WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-internationalisation', location = 'i18n/translations.i18n.js' */
define("confluence-editor/i18n/translations.i18n",["ajs"],function(a){return{popup_blocked:"The browser has blocked a popup opened by the Editor.",ctrl_key:"Ctrl",shift_key:"Shift",Close:"Close",searchreplace:{search_desc:"Find",replace_desc:"Find/Replace"},searchreplace_dlg:{allreplacedplural:"{0} replacements were made",
allreplacedsingular:"1 replacement was made",notfound:"No replacements were made",findlabel:"Find",replacelabel:"Replace",findnext:"Next",findprevious:"Previous",replace:"Replace",replaceall:"Replace all",
close:"Close"},advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"Emoticons"},emotions_dlg:{title:"Insert emoticon",desc:"Emoticons",smile:"Smile :)",sad:"Sad :(",tongue:"Tongue :p",biggrin:"Big grin :D",
wink:"Wink ;)",thumbs_up:"Thumbs up (y)",thumbs_down:"Thumbs down (n)",information:"Info (i)",check:"Tick (/)",error:"Error (x)",warning:"Warning (!)",add:"Plus (+)",forbidden:"Minus (-)",help_16:"Question mark (?)",
lightbulb_on:"Lightbulb on (on)",lightbulb:"Lightbulb off (off)",star_yellow:"Yellow star (*y)",star_red:"Red star (*r)",star_green:"Green star (*g)",star_blue:"Blue star (*b)",heart:"Heart \u003c3",broken_heart:"Broken heart \u003c/3"},confluence:{conf_macro_browser:"Macro",
conf_macro_browser_desc:"Insert macro",conf_image:"Image",confimage_desc:"Insert image",conf_file:"Files and images",confifile_desc:"Insert files and images",conf_link:"Link",conflink_desc:"Insert link",conf_table:"Table",
conf_wikimarkup:"Markup",conf_wikimarkup_desc:"Insert markup",conf_wikimarkup_errors:"Wiki markup conversion errors",conf_wikimarkup_timeout:"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.",conf_wikimarkup_hint:"Hint: you can also enter wiki markup directly in the editor, where it will be formatted as you type.",conf_wikimarkup_markdown_label:"Markdown",
conf_wikimarkup_confluence_label:"Confluence wiki",conf_shortcuts_help_desc:"Keyboard shortcuts help",conf_insert_button_title:"Insert"},table:{desc:"Insert table",row_before_desc:"Insert row above",row_after_desc:"Insert row below",delete_row_desc:"Delete row",
numbering_column_desc:"Insert numbering column",responsive:"Responsive",responsive_tooltip:"Table columns get wider as you add content. Drag column borders to set width relative to each other and the page.",fixed_width:"Fixed width",fixed_width_tooltip:"Drag column borders to set width. The table always appears at the width you set.",col_before_desc:"Insert column left",col_after_desc:"Insert column right",col_copy_desc:"Copy column",
col_paste_desc:"Paste column left",col_cut_desc:"Cut column",delete_col_desc:"Delete column",split_cells_desc:"Split merged cells",merge_cells_desc:"Merge cells",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"Paste row above",
paste_row_after_desc:"Paste row after",cut_row_desc:"Cut row",copy_row_desc:"Copy row",del:"Delete table",row:"Row",col:"Column",cell:"Cell",row_highlight:"Heading row",col_highlight:"Heading column",selection_highlight:"Change cell color",
invalid_table_field:"Rows and columns must both be numbers greater than zero.",table_more_heading:"Table settings",cell_background_color:"Background color : {0}",cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",
row_after_desc_shortcut:"Alt+\u2193"},advanced:{style_select:"tinymce.advanced.style_select",font_size:"tinymce.advanced.font_size",fontdefault:"tinymce.advanced.fontdefault",block:"Format",paragraph:"Paragraph",pre:"Preformatted",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",
h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",blockquote:"Quote",code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"Bold",italic_desc:"Italic",underline_desc:"Underline",
striketrough_desc:"Strikethrough",justifyleft_desc:"Align left",justifycenter_desc:"Align center",justifyright_desc:"Align right",justifyfull_desc:"Align full",bullist_desc:"Bullet list",numlist_desc:"Numbered list",tasklist_desc:"Task list",
outdent_desc:"Outdent",indent_desc:"Indent",undo_desc:"Undo",redo_desc:"Redo",link_desc:"tinymce.advanced.link_desc",unlink_desc:"Unlink",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",
sub_desc:"Subscript",sup_desc:"Superscript",hr_desc:"Horizontal rule",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"Select text color",backcolor_desc:"tinymce.advanced.backcolor_desc",charmap_desc:"Symbol",visualaid_desc:"tinymce.advanced.visualaid_desc",
anchor_desc:"tinymce.advanced.anchor_desc",cut_desc:"tinymce.advanced.cut_desc",copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"Help",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",
newdocument:"tinymce.advanced.newdocument",toolbar_focus:"tinymce.advanced.toolbar_focus",more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",
h5_shortcut:"Ctrl+5",h6_shortcut:"Ctrl+6",blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"[ then ]",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},
colorpicker:{more_colors:"More colors",title:"Select a color",picker_tab:"Picker",picker_title:"Color picker",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"Color",name:"tinymce.colorpicker.name",
apply:"tinymce.colorpicker.apply"},hints:{drafts:"Hint: Confluence saves drafts automatically. If you ever lose a window, recover your work from the \u0022Username -\u003e Drafts\u0022 menu.",dnd:"Hint: you can drag and drop images and Office files from your computer right into this editor.",insert_link_recently_viewed:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 to see a list of suggested pages and insert a link.",insert_link_search:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 and part of a page title to find and link to that page.",insert_link_end:"Hint: press \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e after a word to find and link to relevant pages. Press it again for more suggestions.",insert_link_newpage:"Hint: type \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 and the title of a new page you wish to create, to see an insert link suggestion.",insert_link_user_mention:"Hint: you can mention somebody in Confluence by typing \u0022\u003cstrong\u003e@\u003c/strong\u003e\u0022 and then their name.",
insert_image_on_page:"Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 to see images attached to the page and insert one of them.",insert_image_search:"Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 and part of an image name to find and insert the image.",insert_image_end:"Hint: press \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e after a word to find and insert relevant images.",insert_wikimarkup:"Hint: the Editor will automatically convert wiki markup as you type it.",insert_wikimarkup_dialog:"Hint: press \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e to open the Wiki Markup dialog.",insert_link:"Hint: press \u003cstrong\u003eCtrl+K\u003c/strong\u003e to open the link browser.",insert_image:"Hint: press \u003cstrong\u003eCtrl+M\u003c/strong\u003e to open the image browser.",insert_macro:"Hint: press \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e to open the macro browser.",
insert_macro_toc:"Hint: Let Confluence generate you a table of contents for this page. Use \u0022Insert -\u003e Table of contents\u0022",insert_bullet_list:"Hint: press \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e to start a bullet list.",insert_numbered_list:"Hint: press \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e to start a numbered list.",insert_heading:"Hint: press \u003cstrong\u003eCtrl+1\u003c/strong\u003e to create a heading level 1, \u003cstrong\u003eCtrl+2\u003c/strong\u003e for heading level 2 and so on.",insert_table:"Hint: press \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e to insert a table.",table_rows_copy:"Hint: press \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e to copy a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",table_rows_cut:"Hint: press \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e to cut a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",insert_newline:"Hint: Type \u003cstrong\u003eShift+Enter\u003c/strong\u003e to insert a new paragraph without spacing",
autoformat_heading1:"Hint: Type \u0022\u003cstrong\u003eh1. Title\u003c/strong\u003e\u0022 to quickly insert a Heading 1.",autoformat_heading3:"Hint: Type \u0022\u003cstrong\u003eh3. Title\u003c/strong\u003e\u0022 to quickly insert a Heading 3.",autoformat_code:"Hint: Type \u0022\u003cstrong\u003e{{code}}\u003c/strong\u003e\u0022 to quickly insert monospaced text."},auiwindowmanager:{cancel:"Cancel",ok:"OK"},propertypanel:{links_goto:"Go to link",links_edit:"Edit",links_unlink:"Unlink",
links_goto_disabled_tooltip:"This link goes to content on the page you are editing",links_edit_tooltip:"Edit link in a dialogue",links_unlink_tooltip:"Replace link with the text it contains",images_small:"Small",images_medium:"Medium",images_large:"Large",images_original:"Original",
images_border:"Border",images_link_create:"Link",images_link_edit:"Edit link",images_link_remove:"Unlink",images_link_create_tooltip:"Link this image to other content",images_link_edit_tooltip:"Edit the link for this image",images_link_remove_tooltip:"Remove the link for this image",
images_sizing_tooltip:"Resize image to a specific width",images_small_tooltip:"Resize image to small and link to the original",images_medium_tooltip:"Resize image to medium and link to the original",images_large_tooltip:"Resize image to large and link to the original",images_original_tooltip:"Reset image size to original",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",
images_border_tooltip:"Display a border around image"},toolbar:{insert_files_shortcut_tooltip:"Ctrl+M"},a11ychecker:{btn_tooltip:"Check accessibility"}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/i18n/translations.i18n","TinyMCELang");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dictionary', location = '/includes/js/api/dictionary.js' */
define("confluence/api/dictionary",[],function(){return function(){var a={};return{get:function(b){return a[b]},put:function(b,c){return a[b]=c},reset:function(){a={}},elements:function(){return a}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:macro-js-overrides', location = '/includes/js/macro-js-overrides.js' */
define("confluence/macro-js-overrides",["confluence/api/dictionary","underscore"],function(f,e){var a=new f;return e.extend(a,{getFunction:function(b,c){var d=a.get(b);if(d&&"function"===typeof d[c])return d[c]},assignFunction:function(b,c){a.put(b,e.extend({},a.get(b),c))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define("confluence-ui-components/js/internal/space-resolver",["underscore","jquery","ajs"],function(d,k,a){function m(b){return d.map(b,function(b){return"spaceKey\x3d"+encodeURI(b)}).join("\x26")}function f(b,a){var c="undefined"===typeof a;a=d.escape(c?b:a);return{id:b,text:a,idOnly:c}}var l={conf_all:"All spaces",conf_current:"Current space",conf_favorites:"Favorite spaces",
conf_global:"Site spaces",conf_personal:"Personal spaces"},g=["conf_favorites","conf_global","conf_personal"];return{getSpaceDisplayItems:function(b,g){var c={},h=[];d.each(b,function(a){var b=l[a];b?c[a]=f(a,b):h.push(a)});if(h.length){var e=a.contextPath()+"/rest/api/space?"+m(h);e=k.getJSON(e)}else e=new k.Deferred,e.resolve({results:[]});e.done(function(a){d.each(a.results,
function(a){c[a.key]=f(a.key,a.name)});a=d.map(b,function(a){return c[a]||f(a)});g(a)})},getSpaceCategoryDisplayName:function(a){return l[a]},getSpaceTypeKeys:function(){return g}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define("confluence-ui-components/js/space-picker",["underscore","ajs","jquery","confluence-ui-components/js/internal/space-resolver"],function(d,f,g,k){function q(a){var b=r(),c=t(a);return function(a,h,e){if(2>a.term.length)return c(a);"function"===typeof h&&(a.term=h(a.term));m=u(e);return b(a)}}function n(a,b,c){var l=[];a.forEach(function(a){if(a.children){var e=n(a.children,b,c);e.length&&l.push(g.extend({},a,{children:e}))}else if(e="undefined"!==typeof a.id&&d.contains(k.getSpaceTypeKeys(),
a.id),b&&e||!b&&!e)d.contains(c,a.id)||l.push(a)});return l}function p(a,b){if(!a.length||!b.length)return a;var c=0<d.intersection(b,k.getSpaceTypeKeys()).length;a=n(a,c,b);a.length||a.push({text:"Can\u0027t filter by space types AND spaces",disabled:!0});return a}function v(a){var b=g(".select2-container-active").next("input").val().trim();b=""!==b?b.split(","):[];return p(a,b)}var w={data:null,suggestCategories:null},u=function(a){return function(b){b={id:b.spaceKey,
text:b.spaceName};return"function"===typeof a?a(b):b}},m,x=function(a){return function(b,c){b=g(b).val();""!==b&&(b=b.split(","),k.getSpaceDisplayItems(b,function(b){a.multiple||(b=b[0]);c(b)}))}},t=function(a){var b;if(a.suggestCategories)var c={text:"Select a suggestion or type to search",children:d.map(a.suggestCategories,function(a){return{id:a,text:k.getSpaceCategoryDisplayName(a)}})};return function(a){b?a.callback(b):g.getJSON(f.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(h){var e=
{results:[]};c&&e.results.push(c);0<h.length&&e.results.push({text:"Suggested spaces",children:d.map(h,function(a){return{id:a.key,text:d.escape(a.name)}})});b=e;a.callback(b)}).fail(function(){f.log("Couldn't fetch recent spaces");var b={results:[]};c&&b.results.push(c);a.callback(b)})}},r=function(){return window.Select2.query.ajax({url:f.contextPath()+"/rest/quicknav/1/search?type\x3dspacedesc\x26type\x3dpersonalspacedesc",data:function(a){return{query:a,
maxPerCategory:25}},quietMillis:250,results:function(a){a=a.contentNameMatches;if(1>=a.length)return{results:[]};a=d.map(a[0],m);return{results:[{text:"Search results",children:a}]}}})};return{build:function(a){a=d.extend({},w,a);var b={placeholder:"Select a space",formatResult:function(a,b,d){b.attr("title",g("\x3cdiv/\x3e").html(a.text).text());return g.fn.select2.defaults.formatResult.apply(this,
arguments)},escapeMarkup:function(a){return a},multiple:!0===a.multiple,containerCssClass:"space-picker-container"};a.disableMixedSpaceTypes&&(b.sortResults=v);return a.data?d.extend(b,{data:a.data}):d.extend(b,{initSelection:x(a),query:q(a)})},filterMixedTypesForValues:p}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
window.Confluence.UI.Components.SpacePicker=require("confluence-ui-components/js/space-picker");require("ajs").deprecate.prop(window.Confluence.UI.Components.SpacePicker,"build",{sinceVersion:"1.4.22",extraInfo:"Use require('confluence-ui-components/js/space-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/amd/shim/aui-datepicker-amd.js' */
define("aui/datepicker",function(){return AJS.DatePicker});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:date-picker', location = '/includes/js/date-picker-localisation.js' */
require(["aui/datepicker"],function(a){var b="";a&&(a.prototype.localisations.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday",
"Saturday"],a.prototype.localisations.dayNamesMin=["Sun","Mon","Tue","Wed","Thu","Fri",
"Sat"],a.prototype.localisations.firstDay="0",a.prototype.localisations.isRTL="true"==="false",a.prototype.localisations.monthNames=["January","February","March",
"April","May","June","July","August","September","October","November",
"December"],a.prototype.localisations.showMonthAfterYear="true"==="false",a.prototype.localisations.yearSuffix=b&&"null"!==b?b:"")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/space-page-picker.js' */
define("confluence-ui-components/js/space-page-picker",["underscore","ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(e,g,F,f){function G(a,b,c){a=e.map(a,function(a){return b[a]});return c?a:0<a.length?a[0]:null}function B(a){return 0===a.indexOf("page:")?"data-item-id":"data-item-key"}function v(a,b,c,d){c=c?c:0===a.indexOf("~")?"content-type-personalspacedesc":"content-type-spacedesc";return m("space",a,b,"",c,d)}function C(a){var b=H[a];return m("space-cat",a,b,"",
"content-type-space-category",b)}function D(a){var b=I[a];return m("content-function",a,b,"","content-type-page",b)}function w(a,b,c,d,e){return m("page",a,b,c,d,e)}function m(a,b,c,d,e,g){return{id:J(a,b),text:c?c:b,subText:d,className:g?e:e+" content-not-found",disabled:g?!1:!0}}function J(){return Array.prototype.slice.apply(arguments).join(":")}function K(a){return(!a.contentType||0===a.contentType.length||0<=a.contentType.indexOf("space"))&&!1!==a.showRecentlyViewedSpaces}function L(a){return(!a.contentType||
0===a.contentType.length||0<=a.contentType.indexOf("page"))&&!1!==a.showRecentlyViewedPages}function M(a,b){b=u("SpaceCat",a,b.inputSpaceCatId,b.inputSpaceCatName?b.inputSpaceCatName:b.inputSpaceCatId);return h(a,b.id,b.name)}function N(a,b){var c=b.inputContentFunctionId||"legacy-macro-param-content-funcs";b=u("ContentFunction",a,c,b.inputContentFunctionName||c);return h(a,b.id,b.name)}function O(a,b){b=u("Space",a,b.inputSpaceId,b.inputSpaceName?b.inputSpaceName:b.inputSpaceId);return h(a,b.id,
b.name)}function P(a,b){b=u("Page",a,b.inputPageId,b.inputPageName?b.inputPageName:b.inputPageId);return h(a,b.id,b.name)}function u(a,b,c,d){if(!c){var e=b.attr("id");if(!e)return null;c=e+a}d||(d=(b.attr("name")||e)+a);return{id:c,name:d}}function h(a,b,c){var d=f("#"+b);0===d.length&&(d=f(F.Components().hiddenField({id:b,name:c})),a.after(d));return d}function k(a,b,c){a&&(b=e.filter(b,function(a){return 0===a.indexOf(c)}),b=e.map(b,function(a){return a.substring(c.length,a.length)}),a.val(b.join(",")))}
function y(a,b,c,d){c=c?e.isArray(c)?c:c.split(","):[];d=d?d.split(","):[];c=e.union(c,d);c=e.map(c,function(a){return b+a});d=(d=a.val())?d.split(","):[];c=e.union(d,c);0<c.length&&a.val(c.join(","))}function E(a,b,c){var d=b.data("select2").opts,x=d.placeholder||b.data("placeholder"),n=M(b,d),p=N(b,d),z=O(b,d),A=P(b,d);b.on("change",function(a){k(n,a.val,"space-cat:");k(p,a.val,"content-function:");k(z,a.val,"space:");k(A,a.val,"page:")});b.val("");var Q="SELECT"===b["0"].tagName?b.context.multiple:
d.multiple,m=[],q=[],r=[],u=[],t={},l=a?a.split(","):[];l=e.filter(l,function(a){a=a.split(":");if(2===a.length)return!0;(0>a.length||3<=a.length||1===a.length&&"SPACE-PAGE-TRIGGER-VALUE"!==a[0]&&a[0]!==x)&&g.debug("Error value: "+a)});a=l.join(",");b.val(a);y(b,"space-cat:",d.spaceCatKeys,n?n.val():"");y(b,"content-function:",d.pageCatKeys,p?p.val():"");y(b,"space:",d.spaceKeys,z?z.val():"");y(b,"page:",d.pageIds,A?A.val():"");l=(a=b.val())?a.split(","):[];k(n,l,"space-cat:");k(p,l,"content-function:");
k(z,l,"space:");k(A,l,"page:");if(0!==l.length){e.each(l,function(a,b){b=a.split(":");2===b.length&&(a=b[0],b=b[1],"space-cat"===a?m.push(b):"content-function"===a?r.push(b):"space"===a?q.push(b):"page"===a&&u.push(b))});e.each(m,function(a){t["space-cat:"+a]=C(a)});e.each(r,function(a){t["content-function:"+a]=D(a)});var h=[];0<q.length&&(a=f.getJSON(g.contextPath()+"/rest/prototype/1/space",{spaceKey:q}).done(function(a){var b=[];e.each(a.space,function(a){t["space:"+a.key]=v(a.key,e.escape(a.name),
null,!0);b.push(a.key)});a=e.difference(q,b);e.each(a,function(a){t["space:"+a]=v(a,a,null,!1)})}).fail(function(){g.debug("Couldn't resolve spaceKeys:",q);e.each(q,function(a){t["space:"+a]=v(a,a,null,!1)})}),h.push(a));e.each(u,function(a){var b=f.getJSON(g.contextPath()+"/rest/api/content/"+a,{expand:"space"}).done(function(a){t["page:"+a.id]=w(a.id,e.escape(a.title),e.escape(a.space.name),"content-type-page",!0)}).fail(function(){g.debug("Couldn't resolve pageId:",a);t["page:"+a]=w(a,a,"",
"content-type-page",!1)});h.push(b)});f.when.apply(f,e.map(h,function(a){var b=new f.Deferred;a.always(function(){b.resolve()});return b.promise()})).done(function(){c(G(l,t,Q))})}}var H={conf_all:"All spaces",conf_favorites:"Favorite spaces",conf_global:"Site spaces",conf_personal:"Personal spaces",
conf_current:"Current space"},I={"currentContent()":"Current page"},R={data:null,suggestCategories:null},S={placeholder:"Select a space or page",multiple:!0,formatInputTooShort:function(){return "Start typing to search"},formatResult:function(a,b,c){if(a.children)return b.addClass("space-page-picker-result-category"),
f.fn.select2.defaults.formatResult.apply(this,arguments);if(a.id){b.attr("title",a.text);b.addClass("space-page-picker-result-label-with-icon");var d=f("\x3cspan/\x3e").addClass(a.className+" item-text").html(f.fn.select2.defaults.formatResult.apply(this,arguments)),e=a.subText?f("\x3cspan/\x3e").addClass("space-name").html(a.subText):f("");d=f("\x3cspan/\x3e").attr(B(a.id),a.id).append(d).append(e);return f("\x3cspan/\x3e").append(d)}b.addClass(a.className);return f.fn.select2.defaults.formatResult.apply(this,
arguments)},formatSelection:function(a,b){b.addClass("space-page-picker-selected-item");b.attr("title",a.text);var c=f("\x3cspan/\x3e").attr(B(a.id),a.id).addClass(a.className+" item-text").text(f.fn.select2.defaults.formatSelection.apply(this,arguments));b.append(c)},escapeMarkup:function(a){return a},formatResultCssClass:function(a){return a.children||a.id?"":"select2-result-space-page-separator"},containerCssClass:"space-page-picker-container",dropdownCssClass:"space-page-picker-drop"},T=function(a,
b){!0!==a.data("select2").opts.manualInit&&E(a.val(),a,b)},U=function(a){var b;if(a.suggestCategories)var c={text:"Suggested categories",children:e.map(a.suggestCategories,function(a){return C(a)})};if(a.suggestedContentFunctions)var d=e.map(a.suggestedContentFunctions,function(a){return D(a)});return function(x){if(b)x.callback(b);else{var n=[];b={results:[]};if(K(a)){var p=f.getJSON(g.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(a){var d=
c?[c]:[];0<a.length&&d.push({text:"Suggested spaces",children:e.map(a,function(a){return v(a.key,e.escape(a.name),null,!0)})});0<d.length&&(b.results=b.results.concat(d))}).fail(function(){g.debug("Couldn't fetch recent spaces");var a=c?[c]:[];0<a.length&&(b.results=b.results.concat(a))});n.push(p)}L(a)&&(p=f.getJSON(g.contextPath()+"/rest/recentlyviewed/1.0/recent/pages",{noTrashedContent:!0}).done(function(a){if(0<a.length||d){var c=[];
d&&(c=c.concat(d));0<a.length&&(c=c.concat(e.map(a,function(a){return w(a.id,e.escape(a.title),e.escape(a.space),"content-type-page",!0)})));b.results.push({text:"Suggested pages",children:c})}}).fail(function(){g.debug("Couldn't fetch recent pages")}),n.push(p));f.when.apply(f,e.map(n,function(a){var b=f.Deferred();a.always(function(){b.resolve()});return b})).done(function(){0===b.results.length&&(b.results=[{text:"",children:[]}]);x.callback(b)})}}},
V=function(a){var b="";if(!a||2===a.length&&0<=a.indexOf("space")&&0<=a.indexOf("page"))b="type\x3dspacedesc\x26type\x3dpersonalspacedesc\x26type\x3dpage";else if(1===a.length&&"space"===a[0])b="type\x3dspacedesc\x26type\x3dpersonalspacedesc";else if(1===a.length&&"page"===a[0])b="type\x3dpage";else return;return window.Select2.query.ajax({url:g.contextPath()+"/rest/quicknav/1/search?"+b,data:function(a,b){return{query:a,maxPerCategory:25}},quietMillis:250,results:function(a,b){a=a.contentNameMatches;
if(1>=a.length)return{results:[]};b=[];for(var c=0;c<a.length-1;c++){for(var d=[],e=0;e<a[c].length;e++){var f=a[c][e];var h=void 0,k=f.spaceName,m=f.id,q=f.name,r=f.className;"content-type-spacedesc"===r||"content-type-personalspacedesc"===r?h=v(f.spaceKey,k,r,!0):"content-type-page"===r&&(h=w(m,q,k,r,!0));(f=h)&&d.push(f)}0<d.length&&(b=b.concat(d),b.push({id:"",text:"",subText:"",className:"",disabled:!0}))}return{results:[{text:"Search results",
children:b}]}}})},W=function(a){var b=V(a.contentType),c=U(a);return function(a){2>a.term.length?c(a):b(a)}};return{build:function(a){var b=e.extend({},R,S,a);a.data||(b=e.extend({},{initSelection:T,query:W(b)},b));a=f(b.orgElement);if(!a||1!==a.length)return b;a.val()||b.manualInit||a.val("SPACE-PAGE-TRIGGER-VALUE");a.addClass("select2-input");return b},setValue:function(a,b){E(a,b,function(a){b.auiSelect2("data",a)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/internal/space-page-picker-legacy.js' */
window.Confluence.UI.Components.SpacePagePicker=require("confluence-ui-components/js/space-page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.SpacePagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/space-page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/soy/space-page-picker.soy' */
// This file was automatically generated from space-page-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.templates == 'undefined') { Confluence.UI.Components.templates = {}; }


Confluence.UI.Components.templates.hiddenField = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="' + soy.$$escapeHtml(opt_data.id) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" />';
};
if (goog.DEBUG) {
  Confluence.UI.Components.templates.hiddenField.soyTemplateName = 'Confluence.UI.Components.templates.hiddenField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
define("confluence-ui-components/js/page-picker",["ajs","confluence-ui-components/js/space-page-picker"],function(b,c){return{build:function(a){a.placeholder="Select a page";a.contentType=["page"];a.showRecentlyViewedSpaces=!1;a.spaceCatKeys=[];a.spaceKeys=[];return c.build(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/internal/page-picker-legacy.js' */
window.Confluence.UI.Components.PagePicker=require("confluence-ui-components/js/page-picker");AJS.deprecate.prop(window.Confluence.UI.Components.PagePicker,"build",{sinceVersion:"1.4.34",extraInfo:"Use require('confluence-ui-components/js/page-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker.js' */
define("confluence-ui-components/js/label-picker",["ajs","confluence-ui-components/js/internal/soy-templates","jquery","underscore"],function(c,e,f,d){function l(a){return{id:a.name,text:a.name}}function g(a){if(!a||!a.length)return null;a=d.map(a,l);return d.sortBy(a,function(a){return a.text.toLowerCase()})}function h(a){return function(b){return f.extend({query:b,ignoreRelated:!0,maxResults:10},a)}}var k=/[;,\.\?&\[\(\)#\^\*@!<>\]]/g,m={placeholder:"Add labels",
multiple:!0,minimumInputLength:1,maximumSelectionSize:20,tokenSeparators:[" ",","],formatInputTooShort:function(a,b){return "Start typing to search for a label"},formatSelectionTooBig:function(a){return c.format("You can only input {0} labels",a)},formatResult:function(a){return e.LabelPicker().labelResult({label:{labelName:a.text,isNew:a.isNew}})},formatNoMatches:function(a){var b=d.uniq(a.match(k)).join(" ");return b?e.LabelPicker().labelInvalid({inputValue:a,
invalidCharacters:b}):this.noMatches},createSearchChoice:function(a){return!a||d.uniq(a.match(k)).join(" ")?null:{id:a,text:a,isNew:!0}},ajax:{data:h(),dataType:"json",url:c.contextPath()+"/labels/autocompletelabel.action",results:function(a){var b=a.contentNameMatches;a=g(b[0]);b=g(b[1]);a=a&&b?[{text:"Suggested",children:a},{text:"Other",children:b}]:a||b||[];return{results:a}},quietMillis:300},
dropdownCssClass:"labels-dropdown",containerCssClass:"labels-autocomplete",initSelection:function(a,b){a=a.val().split(",");a=d.map(a,function(a){return{id:a,text:a}});b(a)}};return{build:function(a){var b=f.extend({},m,a);a&&a.queryOpts&&(b.ajax.data=h(a.queryOpts),delete b.queryOpts);a&&a.noMatches||(b.noMatches=b.placeholder);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/internal/label-picker-legacy.js' */
window.Confluence.UI.Components.LabelPicker=require("confluence-ui-components/js/label-picker");AJS.deprecate.prop(window.Confluence.UI.Components.LabelPicker,"build",{sinceVersion:"1.4.18",extraInfo:"Use require('confluence-ui-components/js/label-picker')"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/soy/label-picker.soy' */
// This file was automatically generated from label-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.LabelPicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.LabelPicker == 'undefined') { Confluence.UI.Components.LabelPicker = {}; }
if (typeof Confluence.UI.Components.LabelPicker.templates == 'undefined') { Confluence.UI.Components.LabelPicker.templates = {}; }


Confluence.UI.Components.LabelPicker.templates.labelResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - add a new label',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelResult.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelResult';
}


Confluence.UI.Components.LabelPicker.templates.labelInvalid = function(opt_data, opt_ignored) {
  var output = '';
  var inputValueHtml__soy9 = '<b>' + soy.$$escapeHtml(opt_data.inputValue) + '</b>';
  var invalidCharactersHtml__soy13 = '<b>' + soy.$$escapeHtml(opt_data.invalidCharacters) + '</b>';
  output += soy.$$filterNoAutoescape(AJS.format('{0} contains invalid characters {1}',inputValueHtml__soy9,invalidCharactersHtml__soy13));
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelInvalid.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelInvalid';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define("confluence-ui-components/js/include-exclude-picker",["jquery","underscore"],function(d,e){function g(a){var b=a.charAt(0);e.contains(["-"],b)?(c=b,a=a.substring(1)):c="";return a}function f(a){a=d.extend({},a);a.children?a.children=e.map(a.children,f):(a.id=c+a.id,a.text=c+a.text);return a}function h(a){return function(b){b=g(b);return a(b)}}function k(a){return function(b){b=a?a(b):b;c&&(b.results=e.map(b.results,f));return b}}function l(a){return function(b){return a(b,g,f)}}function m(a){if("-"===
a.text.charAt(0))return"select2-search-choice-subtle"}var c="";return{build:function(a){a=d.extend({formatSelectionCssClass:m},a);a.query?a.query=l(a.query):(a.ajax=d.extend({},a.ajax),a.ajax.data=h(a.ajax.data),a.ajax.results=k(a.ajax.results));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/js/user-group-select2.js' */
define("confluence-ui-components/js/user-group-select2",["ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(c,f,d){return{bind:function(e){e=e||document.body;var l=function(){var b=d(".select2-drop-active \x3e .select2-results");0===b.children(".select2-result-selectable").length&&b.children(".select2-disabled").length&&b.append('\x3cli class\x3d"select2-no-results"\x3e'+c.escapeHtml("No matches found")+"\x3c/li\x3e")};d("input.autocomplete-multiusergroup[data-autocomplete-bound !\x3d 'true']",
e).each(function(){var b=d(this);b.attr("data-autocomplete-bound","true");var e=b.attr("data-include-groups");b.auiSelect2({multiple:!0,minimumInputLength:2,formatInputTooShort:function(){return e?"Start typing to search for a user or group":"Start typing to search for a user"},ajax:{transport:function(a){var c=a.success;delete a.success;return d.ajax.apply(d.ajax,arguments).done(c).done(l)},data:function(a){return{"max-results":6,
query:a}},dataType:"json",url:c.contextPath()+"/rest/prototype/1/search/user"+(e?"-or-group":"")+".json",results:function(a){var b=[];d.each(a.result,function(){"user"===this.type?b.push({id:this.username,text:`${this.title} (${this.username})`,imgSrc:this.thumbnailLink.href,entity:this}):b.push({id:this.name,text:this.name,imgSrc:c.contextPath()+"/images/icons/avatar_group_48.png",entity:this})});return{results:b}},quietMillis:300},formatResult:function(a){return f.UserGroupSelect2().avatarWithName({size:"small",
displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return f.UserGroupSelect2().avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(b.data("autofill-user")){var g=c.Meta.get("remote-user"),h=c.Meta.get("current-user-fullname"),k=c.Meta.get("current-user-avatar-uri-reference");g&&h&&k&&b.auiSelect2("data",
[{id:g,text:h,imgSrc:k}])}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/soy/user-group-select2.soy' */
// This file was automatically generated from user-group-select2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.UserGroupSelect2.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.UserGroupSelect2 == 'undefined') { Confluence.UI.Components.UserGroupSelect2 = {}; }


Confluence.UI.Components.UserGroupSelect2.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  Confluence.UI.Components.UserGroupSelect2.avatarWithName.soyTemplateName = 'Confluence.UI.Components.UserGroupSelect2.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<span class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('Remove filter') + '"></span>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Add a filter') + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a href="#" role="button" data-value="">' + soy.$$escapeHtml('Any date') + '</a></li role="button"><li><a href="#" role="button" data-value="now(\'-1d\')">' + soy.$$escapeHtml('Last 24 hours') + '</a></li><li><a href="#" role="button" data-value="now(\'-1w\')">' + soy.$$escapeHtml('Last week') + '</a></li><li><a href="#" role="button" data-value="now(\'-1M\')">' + soy.$$escapeHtml('Last month') + '</a></li><li><a href="#" role="button" data-value="now(\'-1y\')">' + soy.$$escapeHtml('Last year') + '</a></li><li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Custom') + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a href="#" role="button" data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Custom') + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">' + soy.$$escapeHtml('Search archived spaces') + '</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-soy-templates.js' */
define("confluence-ui-components/js/cql/internal/cql-soy-templates",[],function(){return{CQL:function(){return Confluence.UI.Components.CQL.Templates},Filters:function(){return Confluence.UI.Components.CQLFilters.Templates},FilterSelect:function(){return Confluence.UI.Components.CQL.FilterSelect.Templates},SpaceField:function(){return Confluence.UI.Components.CQL.SpaceField.templates},TypePicker:function(){return Confluence.UI.Components.CQL.TypePicker.templates}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(b){function d(a){return"search-screen"===a?b.omit(c,"conf_current"):c}var c={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"},e=b.invert(c);return{getMap:d,getKeys:function(a){return b.keys(d(a))},getUIValue:function(a){return e[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(b,d,e){var c;return{getFields:function(){c||(c=b.Deferred(),b.getJSON(e.contextPath()+"/rest/cql/fields?filter\x3dwithUiSupport").done(function(a){a=d.values(a);if(!a.length)throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.");a=d.union.apply(d,a);a=d.sortBy(a,"fieldName");c.resolve(a)}).fail(function(){c.reject()}));return c.promise()},parseClauses:function(a){return b.getJSON(e.contextPath()+
"/rest/cql/expressions?cql\x3d"+encodeURIComponent(a))},getTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dall")},getContentTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dcontent")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-date-picker",["ajs","jquery","confluence-ui-components/js/internal/soy-templates"],function(b,g,m){return{build:function(n){var c=g(m.DatePicker().input()),d=c.find(".aui-nav li"),h=c.find(".absolute-date-pickers").hide(),e=c.find(".from-date-picker"),f=c.find(".to-date-picker"),k=function(){};this.onChange=function(a){k=a;e.change(a);f.change(a)};c.on("click",".aui-nav a",function(a){a.preventDefault();a=d.filter("li.aui-nav-selected");var b=g(this).closest("li");
a[0]!==b[0]&&(d.not(b).removeClass("aui-nav-selected"),b.addClass("aui-nav-selected"),k());"custom"===g(this).data("value")?h.slideDown("fast"):h.slideUp("fast")});var l={overrideBrowserDefault:!0};b.DatePicker(e,l);b.DatePicker(f,l);e.attr("placeholder","From");e.attr("aria-label","From");f.attr("placeholder","To");f.attr("aria-label",
"To");n.replaceWith(c);return{getSelectedOption:function(){return d.filter(".aui-nav-selected").find("a").data("value")},selectOption:function(a){d.find('a[data-value\x3d"'+a+'"]').click()},getFromDate:function(){return e.val()},getToDate:function(){return f.val()},setFromDate:function(a){e.val(a);d.find("a[data-value\x3d'custom']").click()},setToDate:function(a){f.val(a);d.find("a[data-value\x3d'custom']").click()}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-type-picker","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/include-exclude-picker".split(" "),function(m,c,n,p,r,t,u){function v(a){g=c.map(a,function(a){return{id:a.type,text:a.label}})}function q(a,e){return 0===a.length?"":1===a.length&&c.contains(c.pluck(e,"type"),a[0])?
a[0]:"custom"}var e,g=[];return{build:function(a,w){var f,h,k,l=[];e||(e=w?p.getContentTypes():p.getTypes(),e.done(v));e.done(function(){if(a.length){var b=c.pluck(g,"id");l=[].concat(g);a.forEach(function(d){""===d.type||c.contains(b,d.type)||l.push({id:d.type,text:d.label})})}else l=g});var x={query:function(b,d,a){e.done(function(){d(b.term);window.Select2.query.local({results:c.map(l,a)})(b)})},initSelection:function(a,d){a=a.val().split(",");var b="",f=c.map(a,function(a){return"-"===a.charAt(0)?
(b="-",a.substring(1)):a});e.done(function(){var a=c.filter(l,function(a){return c.contains(f,a.id)});d(c.map(a,function(a){return{id:b+a.id,text:b+a.text}}))})},multiple:!0,placeholder:"All content types"};return{setupInput:function(b){f=b;if(n.trace)f.on("change",function(){n.trace("type.field.changed")});a.length&&(b=m(t.TypePicker().suggestions({types:a})),h=b.find(".aui-nav li"),f.before(b),b.on("click",".aui-nav a",function(a){a.preventDefault();
a=m(this).closest("li");var b=h.filter(".aui-nav-selected");a[0]!==b[0]&&(b.removeClass("aui-nav-selected"),a.addClass("aui-nav-selected"),a=m(this).attr("data-value"),"custom"===a?k.slideDown("fast"):k.hide(),f.select2("val",[a],!0))}));f.auiSelect2(u.build(x));a.length&&(k=f.closest(".cql-filter").find(".select2-container"),k.hide())},setValues:function(b){if(h){var d=q(b,a),c=h.find('[data-value\x3d"'+d+'"]').parent();h.not(c).removeClass("aui-nav-selected");c.addClass("aui-nav-selected");"custom"===
d&&k.show()}var g=m.Deferred();e.done(function(){r.setValues(f,b).done(function(){g.resolve()})});return g}}},_clearCache:function(){e=null;g=[]},_getPicklistKey:q}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){return{getLabel:function(a){return a.uiSupport.label.translation}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(d,e){return{convertFunctionValues:function(a){var b=a.functionValues;if(!b||!b.length)return a;var c=[];d.each(b,function(a){if("currentSpace"===a.functionName)c.push(e.getUIValue("currentSpace()"));else throw Error(a.functionName+" is not a known function");});a.values=c.concat(a.values);return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field",["jquery","ajs","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,b,k,l){function e(a){return{query:a,searchContext:JSON.stringify({spaceKey:b.Meta.get("space-key"),contentId:b.Meta.get("content-id")})}}function f(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")?a:b.contextPath()+a}var h={placeholder:"Start typing to search",
multiple:!0,tokenSeparators:[" ",","],createSearchChoice:function(a){return a?{id:a,text:"New result: "+a,isNew:!0}:null},createSearchChoicePosition:"bottom",ajax:{data:e,results:function(a){var c=a.suggestedResults;a=a.searchResults;c=c.length?a.length?[{text:"Suggestions",children:c},{text:"Search results",children:a}]:c:a;return{results:c}},quietMillis:300},initSelection:function(a,
c){a=a.val().split(",").map(function(a){return{id:a,text:a}});c(a)}};return{build:function(a){var c;return{setupInput:function(g){c=g;var b=d.extend({},h.ajax,{url:f(a.uiSupport.dataUri)});b=d.extend({},h,{ajax:b});g.auiSelect2(b)},asCqlFunc:function(){var a=this.input.val().trim();if(a)return k.buildEqualityExpressionFromValuesString(this.fieldName,a)},setValues:function(a){return l.setValues(c,a.values)}}},_getUrl:f,_ajaxData:e}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field",["jquery","confluence-ui-components/js/page-picker","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(k,d,e,f){function g(b){return"page:"+b}function h(b){return"content-function:"+b.functionName+"()"}function c(b){return b.values.map(g).concat(b.functionValues.map(h))}return{build:function(){var b;return{setupInput:function(a){b=
a;a.auiSelect2(d.build({multiple:"parent"!==this.fieldName,suggestedContentFunctions:["currentContent()"]}))},asCqlFunc:function(){var a=this.input.val().trim();if(a)return a=a.replace(/[a-z\-]+:/g,""),e.buildEqualityExpressionFromValuesString(this.fieldName,a)},_addValuePrefixes:c,setValues:function(a){a=c(a);return f.setValues(b,a)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions",["ajs"],function(a){var b=[{type:"",label:"All content"},{type:"page",label:"Pages"},{type:"blogpost",label:"Blog Posts"},{type:"attachment",label:"Attachments"},{type:"space",
label:"Spaces"}];return{getList:function(){return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field",["confluence/dark-features","confluence-ui-components/js/cql/internal/cql-type-picker","confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions"],function(f,g,h){return{build:function(k){var a;return{setupInput:function(b,c){var d=[],e=!0;if("search-screen"===c.environment&&"all"===c.searchType||f.isEnabled("cql.force.full.search.mode"))d=h.getList(),e=!1;a=g.build(d,e);a.setupInput(b)},setValues:function(b){return a.setValues(b.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field",["ajs","underscore","confluence-ui-components/js/cql/internal/cql-date-picker"],function(d,h,k){return{build:function(l){var f=l.fieldName,b;return{setupInput:function(a){b=k.build.call(this,a)},setValues:function(a){b?(a=a.expressions,1>a.length||2<a.length?d.warn("Can't set date value with expressions.length: "+a.length):1===a.length&&1===a[0].functionValues.length&&"now"===a[0].functionValues[0].functionName?"\x3e\x3d"!==
a[0].operator?d.warn("Unsupported date picker relative date operator: "+a[0].operator):b.selectOption("now('"+a[0].functionValues[0].parameters[0]+"')"):h.each(a,function(a){if(1===a.values.length){var c=a.values[0];"\x3e\x3d"===a.operator?b.setFromDate(c):"\x3c\x3d"===a.operator&&b.setToDate(c)}})):d.warn("DatePicker not set yet, can't set values")},asCqlFunc:function(){if(b){var a=b.getSelectedOption();if(!a)return"";if("custom"===a){a=b.getFromDate();var g=b.getToDate(),c,e;a&&(c=f+' \x3e\x3d "'+
a+'"');g&&(e=f+' \x3c\x3d "'+g+'"');return c&&e?c+" and "+e:c||e||""}return f+" \x3e\x3d "+a}d.warn("DatePicker not set yet, can't get CQL")}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field",["jquery","ajs","confluence-ui-components/js/label-picker","confluence-ui-components/js/include-exclude-picker","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,e,f,g,h){return{build:function(){var c;return{setupInput:function(a,b){c=a;b=d.extend({},b.select2CustomOptions,{noMatches:"No matching labels found"});a.auiSelect2(g.build(f.build(b)))},
setValues:function(a){return h.setValues(c,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field","jquery confluence-ui-components/js/space-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-special-spaces confluence-ui-components/js/cql/internal/cql-space-expression-adjuster confluence-ui-components/js/cql/internal/cql-space-expression-builder confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(e,f,g,h,k,l,m,n){return{build:function(){var b;return{setupInput:function(a,c){b=a;a.auiSelect2(g.build(f.build({multiple:!0,suggestCategories:h.getKeys(c.environment),disableMixedSpaceTypes:!0})));if("search-screen"===c.environment){var d=e(n.SpaceField().archivedSpacesOption());b.after(d);this.onChange=function(a){d.find("#search-filter-include-archived").change(a);b.change(a)}}},asCqlFunc:function(){return l.buildExpressionFromValuesString(this.input.val())},setValues:function(a){k.convertFunctionValues(a);
return m.setValues(b,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(b,e,f){return{build:function(){function g(a){a=a[0].result[0];return{id:a.username,text:a.title,imgSrc:a.thumbnailLink.href}}var c;return{setupInput:function(a){c=a;a.addClass("select2-input autocomplete-multiusergroup");f.bind(a.parent())},setValues:function(a){if((a=a.values)&&a[0]){var d=a.map(function(a){return b.getJSON(e.contextPath()+
"/rest/prototype/1/search/user.json?query\x3d"+encodeURI(a))});return b.when.apply(b,d).done(function(){var a=(1<d.length?arguments:[arguments]).map(g);c.auiSelect2("data",a)})}}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs","confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field".split(" "),
function(d,e,f,g,h,k,l){var c={contentId:e,contentType:f,date:g,label:h,space:k,user:l};return{getConfig:function(a){var b=a.uiSupport;return b.dataUri?d.build(a):c[b.valueType]?c[b.valueType].build(a):{}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-expression-builder confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(e,f,q,g,h,k,l){function m(b){var d=g.getLabel(b);d=e(n().baseFilterField({label:d,field:b,counter:p++}));var c=d.find("input");d.data("fieldName",
b.fieldName);return e.extend({input:c,element:d,onChange:function(a){c.change(a)}},b)}var n=l.Filters,p=0;return{build:function(b,d){var c=b.fieldName;if(!b.uiSupport.valueType)throw Error("Can't create filter without valueType.");if(!c)throw Error("Can't create filter without fieldName.");c=k.getConfig(b);var a=m(b);a.asCql=f.bind(c.asCqlFunc||function(){return h.buildExpression(a,this.input.val())},a);var e=a.element.find("input");"function"===typeof c.setupInput&&(a.setupInput=c.setupInput,a.setupInput(e,
d.context));a.setValues=c.setValues||function(a){e.val(a.values.join(","))};a.element.find(".aui-iconfont-remove").click(function(){a.element.remove();d.removeField(a)});return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(h,c,b,r,k,l){var t=l.FilterSelect;return{build:function(f){function l(a){a.added&&(g.auiSelect2("val",""),n(a.added),b.debug("CQL Field selection made"),m.addClass("hidden"),d.show())}var p=f.cqlContainer,q=p.find(".cql-fields"),
n=f.onSelection;if(!n)throw Error("An onSelection callback must be provided to the FilterSelect.");var e=h(t().container()),d=e.children("button"),m=e.find(".input-wrapper"),g=e.find("input");d.click(function(a){a.preventDefault();m.removeClass("hidden");d.hide();e.find(".select2-choice").mousedown()});g.bind("select2-close",function(){b.debug("CQL Field selector closed");m.addClass("hidden");d.show();setTimeout(function(){b.log("Checking CQL Field selector focus");h(document.activeElement).closest(".cql-filter").length||
(b.debug("Setting CQL Field selector focus"),d.focus())},1)});p.append(e);r.getFields().done(function(a){"search-screen"===f.context.environment||b.DarkFeatures.isEnabled("cql.search.screen")||(a=c.reject(a,function(a){return"date"===a.type}));a=c.reject(a,function(a){return c.contains(f.ignoredFields,a.fieldName)});g.auiSelect2({id:"fieldName",data:function(){if(!q[0])throw Error("Why no cql-container?");var b=q.find(".cql-filter").map(function(){return h(this).data("fieldName")});return{results:c.reject(a,
function(a){return c.contains(b,a.fieldName)&&!c.contains(["label"],a.fieldName)}),text:k.getLabel}},formatResult:k.getLabel,formatSelection:k.getLabel,placeholder:"Add a filter"}).change(l)}).fail(function(){b.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")});return g}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(k,d,e,f){return{buildExpressionFromValuesString:function(a){if(a=a.trim()){a=a.split(",");var g=e.getKeys(),c=[],b=[];d.each(a,function(a){"conf_current"===a?c.push("currentSpace()"):d.contains(g,a)?b.push(a):c.push(a)});a=[];if(b.length){var h=e.getMap();b=d.map(b,
function(a){return h[a]});a.push(f.buildEqualityExpressionFromValuesArray("space.type",b))}c.length&&a.push(f.buildEqualityExpressionFromValuesArray("space",c));return 1===a.length?a[0]:"("+a.join(" or ")+")"}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(p,c){function e(b){return c.contains(["currentContent()","currentSpace()"],b)?b:'"'+b.replace(/"/g,'\\"')+'"'}function f(b){var a={"+":[],"-":[],"":[]};c.each(b,function(b){var d=b.charAt(0);"+"===d?a["+"].push(b.substring(1)):"-"===d?a["-"].push(b.substring(1)):a[""].push(b)});return a}function g(b,a){return c.map(a,function(a){return b+" \x3d "+e(a)}).join(" AND ")}function h(b,a,d){if(0===
a.length)return"";a=c.map(a,e);if(1===a.length)return b+(d?" \x3d ":" !\x3d ")+a[0];a=a.join(",");return b+(d?" in ":" not in ")+"("+a+")"}function k(b,a){return h(b,a,!1)}function l(b,a){return h(b,a,!0)}function m(b,a){var d=f(a);a=[];var c=g(b,d["+"]);c&&a.push(c);(c=l(b,d[""]))&&a.push(c);(b=k(b,d["-"]))&&a.push(b);return a.join(" AND ")}function n(b,a){if(a=a.trim())return a=a.split(","),a=c.map(a,function(a){return a.trim()}),m(b,a)}return{buildExpression:function(b,a){if("equality"===b.type)return n(b.fieldName,
a);if("text"===b.type)return b=b.fieldName,a=(a=a.trim())?b+" ~ "+e(a):void 0,a;throw Error("buildExpression does not yet support type: "+b.type);},buildEqualityExpressionFromValuesString:n,buildEqualityExpressionFromValuesArray:m,makeValueMap:f,makePlusCql:g,makeMinusCql:k,makeRegularCql:l}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,d){return{convert:function(c,a){a=b.clone(a);var e=b.map(c.values,d.getUIValue);return{field:a,values:e,negate:c.negate}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(d,g){function f(a,b){a.values=a.values.concat(b.values);return a}return{aggregate:function(a,b){var c=d.filter(a,function(a){return"space.type"===a.field.fieldName});if(0===c.length)return a;if(1<c.length)throw Error("Only a single space.type expression is supported.");b=g.convert(c[0],b);var e=d.filter(a,function(a){return"space"===
a.field.fieldName});a=d.difference(a,c);e.length?e[0]=f(e[0],b):a.push(b);return a},combineSpaceExpressions:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define("confluence-ui-components/js/cql/internal/cql-set-value-helper",["jquery"],function(c){return{setValues:function(a,d){var b=c.Deferred();a.on("change",function(){b.resolve()});a.select2("val",d,!0);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-date-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(f){return{aggregate:function(e){var b=[],c={};e.forEach(function(a){var d=a.field.fieldName;"date"!==a.field.type?b.push(a):c[d]?c[d].expressions.push(a):(a={field:a.field,expressions:[a]},c[d]=a,b.push(a))});return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["jquery","underscore"],function(c,d){function b(a){a.values=d.map(a.values,function(a){return"-"+a})}return{convert:function(a){a=c.extend({},a);"equality"===a.field.type&&("!\x3d"===a.operator?(a.operator="\x3d",b(a)):"notin"===a.operator&&(a.operator="in",b(a)));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(e,k){function l(c,a){if(!a.length)return c;var b=c[0];b||(b=a[0],a=e.rest(a));a.forEach(function(a){b.values=b.values.concat(a.values)});"\x3d"===b.operator&&1<b.values.length&&(b.operator="in");return[b].concat(e.rest(c))}return{aggregate:function(c){var a=[],b={},f={};c.forEach(function(g){var d=g.field.fieldName;e.contains(a,d)||(a.push(d),
b[d]=[],f[d]=[]);var c=k.convert(g);c.operator!==g.operator?f[d].push(c):b[d].push(c)});var h=[];a.forEach(function(a){a=l(b[a],f[a]);h=h.concat(a)});return h}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter",[],function(){function c(a,b,c){b&&(a=a.filter(function(a){return-1<b.indexOf(a.field.fieldName)?c:!c}));return a}return{removeFieldsByName:function(a,b){return c(a,b,!1)},getFieldsByName:function(a,b){return c(a,b,!0)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-filter-field confluence-ui-components/js/cql/internal/cql-filter-select confluence-ui-components/js/cql/internal/cql-space-expression-aggregator confluence-ui-components/js/cql/internal/cql-date-expression-aggregator confluence-ui-components/js/cql/internal/cql-negation-aggregator confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(d,h,f,r,C,D,E,F,G,t,k){function H(c){var d=[];h.each(c,function(c){c.forEach(function(c){c&&(c=c.asCql())&&d.push(c)})});return d.join(" and ")}function v(c,d){return h.find(c,function(c){return c.fieldName===d})}var I=k.CQL;return{build:function(c){function m(a){var b=C.build(a,w);b.onChange(x);a=a.fieldName;e[a]=e[a]||[];e[a].push(b);g.trigger("cql-field-adding",b);a=y.find(".cql-field-"+a+":last");a.length?a.after(b.element):y.append(b.element);return b}function k(a){var b=d.Deferred();
if(!a)return b.resolve(),b;var f={},g=h.findWhere(l,{fieldName:"space"});a=E.aggregate(a,g);a=F.aggregate(a);a=G.aggregate(a);z=t.getFieldsByName(a,c.ignoredFields);a=t.removeFieldsByName(a,c.ignoredFields);var k=[];h.each(a,function(a){var b=a.field.fieldName,c=v(l,b),d=f[b];f[b]="number"===typeof d?d+1:0;b=f[b];d=c.fieldName;(a=(e[d]&&e[d][b||0]||m(c)).setValues(a))&&k.push(a)});d.when.apply(d,k).then(function(){b.resolve()});return b}function u(a){if(a){var b=h.escape(a);a="We can\u0027t load your filters";
b=f.format("Curses! We had trouble with \u0022{0}\u0022. Try refreshing the page, but you may need to re-enter your macro parameters.",b)}else a="We couldn\u0027t load the macro",b="If you refresh your page, we\u0027ll give it another shot.";f.messages.error(".cql-error-container",{title:a,body:b,closeable:!0})}function J(a){a=d.extend({},a,{fixed:!1});a=m(a);if(0===a.element.find(".aui-nav-selected").length)if(0!==a.element.find(".select2-container-multi").length){var b=a.element.find("input.select2-input");
b.focus().click()}else b=a.element.find("a.select2-choice.select2-default"),b.length||(b=d(":input:visible",a.element).first()),b.length||f.log("Unable to focus CQL field: "+a.fieldName),b.focus().mousedown()}var A=c.context||{environment:"macro-browser"},n=c.defaultFieldNames;n||(n=c.defaultFields?c.defaultFields.split(","):[]);var g=d(I().container());c.container&&d(c.container).append(g);var y=g.find(".cql-fields"),B=c.value||c.defaultValue;if(B)var p=r.parseClauses(B);else p=new d.Deferred,p.resolve();
var e={},z={},q=new d.Deferred,x=c.onChange||function(){},w={element:g,loading:q,context:c.context||{environment:"macro-browser",searchType:"content",select2CustomOptions:c.select2CustomOptions||{}},getValue:function(){return H(e)},getIgnoredFields:function(){return z},removeField:function(a){var b=a.fieldName;e[b]=h.without(e[b],a);0===e[b].length&&(delete e[b],x())},fieldArrays:e,fieldRegistry:e},l;r.getFields().done(function(a){l=a;n.forEach(function(a){var b=v(l,a);if(!b)throw Error("Unknown fieldname: "+
a);a=d.extend({fixed:!0},b);m(a)});D.build({onSelection:J,cqlContainer:g,context:A,ignoredFields:c.ignoredFields});p.done(function(a){k(a).done(function(){q.resolve()})}).fail(function(){"search-screen"===A.environment?f.log("Error parsing CQL param from search screen URL: "+c.value):u(c.value);q.resolve()})}).fail(function(){u()});return w}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithName.soyTemplateName = 'CreateContent.avatar.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/user-multiselect.js' */
Confluence.Binder.autocompleteMultiUser=function(c){c=c||document.body;var d=AJS.$,g=function(){var b=d(".select2-drop-active \x3e .select2-results");0===b.children(".select2-result-selectable").length&&b.children(".select2-disabled").length&&b.append('\x3cli class\x3d"select2-no-results"\x3e'+AJS.escapeHtml("No matches found")+"\x3c/li\x3e")};d("input.autocomplete-multiuser[data-autocomplete-bound !\x3d 'true']",c).each(function(){var b=d(this);b.auiSelect2({multiple:!0,minimumInputLength:2,
formatInputTooShort:function(){return "Start typing to search for a user"},ajax:{transport:function(a){var b=a.success;delete a.success;return d.ajax.apply(d.ajax,arguments).done(b).done(g)},data:function(a){return{"max-results":6,query:a}},dataType:"json",url:Confluence.getContextPath()+"/rest/prototype/1/search/user.json",results:function(a){var b=[];d.each(a.result,function(){b.push({id:this.username,userKey:this.userKey,text:this.title,imgSrc:this.thumbnailLink.href})});
return{results:b}},quietMillis:300},formatResult:function(a){return CreateContent.avatar.avatarWithName({size:"small",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},escapeMarkup:function(a){return a},formatSelection:function(a){return CreateContent.avatar.avatarWithName({size:"xsmall",displayName:a.text,userId:a.id,avatarImageUrl:a.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:!0});if(b.data("autofill-user")){var c=AJS.Meta.get("remote-user"),
h=AJS.Meta.get("remote-user-key"),e=AJS.Meta.get("current-user-fullname"),f=AJS.Meta.get("current-user-avatar-url");c&&e&&f&&b.auiSelect2("data",[{id:c,userKey:h,text:e,imgSrc:AJS.contextPath()+f}])}})};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
define("confluence-macro-browser/macro-parameter-serializer",["jquery"],function(h){function e(d){return d.replace(/\\/g,"\\\\").replace(/=/g,"\\=").replace(/[|]/g,"\\|")}return{serialize:function(d){var a=[],b;for(b in d)a.push(e(b)+"="+e(d[b]));return a.join("|")},deserialize:function(d){function a(f,d){for(var c=[],b=[],a,f=f||"",g=0,e=f.length;g<e;g++)a=f[g],"\\"==a?c.push(a+(g+1!=f.length?f[++g]:"")):a==d?(b.push(c.join("")),c=[]):c.push(a);b.push(c.join(""));return b}var b={};h.each(a(d||"",
"|"),function(d,e){var c=a(e,"=");2===c.length&&c[0]&&(b[c[0].replace(/\\(.)/g,"$1")]=c[1].replace(/\\(.)/g,"$1"))});return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-parameter-serializer","Confluence.MacroParameterSerializer");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
define("confluence-macro-browser/macro-browser-fields",["ajs","jquery","underscore","confluence/legacy"],function(g,e,o,i){function n(j,h,l){return function(k,b){if(k.multiple)return j.string(k,b);var a=e(i.Templates.MacroBrowser.macroParameterSelect()),c=e("select",a),b=b||{};b.setValue=b.setValue||function(a){var b=!1;c.find("option").each(function(){if(this.value==a)return b=!0,!1});b?delete c.tempValue:(c.append(e("<option></option>").attr("value",a).text(a+" ("+"Not found"+
")")),c.tempValue=a);try{c.val(a)}catch(m){g.logError(m)}c.change()};a=h(a,c,b);a.updateDependencies=l;a.getData=function(a){if(a.title&&a.spaceKey||a.pageId||a.draftId){var f=c.tempValue||c.val();b.fileTypes&&(a.fileTypes=b.fileTypes);var m=g.contextPath()+(a.draftId?"/json/draftattachmentsearch.action":"/json/attachmentsearch.action");e.getJSON(m,a,function(a){if(!a.error){e("option",c).remove();a=a.attachments;if(!a||!a.length){c.append(e("<option></option>").attr("value","").html("No appropriate attachments"));
c.tempValue&&b.setValue(c.tempValue)}else{for(var d=0,m=a.length;d<m;d++)c.append(e("<option></option>").attr("value",a[d].name).text(a[d].name));f=f||c.tempValue;b.setValue(f||a[0].name)}c.attr("style","")}})}else g.log("Not enough parameters to send attachmentsearch request")};return a}}return function(j){var h=function(b,a,c){var c=c||{},d=c.setValue||function(b){a.val(b)},e=c.getValue||function(){return a.val()};a.change(c.onchange||j.paramChanged);return{paramDiv:b,input:a,setValue:d,getValue:e}},
l=function(b,a,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++)j.fields[a[d]]&&j.fields[a[d]].dependencyUpdated(b,c)},k={updateDependencies:l,username:function(b,a){var a=a||{},c=b.multiple?"autocomplete-multiuser":"autocomplete-user",d=e(i.Templates.MacroBrowser.macroParameter()),f=e("input[type='text']",d);f.addClass(c).attr("data-none-message","Not found");b.required&&f.keyup(j.processRequiredParameters);b.multiple?(i.Binder.autocompleteMultiUser(d),a.setValue=
function(a){f.val(a);for(var a=a.split(","),b=[],c=[],d=0,h=a.length;d<h;d++)b.push(function(a){return e.getJSON(g.contextPath()+"/rest/prototype/1/user/non-system/"+a).done(function(a){a&&a.name&&c.push({id:a.name,text:a.displayName,imgSrc:a.avatarUrl})}).fail(function(b){g.logError("Cannot parse user data for macro browser field with: "+b);c.push({id:a,text:g.format("Unknown User ({0})",a),imgSrc:g.contextPath()+"/images/icons/profilepics/default.png"})})}(a[d]));e.when.apply(e,o.map(b,function(a){var b=
e.Deferred();a.always(function(){b.resolve()});return b.promise()})).done(function(){c.length&&f.auiSelect2("data",c)})}):(f.bind("selected.autocomplete-content",function(c,d){if(a.onselect)a.onselect(d.selection);else a.setValue?a.setValue(d.content.username):(l(b.name,a.dependencies,f.val()),"function"===typeof a.onchange&&a.onchange.apply(f))}),g.Confluence.Binder.autocompleteUserOrGroup(d));return h(d,f,a)},spacekey:function(b,a){if(b.multiple)return k.string(b,a);var a=a||{},c=e(i.Templates.MacroBrowser.macroParameter()),
d=e("input[type='text']",c);d.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","Not found");b.required&&d.keyup(j.processRequiredParameters);d.bind("selected.autocomplete-content",function(c,e){if(a.onselect)a.onselect(e.selection);else a.setValue?a.setValue(e.content.key):(l(b.name,a.dependencies,d.val()),"function"===typeof a.onchange&&a.onchange.apply(d))});g.Confluence.Binder.autocompleteSpace(c);return h(c,d)},attachment:n(k,
h,l),full_attachment:n(k,h,l),"confluence-content":function(b,a){if(b.multiple)return k.string(b,a);a=a||{};b.options=b.options||{};var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input[type='text']",c).attr("data-none-message","Not found").attr("data-template","");b.required&&d.keyup(j.processRequiredParameters);a.onchange=a.onchange||function(){var c=d.val();l(b.name,a.dependencies,c)};a.setValue=a.setValue||function(b){d.val(b);"function"===typeof a.onchange&&
a.onchange.apply(d)};d.bind("selected.autocomplete-content",function(c,e){var f="";"true"==b.options.includeDatePath&&"blogpost"===e.content.type&&(f=e.content.createdDate.date.split("-"),f="/"+f[0]+"/"+f[1]+"/"+f[2].substring(0,2)+"/");var h=e.content.space&&e.content.space.key,i=h&&h!=g.Meta.get("space-key");-1!==e.content.title.indexOf(":")&&(i=!0);f=(i?h+":":"")+f+e.content.title;d.val(f);if(a.onselect)a.onselect(e.selection);else a.setValue(f,d)});b.options.spaceKey&&("@self"===b.options.spaceKey.toLowerCase()&&
(b.options.spaceKey=g.Meta.get("space-key")),d.attr("data-spacekey",b.options.spaceKey));var f=b.options.type;if("string"===typeof f)if("page"==f)d.addClass("autocomplete-page"),g.Confluence.Binder.autocompletePage(c);else if("blogpost"==f)d.addClass("autocomplete-blogpost"),g.Confluence.Binder.autocompleteBlogpost(c);else{if("attachment"===f||"full_attachment"===f)d.addClass("autocomplete-attachment"),g.Confluence.Binder.autocompleteAttachment(c)}else d.addClass("autocomplete-confluence-content"),
g.Confluence.Binder.autocompleteConfluenceContent(c);return h(c,d,a)},string:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input",c);b.required&&d.keyup(j.processRequiredParameters);return h(c,d,a)},"boolean":function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterBoolean()),d=e("input",c),a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&d.prop("checked",!0)};return h(c,d,a)},"enum":function(b,a){if(b.multiple)return k.string(b,
a);var c=e(i.Templates.MacroBrowser.macroParameterSelect()),d=e("select",c);!b.required&&!b.defaultValue&&d.append(e("<option></option>").attr("value",""));e(b.enumValues).each(function(a,c){var g=c;if(b.enumToI18nKeyMapping){var h=[b.pluginKey,b.macroName,"param",b.name,this,"desc"].join(".");b.enumToI18nKeyMapping[c]!==h&&(g=b.enumToI18nKeyMapping[c])}d.append(e("<option></option>").attr("value",this).html(""+g))});return h(c,d,a)},_hidden:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterHidden()).hide(),
d=e("input",c);return h(c,d,a)}};return{Field:h,ParameterFields:k}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-fields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
define("confluence-macro-browser/macro-browser-smartfields",["ajs","confluence/macro-js-overrides"],function(c,f){return function(h,d){var e=function(a){this.fileTypes=a};e.prototype.beforeParamsSet=function(a){!a.page&&(!a.date&&!a.space)&&("page"==c.params.contentType||"blogpost"==c.params.contentType?a.page=c.Editor.getCurrentTitle():"comment"==c.params.contentType&&(a.page=c.params.pageTitle));if(a.date){var b=a.date.split("/");a.page=["",b[2],b[0],b[1],a.page].join("/")}a.space&&(a.page=a.space+
":"+a.page);return a};e.prototype.beforeParamsRetrieved=function(a){if(a.page){var b=a.page.split(":");1<b.length&&(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==c.params.contentType||"blogpost"==c.params.contentType)&&a.page==c.Editor.getCurrentTitle()||"comment"==c.params.contentType&&a.page==c.params.pageTitle)&&delete a.page}return a};e.prototype.fields={attachment:function(a){a=d.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=
function(a,g){c.debug("attachment:dependencyUpdated called: "+a+", "+g);var d=e.prototype.fields._parsePageLink(g);this.getData(d)};return a},full_attachment:function(a){a=d.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){c.debug("attachment:dependencyUpdated called: "+a+", "+d);var f=e.prototype.fields._parsePageLink(d);this.getData(f)};return a},"confluence-content":function(a){return d["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b=
{},a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||c.Meta.get("space-key");b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===c.Editor.getCurrentTitle()&&(b.title="");b.title||(c.params.newPage?b.draftId=c.Meta.get("content-id"):b.pageId=c.params.pageId);return b}};h.activateSmartFieldsAttachmentsOnPage=function(a,b){f.put(a,new e(b))}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-smartfields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
define("confluence-macro-browser/macro-browser-utils",["jquery"],function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-cql.js' */
define("confluence-macro-browser/macro-browser-cql",["ajs","underscore","confluence/templates","confluence-ui-components/js/cql/cql-component","jquery"],function(i,g,m,n,d){function j(b){var a=b.param;return d.extend({},b,a.options,{defaultValue:a.defaultValue||a.options.defaultValue,select2CustomOptions:b.cqlSelect2CustomOptions})}function k(b){return d(m.MacroBrowser.CQL.sections({hasRenderParameters:0<b.renderParams.length}))}return{build:function(b){var a=k(b),e=b.container;e.append(a);e.bind("cql-field-adding",
function(b,c){c.element.addClass("macro-param-div");c.element.find(".cql-field-input").addClass("macro-param-input")});e.addClass("loading");a.filter(".cql-render-heading").find("button").click(function(){var b=d(this),c=b.closest(".cql-render-heading").next(),a=c.is(":visible");a?c.slideUp(300):(c.removeClass("hidden").show(),c=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:c},300));a=a?"Show":"Hide";
b.text(a)});var f,h={param:b.cqlParam,value:b.cqlValue,container:a.filter(".cql-filter-fields"),cqlSelect2CustomOptions:b.cqlSelect2CustomOptions},h=j(h);f=n.build(h);e.data("cqlComponent",f);var l=d.Deferred();f.loading.done(function(){var a=b.cqlParam.options.requiredFields;if(a){var c=a.split(",");g.each(f.fieldRegistry||f.fieldArrays,function(a){var d=!1;g.each(a,function(a){!d&&g.contains(c,a.fieldName)&&(b.flagRequiredParam(a.element),d=!0,a.onChange(b.paramChanged))})})}e.removeClass("loading");
l.resolve()});return{elements:a,loading:l}},_makeCqlComponentOptions:j,_renderCqlSections:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser-cql.soy' */
// This file was automatically generated from macro-browser-cql.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.CQL.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }
if (typeof Confluence.Templates.MacroBrowser.CQL == 'undefined') { Confluence.Templates.MacroBrowser.CQL = {}; }


Confluence.Templates.MacroBrowser.CQL.sections = function(opt_data, opt_ignored) {
  return '<div class="cql-filter-fields"></div>' + ((opt_data.hasRenderParameters) ? '<h4 class="cql-render-heading"><span>' + soy.$$escapeHtml('Options') + '</span>' + aui.buttons.button({type: 'link', text: 'Show', extraAttributes: {type: 'button'}}) + '</h4><div class="cql-render-fields hidden"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.CQL.sections.soyTemplateName = 'Confluence.Templates.MacroBrowser.CQL.sections';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
define("confluence-macro-browser/macro-browser-editor","ajs jquery confluence/legacy confluence-macro-browser/macro-browser-cql confluence/macro-js-overrides underscore".split(" "),function(r,e,q,v,s,t){return function(k){function o(d){var a=e("#macro-insert-container").find(".macro-name").val(),b,c=k,f={},g;g={};for(var h=0,l=d.formDetails.parameters.length;h<l;h++){var j=d.formDetails.parameters[h],i;if(j.type&&j.type.name==="cql")i=e(".macro-input-fields form").data("cqlComponent").getValue();
else{i=e("#macro-param-"+j.name);var n=i.val();i.attr("type")=="checkbox"&&(n=""+i.prop("checked"));i=n}if(i){j.shared&&(f[j.name]=i);if(j.hidden||!j.defaultValue||j.defaultValue!=i)g[j.name]=i}}g[""]&&(b=g[""]);e.extend(g,c.unknownParams);(h=s.getFunction(a,"beforeParamsRetrieved"))&&(g=h(g,d,f));return{name:a,bodyHtml:c.getMacroBody(),params:g,defaultParameterValue:b}}function w(d,a,b){a.pluginKey=d.pluginKey;a.macroName=d.macroName;var c=k,f,g=a.type.name;if(b){var h=b.fields&&b.fields[g];h&&typeof h!==
"function"&&(h=h[a.name]);typeof h==="function"&&(f=h.call(b,a))}if(!f){g in c.ParameterFields&&typeof c.ParameterFields[g]==="function"||(g="string");f=c.ParameterFields[g](a)}c.fields[a.name]=f;b=f.paramDiv;c=f.input;f="macro-param-"+a.name;b.attr("id","macro-param-div-"+a.name);c.addClass("macro-param-input").attr("id",f);a.hidden&&b.hide();c=d.pluginKey;if(a.displayName==k.Utils.makeDefaultKey(c,d.macroName,"param",a.name,"label"))a.displayName=a.name;if(a.description==k.Utils.makeDefaultKey(c,
d.macroName,"param",a.name,"desc"))a.description="";e("label",b).attr("for",f).text(a.displayName);a.required&&u(b);a.description&&b.append(q.Templates.MacroBrowser.macroParameterDesc({description:a.description}));return b}function u(d){var a=d.find("label"),b=a.text()+" *";a.text(b);d.addClass("required")}return{loadMacroInBrowser:function(d){if(!d||!d.formDetails){r.trigger("analytics",{name:"macro-browser.unknown-macro-error"});alert("Could not load unknown macro in the macro browser.")}else{var a=
require("tinymce"),b=k,c=d.formDetails,f=c.macroName,g=s.get(f),h=b.settings.selectedMacro,l=a.confluence.macrobrowser.editedMacroDiv;if(g&&typeof g.opener==="function"){b.close();g.opener({name:f})}else{var a=c.parameters,j=t.find(a,function(a){return a.type.name==="cql"});e("#save-warning-span").addClass("hidden");e("#macro-insert-container .macro-name").val(f);var i=e("#macro-insert-container .macro-input-fields form");i.empty();var n=d.extendedDescription||d.description;if(j)c.documentationLink&&
b.UI.setHelpLink(b.dialog,{href:c.documentationLink});else if(n||c.documentationLink){n=e(q.Templates.MacroBrowser.macroDescription({descriptionHtml:n,documentationLink:c.documentationLink}));i.append(n)}if(c.body&&c.body.bodyType!="NONE"&&l&&e(l).hasClass("editor-inline-macro")){l=d.pluginKey;if(c.body.label==k.Utils.makeDefaultKey(l,f,"body","label"))c.body.label="";if(c.body.description==k.Utils.makeDefaultKey(l,f,"body","desc"))c.body.description="";c=c.body;l=b.selectedMacroDefinition;n=k;f=
e(q.Templates.MacroBrowser.macroBody());l=l?l.body:n.settings.selectedText;e("textarea",f).val(l||"");c.label&&e("label",f).text(c.label);c.description&&f.append(q.Templates.MacroBrowser.macroParameterDesc({description:c.description}));c.hidden&&f.hide();f&&i.append(f)}var m=h?e.extend({},h.params):{},o=i;if(j){var p;g&&g.fields&&(p=e.extend({},g.fields.cqlSelect2CustomOptions));a=t.without(a,j);p=v.build({cqlParam:j,renderParams:a,cqlValue:m.cql,container:i,flagRequiredParam:u,paramChanged:k.paramChanged,
cqlSelect2CustomOptions:p});delete m.cql;o=p.elements.filter(".cql-render-fields");p.loading.done(function(){k.paramChanged();k.Preview.previewMacro(d,h);k.UI.focusOnMacroDetailsFirstInput()})}e(a).each(function(){o.append(w(d,this,g))});g&&typeof g.beforeParamsSet==="function"&&(m=g.beforeParamsSet(m,!h));e(a).each(function(){var a;a=this.name==""?b.selectedMacroDefinition?b.selectedMacroDefinition.defaultParameterValue:this.defaultValue:m[this.name];a!=null?delete m[this.name]:e(this.aliases).each(function(){if(m[this]){a=
m[this];delete m[this]}});if(a==null)a=this.defaultValue;a!=null&&b.fields[this.name].setValue(a)});b.unknownParams=m;e("a",i).click(function(){var a=window.open(this.href,"_blank");a.focus();a.opener=null;return false});e("#macro-browser-dialog:visible").length||b.showBrowserDialog();a={};e.extend(true,a,d);if(!a.formDetails)a.formDetails={};if(!a.formDetails.body)a.formDetails.body={};b.dialog.activeMetadata=a;a.formDetails.body.content=b.settings.selectedMacro?b.settings.selectedMacro.body:a.formDetails.body.bodyType&&
a.formDetails.body.bodyType.toLowerCase()==="plain_text"?b.settings.selectedText:b.settings.selectedHtml}}},getMacroParametersFromForm:function(d){return o(d).params},getMacroDefinitionFromForm:o,processRequiredParameters:function(){if(e(".macro-input-fields form").is(".loading")){r.log("Form still loading - cannot processRequiredParameters");return false}var d=e("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=e(this).val();
return a===null||a===""}).length===0,a=d?"":"disabled",b=a?"addClass":"removeClass";e("#macro-browser-dialog button.ok").prop("disabled",a);e("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",a)[b]("disabled");return d}}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-editor");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
define("confluence-macro-browser/macro-browser-preview",["jquery","ajs","confluence/legacy","confluence/macro-js-overrides"],function(e,b,m,n){return function(d){function h(){return e("#macro-insert-container .macro-preview")}function l(){h().html("")}function i(b){b?(d.UI.showPreviewSpinner(!0),f.disable()):(d.UI.showPreviewSpinner(!1),f.enable())}var f={disable:function(){e("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){e("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};
return{previewMacro:function(j,g){var k=d;l();if(!d.Editor.processRequiredParameters())return b.trigger("analytics",{name:"macro-browser.missing-params-error"}),b.log("previewMacro: missing required params"),!1;"object"!==typeof g&&(g=d.Editor.getMacroDefinitionFromForm(j));var a=g.params,f=n.getFunction(j.macroName,"updateMacroParametersForPreview");f&&(a=f(a));a[""]&&delete a[""];k={contentId:m.getContentId(),macroName:j.macroName,params:a,body:k.getMacroBody(),defaultParameterValue:g.defaultParameterValue,
successCallback:function(a){var c=h().find("iframe")[0],c=c.contentDocument||c.contentWindow.document;c.write(a);c.close();e(c).ready(function(){b.trigger("macro-browser.preview-ready")});e("div.error span.error",c).length&&b.logError("Error rendering macro definition : ");setTimeout(function(){i(!1)},1E3)},errorCallback:function(a){b.logError(a);i(!1)}};a=b.params.staticResourceUrlPrefix+"/blank.html";h().html('<iframe src="'+a+'" frameborder="0" name="macro-browser-preview-frame" id="macro-preview-iframe"></iframe>');
i(!0);d.Rest.fetchMacroPreviewData(k)},removePreviewContainer:l}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preview");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
define("confluence-macro-browser/macro-browser-model",["ajs"],function(h){return function(f){function g(a){a.title==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var b=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=b.join(",");var d=a.description&&a.description.replace(/,/g,
" ")||"";b.push(d);a.keywords=b.join(",");return a}return{loadMacros:function(a){if(a){var b=f;b.metadataList=[];b.aliasMap={};for(var d=0,i=a.length;d<i;d++){var c=a[d],c=g(c);if(c.aliases)for(var e=0,j=c.aliases.length;e<j;e++)c.aliases[e]=c.aliases[e].toLowerCase(),b.aliasMap[c.aliases[e]]=c.macroName.toLowerCase();b.metadataList.push(c)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else h.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
transformMetaDataDefault:g}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-model");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
define("confluence-macro-browser/macro-browser-rest",["jquery","ajs","wrm","confluence/api/constants"],function(b,f,g,d){function c(a){f.logError(a)}var h=g.data.claim("confluence.macro.metadata.provider:macro-browser-metadata-resources.macro-meta-client-cache-key");return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.macroMetadataClientCacheKey=h;return b.ajax({type:"GET",cache:!0,timeout:a.timeout||3E4,dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros.action",
data:a.data,success:a.successCallback,error:a.errorCallback||c}).promise()},fetchMacroMetadataDetails:function(a){var e={id:a.id};a.alternateId&&(e.alternateId=a.alternateId);b.ajax({type:"GET",dataType:"json",url:(a.context||d.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros-details.action",data:e,success:a.successCallback,error:a.errorCallback||c})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||c)("invalid parameters");b.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:(a.context||d.CONTEXT_PATH)+"/rest/tinymce/1/macro/preview",data:b.toJSON({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||c})}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-rest");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
define("confluence-macro-browser/macro-browser-UI",["jquery","ajs","confluence/legacy","confluence/api/constants"],function(d,e,j,o){return function(k){function m(a){return d(j.Templates.MacroBrowser.macroSummaryList({category:a}))}function p(a,b){var g=d(j.Templates.MacroBrowser.macroSummaryItem());a.icon?g.prepend("<img src='"+((a.icon.relative?e.params.staticResourceUrlPrefix:"")+a.icon.location)+"' alt='icon' width='"+a.icon.width+"' height='"+a.icon.height+"' title='"+a.title+"'/>"):g.prepend("<span class='macro-icon-holder icon-"+
a.macroName+"'></span>");d(".macro-title",g).text(a.title);d(".macro-desc",g).prepend(a.description);if("gadget"==a.macroName){var f=a.gadgetUrl;f&&(f.match("^https?://.*")||(f=o.CONTEXT_PATH+"/"+f),d(".macro-title",g).after(j.Templates.MacroBrowser.gadgetLink({url:f})))}g.click(function(d){b(d,a)});return g}function q(a,b){var d;d=b?j.Templates.Dialog.helpLink(b):j.Templates.MacroBrowser.helpLink();a.getPage(a.curpage).element.find(".dialog-title").prepend(d)}return{createDialog:function(a){for(var b=
a.macros,g=a.onClickMacroSummary,f={all:m("all")},h=0,r=b.length;h<r;h++){var i=b[h];if(i.hidden)if(k.isHiddenMacroShown(i))i.categories.push("hidden-macros");else continue;f.all.append(p(i,g).attr("id",i.id));for(var n=0,s=i.categories.length;n<s;n++){var l=i.categories[n];f[l]=f[l]||m(l);f[l].append(p(i,g).attr("id",l+"-"+i.id))}}var c=e.ConfluenceDialog({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});c.popup.element.on("keydown",".aui-button",
function(a){a.stopPropagation()});c.getPage(0).element.attr("id","select-macro-page");c.addHeader(a.title);c.addPanel("All",f.all,"all","category-button-all").getPanel(0).setPadding(0);b=0;for(g=a.categories.length;b<g;b++)h=a.categories[b],c.addPanel(h.displayName,f[h.name]||m(h.name),h.name,"category-button-"+h.name).getPanel(b+1).setPadding(0);c.addCancel("Cancel",a.onCancel);q(c);"VANILLA"==e.Meta.get("confluence-flavour")?c.addHelpText("<a href='{0}' id='marketplace-link'><span class='icon icon-marketplace'></span>{1}</a>",
[o.CONTEXT_PATH+"/plugins/servlet/upm/marketplace/featured?category=Macros&source=macro_browser","Find more macros..."]):c.addHelpText("Hint: type \u0022\u003cstrong\u003e{\u003c/strong\u003e\u0022 in the Editor to insert macros on the page.");f=d(j.Templates.MacroBrowser.insertMacroPanel());f.find("form").submit(function(a){k.complete();a.stopPropagation();return!1});d("#macro-browser-preview-link",f).click(function(a){d(this).prop("disabled")||k.previewMacro(c.activeMetadata);a.stopPropagation();return!1});c.addPage().addPanel("X",
f,"macro-input-panel").addLink("Select macro",function(a){a.prevPage();a.searcher.focus()},"dialog-back-link").addButton("insert.name",function(){k.complete()},"ok").addCancel("Cancel",function(){return a.onCancel()}).getPanel(0).setPadding(0);c.getPage(1).element.attr("id","macro-details-page");d("#macro-browser-dialog .dialog-button-panel .ok").before("<span id='save-warning-span' class='hidden'></span>");c.searcher=j.DomFilterField({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",
formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,b){var e=null;if(""!=b){c.getCurrentPanel()!=c.getPanel(0)&&c.gotoPanel(0);var f=k.searchSummaries(b),e={};d.each(f,function(){e[this.id]=this})}a.each(function(){!e||this.id in e?d(this).show():d(this).hide()})},submitCallback:function(a,b){""!=b&&1===a.length&&a.click()}});c.page[0].header.append(c.searcher.form);c.page[0].ontabchange=function(a){a!=c.getPanel(0,0)&&c.searcher.reset()};f=d(j.Templates.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:e.Meta.getBoolean("is-admin")}));
c.addPage().addPanel("No macro metadata",f,"missing-metadata-panel").addLink("Back",function(a){a.gotoPage(0);a.searcher.focus()},"dialog-back-link").addCancel("Cancel",function(){return a.onCancel()});c.gotoPage(2);c.addHeader("No macro metadata");c.gotoPanel(0,0);c.ready=!0;return c},showBrowserSpinner:function(a){var b=d("#macro-browser-dialog");a?b.spin("large"):b.spinStop()},
showPreviewSpinner:function(a){var b=d("#macro-browser-preview");a?b.spin("large"):b.spinStop()},updateButtonText:function(a){var b=d("#macro-browser-dialog .dialog-button-panel .ok");"edit"==a?b.text("Save"):b.text("Insert")},enableSaveButton:function(a){d("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},focusOnMacroDetailsFirstInput:function(){var a=d("#macro-insert-container").find(".macro-input-fields :input:visible:not(button,.select2-offscreen)").first();
if(a.length){if(a.hasClass("select2-input")){var b=a.closest(".select2-container").parent().find(".select2-offscreen");if("function"!==typeof b.select2){e.log("select2Hidden is not a select2 hidden input, skipping focus attempt.");return}b.select2("open");b.select2("close")}else a.focus();!k.selectedMacroDefinition&&""!==a.val()&&a.select()}else e.log("No input to focus")},setHelpLink:q}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-UI");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
define("confluence-macro-browser/macro-browser","window jquery ajs confluence-macro-browser/macro-browser-utils confluence-macro-browser/macro-browser-editor confluence-macro-browser/macro-browser-fields confluence-macro-browser/macro-browser-model confluence-macro-browser/macro-browser-preview confluence-macro-browser/macro-browser-rest confluence-macro-browser/macro-browser-UI confluence-macro-browser/macro-browser-smartfields confluence-macro-browser/macro-parameter-serializer confluence/macro-js-overrides underscore".split(" "),
function(k,h,e,r,s,l,t,u,v,w,x,y,i){var a={},l=l(a);a.ParameterFields=l.ParameterFields;a.Field=l.Field;x(a,a.ParameterFields);a.Utils=r;a.Editor=s(a);a.Preview=u(a);a.Model=t(a);a.Rest=v;a.UI=w(a);var f,g=function(b,c){var d={id:b.macroName,successCallback:function(b){if(b&&b.details)b.details=a.Model.transformMetaDataDefault(b.details);a.Editor.loadMacroInBrowser(b.details,c);g.displayDetails();a.Preview.previewMacro(b.details)},errorCallback:function(){e.trigger("analytics",{name:"macro-browser.fetch-metadata-error"});
k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");g.displayDetails()}};if(b.alternateId)d.alternateId=b.alternateId;g.setUI(c,b.title);a.Rest.fetchMacroMetadataDetails(d)};g.setUI=function(b,c){var d=b=="edit"?a.editTitle:a.insertTitle;h("#macro-insert-container").hide();a.UI.updateButtonText(b);a.UI.enableSaveButton(false);a.dialog.gotoPage(1).addHeader(d.replace(/\{0\}/,c));a.dialog.show();a.UI.showBrowserSpinner(true)};g.displayDetails=function(){a.UI.showBrowserSpinner(false);a.UI.enableSaveButton(false);
h("#macro-insert-container").show();a.UI.focusOnMacroDetailsFirstInput()};a.reset=function(){f&&f.resolve&&f.resolve();f=null;a.initMacroBrowserAfterRequest=null;a.initData=null;a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};i.reset();a.Macros=i.elements()};a.getMacroJsOverride=i.get;a.setMacroJsOverride=i.put;a.Macros=i.elements();a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};a.processRequiredParameters=function(){return a.Editor.processRequiredParameters()};a.paramChanged=
function(){a.Editor.processRequiredParameters()};a.loadMacroInBrowser=function(b,c){a.Editor.loadMacroInBrowser(b,c)};a.getMacroDefinitionFromForm=function(b){a.Editor.getMacroDefinitionFromForm(b)};a.getMacroParametersFromForm=function(b){a.Editor.getMacroParametersFromForm(b)};a.previewMacro=function(b){a.Preview.previewMacro(b)};a.previewOnload=function(b){var c=i.getFunction(a.dialog.activeMetadata.macroName,"postPreview");c&&c(h("#macro-preview-iframe")[0],a.dialog.activeMetadata);e.Editor.disableFrame(b);
h(b).click(function(a){if(a.target.tagName.toLowerCase()==="a"){if((a=h(a.target).attr("href"))&&a.indexOf("#")!=0&&a.indexOf(k.location)==-1){a=k.open(a,"_blank");a.focus();a.opener=null}return false}})};a.getMacroMetadata=function(b){for(var c=0,d=a.metadataList.length;c<d;c++){var j=a.metadataList[c];if(j.macroName==b)return j}return null};a.getMetadataPromise=function(){return f};a.open=function(b){if(!b){b={};e.log("No settings to open the macro browser.")}var c=b.selectedMacro;!c&&b.presetMacroMetadata&&
(c={name:b.presetMacroMetadata.macroName});if(c&&c.name){var d=i.getFunction(c.name,"opener");if(d){d(c);return}}if(!a.hasInit){e.debug("init macro browser");a.UI.showBrowserSpinner(true);if(a.initData!==null&&h.isEmptyObject(a.initData)){e.trigger("analytics",{name:"macro-browser.init-reattempt"});e.logError("Macro browser preload failed. Trying again...");a.initMacroBrowserAfterRequest=b;a.preLoadMacro();return}if(a.initData)a.initBrowser();else{e.trigger("analytics",{name:"macro-browser.init-overlap"});
e.debug("Waiting for macro browser preloading...");a.initMacroBrowserAfterRequest=b;return}}a.openMacroBrowser(b)};a.openMacroBrowser=function(b){a.settings=b;a.selectedMacroDefinition=b.selectedMacro;var c=a.selectedMacroDefinition&&a.selectedMacroDefinition.name||b.presetMacroName;if(b.presetMacroName)b.presetMacroMetadata=a.getMacroMetadata(b.presetMacroName);var d=b.presetMacroMetadata;if(!d){var j=b.selectedMacro;if(j){var c=j.name.toLowerCase(),c=a.aliasMap[c]||c,f=i.getFunction(c,"updateSelectedMacro"),
g=i.getFunction(c,"getMacroDetailsFromSelectedMacro");f&&f(j);g&&(d=g(a.metadataList,j));d||(d=a.getMacroMetadata(c))}}j=h("#macro-browser-dialog").find("button.back");if(d){e.debug("Open macro browser to edit macro: "+d.macroName);j.hide();a.replicateSelectMacro(d,b.mode||"edit")}else if(c){j.show();a.dialog.overrideLastTab();a.dialog.gotoPage(2);a.showBrowserDialog()}else{j.show();if(b.selectedCategory){c=h("#select-macro-page .dialog-page-menu button").index(h("#category-button-"+b.selectedCategory));
c<0&&(c=0);a.dialog.overrideLastTab();a.dialog.gotoPanel(0,c)}else a.dialog.gotoPage(0);a.showBrowserDialog();a.dialog.searcher.focusAndSearch(b.searchText)}};a.showBrowserDialog=function(){a.dialog.show();a.UI.showBrowserSpinner(false)};a.complete=function(){if(h("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){var b=a.dialog.activeMetadata,c=i.getFunction(b.macroName,"manipulateMarkup");c&&c(b);b=a.Editor.getMacroDefinitionFromForm(b);a.close();if(a.settings.onComplete)a.settings.onComplete(b)}};
a.cancel=function(){a.close();if(typeof a.settings.onCancel==="function")a.settings.onCancel();return false};a.close=function(){this.unknownParams={};this.fields={};a.Preview.removePreviewContainer();this.dialog.hide()};a.replicateSelectMacro=function(a,c){g(a,c)};a.initBrowser=function(){var b=a.initData;if(!b.categories||!a.metadataList.length){e.trigger("analytics",{name:"macro-browser.init-browser-error"});k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");a.UI.showBrowserSpinner(false);
return false}a.editTitle=b.editTitle;a.insertTitle=b.insertTitle;var c;b.categories=h.map(b.categories,function(a){if(a.name=="hidden-macros"){c=a;return null}return a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&e.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=a.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,onClickMacroSummary:function(a,b){a.preventDefault();g(b,"insert")},onSubmit:a.complete,
onCancel:a.cancel});return a.hasInit=true};a.searchSummaries=function(b,c){var c=h.extend({splitRegex:/[\s-]+/},c),d;d=a.metadataList;var e,f,i,g,m,k,l,p,n,o,q;if(b){e=c&&c.keywordsField||"keywords";f=c&&c.ignoreForCamelCase?"i":"";i=c&&c.matchBoundary?"\\b":"";g=c&&c.splitRegex||/\s+/;g=b.split(g);m=[];g.forEach(function(a){k=[RegExp(i+a,"i")];if(/^([A-Z][a-z]*) {2,}$/.test(this)){l=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");k.push(RegExp(l,f))}m.push(k)});p=[];d.forEach(function(a){for(n=0;n<m.length;n++){q=
false;for(o=0;o<m[n].length;o++)if(m[n][o].test(a[e])){q=true;break}if(!q)return}p.push(a)});d=p}else d=[];return d};a.getMacroBody=function(){var b="";if(h("#macro-insert-container .macro-body-div textarea").length)b=h("#macro-insert-container .macro-body-div textarea").val();else if(a.selectedMacroDefinition){if(a.selectedMacroDefinition.body)b=a.selectedMacroDefinition.body}else if(a.dialog.activeMetadata)b=a.dialog.activeMetadata.formDetails.body.content;return b};a.getMacroParams=function(a){return y.deserialize(a.getAttribute("data-macro-parameters"))};
a.getMacroName=function(a){return!a.hasAttribute("data-macro-name")?void 0:a.getAttribute("data-macro-name")};a.isHiddenMacroShown=function(a){return e.params.showHiddenUserMacros&&a.pluginKey=="_-user-macro-_"};a.hasRequiredParameters=function(a){return a.anyParameterRequired};a.setWhitelist=function(b){a.whitelist=b};a.preLoadMacro=function(){a.initData=null;if(f&&f.state()==="pending")return f;f=a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:false},successCallback:function(b){a.initData=
b;a.Model.loadMacros(b.macros);if(a.initMacroBrowserAfterRequest){a.initBrowser();a.openMacroBrowser(a.initMacroBrowserAfterRequest)}},errorCallback:function(b){e.trigger("analytics",{name:"macro-browser.preload-error"});e.logError("Error requesting macro browser metadata:");e.logError(b);a.initData={}}})};return a});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-browser","AJS.MacroBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_ignored) {
  return '<ol id="category-' + soy.$$escapeHtml(opt_data.category) + '" class="macro-list"></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryList.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryList';
}


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_ignored) {
  return '<li class="macro-list-item"><h4 class="macro-title"></h4>' + Confluence.Templates.MacroBrowser.macroDescription({description: ''}) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryItem.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryItem';
}


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="macro-desc">' + ((opt_data.descriptionHtml) ? soy.$$filterNoAutoescape(opt_data.descriptionHtml) : '') + ((opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml('Documentation') + '</a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroDescription.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroDescription';
}


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div class="macro-preview-container dialog-panel"><div class="macro-preview-header"><ul class="macro-preview-links"><li><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">' + soy.$$escapeHtml('Refresh') + '</a></li></ul><span>' + soy.$$escapeHtml('Preview') + '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.insertMacroPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.insertMacroPanel';
}


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-missing-metadata-container"><p>' + 'There is no metadata configured for this macro which means no configuration screen can be presented here.' + '</p>' + ((opt_data.showAdminMessage) ? '<p>' + AJS.format('If this is a user macro then you can add metadata to the template using the \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eUser Macro Administration\x3c/a\x3e console.',"" + '/admin/usermacros.action') + '</p>' : '<p>' + 'You must contact an administrator to configure metadata for this macro.' + '</p>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel';
}


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><input type="text" class="text"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameter.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameter';
}


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_ignored) {
  return '<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterBoolean.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterBoolean';
}


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><select class="select"></select></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterSelect.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterSelect';
}


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><input type="hidden"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterHidden.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterHidden';
}


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_ignored) {
  return '<div class="macro-param-desc">' + soy.$$filterNoAutoescape(opt_data.description) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterDesc.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterDesc';
}


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_ignored) {
  return '<div class="macro-body-div"><label>' + soy.$$escapeHtml('Body text') + '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroBody.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroBody';
}


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-713/Macros"});
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.helpLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.helpLink';
}


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_ignored) {
  return '<a class=\'macro-uri\' href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.url) + '" target=\'_blank\'>' + soy.$$escapeHtml('Gadget URL') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.gadgetLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.gadgetLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
define("confluence-macro-browser/macro-browser-preload",["jquery","ajs","window"],function(a,b,c){return{macroBrowserPreload:function(){a(c).bind("render-content-loaded",function(c,d){a("#macro-preview-iframe").contents().find("body")[0]==d&&b.MacroBrowser.previewOnload(d)});b.MacroBrowser.preLoadMacro()}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preload",function(a){require("ajs").toInit(a.macroBrowserPreload)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:attachments-insert-utils-resources', location = 'utils/attachments-insert-utils.js' */
define("confluence-editor/utils/attachments-insert-utils",["underscore","confluence/meta","jquery"],function(c,b,d){return{insertFilePlaceholder:function(a,e,f){var g=require("tinymce");a.height="comment"===b.get("content-type")?"150":"250";a.ownerId&&a.ownerId===b.get("content-id")&&(delete a.page,delete a.space,delete a.date);a=c.omit(c.pick(a,"name","page","space","date","height"),function(a){return!a});a={contentId:b.get("content-id")||"0",macro:{name:"view-file",params:a}};g.confluence.MacroUtils.insertMacro(a,
e).done(function(a){f&&d(a).click()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/utils/attachments-insert-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~react~react-dom~table-styles-editor', location = 'vendors~react~react-dom~table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[5],{148:function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;function c(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,i,f=c(e),l=1;l<arguments.length;l++){for(var a in r=Object(arguments[l]))o.call(r,a)&&(f[a]=r[a]);if(n){i=n(r);for(var s=0;s<i.length;s++)u.call(r,i[s])&&(f[i[s]]=r[i[s]])}}return f}},386:function(e,t,r){"use strict";
/** @license React v16.8.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(148),o="function"==typeof Symbol&&Symbol.for,u=o?Symbol.for("react.element"):60103,c=o?Symbol.for("react.portal"):60106,i=o?Symbol.for("react.fragment"):60107,f=o?Symbol.for("react.strict_mode"):60108,l=o?Symbol.for("react.profiler"):60114,a=o?Symbol.for("react.provider"):60109,s=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.concurrent_mode"):60111,y=o?Symbol.for("react.forward_ref"):60112,d=o?Symbol.for("react.suspense"):60113,v=o?Symbol.for("react.memo"):60115,m=o?Symbol.for("react.lazy"):60116,b="function"==typeof Symbol&&Symbol.iterator;function h(e,t,r,n,o,u,c,i){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[r,n,o,u,c,i],l=0;(e=Error(t.replace(/%s/g,(function(){return f[l++]})))).name="Invariant Violation"}throw e.framesToPop=1,e}}function g(e){for(var t=arguments.length-1,r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=0;n<t;n++)r+="&args[]="+encodeURIComponent(arguments[n+1]);h(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",r)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function w(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||S}function j(){}function k(e,t,r){this.props=e,this.context=t,this.refs=_,this.updater=r||S}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&g("85"),this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},j.prototype=w.prototype;var O=k.prototype=new j;O.constructor=k,n(O,w.prototype),O.isPureReactComponent=!0;var $={current:null},x={current:null},C=Object.prototype.hasOwnProperty,P={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var n=void 0,o={},c=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(c=""+t.key),t)C.call(t,n)&&!P.hasOwnProperty(n)&&(o[n]=t[n]);var f=arguments.length-2;if(1===f)o.children=r;else if(1<f){for(var l=Array(f),a=0;a<f;a++)l[a]=arguments[a+2];o.children=l}if(e&&e.defaultProps)for(n in f=e.defaultProps)void 0===o[n]&&(o[n]=f[n]);return{$$typeof:u,type:e,key:c,ref:i,props:o,_owner:x.current}}function R(e){return"object"==typeof e&&null!==e&&e.$$typeof===u}var A=/\/+/g,I=[];function q(e,t,r,n){if(I.length){var o=I.pop();return o.result=e,o.keyPrefix=t,o.func=r,o.context=n,o.count=0,o}return{result:e,keyPrefix:t,func:r,context:n,count:0}}function M(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>I.length&&I.push(e)}function U(e,t,r){return null==e?0:function e(t,r,n,o){var i=typeof t;"undefined"!==i&&"boolean"!==i||(t=null);var f=!1;if(null===t)f=!0;else switch(i){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case u:case c:f=!0}}if(f)return n(o,t,""===r?"."+F(t,0):r),1;if(f=0,r=""===r?".":r+":",Array.isArray(t))for(var l=0;l<t.length;l++){var a=r+F(i=t[l],l);f+=e(i,a,n,o)}else if(null===t||"object"!=typeof t?a=null:a="function"==typeof(a=b&&t[b]||t["@@iterator"])?a:null,"function"==typeof a)for(t=a.call(t),l=0;!(i=t.next()).done;)f+=e(i=i.value,a=r+F(i,l++),n,o);else"object"===i&&g("31","[object Object]"===(n=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":n,"");return f}(e,"",t,r)}function F(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function L(e,t){e.func.call(e.context,t,e.count++)}function N(e,t,r){var n=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?T(e,n,r,(function(e){return e})):null!=e&&(R(e)&&(e=function(e,t){return{$$typeof:u,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(A,"$&/")+"/")+r)),n.push(e))}function T(e,t,r,n,o){var u="";null!=r&&(u=(""+r).replace(A,"$&/")+"/"),U(e,N,t=q(t,u,n,o)),M(t)}function V(){var e=$.current;return null===e&&g("307"),e}var D={Children:{map:function(e,t,r){if(null==e)return e;var n=[];return T(e,n,null,t,r),n},forEach:function(e,t,r){if(null==e)return e;U(e,L,t=q(null,null,t,r)),M(t)},count:function(e){return U(e,(function(){return null}),null)},toArray:function(e){var t=[];return T(e,t,null,(function(e){return e})),t},only:function(e){return R(e)||g("143"),e}},createRef:function(){return{current:null}},Component:w,PureComponent:k,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:y,render:e}},lazy:function(e){return{$$typeof:m,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},useCallback:function(e,t){return V().useCallback(e,t)},useContext:function(e,t){return V().useContext(e,t)},useEffect:function(e,t){return V().useEffect(e,t)},useImperativeHandle:function(e,t,r){return V().useImperativeHandle(e,t,r)},useDebugValue:function(){},useLayoutEffect:function(e,t){return V().useLayoutEffect(e,t)},useMemo:function(e,t){return V().useMemo(e,t)},useReducer:function(e,t,r){return V().useReducer(e,t,r)},useRef:function(e){return V().useRef(e)},useState:function(e){return V().useState(e)},Fragment:i,StrictMode:f,Suspense:d,createElement:E,cloneElement:function(e,t,r){null==e&&g("267",e);var o=void 0,c=n({},e.props),i=e.key,f=e.ref,l=e._owner;if(null!=t){void 0!==t.ref&&(f=t.ref,l=x.current),void 0!==t.key&&(i=""+t.key);var a=void 0;for(o in e.type&&e.type.defaultProps&&(a=e.type.defaultProps),t)C.call(t,o)&&!P.hasOwnProperty(o)&&(c[o]=void 0===t[o]&&void 0!==a?a[o]:t[o])}if(1===(o=arguments.length-2))c.children=r;else if(1<o){a=Array(o);for(var s=0;s<o;s++)a[s]=arguments[s+2];c.children=a}return{$$typeof:u,type:e.type,key:i,ref:f,props:c,_owner:l}},createFactory:function(e){var t=E.bind(null,e);return t.type=e,t},isValidElement:R,version:"16.8.1",unstable_ConcurrentMode:p,unstable_Profiler:l,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:$,ReactCurrentOwner:x,assign:n}},W={default:D},z=W&&D||W;e.exports=z.default||z},66:function(e,t,r){"use strict";e.exports=r(386)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~table-styles-editor', location = 'vendors~table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[34],{2:function(t,e,n){!function(t,e,n){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var r="default"in n?n.default:n;function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){for(var o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];var l=0,u={};i=i.map((function(t){if(n.isValidElement(t)){var e="!PLACEHOLDER_".concat(++l,"!");return u[e]=t,e}return t}));var f=e.apply(void 0,[t].concat(a(i))).split(/(!PLACEHOLDER_\d+!)/g);if(1===f.length)return f.join("");var d=f.map((function(t,e){return r.createElement(n.Fragment,{key:e},e%2?u[t]:t)}));return r.createElement(n.Fragment,null,d)}var i={getText:function(){return console.warn('Call to "getText" function was not replaced with either raw translation or call to "format" function. Have you included the "jsI18n" transformation in Web Resource Manager?'),o.apply(void 0,arguments)}};t.I18n=i,t.format=o,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(393),n(66))}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_table-styles-editor', location = 'table-styles-editor.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[23],{393:function(e,t){e.exports=WRM.format},394:function(e,t,l){},395:function(e,t,l){},403:function(e,t,l){"use strict";l.r(t);var c=l(12),f=l(2);const a={"000000":"Black 100%","172b4d":"Dark grey 100%","42526e":"Medium grey 100%","7a869a":"Medium grey 85%",c1c7d0:"Medium grey 45%",f4f5f7:"Light grey 100%",clear:"Clear fill",bf2600:"Dark red 100%",de350b:"Dark red 85%",ff5630:"Medium red 100%",ff7452:"Medium red 85%",ff8f73:"Medium red 65%",ffbdad:"Light red 100%",ffebe6:"Light red 35%",ff8b00:"Dark orange 100%",ff991f:"Dark orange 85%",ffab00:"Medium orange 100%",ffc400:"Medium yellow 100%",ffe380:"Medium yellow 45%",fff0b3:"Light yellow 100%",fffae6:"Light yellow 35%","006644":"Dark green 100%","00875a":"Dark green 85%","36b37e":"Medium green 100%","57d9a3":"Medium green 65%","79f2c0":"Medium green 45%",abf5d1:"Light green 100%",e3fcef:"Light green 35%","008da6":"Dark teal 100%","00a3bf":"Dark teal 85%","00b8d9":"Medium teal 100%","00c7e6":"Medium teal 85%","79e2f2":"Medium teal 45%",b3f5ff:"Light teal 100%",e6fcff:"Light teal 35%","0747a6":"Dark blue 100%","0052cc":"Dark blue 85%","0065ff":"Medium blue 100%","2684ff":"Medium blue 85%","4c9aff":"Medium blue 65%",b3d4ff:"Light blue 100%",deebff:"Light blue 35%",403294:"Dark purple 100%","5243aa":"Dark purple 85%","6554c0":"Medium purple 100%","8777d9":"Medium purple 85%","998dd9":"Medium purple 65%",c0b6f2:"Light purple 100%",eae6ff:"Light purple 35%"},n=["bf2600","ff8b00","006644","008da6","0747a6","403294","000000","de350b","ff991f","00875a","00a3bf","0052cc","5243aa","172b4d","ff5630","ffab00","36b37e","00b8d9","0065ff","6554c0","42526e","ff7452","ffc400","57d9a3","00c7e6","2684ff","8777d9","7a869a","ff8f73","ffe380","79f2c0","79e2f2","4c9aff","998dd9","c1c7d0","ffbdad","fff0b3","abf5d1","b3f5ff","b3d4ff","c0b6f2","f4f5f7","ffebe6","fffae6","e3fcef","e6fcff","deebff","eae6ff","clear"];l(394),l(395);Object(c.a)("confluence/table-color-names",()=>({colorNames:a,colorValues:n}))}},[[403,0,3,5,34,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_locale', location = 'locale.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[18],{150:function(e,r){e.exports=require("confluence/meta")},402:function(e,r,t){"use strict";t.r(r);var n={};t.r(n),t.d(n,"getUserLocale",(function(){return i}));var c=t(12),o=t(150),a=t.n(o);const i=()=>a.a.get("user-locale").replace("_","-").match(/^([a-zA-Z]{2,5}(-[a-zA-Z]+)?)/)[0];function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object(c.a)("confluence/locale",()=>function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?u(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},n))}},[[402,0,3,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-v4:editor-resources-v4', location = 'build/editor.js' */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="","undefined"!=typeof AJS&&(n.p=AJS.contextPath()+"/download/resources/com.atlassian.confluence.plugins.confluence-editor-v4:assets-06b4af98-771d-4f0b-b324-3bac839993ec/"),n(n.s=0)}({"./node_modules/@atlassian/aui-template/src/template.js":function(e,t,n){var r;"undefined"!=typeof self&&self,void 0===(r=function(){return function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r,o){var i=r;return n.replace(t,(function(e,t,n,r,a){t=t||r,i&&(t+":html"in i?(i=i[t+":html"],o=!0):t in i&&(i=i[t]),a&&"function"==typeof i&&(i=i()))})),null!=i&&i!==r||(i=e),i=String(i),o||(i=a.escape(i)),i},r=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t,!0)})),this},o=function(t){return this.template=this.template.replace(e,(function(e,r){return n(e,r,t)})),this},i=function(){return this.template},a=function(e){function t(){return t.template}return t.template=String(e),t.toString=t.valueOf=i,t.fill=o,t.fillHtml=r,t},c={},u=[];a.load=function(e){if(e=String(e),!c.hasOwnProperty(e)){u.length>=1e3&&delete c[u.shift()],u.push(e);var t=function(e){return document.querySelector('script[title="'+e+'"]')}(e);t&&(c[e]=t.text)}return this(c[e])};var l={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#96;"},s=new RegExp("["+Object.keys(l).join("")+"]","g");return a.escape=function(e){return String(e||"").replace(s,(function(e){return l[e]}))},a}()}.call(t,n,t,e))||(e.exports=r)},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/a11ychecker/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation]{outline:2px dashed;transition:outline-width .1s ease-in-out,background-color .1s ease-in-out}[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation=info]{outline-color:#0747a6;background-color:#deebff}[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation=warning]{outline-color:#ff8b00;background-color:#fffae6}[data-ephox-foam-a11y-violation][data-ephox-foam-a11y-current-violation=error]{outline-color:#bf2600;background-color:#ffebe6}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#charmap-picker{border:0;font-size:16px;font-family:Arial,Helvetica,FreeSans,sans-serif;padding:2px;text-align:center}#charmap-view{padding-right:1em;text-align:left;vertical-align:top}#charmap-info{text-align:center;vertical-align:top;width:100%}#charmap-info>table{border:0;height:100px;padding:0;width:100%}#code-value{font-size:3em}#code-name{font-size:13px}#code-name,#code-value{color:#666;text-align:center}.charmap a:active,.charmap a:hover,.charmap a:link,.charmap a:visited{color:#326ca6;text-decoration:none}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"table.draggable{margin-left:-10px;margin-top:-10px}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{background-color:#777;border-top:1px solid #777;border-left:1px solid #777}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-table{border-right:1px solid #aaa}table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{border-bottom:1px solid #aaa}td.draggable-column,td.draggable-row,td.draggable-table{background-color:transparent;border-top:1px solid transparent;border-left:1px solid transparent;cursor:move}td.draggable-column,td.draggable-table{border-right:1px solid transparent}td.draggable-row,td.draggable-table{border-bottom:1px solid transparent}td.draggable-column{height:10px}td.draggable-row{width:10px}.wiki-content img.confluence-embedded-image,.wiki-content img.editor-inline-macro,.wiki-content table.wysiwyg-macro{cursor:move}.wiki-content table.wysiwyg-macro>tbody>tr>td.wysiwyg-macro-body{cursor:text}#move-indicator{font-weight:400!important}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".quick-comment-form #rte-toolbar .insert-files.toolbar-item{padding:0 6px}.quick-comment-form #rte-toolbar .insert-files .toolbar-trigger{margin:0 -6px}#rte-toolbar .insert-files.toolbar-item{padding:0}#rte-toolbar .insert-files .trigger-text{display:none}#rte-toolbar .insert-files .aui-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,'.aui-dialog .wiki-parser-selector{font-size:14px;margin-right:5px}.insert-wiki-markup-panel div,.insert-wiki-markup-panel div form{height:100%;text-align:center}.insert-wiki-markup-panel .spinner{position:absolute;top:50%;left:50%;margin-top:-73px;margin-left:-60px}#insert-wiki-info-title{text-align:left;margin-left:10px}#insert-wiki-markup-form{height:95%}#insert-wiki-markup-form .wiki-title span{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;margin-bottom:10px;max-width:48%;text-align:left;vertical-align:middle;width:48%}#insert-wiki-markup-form .wiki-title span:first-child{margin-right:20px}#insert-wiki-textarea,#insert-wiki-textarea-preview{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;font-size:14px;height:84%;max-width:48%;vertical-align:middle;width:48%;resize:none}#insert-wiki-textarea.originalDefault{height:100%;min-width:100%;width:100%}#insert-wiki-textarea{font-family:Monaco,Consolas,Courier New,"monospace";margin-right:20px}#insert-wiki-textarea-preview{border:1px solid #ccc;border-radius:3px;position:relative}#insert-wiki-textarea-preview iframe{border:0;height:100%;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%}',""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"body.ios{min-height:150px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-placeholder-property-panel-display-newline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR42rVTPQuFIBT1p1t7e2EFDrXnVmNb4Ca4BS5BW9AfOA+F+wjfAwfpwuHcDzn3olcGIAv5An3fo+u6L55x27bE5P+cZdkWqVJH6pDMsWxTSsFjmqbAMZIC4zjivm9c14XjOLDvO4wx2LYNwzCkBZqmwXmecM7BWgutNdZ1xTzP8LWkQFVVWJYFUspwQUII1HUd2NeSApxzeJRlCfKLovBxYPa6xe9KsedHLc7TXryzidQpnurvZNm/8QMbqb4yyqv4rAAAAABJRU5ErkJggg==);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVR42q1TMQqAMBDr0/UBroJiBUEf0E51dRMcxUlwFBcHPxA5IUuLONSDcDmupO01VQCiEC+gtYagrusH5FVVCfdz0FfRQVVR5CmoLtzfnWBf/R7WWhhjIFnAmvlToOs6XNeF8zyx7zvWdcU8zxjHEW3bhgK8NydaFAWO48C2bViWBdM0YRgGOOcgPc7t9RWyLEPf92ia5hEuyxJ5nj+Lpae+IkkSpGkKZnLW6u/gDHzX+c6kP4j/nfjmNJ8HiP6NN81gzxU6QYojAAAAAElFTkSuQmCC);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button,#property-panel a.macro-placeholder-property-panel-display-newline-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".editor-inline-macro[data-macro-name=status]{background:transparent;border:0;min-height:16px;margin:0;vertical-align:-4px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/styles.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-property-panel-Grey span.icon{background-color:#42526e}#property-panel a.macro-property-panel-Green span.icon{background-color:#00875a}#property-panel a.macro-property-panel-Red span.icon{background-color:#bf2600}#property-panel a.macro-property-panel-Yellow span.icon{background-color:#ff991f}#property-panel a.macro-property-panel-Blue span.icon{background-color:#0052cc}#property-panel a.macro-property-panel-Blue,#property-panel a.macro-property-panel-Brown,#property-panel a.macro-property-panel-Green,#property-panel a.macro-property-panel-Grey,#property-panel a.macro-property-panel-Red,#property-panel a.macro-property-panel-Yellow{padding:6px;display:inline-block}#property-panel a.macro-property-panel-Blue span.icon,#property-panel a.macro-property-panel-Brown span.icon,#property-panel a.macro-property-panel-Green span.icon,#property-panel a.macro-property-panel-Grey span.icon,#property-panel a.macro-property-panel-Red span.icon,#property-panel a.macro-property-panel-Yellow span.icon{display:inline-block;background-image:none;margin:0;border:0;min-width:auto;border-radius:3px;width:16px;height:16px}#property-panel .editable.status-macro-title{margin-right:10px;float:none;text-transform:uppercase;text-decoration:none;width:88px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;padding:0 5px}#property-panel input.editable.status-macro-title{outline:none;height:30px;line-height:20px;vertical-align:bottom;padding-top:2px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/theme-atlassian/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".mce-content-body .mce-visual-caret{background-color:#000;background-color:currentColor;position:absolute}.mce-content-body .mce-visual-caret-hidden{display:none}.mce-content-body [data-mce-caret]{left:-1000px;margin:0;padding:0;position:absolute;right:auto;top:0}.mce-offscreen-selection{left:-2000000px;max-width:1000000px;position:absolute}",""])},"./node_modules/css-loader/dist/runtime/api.js":function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),i=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(i).concat([o]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];null!=i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},"./node_modules/process/browser.js":function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,l=[],s=!1,f=-1;function d(){s&&u&&(s=!1,u.length?l=u.concat(l):f=-1,l.length&&m())}function m(){if(!s){var e=c(d);s=!0;for(var t=l.length;t;){for(u=l,l=[];++f<t;)u&&u[f].run();f=-1,t=l.length}u=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||s||c(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/querystring-es3/decode.js":function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var c=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var l=e.length;u>0&&l>u&&(l=u);for(var s=0;s<l;++s){var f,d,m,p,g=e[s].replace(c,"%20"),h=g.indexOf(n);h>=0?(f=g.substr(0,h),d=g.substr(h+1)):(f=g,d=""),m=decodeURIComponent(f),p=decodeURIComponent(d),r(a,m)?o(a[m])?a[m].push(p):a[m]=[a[m],p]:a[m]=p}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},"./node_modules/querystring-es3/encode.js":function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var c=encodeURIComponent(r(a))+n;return o(e[a])?i(e[a],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[a]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},"./node_modules/querystring-es3/index.js":function(e,t,n){"use strict";t.decode=t.parse=n("./node_modules/querystring-es3/decode.js"),t.encode=t.stringify=n("./node_modules/querystring-es3/encode.js")},"./node_modules/setimmediate/setImmediate.js":function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,a,c,u=1,l={},s=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return l[u]=o,r(u),u++},d.clearImmediate=m}function m(e){delete l[e]}function p(e){if(s)setTimeout(p,0,e);else{var t=l[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{m(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/style-loader/lib/addStyles.js":function(e,t,n){var r,o,i={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=r.apply(this,arguments)),o}),c=function(e,t){return t?t.querySelector(e):document.querySelector(e)},u=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=c.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),l=null,s=0,f=[],d=n("./node_modules/style-loader/lib/urls.js");function m(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(y(r.parts[a],t))}else{var c=[];for(a=0;a<r.parts.length;a++)c.push(y(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:c}}}}function p(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],a=t.base?i[0]+t.base:i[0],c={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}function g(e,t){var n=u(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=f[f.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),f.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=u(e.insertAt.before,n);n.insertBefore(t,o)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=f.indexOf(e);t>=0&&f.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return b(t,e.attrs),g(e,t),t}function b(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function y(e,t){var n,r,o,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var a=s++;n=l||(l=v(t)),r=x.bind(null,n,a,!1),o=x.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",b(t,e.attrs),g(e,t),t}(t),r=S.bind(null,n,t),o=function(){h(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(t),r=k.bind(null,n),o=function(){h(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return m(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o];(c=i[a.id]).refs--,r.push(c)}e&&m(p(e,t),t);for(o=0;o<r.length;o++){var c;if(0===(c=r[o]).refs){for(var u=0;u<c.parts.length;u++)c.parts[u]();delete i[c.id]}}}};var w,C=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function x(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=C(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function k(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function S(e,t,n){var r=n.css,o=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||i)&&(r=d(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),c=e.href;e.href=URL.createObjectURL(a),c&&URL.revokeObjectURL(c)}},"./node_modules/style-loader/lib/urls.js":function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,i=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},"./node_modules/timers-browserify/main.js":function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("./node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/tinymce/plugins/lists/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/lists/plugin.js")},"./node_modules/tinymce/plugins/lists/plugin.js":function(e,t){!function(){"use strict";var e,t,n,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(){},a=function(e){return function(){return e}},c=function(e){return function(t){return!e(t)}},u=a(!1),l=a(!0),s=function(){return f},f=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e};return{fold:function(e,t){return e()},is:u,isSome:u,isNone:l,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:n,orThunk:t,map:s,each:i,bind:s,exists:u,forall:l,filter:s,equals:e,equals_:e,toArray:function(){return[]},toString:a("none()")}}(),d=function(e){var t=a(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return o},m={some:d,none:s,from:function(e){return null==e?f:d(e)}},p=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},g=function(e){return function(t){return typeof t===e}},h=p("string"),v=p("array"),b=g("boolean"),y=g("function"),w=g("number"),C=Array.prototype.slice,x=Array.prototype.push,k=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},S=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},T=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},E=function(e,t,n){return S(e,(function(e){n=t(n,e)})),n},_=function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return m.some(i);if(n(i,r))break}return m.none()},A=function(e,t){return _(e,t,u)},N=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!v(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);x.apply(t,e[n])}return t}(k(e,t))},R=function(e){var t=C.call(e,0);return t.reverse(),t},O=function(e,t){return t>=0&&t<e.length?m.some(e[t]):m.none()},D=function(e){return O(e,0)},I=function(e){return O(e,e.length-1)},P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},B=function(){return M(0,0)},M=function(e,t){return{major:e,minor:t}},L={nu:M,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?B():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return M(r(1),r(2))}(e,n)},unknown:B},F=function(e,t){var n=String(t).toLowerCase();return A(e,(function(e){return e.search(n)}))},j=function(e,t){return F(e,t).map((function(e){var n=L.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},H=function(e,t){return F(e,t).map((function(e){var n=L.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},U=function(e,t){return-1!==e.indexOf(t)},z=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,W=function(e){return function(t){return U(t,e)}},q=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return U(e,"edge/")&&U(e,"chrome")&&U(e,"safari")&&U(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,z],search:function(e){return U(e,"chrome")&&!U(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return U(e,"msie")||U(e,"trident")}},{name:"Opera",versionRegexes:[z,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:W("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:W("firefox")},{name:"Safari",versionRegexes:[z,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(U(e,"safari")||U(e,"mobile/"))&&U(e,"applewebkit")}}],V=[{name:"Windows",search:W("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return U(e,"iphone")||U(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:W("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:W("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:W("linux"),versionRegexes:[]},{name:"Solaris",search:W("sunos"),versionRegexes:[]},{name:"FreeBSD",search:W("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:W("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],$={browsers:a(q),oses:a(V)},K=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},J={unknown:function(){return K({current:void 0,version:L.unknown()})},nu:K,edge:a("Edge"),chrome:a("Chrome"),ie:a("IE"),opera:a("Opera"),firefox:a("Firefox"),safari:a("Safari")},G=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},X={unknown:function(){return G({current:void 0,version:L.unknown()})},nu:G,windows:a("Windows"),ios:a("iOS"),android:a("Android"),linux:a("Linux"),osx:a("OSX"),solaris:a("Solaris"),freebsd:a("FreeBSD"),chromeos:a("ChromeOS")},Y=function(e,t){var n=$.browsers(),r=$.oses(),o=j(n,e).fold(J.unknown,J.nu),i=H(r,e).fold(X.unknown,X.nu),c=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,c=e.isiOS()||e.isAndroid(),u=c||r("(pointer:coarse)"),l=o||!i&&c&&r("(min-device-width:768px)"),s=i||c&&!l,f=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),d=!s&&!l&&!f;return{isiPad:a(o),isiPhone:a(i),isTablet:a(l),isPhone:a(s),isTouch:a(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:a(f),isDesktop:a(d)}}(i,o,e,t);return{browser:o,os:i,deviceType:c}},Q=function(e){return window.matchMedia(e).matches},Z=(e=function(){return Y(navigator.userAgent,Q)},n=!1,function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}),ee=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},te={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ee(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return ee(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return ee(n)},fromDom:ee,fromPoint:function(e,t,n){return m.from(e.dom.elementFromPoint(t,n)).map(ee)}},ne=function(e,t){return e.dom===t.dom},re=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},oe=function(e,t){return Z().browser.isIE()?re(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},ie=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ae=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),ce=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ue=tinymce.util.Tools.resolve("tinymce.util.VK"),le=Object.keys,se=function(e,t){for(var n=le(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},fe=function(e,t){var n={};return function(e,t,n,r){se(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(e,t,function(e){return function(t,n){e[n]=t}}(n),i),n},de=("undefined"!=typeof window?window:Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),me=(r=1,function(e){return function(e){return e.dom.nodeType}(e)===r}),pe=function(e,t){var n=e.dom;se(t,(function(e,t){!function(e,t,n){if(!(h(n)||b(n)||w(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}(n,t,e)}))},ge=function(e){return E(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},he=function(e){return m.from(e.dom.parentNode).map(te.fromDom)},ve=function(e){return k(e.dom.childNodes,te.fromDom)},be=function(e,t){var n=e.dom.childNodes;return m.from(n[t]).map(te.fromDom)},ye=function(e){return be(e,0)},we=function(e){return be(e,e.dom.childNodes.length-1)},Ce=function(e,t){he(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},xe=function(e,t){e.dom.appendChild(t.dom)},ke=function(e,t){S(t,(function(t){xe(e,t)}))},Se=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Te=function(e){return function(e,t){return te.fromDom(e.dom.cloneNode(t))}(e,!0)},Ee=function(e,t){var n=function(e,t){var n=te.fromTag(t),r=ge(e);return pe(n,r),n}(e,t);Ce(e,n);var r=ve(e);return ke(n,r),Se(e),n},_e=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ae=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ne=function(e){return function(t){return t&&t.nodeName.toLowerCase()===e}},Re=function(e){return function(t){return t&&e.test(t.nodeName)}},Oe=function(e){return e&&3===e.nodeType},De=Re(/^(OL|UL|DL)$/),Ie=Re(/^(OL|UL)$/),Pe=Ne("ol"),Be=Re(/^(LI|DT|DD)$/),Me=Re(/^(DT|DD)$/),Le=Re(/^(TH|TD)$/),Fe=Ne("br"),je=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},He=function(e,t){return e&&e.nodeName in t},Ue=function(e,t,n){var r=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&r},ze=function(e,t){return e.isChildOf(t,e.getRoot())},We=function(e,t){var n,r,o,i=e.dom,a=e.schema.getBlockElements(),c=i.createFragment(),u=function(e){var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t}(e);if(u&&((r=i.create(u)).tagName===u.toUpperCase()&&i.setAttribs(r,function(e){return e.getParam("forced_root_block_attrs",{})}(e)),He(t.firstChild,a)||c.appendChild(r)),t)for(;n=t.firstChild;){var l=n.nodeName;o||"SPAN"===l&&"bookmark"===n.getAttribute("data-mce-type")||(o=!0),He(n,a)?(c.appendChild(n),r=null):u?(r||(r=i.create(u),c.appendChild(r)),r.appendChild(n)):c.appendChild(n)}return u?o||r.appendChild(i.create("br",{"data-mce-bogus":"1"})):c.appendChild(i.create("br")),c},qe=_e.DOM,Ve=function(e,t){ie(t,"dd")?Ee(t,"dt"):ie(t,"dt")&&he(t).each((function(n){return function(e,t,n){var r=qe.select('span[data-mce-type="bookmark"]',t),o=We(e,n),i=qe.createRng();i.setStartAfter(n),i.setEndAfter(t);for(var a,c=i.extractContents(),u=c.firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&e.dom.isEmpty(u)){qe.remove(u);break}e.dom.isEmpty(c)||qe.insertAfter(c,t),qe.insertAfter(o,t),Ue(e.dom,n.parentNode)&&(a=n.parentNode,Ae.each(r,(function(e){a.parentNode.insertBefore(e,n.parentNode)})),qe.remove(a)),qe.remove(n),Ue(e.dom,t)&&qe.remove(t)}(e,n.dom,t.dom)}))},$e=function(e){ie(e,"dt")&&Ee(e,"dd")},Ke=function(e,t){if(Oe(e))return{container:e,offset:t};var n=ae.getNode(e,t);return Oe(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&Oe(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Oe(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},Je=function(e){var t=e.cloneRange(),n=Ke(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Ke(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},Ge=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Xe=function(e,t){var n=t||e.selection.getStart(!0);return e.dom.getParent(n,"OL,UL,DL",Ze(e,n))},Ye=function(e){var t=Xe(e),n=e.selection.getSelectedBlocks();return function(e,t){return e&&1===t.length&&t[0]===e}(t,n)?function(e){return Ae.grep(e.querySelectorAll("ol,ul,dl"),(function(e){return De(e)}))}(t):Ae.grep(n,(function(e){return De(e)&&t!==e}))},Qe=function(e){var t=e.selection.getSelectedBlocks();return Ae.grep(function(e,t){var n=Ae.map(t,(function(t){var n=e.dom.getParent(t,"li,dd,dt",Ze(e,t));return n||t}));return Ge.unique(n)}(e,t),(function(e){return Be(e)}))},Ze=function(e,t){var n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},et=function(e,t){var n=e.dom.getParents(t,"ol,ul",Ze(e,t));return I(n)},tt=function(e){var t=function(e){var t=et(e,e.selection.getStart()),n=T(e.selection.getSelectedBlocks(),Ie);return t.toArray().concat(n)}(e);return nt(e,t)},nt=function(e,t){var n=k(t,(function(t){return et(e,t).getOr(t)}));return Ge.unique(n)},rt=function(e,t,n){return e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none()},ot=function(e,t,n){return e.fire("ListMutation",{action:t,element:n})},it=function(e,t,n){if(!h(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);(function(e){return void 0!==e.style&&y(e.style.getPropertyValue)})(e)&&e.style.setProperty(t,n)},at=function(e,t){xe(e.item,t.list)},ct=function(e,t){var n={list:te.fromTag(t,e),item:te.fromTag("li",e)};return xe(n.list,n.item),n},ut=function(e,t,n){var r=t.slice(0,n.depth);return I(r).each((function(t){!function(e,t){xe(e.list,t),e.item=t}(t,function(e,t,n){var r=te.fromTag("li",e);return pe(r,t),ke(r,n),r}(e,n.itemAttributes,n.content)),function(e,t){de(e.list)!==t.listType&&(e.list=Ee(e.list,t.listType)),pe(e.list,t.listAttributes)}(t,n)})),r},lt=function(e,t,n){var r,o=function(e,t,n){for(var r=[],o=0;o<n;o++)r.push(ct(e,t.listType));return r}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)at(e[t-1],e[t])}(o),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item,o="list-style-type",i="none",a=void 0,a=r.dom,it(a,o,i);var r,o,i,a;I(e).each((function(e){pe(e.list,t.listAttributes),pe(e.item,t.itemAttributes),ke(e.item,t.content)}))}(o,n),r=o,rt(I(t),D(r),at),t.concat(o)},st=function(e){return ie(e,"OL,UL")},ft=function(e){return ye(e).map(st).getOr(!1)},dt=function(e){return e.depth>0},mt=function(e){return e.isSelected},pt=function(e){var t=ve(e),n=we(e).map(st).getOr(!1)?t.slice(0,-1):t;return k(n,Te)},gt=function(e){return S(e,(function(t,n){(function(e,t){var n=e[t].depth,r=function(e){return e.depth===n&&!e.dirty},o=function(e){return e.depth<n};return _(R(e.slice(0,t)),r,o).orThunk((function(){return _(e.slice(t+1),r,o)}))})(e,n).fold((function(){t.dirty&&function(e){e.listAttributes=fe(e.listAttributes,(function(e,t){return"start"!==t}))}(t)}),(function(e){return r=e,(n=t).listType=r.listType,void(n.listAttributes=P({},r.listAttributes));var n,r}))})),e},ht=function(e,t,n,r){return ye(r).filter(st).fold((function(){t.each((function(e){ne(e.start,r)&&n.set(!0)}));var o=function(e,t,n){return he(e).filter(me).map((function(r){return{depth:t,dirty:!1,isSelected:n,content:pt(e),itemAttributes:ge(e),listAttributes:ge(r),listType:de(r)}}))}(r,e,n.get());t.each((function(e){ne(e.end,r)&&n.set(!1)}));var i=we(r).filter(st).map((function(r){return vt(e,t,n,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return vt(e,t,n,r)}))},vt=function(e,t,n,r){return N(ve(r),(function(r){return(st(r)?vt:ht)(e+1,t,n,r)}))},bt=function(e,t){var n=gt(t);return k(n,(function(t){var n,r,o,i=(n=t.content,o=(r||document).createDocumentFragment(),S(n,(function(e){o.appendChild(e.dom)})),te.fromDom(o));return te.fromDom(We(e,i.dom))}))},yt=function(e,t){var n=gt(t);return function(e,t){var n=E(t,(function(t,n){return n.depth>t.length?lt(e,t,n):ut(e,t,n)}),[]);return D(n).map((function(e){return e.list}))}(e.contentDocument,n).toArray()},wt=function(e,t,n){var r=function(e,t){var n,r=(n=!1,{get:function(){return n},set:function(e){n=e}});return k(e,(function(e){return{sourceList:e,entries:vt(0,t,r,e)}}))}(t,function(e){var t=k(Qe(e),te.fromDom);return rt(A(t,c(ft)),A(R(t),c(ft)),(function(e,t){return{start:e,end:t}}))}(e));S(r,(function(t){!function(e,t){S(T(e,mt),(function(e){return function(e,t){switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0}(t,e)}))}(t.entries,n);var r,o=function(e,t){return N(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],u=t(c);u!==n&&(r.push(o),o=[]),n=u,o.push(c)}return 0!==o.length&&r.push(o),r}(t,dt),(function(t){return D(t).map(dt).getOr(!1)?yt(e,t):bt(e,t)}))}(e,t.entries);S(o,(function(t){ot(e,"Indent"===n?"IndentList":"OutdentList",t.dom)})),r=t.sourceList,S(o,(function(e){Ce(r,e)})),Se(t.sourceList)}))},Ct=function(e,t){var n=k(tt(e),te.fromDom),r=k(function(e){return T(Qe(e),Me)}(e),te.fromDom),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();wt(e,n,t),function(e,t,n){S(n,"Indent"===t?$e:function(t){return Ve(e,t)})}(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(Je(e.selection.getRng())),e.nodeChanged(),o=!0}return o},xt=function(e){return Ct(e,"Indent")},kt=function(e){return Ct(e,"Outdent")},St=function(e){return Ct(e,"Flatten")},Tt=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),Et=_e.DOM,_t=function(e){var t={},n=function(n){var r,o,i;o=e[n?"startContainer":"endContainer"],i=e[n?"startOffset":"endOffset"],1===o.nodeType&&(r=Et.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),n?o.insertBefore(r,o.childNodes[i]):Et.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),t[n?"startContainer":"endContainer"]=o,t[n?"startOffset":"endOffset"]=i};return n(!0),e.collapsed||n(),t},At=function(e){function t(t){var n,r,o;n=o=e[t?"startContainer":"endContainer"],r=e[t?"startOffset":"endOffset"],n&&(1===n.nodeType&&(r=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(n),n=n.parentNode,Et.remove(o),!n.hasChildNodes()&&Et.isBlock(n)&&n.appendChild(Et.create("br"))),e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=r)}t(!0),t();var n=Et.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),Je(n)},Nt=function(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Rt=function(e){return/\btox\-/.test(e.className)},Ot=function(e,t,n){var r=function(e){var r=_(e.parents,De,Le).filter((function(e){return e.nodeName===t&&!Rt(e)})).isSome();n(r)},o=e.dom.getParents(e.selection.getNode());return r({parents:o}),e.on("NodeChange",r),function(){return e.off("NodeChange",r)}},Dt=function(e,t){Ae.each(t,(function(t,n){e.setAttribute(n,t)}))},It=function(e,t,n){!function(e,t,n){var r=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",r)}(e,t,n),function(e,t,n){Dt(t,n["list-attributes"]),Ae.each(e.select("li",t),(function(e){Dt(e,n["list-item-attributes"])}))}(e,t,n)},Pt=function(e,t,n,r){var o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"];for(1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&Fe(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(je(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Bt=function(e,t,n){void 0===n&&(n={});var r=e.selection.getRng(),o="LI",i=Ze(e,e.selection.getStart(!0)),a=e.dom;if("false"!==a.getContentEditable(e.selection.getNode())){"DL"===(t=t.toUpperCase())&&(o="DT");var c=_t(r);Ae.each(function(e,t,n){for(var r,o=[],i=e.dom,a=Pt(e,t,!0,n),c=Pt(e,t,!1,n),u=[],l=a;l&&(u.push(l),l!==c);l=l.nextSibling);return Ae.each(u,(function(t){if(je(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||Fe(t))return Fe(t)&&i.remove(t),void(r=null);var a=t.nextSibling;Tt.isBookmarkNode(t)&&(je(e,a)||!a&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o}(e,r,i),(function(r){var i,c=r.previousSibling;c&&De(c)&&c.nodeName===t&&function(e,t,n){var r=e.getStyle(t,"list-style-type"),o=n?n["list-style-type"]:"";return r===(o=null===o?"":o)}(a,c,n)?(i=c,r=a.rename(r,o),c.appendChild(r)):(i=a.create(t),r.parentNode.insertBefore(i,r),i.appendChild(r),r=a.rename(r,o)),function(e,t,n){Ae.each(n,(function(n){var r;return e.setStyle(t,((r={})[n]="",r))}))}(a,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),It(a,i,n),Lt(e.dom,i)})),e.selection.setRng(At(c))}},Mt=function(e,t,n){return function(e,t){return e&&t&&De(e)&&e.nodeName===t.nodeName}(t,n)&&function(e,t,n){return e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0)}(e,t,n)&&(r=n,t.className===r.className);var r},Lt=function(e,t){var n,r;if(n=t.nextSibling,Mt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,Mt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},Ft=function(e,t,n,r,o){if(t.nodeName!==r||jt(o)){var i=_t(e.selection.getRng(!0));Ae.each([t].concat(n),(function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.dom.rename(t,n);It(e.dom,o,r),ot(e,Nt(n),o)}else It(e.dom,t,r),ot(e,Nt(n),t)}(e,t,r,o)})),e.selection.setRng(At(i))}else St(e)},jt=function(e){return"list-style-type"in e},Ht=function(e,t,n){var r=Xe(e),o=Ye(e);n=n||{},r&&o.length>0?Ft(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||jt(r)||Rt(t)){var o=_t(e.selection.getRng(!0));It(e.dom,t,r);var i=e.dom.rename(t,n);Lt(e.dom,i),e.selection.setRng(At(o)),ot(e,Nt(n),i)}else St(e);else Bt(e,n,r),ot(e,Nt(n),t)}(e,r,t,n)},Ut=_e.DOM,zt=function(e,t){Ae.each(Ae.grep(e.select("ol,ul",t)),(function(t){!function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),Ue(e,r)&&Ut.remove(r)):Ut.setStyle(r,"listStyleType","none")),De(r)&&(n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t)}(e,t)}))},Wt=function(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(Oe(o)&&(n?i<o.data.length:i>0))return o;var a=e.schema.getNonEmptyElements();1===o.nodeType&&(o=ae.getNode(o,i));var c=new ce(o,r);for(n&&function(e,t){return!!Fe(t)&&(e.isBlock(t.nextSibling)&&!Fe(t.previousSibling))}(e.dom,o)&&c.next();o=c[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(a[o.nodeName])return o;if(Oe(o)&&o.data.length>0)return o}},qt=function(e,t){var n=t.childNodes;return 1===n.length&&!De(n[0])&&e.isBlock(n[0])},Vt=function(e,t,n){var r,o=qt(e,n)?n.firstChild:n;if(function(e,t){qt(e,t)&&e.remove(t.firstChild,!0)}(e,t),!Ue(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},$t=function(e,t,n){var r,o=t.parentNode;if(ze(e,t)&&ze(e,n)){De(n.lastChild)&&(r=n.lastChild),o===n.lastChild&&Fe(o.previousSibling)&&e.remove(o.previousSibling);var i=n.lastChild;i&&Fe(i)&&t.hasChildNodes()&&e.remove(i),Ue(e,n,!0)&&e.$(n).empty(),Vt(e,t,n),r&&n.appendChild(r);var a=oe(te.fromDom(n),te.fromDom(t))?e.getParents(t,De,n):[];e.remove(t),S(a,(function(t){Ue(e,t)&&t!==e.getRoot()&&e.remove(t)}))}},Kt=function(e,t,n,r){var o=e.dom;if(o.isEmpty(r))!function(e,t,n){e.dom.$(n).empty(),$t(e.dom,t,n),e.selection.setCursorLocation(n)}(e,n,r);else{var i=_t(t);$t(o,n,r),e.selection.setRng(At(i))}},Jt=function(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=Ze(e,o),a=n.getParent(r.getStart(),"LI",i);if(a){var c=a.parentNode;if(c===e.getBody()&&Ue(n,c))return!0;var u=Je(r.getRng()),l=n.getParent(Wt(e,u,t,i),"LI",i);if(l&&l!==a)return e.undoManager.transact((function(){var n;t?Kt(e,u,l,a):(n=a).parentNode.firstChild===n?kt(e):function(e,t,n,r){var o=_t(t);$t(e.dom,n,r);var i=At(o);e.selection.setRng(i)}(e,u,a,l)})),!0;if(!l&&!t&&0===u.startOffset&&0===u.endOffset)return e.undoManager.transact((function(){St(e)})),!0}return!1},Gt=function(e,t){return Jt(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=Ze(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var a=Je(e.selection.getRng()),c=n.getParent(Wt(e,a,t,o),"LI",o);if(c)return e.undoManager.transact((function(){!function(e,t,n){var r=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),r&&e.isEmpty(r)&&e.remove(r)}(n,i,o),Lt(n,c.parentNode),e.selection.select(c,!0),e.selection.collapse(t)})),!0}return!1}(e,t)},Xt=function(e,t){return e.selection.isCollapsed()?Gt(e,t):function(e){var t=e.selection.getStart(),n=Ze(e,t);return!!(e.dom.getParent(t,"LI,DT,DD",n)||Qe(e).length>0)&&(e.undoManager.transact((function(){e.execCommand("Delete"),zt(e.dom,e.getBody())})),!0)}(e)},Yt=function(e){var t=e.dom,n=Xe(e);Pe(n)&&e.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:t.getAttrib(n,"start")||"1"},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(n){var r=n.getData();e.undoManager.transact((function(){t.setAttrib(Xe(e),"start","1"===r.start?"":r.start)})),n.close()}})},Qt=function(e,t){return function(){var n=e.dom.getParent(e.selection.getStart(),"UL,OL,DL");return n&&n.nodeName===t}},Zt=function(e){(function(e){return e.getParam("lists_indent_on_tab",!0)})(e)&&function(e){e.on("keydown",(function(t){t.keyCode!==ue.TAB||ue.metaKeyPressed(t)||e.undoManager.transact((function(){(t.shiftKey?kt(e):xt(e))&&t.preventDefault()}))}))}(e),function(e){e.on("keydown",(function(t){t.keyCode===ue.BACKSPACE?Xt(e,!1)&&t.preventDefault():t.keyCode===ue.DELETE&&Xt(e,!0)&&t.preventDefault()}))}(e)};o.add("lists",(function(e){return!1===e.hasPlugin("rtc",!0)&&(Zt(e),function(e){e.on("BeforeExecCommand",(function(t){var n=t.command.toLowerCase();"indent"===n?xt(e):"outdent"===n&&kt(e)})),e.addCommand("InsertUnorderedList",(function(t,n){Ht(e,"UL",n)})),e.addCommand("InsertOrderedList",(function(t,n){Ht(e,"OL",n)})),e.addCommand("InsertDefinitionList",(function(t,n){Ht(e,"DL",n)})),e.addCommand("RemoveList",(function(){St(e)})),e.addCommand("mceListProps",(function(){Yt(e)})),e.addQueryStateHandler("InsertUnorderedList",Qt(e,"UL")),e.addQueryStateHandler("InsertOrderedList",Qt(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",Qt(e,"DL"))}(e)),function(e){var t=function(t){return function(){return e.execCommand(t)}};e.hasPlugin("advlist")||(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:function(t){return Ot(e,"OL",t.setActive)}}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:function(t){return Ot(e,"UL",t.setActive)}}))}(e),function(e){var t={text:"List properties...",icon:"ordered-list",onAction:function(){return Yt(e)},onSetup:function(t){return Ot(e,"OL",(function(e){return t.setDisabled(!e)}))}};e.ui.registry.addMenuItem("listprops",t),e.ui.registry.addContextMenu("lists",{update:function(t){var n=Xe(e,t);return Pe(n)?["listprops"]:[]}})}(e),function(e){return{backspaceDelete:function(t){Xt(e,t)}}}(e)}))}()},"./node_modules/tinymce/plugins/paste/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/paste/plugin.js")},"./node_modules/tinymce/plugins/paste/plugin.js":function(e,t){!function(){"use strict";var e,t,n,r,o=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},i=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(){},c=function(e){return function(){return e}},u=c(!1),l=c(!0),s=function(){return f},f=(e=function(e){return e.isNone()},{fold:function(e,t){return e()},is:u,isSome:u,isNone:l,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:n,orThunk:t,map:s,each:a,bind:s,exists:u,forall:l,filter:s,equals:e,equals_:e,toArray:function(){return[]},toString:c("none()")}),d=function(e){var t=c(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:l,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return d(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return o},m={some:d,none:s,from:function(e){return null==e?f:d(e)}},p=function(e){return!function(e){return null==e}(e)},g=(r="function",function(e){return typeof e===r}),h=Array.prototype.slice,v=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},b=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},y=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},w=g(Array.from)?Array.from:function(e){return h.call(e)},C=function(){var e=o(m.none());return{clear:function(){return e.set(m.none())},set:function(t){return e.set(m.some(t))},isSet:function(){return e.get().isSome()},on:function(t){return e.get().each(t)}}},x=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},k=tinymce.util.Tools.resolve("tinymce.Env"),S=tinymce.util.Tools.resolve("tinymce.util.Delay"),T=tinymce.util.Tools.resolve("tinymce.util.Promise"),E=tinymce.util.Tools.resolve("tinymce.util.VK"),_=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},A=tinymce.util.Tools.resolve("tinymce.util.Tools"),N=function(e){return e.getParam("paste_data_images",!1)},R=function(e){return e.getParam("paste_merge_formats",!0)},O=function(e){return e.getParam("paste_retain_style_properties")},D=function(e){return e.getParam("validate")},I=function(e){return e.getParam("allow_html_data_urls",!1,"boolean")},P=function(e){return e.getParam("paste_data_images",!1,"boolean")},B=function(e){return A.explode(e.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},M=function(e){return-1!==e.indexOf("\x3c!-- x-tinymce/html --\x3e")},L=tinymce.util.Tools.resolve("tinymce.html.Entities"),F=function(e,t,n){var r=e.split(/\n\n/),o=function(e,t){var n,r=[],o="<"+e;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&r.push(n+'="'+L.encodeAllRaw(t[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"}(t,n),i="</"+t+">",a=A.map(r,(function(e){return e.split(/\n/).join("<br />")}));return 1===a.length?a[0]:A.map(a,(function(e){return o+e+i})).join("")},j=tinymce.util.Tools.resolve("tinymce.html.DomParser"),H=tinymce.util.Tools.resolve("tinymce.html.Serializer"),U=tinymce.util.Tools.resolve("tinymce.html.Node"),z=tinymce.util.Tools.resolve("tinymce.html.Schema");function W(e,t){return A.each(t,(function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])})),e}function q(e){return e=W(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?" ":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])}function V(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}function $(e){var t;return e=e.replace(/^[\u00a0 ]+/,""),A.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],(function(n){if(n.test(e))return t=!0,!1})),t}function K(e){var t,n,r=1;function o(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=o(e)}while(e=e.next);return t}function i(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0}function a(e,o,a){var c=e._listLevel||r;c!==r&&(c<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===o?t.append(e):(n=n||t,t=new U(o,1),a>1&&t.attr("start",""+a),e.wrap(t)),e.name="li",c>r&&n&&n.lastChild.append(t),r=c,function e(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)do{e(t)}while(t=t.next)}(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)}for(var c=[],u=e.firstChild;null!=u;)if(c.push(u),null!==(u=u.walk()))for(;void 0!==u&&u.parent!==e;)u=u.walk();for(var l=0;l<c.length;l++)if("p"===(e=c[l]).name&&e.firstChild){var s=o(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(s)){a(e,"ul");continue}if($(s)){var f=/([0-9]+)\./.exec(s),d=1;f&&(d=parseInt(f[1],10)),a(e,"ol",d);continue}if(e._listLevel){a(e,"ul",1);continue}t=null}else n=t,t=null}function J(e,t,n,r){var o,i={},a=e.dom.parseStyle(r);return A.each(a,(function(a,c){switch(c){case"mso-list":(o=/\w+ \w+([0-9]+)/i.exec(r))&&(n._listLevel=parseInt(o[1],10)),/Ignore/i.test(a)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":c="text-align";break;case"vert-align":c="vertical-align";break;case"font-color":case"mso-foreground":c="color";break;case"mso-background":case"mso-highlight":c="background";break;case"font-weight":case"font-style":return void("normal"!==a&&(i[c]=a));case"mso-element":if(/^(comment|comment-list)$/i.test(a))return void n.remove()}0!==c.indexOf("mso-comment")?0!==c.indexOf("mso-")&&("all"===O(e)||t&&t[c])&&(i[c]=a):n.remove()})),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new U("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new U("i",1))),(i=e.dom.serializeStyle(i,n.name))||null}var G,X,Y=function(e,t){return function(e){return e.getParam("paste_enable_default_filters",!0)}(e)?function(e,t){var n,r=O(e);r&&(n=A.makeMap(r.split(/[, ]/))),t=W(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}]]);var o=function(e){return e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")}(e),i=z({valid_elements:o,valid_children:"-li[p]"});A.each(i.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var a=j({},i);a.addAttributeFilter("style",(function(t){for(var r,o=t.length;o--;)(r=t[o]).attr("style",J(e,n,r,r.attr("style"))),"span"===r.name&&r.parent&&!r.attributes.length&&r.unwrap()})),a.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)n=(t=e[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),a.addNodeFilter("del",(function(e){for(var t=e.length;t--;)e[t].remove()})),a.addNodeFilter("a",(function(e){for(var t,n,r,o=e.length;o--;)if(n=(t=e[o]).attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()}));var c=a.parse(t);return function(e){return e.getParam("paste_convert_word_fake_lists",!0)}(e)&&K(c),t=H({validate:D(e)},i).serialize(c)}(e,t):t},Q=function(e,t){return{content:e,cancelled:t}},Z=function(e,t,n,r){var o=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})}(e,t,n,r),i=function(e,t){var n=j({},e.schema);n.addNodeFilter("meta",(function(e){A.each(e,(function(e){e.remove()}))}));var r=n.parse(t,{forced_root_block:!1,isRootContent:!0});return H({validate:D(e)},e.schema).serialize(r)}(e,o.content);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?function(e,t,n,r){var o=e.dom.create("div",{style:"display:none"},t),i=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})}(e,o,n,r);return Q(i.node.innerHTML,i.isDefaultPrevented())}(e,i,n,r):Q(i,o.isDefaultPrevented())},ee=function(e,t){return e.insertContent(t,{merge:R(e),paste:!0}),!0},te=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},ne=function(e,t){return te(t)&&v(B(e),(function(e){return x(n=t,r="."+e,n.length-r.length);var n,r}))},re=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!te(t))&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.execCommand("mceInsertLink",!1,t)})),!0}(e,t,n)},oe=function(e,t,n){return!!ne(e,t)&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.insertContent('<img src="'+t+'">')})),!0}(e,t,n)},ie=function(e,t,n){n||!1===function(e){return e.getParam("smart_paste",!0)}(e)?ee(e,t):function(e,t){A.each([re,oe,ee],(function(n){return!0!==n(e,t,ee)}))}(e,t)},ae=function(e){return"\n"===e||"\r"===e},ce=function(e,t){var n,r,o=(n=" ",(r=function(e){return e.getParam("paste_tab_spaces",4,"number")}(e))<=0?"":new Array(r+1).join(n)),i=t.replace(/\t/g,o);return function(e,t,n){return y(e,(function(e){n=t(n,e)})),n}(i,(function(e,t){return function(e){return-1!==" \f\t\v".indexOf(e)}(t)||" "===t?e.pcIsSpace||""===e.str||e.str.length===i.length-1||function(e,t){return t<e.length&&t>=0&&ae(e[t])}(i,e.str.length+1)?{pcIsSpace:!1,str:e.str+" "}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:ae(t),str:e.str+t}}),{pcIsSpace:!1,str:""}).str},ue=function(e,t,n,r){var o=function(e,t,n){var r=V(t),o=r?Y(e,t):t;return Z(e,o,n,r)}(e,t,n);!1===o.cancelled&&ie(e,o.content,r)},le=function(e,t,n){var r=n||M(t);ue(e,function(e){return e.replace("\x3c!-- x-tinymce/html --\x3e","")}(t),r,!1)},se=function(e,t){var n=e.dom.encode(t).replace(/\r\n/g,"\n"),r=function(e,t,n){return t?F(e,!0===t?"p":t,n):function(e){return e.replace(/\r?\n/g,"<br>")}(e)}(ce(e,n),function(e){return e.getParam("forced_root_block")}(e),function(e){return e.getParam("forced_root_block_attrs")}(e));ue(e,r,!1,!0)},fe=function(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&n.length>0&&-1===n.indexOf("data:text/mce-internal,")&&(t["text/plain"]=n)}if(e.types)for(var r=0;r<e.types.length;r++){var o=e.types[r];try{t[o]=e.getData(o)}catch(e){t[o]=""}}}return t},de=function(e,t){return t in e&&e[t].length>0},me=function(e){return de(e,"text/html")||de(e,"text/plain")},pe=(G="mceclip",X=0,function(){return G+X++}),ge=function(e,t){var n,r,o=(n=t.uri,(r=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(n))?{type:r[1],data:decodeURIComponent(r[2])}:{type:null,data:null}),i=o.data,a=o.type,c=pe(),u=t.blob,l=new Image;if(l.src=t.uri,function(e,t){var n=function(e){return e.getParam("images_dataimg_filter")}(e);return!n||n(t)}(e,l)){var s=e.editorUpload.blobCache,f=void 0,d=s.getByData(i,a);if(d)f=d;else{var m=function(e){return e.getParam("images_reuse_filename")}(e)&&p(u.name),g=m?function(e,t){var n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return p(n)?e.dom.encode(n[1]):null}(e,u.name):c,h=m?u.name:void 0;f=s.create(c,u,i,g,h),s.add(f)}le(e,'<img src="'+f.blobUri()+'">',!1)}else le(e,'<img src="'+t.uri+'">',!1)},he=function(e){return T.all(b(e,(function(e){return new T((function(t){var n=function(e){return p(e.getAsFile)}(e)?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)}))})))},ve=function(e){var t=B(e);return function(e){return function(e,t){return x(e,t,0)}(e.type,"image/")&&v(t,(function(t){return n=t,r={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},(A.hasOwn(r,n)?"image/"+r[n]:"image/"+n)===e.type;var n,r}))}},be=function(e,t,n){var r="paste"===t.type?t.clipboardData:t.dataTransfer;if(P(e)&&r){var o=function(e,t){var n=t.items?b(w(t.items),(function(e){return e.getAsFile()})):[],r=t.files?w(t.files):[];return function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n}(n.length>0?n:r,ve(e))}(e,r);if(o.length>0)return t.preventDefault(),he(o).then((function(t){n&&e.selection.setRng(n),y(t,(function(t){ge(e,t)}))})),!0}return!1},ye=function(e){return E.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},we=function(e,t,n){var r,o=C(),i=C();function a(e,n,r,o,i){var a;de(n,"text/html")?a=n["text/html"]:(a=t.getHtml(),i=i||M(a),t.isDefaultContent(a)&&(o=!0)),a=q(a),t.remove();var c=!1===i&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(a),u=ne(e,a);(!a.length||c&&!u)&&(o=!0),(o||u)&&(a=de(n,"text/plain")&&c?n["text/plain"]:function(e){var t=z(),n=j({},t),r="",o=t.getShortEndedElements(),i=A.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements();return e=W(e,[/<!\[[^\]]+\]>/g]),function e(t){var n=t.name,c=t;if("br"!==n){if("wbr"!==n)if(o[n]&&(r+=" "),i[n])r+=" ";else{if(3===t.type&&(r+=t.value),!t.shortEnded&&(t=t.firstChild))do{e(t)}while(t=t.next);a[n]&&c.next&&(r+="\n","p"===n&&(r+="\n"))}}else r+="\n"}(n.parse(e)),r}(a)),t.isDefaultContent(a)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?se(e,a):le(e,a,i)}e.on("keyup",i.clear),e.on("keydown",(function(n){var a=function(e){ye(e)&&!e.isDefaultPrevented()&&t.remove()};if(ye(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&k.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o.set(n),i.set(!0),k.ie&&r)return n.preventDefault(),void function(e,t){e.fire("paste",{ieFake:t})}(e,!0);t.remove(),t.create(),e.once("keyup",a),e.once("paste",(function(){e.off("keyup",a)}))}}));e.on("paste",(function(c){var u=o.isSet()||i.isSet();u&&o.clear();var l=function(e,t){return fe(t.clipboardData||e.getDoc().dataTransfer)}(e,c),s="text"===n.get()||r,f=de(l,"x-tinymce/html");r=!1,c.isDefaultPrevented()||function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length}(c)?t.remove():me(l)||!be(e,c,t.getLastRng()||e.selection.getRng())?(u||c.preventDefault(),!k.ie||u&&!c.ieFake||de(l,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",(function(e){e.stopPropagation()})),e.getDoc().execCommand("Paste",!1,null),l["text/html"]=t.getHtml()),de(l,"text/html")?(c.preventDefault(),f||(f=M(l["text/html"])),a(e,l,u,s,f)):S.setEditorTimeout(e,(function(){a(e,l,u,s,f)}),0)):t.remove()}))},Ce=function(e){return k.ie&&e.inline?document.body:e.getBody()},xe=function(e,t,n){(function(e){return Ce(e)!==e.getBody()})(e)&&e.dom.bind(t,"paste keyup",(function(t){Te(e,n)||e.fire("paste")}))},ke=function(e){return e.dom.get("mcepastebin")},Se=function(e,t){return t===e},Te=function(e,t){var n,r=ke(e);return(n=r)&&"mcepastebin"===n.id&&Se(t,r.innerHTML)},Ee=function(e){var t=o(null);return{create:function(){return function(e,t,n){var r=e.dom,o=e.getBody();t.set(e.selection.getRng());var i=e.dom.add(Ce(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n);(k.ie||k.gecko)&&r.setStyle(i,"left","rtl"===r.getStyle(o,"direction",!0)?65535:-65535),r.bind(i,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),xe(e,i,n),i.focus(),e.selection.select(i,!0)}(e,t,"%MCEPASTEBIN%")},remove:function(){return function(e,t){if(ke(e)){for(var n=void 0,r=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)}(e,t)},getEl:function(){return ke(e)},getHtml:function(){return function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=A.grep(Ce(e).childNodes,(function(e){return"mcepastebin"===e.id})),r=n.shift();A.each(n,(function(e){t(r,e)}));for(var o=e.dom.select("div[id=mcepastebin]",r),i=o.length-1;i>=0;i--){var a=e.dom.create("div");r.insertBefore(a,o[i]),t(a,o[i])}return r?r.innerHTML:""}(e)},getLastRng:function(){return function(e){return e.get()}(t)},isDefault:function(){return Te(e,"%MCEPASTEBIN%")},isDefaultContent:function(e){return Se("%MCEPASTEBIN%",e)}}},_e=function(e,t){var n=Ee(e);return e.on("PreInit",(function(){return function(e,t,n){var r;we(e,t,n),e.parser.addNodeFilter("img",(function(t,n,o){var i=function(e){e.attr("data-mce-object")||r===k.transparentSrc||e.remove()},a=function(e){return 0===e.indexOf("webkit-fake-url")},c=function(e){return 0===e.indexOf("data:")};if(!P(e)&&function(e){return e.data&&!0===e.data.paste}(o))for(var u=t.length;u--;)(r=t[u].attr("src"))&&(a(r)||!I(e)&&c(r))&&i(t[u])}))}(e,n,t)})),{pasteFormat:t,pasteHtml:function(t,n){return le(e,t,n)},pasteText:function(t){return se(e,t)},pasteImageData:function(t,n){return be(e,t,n)},getDataTransferItems:fe,hasHtmlOrText:me,hasContentType:de}},Ae=function(e,t){e.addCommand("mceTogglePlainTextPaste",(function(){!function(e,t){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),_(e,!1)):(t.pasteFormat.set("text"),_(e,!0)),e.focus()}(e,t)})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},Ne=function(e,t,n){if(!function(e){return!1===k.iOS&&"function"==typeof(null==e?void 0:e.setData)}(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData("x-tinymce/html",t),!0}catch(e){return!1}},Re=function(e,t,n,r){Ne(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},Oe=function(e){return function(t,n){var r=function(e){return"\x3c!-- x-tinymce/html --\x3e"+e}(t),o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var a=e.selection.getRng();i.focus();var c=e.dom.createRng();c.selectNodeContents(i),e.selection.setRng(c),S.setTimeout((function(){e.selection.setRng(a),o.parentNode.removeChild(o),n()}),0)}},De=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},Ie=function(e){return!e.selection.isCollapsed()||function(e){return!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody())}(e)},Pe=function(e){e.on("cut",function(e){return function(t){Ie(e)&&Re(t,De(e),Oe(e),(function(){if(k.browser.isChrome()||k.browser.isFirefox()){var t=e.selection.getRng();S.setEditorTimeout(e,(function(){e.selection.setRng(t),e.execCommand("Delete")}),0)}else e.execCommand("Delete")}))}}(e)),e.on("copy",function(e){return function(t){Ie(e)&&Re(t,De(e),Oe(e),(function(){}))}}(e))},Be=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Me=function(e,t){return Be.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},Le=function(e,t){e.focus(),e.selection.setRng(t)};function Fe(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))}function je(e,t){if(!V(t))return t;var n=[];return A.each(e.schema.getBlockElements(),(function(e,t){n.push(t)})),t=W(t,[[new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g"),"$1"]]),t=W(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function He(e,t,n,r){if(r||n)return t;var o,i=function(e){return e.getParam("paste_webkit_styles")}(e);if(!1===function(e){return e.getParam("paste_remove_styles_if_webkit",!0)}(e)||"all"===i)return t;if(i&&(o=i.split(/[, ]/)),o){var a=e.dom,c=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,r){var i=a.parseStyle(a.decode(n)),u={};if("none"===o)return t+r;for(var l=0;l<o.length;l++){var s=i[o[l]],f=a.getStyle(c,o[l],!0);/color/.test(o[l])&&(s=a.toHex(s),f=a.toHex(f)),f!==s&&(u[o[l]]=s)}return(u=a.serializeStyle(u,"span"))?t+' style="'+u+'"'+r:t+r}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,r){return t+' style="'+n+'"'+r}))}function Ue(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))}var ze=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var r=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",r),function(){return e.off("PastePlainTextToggle",r)}}};i.add("paste",(function(e){if(!1===function(e){return!!e.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)}(e)){var t=o(!1),n=o(function(e){return e.getParam("paste_as_text",!1)}(e)?"text":"html"),r=_e(e,n),i=function(e){k.webkit&&Fe(e,He),k.ie&&(Fe(e,je),function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))}(e,Ue))}(e);return function(e,t){e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return e.execCommand("mceTogglePlainTextPaste")},onSetup:ze(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:function(){return e.execCommand("mceTogglePlainTextPaste")},onSetup:ze(e,t)})}(e,r),Ae(e,r),function(e){var t=e.plugins.paste,n=function(e){return e.getParam("paste_preprocess")}(e);n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var r=function(e){return e.getParam("paste_postprocess")}(e);r&&e.on("PastePostProcess",(function(e){r.call(t,t,e)}))}(e),Pe(e),function(e,t,n){(function(e){return e.getParam("paste_block_drop",!1)})(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),N(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),e.on("drop",(function(r){var o=Me(e,r);if(!r.isDefaultPrevented()&&!n.get()){var i,a=t.getDataTransferItems(r.dataTransfer),c=t.hasContentType(a,"x-tinymce/html");if((t.hasHtmlOrText(a)&&(!(i=a["text/plain"])||0!==i.indexOf("file://"))||!t.pasteImageData(r,o))&&o&&function(e){return e.getParam("paste_filter_drop",!0)}(e)){var u=a["mce-internal"]||a["text/html"]||a["text/plain"];u&&(r.preventDefault(),S.setEditorTimeout(e,(function(){e.undoManager.transact((function(){a["mce-internal"]&&e.execCommand("Delete"),Le(e,o),u=q(u),a["text/html"]?t.pasteHtml(u,c):t.pasteText(u)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){N(e)&&!1===n.get()&&(t.preventDefault(),Le(e,Me(e,t))),"dragend"===t.type&&n.set(!1)}))}(e,r,t),function(e,t){return{clipboard:e,quirks:t}}(r,i)}}))}()},"./node_modules/tinymce/plugins/table/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/table/plugin.js")},"./node_modules/tinymce/plugins/table/plugin.js":function(e,t){!function(){"use strict";var e=function(){},t=function(e){return function(){return e}},n=function(e){return e};function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var o,i=function(e){return function(t){return!e(t)}},a=t(!1),c=t(!0),u=function(){return l},l=function(){var n=function(e){return e.isNone()},r=function(e){return e()},o=function(e){return e};return{fold:function(e,t){return e()},is:a,isSome:a,isNone:c,getOr:o,getOrThunk:r,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:o,orThunk:r,map:u,each:e,bind:u,exists:a,forall:c,filter:u,equals:n,equals_:n,toArray:function(){return[]},toString:t("none()")}}(),s=function(e){var n=t(e),r=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:c,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:r,orThunk:r,map:function(t){return s(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:l},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(a,(function(t){return n(e,t)}))}};return i},f={some:s,none:u,from:function(e){return null==e?l:s(e)}},d=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},m=function(e){return function(t){return typeof t===e}},p=d("string"),g=d("object"),h=d("array"),v=m("boolean"),b=(o=void 0,function(e){return o===e}),y=function(e){return!function(e){return null==e}(e)},w=m("function"),C=m("number"),x=Array.prototype.slice,k=Array.prototype.indexOf,S=Array.prototype.push,T=function(e,t){return function(e,t){return k.call(e,t)}(e,t)>-1},E=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},_=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},A=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},N=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},R=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},O=function(e,t,n){return function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}}(e,(function(e){n=t(n,e)})),n},D=function(e,t,n){return N(e,(function(e){n=t(n,e)})),n},I=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return f.some(i);if(n(i,r))break}return f.none()}(e,t,a)},P=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return f.some(n)}return f.none()},B=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!h(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);S.apply(t,e[n])}return t},M=function(e,t){return B(A(e,t))},L=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},F=function(e){return[e]},j=function(e,t){return t>=0&&t<e.length?f.some(e[t]):f.none()},H=function(e){return j(e,e.length-1)},U=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return f.none()},z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function W(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}var q=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}},V=function(){return $(0,0)},$=function(e,t){return{major:e,minor:t}},K={nu:$,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?V():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return $(r(1),r(2))}(e,n)},unknown:V},J=function(e,t){var n=String(t).toLowerCase();return I(e,(function(e){return e.search(n)}))},G=function(e,t){return J(e,t).map((function(e){var n=K.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},X=function(e,t){return J(e,t).map((function(e){var n=K.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Y=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},Q=function(e,t){return-1!==e.indexOf(t)},Z=function(e,t){return Y(e,t,0)},ee=function(e,t){return Y(e,t,e.length-t.length)},te=function(e){return function(t){return t.replace(e,"")}}(/^\s+|\s+$/g),ne=function(e){return e.length>0},re=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,oe=function(e){return function(t){return Q(t,e)}},ie=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Q(e,"edge/")&&Q(e,"chrome")&&Q(e,"safari")&&Q(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,re],search:function(e){return Q(e,"chrome")&&!Q(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Q(e,"msie")||Q(e,"trident")}},{name:"Opera",versionRegexes:[re,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:oe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:oe("firefox")},{name:"Safari",versionRegexes:[re,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Q(e,"safari")||Q(e,"mobile/"))&&Q(e,"applewebkit")}}],ae=[{name:"Windows",search:oe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Q(e,"iphone")||Q(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:oe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:oe("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:oe("linux"),versionRegexes:[]},{name:"Solaris",search:oe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:oe("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:oe("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ce={browsers:t(ie),oses:t(ae)},ue=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},le={unknown:function(){return ue({current:void 0,version:K.unknown()})},nu:ue,edge:t("Edge"),chrome:t("Chrome"),ie:t("IE"),opera:t("Opera"),firefox:t("Firefox"),safari:t("Safari")},se=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},fe={unknown:function(){return se({current:void 0,version:K.unknown()})},nu:se,windows:t("Windows"),ios:t("iOS"),android:t("Android"),linux:t("Linux"),osx:t("OSX"),solaris:t("Solaris"),freebsd:t("FreeBSD"),chromeos:t("ChromeOS")},de=function(e,n){var r=ce.browsers(),o=ce.oses(),i=G(r,e).fold(le.unknown,le.nu),a=X(o,e).fold(fe.unknown,fe.nu),c=function(e,n,r,o){var i=e.isiOS()&&!0===/ipad/i.test(r),a=e.isiOS()&&!i,c=e.isiOS()||e.isAndroid(),u=c||o("(pointer:coarse)"),l=i||!a&&c&&o("(min-device-width:768px)"),s=a||c&&!l,f=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),d=!s&&!l&&!f;return{isiPad:t(i),isiPhone:t(a),isTablet:t(l),isPhone:t(s),isTouch:t(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:t(f),isDesktop:t(d)}}(a,i,e,n);return{browser:i,os:a,deviceType:c}},me=function(e){return window.matchMedia(e).matches},pe=q((function(){return de(navigator.userAgent,me)})),ge=function(){return pe()},he=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},ve={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return he(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return he(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return he(n)},fromDom:he,fromPoint:function(e,t,n){return f.from(e.dom.elementFromPoint(t,n)).map(he)}},be=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ye=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},we=function(e,t){return e.dom===t.dom},Ce=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},xe=function(e,t){return ge().browser.isIE()?Ce(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},ke=be,Se=Object.keys,Te=Object.hasOwnProperty,Ee=function(e,t){for(var n=Se(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},_e=function(e,t){return Ae(e,(function(e,n){return{k:n,v:t(e,n)}}))},Ae=function(e,t){var n={};return Ee(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},Ne=function(t,n){var r={};return function(e,t,n,r){Ee(e,(function(e,o){(t(e,o)?n:r)(e,o)}))}(t,n,function(e){return function(t,n){e[n]=t}}(r),e),r},Re=function(e){return function(e,t){var n=[];return Ee(e,(function(e,r){n.push(t(e,r))})),n}(e,(function(e){return e}))},Oe=function(e,t){return De(e,t)?f.from(e[t]):f.none()},De=function(e,t){return Te.call(e,t)},Ie=["tfoot","thead","tbody","colgroup"],Pe=function(e,t,n){return{element:e,rowspan:t,colspan:n}},Be=function(e,t,n){return{element:e,cells:t,section:n}},Me=function(e,t){return{element:e,isNew:t}},Le=function(e,t){return{cells:e,section:t}},Fe=("undefined"!=typeof window?window:Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),je=function(e){return e.dom.nodeType},He=function(e){return function(t){return je(t)===e}},Ue=function(e){return 8===je(e)||"#comment"===Fe(e)},ze=He(1),We=He(3),qe=He(9),Ve=He(11),$e=function(e){return ve.fromDom(e.dom.ownerDocument)},Ke=function(e){return qe(e)?e:$e(e)},Je=function(e){return f.from(e.dom.parentNode).map(ve.fromDom)},Ge=function(e,t){for(var n=w(t)?t:a,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,c=ve.fromDom(i);if(o.push(c),!0===n(c))break;r=i}return o},Xe=function(e){return f.from(e.dom.previousSibling).map(ve.fromDom)},Ye=function(e){return f.from(e.dom.nextSibling).map(ve.fromDom)},Qe=function(e){return A(e.dom.childNodes,ve.fromDom)},Ze=function(e,t){var n=e.dom.childNodes;return f.from(n[t]).map(ve.fromDom)},et=w(Element.prototype.attachShadow)&&w(Node.prototype.getRootNode),tt=t(et),nt=et?function(e){return ve.fromDom(e.dom.getRootNode())}:Ke,rt=function(e){var t=nt(e);return Ve(t)?f.some(t):f.none()},ot=function(e){return ve.fromDom(e.dom.host)},it=function(e){if(tt()&&y(e.target)){var t=ve.fromDom(e.target);if(ze(t)&&at(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return j(n,0)}}return f.from(e.target)},at=function(e){return y(e.dom.shadowRoot)},ct=function(e){var t=We(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return rt(ve.fromDom(t)).fold((function(){return o.body.contains(t)}),(n=ct,r=ot,function(e){return n(r(e))}))},ut=function(e){var t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return ve.fromDom(t)},lt=function(e,t){var n=[];return N(Qe(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(lt(e,t))})),n},st=function(e,t,n){return function(e,t,n){return R(Ge(e,n),t)}(e,(function(e){return be(e,t)}),n)},ft=function(e,t){return function(e,t){return R(Qe(e),t)}(e,(function(e){return be(e,t)}))},dt=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return ye(n)?[]:A(n.querySelectorAll(e),ve.fromDom)}(t,e)};function mt(e,t,n,r,o){return e(n,r)?f.some(n):w(o)&&o(n)?f.none():t(n,r,o)}var pt=function(e,t,n){for(var r=e.dom,o=w(n)?n:a;r.parentNode;){r=r.parentNode;var i=ve.fromDom(r);if(t(i))return f.some(i);if(o(i))break}return f.none()},gt=function(e,t,n){return pt(e,(function(e){return be(e,t)}),n)},ht=function(e,t){return function(e,t){return I(e.dom.childNodes,(function(e){return t(ve.fromDom(e))})).map(ve.fromDom)}(e,(function(e){return be(e,t)}))},vt=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return ye(n)?f.none():f.from(n.querySelector(e)).map(ve.fromDom)}(t,e)},bt=function(e,t,n){return mt((function(e,t){return be(e,t)}),gt,e,t,n)},yt=function(e,t,n){if(!(p(n)||v(n)||C(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},wt=function(e,t,n){yt(e.dom,t,n)},Ct=function(e,t){var n=e.dom;Ee(t,(function(e,t){yt(n,t,e)}))},xt=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},kt=function(e,t){return f.from(xt(e,t))},St=function(e,t){e.dom.removeAttribute(t)},Tt=function(e){return D(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})},Et=function(e){return void 0!==e.style&&w(e.style.getPropertyValue)},_t=function(e,t,n){if(!p(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Et(e)&&e.style.setProperty(t,n)},At=function(e,t,n){var r=e.dom;_t(r,t,n)},Nt=function(e,t){var n=e.dom;Ee(t,(function(e,t){_t(n,t,e)}))},Rt=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||ct(e)?r:Ot(n,t)},Ot=function(e,t){return Et(e)?e.style.getPropertyValue(t):""},Dt=function(e,t){var n=e.dom,r=Ot(n,t);return f.from(r).filter((function(e){return e.length>0}))},It=function(e,t){!function(e,t){Et(e)&&e.style.removeProperty(t)}(e.dom,t),kt(e,"style").map(te).is("")&&St(e,"style")},Pt=function(e,t,n){return void 0===n&&(n=0),kt(e,t).map((function(e){return parseInt(e,10)})).getOr(n)},Bt=function(e,t){return Pt(e,t,1)},Mt=function(e){return Bt(e,"colspan")>1},Lt=function(e){return Bt(e,"rowspan")>1},Ft=function(e,t){return parseInt(Rt(e,t),10)},jt=t(10),Ht=t(10),Ut=function(e,t){return zt(e,t,c)},zt=function(e,t,n){return M(Qe(e),(function(e){return be(e,t)?n(e)?[e]:[]:zt(e,t,n)}))},Wt=function(e,t){return function(e,t,n){if(void 0===n&&(n=a),n(t))return f.none();if(T(e,Fe(t)))return f.some(t);return gt(t,e.join(","),(function(e){return be(e,"table")||n(e)}))}(["td","th"],e,t)},qt=function(e){return Ut(e,"th,td")},Vt=function(e){return be(e,"colgroup")?ft(e,"col"):M(Jt(e),(function(e){return ft(e,"col")}))},$t=function(e,t){return bt(e,"table",t)},Kt=function(e){return Ut(e,"tr")},Jt=function(e){return $t(e).fold(t([]),(function(e){return ft(e,"colgroup")}))},Gt=function(e,t){return A(e,(function(e){if("colgroup"===Fe(e)){var n=A(Vt(e),(function(e){var t=Pt(e,"span",1);return Pe(e,1,t)}));return Be(e,n,"colgroup")}n=A(qt(e),(function(e){var t=Pt(e,"rowspan",1),n=Pt(e,"colspan",1);return Pe(e,t,n)}));return Be(e,n,t(e))}))},Xt=function(e){return Je(e).map((function(e){var t=Fe(e);return function(e){return T(Ie,e)}(t)?t:"tbody"})).getOr("tbody")},Yt=function(e){var t=Kt(e),n=W(Jt(e),t);return Gt(n,Xt)},Qt=function(e,t){return e+","+t},Zt=function(e,t){var n=M(e.all,(function(e){return e.cells}));return R(n,t)},en=function(e){var t={},n=[],r={},o=0,i=0,a=0;return N(e,(function(e){if("colgroup"===e.section)r=function(e){var t={},n=0;return N(e.cells,(function(e){var r=e.colspan;_(r,(function(o){var i=n+o;t[i]=function(e,t,n){return{element:e,colspan:t,column:n}}(e.element,r,i)})),n+=r})),t}(e);else{var c=[];N(e.cells,(function(e){for(var n=0;void 0!==t[Qt(a,n)];)n++;for(var r=function(e,t,n,r,o){return{element:e,rowspan:t,colspan:n,row:r,column:o}}(e.element,e.rowspan,e.colspan,a,n),o=0;o<e.colspan;o++)for(var u=0;u<e.rowspan;u++){var l=n+o,s=Qt(a+u,l);t[s]=r,i=Math.max(i,l+1)}c.push(r)})),o++,n.push(Be(e.element,c,e.section)),a++}})),{grid:function(e,t){return{rows:e,columns:t}}(o,i),access:t,all:n,columns:r}},tn={fromTable:function(e){var t=Yt(e);return en(t)},generate:en,getAt:function(e,t,n){var r=e.access[Qt(t,n)];return void 0!==r?f.some(r):f.none()},findItem:function(e,t,n){var r=Zt(e,(function(e){return n(t,e.element)}));return r.length>0?f.some(r[0]):f.none()},filterItems:Zt,justCells:function(e){return M(e.all,(function(e){return e.cells}))},justColumns:function(e){return Re(e.columns)},hasColumns:function(e){return Se(e.columns).length>0},getColumnAt:function(e,t){return f.from(e.columns[t])}},nn=function(e,t){var n=t.column,r=t.column+t.colspan-1,o=t.row,i=t.row+t.rowspan-1;return n<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&i>=e.startRow},rn=function(e,t){return t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow},on=function(e,t,n){var r=tn.findItem(e,t,we),o=tn.findItem(e,n,we);return r.bind((function(e){return o.map((function(t){return n=e,r=t,o=Math.min(n.row,r.row),i=Math.min(n.column,r.column),a=Math.max(n.row+n.rowspan-1,r.row+r.rowspan-1),c=Math.max(n.column+n.colspan-1,r.column+r.colspan-1),{startRow:o,startCol:i,finishRow:a,finishCol:c};var n,r,o,i,a,c}))}))},an=function(e,t,n){return on(e,t,n).bind((function(t){return function(e,t){for(var n=!0,o=r(rn,t),i=t.startRow;i<=t.finishRow;i++)for(var a=t.startCol;a<=t.finishCol;a++)n=n&&tn.getAt(e,i,a).exists(o);return n?f.some(t):f.none()}(e,t)}))},cn=function(e,t,n){return on(e,t,n).map((function(t){var n=tn.filterItems(e,r(nn,t));return A(n,(function(e){return e.element}))}))},un=function(e,t){return tn.findItem(e,t,(function(e,t){return xe(t,e)})).map((function(e){return e.element}))},ln=function(e,t,n){return $t(e).bind((function(r){return function(e,t,n,r){return tn.findItem(e,t,we).bind((function(t){var o=n>0?t.row+t.rowspan-1:t.row,i=r>0?t.column+t.colspan-1:t.column;return tn.getAt(e,o+n,i+r).map((function(e){return e.element}))}))}(dn(r),e,t,n)}))},sn=function(e,t,n){var r=dn(e);return cn(r,t,n)},fn=function(e,t,n,r,o){var i=dn(e),a=we(e,n)?f.some(t):un(i,t),c=we(e,o)?f.some(r):un(i,r);return a.bind((function(e){return c.bind((function(t){return cn(i,e,t)}))}))},dn=tn.fromTable,mn=function(e,t){Je(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},pn=function(e,t){Ye(e).fold((function(){Je(e).each((function(e){hn(e,t)}))}),(function(e){mn(e,t)}))},gn=function(e,t){(function(e){return Ze(e,0)})(e).fold((function(){hn(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},hn=function(e,t){e.dom.appendChild(t.dom)},vn=function(e,t){mn(e,t),hn(t,e)},bn=function(e,t){N(t,(function(n,r){var o=0===r?e:t[r-1];pn(o,n)}))},yn=function(e,t){N(t,(function(t){hn(e,t)}))},wn=function(e){e.dom.textContent="",N(Qe(e),(function(e){Cn(e)}))},Cn=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},xn=function(e){var t,n=Qe(e);n.length>0&&(t=e,N(n,(function(e){mn(t,e)}))),Cn(e)};var kn=function(e,t){var n=function(t){return e(t)?f.from(t.dom.nodeValue):f.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(We,"text"),Sn=function(e){return kn.get(e)},Tn=function(e){return kn.getOption(e)},En=function(e,t){return kn.set(e,t)},_n=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function An(){return{up:t({selector:gt,closest:bt,predicate:pt,all:Ge}),down:t({selector:dt,predicate:lt}),styles:t({get:Rt,getRaw:Dt,set:At,remove:It}),attrs:t({get:xt,set:wt,remove:St,copyTo:function(e,t){var n=Tt(e);Ct(t,n)}}),insert:t({before:mn,after:pn,afterAll:bn,append:hn,appendAll:yn,prepend:gn,wrap:vn}),remove:t({unwrap:xn,remove:Cn}),create:t({nu:ve.fromTag,clone:function(e){return ve.fromDom(e.dom.cloneNode(!1))},text:ve.fromText}),query:t({comparePosition:function(e,t){return e.dom.compareDocumentPosition(t.dom)},prevSibling:Xe,nextSibling:Ye}),property:t({children:Qe,name:Fe,parent:Je,document:function(e){return Ke(e).dom},isText:We,isComment:Ue,isElement:ze,getText:Sn,setText:En,isBoundary:function(e){return!!ze(e)&&("body"===Fe(e)||T(_n,Fe(e)))},isEmptyTag:function(e){return!!ze(e)&&T(["br","img","hr","input"],Fe(e))},isNonEditable:function(e){return ze(e)&&"false"===xt(e,"contenteditable")}}),eq:we,is:ke}}var Nn=function(e,t,n,r){var o=t(e,n);return O(r,(function(n,r){var o=t(e,r);return Rn(e,n,o)}),o)},Rn=function(e,t,n){return t.bind((function(t){return n.filter(r(e.eq,t))}))},On=function(e,t,n){return n.length>0?function(e,t,n,r){return r(e,t,n[0],n.slice(1))}(e,t,n,Nn):f.none()},Dn=function(e,t,n,o){void 0===o&&(o=a);var i=[t].concat(e.up().all(t)),c=[n].concat(e.up().all(n)),u=function(e){return P(e,o).fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},l=u(i),s=u(c),f=I(l,(function(t){return E(s,function(e,t){return r(e.eq,t)}(e,t))}));return{firstpath:l,secondpath:s,shared:f}},In=An(),Pn=function(e,t){return On(In,(function(t,n){return e(n)}),t)},Bn=function(e){return gt(e,"table")},Mn=function(e,t,n){var r=function(e){return function(t){return void 0!==n&&n(t)||we(t,e)}};return we(e,t)?f.some({boxes:f.some([e]),start:e,finish:t}):Bn(e).bind((function(o){return Bn(t).bind((function(i){if(we(o,i))return f.some({boxes:sn(o,e,t),start:e,finish:t});if(xe(o,i)){var a=(c=st(t,"td,th",r(o))).length>0?c[c.length-1]:t;return f.some({boxes:fn(o,e,o,t,i),start:e,finish:a})}if(xe(i,o)){var c,u=(c=st(e,"td,th",r(i))).length>0?c[c.length-1]:e;return f.some({boxes:fn(i,e,o,t,i),start:e,finish:u})}return function(e,t,n){return Dn(In,e,t,n)}(e,t).shared.bind((function(a){return bt(a,"table",n).bind((function(n){var a=st(t,"td,th",r(n)),c=a.length>0?a[a.length-1]:t,u=st(e,"td,th",r(n)),l=u.length>0?u[u.length-1]:e;return f.some({boxes:fn(n,e,o,t,i),start:l,finish:c})}))}))}))}))},Ln=function(e,t){var n=dt(e,t);return n.length>0?f.some(n):f.none()},Fn=function(e,t,n){return vt(e,t).bind((function(t){return vt(e,n).bind((function(e){return Pn(Bn,[t,e]).map((function(n){return{first:t,last:e,table:n}}))}))}))},jn=function(e,t,n,r,o){return function(e,t){return I(e,(function(e){return be(e,t)}))}(e,o).bind((function(e){return ln(e,t,n).bind((function(e){return function(e,t){return gt(e,"table").bind((function(n){return vt(n,t).bind((function(t){return Mn(t,e).bind((function(e){return e.boxes.map((function(t){return{boxes:t,start:e.start,finish:e.finish}}))}))}))}))}(e,r)}))}))},Hn=function(e,t){return Ln(e,t)},Un=function(e,t,n){return Fn(e,t,n).bind((function(t){var n=function(t){return we(e,t)},r=gt(t.first,"thead,tfoot,tbody,table",n),o=gt(t.last,"thead,tfoot,tbody,table",n);return r.bind((function(e){return o.bind((function(n){return we(e,n)?function(e,t,n){var r=dn(e);return an(r,t,n)}(t.table,t.first,t.last):f.none()}))}))}))},zn=function(e){if(!h(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return N(e,(function(r,o){var i=Se(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!h(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){var n=arguments.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var u=function(e){var n=Se(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!L(t,(function(e){return T(n,e)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:u,log:function(e){console.log(e,{constructors:t,constructor:a,params:r})}}}})),n},Wn=zn([{none:[]},{multiple:["elements"]},{single:["element"]}]),qn=function(e,t,n,r){return e.fold(t,n,r)},Vn=Wn.none,$n=Wn.multiple,Kn=Wn.single,Jn=tinymce.util.Tools.resolve("tinymce.PluginManager"),Gn=function(e,t,n){var r=e[n].element,o=ve.fromTag("td");hn(o,ve.fromTag("br")),(t?hn:gn)(r,o)},Xn=function(e,t){var n=function(e){return be(e.element,t)},r=Yt(e),o=tn.generate(r),i=function(e,t){var n=e.grid.columns,r=e.grid.rows,o=n,i=0,a=0;return Ee(e.access,(function(e){if(t(e)){var n=e.row,c=n+e.rowspan-1,u=e.column,l=u+e.colspan-1;n<r?r=n:c>i&&(i=c),u<o?o=u:l>a&&(a=l)}})),function(e,t,n,r){return{minRow:e,minCol:t,maxRow:n,maxCol:r}}(r,o,i,a)}(o,n),a="th:not("+t+"),td:not("+t+")",c=zt(e,"th,td",(function(e){return be(e,a)}));return N(c,Cn),function(e,t,n,r){for(var o=t.grid.columns,i=t.grid.rows,a=0;a<i;a++)for(var c=!1,u=0;u<o;u++){if(!(a<n.minRow||a>n.maxRow||u<n.minCol||u>n.maxCol))tn.getAt(t,a,u).filter(r).isNone()?Gn(e,c,a):c=!0}}(r,o,i,n),function(e,t){var n=R(Ut(e,"tr"),(function(e){return 0===e.dom.childElementCount}));N(n,Cn),t.minCol!==t.maxCol&&t.minRow!==t.maxRow||N(Ut(e,"th,td"),(function(e){St(e,"rowspan"),St(e,"colspan")})),St(e,"width"),St(e,"height"),It(e,"width"),It(e,"height")}(e,i),e},Yn=function(e){return"img"===Fe(e)?1:Tn(e).fold((function(){return Qe(e).length}),(function(e){return e.length}))},Qn=["img","br"],Zn=function(e){return Tn(e).filter((function(e){return 0!==e.trim().length||e.indexOf(" ")>-1})).isSome()||T(Qn,Fe(e))},er=function(e){return t=Zn,(n=function(e){for(var r=0;r<e.childNodes.length;r++){var o=ve.fromDom(e.childNodes[r]);if(t(o))return f.some(o);var i=n(e.childNodes[r]);if(i.isSome())return i}return f.none()})(e.dom);var t,n},tr=function(e){return nr(e,Zn)},nr=function(e,t){var n=function(e){for(var r=Qe(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return f.some(i);var a=n(i);if(a.isSome())return a}return f.none()};return n(e)},rr=function(e,t){return ve.fromDom(e.dom.cloneNode(t))},or=function(e){return rr(e,!1)},ir=function(e){return rr(e,!0)},ar=function(e,t){var n=function(e,t){var n=ve.fromTag(t),r=Tt(e);return Ct(n,r),n}(e,t),r=Qe(ir(e));return yn(n,r),n},cr={scope:["row","col"]},ur=function(){var e=ve.fromTag("td");return hn(e,ve.fromTag("br")),e},lr=function(){return ve.fromTag("col")},sr=function(){return ve.fromTag("colgroup")},fr=function(e,t,n){var r=ar(e,t);return Ee(n,(function(e,t){null===e?St(r,t):wt(r,t,e)})),r},dr=function(e){return e},mr=function(e){return function(){return ve.fromTag("tr",e.dom)}},pr=function(e,t,n){var r=function(e,t){var n,r,o,i;n=e.element,r=t,o=n.dom,i=r.dom,Et(o)&&Et(i)&&(i.style.cssText=o.style.cssText),It(t,"height"),1!==e.colspan&&It(e.element,"width")};return{col:function(t){var n=$e(t.element),o=ve.fromTag(Fe(t.element),n.dom);return r(t,o),e(t.element,o),o},colgroup:sr,row:mr(t),cell:function(t){var o=$e(t.element),i=ve.fromTag(Fe(t.element),o.dom),a=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=a.length>0?function(e,t,n){return er(e).map((function(r){var o=n.join(","),i=st(r,o,(function(t){return we(t,e)}));return O(i,(function(e,t){var n=or(t);return St(n,"contenteditable"),hn(e,n),n}),t)})).getOr(t)}(t.element,i,a):i;return hn(c,ve.fromTag("br")),r(t,i),function(e,t){Ee(cr,(function(n,r){return kt(e,r).filter((function(e){return T(n,e)})).each((function(e){return wt(t,r,e)}))}))}(t.element,i),e(t.element,i),i},replace:fr,gap:ur}},gr=function(e){return{col:lr,colgroup:sr,row:mr(e),cell:ur,replace:dr,gap:ur}},hr=function(e){return A(e,ve.fromDom)},vr=function(e){return qn(e.get(),t([]),n,F)},br=function(e){var t=function(e,t){return kt(e,t).exists((function(e){return parseInt(e,10)>1}))},n=vr(e);return n.length>0&&L(n,(function(e){return t(e,"rowspan")||t(e,"colspan")}))?f.some(n):f.none()},yr=function(e,t,n){return qn(t.get(),f.none,(function(t){return t.length<=1?f.none():Un(e,n.firstSelectedSelector,n.lastSelectedSelector).map((function(e){return{bounds:e,cells:t}}))}),f.none)},wr={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Cr=function(e){return{element:e,mergable:f.none(),unmergable:f.none(),selection:[e]}},xr=function(e,t,n){return{element:n,mergable:yr(t,e,wr),unmergable:br(e),selection:vr(e)}},kr=function(t,n,r,o){t.on("BeforeGetContent",(function(r){!0===r.selection&&qn(n.get(),e,(function(e){r.preventDefault(),function(e){return $t(e[0]).map(ir).map((function(e){return[Xn(e,"[data-mce-selected]")]}))}(e).each((function(e){r.content="text"===r.format?function(e){return A(e,(function(e){return e.dom.innerText})).join("")}(e):function(e,t){return A(t,(function(t){return e.selection.serializer.serialize(t.dom,{})})).join("")}(t,e)}))}),e)})),t.on("BeforeSetContent",(function(e){!0===e.selection&&!0===e.paste&&f.from(t.dom.getParent(t.selection.getStart(),"th,td")).each((function(n){var i=ve.fromDom(n);$t(i).each((function(n){var a,c,u,l,s=R((a=e.content,(u=(c||document).createElement("div")).innerHTML=a,Qe(ve.fromDom(u))),(function(e){return"meta"!==Fe(e)}));if(1===s.length&&(l=s[0],"table"===Fe(l))){e.preventDefault();var f=ve.fromDom(t.getDoc()),d=gr(f),m=function(e,t,n){return{element:e,clipboard:t,generators:n}}(i,s[0],d);r.pasteCells(n,m).each((function(e){t.selection.setRng(e),t.focus(),o.clear(n)}))}}))}))}))},Sr=zn([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Tr=z({},Sr),Er=function(e,n,r,o,i){var a=e.slice(0),c=function(e,t){return 0===e.length?Tr.none():1===e.length?Tr.only(0):0===t?Tr.left(0,1):t===e.length-1?Tr.right(t-1,t):t>0&&t<e.length-1?Tr.middle(t-1,t,t+1):Tr.none()}(e,n),u=t(A(a,t(0)));return c.fold(u,(function(e){return o.singleColumnWidth(a[e],r)}),(function(e,t){return i.calcLeftEdgeDeltas(a,e,t,r,o.minCellWidth(),o.isRelative)}),(function(e,t,n){return i.calcMiddleDeltas(a,e,t,n,r,o.minCellWidth(),o.isRelative)}),(function(e,t){return i.calcRightEdgeDeltas(a,e,t,r,o.minCellWidth(),o.isRelative)}))},_r=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t};function Ar(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Rt(n,e);return parseFloat(o)||0}return r},r=function(e,t){return D(t,(function(t,n){var r=Rt(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!C(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Et(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}var Nr,Rr,Or,Dr=Ar("width",(function(e){return e.dom.offsetWidth})),Ir=function(e){return Dr.get(e)},Pr=function(e){return Dr.getOuter(e)},Br=function(e){var t=e.grid,r=_(t.columns,n),o=_(t.rows,n);return A(r,(function(t){return Mr((function(){return M(o,(function(n){return tn.getAt(e,n,t).filter((function(e){return e.column===t})).toArray()}))}),(function(e){return 1===e.colspan}),(function(){return tn.getAt(e,0,t)}))}))},Mr=function(e,t,n){var r=e();return I(r,t).orThunk((function(){return f.from(r[0]).orThunk(n)})).map((function(e){return e.element}))},Lr=function(e){var r=e.grid,o=_(r.rows,n),i=_(r.columns,n);return A(o,(function(n){return Mr((function(){return M(i,(function(r){return tn.getAt(e,n,r).filter((function(e){return e.row===n})).fold(t([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return tn.getAt(e,n,0)}))}))},Fr=function(e,t){if(t<0||t>=e.length-1)return f.none();var n=e[t].fold((function(){var n=function(e){var t=x.call(e,0);return t.reverse(),t}(e.slice(0,t));return U(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return f.some({value:e,delta:0})})),r=e[t+1].fold((function(){var n=e.slice(t+1);return U(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return f.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},jr=function(e,t){return function(n){return"rtl"===Hr(n)?t:e}},Hr=function(e){return"rtl"===Rt(e,"direction")?"rtl":"ltr"},Ur=Ar("height",(function(e){var t=e.dom;return ct(e)?t.getBoundingClientRect().height:t.offsetHeight})),zr=function(e){return Ur.get(e)},Wr=function(e){return Ur.getOuter(e)},qr=function(e,t){return{left:e,top:t,translate:function(n,r){return qr(e+n,t+r)}}},Vr=qr,$r=function(e,t){return void 0!==e?e:void 0!==t?t:0},Kr=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return Vr(n.offsetLeft,n.offsetTop);var i=$r(null==r?void 0:r.pageYOffset,o.scrollTop),a=$r(null==r?void 0:r.pageXOffset,o.scrollLeft),c=$r(o.clientTop,n.clientTop),u=$r(o.clientLeft,n.clientLeft);return Jr(e).translate(a-u,i-c)},Jr=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Vr(n.offsetLeft,n.offsetTop):ct(e)?function(e){var t=e.getBoundingClientRect();return Vr(t.left,t.top)}(t):Vr(0,0)},Gr=function(e,t){return{row:e,y:t}},Xr=function(e,t){return{col:e,x:t}},Yr=function(e){return Kr(e).left+Pr(e)},Qr=function(e){return Kr(e).left},Zr=function(e,t){return Xr(e,Qr(t))},eo=function(e,t){return Xr(e,Yr(t))},to=function(e){return Kr(e).top},no=function(e,t){return Gr(e,to(t))},ro=function(e,t){return Gr(e,to(t)+Wr(t))},oo=function(e,t,n){if(0===n.length)return[];var r=A(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),o=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([o])},io={delta:n,positions:function(e){return oo(no,ro,e)},edge:to},ao=jr({delta:n,edge:Qr,positions:function(e){return oo(Zr,eo,e)}},{delta:function(e){return-e},edge:Yr,positions:function(e){return oo(eo,Zr,e)}}),co={delta:function(e,t){return ao(t).delta(e,t)},positions:function(e,t){return ao(t).positions(e,t)},edge:function(e){return ao(e).edge(e)}},uo={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},lo=(Rr=["Infinity","[0-9]+\\."+(Nr=function(e){return"(?:"+e+")?"})("[0-9]+")+Nr("[eE][+-]?[0-9]+"),"\\.[0-9]+"+Nr("[eE][+-]?[0-9]+"),"[0-9]+"+Nr("[eE][+-]?[0-9]+")].join("|"),new RegExp("^([+-]?(?:"+Rr+"))(.*)$")),so=function(e,t){return f.from(lo.exec(e)).bind((function(e){var n=Number(e[1]),r=e[2];return function(e,t){return E(t,(function(t){return E(uo[t],(function(t){return e===t}))}))}(r,t)?f.some({value:n,unit:r}):f.none()}))},fo=function(){var e=ge().browser;return e.isIE()||e.isEdge()},mo=function(e,t,n){return function(e,t){var n=parseFloat(e);return isNaN(n)?t:n}(Rt(e,t),n)},po=function(e){return fo()?function(e){var t=e.dom.getBoundingClientRect().height;return"border-box"===Rt(e,"box-sizing")?t:t-mo(e,"padding-top",0)-mo(e,"padding-bottom",0)-(mo(e,"border-top-width",0)+mo(e,"border-bottom-width",0))}(e):mo(e,"height",zr(e))},go=function(e){return fo()?function(e){var t=e.dom.getBoundingClientRect().width;return"border-box"===Rt(e,"box-sizing")?t:t-mo(e,"padding-left",0)-mo(e,"padding-right",0)-(mo(e,"border-left-width",0)+mo(e,"border-right-width",0))}(e):mo(e,"width",Ir(e))},ho=/(\d+(\.\d+)?)%/,vo=/(\d+(\.\d+)?)px|em/,bo=function(e,t){var n,r=(n=e,f.from(n.dom.offsetParent).map(ve.fromDom)).getOr(ut($e(e)));return t(e)/t(r)*100},yo=function(e,t){At(e,"width",t+"px")},wo=function(e,t){At(e,"width",t+"%")},Co=function(e,t){At(e,"height",t+"px")},xo=function(e,t,n,r){var o=parseInt(e,10);return ee(e,"%")&&"table"!==Fe(t)?function(e,t,n,r){var o=$t(e).map((function(e){var r=n(e);return Math.floor(t/100*r)})).getOr(t);return r(e,o),o}(t,o,n,r):o},ko=function(e){var t=function(e){return Dt(e,"height").getOrThunk((function(){return po(e)+"px"}))}(e);return t?xo(t,e,zr,Co):zr(e)},So=function(e){return Dt(e,"width").fold((function(){return f.from(xt(e,"width"))}),(function(e){return f.some(e)}))},To=function(e,t){return e/t.pixelWidth()*100},Eo=function(e,t){return So(e).fold((function(){var n=Ir(e);return To(n,t)}),(function(n){return function(e,t,n){var r=ho.exec(t);if(null!==r)return parseFloat(r[1]);var o=go(e);return To(o,n)}(e,n,t)}))},_o=function(e,t){return So(e).fold((function(){return go(e)}),(function(n){return function(e,t,n){var r=vo.exec(t);if(null!==r)return parseInt(r[1],10);var o=ho.exec(t);return null!==o?function(e,t){return e/100*t.pixelWidth()}(parseFloat(o[1]),n):go(e)}(e,n,t)}))},Ao=function(e){return function(e,t,n){return n(e)/Bt(e,t)}(e,"rowspan",ko)},No=function(e,t,n){At(e,"width",t+n)},Ro=function(e){return bo(e,Ir)+"%"},Oo=t(ho),Do=t(vo),Io=(Or="col",function(e){return ze(e)&&Fe(e)===Or}),Po=function(e,t,n){return Dt(e,t).fold((function(){return n(e)+"px"}),(function(e){return e}))},Bo=function(e,t){return Po(e,"width",(function(e){return Io(e)?Ir(e):_o(e,t)}))},Mo=function(e){return Po(e,"height",Ao)},Lo=function(e,t,n,r,o,i){return e.filter(r).fold((function(){return i(Fr(n,t))}),(function(e){return o(e)}))},Fo=function(e,t,r,o,a){var c=Br(e),u=tn.hasColumns(e)?function(e){return A(tn.justColumns(e),(function(e){return f.from(e.element)}))}(e):c,l=[f.some(co.edge(t))].concat(A(co.positions(c,t),(function(e){return e.map((function(e){return e.x}))}))),s=i(Mt);return A(u,(function(e,t){return Lo(e,t,l,s,(function(e){if(function(e){return!Io(e)||Dt(e,"width").isSome()}(e))return r(e,a);var i,u,d=(i=c[t],u=n,null!=i?u(i):f.none());return Lo(d,t,l,s,(function(e){return o(f.some(Ir(e)))}),o)}),o)}))},jo=function(e){return e.map((function(e){return e+"px"})).getOr("")},Ho=function(e,t,n){return Fo(e,t,_o,(function(e){return e.getOrThunk(n.minCellWidth)}),n)},Uo=function(e,t,n,r,o){var a=Lr(e),c=[f.some(n.edge(t))].concat(A(n.positions(a,t),(function(e){return e.map((function(e){return e.y}))})));return A(a,(function(e,t){return Lo(e,t,c,i(Lt),r,o)}))},zo=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},Wo=function(e,t){var n=tn.justCells(e);return A(n,(function(e){var n=zo(e.row,e.row+e.rowspan,t);return{element:e.element,height:n,rowspan:e.rowspan}}))},qo=function(e,t){return tn.hasColumns(e)?function(e,t){var n=tn.justColumns(e);return A(n,(function(e,n){return{element:e.element,width:t[n],colspan:e.colspan}}))}(e,t):function(e,t){var n=tn.justCells(e);return A(n,(function(e){var n=zo(e.column,e.column+e.colspan,t);return{element:e.element,width:n,colspan:e.colspan}}))}(e,t)},Vo=function(e,t,n){var r=qo(e,t);N(r,(function(e){n.setElementWidth(e.element,e.width)}))},$o=function(e,t,n,r,o){var i=tn.fromTable(e),a=o.getCellDelta(t),c=o.getWidths(i,o),u=n===i.grid.columns-1,l=r.clampTableDelta(c,n,a,o.minCellWidth(),u),s=Er(c,n,l,o,r),f=A(s,(function(e,t){return e+c[t]}));Vo(i,f,o),r.resizeTable(o.adjustTableWidth,l,u)},Ko=function(e,t,n,r){var o=tn.fromTable(e),i=function(e,t,n){return Uo(e,t,n,Ao,(function(e){return e.getOrThunk(Ht)}))}(o,e,r),a=A(i,(function(e,r){return n===r?Math.max(t+e,Ht()):e})),c=Wo(o,a),u=function(e,t){return A(e.all,(function(e,n){return{element:e.element,height:t[n]}}))}(o,a);N(u,(function(e){Co(e.element,e.height)})),N(c,(function(e){Co(e.element,e.height)}));var l=O(a,(function(e,t){return e+t}),0);Co(e,l)},Jo=function(e){return A(e,t(0))},Go=function(e,t,n,r,o){return o(e.slice(0,t)).concat(r).concat(o(e.slice(n)))},Xo=function(e){return function(t,n,r,o){if(e(r)){var i=Math.max(o,t[n]-Math.abs(r)),a=Math.abs(i-t[n]);return r>=0?a:-a}return r}},Yo=Xo((function(e){return e<0})),Qo=Xo(c),Zo=function(){var e=function(e,t,n,r){var o=(100+n)/100,i=Math.max(r,(e[t]+n)/o);return A(e,(function(e,n){return(n===t?i:e/o)-e}))},t=function(t,n,r,o,i,a){return a?e(t,n,o,i):function(e,t,n,r,o){var i=Yo(e,t,r,o);return Go(e,t,n+1,[i,0],Jo)}(t,n,r,o,i)};return{resizeTable:function(e,t){return e(t)},clampTableDelta:Yo,calcLeftEdgeDeltas:t,calcMiddleDeltas:function(e,n,r,o,i,a,c){return t(e,r,o,i,a,c)},calcRightEdgeDeltas:function(t,n,r,o,i,a){if(a)return e(t,r,o,i);var c=Yo(t,r,o,i);return Jo(t.slice(0,r)).concat([c])}}},ei=function(e,n){var r=f.from(e.dom.documentElement).map(ve.fromDom).getOr(e);return{parent:t(r),view:t(e),origin:t(Vr(0,0)),isResizable:n}},ti=function(e,n,r){return{parent:t(n),view:t(e),origin:t(Vr(0,0)),isResizable:r}},ni=zn([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),ri=function(e,t,n){var r=n.substring(0,n.length-e.length),o=parseFloat(r);return r===o.toString()?t(o):ni.invalid(n)},oi=z(z({},ni),{from:function(e){return ee(e,"%")?ri("%",ni.percent,e):ee(e,"px")?ri("px",ni.pixels,e):ni.invalid(e)}}),ii=function(e,t,n){return e.fold((function(){return t}),(function(e){return function(e,t,n){var r=n/t;return A(e,(function(e){return oi.from(e).fold((function(){return e}),(function(e){return e*r+"px"}),(function(e){return e/100*n+"px"}))}))}(t,n,e)}),(function(e){return function(e,t){return A(e,(function(e){return oi.from(e).fold((function(){return e}),(function(e){return e/t*100+"%"}),(function(e){return e+"%"}))}))}(t,n)}))},ai=function(e,n,r){var o=oi.from(r),i=L(e,(function(e){return"0px"===e}))?function(e,n){var r=e.fold((function(){return t("")}),(function(e){return t(e/n+"px")}),(function(){return t(100/n+"%")}));return _(n,r)}(o,e.length):ii(o,e,n);return li(i)},ci=function(e,r){return 0===e.length?r:O(e,(function(e,r){return oi.from(r).fold(t(0),n,n)+e}),0)},ui=function(e,n){return oi.from(e).fold(t(e),(function(e){return e+n+"px"}),(function(e){return e+n+"%"}))},li=function(e){if(0===e.length)return e;var t=O(e,(function(e,t){var n=oi.from(t).fold((function(){return{value:t,remainder:0}}),(function(e){return function(e,t){var n=Math.floor(e);return{value:n+t,remainder:e-n}}(e,"px")}),(function(e){return{value:e+"%",remainder:0}}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}}),{output:[],remainder:0}),n=t.output;return n.slice(0,n.length-1).concat([ui(n[n.length-1],Math.round(t.remainder))])},si=oi.from,fi=function(e){return si(e).fold(t("px"),t("px"),t("%"))},di=function(e,t,n,r){var o=tn.fromTable(e),i=o.all,a=tn.justCells(o),c=tn.justColumns(o);t.each((function(t){var n=fi(t),i=Ir(e),u=function(e,t,n){return Fo(e,t,Bo,jo,n)}(o,e,r),l=ai(u,i,t);tn.hasColumns(o)?function(e,t,n){N(t,(function(t,r){var o=ci([e[r]],jt());At(t.element,"width",o+n)}))}(l,c,n):function(e,t,n){N(t,(function(t){var r=e.slice(t.column,t.colspan+t.column),o=ci(r,jt());At(t.element,"width",o+n)}))}(l,a,n),At(e,"width",t)})),n.each((function(t){var n=fi(t),r=zr(e),c=function(e,t,n){return Uo(e,t,n,Mo,jo)}(o,e,io);!function(e,t,n,r){N(n,(function(t){var n=e.slice(t.row,t.rowspan+t.row),o=ci(n,Ht());At(t.element,"height",o+r)})),N(t,(function(t,n){At(t.element,"height",e[n])}))}(ai(c,r,t),i,a,n),At(e,"height",t)}))},mi=function(e){return So(e).exists((function(e){return ho.test(e)}))},pi=function(e){return So(e).exists((function(e){return vo.test(e)}))},gi=function(e){return So(e).isNone()},hi=Ro,vi=function(e){return tn.fromTable(e).grid},bi=function(e){var t=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");t.push(e)},unbind:function(e){t=R(t,(function(t){return t!==e}))},trigger:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={};N(e,(function(e,t){o[e]=n[t]})),N(t,(function(e){e(o)}))}}},yi=function(e){return{registry:_e(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:_e(e,(function(e){return e.trigger}))}},wi=function(e){return e.slice(0).sort()},Ci=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var r;return function(e,t){if(!h(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");N(t,(function(t){if(!p(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))}("required",t),r=wi(t),I(r,(function(e,t){return t<r.length-1&&e===r[t+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=Se(r);L(t,(function(e){return T(o,e)}))||function(e,t){throw new Error("All required keys ("+wi(e).join(", ")+") were not specified. Specified keys were: "+wi(t).join(", ")+".")}(t,o),e(t,o);var i=R(t,(function(e){return!n.validate(r[e],e)}));return i.length>0&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+wi(e).join(", ")+") were not.")}(i,n.label),r}},xi=function(e,t){var n=R(t,(function(t){return!T(e,t)}));n.length>0&&function(e){throw new Error("Unsupported keys for object: "+wi(e).join(", "))}(n)},ki=function(e){return function(e,t){return Ci(e,t,{validate:w,label:"function"})}(xi,e)},Si=ki(["compare","extract","mutate","sink"]),Ti=ki(["element","start","stop","destroy"]),Ei=ki(["forceDrop","drop","move","delayDrop"]);function _i(){var e=f.none(),t=yi({move:bi(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){(function(t,n){var r=e.map((function(e){return t.compare(e,n)}));return e=f.some(n),r})(r,n).each((function(e){t.trigger.move(e)}))}))},reset:function(){e=f.none()},events:t.registry}}function Ai(){var t={onEvent:e,reset:e},n=_i(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(e,t){r.onEvent(e,t)},events:n.events}}var Ni=function(e,t,n){var r,o,i,a=!1,c=yi({start:bi([]),stop:bi([])}),u=Ai(),l=function(){d.stop(),u.isOn()&&(u.off(),c.trigger.stop())},s=(r=l,o=200,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==i&&clearTimeout(i),i=setTimeout((function(){r.apply(null,e),i=null}),o)}});u.events.move.bind((function(n){t.mutate(e,n.info)}));var f=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];a&&e.apply(null,t)}},d=t.sink(Ei({forceDrop:l,drop:f(l),move:f((function(e){s.cancel(),u.onEvent(e,t)})),delayDrop:f(s.throttle)}),n);return{element:d.element,go:function(e){d.start(e),u.on(),c.trigger.start()},on:function(){a=!0},off:function(){a=!1},destroy:function(){d.destroy()},events:c.registry}},Ri=function(e){var t,n,r=ve.fromDom(it(e).getOr(e.target)),o=function(){return e.stopPropagation()},i=function(){return e.preventDefault()},a=(t=i,n=o,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))});return function(e,t,n,r,o,i,a){return{target:e,x:t,y:n,stop:r,prevent:o,kill:i,raw:a}}(r,e.clientX,e.clientY,o,i,a,e)},Oi=function(e,t,n,o,i){var a=function(e,t){return function(n){e(n)&&t(Ri(n))}}(n,o);return e.dom.addEventListener(t,a,i),{unbind:r(Di,e,t,a,i)}},Di=function(e,t,n,r){e.dom.removeEventListener(t,n,r)},Ii=c,Pi=function(e,t,n){return function(e,t,n,r){return Oi(e,t,n,r,!1)}(e,t,Ii,n)},Bi=Ri,Mi=function(e,t){var n=xt(e,t);return void 0===n||""===n?[]:n.split(" ")},Li=function(e){return void 0!==e.dom.classList},Fi=function(e,t){return function(e,t,n){var r=Mi(e,t).concat([n]);return wt(e,t,r.join(" ")),!0}(e,"class",t)},ji=function(e,t){Li(e)?e.dom.classList.add(t):Fi(e,t)},Hi=function(e,t){return Li(e)&&e.dom.classList.contains(t)},Ui=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},zi=Ui("ephox-dragster"),Wi=zi.resolve,qi=Si({compare:function(e,t){return Vr(t.left-e.left,t.top-e.top)},extract:function(e){return f.some(Vr(e.x,e.y))},sink:function(e,t){var n=function(e){var t=z({layerClass:Wi("blocker")},e),n=ve.fromTag("div");wt(n,"role","presentation"),Nt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ji(n,Wi("blocker")),ji(n,t.layerClass);return{element:function(){return n},destroy:function(){Cn(n)}}}(t),r=Pi(n.element(),"mousedown",e.forceDrop),o=Pi(n.element(),"mouseup",e.drop),i=Pi(n.element(),"mousemove",e.move),a=Pi(n.element(),"mouseout",e.delayDrop);return Ti({element:n.element,start:function(e){hn(e,n.element())},stop:function(){Cn(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),a.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left,t.top)}}),Vi=function(e){return"true"===xt(e,"contenteditable")},$i=Ui("ephox-snooker"),Ki=$i.resolve,Ji=function(){var e=yi({drag:bi(["xDelta","yDelta","target"])}),t=f.none(),n=function(){var e=yi({drag:bi(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}();n.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta,n.yDelta,t)}))}));return{assign:function(e){t=f.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}},Gi=Ki("resizer-bar"),Xi=Ki("resizer-rows"),Yi=Ki("resizer-cols"),Qi=function(e){var t=dt(e.parent(),"."+Gi);N(t,Cn)},Zi=function(e,t,n){var r=e.origin();N(t,(function(t){t.each((function(t){var o=n(r,t);ji(o,Gi),hn(e.parent(),o)}))}))},ea=function(e,t,n,r){Zi(e,t,(function(e,t){var o,i,a,c,u,l,s=(o=t.col,i=t.x-e.left,a=n.top-e.top,c=7,u=r,l=ve.fromTag("div"),Nt(l,{position:"absolute",left:i-c/2+"px",top:a+"px",height:u+"px",width:c+"px"}),Ct(l,{"data-column":o,role:"presentation"}),l);return ji(s,Yi),s}))},ta=function(e,t,n,r){Zi(e,t,(function(e,t){var o=function(e,t,n,r,o){var i=ve.fromTag("div");return Nt(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),Ct(i,{"data-row":e,role:"presentation"}),i}(t.row,n.left-e.left,t.y-e.top,r,7);return ji(o,Xi),o}))},na=function(e,t,n,r,o){var i=Kr(n),a=t.isResizable,c=r.length>0?io.positions(r,n):[],u=c.length>0?function(e,t){return M(e.all,(function(e,n){return t(e.element)?[n]:[]}))}(e,a):[],l=R(c,(function(e,t){return E(u,(function(e){return t===e}))}));ta(t,l,i,Pr(n));var s=o.length>0?co.positions(o,n):[],f=s.length>0?function(e,t){var n=[];return _(e.grid.columns,(function(r){tn.getColumnAt(e,r).map((function(e){return e.element})).forall(t)&&n.push(r)})),R(n,(function(n){var r=tn.filterItems(e,(function(e){return e.column===n}));return L(r,(function(e){return t(e.element)}))}))}(e,a):[],d=R(s,(function(e,t){return E(f,(function(e){return t===e}))}));ea(t,d,i,Wr(n))},ra=function(e,t){if(Qi(e),e.isResizable(t)){var n=tn.fromTable(t),r=Lr(n),o=Br(n);na(n,e,t,r,o)}},oa=function(e,t){var n=dt(e.parent(),"."+Gi);N(n,t)},ia=function(e){oa(e,(function(e){At(e,"display","none")}))},aa=function(e){oa(e,(function(e){At(e,"display","block")}))},ca=Ki("resizer-bar-dragging"),ua=function(e){var t=Ji(),n=function(e,t){void 0===t&&(t={});var n=void 0!==t.mode?t.mode:qi;return Ni(e,n,t)}(t,{}),o=f.none(),i=function(e,t){return f.from(xt(e,t))};t.events.drag.bind((function(e){i(e.target,"data-row").each((function(t){var n=Ft(e.target,"top");At(e.target,"top",n+e.yDelta+"px")})),i(e.target,"data-column").each((function(t){var n=Ft(e.target,"left");At(e.target,"left",n+e.xDelta+"px")}))}));var a=function(e,t){return Ft(e,t)-Pt(e,"data-initial-"+t,0)};n.events.stop.bind((function(){t.get().each((function(t){o.each((function(n){i(t,"data-row").each((function(e){var r=a(t,"top");St(t,"data-initial-top"),m.trigger.adjustHeight(n,r,parseInt(e,10))})),i(t,"data-column").each((function(e){var r=a(t,"left");St(t,"data-initial-left"),m.trigger.adjustWidth(n,r,parseInt(e,10))})),ra(e,n)}))}))}));var c=function(r,o){m.trigger.startAdjust(),t.assign(r),wt(r,"data-initial-"+o,Ft(r,o)),ji(r,ca),At(r,"opacity","0.2"),n.go(e.parent())},u=Pi(e.parent(),"mousedown",(function(e){var t;t=e.target,Hi(t,Xi)&&c(e.target,"top"),function(e){return Hi(e,Yi)}(e.target)&&c(e.target,"left")})),l=function(t){return we(t,e.view())},s=function(e){return bt(e,"table",l).filter((function(e){return function(e,t){return bt(e,"[contenteditable]",t)}(e,l).exists(Vi)}))},d=Pi(e.view(),"mouseover",(function(t){s(t.target).fold((function(){ct(t.target)&&Qi(e)}),(function(t){o=f.some(t),ra(e,t)}))})),m=yi({adjustHeight:bi(["table","delta","row"]),adjustWidth:bi(["table","delta","column"]),startAdjust:bi([])});return{destroy:function(){u.unbind(),d.unbind(),n.destroy(),Qi(e)},refresh:function(t){ra(e,t)},on:n.on,off:n.off,hideBars:r(ia,e),showBars:r(aa,e),events:m.registry}},la=function(e,t,n){var r=io,o=co,i=ua(e),a=yi({beforeResize:bi(["table","type"]),afterResize:bi(["table","type"]),startDrag:bi([])});return i.events.adjustHeight.bind((function(e){var t=e.table;a.trigger.beforeResize(t,"row");var n=r.delta(e.delta,t);Ko(t,n,e.row,r),a.trigger.afterResize(t,"row")})),i.events.startAdjust.bind((function(e){a.trigger.startDrag()})),i.events.adjustWidth.bind((function(e){var r=e.table;a.trigger.beforeResize(r,"col");var i=o.delta(e.delta,r),c=n(r);$o(r,i,e.column,t,c),a.trigger.afterResize(r,"col")})),{on:i.on,off:i.off,hideBars:i.hideBars,showBars:i.showBars,destroy:i.destroy,events:a.registry}},sa=function(e,t){return e.fire("newrow",{node:t})},fa=function(e,t){return e.fire("newcell",{node:t})},da=function(e,t,n){e.fire("TableModified",z(z({},n),{table:t}))},ma={"border-collapse":"collapse",width:"100%"},pa={border:"1"},ga=function(e){return e.getParam("table_sizing_mode","auto")},ha=function(e){return e.getParam("table_responsive_width")},va=function(e){return e.getParam("table_default_attributes",pa,"object")},ba=function(e){return e.getParam("table_default_styles",function(e){if(Sa(e)){var t=e.getBody().offsetWidth;return z(z({},ma),{width:t+"px"})}return Ta(e)?Ne(ma,(function(e,t){return"width"!==t})):ma}(e),"object")},ya=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},wa=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Ca=function(e){return e.getParam("table_advtab",!0,"boolean")},xa=function(e){return e.getParam("table_style_by_css",!1,"boolean")},ka=function(e){return"relative"===ga(e)||!0===ha(e)},Sa=function(e){return"fixed"===ga(e)||!1===ha(e)},Ta=function(e){return"responsive"===ga(e)},Ea=function(e){return e.getParam("table_use_colgroups",!1,"boolean")},_a=function(e){var t=e.getParam("table_header_type","section","string");return T(["section","cells","sectionCells","auto"],t)?t:"section"},Aa=function(e){var t=e.getParam("table_column_resizing","preservetable","string");return I(["preservetable","resizetable"],(function(e){return e===t})).getOr("preservetable")},Na=function(e){return"preservetable"===Aa(e)},Ra=function(e){var t=e.getParam("table_clone_elements");return p(t)?f.some(t.split(/[ ,]/)):Array.isArray(t)?f.some(t):f.none()},Oa=function(e){return e.nodeName.toLowerCase()},Da=function(e){return ve.fromDom(e.getBody())},Ia=function(e){return e.getBoundingClientRect().width},Pa=function(e){return e.getBoundingClientRect().height},Ba=function(e){return function(t){return we(t,Da(e))}},Ma=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},La=function(e){St(e,"data-mce-style");var t=function(e){return St(e,"data-mce-style")};N(qt(e),t),N(Vt(e),t)},Fa=function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return f.from(n).filter(ne)},ja=function(e){return/^(\d+(\.\d+)?)%$/.test(e)},Ha=function(e){return ve.fromDom(e.selection.getStart())},Ua=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},za=function(n){var r=function(){return Ir(n)},o=t(0);return{width:r,pixelWidth:r,getWidths:function(e,t){return Ho(e,n,t)},getCellDelta:o,singleColumnWidth:t([0]),minCellWidth:o,setElementWidth:e,adjustTableWidth:e,isRelative:!0,label:"none"}},Wa=function(e,t){var n=Ua(parseFloat(e)),r=Ua(Ir(t));return{width:n.get,pixelWidth:r.get,getWidths:function(e,n){return function(e,t,n){return Fo(e,t,Eo,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}),n)}(e,t,n)},getCellDelta:function(e){return e/r.get()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return jt()/r.get()*100},setElementWidth:wo,adjustTableWidth:function(e){var o=n.get(),i=o+e/100*o;wo(t,i),n.set(i),r.set(Ir(t))},isRelative:!0,label:"percent"}},qa=function(e,t){var r=Ua(e),o=r.get;return{width:o,pixelWidth:o,getWidths:function(e,n){return Ho(e,t,n)},getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(jt(),e+t)-e]},minCellWidth:jt,setElementWidth:yo,adjustTableWidth:function(e){var n=o()+e;yo(t,n),r.set(n)},isRelative:!1,label:"pixel"}},Va=function(e){return So(e).fold((function(){return za(e)}),(function(t){return function(e,t){var n=Oo().exec(t);if(null!==n)return Wa(n[1],e);var r=Do().exec(t);if(null!==r){var o=parseInt(r[1],10);return qa(o,e)}var i=Ir(e);return qa(i,e)}(e,t)}))},$a=qa,Ka=Wa,Ja=function(e,t){if(ka(e)){var n=Fa(e,t.dom).filter(ja).getOrThunk((function(){return hi(t)}));return Ka(n,t)}return Sa(e)?$a(Ir(t),t):Va(t)},Ga=function(e){St(e,"width")},Xa=function(e,t){var n=function(e){return Ir(e)+"px"}(e);di(e,f.some(n),f.none(),t),Ga(e)},Ya=function(e,t){!function(e,t){var n=Ro(e);di(e,f.some(n),f.none(),t),Ga(e)}(t,Ja(e,t))},Qa=function(e,t){var n=Ja(e,t);Xa(t,n)},Za=function(e){It(e,"width");var t=Vt(e),n=t.length>0?t:qt(e);N(n,(function(e){It(e,"width"),Ga(e)})),Ga(e)},ec=function(){var e=ve.fromTag("div");return Nt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),hn(ut(ve.fromDom(document)),e),e},tc=function(e){return"false"!==xt(e,"data-mce-resize")},nc=function(e){var n,r,o=f.none(),i=f.none(),a=f.none(),c=function(e){return"TABLE"===e.nodeName},u=function(){return i},l=function(t){return Ja(e,t)},s=function(){return Na(e)?{resizeTable:function(e,t,n){n&&e(t)},clampTableDelta:function(e,t,n,r,o){if(o){if(n>=0)return n;var i=D(e,(function(e,t){return e+t-r}),0);return Math.max(-i,n)}return Yo(e,t,n,r)},calcLeftEdgeDeltas:n=function(e,t,n,r,o){var i=Qo(e,r>=0?n:t,r,o);return Go(e,t,n+1,[i,-i],Jo)},calcMiddleDeltas:function(e,t,r,o,i,a){return n(e,r,o,i,a)},calcRightEdgeDeltas:function(e,n,r,o,i,a){if(a)return Jo(e);var c=o/e.length;return A(e,t(c))}}:Zo();var n},d=function(t,o,i){var a=ee(o,"e");if(""===r&&Ya(e,t),i!==n&&""!==r){At(t,"width",r);var c=s(),u=l(t),f=Na(e)||a?function(e){return vi(e).columns}(t)-1:0;$o(t,i-n,f,c,u)}else if(ja(r)){var d=parseFloat(r.replace("%",""));At(t,"width",i*d/n+"%")}(function(e){return/^(\d+(\.\d+)?)px$/.test(e)})(r)&&function(e){var t=tn.fromTable(e);tn.hasColumns(t)||N(qt(e),(function(e){var t=Rt(e,"width");At(e,"width",t),St(e,"width")}))}(t)};return e.on("init",(function(){var t=function(e,t){return e.inline?ti(Da(e),ec(),t):ei(ve.fromDom(e.getDoc()),t)}(e,tc);if(a=f.some(t),function(e){var t=e.getParam("object_resizing",!0);return p(t)?"table"===t:t}(e)&&function(e){return e.getParam("table_resize_bars",!0,"boolean")}(e)){var n=s(),r=la(t,n,l);r.on(),r.events.startDrag.bind((function(t){o=f.some(e.selection.getRng())})),r.events.beforeResize.bind((function(t){var n=t.table.dom;!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(e,n,Ia(n),Pa(n),"bar-"+t.type)})),r.events.afterResize.bind((function(t){var n=t.table,r=n.dom;La(n),o.each((function(t){e.selection.setRng(t),e.focus()})),function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(e,r,Ia(r),Pa(r),"bar-"+t.type),e.undoManager.add()})),i=f.some(r)}})),e.on("ObjectResizeStart",(function(t){var o=t.target;if(c(o)){var i=ve.fromDom(o);N(e.dom.select(".mce-clonedresizable"),(function(t){e.dom.addClass(t,"mce-"+Aa(e)+"-columns")})),!pi(i)&&Sa(e)?Qa(e,i):!mi(i)&&ka(e)&&Ya(e,i),gi(i)&&Z(t.origin,"bar-")&&Ya(e,i),n=t.width,r=Ta(e)?"":Fa(e,o).getOr("")}})),e.on("ObjectResized",(function(t){var n=t.target;if(c(n)){var r=ve.fromDom(n),o=t.origin;Z(o,"corner-")&&d(r,o,t.width),La(r),da(e,r.dom)}})),e.on("SwitchMode",(function(){u().each((function(t){e.mode.isReadOnly()?t.hideBars():t.showBars()}))})),{lazyResize:u,lazyWire:function(){return a.getOr(ei(ve.fromDom(e.getBody()),tc))},destroy:function(){i.each((function(e){e.destroy()})),a.each((function(t){!function(e,t){e.inline&&Cn(t.parent())}(e,t)}))}}},rc=function(e,t){return{element:e,offset:t}},oc=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind((function(t){return oc(e,t,n).orThunk((function(){return f.some(t)}))})):f.none()},ic=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},ac=function(e,t){var n=oc(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return rc(n,ic(e,n));var r=e.property().children(n);return r.length>0?ac(e,r[r.length-1]):rc(n,ic(e,n))},cc=ac,uc=An(),lc=function(e,t){(function(e){return So(e).bind((function(e){return so(e,["fixed","relative","empty"])}))})(e).each((function(n){var r=n.value/2;No(e,r,n.unit),No(t,r,n.unit)}))},sc=function(e,t,n){e.cells[t]=n},fc=function(e,t){return Le(t,e.section)},dc=function(e,t){var n=e.cells,r=A(n,t);return Le(r,e.section)},mc=function(e,t){return e.cells[t]},pc=function(e,t){return mc(e,t).element},gc=function(e){return e.cells.length},hc=function(e){var t=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o)?n:r).push(a)}return{pass:n,fail:r}}(e,(function(e){return"colgroup"===e.section}));return{rows:t.fail,cols:t.pass}},vc=function(e,t,n,r){n===r?St(e,t):wt(e,t,n)},bc=function(e,t,n){H(ft(e,t)).fold((function(){return gn(e,n)}),(function(e){return pn(e,n)}))},yc=function(e,t){var n=[],r=[],o=function(e){return A(e,(function(e){e.isNew&&n.push(e.element);var t=e.element;return wn(t),N(e.cells,(function(e){e.isNew&&r.push(e.element),vc(e.element,"colspan",e.colspan,1),vc(e.element,"rowspan",e.rowspan,1),hn(t,e.element)})),t}))},i=function(e){return M(e,(function(e){return A(e.cells,(function(e){return vc(e.element,"span",e.colspan,1),e.element}))}))},a=function(t,n){var r=function(e,t){var n=ht(e,t).getOrThunk((function(){var n=ve.fromTag(t,$e(e).dom);return"thead"===t?bc(e,"caption,colgroup",n):"colgroup"===t?bc(e,"caption",n):hn(e,n),n}));return wn(n),n}(e,n),a=("colgroup"===n?i:o)(t);yn(r,a)},c=function(t,n){t.length>0?a(t,n):function(t){ht(e,t).each(Cn)}(n)},u=[],l=[],s=[],f=[];return N(t,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":l.push(e);break;case"tfoot":s.push(e);break;case"colgroup":f.push(e)}})),c(f,"colgroup"),c(u,"thead"),c(l,"tbody"),c(s,"tfoot"),{newRows:n,newCells:r}},wc=function(e,t){if(0===e.length)return 0;var n=e[0];return P(e,(function(e){return!t(n.element,e.element)})).fold((function(){return e.length}),(function(e){return e}))},Cc=function(e,t,n,r){var o=function(e,t){return e[t]}(e,t).cells.slice(n),i=wc(o,r),a=function(e,t){return A(e,(function(e){return mc(e,t)}))}(e,n).slice(t);return{colspan:i,rowspan:wc(a,r)}},xc=function(e,t){var n=A(e,(function(e){return A(e.cells,a)}));return A(e,(function(r,o){return function(e,t){return{details:e,section:t}}(M(r.cells,(function(r,i){if(!1===n[o][i]){var a=Cc(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var a=t;a<t+o;a++)n[i][a]=!0}(o,i,a.rowspan,a.colspan),[(c=r.element,u=a.rowspan,l=a.colspan,s=r.isNew,{element:c,rowspan:u,colspan:l,isNew:s})]}return[];var c,u,l,s})),r.section)}))},kc=function(e,t,n){var r=[];if(tn.hasColumns(e)){var o=A(tn.justColumns(e),(function(e){return Me(e.element,n)}));r.push(Le(o,"colgroup"))}for(var i=0;i<e.grid.rows;i++){for(var a=[],c=0;c<e.grid.columns;c++){var u=tn.getAt(e,i,c).map((function(e){return Me(e.element,n)})).getOrThunk((function(){return Me(t.gap(),!0)}));a.push(u)}var l=Le(a,e.all[i].section);r.push(l)}return r},Sc=function(e,t){return A(e,(function(e){var n=function(e){return U(e,(function(e){return Je(e.element).map((function(e){var t=Je(e).isNone();return Me(e,t)}))})).getOrThunk((function(){return Me(t.row(),!0)}))}(e.details);return function(e,t,n,r){return{element:e,cells:t,section:n,isNew:r}}(n.element,e.details,e.section,n.isNew)}))},Tc=function(e,t){var n=xc(e,we);return Sc(n,t)},Ec=function(e,t){return U(e.all,(function(e){return I(e.cells,(function(e){return we(t,e.element)}))}))},_c=function(e,t,n,r,o){return function(i,a,c,u,l){var s=tn.fromTable(a);return t(s,c).map((function(t){var n=function(e,t){return kc(e,t,!1)}(s,u),r=e(n,t,we,o(u));return{grid:Tc(r.grid,u),cursor:r.cursor}})).fold((function(){return f.none()}),(function(e){var t=yc(a,e.grid),o=f.from(l).getOrThunk((function(){return Va(a)}));return n(a,e.grid,o),r(a),ra(i,a),f.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))}},Ac=function(e,t){return Wt(t.element).bind((function(t){return Ec(e,t)}))},Nc=function(e,t){var n=A(t.selection,(function(t){return Wt(t).bind((function(t){return Ec(e,t)}))})),r=_r(n);return r.length>0?f.some({cells:r,generators:t.generators,clipboard:t.clipboard}):f.none()},Rc=function(e,t){var n=A(t.selection,(function(t){return Wt(t).bind((function(t){return Ec(e,t)}))})),r=_r(n);return r.length>0?f.some(r):f.none()},Oc=function(e,t,n,r){for(var o=hc(e).rows,i=!0,a=0;a<o.length;a++)for(var c=0;c<gc(o[0]);c++){var u=n(pc(o[a],c),t);!0===u&&!1===i?sc(o[a],c,Me(r(),!0)):!0===u&&(i=!1)}return e},Dc=function(e,t,n,r){var o=hc(e).rows;if(t>0&&t<o.length){var i=function(e,t){return D(e,(function(e,n){return E(e,(function(e){return t(e.element,n.element)}))?e:e.concat([n])}),[])}(o[t-1].cells,n);N(i,(function(e){for(var i=f.none(),a=function(t){for(var a=function(a){var c=o[t].cells[a];n(c.element,e.element)&&(i.isNone()&&(i=f.some(r())),i.each((function(e){sc(o[t],a,Me(e,!0))})))},c=0;c<gc(o[0]);c++)a(c)},c=t;c<o.length;c++)a(c)}))}return e},Ic=function(e){return{is:function(t){return e===t},isValue:c,isError:a,getOr:t(e),getOrThunk:t(e),getOrDie:t(e),or:function(t){return Ic(e)},orThunk:function(t){return Ic(e)},fold:function(t,n){return n(e)},map:function(t){return Ic(t(e))},mapError:function(t){return Ic(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return f.some(e)}}},Pc=function(t){return{is:a,isValue:a,isError:c,getOr:n,getOrThunk:function(e){return e()},getOrDie:function(){return(e=String(t),function(){throw new Error(e)})();var e},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return Pc(t)},mapError:function(e){return Pc(e(t))},each:e,bind:function(e){return Pc(t)},exists:a,forall:c,toOptional:f.none}},Bc={value:Ic,error:Pc,fromOption:function(e,t){return e.fold((function(){return Pc(t)}),Ic)}},Mc=function(e,t){return{rowDelta:0,colDelta:gc(e[0])-gc(t[0])}},Lc=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},Fc=function(e,t,n){var r="colgroup"===t.section?n.col:n.cell;return A(e,(function(){return Me(r(),!0)}))},jc=function(e,t,n){return e.concat(_(t,(function(){var t=e[e.length-1];return fc(t,Fc(t.cells,t,n))})))},Hc=function(e,t,r){return A(e,(function(e){var o=Fc(_(t,n),e,r);return fc(e,e.cells.concat(o))}))},Uc=function(e,t,r){var o=t.colDelta<0?Hc:n;return(t.rowDelta<0?jc:n)(o(e,Math.abs(t.colDelta),r),Math.abs(t.rowDelta),r)},zc=function(e,t,n,o){var i=r(o,mc(e[t],n).element),a=e[t];return e.length>1&&gc(a)>1&&(n>0&&i(pc(a,n-1))||n<a.cells.length-1&&i(pc(a,n+1))||t>0&&i(pc(e[t-1],n))||t<e.length-1&&i(pc(e[t+1],n)))},Wc=function(e,t,n,r,o){return function(e,t,n){if(e.row>=t.length||e.column>gc(t[0]))return Bc.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=t.slice(e.row),o=r[0].cells.slice(e.column),i=gc(n[0]),a=n.length;return Bc.value({rowDelta:r.length-a,colDelta:o.length-i})}(e,t,n).map((function(i){var a=Uc(t,i,r);return function(e,t,n,r,o){for(var i=e.row,a=e.column,c=i+n.length,u=a+gc(n[0]),l=i;l<c;l++)for(var s=a;s<u;s++){zc(t,l,s,o)&&Oc(t,pc(t[l],s),o,r.cell);var f=pc(n[l-i],s-a),d=r.replace(f);sc(t[l],s,Me(d,!0))}return t}(e,a,n,r,o)}))},qc=function(e,t,n,r,o){!function(e,t,n,r){t>0&&t<e[0].cells.length&&N(e,(function(e){var o=e.cells[t-1],i=e.cells[t];n(i.element,o.element)&&sc(e,t,Me(r(),!0))}))}(t,e,o,r.cell);var i=Lc(n,t),a=Uc(n,i,r),c=Lc(t,a),u=Uc(t,c,r);return A(u,(function(t,n){var r=t.cells.slice(0,e).concat(a[n].cells).concat(t.cells.slice(e,t.cells.length));return fc(t,r)}))},Vc=function(e,t,n,r,o){Dc(t,e,o,r.cell);var i=Mc(n,t),a=Uc(n,i,r),c=Mc(t,a),u=Uc(t,c,r),l=hc(u),s=l.cols,f=l.rows;return s.concat(f.slice(0,e)).concat(a).concat(f.slice(e,f.length))},$c=function(e,t,n,r,o){var i=hc(e),a=i.rows,c=i.cols,u=a.slice(0,t),l=a.slice(t),s=dc(a[n],(function(e,n){return t>0&&t<a.length&&r(pc(a[t-1],n),pc(a[t],n))?mc(a[t],n):Me(o(e.element,r),!0)}));return c.concat(u).concat([s]).concat(l)},Kc=function(e,t,n,r,o){return A(e,(function(e){var i=t>0&&t<gc(e)&&r(pc(e,t-1),pc(e,t)),a=function(e,t,n,r,o,i,a){return"colgroup"!==n&&r?mc(e,t):Me(a(pc(e,o),i),!0)}(e,t,e.section,i,n,r,o);return function(e,t,n){var r=e.cells,o=r.slice(0,t),i=r.slice(t),a=o.concat([n]).concat(i);return fc(e,a)}(e,t,a)}))},Jc=function(e,t,n,r){return A(e,(function(e){return dc(e,(function(e){return function(e){return E(t,(function(t){return n(e.element,t.element)}))}(e)?Me(r(e.element,n),!0):e}))}))},Gc=function(e,t,n,r){return void 0!==pc(e[t],n)&&t>0&&r(pc(e[t-1],n),pc(e[t],n))},Xc=function(e,t,n){return t>0&&n(pc(e,t-1),pc(e,t))},Yc=function(e,t,n,r){var o=M(e,(function(r,o){return Gc(e,o,t,n)||Xc(r,t,n)?[]:[mc(r,t)]}));return Jc(e,o,n,r)},Qc=function(e,t,n,r){var o=hc(e).rows,i=o[t],a=M(i.cells,(function(e,r){return Gc(o,t,r,n)||Xc(i,r,n)?[]:[e]}));return Jc(e,a,n,r)},Zc=ki(["cell","row","replace","gap","col","colgroup"]),eu=function(e){return{element:e,colspan:Pt(e,"colspan",1),rowspan:Pt(e,"rowspan",1)}},tu=function(e,t){void 0===t&&(t=eu),Zc(e);var n=Ua(f.none()),r=function(n){return function(t){switch(Fe(t.element)){case"col":return e.col(t);default:return e.cell(t)}}(t(n))},o=function(e){var t=r(e);return n.get().isNone()&&n.set(f.some(t)),i=f.some({item:e,replacement:t}),t},i=f.none();return{getOrInit:function(e,t){return i.fold((function(){return o(e)}),(function(n){return t(e,n.item)?n.replacement:o(e)}))},cursor:n.get}},nu=function(e,t){return function(n){var r=Ua(f.none());Zc(n);var o=[],i=function(i){var a={scope:e},c=n.replace(i,t,a);return o.push({item:i,sub:c}),r.get().isNone()&&r.set(f.some(c)),c};return{replaceOrInit:function(e,t){return function(e,t){return I(o,(function(n){return t(n.item,e)}))}(e,t).fold((function(){return i(e)}),(function(n){return t(e,n.item)?n.sub:i(e)}))},cursor:r.get}}},ru=function(e){Zc(e);var t=Ua(f.none());return{combine:function(n){return t.get().isNone()&&t.set(f.some(n)),function(){var t=e.cell({element:n,colspan:1,rowspan:1});return It(t,"width"),It(n,"width"),t}},cursor:t.get}},ou=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],iu=An(),au=function(e){return function(e,t){var n=e.property().name(t);return T(ou,n)}(iu,e)},cu=function(e){return function(e,t){var n=e.property().name(t);return T(["ol","ul"],n)}(iu,e)},uu=function(e){return function(e,t){return T(["br","img","hr","input"],e.property().name(t))}(iu,e)},lu=function(e){var t,n=function(e){return"br"===Fe(e)},r=function(e){return tr(e).bind((function(t){var r=Ye(t).map((function(e){return!!au(e)||!!uu(e)&&"img"!==Fe(e)})).getOr(!1);return Je(t).map((function(o){return!0===r||function(e){return"li"===Fe(e)||pt(e,cu).isSome()}(o)||n(t)||au(o)&&!we(e,o)?[]:[ve.fromTag("br")]}))})).getOr([])},o=0===(t=M(e,(function(e){var t=Qe(e);return function(e){return L(e,(function(e){return n(e)||We(e)&&0===Sn(e).trim().length}))}(t)?[]:t.concat(r(e))}))).length?[ve.fromTag("br")]:t;wn(e[0]),yn(e[0],o)},su=function(e){0===qt(e).length&&Cn(e)},fu=function(e,t){return{grid:e,cursor:t}},du=function(e,t,n){var r=hc(e).rows;return mu(r,t,n).orThunk((function(){return mu(r,0,0)}))},mu=function(e,t,n){return f.from(e[t]).bind((function(e){return f.from(e.cells[n]).bind((function(e){return f.from(e.element)}))}))},pu=function(e,t,n){var r=hc(e).rows;return fu(e,mu(r,t,n))},gu=function(e){return D(e,(function(e,t){return E(e,(function(e){return e.row===t.row}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row-t.row}))},hu=function(e){return D(e,(function(e,t){return E(e,(function(e){return e.column===t.column}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column-t.column}))},vu=function(e,t,n){var r,o,i=(r=e,o=n.section,Gt(r,(function(){return o}))),a=tn.generate(i);return kc(a,t,!0)},bu=function(e,t){var n=R(e,t);return 0===n.length?f.some("td"):n.length===e.length?f.some("th"):f.none()},yu=function(e,t,n){var r=tn.generate(t),o=n.getWidths(r,n);Vo(r,o,n)},wu=_c((function(e,t,n,r){var o=t[0].row,i=t[0].row,a=gu(t),c=D(a,(function(e,t){return $c(e,i,o,n,r.getOrInit)}),e);return pu(c,i,t[0].column)}),Rc,e,e,tu),Cu=_c((function(e,t,n,r){var o=gu(t),i=o[o.length-1].row,a=o[o.length-1].row+o[o.length-1].rowspan,c=D(o,(function(e,t){return $c(e,a,i,n,r.getOrInit)}),e);return pu(c,a,t[0].column)}),Rc,e,e,tu),xu=_c((function(e,t,n,r){var o=hu(t),i=o[0].column,a=o[0].column,c=D(o,(function(e,t){return Kc(e,a,i,n,r.getOrInit)}),e);return pu(c,t[0].row,a)}),Rc,yu,e,tu),ku=_c((function(e,t,n,r){var o=t[t.length-1].column,i=t[t.length-1].column+t[t.length-1].colspan,a=hu(t),c=D(a,(function(e,t){return Kc(e,i,o,n,r.getOrInit)}),e);return pu(c,t[0].row,i)}),Rc,yu,e,tu),Su=_c((function(e,t,n,r){var o=hu(t),i=function(e,t,n){var r=A(e,(function(e){var r=e.cells.slice(0,t).concat(e.cells.slice(n+1));return Le(r,e.section)}));return R(r,(function(e){return e.cells.length>0}))}(e,o[0].column,o[o.length-1].column),a=du(i,t[0].row,t[0].column);return fu(i,a)}),Rc,yu,su,tu),Tu=_c((function(e,t,n,r){var o=gu(t),i=function(e,t,n){var r=hc(e),o=r.rows;return r.cols.concat(o.slice(0,t)).concat(o.slice(n+1))}(e,o[0].row,o[o.length-1].row),a=du(i,t[0].row,t[0].column);return fu(i,a)}),Rc,e,su,tu),Eu=(_c((function(e,t,n,r){var o=Yc(e,t.column,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu("row","th")),_c((function(e,t,n,r){var o=hu(t),i=D(o,(function(e,t){return Yc(e,t.column,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu("row","th"))),_u=(_c((function(e,t,n,r){var o=Yc(e,t.column,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu(null,"td")),_c((function(e,t,n,r){var o=hu(t),i=D(o,(function(e,t){return Yc(e,t.column,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu(null,"td"))),Au=(_c((function(e,t,n,r){var o=Qc(e,t.row,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu("col","th")),_c((function(e,t,n,r){var o=gu(t),i=D(o,(function(e,t){return Qc(e,t.row,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu("col","th")),_c((function(e,t,n,r){var o=Qc(e,t.row,n,r.replaceOrInit);return pu(o,t.row,t.column)}),Ac,e,e,nu(null,"td")),_c((function(e,t,n,r){var o=gu(t),i=D(o,(function(e,t){return Qc(e,t.row,n,r.replaceOrInit)}),e);return pu(i,t[0].row,t[0].column)}),Rc,e,e,nu(null,"td")),_c((function(e,n,r,o){var i=n.cells;lu(i);var a=function(e,t,n,r){var o=hc(e).rows;if(0===o.length)return e;for(var i=t.startRow;i<=t.finishRow;i++)for(var a=t.startCol;a<=t.finishCol;a++)sc(o[i],a,Me(r(),!1));return e}(e,n.bounds,0,t(i[0]));return fu(a,f.from(i[0]))}),(function(e,t){return t.mergable}),e,e,ru)),Nu=_c((function(e,t,n,r){var o=O(t,(function(e,t){return Oc(e,t,n,r.combine(t))}),e);return fu(o,f.from(t[0]))}),(function(e,t){return t.unmergable}),yu,e,ru),Ru=_c((function(e,t,n,r){var o=function(e,t){var n=tn.fromTable(e);return kc(n,t,!0)}(t.clipboard,t.generators),i=function(e,t){return{row:e,column:t}}(t.row,t.column);return Wc(i,e,o,t.generators,n).fold((function(){return fu(e,f.some(t.element))}),(function(e){var n=du(e,t.row,t.column);return fu(e,n)}))}),(function(e,t){return Wt(t.element).bind((function(n){return Ec(e,n).map((function(e){return z(z({},e),{generators:t.generators,clipboard:t.clipboard})}))}))}),yu,e,tu),Ou=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[0].column,a=o[t.cells[0].row],c=vu(t.clipboard,t.generators,a),u=qc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Du=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,a=o[t.cells[0].row],c=vu(t.clipboard,t.generators,a),u=qc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Iu=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[0].row,a=o[i],c=vu(t.clipboard,t.generators,a),u=Vc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Pu=_c((function(e,t,n,r){var o=hc(e).rows,i=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,a=o[t.cells[0].row],c=vu(t.clipboard,t.generators,a),u=Vc(i,e,c,t.generators,n),l=du(u,t.cells[0].row,t.cells[0].column);return fu(u,l)}),Nc,e,e,tu),Bu=function(e,t){var n=tn.fromTable(e);return Rc(n,t).bind((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,i=B(A(n.all,(function(e){return R(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return bu(i,(function(e){return"th"===Fe(e.element)}))})).getOr("")},Mu=function(e){return Oa(e.parentNode)},Lu=function(e,t){var n="thead"===Mu(t),r=!E(t.cells,(function(e){return"th"!==Oa(e)}));return n||r?f.some({thead:n,ths:r}):f.none()},Fu=function(e,t){return"thead"===(n=Lu(0,t).fold((function(){return Mu(t)}),(function(e){return"thead"})))?"header":"tfoot"===n?"footer":"body";var n},ju=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=Oa(o);if(n!==i){var a=e.select(n,r)[0];if(!a){a=e.create(n);var c=r.firstChild;"thead"===n?H(ft(ve.fromDom(r),"caption,colgroup")).fold((function(){return r.insertBefore(a,c)}),(function(t){return e.insertAfter(a,t.dom)})):r.appendChild(a)}"tbody"===n&&"thead"===i&&a.firstChild?a.insertBefore(t,a.firstChild):a.appendChild(t),o.hasChildNodes()||e.remove(o)}},Hu=function(e,t,n,r){var o=e.dom,i=function(e,t,n){if(y(n)&&Oa(t)!==n){var r=e.dom.rename(t,n);return fa(e,r),r}return t}(e,t,n);return b(r)||o.setAttrib(i,"scope",r),i},Uu=function(e,t,n,r){return N(t,(function(t){return Hu(e,t,n,r)}))},zu=function(e,t,n){var r,o=e.dom;if("header"===n){var i=_a(e),a="auto"===i?(r=$t(ve.fromDom(t.cells[0])).map((function(e){return Kt(e)})).getOr([]),U(r,(function(e){return Lu(0,e.dom)})).map((function(e){return e.thead&&e.ths?"sectionCells":e.thead?"section":"cells"})).getOr("section")):i;Uu(e,t.cells,"section"===a?"td":"th","col"),ju(o,t,"cells"===a?"tbody":"thead")}else Uu(e,t.cells,"td",null),ju(o,t,"footer"===n?"tfoot":"tbody")},Wu=function(e){return function(t){var n=Fe(t),r="col"===n||"colgroup"===n?function(e){return $t(e).bind((function(e){return Hn(e,wr.firstSelectedSelector)})).fold((function(){return e}),(function(e){return e[0]}))}(t):t;return bt(r,e)}},qu=Wu("th,td"),Vu=Wu("th,td,caption"),$u=function(e,t){return qu(e).map((function(e){return vr(t)})).getOr([])},Ku=function(e,t){var n,r,o,i=qu(e),a=i.bind((function(e){return $t(e)})).map((function(e){return Kt(e)}));return(n=i,r=a,o=function(e,n){return R(n,(function(n){return E(hr(n.dom.cells),(function(n){return"1"===xt(n,t)||we(n,e)}))}))},n.isSome()&&r.isSome()?f.some(o(n.getOrDie(),r.getOrDie())):f.none()).getOr([])},Ju=function(t,n,r){var o=function(e){return"table"===Fe(Da(e))},i=Ra(t),a=function(e,n,r,o){return function(a,c){La(a);var u=o(),l=ve.fromDom(t.getDoc()),s=pr(r,l,i),d=Ja(t,a);return n(a)?e(u,a,c,s,d).bind((function(e){return N(e.newRows,(function(e){sa(t,e.dom)})),N(e.newCells,(function(e){fa(t,e.dom)})),e.cursor.map((function(e){var n=cc(uc,e),r=t.dom.createRng();return r.setStart(n.element.dom,n.offset),r.setEnd(n.element.dom,n.offset),r}))})):f.none()}},u=a(Tu,(function(e){return!1===o(t)||vi(e).rows>1}),e,n),l=a(Su,(function(e){return!1===o(t)||vi(e).columns>1}),e,n),s=a(wu,c,e,n),d=a(Cu,c,e,n),m=a(xu,c,lc,n),p=a(ku,c,lc,n),g=a(Au,c,e,n),h=a(Nu,c,e,n),v=a(Ou,c,e,n),b=a(Du,c,e,n),y=a(Iu,c,e,n),w=a(Pu,c,e,n),C=a(Ru,c,e,n),x=function(e,t){return Oe(e,"type").filter((function(e){return T(t,e)}))};return{deleteRow:u,deleteColumn:l,insertRowsBefore:s,insertRowsAfter:d,insertColumnsBefore:m,insertColumnsAfter:p,mergeCells:g,unmergeCells:h,pasteColsBefore:v,pasteColsAfter:b,pasteRowsBefore:y,pasteRowsAfter:w,pasteCells:C,setTableCellType:function(e,t){return x(t,["td","th"]).each((function(t){var n=A($u(Ha(e),r),(function(e){return e.dom}));Uu(e,n,t,null)}))},setTableRowType:function(e,t){return x(t,["header","body","footer"]).each((function(t){A(Ku(Ha(e),wr.selected),(function(n){return zu(e,n.dom,t)}))}))},makeColumnsHeader:a(Eu,c,e,n),unmakeColumnsHeader:a(_u,c,e,n),getTableRowType:function(e){var t=Ku(Ha(e),wr.selected);if(t.length>0){var n=A(t,(function(e){return Fu(0,e.dom)})),r=T(n,"header"),o=T(n,"footer");if(r||o){var i=T(n,"body");return!r||i||o?r||i||!o?"":"footer":"header"}return"body"}},getTableCellType:function(e){return bu($u(Ha(e),r),(function(e){return"th"===Fe(e)})).getOr("")},getTableColType:Bu}},Gu={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Xu=function(e){var t=ve.fromTag("colgroup");return _(e,(function(){return hn(t,ve.fromTag("col"))})),t},Yu=function(e,t,n,r){return _(e,(function(e){return function(e,t,n,r){for(var o=ve.fromTag("tr"),i=0;i<e;i++){var a=r<t||i<n?ve.fromTag("th"):ve.fromTag("td");i<n&&wt(a,"scope","row"),r<t&&wt(a,"scope","col"),hn(a,ve.fromTag("br")),hn(o,a)}return o}(t,n,r,e)}))},Qu=function(e,t){e.selection.select(t.dom,!0),e.selection.collapse(!0)},Zu=function(e,t,n,o,i){var a=ba(e),c={styles:a,attributes:va(e),colGroups:Ea(e)};return e.undoManager.ignore((function(){var r=function(e,t,n,r,o,i){void 0===i&&(i=Gu);var a=ve.fromTag("table"),c="cells"!==o;Nt(a,i.styles),Ct(a,i.attributes),i.colGroups&&hn(a,Xu(t));var u=Math.min(e,n);if(c&&n>0){var l=ve.fromTag("thead");hn(a,l);var s=Yu(n,t,"sectionCells"===o?u:0,r);yn(l,s)}var f=ve.fromTag("tbody");hn(a,f);var d=Yu(c?e-u:e,t,c?0:n,r);return yn(f,d),a}(n,t,i,o,_a(e),c);wt(r,"data-mce-id","__mce");var a=function(e){var t=ve.fromTag("div"),n=ve.fromDom(e.dom.cloneNode(!0));return hn(t,n),function(e){return e.dom.innerHTML}(t)}(r);e.insertContent(a),e.addVisual()})),vt(Da(e),'table[data-mce-id="__mce"]').map((function(t){return Sa(e)?Qa(e,t):Ta(e)?Za(t):(ka(e)||function(e){return p(e)&&-1!==e.indexOf("%")}(a.width))&&Ya(e,t),La(t),St(t,"data-mce-id"),function(e,t){N(dt(t,"tr"),(function(t){sa(e,t.dom),N(dt(t,"th,td"),(function(t){fa(e,t.dom)}))}))}(e,t),function(e,t){vt(t,"td,th").each(r(Qu,e))}(e,t),t.dom})).getOr(null)},el=function(e,t,n,r,o){void 0===r&&(r={});var i=function(e){return C(e)&&e>0};if(i(t)&&i(n)){var a=r.headerRows||0,c=r.headerColumns||0;return Zu(e,n,t,c,a)}return console.error(o),null},tl=function(e){return function(){return e().fold((function(){return[]}),(function(e){return A(e,(function(e){return e.dom}))}))}},nl=function(e){return function(t){var n=t.length>0?f.some(hr(t)):f.none();e(n)}},rl=function(e){return function(t,n,r){void 0===r&&(r={});var o=el(e,n,t,r,"Invalid values for insertTable - rows and columns values are required to insert a table.");return e.undoManager.add(),o}},ol=function(e,t,n){var r=Pt(e,t,1);1===n||r<=1?St(e,t):wt(e,t,Math.min(n,r))},il=function(e,t){var n=tn.fromTable(e);return Rc(n,t).map((function(e){var t=e[e.length-1],r=e[0].column,o=t.column+t.colspan;return W(function(e,t,n){if(tn.hasColumns(e)){var r=R(tn.justColumns(e),(function(e){return e.column>=t&&e.column<n})),o=A(r,(function(e){var r=ir(e.element);return ol(r,"span",n-t),r})),i=ve.fromTag("colgroup");return yn(i,o),[i]}return[]}(n,r,o),function(e,t,n){return A(e.all,(function(e){var r=R(e.cells,(function(e){return e.column>=t&&e.column<n})),o=A(r,(function(e){var r=ir(e.element);return ol(r,"colspan",n-t),r})),i=ve.fromTag("tr");return yn(i,o),i}))}(n,r,o))}))},al=function(e,t,n){var r=tn.fromTable(e);return Rc(r,t).map((function(e){var t=kc(r,n,!1),o=hc(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan);return function(e){return A(e,(function(e){var t=or(e.element);return N(e.cells,(function(e){var n=ir(e.element);vc(n,"colspan",e.colspan,1),vc(n,"rowspan",e.rowspan,1),hn(t,n)})),t}))}(Tc(o,n))}))},cl=tinymce.util.Tools.resolve("tinymce.util.Tools"),ul=function(e,t,n){return function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(void 0,e.select("td,th",t))},ll=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},sl=function(e,t){cl.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},fl=function(e){return function(e,t){return De(e,t)&&void 0!==e[t]&&null!==e[t]}(e,"menu")},dl=function(e,t){return function(e,t){return t.concat(A(e,(function(e){var t=e.text||e.title;return fl(e)?{text:t,items:dl(e.menu)}:{text:t,value:e.value}})))}(e,t||[])},ml=function(e){return function(t){return Z(t,"rgb")?e.toHex(t):t}},pl=function(e,t){var n=ve.fromDom(t);return{borderwidth:Dt(n,"border-width").getOr(""),borderstyle:Dt(n,"border-style").getOr(""),bordercolor:Dt(n,"border-color").map(ml(e)).getOr(""),backgroundcolor:Dt(n,"background-color").map(ml(e)).getOr("")}},gl=function(e){var t=e[0],n=e.slice(1);return N(n,(function(e){N(Se(t),(function(n){Ee(e,(function(e,r){var o=t[n];""!==o&&n===r&&o!==e&&(t[n]="")}))}))})),t},hl=function(e){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},vl=function(e,t,n,r){return I(e,(function(e){return n.formatter.matchNode(r,t+e)})).getOr("")},bl=r(vl,["left","center","right"],"align"),yl=r(vl,["top","middle","bottom"],"valign"),wl=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Cl=function(e){return wl.concat(function(e){var t=dl(function(e){return e.getParam("table_cell_class_list",[],"array")}(e));return t.length>0?f.some({name:"class",type:"listbox",label:"Class",items:t}):f.none()}(e).toArray())},xl=function(e){return function(t,n){var r=t.dom;return{setAttrib:function(t,o){e&&!o||r.setAttrib(n,t,o)},setStyle:function(t,o){e&&!o||r.setStyle(n,t,o)},setFormat:function(r,o){e&&!o||(""===o?t.formatter.remove(r,{value:null},n,!0):t.formatter.apply(r,{value:o},n))}}}},kl={normal:xl(!1),ifTruthy:xl(!0)},Sl=function(e){return $t(e[0]).map((function(t){var n=tn.fromTable(t),r=tn.justCells(n),o=R(r,(function(t){return E(e,(function(e){return we(t.element,e)}))}));return A(o,(function(e){return{element:e.element.dom,column:tn.getColumnAt(n,e.column).map((function(e){return e.element.dom}))}}))}))},Tl=function(e,t,n){var r=1===t.length;if(t.length>=1){var o=$t(t[0]);Sl(t).each((function(t){N(t,(function(t){var o=Hu(e,t.element,n.celltype),i=r?kl.normal(e,o):kl.ifTruthy(e,o);!function(e,t,n){e.setAttrib("scope",n.scope),e.setAttrib("class",n.class),e.setStyle("height",Ma(n.height)),t.setStyle("width",Ma(n.width))}(i,t.column.map((function(t){return r?kl.normal(e,t):kl.ifTruthy(e,t)})).getOr(i),n),ya(e)&&function(e,t){e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),e.setFormat("tablecellbordercolor",t.bordercolor),e.setFormat("tablecellborderstyle",t.borderstyle),e.setFormat("tablecellborderwidth",Ma(t.borderwidth))}(i,n),r&&(sl(e,o),function(e,t){cl.each("top middle bottom".split(" "),(function(n){e.formatter.remove("valign"+n,{},t)}))}(e,o)),n.halign&&ll(e,o,n.halign),n.valign&&function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)}(e,o,n.valign)}))})),o.each((function(t){return da(e,t.dom)}))}},El=function(e,t,n){var r=n.getData();n.close(),e.undoManager.transact((function(){Tl(e,t,r),e.focus()}))},_l=function(e,t){var n=Sl(t).map((function(t){return A(t,(function(t){return function(e,t,n,r){var o=e.dom,i=r.getOr(t),a=function(e,t){return o.getStyle(e,t)||o.getAttrib(e,t)};return z({width:a(i,"width"),height:a(t,"height"),scope:o.getAttrib(t,"scope"),celltype:Oa(t),class:o.getAttrib(t,"class",""),halign:bl(e,t),valign:yl(e,t)},n?pl(o,t):{})}(e,t.element,ya(e),t.column)}))}));return gl(n.getOrDie())},Al=function(e,t){var n=$u(Ha(e),t);if(0!==n.length){var o=_l(e,n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Cl(e)},hl("cell")]},a={type:"panel",items:[{type:"grid",columns:2,items:Cl(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:ya(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(El,e,n)})}},Nl=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Rl=function(e){return Nl.concat(function(e){var t=dl(function(e){return e.getParam("table_row_class_list",[],"array")}(e));return t.length>0?f.some({name:"class",type:"listbox",label:"Class",items:t}):f.none()}(e).toArray())},Ol=function(e,t,n,r){var o=1===t.length;N(t,(function(t){r.type!==Oa(t.parentNode)&&zu(e,t,r.type);var i=o?kl.normal(e,t):kl.ifTruthy(e,t);!function(e,t){e.setAttrib("scope",t.scope),e.setAttrib("class",t.class),e.setStyle("height",Ma(t.height))}(i,r),wa(e)&&function(e,t){e.setStyle("background-color",t.backgroundcolor),e.setStyle("border-color",t.bordercolor),e.setStyle("border-style",t.borderstyle)}(i,r),r.align!==n.align&&(sl(e,t),ll(e,t,r.align))})),$t(ve.fromDom(t[0])).each((function(t){return da(e,t.dom)}))},Dl=function(e,t,n,r){var o=r.getData();r.close(),e.undoManager.transact((function(){Ol(e,t,n,o),e.focus()}))},Il=function(e){var t=Ku(Ha(e),wr.selected);if(0!==t.length){var n=A(t,(function(t){return function(e,t,n){var r=e.dom;return z({height:r.getStyle(t,"height")||r.getAttrib(t,"height"),scope:r.getAttrib(t,"scope"),class:r.getAttrib(t,"class",""),type:Fu(0,t),align:bl(e,t)},n?pl(r,t):{})}(e,t.dom,wa(e))})),o=gl(n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Rl(e)},hl("row")]},a={type:"panel",items:[{type:"grid",columns:2,items:Rl(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:wa(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(Dl,e,A(t,(function(e){return e.dom})),o)})}},Pl=tinymce.util.Tools.resolve("tinymce.Env"),Bl=function(e,t,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(e){return e.getParam("table_appearance_options",!0,"boolean")}(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},Ml=function(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)p(n)?e.setStyle(t,n,r):e.setStyle(t,n);else if(t.children)for(var o=0;o<t.children.length;o++)Ml(e,t.children[o],n,r)},Ll=function(e,t,n){var r,o=e.dom,i=n.getData();n.close(),""===i.class&&delete i.class,e.undoManager.transact((function(){if(!t){var n=parseInt(i.cols,10)||1,a=parseInt(i.rows,10)||1;t=Zu(e,n,a,0,0)}!function(e,t,n){var r,o=e.dom,i={},a={};if(i.class=n.class,a.height=Ma(n.height),o.getAttrib(t,"width")&&!xa(e)?i.width=(r=n.width)?r.replace(/px$/,""):"":a.width=Ma(n.width),xa(e)?(a["border-width"]=Ma(n.border),a["border-spacing"]=Ma(n.cellspacing)):(i.border=n.border,i.cellpadding=n.cellpadding,i.cellspacing=n.cellspacing),xa(e)&&t.children)for(var c=0;c<t.children.length;c++)Ml(o,t.children[c],{"border-width":Ma(n.border),padding:Ma(n.cellpadding)}),Ca(e)&&Ml(o,t.children[c],{"border-color":n.bordercolor});Ca(e)&&(a["background-color"]=n.backgroundcolor,a["border-color"]=n.bordercolor,a["border-style"]=n.borderstyle),i.style=o.serializeStyle(z(z({},ba(e)),a)),o.setAttribs(t,z(z({},va(e)),i)),da(e,t)}(e,t,i),(r=o.select("caption",t)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=Pl.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),""===i.align?sl(e,t):ll(e,t,i.align),e.focus(),e.addVisual()}))},Fl=function(e,t){var n,o=e.dom,i=function(e,t){var n,r,o,i,a=ba(e),c=va(e),u=t?(n=e.dom,{borderstyle:Oe(a,"border-style").getOr(""),bordercolor:ml(n)(Oe(a,"border-color").getOr("")),backgroundcolor:ml(n)(Oe(a,"background-color").getOr(""))}):{};return z(z(z(z(z(z({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),c),u),(i=a["border-width"],xa(e)&&i?{border:i}:Oe(c,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(r=Oe(a,"border-spacing").or(Oe(c,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),o=Oe(a,"border-padding").or(Oe(c,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),z(z({},r),o)))}(e,Ca(e));!1===t?(n=o.getParent(e.selection.getStart(),"table"))?i=function(e,t,n){var r=e.dom;return z({width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"),cellpadding:r.getAttrib(t,"cellpadding")||ul(e.dom,t,"padding"),border:function(t,n){var r=Dt(ve.fromDom(n),"border-width");return xa(e)&&r.isSome()?r.getOr(""):t.getAttrib(n,"border")||ul(e.dom,n,"border-width")||ul(e.dom,n,"border")}(r,t),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:bl(e,t)},n?pl(r,t):{})}(e,n,Ca(e)):Ca(e)&&(i.borderstyle="",i.bordercolor="",i.backgroundcolor=""):(i.cols="1",i.rows="1",Ca(e)&&(i.borderstyle="",i.bordercolor="",i.backgroundcolor=""));var a=dl(function(e){return e.getParam("table_class_list",[],"array")}(e));a.length>0&&i.class&&(i.class=i.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:Bl(e,a,t)},u=Ca(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},hl("table")]}:{type:"panel",items:[c]};e.windowManager.open({title:"Table Properties",size:"normal",body:u,onSubmit:r(Ll,e,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i})},jl=function(e){return Vu(Ha(e))},Hl=function(e){return qu(Ha(e))},Ul=function(t,n,o,a,c){var u=Ba(t),l=function(e){return $t(e,u)},s=function(e){return function(n){t.selection.setRng(n),t.focus(),o.clear(e),La(e),da(t,e.dom)}},d=function(e){return Hl(t).each((function(t){l(t).each((function(n){var r=xr(a,n,t);e(n,r).each(s(n))}))}))},m=function(){return Hl(t).map((function(n){return l(n).bind((function(r){var o=xr(a,r,n),i=pr(e,ve.fromDom(t.getDoc()),f.none());return al(r,o,i)}))}))},h=function(){return Hl(t).map((function(e){return l(e).bind((function(t){var n=xr(a,t,e);return il(t,n)}))}))},v=function(e,n){return n().each((function(n){var r=A(n,(function(e){return ir(e)}));Hl(t).each((function(n){return l(n).each((function(n){var o=gr(ve.fromDom(t.getDoc())),i=function(e,t,n,r){return{selection:vr(e),clipboard:n,generators:r}}(a,0,r,o);e(n,i).each(s(n))}))}))}))};Ee({mceTableSplitCells:function(){return d(n.unmergeCells)},mceTableMergeCells:function(){return d(n.mergeCells)},mceTableInsertRowBefore:function(){return d(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return d(n.insertRowsAfter)},mceTableInsertColBefore:function(){return d(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return d(n.insertColumnsAfter)},mceTableDeleteCol:function(){return d(n.deleteColumn)},mceTableDeleteRow:function(){return d(n.deleteRow)},mceTableCutCol:function(e){return h().each((function(e){c.setColumns(e),d(n.deleteColumn)}))},mceTableCutRow:function(e){return m().each((function(e){c.setRows(e),d(n.deleteRow)}))},mceTableCopyCol:function(e){return h().each((function(e){return c.setColumns(e)}))},mceTableCopyRow:function(e){return m().each((function(e){return c.setRows(e)}))},mceTablePasteColBefore:function(e){return v(n.pasteColsBefore,c.getColumns)},mceTablePasteColAfter:function(e){return v(n.pasteColsAfter,c.getColumns)},mceTablePasteRowBefore:function(e){return v(n.pasteRowsBefore,c.getRows)},mceTablePasteRowAfter:function(e){return v(n.pasteRowsAfter,c.getRows)},mceTableDelete:function(){return jl(t).each((function(e){$t(e,u).filter(i(u)).each((function(e){var n=ve.fromText("");if(pn(e,n),Cn(e),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(n.dom,0),r.setEnd(n.dom,0),t.selection.setRng(r),t.nodeChanged()}}))}))},mceTableSizingMode:function(e,n){return function(e){return jl(t).each((function(n){Ta(t)||Sa(t)||ka(t)||$t(n,u).each((function(n){"relative"!==e||mi(n)?"fixed"!==e||pi(n)?"responsive"!==e||gi(n)||Za(n):Qa(t,n):Ya(t,n),La(n),da(t,n.dom)}))}))}(n)}},(function(e,n){return t.addCommand(n,e)}));var b=function(e,t){t.each((function(t){da(e,t.dom)}))};Ee({mceTableCellType:function(e,r){var o=$t(Ha(t),u);n.setTableCellType(t,r),b(t,o)},mceTableRowType:function(e,r){var o=$t(Ha(t),u);n.setTableRowType(t,r),b(t,o)}},(function(e,n){return t.addCommand(n,e)})),t.addCommand("mceTableColType",(function(e,t){return Oe(t,"type").each((function(e){return d("th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader)}))})),Ee({mceTableProps:r(Fl,t,!1),mceTableRowProps:r(Il,t),mceTableCellProps:r(Al,t,a)},(function(e,n){return t.addCommand(n,(function(){return e()}))})),t.addCommand("mceInsertTable",(function(e,n){g(n)&&Se(n).length>0?el(t,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):Fl(t,!0)})),t.addCommand("mceTableApplyCellStyle",(function(e,n){var r=function(e){return"tablecell"+e.toLowerCase().replace("-","")};if(g(n)){var o=$u(Ha(t),a);if(0!==o.length){var i=Ne(n,(function(e,n){return t.formatter.has(r(n))&&p(e)}));(function(e){for(var t in e)if(Te.call(e,t))return!1;return!0})(i)||(Ee(i,(function(e,n){N(o,(function(o){kl.normal(t,o.dom).setFormat(r(n),e)}))})),l(o[0]).each((function(e){return da(t,e.dom,{structure:!1,style:!0})})))}}}))},zl=function(e,t,n){var r=Ba(e);Ee({mceTableRowType:function(){return t.getTableRowType(e)},mceTableCellType:function(){return t.getTableCellType(e)},mceTableColType:function(){return qu(Ha(e)).bind((function(e){return function(e){return $t(e,r)}(e).map((function(r){var o=xr(n,r,e);return t.getTableColType(r,o)}))})).getOr("")}},(function(t,n){return e.addQueryValueHandler(n,t)}))},Wl={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},ql=zn([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Vl=z(z({},ql),{none:function(e){return void 0===e&&(e=void 0),ql.none(e)}}),$l=function(e,t){return $t(e,t).bind((function(t){var n=qt(t);return P(n,(function(t){return we(e,t)})).map((function(e){return{index:e,all:n}}))}))},Kl=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},Jl=zn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Gl={before:Jl.before,on:Jl.on,after:Jl.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(n,n,n)}},Xl=zn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Yl={domRange:Xl.domRange,relative:Xl.relative,exact:Xl.exact,exactFromRange:function(e){return Xl.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t,n=function(e){return e.match({domRange:function(e){return ve.fromDom(e.startContainer)},relative:function(e,t){return Gl.getStart(e)},exact:function(e,t,n,r){return e}})}(e);return t=n,ve.fromDom(Ke(t).dom.defaultView)},range:Kl},Ql=function(e,t){return e.selectNodeContents(t.dom)},Zl=function(e,t,n){var r,o=e.document.createRange();return r=o,t.fold((function(e){r.setStartBefore(e.dom)}),(function(e,t){r.setStart(e.dom,t)}),(function(e){r.setStartAfter(e.dom)})),function(e,t){t.fold((function(t){e.setEndBefore(t.dom)}),(function(t,n){e.setEnd(t.dom,n)}),(function(t){e.setEndAfter(t.dom)}))}(o,n),o},es=function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},ts=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}},ns=zn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),rs=function(e,t,n){return t(ve.fromDom(n.startContainer),n.startOffset,ve.fromDom(n.endContainer),n.endOffset)},os=function(e,n){return function(e,t){var n=t.ltr();return n.collapsed?t.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return ns.rtl(ve.fromDom(e.endContainer),e.endOffset,ve.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return rs(0,ns.ltr,n)})):rs(0,ns.ltr,n)}(0,function(e,n){return n.match({domRange:function(e){return{ltr:t(e),rtl:f.none}},relative:function(t,n){return{ltr:q((function(){return Zl(e,t,n)})),rtl:q((function(){return f.some(Zl(e,n,t))}))}},exact:function(t,n,r,o){return{ltr:q((function(){return es(e,t,n,r,o)})),rtl:q((function(){return f.some(es(e,r,o,t,n))}))}}})}(e,n))},is=function(e,t){return os(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(r.dom,o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,n),i}})},as=(ns.ltr,ns.rtl,function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}),cs=function(e,t,n,r,o){var i=function(n){var r=e.dom.createRange();return r.setStart(t.dom,n),r.collapse(!0),r},a=Sn(t).length,c=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,a=1;a<o;a++){var c=e(a),u=Math.abs(t-c.left);if(n<=c.bottom){if(n<c.top||u>i)return a-1;i=u}}return 0}((function(e){return i(e).getBoundingClientRect()}),n,r,o.right,a);return i(c)},us=function(e,t,n,r){return We(t)?function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getClientRects();return U(i,(function(e){return as(e,n,r)?f.some(e):f.none()})).map((function(o){return cs(e,t,n,r,o)}))}(e,t,n,r):function(e,t,n,r){var o=e.dom.createRange(),i=Qe(t);return U(i,(function(t){return o.selectNode(t.dom),as(o.getBoundingClientRect(),n,r)?us(e,t,n,r):f.none()}))}(e,t,n,r)},ls=function(e,t){return t-e.left<e.right-t},ss=function(e,t,n){var r=e.dom.createRange();return r.selectNode(t.dom),r.collapse(n),r},fs=function(e,t,n){var r=e.dom.createRange();r.selectNode(t.dom);var o=r.getBoundingClientRect(),i=ls(o,n);return(!0===i?er:tr)(t).map((function(t){return ss(e,t,i)}))},ds=function(e,t,n){var r=t.dom.getBoundingClientRect(),o=ls(r,n);return f.some(ss(e,t,o))},ms=function(e,t,n){return f.from(e.dom.caretPositionFromPoint(t,n)).bind((function(t){if(null===t.offsetNode)return f.none();var n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),f.some(n)}))},ps=function(e,t,n){return f.from(e.dom.caretRangeFromPoint(t,n))},gs=function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect();return function(e,t,n,r){var o=e.dom.createRange();o.selectNode(t.dom);var i=o.getBoundingClientRect(),a=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return us(e,t,a,c)}(e,t,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))},hs=function(e,t,n){return ve.fromPoint(e,t,n).bind((function(r){var o=function(){return function(e,t,n){return(0===Qe(t).length?ds:fs)(e,t,n)}(e,r,t)};return 0===Qe(r).length?o():gs(e,r,t,n).orThunk(o)}))},vs=document.caretPositionFromPoint?ms:document.caretRangeFromPoint?ps:hs,bs=function(e,t){var n=Fe(e);return"input"===n?Gl.after(e):T(["br","img"],n)?0===t?Gl.before(e):Gl.after(e):Gl.on(e,t)},ys=function(e,t){var n=e.fold(Gl.before,bs,Gl.after),r=t.fold(Gl.before,bs,Gl.after);return Yl.relative(n,r)},ws=function(e,t,n,r){var o=bs(e,t),i=bs(n,r);return Yl.relative(o,i)},Cs=function(e,t,n,r){var o=function(e,t,n,r){var o=$e(e).dom.createRange();return o.setStart(e.dom,t),o.setEnd(n.dom,r),o}(e,t,n,r),i=we(e,n)&&t===r;return o.collapsed&&!i},xs=function(e){return f.from(e.getSelection())},ks=function(e,t){xs(e).each((function(e){e.removeAllRanges(),e.addRange(t)}))},Ss=function(e,t,n,r,o){var i=es(e,t,n,r,o);ks(e,i)},Ts=function(e,t){return os(e,t).match({ltr:function(t,n,r,o){Ss(e,t,n,r,o)},rtl:function(t,n,r,o){xs(e).each((function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,n,r.dom,o);else if(i.extend)try{!function(e,t,n,r,o,i){t.collapse(n.dom,r),t.extend(o.dom,i)}(0,i,t,n,r,o)}catch(i){Ss(e,r,o,t,n)}else Ss(e,r,o,t,n)}))}})},Es=function(e,t,n,r,o){var i=ws(t,n,r,o);Ts(e,i)},_s=function(e,t,n){var r=ys(t,n);Ts(e,r)},As=function(e){var t=Yl.getWin(e).dom,n=function(e,n,r,o){return es(t,e,n,r,o)},r=function(e){return e.match({domRange:function(e){var t=ve.fromDom(e.startContainer),n=ve.fromDom(e.endContainer);return ws(t,e.startOffset,n,e.endOffset)},relative:ys,exact:ws})}(e);return os(t,r).match({ltr:n,rtl:n})},Ns=function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return f.some(Kl(ve.fromDom(t.startContainer),t.startOffset,ve.fromDom(n.endContainer),n.endOffset))}return f.none()},Rs=function(e){if(null===e.anchorNode||null===e.focusNode)return Ns(e);var t=ve.fromDom(e.anchorNode),n=ve.fromDom(e.focusNode);return Cs(t,e.anchorOffset,n,e.focusOffset)?f.some(Kl(t,e.anchorOffset,n,e.focusOffset)):Ns(e)},Os=function(e,t){var n=function(e,t){var n=e.document.createRange();return Ql(n,t),n}(e,t);ks(e,n)},Ds=function(e){return function(e){return xs(e).filter((function(e){return e.rangeCount>0})).bind(Rs)}(e).map((function(e){return Yl.exact(e.start,e.soffset,e.finish,e.foffset)}))},Is=function(e,t){return function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?f.some(n).map(ts):f.none()}(is(e,t))},Ps=function(e,t,n){return function(e,t,n){var r=ve.fromDom(e.document);return vs(r,t,n).map((function(e){return Kl(ve.fromDom(e.startContainer),e.startOffset,ve.fromDom(e.endContainer),e.endOffset)}))}(e,t,n)},Bs=tinymce.util.Tools.resolve("tinymce.util.VK"),Ms=function(e,t,n,r){return js(e,t,function(e,t){return $l(e,t).fold((function(){return Vl.none(e)}),(function(t){return t.index+1<t.all.length?Vl.middle(e,t.all[t.index+1]):Vl.last(e)}))}(n),r)},Ls=function(e,t,n,r){return js(e,t,function(e,t){return $l(e,t).fold((function(){return Vl.none()}),(function(t){return t.index-1>=0?Vl.middle(e,t.all[t.index-1]):Vl.first(e)}))}(n),r)},Fs=function(e,t){var n=Yl.exact(t,0,t,0);return As(n)},js=function(e,t,n,r){return n.fold(f.none,f.none,(function(e,t){return er(t).map((function(e){return Fs(0,e)}))}),(function(n){return $t(n,t).bind((function(t){var o=Cr(n);return e.undoManager.transact((function(){r.insertRowsAfter(t,o)})),function(e,t){var n=dt(t,"tr");return H(n).bind((function(e){return vt(e,"td,th").map((function(e){return Fs(0,e)}))}))}(0,t)}))}))},Hs=["table","li","dl"],Us=function(e,t){return{selection:e,kill:t}},zs=function(e,t,n,r){return{start:Gl.on(e,t),finish:Gl.on(n,r)}},Ws=function(e,t){var n=is(e,t);return Kl(ve.fromDom(n.startContainer),n.startOffset,ve.fromDom(n.endContainer),n.endOffset)},qs=zs,Vs=function(e,t,n,r,o){return we(n,r)?f.none():Mn(n,r,t).bind((function(t){var r=t.boxes.getOr([]);return r.length>0?(o(e,r,t.start,t.finish),f.some(Us(f.some(qs(n,0,n,Yn(n))),!0))):f.none()}))},$s=function(e,t){return{item:e,mode:t}},Ks=function(e,t,n,r){return void 0===r&&(r=Js),e.property().parent(t).map((function(e){return $s(e,r)}))},Js=function(e,t,n,r){return void 0===r&&(r=Gs),n.sibling(e,t).map((function(e){return $s(e,r)}))},Gs=function(e,t,n,r){void 0===r&&(r=Gs);var o=e.property().children(t);return n.first(o).map((function(e){return $s(e,r)}))},Xs=[{current:Ks,next:Js,fallback:f.none()},{current:Js,next:Gs,fallback:f.some(Ks)},{current:Gs,next:Gs,fallback:f.some(Js)}],Ys=function(e,t,n,r,o){return void 0===o&&(o=Xs),I(o,(function(e){return e.current===n})).bind((function(n){return n.current(e,t,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Ys(e,t,n,r)}))}))}))},Qs=function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?f.some(e[e.length-1]):f.none()}}},Zs=function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?f.some(e[0]):f.none()}}},ef=function(e,t,n,r,o,i){return Ys(e,t,r,o).bind((function(t){return i(t.item)?f.none():n(t.item)?f.some(t.item):ef(e,t.item,n,t.mode,o,i)}))},tf=function(e){return function(t){return 0===e.property().children(t).length}},nf=function(e,t,n,r){return ef(e,t,n,Js,Qs(),r)},rf=function(e,t,n,r){return ef(e,t,n,Js,Zs(),r)},of=An(),af=function(e,t){return function(e,t,n){return nf(e,t,tf(e),n)}(of,e,t)},cf=function(e,t){return function(e,t,n){return rf(e,t,tf(e),n)}(of,e,t)},uf=zn([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),lf=function(e){return bt(e,"tr")},sf=z(z({},uf),{verify:function(e,t,n,r,o,i,a){return bt(r,"td,th",a).bind((function(n){return bt(t,"td,th",a).map((function(t){return we(n,t)?we(r,n)&&Yn(n)===o?i(t):uf.none("in same cell"):Pn(lf,[n,t]).fold((function(){return function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right}(e,t,n)?uf.success():i(t)}),(function(e){return i(t)}))}))})).getOr(uf.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)}}),ff=function(e,t){return P(e,r(we,t))},df=function(e){return"br"===Fe(e)},mf=function(e,t,n){return t(e,n).bind((function(e){return We(e)&&0===Sn(e).trim().length?mf(e,t,n):f.some(e)}))},pf=function(e,t,n,r){return function(e,t){return Ze(e,t).filter(df).orThunk((function(){return Ze(e,t-1).filter(df)}))}(t,n).bind((function(t){return r.traverse(t).fold((function(){return mf(t,r.gather,e).map(r.relative)}),(function(e){return function(e){return Je(e).bind((function(t){var n=Qe(t);return ff(n,e).map((function(r){return function(e,t,n,r){return{parent:e,children:t,element:n,index:r}}(t,n,e,r)}))}))}(e).map((function(e){return Gl.on(e.parent,e.index)}))}))}))},gf=function(e,t,n,r){return(df(t)?function(e,t,n){return n.traverse(t).orThunk((function(){return mf(t,n.gather,e)})).map(n.relative)}(e,t,r):pf(e,t,n,r)).map((function(e){return{start:e,finish:e}}))},hf=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},vf=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},bf=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},yf=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},wf=function(e,t){return f.some(e.getRect(t))},Cf=function(e,t,n){return ze(t)?wf(e,t).map(yf):We(t)?function(e,t,n){return n>=0&&n<Yn(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):f.none()}(e,t,n).map(yf):f.none()},xf=function(e,t){return ze(t)?wf(e,t).map(yf):We(t)?e.getRangedRect(t,0,t,Yn(t)).map(yf):f.none()},kf=zn([{none:[]},{retry:["caret"]}]),Sf=function(e,t,n){return(r=t,o=au,mt((function(e,t){return t(e)}),pt,r,o,i)).fold(a,(function(t){return xf(e,t).exists((function(e){return function(e,t){return e.left<t.left||Math.abs(t.right-e.left)<1||e.left>t.right}(n,e)}))}));var r,o,i},Tf={point:function(e){return e.bottom},adjuster:function(e,t,n,r,o){var i=hf(o,5);return Math.abs(n.bottom-r.bottom)<1||n.top>o.bottom?kf.retry(i):n.top===o.bottom?kf.retry(hf(o,1)):Sf(e,t,o)?kf.retry(bf(i,5,0)):kf.none()},move:hf,gather:cf},Ef=function(e,t,n,r,o){return 0===o?f.some(r):function(e,t,n){return e.elementFromPoint(t,n).filter((function(e){return"table"===Fe(e)})).isSome()}(e,r.left,t.point(r))?function(e,t,n,r,o){return Ef(e,t,n,t.move(r,5),o)}(e,t,n,r,o-1):e.situsFromPoint(r.left,t.point(r)).bind((function(i){return i.start.fold(f.none,(function(i){return xf(e,i).bind((function(a){return t.adjuster(e,i,a,n,r).fold(f.none,(function(r){return Ef(e,t,n,r,o-1)}))})).orThunk((function(){return f.some(r)}))}),f.none)}))},_f=function(e,t,n){var r=e.move(n,5),o=Ef(t,e,n,r,100).getOr(r);return function(e,t,n){return e.point(t)>n.getInnerHeight()?f.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?f.some(-e.point(t)):f.none()}(e,o,t).fold((function(){return t.situsFromPoint(o.left,e.point(o))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left,e.point(o)-n)}))},Af={tryUp:r(_f,{point:function(e){return e.top},adjuster:function(e,t,n,r,o){var i=vf(o,5);return Math.abs(n.top-r.top)<1||n.bottom<o.top?kf.retry(i):n.bottom===o.top?kf.retry(vf(o,1)):Sf(e,t,o)?kf.retry(bf(i,5,0)):kf.none()},move:vf,gather:af}),tryDown:r(_f,Tf),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:t(5)},Nf=function(e,t,n){return e.getSelection().bind((function(r){return gf(t,r.finish,r.foffset,n).fold((function(){return f.some(rc(r.finish,r.foffset))}),(function(o){var i=e.fromSitus(o);return function(e){return sf.cata(e,(function(e){return f.none()}),(function(){return f.none()}),(function(e){return f.some(rc(e,0))}),(function(e){return f.some(rc(e,Yn(e)))}))}(sf.verify(e,r.finish,r.foffset,i.finish,i.foffset,n.failure,t))}))}))},Rf=function(e,t,n,r,o,i){return 0===i?f.none():If(e,t,n,r,o).bind((function(a){var c=e.fromSitus(a),u=sf.verify(e,n,r,c.finish,c.foffset,o.failure,t);return sf.cata(u,(function(){return f.none()}),(function(){return f.some(a)}),(function(a){return we(n,a)&&0===r?Of(e,n,r,vf,o):Rf(e,t,a,0,o,i-1)}),(function(a){return we(n,a)&&r===Yn(a)?Of(e,n,r,hf,o):Rf(e,t,a,Yn(a),o,i-1)}))}))},Of=function(e,t,n,r,o){return Cf(e,t,n).bind((function(t){return Df(e,o,r(t,Af.getJumpSize()))}))},Df=function(e,t,n){var r=ge().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?t.otherRetry(e,n):r.isIE()?t.ieRetry(e,n):f.none()},If=function(e,t,n,r,o){return Cf(e,n,r).bind((function(t){return Df(e,o,t)}))},Pf=function(e,t){return pt(e,(function(e){return Je(e).exists((function(e){return we(e,t)}))}),n).isSome();var n},Bf=function(e,t,n,r,o){return bt(r,"td,th",t).bind((function(r){return bt(r,"table",t).bind((function(i){return Pf(o,i)?function(e,t,n){return Nf(e,t,n).bind((function(r){return Rf(e,t,r.element,r.offset,n,20).map(e.fromSitus)}))}(e,t,n).bind((function(e){return bt(e.finish,"td,th",t).map((function(t){return{start:r,finish:t,range:e}}))})):f.none()}))}))},Mf=function(e,t,n,r,o,i){return ge().browser.isIE()?f.none():i(r,t).orThunk((function(){return Bf(e,t,n,r,o).map((function(e){var t=e.range;return Us(f.some(qs(t.start,t.soffset,t.finish,t.foffset)),!0)}))}))},Lf=function(e,t){return bt(e,"tr",t).bind((function(e){return bt(e,"table",t).bind((function(n){var r=dt(n,"tr");return we(e,r[0])?function(e,t,n){return nf(of,e,t,n)}(n,(function(e){return tr(e).isSome()}),t).map((function(e){var t=Yn(e);return Us(f.some(qs(e,t,e,t)),!0)})):f.none()}))}))},Ff=function(e,t){return bt(e,"tr",t).bind((function(e){return bt(e,"table",t).bind((function(n){var r=dt(n,"tr");return we(e,r[r.length-1])?function(e,t,n){return rf(of,e,t,n)}(n,(function(e){return er(e).isSome()}),t).map((function(e){return Us(f.some(qs(e,0,e,0)),!0)})):f.none()}))}))},jf=function(e,t,n,r,o,i,a){return Bf(e,n,r,o,i).bind((function(e){return Vs(t,n,e.start,e.finish,a)}))},Hf=function(e,t){return bt(e,"td,th",t)};function Uf(e,t,n,r){var o,i=(o=Ua(f.none()),{clear:function(){return o.set(f.none())},set:function(e){return o.set(f.some(e))},isSet:function(){return o.get().isSome()},on:function(e){return o.get().each(e)}}),a=i.clear;return{clearstate:a,mousedown:function(e){r.clear(t),Hf(e.target,n).each(i.set)},mouseover:function(o){i.on((function(i){r.clearBeforeUpdate(t),Hf(o.target,n).each((function(o){Mn(i,o,n).each((function(n){var a=n.boxes.getOr([]);(a.length>1||1===a.length&&!we(i,o))&&(r.selectRange(t,a,n.start,n.finish),e.selectContents(o))}))}))}))},mouseup:function(e){a()}}}var zf={traverse:Ye,gather:cf,relative:Gl.before,otherRetry:Af.tryDown,ieRetry:Af.ieTryDown,failure:sf.failedDown},Wf={traverse:Xe,gather:af,relative:Gl.before,otherRetry:Af.tryUp,ieRetry:Af.ieTryUp,failure:sf.failedUp},qf=function(e){return function(t){return t===e}},Vf=qf(38),$f=qf(40),Kf=function(e){return e>=37&&e<=40},Jf={isBackward:qf(37),isForward:qf(39)},Gf={isBackward:qf(39),isForward:qf(37)},Xf=function(e){return{elementFromPoint:function(t,n){return ve.fromPoint(ve.fromDom(e.document),t,n)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=Yl.exact(t,n,r,o);return Is(e,i)},getSelection:function(){return Ds(e).map((function(t){return Ws(e,t)}))},fromSitus:function(t){var n=Yl.relative(t.start,t.finish);return Ws(e,n)},situsFromPoint:function(t,n){return Ps(e,t,n).map((function(e){return zs(e.start,e.soffset,e.finish,e.foffset)}))},clearSelection:function(){!function(e){xs(e).each((function(e){return e.removeAllRanges()}))}(e)},collapseSelection:function(t){void 0===t&&(t=!1),Ds(e).each((function(n){return n.fold((function(e){return e.collapse(t)}),(function(n,r){var o=t?n:r;_s(e,o,o)}),(function(n,r,o,i){var a=t?n:o,c=t?r:i;Es(e,a,c,a,c)}))}))},setSelection:function(t){Es(e,t.start,t.soffset,t.finish,t.foffset)},setRelativeSelection:function(t,n){_s(e,t,n)},selectContents:function(t){Os(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var t,n,r,o;return(t=ve.fromDom(e.document),n=void 0!==t?t.dom:document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop,Vr(r,o)).top},scrollBy:function(t,n){!function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollBy(e,t)}(t,n,ve.fromDom(e.document))}}},Yf=function(e,t){return{rows:e,cols:t}},Qf=function(e,t,n,o){var i=Xf(e),a=function(){return o.clear(t),f.none()};return{keydown:function(e,c,u,l,s,d){var m=e.raw,p=m.which,g=!0===m.shiftKey;return Ln(t,o.selectedSelector).fold((function(){return $f(p)&&g?r(jf,i,t,n,zf,l,c,o.selectRange):Vf(p)&&g?r(jf,i,t,n,Wf,l,c,o.selectRange):$f(p)?r(Mf,i,n,zf,l,c,Ff):Vf(p)?r(Mf,i,n,Wf,l,c,Lf):f.none}),(function(e){var n=function(n){return function(){return U(n,(function(n){return function(e,t,n,r,o){return jn(r,e,t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){return o.clearBeforeUpdate(n),o.selectRange(n,e.boxes,e.start,e.finish),e.boxes}))}(n.rows,n.cols,t,e,o)})).fold((function(){return Fn(t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){var n=$f(p)||d.isForward(p)?Gl.after:Gl.before;return i.setRelativeSelection(Gl.on(e.first,0),n(e.table)),o.clear(t),Us(f.none(),!0)}))}),(function(e){return f.some(Us(f.none(),!0))}))}};return $f(p)&&g?n([Yf(1,0)]):Vf(p)&&g?n([Yf(-1,0)]):d.isBackward(p)&&g?n([Yf(0,-1),Yf(-1,0)]):d.isForward(p)&&g?n([Yf(0,1),Yf(1,0)]):Kf(p)&&!1===g?a:f.none}))()},keyup:function(e,r,i,a,c){return Ln(t,o.selectedSelector).fold((function(){var u=e.raw,l=u.which;return!1===(!0===u.shiftKey)?f.none():Kf(l)?function(e,t,n,r,o,i,a){return we(n,o)&&r===i?f.none():bt(n,"td,th",t).bind((function(n){return bt(o,"td,th",t).bind((function(r){return Vs(e,t,n,r,a)}))}))}(t,n,r,i,a,c,o.selectRange):f.none()}),f.none)}}},Zf=function(e,t,n){var r=function(t){St(t,e.selected),St(t,e.firstSelected),St(t,e.lastSelected)},o=function(t){wt(t,e.selected,"1")},i=function(e){a(e),n()},a=function(t){var n=dt(t,e.selectedSelector);N(n,r)};return{clearBeforeUpdate:a,clear:i,selectRange:function(n,r,a,c){i(n),N(r,o),wt(a,e.firstSelected,"1"),wt(c,e.lastSelected,"1"),t(r,a,c)},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},ed=function(e,t,n){var r=tn.fromTable(e);return Rc(r,t).map((function(e){var t=kc(r,n,!1);return{upOrLeftCells:function(e,t,n){var r=e.slice(0,t[t.length-1].row+1),o=Tc(r,n);return M(o,(function(e){var n=e.cells.slice(0,t[t.length-1].column+1);return A(n,(function(e){return e.element}))}))}(t,e,n),downOrRightCells:function(e,t,n){var r=e.slice(t[0].row+t[0].rowspan-1,e.length),o=Tc(r,n);return M(o,(function(e){var n=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return A(n,(function(e){return e.element}))}))}(t,e,n)}}))},td=function(e){return!1===Hi(ve.fromDom(e.target),"ephox-snooker-resizer-bar")};function nd(t,n,r){var o=Zf(wr,(function(n,o,i){r.targets().each((function(r){$t(o).each((function(a){var c=Ra(t),u=pr(e,ve.fromDom(t.getDoc()),c),l=ed(a,r,u);!function(e,t,n,r,o){e.fire("TableSelectionChange",{cells:t,start:n,finish:r,otherCells:o})}(t,n,o,i,l)}))}))}),(function(){return function(e){e.fire("TableSelectionClear")}(t)}));return t.on("init",(function(r){var i=t.getWin(),a=Da(t),c=Ba(t),u=function(e,t,n,r){var o=Uf(Xf(e),t,n,r);return{clearstate:o.clearstate,mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(i,a,c,o),l=Qf(i,a,c,o),s=function(e,t,n,r){var o=Xf(e);return function(e,i){r.clearBeforeUpdate(t),Mn(e,i,n).each((function(e){var n=e.boxes.getOr([]);r.selectRange(t,n,e.start,e.finish),o.selectContents(i),o.collapseSelection()}))}}(i,a,c,o);t.on("TableSelectorChange",(function(e){return s(e.start,e.finish)}));var f,d,m=function(e,n){(function(e){return!0===e.raw.shiftKey})(e)&&(n.kill&&e.kill(),n.selection.each((function(e){var n=Yl.relative(e.start,e.finish),r=is(i,n);t.selection.setRng(r)})))},p=function(e){return 0===e.button},g=(f=Ua(ve.fromDom(a)),d=Ua(0),{touchEnd:function(e){var t=ve.fromDom(e.target);if("td"===Fe(t)||"th"===Fe(t)){var n=f.get(),r=d.get();we(n,t)&&e.timeStamp-r<300&&(e.preventDefault(),s(t,t))}f.set(t),d.set(e.timeStamp)}});t.on("dragstart",(function(e){u.clearstate()})),t.on("mousedown",(function(e){p(e)&&td(e)&&u.mousedown(Bi(e))})),t.on("mouseover",(function(e){var t;(void 0===(t=e).buttons||Pl.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&td(e)&&u.mouseover(Bi(e))})),t.on("mouseup",(function(e){p(e)&&td(e)&&u.mouseup(Bi(e))})),t.on("touchend",g.touchEnd),t.on("keyup",(function(e){var n=Bi(e);if(n.raw.shiftKey&&Kf(n.raw.which)){var r=t.selection.getRng(),o=ve.fromDom(r.startContainer),i=ve.fromDom(r.endContainer);l.keyup(n,o,r.startOffset,i,r.endOffset).each((function(e){m(n,e)}))}})),t.on("keydown",(function(e){var r=Bi(e);n().each((function(e){return e.hideBars()}));var o=t.selection.getRng(),i=ve.fromDom(o.startContainer),a=ve.fromDom(o.endContainer),c=jr(Jf,Gf)(ve.fromDom(t.selection.getStart()));l.keydown(r,i,o.startOffset,a,o.endOffset,c).each((function(e){m(r,e)})),n().each((function(e){return e.showBars()}))})),t.on("NodeChange",(function(){var n=t.selection,r=ve.fromDom(n.getStart()),i=ve.fromDom(n.getEnd());Pn($t,[r,i]).fold((function(){return o.clear(a)}),e)}))})),{clear:o.clear}}var rd=function(e,t){var n=Ua(f.none()),r=Ua([]),o=function(){return Vu(Ha(e)).bind((function(e){var n=$t(e);return n.map((function(n){return"caption"===Fe(e)?Cr(e):xr(t,n,e)}))}))},i=function(){n.set(q(o)()),N(r.get(),(function(e){return e()}))},a=function(e,t){var o=function(){return n.get().fold((function(){e.setDisabled(!0)}),(function(n){e.setDisabled(t(n))}))};return o(),r.set(r.get().concat([o])),function(){r.set(R(r.get(),(function(e){return e!==o})))}};return e.on("NodeChange ExecCommand TableSelectorChange",i),{onSetupTable:function(e){return a(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return a(e,(function(e){return"caption"===Fe(e.element)}))},onSetupPasteable:function(e){return function(t){return a(t,(function(t){return"caption"===Fe(t.element)||e().isNone()}))}},onSetupMergeable:function(e){return a(e,(function(e){return e.mergable.isNone()}))},onSetupUnmergeable:function(e){return a(e,(function(e){return e.unmergable.isNone()}))},resetTargets:i,targets:function(){return n.get()}}};function od(e){var t=function(e,t,n){return{get:function(){return Hn(e(),n).fold((function(){return t().map(Kn).getOrThunk(Vn)}),(function(e){return $n(e)}))}}}((function(){return Da(e)}),(function(){return Vu(Ha(e))}),wr.selectedSelector),n=rd(e,t),r=nc(e),o=nd(e,r.lazyResize,n),i=Ju(e,r.lazyWire,t),a=function(){var e=Ua(f.none()),t=Ua(f.none()),n=function(e){e.set(f.none())};return{getRows:e.get,setRows:function(r){e.set(r),n(t)},clearRows:function(){return n(e)},getColumns:t.get,setColumns:function(r){t.set(r),n(e)},clearColumns:function(){return n(t)}}}();return Ul(e,i,o,t,a),zl(e,i,t),kr(e,t,i,o),function(e,t,n){var r=function(t){return function(){return e.execCommand(t)}},o=function(t){e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},i={text:"Table properties",onSetup:t.onSetupTable,onAction:r("mceTableProps")},a={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:r("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)});e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(n.getColumns)});e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:t.onSetupUnmergeable});!1===function(e){return e.getParam("table_grid",!0,"boolean")}(e)?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",i),e.ui.registry.addMenuItem("deletetable",a),e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter"}}),e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(e){return"caption"===Fe(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(e,n,a),function(e,t,n){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"})}(e,n,a),function(e){var t=function(e){return e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(e);t.length>0&&e.ui.registry.addContextToolbar("table",{predicate:function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},items:t,scope:"node",position:"node"})}(e),e.on("PreInit",(function(){e.serializer.addTempAttr(wr.firstSelected),e.serializer.addTempAttr(wr.lastSelected),function(e){e.formatter.register(Wl)}(e)})),function(e){return e.getParam("table_tab_navigation",!0,"boolean")}(e)&&e.on("keydown",(function(t){!function(e,t,n){if(e.keyCode===Bs.TAB){var r=Da(t),o=function(e){var t=Fe(e);return we(e,r)||T(Hs,t)},i=t.selection.getRng();if(i.collapsed){var a=ve.fromDom(i.startContainer);Wt(a,o).each((function(r){e.preventDefault(),(e.shiftKey?Ls:Ms)(t,o,r,n).each((function(e){t.selection.setRng(e)}))}))}}}(t,e,i)})),e.on("remove",(function(){r.destroy()})),function(e,t,n,r){return{insertTable:rl(e),setClipboardRows:nl(t.setRows),getClipboardRows:tl(t.getRows),setClipboardCols:nl(t.setColumns),getClipboardCols:tl(t.getColumns),resizeHandler:n,selectionTargets:r}}(e,a,r,n)}Jn.add("table",od)}()},"./node_modules/tinymce/tinymce.js":function(e,t,n){(function(t,n){!function(){"use strict";var r=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},o=function(e){return{eq:e}},i=o((function(e,t){return e===t})),a=function(e){return o((function(t,n){if(t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e.eq(t[o],n[o]))return!1;return!0}))},c=function(e,t){return function(e,t){return o((function(n,r){return e.eq(t(n),t(r))}))}(a(e),(function(e){return function(e,t){return Array.prototype.slice.call(e).sort(t)}(e,t)}))},u=function(e){return o((function(t,n){var r=Object.keys(t),o=Object.keys(n);if(!c(i).eq(r,o))return!1;for(var a=r.length,u=0;u<a;u++){var l=r[u];if(!e.eq(t[l],n[l]))return!1}return!0}))},l=o((function(e,t){if(e===t)return!0;var n=r(e);return n===r(t)&&(function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)}(n)?e===t:"array"===n?a(l).eq(e,t):"object"===n&&u(l).eq(e,t))})),s=function(){},f=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,n))}},d=function(e){return function(){return e}},m=function(e){return e};function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var g=function(e){return function(t){return!e(t)}},h=function(e){return function(){throw new Error(e)}},v=function(e){e()},b=d(!1),y=d(!0),w=function(){return C},C=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e};return{fold:function(e,t){return e()},is:b,isSome:b,isNone:y,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:n,orThunk:t,map:w,each:s,bind:w,exists:b,forall:y,filter:w,equals:e,equals_:e,toArray:function(){return[]},toString:d("none()")}}(),x=function(e){var t=d(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:y,isNone:b,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return x(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:C},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(b,(function(t){return n(e,t)}))}};return o},k={some:x,none:w,from:function(e){return null==e?C:x(e)}},S=function(e){return function(t){return r=typeof(n=t),(null===n?"null":"object"===r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===e;var n,r}},T=function(e){return function(t){return typeof t===e}},E=function(e){return function(t){return e===t}},_=S("string"),A=S("object"),N=S("array"),R=E(null),O=T("boolean"),D=E(void 0),I=function(e){return null==e},P=function(e){return!I(e)},B=T("function"),M=T("number"),L=Array.prototype.slice,F=Array.prototype.indexOf,j=Array.prototype.push,H=function(e,t){return F.call(e,t)},U=function(e,t){return H(e,t)>-1},z=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return!0}return!1},W=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},q=function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}},V=function(e,t){for(var n=e.length-1;n>=0;n--){t(e[n],n)}},$=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r)&&n.push(i)}return n},K=function(e,t,n){return V(e,(function(e){n=t(n,e)})),n},J=function(e,t,n){return q(e,(function(e){n=t(n,e)})),n},G=function(e,t){return function(e,t,n){for(var r=0,o=e.length;r<o;r++){var i=e[r];if(t(i,r))return k.some(i);if(n(i,r))break}return k.none()}(e,t,b)},X=function(e,t){for(var n=0,r=e.length;n<r;n++){if(t(e[n],n))return k.some(n)}return k.none()},Y=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!N(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);j.apply(t,e[n])}return t}(W(e,t))},Q=function(e,t){for(var n=0,r=e.length;n<r;++n){if(!0!==t(e[n],n))return!1}return!0},Z=function(e){var t=L.call(e,0);return t.reverse(),t},ee=function(e,t){return $(e,(function(e){return!U(t,e)}))},te=function(e,t){return t>=0&&t<e.length?k.some(e[t]):k.none()},ne=function(e){return te(e,0)},re=function(e){return te(e,e.length-1)},oe=B(Array.from)?Array.from:function(e){return L.call(e)},ie=Object.keys,ae=Object.hasOwnProperty,ce=function(e,t){for(var n=ie(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}},ue=function(e,t){return le(e,(function(e,n){return{k:n,v:t(e,n)}}))},le=function(e,t){var n={};return ce(e,(function(e,r){var o=t(e,r);n[o.k]=o.v})),n},se=function(e){return function(t,n){e[n]=t}},fe=function(e,t,n,r){return ce(e,(function(e,o){(t(e,o)?n:r)(e,o)})),{}},de=function(e,t){var n={},r={};return fe(e,t,se(n),se(r)),{t:n,f:r}},me=function(e,t){var n={};return fe(e,t,se(n),s),n},pe=function(e){return function(e,t){var n=[];return ce(e,(function(e,r){n.push(t(e,r))})),n}(e,(function(e){return e}))},ge=function(e,t){return he(e,t)?k.from(e[t]):k.none()},he=function(e,t){return ae.call(e,t)},ve=function(e,t){return he(e,t)&&void 0!==e[t]&&null!==e[t]},be=Array.isArray,ye=function(e,t,n){var r,o;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,o=e.length;r<o;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return!1;return!0},we=function(e,t){var n=[];return ye(e,(function(r,o){n.push(t(r,o,e))})),n},Ce=function(e,t){var n=[];return ye(e,(function(r,o){t&&!t(r,o,e)||n.push(r)})),n},xe=function(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},ke=function(e,t,n,r){for(var o=D(n)?e[0]:n,i=0;i<e.length;i++)o=t.call(r,o,e[i],i);return o},Se=function(e,t,n){var r,o;for(r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e))return r;return-1},Te=function(e){return e[e.length-1]},Ee=function(){return(Ee=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function _e(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r}var Ae=function(){return Ne(0,0)},Ne=function(e,t){return{major:e,minor:t}},Re={nu:Ne,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?Ae():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return Ne(r(1),r(2))}(e,n)},unknown:Ae},Oe=function(e,t){var n=String(t).toLowerCase();return G(e,(function(e){return e.search(n)}))},De=function(e,t){return Oe(e,t).map((function(e){var n=Re.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Ie=function(e,t){return Oe(e,t).map((function(e){var n=Re.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Pe=function(e,t){return-1!==e.indexOf(t)},Be=function(e,t){return function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t}(e,t,0)},Me=function(e){return function(t){return t.replace(e,"")}},Le=Me(/^\s+|\s+$/g),Fe=Me(/^\s+/g),je=Me(/\s+$/g),He=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ue=function(e){return function(t){return Pe(t,e)}},ze=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Pe(e,"edge/")&&Pe(e,"chrome")&&Pe(e,"safari")&&Pe(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,He],search:function(e){return Pe(e,"chrome")&&!Pe(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Pe(e,"msie")||Pe(e,"trident")}},{name:"Opera",versionRegexes:[He,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ue("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ue("firefox")},{name:"Safari",versionRegexes:[He,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Pe(e,"safari")||Pe(e,"mobile/"))&&Pe(e,"applewebkit")}}],We=[{name:"Windows",search:Ue("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Pe(e,"iphone")||Pe(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ue("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ue("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ue("linux"),versionRegexes:[]},{name:"Solaris",search:Ue("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ue("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ue("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],qe={browsers:d(ze),oses:d(We)},Ve=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isEdge:r("Edge"),isChrome:r("Chrome"),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r("Firefox"),isSafari:r("Safari")}},$e={unknown:function(){return Ve({current:void 0,version:Re.unknown()})},nu:Ve,edge:d("Edge"),chrome:d("Chrome"),ie:d("IE"),opera:d("Opera"),firefox:d("Firefox"),safari:d("Safari")},Ke=function(e){var t=e.current,n=e.version,r=function(e){return function(){return t===e}};return{current:t,version:n,isWindows:r("Windows"),isiOS:r("iOS"),isAndroid:r("Android"),isOSX:r("OSX"),isLinux:r("Linux"),isSolaris:r("Solaris"),isFreeBSD:r("FreeBSD"),isChromeOS:r("ChromeOS")}},Je={unknown:function(){return Ke({current:void 0,version:Re.unknown()})},nu:Ke,windows:d("Windows"),ios:d("iOS"),android:d("Android"),linux:d("Linux"),osx:d("OSX"),solaris:d("Solaris"),freebsd:d("FreeBSD"),chromeos:d("ChromeOS")},Ge=function(e,t){var n=qe.browsers(),r=qe.oses(),o=De(n,e).fold($e.unknown,$e.nu),i=Ie(r,e).fold(Je.unknown,Je.nu),a=function(e,t,n,r){var o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),c=a||r("(pointer:coarse)"),u=o||!i&&a&&r("(min-device-width:768px)"),l=i||a&&!u,s=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),f=!l&&!u&&!s;return{isiPad:d(o),isiPhone:d(i),isTablet:d(u),isPhone:d(l),isTouch:d(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:d(s),isDesktop:d(f)}}(i,o,e,t);return{browser:o,os:i,deviceType:a}},Xe=function(e){return window.matchMedia(e).matches},Ye=function(e){var t,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,t=e.apply(null,r)),t}}((function(){return Ge(navigator.userAgent,Xe)})),Qe=function(){return Ye()},Ze=navigator.userAgent,et=Qe(),tt=et.browser,nt=et.os,rt=et.deviceType,ot=/WebKit/.test(Ze)&&!tt.isEdge(),it="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,at=-1!==Ze.indexOf("Windows Phone"),ct={opera:tt.isOpera(),webkit:ot,ie:!(!tt.isIE()&&!tt.isEdge())&&tt.version.major,gecko:tt.isFirefox(),mac:nt.isOSX()||nt.isiOS(),iOS:rt.isiPad()||rt.isiPhone(),android:nt.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:tt.isIE()?document.documentMode||7:10,fileApi:it,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!tt.isIE(),desktop:rt.isDesktop(),windowsPhone:at,browser:{current:tt.current,version:tt.version,isChrome:tt.isChrome,isEdge:tt.isEdge,isFirefox:tt.isFirefox,isIE:tt.isIE,isOpera:tt.isOpera,isSafari:tt.isSafari},os:{current:nt.current,version:nt.version,isAndroid:nt.isAndroid,isChromeOS:nt.isChromeOS,isFreeBSD:nt.isFreeBSD,isiOS:nt.isiOS,isLinux:nt.isLinux,isOSX:nt.isOSX,isSolaris:nt.isSolaris,isWindows:nt.isWindows},deviceType:{isDesktop:rt.isDesktop,isiPad:rt.isiPad,isiPhone:rt.isiPhone,isPhone:rt.isPhone,isTablet:rt.isTablet,isTouch:rt.isTouch,isWebView:rt.isWebView}},ut=/^\s*|\s*$/g,lt=function(e){return null==e?"":(""+e).replace(ut,"")},st=function(e,t){return t?!("array"!==t||!be(e))||typeof e===t:void 0!==e},ft=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),ye(e,(function(e,o){if(!1===t.call(r,e,o,n))return!1;ft(e,t,n,r)})))},dt={trim:lt,isArray:be,is:st,toArray:function(e){if(be(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var r;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n},each:ye,map:we,grep:Ce,inArray:xe,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var o=t[r];for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];void 0!==a&&(e[i]=a)}}return e},create:function(e,t,n){var r,o,i,a=0,c=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],u=this.createNS(e[3].replace(/\.\w+$/,""),n);if(!u[c]){if("static"===e[2])return u[c]=t,void(this.onCreate&&this.onCreate(e[2],e[3],u[c]));t[c]||(t[c]=function(){},a=1),u[c]=t[c],this.extend(u[c].prototype,t),e[5]&&(r=this.resolve(e[5]).prototype,o=e[5].match(/\.(\w+)$/i)[1],i=u[c],u[c]=a?function(){return r[o].apply(this,arguments)}:function(){return this.parent=r[o],i.apply(this,arguments)},u[c].prototype[c]=u[c],this.each(r,(function(e,t){u[c].prototype[t]=r[t]})),this.each(t,(function(e,t){r[t]?u[c].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==c&&(u[c].prototype[t]=e)}))),this.each(t.static,(function(e,t){u[c][t]=e}))}},walk:ft,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||st(e,"array")?e:we(e.split(t||","),lt)},_addCacheSuffix:function(e){var t=ct.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},mt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},pt={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return mt(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return mt(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return mt(n)},fromDom:mt,fromPoint:function(e,t,n){return k.from(e.dom.elementFromPoint(t,n)).map(mt)}},gt=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},ht=function(e,t){var n=e.dom;if(1!==n.nodeType)return!1;var r=n;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},vt=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},bt=function(e,t){return e.dom===t.dom},yt=function(e,t){return n=e.dom,r=t.dom,function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)}(n,r,Node.DOCUMENT_POSITION_CONTAINED_BY);var n,r},wt=function(e,t){return Qe().browser.isIE()?yt(e,t):function(e,t){var n=e.dom,r=t.dom;return n!==r&&n.contains(r)}(e,t)},Ct=("undefined"!=typeof window?window:Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),xt=function(e){return e.dom.nodeType},kt=function(e){return function(t){return xt(t)===e}},St=kt(1),Tt=kt(3),Et=kt(9),_t=kt(11),At=function(e){return pt.fromDom(e.dom.ownerDocument)},Nt=function(e){return Et(e)?e:At(e)},Rt=function(e){return pt.fromDom(Nt(e).dom.defaultView)},Ot=function(e){return k.from(e.dom.parentNode).map(pt.fromDom)},Dt=function(e){return k.from(e.dom.previousSibling).map(pt.fromDom)},It=function(e){return k.from(e.dom.nextSibling).map(pt.fromDom)},Pt=function(e){return Z(gt(e,Dt))},Bt=function(e){return gt(e,It)},Mt=function(e){return W(e.dom.childNodes,pt.fromDom)},Lt=function(e,t){var n=e.dom.childNodes;return k.from(n[t]).map(pt.fromDom)},Ft=function(e){return Lt(e,0)},jt=function(e){return Lt(e,e.dom.childNodes.length-1)},Ht=function(e){return _t(e)},Ut=B(Element.prototype.attachShadow)&&B(Node.prototype.getRootNode),zt=d(Ut),Wt=Ut?function(e){return pt.fromDom(e.dom.getRootNode())}:Nt,qt=function(e){return Ht(e)?e:function(e){var t=e.dom.head;if(null==t)throw new Error("Head is not available yet");return pt.fromDom(t)}(Nt(e))},Vt=function(e){return pt.fromDom(e.dom.host)},$t=function(e){return P(e.dom.shadowRoot)},Kt=function(e,t){Ot(e).each((function(n){n.dom.insertBefore(t.dom,e.dom)}))},Jt=function(e,t){It(e).fold((function(){Ot(e).each((function(e){Xt(e,t)}))}),(function(e){Kt(e,t)}))},Gt=function(e,t){Ft(e).fold((function(){Xt(e,t)}),(function(n){e.dom.insertBefore(t.dom,n.dom)}))},Xt=function(e,t){e.dom.appendChild(t.dom)},Yt=function(e,t){q(t,(function(t){Xt(e,t)}))},Qt=function(e){e.dom.textContent="",q(Mt(e),(function(e){Zt(e)}))},Zt=function(e){var t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},en=function(e){var t,n=Mt(e);n.length>0&&(t=e,q(n,(function(e){Kt(t,e)}))),Zt(e)},tn=function(e){var t=Tt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;var n,r,o=t.ownerDocument;return function(e){var t=Wt(e);return Ht(t)?k.some(t):k.none()}(pt.fromDom(t)).fold((function(){return o.body.contains(t)}),(n=tn,r=Vt,function(e){return n(r(e))}))},nn=function(e,t){return{left:e,top:t,translate:function(n,r){return nn(e+n,t+r)}}},rn=nn,on=function(e,t){return void 0!==e?e:void 0!==t?t:0},an=function(e){var t=e.dom,n=t.ownerDocument.body;return n===t?rn(n.offsetLeft,n.offsetTop):tn(e)?function(e){var t=e.getBoundingClientRect();return rn(t.left,t.top)}(t):rn(0,0)},cn=function(e){var t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return rn(n,r)},un=function(e,t,n){var r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(e,t)},ln=function(e,t){Qe().browser.isSafari()&&B(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},sn=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},fn=function(e){var t=void 0===e?window:e,n=t.document,r=cn(pt.fromDom(n));return function(e){var t=void 0===e?window:e;return k.from(t.visualViewport)}(t).fold((function(){var e=t.document.documentElement,n=e.clientWidth,o=e.clientHeight;return sn(r.left,r.top,n,o)}),(function(e){return sn(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)}))},dn=function(e){return function(t){return!!t&&t.nodeType===e}},mn=function(e){return!!e&&!Object.getPrototypeOf(e)},pn=dn(1),gn=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return U(t,n)}return!1}},hn=function(e,t){var n=t.toLowerCase().split(" ");return function(t){var r;if(pn(t))for(r=0;r<n.length;r++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);if((o?o.getPropertyValue(e):null)===n[r])return!0}return!1}},vn=function(e){return function(t){return pn(t)&&t.hasAttribute(e)}},bn=function(e){return pn(e)&&e.hasAttribute("data-mce-bogus")},yn=function(e){return pn(e)&&"TABLE"===e.tagName},wn=function(e){return function(t){if(pn(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},Cn=gn(["textarea","input"]),xn=dn(3),kn=dn(8),Sn=dn(9),Tn=dn(11),En=gn(["br"]),_n=gn(["img"]),An=wn("true"),Nn=wn("false"),Rn=gn(["td","th"]),On=gn(["video","audio","object","embed"]),Dn=function(e){return void 0!==e.style&&B(e.style.getPropertyValue)},In=function(e,t,n){if(!(_(n)||O(n)||M(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Pn=function(e,t,n){In(e.dom,t,n)},Bn=function(e,t){var n=e.dom;ce(t,(function(e,t){In(n,t,e)}))},Mn=function(e,t){var n=e.dom.getAttribute(t);return null===n?void 0:n},Ln=function(e,t){return k.from(Mn(e,t))},Fn=function(e,t){e.dom.removeAttribute(t)},jn=function(e,t){var n=e.dom;ce(t,(function(e,t){!function(e,t,n){if(!_(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Dn(e)&&e.style.setProperty(t,n)}(n,t,e)}))},Hn=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||tn(e)?r:Un(n,t)},Un=function(e,t){return Dn(e)?e.style.getPropertyValue(t):""},zn=function(e,t){var n=e.dom,r=Un(n,t);return k.from(r).filter((function(e){return e.length>0}))},Wn=function(e){var t={},n=e.dom;if(Dn(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},qn=Qe().browser,Vn=function(e){return G(e,St)},$n=function(e,t){return e.children&&U(e.children,t)},Kn=function(e,t,n){var r,o,i=0,a=0,c=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Hn(pt.fromDom(e),"position"))return{x:i=(o=t.getBoundingClientRect()).left+(c.documentElement.scrollLeft||e.scrollLeft)-c.documentElement.clientLeft,y:a=o.top+(c.documentElement.scrollTop||e.scrollTop)-c.documentElement.clientTop};for(r=t;r&&r!==n&&r.nodeType&&!$n(r,n);)i+=r.offsetLeft||0,a+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!==n&&r.nodeType&&!$n(r,n);)i-=r.scrollLeft||0,a-=r.scrollTop||0,r=r.parentNode;a+=function(e){return qn.isFirefox()&&"table"===Ct(e)?Vn(Mt(e)).filter((function(e){return"caption"===Ct(e)})).bind((function(e){return Vn(Bt(e)).map((function(t){var n=t.dom.offsetTop,r=e.dom.offsetTop,o=e.dom.offsetHeight;return n<=r?-o:0}))})).getOr(0):0}(pt.fromDom(t))}return{x:i,y:a}},Jn={},Gn={exports:Jn};!function(e,n,r,o){!function(o){if("object"==typeof n&&void 0!==r)r.exports=o();else if("function"==typeof e&&e.amd)e([],o);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).EphoxContactWrapper=o()}}((function(){return function e(t,n,r){function i(c,u){if(!n[c]){if(!t[c]){var l="function"==typeof o&&o;if(!u&&l)return l(c,!0);if(a)return a(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[c]={exports:{}};t[c][0].call(f.exports,(function(e){return i(t[c][1][e]||e)}),f,f.exports,e,t,n,r)}return n[c].exports}for(var a="function"==typeof o&&o,c=0;c<r.length;c++)i(r[c]);return i}({1:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var l,s=[],f=!1,d=-1;function m(){f&&l&&(f=!1,l.length?s=l.concat(s):d=-1,s.length&&p())}function p(){if(!f){var e=u(m);f=!0;for(var t=s.length;t;){for(l=s,s=[];++d<t;)l&&l[d].run();d=-1,t=s.length}l=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new g(e,t)),1!==s.length||f||u(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){!function(n){var r=setTimeout;function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void u(t.promise,e)}c(t.promise,r)}else(1===e._state?c:u)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void f((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){u(e,t)}var r,o}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e((function(e){n||(n=!0,c(t,e))}),(function(e){n||(n=!0,u(t,e))}))}catch(e){if(n)return;n=!0,u(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return a(this,new s(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i((function(e,n){if(0===t.length)return e([]);var r=t.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(e){o(i,e)}),n)}t[i]=a,0==--r&&e(t)}catch(e){n(e)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},i._immediateFn="function"==typeof e?function(t){e(t)}:function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,r){var o=e("process/browser.js").nextTick,i=Function.prototype.apply,a=Array.prototype.slice,c={},u=0;function l(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new l(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new l(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n.setImmediate="function"==typeof t?t:function(e){var t=u++,r=!(arguments.length<2)&&a.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))})),t},n.clearImmediate="function"==typeof r?r:function(e){delete c[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var r=e("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))}(void 0,Jn,Gn,void 0);var Xn=Gn.exports.boltExport,Yn=function(e){var t=k.none(),n=[],r=function(e){o()?a(e):n.push(e)},o=function(){return t.isSome()},i=function(e){q(e,a)},a=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e((function(e){o()||(t=k.some(e),i(n),n=[])})),{get:r,map:function(e){return Yn((function(t){r((function(n){t(e(n))}))}))},isReady:o}},Qn={nu:Yn,pure:function(e){return Yn((function(t){t(e)}))}},Zn=function(e){setTimeout((function(){throw e}),0)},er=function(e){var t=function(t){e().then(t,Zn)};return{map:function(t){return er((function(){return e().then(t)}))},bind:function(t){return er((function(){return e().then((function(e){return t(e).toPromise()}))}))},anonBind:function(t){return er((function(){return e().then((function(){return t.toPromise()}))}))},toLazy:function(){return Qn.nu(t)},toCached:function(){var t=null;return er((function(){return null===t&&(t=e()),t}))},toPromise:e,get:t}},tr=function(e){return er((function(){return new Xn(e)}))},nr=function(e,t){return t((function(t){var n=[],r=0;0===e.length?t([]):q(e,(function(o,i){o.get(function(o){return function(i){n[o]=i,++r>=e.length&&t(n)}}(i))}))}))},rr=function(e){return{is:function(t){return e===t},isValue:y,isError:b,getOr:d(e),getOrThunk:d(e),getOrDie:d(e),or:function(t){return rr(e)},orThunk:function(t){return rr(e)},fold:function(t,n){return n(e)},map:function(t){return rr(t(e))},mapError:function(t){return rr(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return k.some(e)}}},or=function(e){return{is:b,isValue:b,isError:y,getOr:m,getOrThunk:function(e){return e()},getOrDie:function(){return h(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return or(e)},mapError:function(t){return or(t(e))},each:s,bind:function(t){return or(e)},exists:b,forall:y,toOptional:k.none}},ir={value:rr,error:or,fromOption:function(e,t){return e.fold((function(){return or(t)}),rr)}},ar=function(e){if(!N(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return q(e,(function(r,o){var i=ie(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!N(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){var n=arguments.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var u=function(e){var n=ie(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!Q(t,(function(e){return U(n,e)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:u,log:function(e){console.log(e,{constructors:t,constructor:a,params:r})}}}})),n},cr=(ar([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e){return e.fold(m,m)});function ur(e,t,n,r,o){return e(n,r)?k.some(n):B(o)&&o(n)?k.none():t(n,r,o)}var lr,sr=function(e,t,n){for(var r=e.dom,o=B(n)?n:b;r.parentNode;){r=r.parentNode;var i=pt.fromDom(r);if(t(i))return k.some(i);if(o(i))break}return k.none()},fr=function(e,t,n){return ur((function(e,t){return t(e)}),sr,e,t,n)},dr=function(e,t){return G(e.dom.childNodes,(function(e){return t(pt.fromDom(e))})).map(pt.fromDom)},mr=function(e,t,n){return sr(e,(function(e){return ht(e,t)}),n)},pr=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return vt(n)?k.none():k.from(n.querySelector(e)).map(pt.fromDom)}(t,e)},gr=function(e,t,n){return ur((function(e,t){return ht(e,t)}),mr,e,t,n)},hr=window.Promise?window.Promise:function(){function e(e,t){return function(){e.apply(t,arguments)}}var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],s(t,e(a,this),e(c,this))},o=r.immediateFn||"function"==typeof n&&n||function(e){setTimeout(e,1)};function i(e){var t=this;null!==this._state?o((function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void e.reject(t)}e.resolve(r)}else(t._state?e.resolve:e.reject)(t._value)})):this._deferreds.push(e)}function a(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void s(e(n,t),e(a,this),e(c,this))}this._state=!0,this._value=t,u.call(this)}catch(e){c.call(this,e)}}function c(e){this._state=!1,this._value=e,u.call(this)}function u(){for(var e=0,t=this._deferreds.length;e<t;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function l(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function s(e,t,n){var r=!1;try{e((function(e){r||(r=!0,t(e))}),(function(e){r||(r=!0,n(e))}))}catch(e){if(r)return;r=!0,n(e)}}return r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=this;return new r((function(r,o){i.call(n,new l(e,t,r,o))}))},r.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&t(arguments[0])?arguments[0]:arguments);return new r((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(e){o(i,e)}),n)}e[i]=a,0==--r&&t(e)}catch(e){n(e)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r((function(t){t(e)}))},r.reject=function(e){return new r((function(t,n){n(e)}))},r.race=function(e){return new r((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},r}(),vr=function(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)},br=function(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)},yr=function(e,t){var n,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];clearTimeout(n),n=vr((function(){e.apply(this,r)}),t)};return r.stop=function(){clearTimeout(n)},r},wr={requestAnimationFrame:function(e,t){lr?lr.then(e):lr=new hr((function(e){t||(t=document.body),function(e,t){var n,r=window.requestAnimationFrame,o=["ms","moz","webkit"];for(n=0;n<o.length&&!r;n++)r=window[o[n]+"RequestAnimationFrame"];r||(r=function(e){window.setTimeout(e,0)}),r(e,t)}(e,t)})).then(e)},setTimeout:vr,setInterval:br,setEditorTimeout:function(e,t,n){return vr((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var r=br((function(){e.removed?clearInterval(r):t()}),n);return r},debounce:yr,throttle:yr,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}};function Cr(e,t){void 0===t&&(t={});var n=0,r={},o=pt.fromDom(e),i=Nt(o),a=t.maxLoadTime||5e3,c=function(c,u,l){var s,f=dt._addCacheSuffix(c),d=function(e){return ge(r,e).getOrThunk((function(){return{id:"mce-u"+n++,passed:[],failed:[],count:0}}))}(f);r[f]=d,d.count++;var m=function(e,t){for(var n=e.length;n--;)e[n]();d.status=t,d.passed=[],d.failed=[],s&&(s.onload=null,s.onerror=null,s=null)},p=function(){return m(d.passed,2)},g=function(){return m(d.failed,3)},h=function(){var t;t=h,function(){for(var t=e.styleSheets,n=t.length;n--;){var r=t[n].ownerNode;if(r&&r.id===s.id)return p(),!0}return!1}()||(Date.now()-y<a?wr.setTimeout(t):g())};if(u&&d.passed.push(u),l&&d.failed.push(l),1!==d.status)if(2!==d.status)if(3!==d.status){d.status=1;var v=pt.fromTag("link",i.dom);Bn(v,{rel:"stylesheet",type:"text/css",id:d.id});var b,y=Date.now();t.contentCssCors&&Pn(v,"crossOrigin","anonymous"),t.referrerPolicy&&Pn(v,"referrerpolicy",t.referrerPolicy),(s=v.dom).onload=h,s.onerror=g,b=v,Xt(qt(o),b),Pn(v,"href",f)}else g();else p()},u=function(e){return tr((function(t){c(e,f(t,d(ir.value(e))),f(t,d(ir.error(e))))}))},l=function(e){var t=dt._addCacheSuffix(e);ge(r,t).each((function(e){var n,i;0===--e.count&&(delete r[t],n=e.id,i=qt(o),pr(i,"#"+n).each(Zt))}))};return{load:c,loadAll:function(e,t,n){var r;(r=W(e,u),nr(r,tr)).get((function(e){var r=function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o)?n:r).push(a)}return{pass:n,fail:r}}(e,(function(e){return e.isValue()}));r.fail.length>0?n(r.fail.map(cr)):t(r.pass.map(cr))}))},unload:l,unloadAll:function(e){q(e,(function(e){l(e)}))},_setReferrerPolicy:function(e){t.referrerPolicy=e}}}var xr,kr,Sr=function(){var e=new WeakMap;return{forElement:function(t,n){var r=Wt(t).dom;return k.from(e.get(r)).getOrThunk((function(){var t=Cr(r,n);return e.set(r,t),t}))}}}(),Tr=function(){function e(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}return e.prototype.current=function(){return this.node},e.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},e.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},e.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},e.prototype.findSibling=function(e,t,n,r){var o,i;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(o=e[n])return o;for(i=e.parentNode;i&&i!==this.rootNode;i=i.parentNode)if(o=i[n])return o}}},e.prototype.findPreviousNode=function(e,t,n,r){var o,i,a;if(e){if(o=e[n],this.rootNode&&o===this.rootNode)return;if(o){if(!r)for(a=o[t];a;a=a[t])if(!a[t])return a;return o}if((i=e.parentNode)&&i!==this.rootNode)return i}},e}(),Er=function(e){var t;return function(n){return(t=t||function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n}(e,y)).hasOwnProperty(Ct(n))}},_r=Er(["h1","h2","h3","h4","h5","h6"]),Ar=Er(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Nr=function(e){return St(e)&&!Ar(e)},Rr=function(e){return St(e)&&"br"===Ct(e)},Or=Er(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Dr=Er(["ul","ol","dl"]),Ir=Er(["li","dd","dt"]),Pr=Er(["thead","tbody","tfoot"]),Br=Er(["td","th"]),Mr=Er(["pre","script","textarea","style"]),Lr=function(e){return"\ufeff"===e},Fr=function(e){return e.replace(/\uFEFF/g,"")},jr=pn,Hr=xn,Ur=function(e){return Hr(e)&&(e=e.parentNode),jr(e)&&e.hasAttribute("data-mce-caret")},zr=function(e){return Hr(e)&&Lr(e.data)},Wr=function(e){return Ur(e)||zr(e)},qr=function(e){return e.firstChild!==e.lastChild||!En(e.firstChild)},Vr=function(e){var t=e.container();return!!xn(t)&&("\ufeff"===t.data.charAt(e.offset())||e.isAtStart()&&zr(t.previousSibling))},$r=function(e){var t=e.container();return!!xn(t)&&("\ufeff"===t.data.charAt(e.offset()-1)||e.isAtEnd()&&zr(t.nextSibling))},Kr=function(e,t,n){var r,o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(((r=document.createElement("br")).setAttribute("data-mce-bogus","1"),r));var i=t.parentNode;return n?i.insertBefore(o,t):t.nextSibling?i.insertBefore(o,t.nextSibling):i.appendChild(o),o},Jr=function(e){return Hr(e)&&"\ufeff"===e.data[0]},Gr=function(e){return Hr(e)&&"\ufeff"===e.data[e.data.length-1]},Xr=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),n=t[t.length-1],bn(n)&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},Yr=An,Qr=Nn,Zr=En,eo=xn,to=gn(["script","style","textarea"]),no=gn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),ro=gn(["table"]),oo=Wr,io=function(e){return!oo(e)&&(eo(e)?!to(e.parentNode):no(e)||Zr(e)||ro(e)||ao(e))},ao=function(e){return!1===function(e){return pn(e)&&"true"===e.getAttribute("unselectable")}(e)&&Qr(e)},co=function(e,t){return io(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(ao(e))return!1;if(Yr(e))return!0}return!0}(e,t)},uo=/^[ \t\r\n]*$/,lo=function(e){return uo.test(e)},so=function(e,t){var n,r,o,i=pt.fromDom(t),a=pt.fromDom(e);return n=a,r="pre,code",o=p(bt,i),mr(n,r,o).isSome()},fo=function(e,t){return io(e)&&!1===function(e,t){return xn(e)&&lo(e.data)&&!1===so(e,t)}(e,t)||function(e){return pn(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id"))}(e)||mo(e)},mo=vn("data-mce-bookmark"),po=vn("data-mce-bogus"),go=(xr="data-mce-bogus",kr="all",function(e){return pn(e)&&e.getAttribute(xr)===kr}),ho=function(e,t){return void 0===t&&(t=!0),function(e,t){var n,r=0;if(fo(e,e))return!1;if(!(n=e.firstChild))return!0;var o=new Tr(n,e);do{if(t){if(go(n)){n=o.next(!0);continue}if(po(n)){n=o.next();continue}}if(En(n))r++,n=o.next();else{if(fo(n,e))return!1;n=o.next()}}while(n);return r<=1}(e.dom,t)},vo=function(e,t){return P(e)&&(fo(e,t)||Nr(pt.fromDom(e)))},bo=function(e){return function(e){return"span"===e.nodeName.toLowerCase()}(e)&&"bookmark"===e.getAttribute("data-mce-type")},yo=function(e,t){return xn(e)&&e.data.length>0&&function(e,t){var n=new Tr(e,t).prev(!1),r=new Tr(e,t).next(!1),o=D(n)||vo(n,t),i=D(r)||vo(r,t);return o&&i}(e,t)},wo=function(e,t,n){var r=n||t;if(pn(t)&&bo(t))return t;for(var o=t.childNodes,i=o.length-1;i>=0;i--)wo(e,o[i],r);if(pn(t)){var a=t.childNodes;1===a.length&&bo(a[0])&&t.parentNode.insertBefore(a[0],t)}return function(e){return Tn(e)||Sn(e)}(t)||fo(t,r)||function(e){return!!pn(e)&&e.childNodes.length>0}(t)||yo(t,r)||e.remove(t),t},Co=dt.makeMap,xo=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ko=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,So=/[<>&\"\']/g,To=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Eo={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},_o={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Ao={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},No=function(e,t){var n,r,o,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),_o[r]||(o="&"+e[n+1]+";",i[r]=o,i[o]=r);return i}},Ro=No("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Oo=function(e,t){return e.replace(t?xo:ko,(function(e){return _o[e]||e}))},Do=function(e,t){return e.replace(t?xo:ko,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":_o[e]||"&#"+e.charCodeAt(0)+";"}))},Io=function(e,t,n){return n=n||Ro,e.replace(t?xo:ko,(function(e){return _o[e]||n[e]||e}))},Po={encodeRaw:Oo,encodeAllRaw:function(e){return(""+e).replace(So,(function(e){return _o[e]||e}))},encodeNumeric:Do,encodeNamed:Io,getEncodeFunc:function(e,t){var n=No(t)||Ro,r=Co(e.replace(/\+/g,","));return r.named&&r.numeric?function(e,t){return e.replace(t?xo:ko,(function(e){return void 0!==_o[e]?_o[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))}:r.named?t?function(e,t){return Io(e,t,n)}:Io:r.numeric?Do:Oo},decode:function(e){return e.replace(To,(function(e,t){return t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):Eo[t]||String.fromCharCode(t):Ao[e]||Ro[e]||function(e){var t=pt.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e}(e)}))}},Bo={},Mo={},Lo=dt.makeMap,Fo=dt.each,jo=dt.extend,Ho=dt.explode,Uo=dt.inArray,zo=function(e,t){return(e=dt.trim(e))?e.split(t||" "):[]},Wo=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),Fo(e,(function(e,r){n[r]=n[r.toUpperCase()]="map"===t?Lo(e,/[, ]/):Ho(e,/[, ]/)}))),n};function qo(e){var t={},n={},r=[],o={},i={},a=function(t,n,r){var o=e[t];return o?o=Lo(o,/[, ]/,Lo(o.toUpperCase(),/[, ]/)):(o=Bo[t])||(o=Lo(n," ",Lo(n.toUpperCase()," ")),o=jo(o,r),Bo[t]=o),o},c=function(e){var t,n,r,o,i,a,c={},u=function(e,n,r){var o,i,a,u=function(e,t){var n,r,o={};for(n=0,r=e.length;n<r;n++)o[e[n]]=t||{};return o};n=n||"","string"==typeof(r=r||[])&&(r=zo(r));var l=zo(e);for(o=l.length;o--;)a={attributes:u(i=zo([t,n].join(" "))),attributesOrder:i,children:u(r,Mo)},c[l[o]]=a},l=function(e,t){var n,r,o,i,a=zo(e);n=a.length;for(var u=zo(t);n--;)for(r=c[a[n]],o=0,i=u.length;o<i;o++)r.attributes[u[o]]={},r.attributesOrder.push(u[o])};return Bo[e]?Bo[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",r=[r,a="acronym applet basefont big font strike tt"].join(" "),Fo(zo(a),(function(e){u(e,"",r)})),n=[n,i="center dir isindex noframes"].join(" "),o=[n,r].join(" "),Fo(zo(i),(function(e){u(e,"",o)}))),o=o||[n,r].join(" "),u("html","manifest","head body"),u("head","","base command link meta noscript script style title"),u("title hr noscript br"),u("base","href target"),u("link","href rel media hreflang type sizes hreflang"),u("meta","name http-equiv content charset"),u("style","media type scoped"),u("script","src async defer type charset"),u("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),u("address dt dd div caption","",o),u("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),u("blockquote","cite",o),u("ol","reversed start type","li"),u("ul","","li"),u("li","value",o),u("dl","","dt dd"),u("a","href target rel media hreflang type",r),u("q","cite",r),u("ins del","cite datetime",o),u("img","src sizes srcset alt usemap ismap width height"),u("iframe","src name width height",o),u("embed","src type width height"),u("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),u("param","name value"),u("map","name",[o,"area"].join(" ")),u("area","alt coords shape href target rel media hreflang type"),u("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),u("colgroup","span","col"),u("col","span"),u("tbody thead tfoot","","tr"),u("tr","","td th"),u("td","colspan rowspan headers",o),u("th","colspan rowspan headers scope abbr",o),u("form","accept-charset action autocomplete enctype method name novalidate target",o),u("fieldset","disabled form name",[o,"legend"].join(" ")),u("label","form for",r),u("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),u("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:r),u("select","disabled form multiple name required size","option optgroup"),u("optgroup","disabled label","option"),u("option","disabled label selected value"),u("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),u("menu","type label",[o,"li"].join(" ")),u("noscript","",o),"html4"!==e&&(u("wbr"),u("ruby","",[r,"rt rp"].join(" ")),u("figcaption","",o),u("mark rt rp summary bdi","",r),u("canvas","width height",o),u("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),u("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),u("picture","","img source"),u("source","src srcset type media sizes"),u("track","kind src srclang label default"),u("datalist","",[r,"option"].join(" ")),u("article section nav aside main header footer","",o),u("hgroup","","h1 h2 h3 h4 h5 h6"),u("figure","",[o,"figcaption"].join(" ")),u("time","datetime",r),u("dialog","open",o),u("command","type label icon disabled checked radiogroup command"),u("output","for form name",r),u("progress","value max",r),u("meter","value min max low high optimum",r),u("details","open",[o,"summary"].join(" ")),u("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(l("script","language xml:space"),l("style","xml:space"),l("object","declare classid code codebase codetype archive standby align border hspace vspace"),l("embed","align name hspace vspace"),l("param","valuetype type"),l("a","charset name rev shape coords"),l("br","clear"),l("applet","codebase archive code object alt name width height align hspace vspace"),l("img","name longdesc align border hspace vspace"),l("iframe","longdesc frameborder marginwidth marginheight scrolling align"),l("font basefont","size color face"),l("input","usemap align"),l("select"),l("textarea"),l("h1 h2 h3 h4 h5 h6 div p legend caption","align"),l("ul","type compact"),l("li","type"),l("ol dl menu dir","compact"),l("pre","width xml:space"),l("hr","align noshade size width"),l("isindex","prompt"),l("table","summary width frame rules cellspacing cellpadding align bgcolor"),l("col","width align char charoff valign"),l("colgroup","width align char charoff valign"),l("thead","align char charoff valign"),l("tr","align char charoff valign bgcolor"),l("th","axis align char charoff valign nowrap bgcolor width height"),l("form","accept"),l("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),l("tfoot","align char charoff valign"),l("tbody","align char charoff valign"),l("area","nohref"),l("body","background bgcolor text link vlink alink")),"html4"!==e&&(l("input button select textarea","autofocus"),l("input textarea","placeholder"),l("a","download"),l("link script img","crossorigin"),l("img","loading"),l("iframe","sandbox seamless allowfullscreen loading")),Fo(zo("a form meter progress dfn"),(function(e){c[e]&&delete c[e].children[e]})),delete c.caption.children.table,delete c.script,Bo[e]=c,c)}((e=e||{}).schema);!1===e.verify_html&&(e.valid_elements="*[*]");var u=Wo(e.valid_styles),l=Wo(e.invalid_styles,"map"),s=Wo(e.valid_classes,"map"),f=a("whitespace_elements","pre script noscript style textarea video audio iframe object code"),d=a("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),m=a("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),p=a("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),g=a("non_empty_elements","td th iframe video audio object script code pre",m),h=a("move_caret_before_on_enter_elements","td th iframe video audio object script code table",m),v=a("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),b=a("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",v),y=a("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");Fo((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){i[e]=new RegExp("</"+e+"[^>]*>","gi")}));var w=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},C=function(e){var n,o,i,a,c,u,l,s,f,d,m,p,g,h,v,b,y,C,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,k=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,S=/[*?+]/;if(e){var T=zo(e,",");for(t["@"]&&(b=t["@"].attributes,y=t["@"].attributesOrder),n=0,o=T.length;n<o;n++)if(c=x.exec(T[n])){if(h=c[1],f=c[2],v=c[3],s=c[5],u={attributes:p={},attributesOrder:g=[]},"#"===h&&(u.paddEmpty=!0),"-"===h&&(u.removeEmpty=!0),"!"===c[4]&&(u.removeEmptyAttrs=!0),b&&(ce(b,(function(e,t){p[t]=e})),g.push.apply(g,y)),s)for(i=0,a=(s=zo(s,"|")).length;i<a;i++)if(c=k.exec(s[i])){if(l={},m=c[1],d=c[2].replace(/[\\:]:/g,":"),h=c[3],C=c[4],"!"===m&&(u.attributesRequired=u.attributesRequired||[],u.attributesRequired.push(d),l.required=!0),"-"===m){delete p[d],g.splice(Uo(g,d),1);continue}h&&("="===h&&(u.attributesDefault=u.attributesDefault||[],u.attributesDefault.push({name:d,value:C}),l.defaultValue=C),":"===h&&(u.attributesForced=u.attributesForced||[],u.attributesForced.push({name:d,value:C}),l.forcedValue=C),"<"===h&&(l.validValues=Lo(C,"?"))),S.test(d)?(u.attributePatterns=u.attributePatterns||[],l.pattern=w(d),u.attributePatterns.push(l)):(p[d]||g.push(d),p[d]=l)}b||"@"!==f||(b=p,y=g),v&&(u.outputName=f,t[v]=u),S.test(f)?(u.pattern=w(f),r.push(u)):t[f]=u}}},x=function(e){t={},r=[],C(e),Fo(c,(function(e,t){n[t]=e.children}))},k=function(e){var r=/^(~)?(.+)$/;e&&(Bo.text_block_elements=Bo.block_elements=null,Fo(zo(e,","),(function(e){var i=r.exec(e),a="~"===i[1],c=a?"span":"div",u=i[2];if(n[u]=n[c],o[u]=c,a||(b[u.toUpperCase()]={},b[u]={}),!t[u]){var l=t[c];delete(l=jo({},l)).removeEmptyAttrs,delete l.removeEmpty,t[u]=l}Fo(n,(function(e,t){e[c]&&(n[t]=e=jo({},n[t]),e[u]=e[c])}))})))},S=function(t){var r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;Bo[e.schema]=null,t&&Fo(zo(t,","),(function(e){var t,o,i=r.exec(e);i&&(o=i[1],t=o?n[i[2]]:n[i[2]]={"#comment":{}},t=n[i[2]],Fo(zo(i[3],"|"),(function(e){"-"===o?delete t[e]:t[e]={}})))}))},T=function(e){var n,o=t[e];if(o)return o;for(n=r.length;n--;)if((o=r[n]).pattern.test(e))return o};e.valid_elements?x(e.valid_elements):(Fo(c,(function(e,r){t[r]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[r]=e.children})),"html5"!==e.schema&&Fo(zo("strong/b em/i"),(function(e){var n=zo(e,"/");t[n[1]].outputName=n[0]})),Fo(zo("ol ul sub sup blockquote span font a table tbody strong em b i"),(function(e){t[e]&&(t[e].removeEmpty=!0)})),Fo(zo("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=!0})),Fo(zo("span"),(function(e){t[e].removeEmptyAttrs=!0}))),k(e.custom_elements),S(e.valid_children),C(e.extended_valid_elements),S("+ol[ul|ol],+ul[ul|ol]"),Fo({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=zo(e))})),e.invalid_elements&&Fo(Ho(e.invalid_elements),(function(e){t[e]&&delete t[e]})),T("span")||C("span[!data-mce-type|*]");return{children:n,elements:t,getValidStyles:function(){return u},getValidClasses:function(){return s},getBlockElements:function(){return b},getInvalidStyles:function(){return l},getShortEndedElements:function(){return m},getTextBlockElements:function(){return v},getTextInlineElements:function(){return y},getBoolAttrs:function(){return p},getElementRule:T,getSelfClosingElements:function(){return d},getNonEmptyElements:function(){return g},getMoveCaretBeforeOnEnterElements:function(){return h},getWhiteSpaceElements:function(){return f},getSpecialElements:function(){return i},isValidChild:function(e,t){var r=n[e.toLowerCase()];return!(!r||!r[t.toLowerCase()])},isValid:function(e,t){var n,r,o=T(e);if(o){if(!t)return!0;if(o.attributes[t])return!0;if(n=o.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:function(){return o},addValidElements:C,setValidElements:x,addCustomElements:k,addValidChildren:S}}var Vo,$o,Ko,Jo,Go,Xo,Yo,Qo,Zo,ei,ti,ni,ri,oi,ii,ai,ci,ui=function(e,t,n,r){var o=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+o(t)+o(n)+o(r)},li=function(e,t){var n,r,o,i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,c=/\s*([^:]+):\s*([^;]+);?/g,u=/\s+$/,l={};e=e||{},t&&(r=t.getValidStyles(),o=t.getInvalidStyles());var s="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(n=0;n<s.length;n++)l[s[n]]="\ufeff"+n,l["\ufeff"+n]=s[n];return{toHex:function(e){return e.replace(i,ui)},parse:function(t){var r,o,s,f,d,m,p,g,h={},v=e.url_converter,b=e.url_converter_scope||this,y=function(e,t,r){var o=h[e+"-top"+t];if(o){var i=h[e+"-right"+t];if(i){var a=h[e+"-bottom"+t];if(a){var c=h[e+"-left"+t];if(c){var u=[o,i,a,c];for(n=u.length-1;n--&&u[n]===u[n+1];);n>-1&&r||(h[e+t]=-1===n?u[0]:u.join(" "),delete h[e+"-top"+t],delete h[e+"-right"+t],delete h[e+"-bottom"+t],delete h[e+"-left"+t])}}}}},w=function(e){var t,n=h[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return h[e]=n[0],!0}},C=function(e){return f=!0,l[e]},x=function(e,t){return f&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return l[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},k=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},S=function(e){return e.replace(/\\[0-9a-f]+/gi,k)},T=function(t,n,r,o,i,a){if(i=i||a)return"'"+(i=x(i)).replace(/\'/g,"\\'")+"'";if(n=x(n||r||o),!e.allow_script_urls){var c=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(c))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(c))return""}return v&&(n=v.call(b,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,C).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,C)}));r=c.exec(t);)if(c.lastIndex=r.index+r[0].length,o=r[1].replace(u,"").toLowerCase(),s=r[2].replace(u,""),o&&s){if(o=S(o),s=S(s),-1!==o.indexOf("\ufeff")||-1!==o.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===o||/expression\s*\(|\/\*|\*\//.test(s)))continue;"font-weight"===o&&"700"===s?s="bold":"color"!==o&&"background-color"!==o||(s=s.toLowerCase()),s=(s=s.replace(i,ui)).replace(a,T),h[o]=f?x(s,!0):s}y("border","",!0),y("border","-width"),y("border","-color"),y("border","-style"),y("padding",""),y("margin",""),d="border",p="border-style",g="border-color",w(m="border-width")&&w(p)&&w(g)&&(h[d]=h[m]+" "+h[p]+" "+h[g],delete h[m],delete h[p],delete h[g]),"medium none"===h.border&&delete h.border,"none"===h["border-image"]&&delete h["border-image"]}return h},serialize:function(e,t){var n="",i=function(t){var o,i=r[t];if(i)for(var a=0,c=i.length;a<c;a++)t=i[a],(o=e[t])&&(n+=(n.length>0?" ":"")+t+": "+o+";")};return t&&r?(i("*"),i(t)):ce(e,(function(e,r){!e||o&&!function(e,t){var n=o["*"];return(!n||!n[e])&&!((n=o[t])&&n[e])}(r,t)||(n+=(n.length>0?" ":"")+r+": "+e+";")})),n}}},si=/^(?:mouse|contextmenu)|click/,fi={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},di=function(){return!1},mi=function(){return!0},pi=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},gi=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},hi=function(e,t){var n,r=t||{};for(n in e)fi[n]||(r[n]=e[n]);if(r.target||(r.target=r.srcElement||document),r.composedPath&&(r.composedPath=function(){return e.composedPath()}),e&&function(e){return si.test(e.type)}(e)&&void 0===e.pageX&&void 0!==e.clientX){var o=r.target.ownerDocument||document,i=o.documentElement,a=o.body;r.pageX=e.clientX+(i&&i.scrollLeft||a&&a.scrollLeft||0)-(i&&i.clientLeft||a&&a.clientLeft||0),r.pageY=e.clientY+(i&&i.scrollTop||a&&a.scrollTop||0)-(i&&i.clientTop||a&&a.clientTop||0)}return r.preventDefault=function(){r.isDefaultPrevented=mi,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},r.stopPropagation=function(){r.isPropagationStopped=mi,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=mi,r.stopPropagation()},!1===function(e){return e.isDefaultPrevented===mi||e.isDefaultPrevented===di}(r)&&(r.isDefaultPrevented=di,r.isPropagationStopped=di,r.isImmediatePropagationStopped=di),void 0===r.metaKey&&(r.metaKey=!1),r},vi=function(e,t,n){var r=e.document,o={type:"ready"};if(n.domLoaded)t(o);else{var i=function(){gi(e,"DOMContentLoaded",i),gi(e,"load",i),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};"complete"===r.readyState||"interactive"===r.readyState&&r.body?i():pi(e,"DOMContentLoaded",i),n.domLoaded||pi(e,"load",i)}},bi=function(){function e(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}return e.prototype.bind=function(e,t,n,r){var o,i,a,c,u,l,s,f=this,d=window,m=function(e){f.executeHandlers(hi(e||d.event),o)};if(e&&3!==e.nodeType&&8!==e.nodeType){e[f.expando]?o=e[f.expando]:(o=f.count++,e[f.expando]=o,f.events[o]={}),r=r||e;var p=t.split(" ");for(a=p.length;a--;)l=m,u=s=!1,"DOMContentLoaded"===(c=p[a])&&(c="ready"),f.domLoaded&&"ready"===c&&"complete"===e.readyState?n.call(r,hi({type:c})):(f.hasMouseEnterLeave||(u=f.mouseEnterLeave[c])&&(l=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=hi(e||d.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,f.executeHandlers(e,o))}),f.hasFocusIn||"focusin"!==c&&"focusout"!==c||(s=!0,u="focusin"===c?"focus":"blur",l=function(e){(e=hi(e||d.event)).type="focus"===e.type?"focusin":"focusout",f.executeHandlers(e,o)}),(i=f.events[o][c])?"ready"===c&&f.domLoaded?n(hi({type:c})):i.push({func:n,scope:r}):(f.events[o][c]=i=[{func:n,scope:r}],i.fakeName=u,i.capture=s,i.nativeHandler=l,"ready"===c?vi(e,l,f):pi(e,u||c,l,s)));return e=i=null,n}},e.prototype.unbind=function(e,t,n){var r,o,i,a,c;if(!e||3===e.nodeType||8===e.nodeType)return this;var u=e[this.expando];if(u){if(c=this.events[u],t){var l=t.split(" ");for(o=l.length;o--;)if(r=c[a=l[o]]){if(n)for(i=r.length;i--;)if(r[i].func===n){var s=r.nativeHandler,f=r.fakeName,d=r.capture;(r=r.slice(0,i).concat(r.slice(i+1))).nativeHandler=s,r.fakeName=f,r.capture=d,c[a]=r}n&&0!==r.length||(delete c[a],gi(e,r.fakeName||a,r.nativeHandler,r.capture))}}else ce(c,(function(t,n){gi(e,t.fakeName||n,t.nativeHandler,t.capture)})),c={};for(a in c)if(he(c,a))return this;delete this.events[u];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this},e.prototype.fire=function(e,t,n){var r;if(!e||3===e.nodeType||8===e.nodeType)return this;var o=hi(null,n);o.type=t,o.target=e;do{(r=e[this.expando])&&this.executeHandlers(o,r),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!o.isPropagationStopped());return this},e.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},e.prototype.destroy=function(){this.events={}},e.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},e.prototype.executeHandlers=function(e,t){var n=this.events[t],r=n&&n[e.type];if(r)for(var o=0,i=r.length;o<i;o++){var a=r[o];if(a&&!1===a.func.call(a.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},e.Event=new e,e}(),yi="sizzle"+-new Date,wi=window.document,Ci=0,xi=0,ki=ea(),Si=ea(),Ti=ea(),Ei=function(e,t){return e===t&&(ei=!0),0},_i={}.hasOwnProperty,Ai=[],Ni=Ai.pop,Ri=Ai.push,Oi=Ai.push,Di=Ai.slice,Ii=Ai.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Pi="[\\x20\\t\\r\\n\\f]",Bi="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Mi="\\["+Pi+"*("+Bi+")(?:"+Pi+"*([*^$|!~]?=)"+Pi+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Bi+"))|)"+Pi+"*\\]",Li=":("+Bi+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Mi+")*)|.*)\\)|)",Fi=new RegExp("^"+Pi+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Pi+"+$","g"),ji=new RegExp("^"+Pi+"*,"+Pi+"*"),Hi=new RegExp("^"+Pi+"*([>+~]|"+Pi+")"+Pi+"*"),Ui=new RegExp("="+Pi+"*([^\\]'\"]*?)"+Pi+"*\\]","g"),zi=new RegExp(Li),Wi=new RegExp("^"+Bi+"$"),qi={ID:new RegExp("^#("+Bi+")"),CLASS:new RegExp("^\\.("+Bi+")"),TAG:new RegExp("^("+Bi+"|[*])"),ATTR:new RegExp("^"+Mi),PSEUDO:new RegExp("^"+Li),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Pi+"*(even|odd|(([+-]|)(\\d*)n|)"+Pi+"*(?:([+-]|)"+Pi+"*(\\d+)|))"+Pi+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Pi+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Pi+"*((?:-\\d)?\\d*)"+Pi+"*\\)|)(?=[^-]|$)","i")},Vi=/^(?:input|select|textarea|button)$/i,$i=/^h\d$/i,Ki=/^[^{]+\{\s*\[native \w/,Ji=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Gi=/[+~]/,Xi=/'|\\/g,Yi=new RegExp("\\\\([\\da-f]{1,6}"+Pi+"?|("+Pi+")|.)","ig"),Qi=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{Oi.apply(Ai=Di.call(wi.childNodes),wi.childNodes),Ai[wi.childNodes.length].nodeType}catch(e){Oi={apply:Ai.length?function(e,t){Ri.apply(e,Di.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}var Zi=function(e,t,n,r){var o,i,a,c,u,l,s,f,d,m;if((t?t.ownerDocument||t:wi)!==ni&&ti(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(c=(t=t||ni).nodeType)&&9!==c)return[];if(oi&&!r){if(o=Ji.exec(e))if(a=o[1]){if(9===c){if(!(i=t.getElementById(a))||!i.parentNode)return n;if(i.id===a)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(a))&&ci(t,i)&&i.id===a)return n.push(i),n}else{if(o[2])return Oi.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&Vo.getElementsByClassName)return Oi.apply(n,t.getElementsByClassName(a)),n}if(Vo.qsa&&(!ii||!ii.test(e))){if(f=s=yi,d=t,m=9===c&&e,1===c&&"object"!==t.nodeName.toLowerCase()){for(l=Go(e),(s=t.getAttribute("id"))?f=s.replace(Xi,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",u=l.length;u--;)l[u]=f+aa(l[u]);d=Gi.test(e)&&oa(t.parentNode)||t,m=l.join(",")}if(m)try{return Oi.apply(n,d.querySelectorAll(m)),n}catch(e){}finally{s||t.removeAttribute("id")}}}return Yo(e.replace(Fi,"$1"),t,n,r)};function ea(){var e=[];return function t(n,r){return e.push(n+" ")>$o.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function ta(e){return e[yi]=!0,e}function na(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ra(e){return ta((function(t){return t=+t,ta((function(n,r){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(r[o]=n[o]))}))}))}function oa(e){return e&&void 0!==e.getElementsByTagName&&e}function ia(){}function aa(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ca(e,t,n){var r=t.dir,o=n&&"parentNode"===r,i=xi++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,a){var c,u,l=[Ci,i];if(a){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if((c=(u=t[yi]||(t[yi]={}))[r])&&c[0]===Ci&&c[1]===i)return l[2]=c[2];if(u[r]=l,l[2]=e(t,n,a))return!0}}}function ua(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function la(e,t,n,r,o){for(var i,a=[],c=0,u=e.length,l=null!=t;c<u;c++)(i=e[c])&&(n&&!n(i,r,o)||(a.push(i),l&&t.push(c)));return a}function sa(e,t,n,r,o,i){return r&&!r[yi]&&(r=sa(r)),o&&!o[yi]&&(o=sa(o,i)),ta((function(i,a,c,u){var l,s,f,d=[],m=[],p=a.length,g=i||function(e,t,n){for(var r=0,o=t.length;r<o;r++)Zi(e,t[r],n);return n}(t||"*",c.nodeType?[c]:c,[]),h=!e||!i&&t?g:la(g,d,e,c,u),v=n?o||(i?e:p||r)?[]:a:h;if(n&&n(h,v,c,u),r)for(l=la(v,m),r(l,[],c,u),s=l.length;s--;)(f=l[s])&&(v[m[s]]=!(h[m[s]]=f));if(i){if(o||e){if(o){for(l=[],s=v.length;s--;)(f=v[s])&&l.push(h[s]=f);o(null,v=[],l,u)}for(s=v.length;s--;)(f=v[s])&&(l=o?Ii.call(i,f):d[s])>-1&&(i[l]=!(a[l]=f))}}else v=la(v===a?v.splice(p,v.length):v),o?o(null,a,v,u):Oi.apply(a,v)}))}function fa(e){for(var t,n,r,o=e.length,i=$o.relative[e[0].type],a=i||$o.relative[" "],c=i?1:0,u=ca((function(e){return e===t}),a,!0),l=ca((function(e){return Ii.call(t,e)>-1}),a,!0),s=[function(e,n,r){return!i&&(r||n!==Qo)||((t=n).nodeType?u(e,n,r):l(e,n,r))}];c<o;c++)if(n=$o.relative[e[c].type])s=[ca(ua(s),n)];else{if((n=$o.filter[e[c].type].apply(null,e[c].matches))[yi]){for(r=++c;r<o&&!$o.relative[e[r].type];r++);return sa(c>1&&ua(s),c>1&&aa(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(Fi,"$1"),n,c<r&&fa(e.slice(c,r)),r<o&&fa(e=e.slice(r)),r<o&&aa(e))}s.push(n)}return ua(s)}Vo=Zi.support={},Jo=Zi.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},ti=Zi.setDocument=function(e){var t,n=e?e.ownerDocument||e:wi,r=n.defaultView;return n!==ni&&9===n.nodeType&&n.documentElement?(ni=n,ri=n.documentElement,oi=!Jo(n),r&&r!==function(e){try{return e.top}catch(e){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",(function(){ti()}),!1):r.attachEvent&&r.attachEvent("onunload",(function(){ti()}))),Vo.attributes=!0,Vo.getElementsByTagName=!0,Vo.getElementsByClassName=Ki.test(n.getElementsByClassName),Vo.getById=!0,$o.find.ID=function(e,t){if(void 0!==t.getElementById&&oi){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},$o.filter.ID=function(e){var t=e.replace(Yi,Qi);return function(e){return e.getAttribute("id")===t}},$o.find.TAG=Vo.getElementsByTagName?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},$o.find.CLASS=Vo.getElementsByClassName&&function(e,t){if(oi)return t.getElementsByClassName(e)},ai=[],ii=[],Vo.disconnectedMatch=!0,ii=ii.length&&new RegExp(ii.join("|")),ai=ai.length&&new RegExp(ai.join("|")),t=Ki.test(ri.compareDocumentPosition),ci=t||Ki.test(ri.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Ei=t?function(e,t){if(e===t)return ei=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!Vo.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===wi&&ci(wi,e)?-1:t===n||t.ownerDocument===wi&&ci(wi,t)?1:Zo?Ii.call(Zo,e)-Ii.call(Zo,t):0:4&r?-1:1)}:function(e,t){if(e===t)return ei=!0,0;var r,o=0,i=e.parentNode,a=t.parentNode,c=[e],u=[t];if(!i||!a)return e===n?-1:t===n?1:i?-1:a?1:Zo?Ii.call(Zo,e)-Ii.call(Zo,t):0;if(i===a)return na(e,t);for(r=e;r=r.parentNode;)c.unshift(r);for(r=t;r=r.parentNode;)u.unshift(r);for(;c[o]===u[o];)o++;return o?na(c[o],u[o]):c[o]===wi?-1:u[o]===wi?1:0},n):ni},Zi.matches=function(e,t){return Zi(e,null,null,t)},Zi.matchesSelector=function(e,t){if((e.ownerDocument||e)!==ni&&ti(e),t=t.replace(Ui,"='$1']"),Vo.matchesSelector&&oi&&(!ai||!ai.test(t))&&(!ii||!ii.test(t)))try{var n=(void 0).call(e,t);if(n||Vo.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return Zi(t,ni,null,[e]).length>0},Zi.contains=function(e,t){return(e.ownerDocument||e)!==ni&&ti(e),ci(e,t)},Zi.attr=function(e,t){(e.ownerDocument||e)!==ni&&ti(e);var n=$o.attrHandle[t.toLowerCase()],r=n&&_i.call($o.attrHandle,t.toLowerCase())?n(e,t,!oi):void 0;return void 0!==r?r:Vo.attributes||!oi?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},Zi.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},Zi.uniqueSort=function(e){var t,n=[],r=0,o=0;if(ei=!Vo.detectDuplicates,Zo=!Vo.sortStable&&e.slice(0),e.sort(Ei),ei){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return Zo=null,e},Ko=Zi.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Ko(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=Ko(t);return n},($o=Zi.selectors={cacheLength:50,createPseudo:ta,match:qi,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Yi,Qi),e[3]=(e[3]||e[4]||e[5]||"").replace(Yi,Qi),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Zi.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Zi.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return qi.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&zi.test(n)&&(t=Go(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Yi,Qi).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=ki[e+" "];return t||(t=new RegExp("(^|"+Pi+")"+e+"("+Pi+"|$)"))&&ki(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var o=Zi.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),c="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,u){var l,s,f,d,m,p,g=i!==a?"nextSibling":"previousSibling",h=t.parentNode,v=c&&t.nodeName.toLowerCase(),b=!u&&!c;if(h){if(i){for(;g;){for(f=t;f=f[g];)if(c?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?h.firstChild:h.lastChild],a&&b){for(m=(l=(s=h[yi]||(h[yi]={}))[e]||[])[0]===Ci&&l[1],d=l[0]===Ci&&l[2],f=m&&h.childNodes[m];f=++m&&f&&f[g]||(d=m=0)||p.pop();)if(1===f.nodeType&&++d&&f===t){s[e]=[Ci,m,d];break}}else if(b&&(l=(t[yi]||(t[yi]={}))[e])&&l[0]===Ci)d=l[1];else for(;(f=++m&&f&&f[g]||(d=m=0)||p.pop())&&((c?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++d||(b&&((f[yi]||(f[yi]={}))[e]=[Ci,d]),f!==t)););return(d-=o)===r||d%r==0&&d/r>=0}}},PSEUDO:function(e,t){var n,r=$o.pseudos[e]||$o.setFilters[e.toLowerCase()]||Zi.error("unsupported pseudo: "+e);return r[yi]?r(t):r.length>1?(n=[e,e,"",t],$o.setFilters.hasOwnProperty(e.toLowerCase())?ta((function(e,n){for(var o,i=r(e,t),a=i.length;a--;)e[o=Ii.call(e,i[a])]=!(n[o]=i[a])})):function(e){return r(e,0,n)}):r}},pseudos:{not:ta((function(e){var t=[],n=[],r=Xo(e.replace(Fi,"$1"));return r[yi]?ta((function(e,t,n,o){for(var i,a=r(e,null,o,[]),c=e.length;c--;)(i=a[c])&&(e[c]=!(t[c]=i))})):function(e,o,i){return t[0]=e,r(t,null,i,n),!n.pop()}})),has:ta((function(e){return function(t){return Zi(e,t).length>0}})),contains:ta((function(e){return e=e.replace(Yi,Qi),function(t){return(t.textContent||t.innerText||Ko(t)).indexOf(e)>-1}})),lang:ta((function(e){return Wi.test(e||"")||Zi.error("unsupported lang: "+e),e=e.replace(Yi,Qi).toLowerCase(),function(t){var n;do{if(n=oi?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===ri},focus:function(e){return e===ni.activeElement&&(!ni.hasFocus||ni.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!$o.pseudos.empty(e)},header:function(e){return $i.test(e.nodeName)},input:function(e){return Vi.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ra((function(){return[0]})),last:ra((function(e,t){return[t-1]})),eq:ra((function(e,t,n){return[n<0?n+t:n]})),even:ra((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:ra((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:ra((function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e})),gt:ra((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=$o.pseudos.eq,q(["radio","checkbox","file","password","image"],(function(e){$o.pseudos[e]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(e)})),q(["submit","reset"],(function(e){$o.pseudos[e]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(e)})),ia.prototype=$o.filters=$o.pseudos,$o.setFilters=new ia,Go=Zi.tokenize=function(e,t){var n,r,o,i,a,c,u,l=Si[e+" "];if(l)return t?0:l.slice(0);for(a=e,c=[],u=$o.preFilter;a;){for(i in n&&!(r=ji.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=Hi.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(Fi," ")}),a=a.slice(n.length)),$o.filter)$o.filter.hasOwnProperty(i)&&(!(r=qi[i].exec(a))||u[i]&&!(r=u[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),a=a.slice(n.length)));if(!n)break}return t?a.length:a?Zi.error(e):Si(e,c).slice(0)},Xo=Zi.compile=function(e,t){var n,r=[],o=[],i=Ti[e+" "];if(!i){for(t||(t=Go(e)),n=t.length;n--;)(i=fa(t[n]))[yi]?r.push(i):o.push(i);(i=Ti(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,i,a,c,u){var l,s,f,d=0,m="0",p=o&&[],g=[],h=Qo,v=o||r&&$o.find.TAG("*",u),b=Ci+=null==h?1:Math.random()||.1,y=v.length;for(u&&(Qo=i!==ni&&i);m!==y&&null!=(l=v[m]);m++){if(r&&l){for(s=0;f=e[s++];)if(f(l,i,a)){c.push(l);break}u&&(Ci=b)}n&&((l=!f&&l)&&d--,o&&p.push(l))}if(d+=m,n&&m!==d){for(s=0;f=t[s++];)f(p,g,i,a);if(o){if(d>0)for(;m--;)p[m]||g[m]||(g[m]=Ni.call(c));g=la(g)}Oi.apply(c,g),u&&!o&&g.length>0&&d+t.length>1&&Zi.uniqueSort(c)}return u&&(Ci=b,Qo=h),p};return n?ta(o):o}(o,r))).selector=e}return i},Yo=Zi.select=function(e,t,n,r){var o,i,a,c,u,l="function"==typeof e&&e,s=!r&&Go(e=l.selector||e);if(n=n||[],1===s.length){if((i=s[0]=s[0].slice(0)).length>2&&"ID"===(a=i[0]).type&&Vo.getById&&9===t.nodeType&&oi&&$o.relative[i[1].type]){if(!(t=($o.find.ID(a.matches[0].replace(Yi,Qi),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=qi.needsContext.test(e)?0:i.length;o--&&(a=i[o],!$o.relative[c=a.type]);)if((u=$o.find[c])&&(r=u(a.matches[0].replace(Yi,Qi),Gi.test(i[0].type)&&oa(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&aa(i)))return Oi.apply(n,r),n;break}}return(l||Xo(e,s))(r,t,!oi,n,Gi.test(e)&&oa(t.parentNode)||t),n},Vo.sortStable=yi.split("").sort(Ei).join("")===yi,Vo.detectDuplicates=!!ei,ti(),Vo.sortDetached=!0;var da=document,ma=Array.prototype.push,pa=Array.prototype.slice,ga=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,ha=bi.Event,va=dt.makeMap("children,contents,next,prev"),ba=function(e){return void 0!==e},ya=function(e){return"string"==typeof e},wa=function(e,t){var n,r=(t=t||da).createElement("div"),o=t.createDocumentFragment();for(r.innerHTML=e;n=r.firstChild;)o.appendChild(n);return o},Ca=function(e,t,n,r){var o;if(ya(t))t=wa(t,Ba(e[0]));else if(t.length&&!t.nodeType){if(t=ja.makeArray(t),r)for(o=t.length-1;o>=0;o--)Ca(e,t[o],n,r);else for(o=0;o<t.length;o++)Ca(e,t[o],n,r);return e}if(t.nodeType)for(o=e.length;o--;)n.call(e[o],t);return e},xa=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},ka=function(e,t,n){var r,o;return t=ja(t)[0],e.each((function(){n&&r===this.parentNode||(r=this.parentNode,o=t.cloneNode(!1),this.parentNode.insertBefore(o,this)),o.appendChild(this)})),e},Sa=dt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Ta=dt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Ea={for:"htmlFor",class:"className",readonly:"readOnly"},_a={float:"cssFloat"},Aa={},Na={},Ra=function(e,t){return new ja.fn.init(e,t)},Oa=/^\s*|\s*$/g,Da=function(e){return null==e?"":(""+e).replace(Oa,"")},Ia=function(e,t){var n,r,o,i;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(i=e[r],!1===t.call(i,r,i)))break}else for(o=0;o<n&&(i=e[o],!1!==t.call(i,o,i));o++);return e},Pa=function(e,t){var n=[];return Ia(e,(function(e,r){t(r,e)&&n.push(r)})),n},Ba=function(e){return e?9===e.nodeType?e:e.ownerDocument:da};Ra.fn=Ra.prototype={constructor:Ra,selector:"",context:null,length:0,init:function(e,t){var n,r;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(t&&t.nodeType)this.context=t;else{if(t)return ja(e).attr(t);this.context=t=document}if(ya(e)){if(this.selector=e,!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ga.exec(e)))return ja(t).find(e);if(n[1])for(r=wa(e,Ba(t)).firstChild;r;)ma.call(this,r),r=r.nextSibling;else{if(!(r=Ba(t).getElementById(n[2])))return this;if(r.id!==n[2])return this.find(e);this.length=1,this[0]=r}}else this.add(e,!1);return this},toArray:function(){return dt.toArray(this)},add:function(e,t){var n,r;if(ya(e))return this.add(ja(e));if(!1!==t)for(n=ja.unique(this.toArray().concat(ja.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else ma.apply(this,ja.makeArray(e));return this},attr:function(e,t){var n,r=this;if("object"==typeof e)Ia(e,(function(e,t){r.attr(e,t)}));else{if(!ba(t)){if(r[0]&&1===r[0].nodeType){if((n=Aa[e])&&n.get)return n.get(r[0],e);if(Ta[e])return r.prop(e)?e:void 0;null===(t=r[0].getAttribute(e,2))&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if((n=Aa[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=Ea[e]||e))Ia(e,(function(e,t){n.prop(e,t)}));else{if(!ba(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,r,o=this,i=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},a=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"==typeof e)Ia(e,(function(e,t){o.css(e,t)}));else if(ba(t))e=i(e),"number"!=typeof t||Sa[e]||(t=t.toString()+"px"),o.each((function(){var n=this.style;if((r=Na[e])&&r.set)r.set(this,t);else{try{this.style[_a[e]||e]=t}catch(e){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(a(e)):n.removeAttribute(e))}}));else{if(n=o[0],(r=Na[e])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[i(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(a(e))}catch(e){return}}return o},remove:function(){for(var e,t=this.length;t--;)e=this[t],ha.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(ba(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(n){ja(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(ba(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return Ca(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return Ca(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){var e=this;return e[0]&&e[0].parentNode?Ca(e,arguments,(function(e){this.parentNode.insertBefore(e,this)})):e},after:function(){var e=this;return e[0]&&e[0].parentNode?Ca(e,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):e},appendTo:function(e){return ja(e).append(this),this},prependTo:function(e){return ja(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return ka(this,e)},wrapAll:function(e){return ka(this,e,!0)},wrapInner:function(e){return this.each((function(){ja(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){ja(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),ja(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e||(-1!==e.indexOf(" ")?Ia(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,r){var o=xa(r,e);if(o!==t){var i=r.className;o?r.className=Da((" "+i+" ").replace(" "+e+" "," ")):r.className+=i?" "+e:e}}))),n},hasClass:function(e){return xa(this[0],e)},each:function(e){return Ia(this,e)},on:function(e,t){return this.each((function(){ha.bind(this,e,t)}))},off:function(e,t){return this.each((function(){ha.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"==typeof e?ha.fire(this,e.type,e):ha.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new ja(pa.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,r=[];for(t=0,n=this.length;t<n;t++)ja.find(e,this[t],r);return ja(r)},filter:function(e){return ja("function"==typeof e?Pa(this.toArray(),(function(t,n){return e(n,t)})):ja.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof ja&&(e=e[0]),this.each((function(n,r){for(;r;){if("string"==typeof e&&ja(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}})),ja(t)},offset:function(e){var t,n,r,o,i=0,a=0;return e?this.css(e):((t=this[0])&&(r=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(i=(o=t.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,a=o.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:i,top:a})},push:ma,sort:Array.prototype.sort,splice:Array.prototype.splice},dt.extend(Ra,{extend:dt.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:dt.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:dt.isArray,each:Ia,trim:Da,grep:Pa,find:Zi,expr:Zi.selectors,unique:Zi.uniqueSort,text:Zi.getText,contains:Zi.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return t=1===t.length?ja.find.matchesSelector(t[0],e)?[t[0]]:[]:ja.find.matches(e,t)}});var Ma=function(e,t,n){var r=[],o=e[t];for("string"!=typeof n&&n instanceof ja&&(n=n[0]);o&&9!==o.nodeType;){if(void 0!==n){if(o===n)break;if("string"==typeof n&&ja(o).is(n))break}1===o.nodeType&&r.push(o),o=o[t]}return r},La=function(e,t,n,r){var o=[];for(r instanceof ja&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&ja(e).is(r))break}o.push(e)}return o},Fa=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};Ia({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Ma(e,"parentNode")},next:function(e){return Fa(e,"nextSibling",1)},prev:function(e){return Fa(e,"previousSibling",1)},children:function(e){return La(e.firstChild,"nextSibling",1)},contents:function(e){return dt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){Ra.fn[e]=function(n){var r=[];this.each((function(){var e=t.call(r,this,n,r);e&&(ja.isArray(e)?r.push.apply(r,e):r.push(e))})),this.length>1&&(va[e]||(r=ja.unique(r)),0===e.indexOf("parents")&&(r=r.reverse()));var o=ja(r);return n?o.filter(n):o}})),Ia({parentsUntil:function(e,t){return Ma(e,"parentNode",t)},nextUntil:function(e,t){return La(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return La(e,"previousSibling",1,t).slice(1)}},(function(e,t){Ra.fn[e]=function(n,r){var o=[];this.each((function(){var e=t.call(o,this,n,o);e&&(ja.isArray(e)?o.push.apply(o,e):o.push(e))})),this.length>1&&(o=ja.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse()));var i=ja(o);return r?i.filter(r):i}})),Ra.fn.is=function(e){return!!e&&this.filter(e).length>0},Ra.fn.init.prototype=Ra.fn,Ra.overrideDefaults=function(e){var t,n=function(r,o){return t=t||e(),0===arguments.length&&(r=t.element),o||(o=t.context),new n.fn.init(r,o)};return ja.extend(n,this),n},Ra.attrHooks=Aa,Ra.cssHooks=Na;var ja=Ra,Ha=dt.each,Ua=dt.grep,za=ct.ie,Wa=/^([a-z0-9],?)+$/i,qa=function(e,t){var n=t.attr("style"),r=e.serialize(e.parse(n),t[0].nodeName);r||(r=null),t.attr("data-mce-style",r)},Va=function(e,t){var n,r,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(o++,n=r);return o};function $a(e,t){var n=this;void 0===t&&(t={});var r={},o=window,i={},a=0,c=Sr.forElement(pt.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),u=[],l=t.schema?t.schema:qo({}),f=li({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new bi:bi.Event,m=l.getBlockElements(),p=ja.overrideDefaults((function(){return{context:e,element:W.getRoot()}})),g=function(t){return t&&e&&_(t)?e.getElementById(t):t},h=function(e){return p("string"==typeof e?g(e):e)},v=function(e,t,n){var r,o,i=h(e);return i.length&&(o=(r=V[t])&&r.get?r.get(i,t):i.attr(t)),void 0===o&&(o=n||""),o},b=function(e){var t=g(e);return t?t.attributes:[]},y=function(e,n,r){""===r&&(r=null);var o=h(e),i=o.attr(n);if(o.length){var a=V[n];a&&a.set?a.set(o,r,n):o.attr(n,r),i!==r&&t.onSetAttrib&&t.onSetAttrib({attrElm:o,attrName:n,attrValue:r})}},w=function(){return t.root_element||e.body},C=function(t,n){return Kn(e.body,g(t),n)},x=function(e,t,n){var r=h(e);return n?r.css(t):("float"===(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})))&&(t=ct.browser.isIE()?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},k=function(e){var t,n;return e=g(e),t=x(e,"width"),n=x(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},S=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Wa.test(t)){var r=t.toLowerCase().split(/,/),o=e.nodeName.toLowerCase();for(n=r.length-1;n>=0;n--)if(r[n]===o)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var i=Array.isArray(e)?e:[e];return Zi(t,i[0].ownerDocument||i[0],null,i).length>0},T=function(e,t,n,r){var o,i=[],a=g(e);for(r=void 0===r,n=n||("BODY"!==w().nodeName?w().parentNode:null),dt.is(t,"string")&&(o=t,t="*"===t?function(e){return 1===e.nodeType}:function(e){return S(e,o)});a&&!(a===n||I(a.nodeType)||Sn(a)||Tn(a));){if(!t||"function"==typeof t&&t(a)){if(!r)return[a];i.push(a)}a=a.parentNode}return r?i:null},E=function(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return S(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null},A=function(e,t,r){var o,i="string"==typeof e?g(e):e;if(!i)return!1;if(dt.isArray(i)&&(i.length||0===i.length))return o=[],Ha(i,(function(e,n){e&&o.push(t.call(r,"string"==typeof e?g(e):e,n))})),o;var a=r||n;return t.call(a,i)},N=function(e,t){h(e).each((function(e,n){Ha(t,(function(e,t){y(n,t,e)}))}))},R=function(e,t){var n=h(e);za?n.each((function(e,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(e){ja("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},O=function(t,n,r,o,i){return A(t,(function(t){var a="string"==typeof n?e.createElement(n):n;return N(a,r),o&&("string"!=typeof o&&o.nodeType?a.appendChild(o):"string"==typeof o&&R(a,o)),i?a:t.appendChild(a)}))},D=function(t,n,r){return O(e.createElement(t),t,n,r,!0)},P=Po.encodeAllRaw,B=function(e,t){var n=h(e);return t?n.each((function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),n.length>1?n.toArray():n[0]},M=function(e,t,n){h(e).toggleClass(t,n).each((function(){""===this.className&&ja(this).attr("class",null)}))},L=function(e,t,n){return A(t,(function(t){return dt.is(t,"array")&&(e=e.cloneNode(!0)),n&&Ha(Ua(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},F=function(e){if(pn(e)){var t="a"===e.nodeName.toLowerCase()&&!v(e,"href")&&v(e,"id");if(v(e,"name")||v(e,"data-mce-bookmark")||t)return!0}return!1},j=function(){return e.createRange()},H=function(n,r,i,a){if(dt.isArray(n)){for(var c=n.length,l=[];c--;)l[c]=H(n[c],r,i,a);return l}return!t.collect||n!==e&&n!==o||u.push([n,r,i,a]),d.bind(n,r,i,a||W)},U=function(t,n,r){if(dt.isArray(t)){for(var i=t.length,a=[];i--;)a[i]=U(t[i],n,r);return a}if(u.length>0&&(t===e||t===o))for(i=u.length;i--;){var c=u[i];t!==c[0]||n&&n!==c[1]||r&&r!==c[2]||d.unbind(c[0],c[1],c[2])}return d.unbind(t,n,r)},z=function(e){if(e&&pn(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},W={doc:e,settings:t,win:o,files:i,stdMode:!0,boxModel:!0,styleSheetLoader:c,boundEvents:u,styles:f,schema:l,events:d,isBlock:function(e){if("string"==typeof e)return!!m[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!m[e.nodeName])}return!1},$:p,$$:h,root:null,clone:function(t,n){if(!za||1!==t.nodeType||n)return t.cloneNode(n);var r=e.createElement(t.nodeName);return Ha(b(t),(function(e){y(r,e.nodeName,v(t,e.nodeName))})),r},getRoot:w,getViewPort:function(e){var t=fn(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:function(e){e=g(e);var t=C(e),n=k(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:k,getParent:function(e,t,n){var r=T(e,t,n,!1);return r&&r.length>0?r[0]:null},getParents:T,get:g,getNext:function(e,t){return E(e,t,"nextSibling")},getPrev:function(e,t){return E(e,t,"previousSibling")},select:function(n,r){return Zi(n,g(r)||t.root_element||e,[])},is:S,add:O,create:D,createHTML:function(e,t,n){var r,o="";for(r in o+="<"+e,t)t.hasOwnProperty(r)&&null!==t[r]&&void 0!==t[r]&&(o+=" "+r+'="'+P(t[r])+'"');return void 0!==n?o+">"+n+"</"+e+">":o+" />"},createFragment:function(t){var n,r=e.createElement("div"),o=e.createDocumentFragment();for(o.appendChild(r),t&&(r.innerHTML=t);n=r.firstChild;)o.appendChild(n);return o.removeChild(r),o},remove:B,setStyle:function(e,n,r){var o=_(n)?h(e).css(n,r):h(e).css(n);t.update_styles&&qa(f,o)},getStyle:x,setStyles:function(e,n){var r=h(e).css(n);t.update_styles&&qa(f,r)},removeAllAttribs:function(e){return A(e,(function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))},setAttrib:y,setAttribs:N,getAttrib:v,getPos:C,parseStyle:function(e){return f.parse(e)},serializeStyle:function(e,t){return f.serialize(e,t)},addStyle:function(t){var n,o;if(W!==$a.DOM&&e===document){if(r[t])return;r[t]=!0}(o=e.getElementById("mceDefaultStyles"))||((o=e.createElement("style")).id="mceDefaultStyles",o.type="text/css",(n=e.getElementsByTagName("head")[0]).firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o)),o.styleSheet?o.styleSheet.cssText+=t:o.appendChild(e.createTextNode(t))},loadCSS:function(e){e||(e=""),q(e.split(","),(function(e){i[e]=!0,c.load(e,s)}))},addClass:function(e,t){h(e).addClass(t)},removeClass:function(e,t){M(e,t,!1)},hasClass:function(e,t){return h(e).hasClass(t)},toggleClass:M,show:function(e){h(e).show()},hide:function(e){h(e).hide()},isHidden:function(e){return"none"===h(e).css("display")},uniqueId:function(e){return(e||"mce_")+a++},setHTML:R,getOuterHTML:function(e){var t="string"==typeof e?g(e):e;return pn(t)?t.outerHTML:ja("<div></div>").append(ja(t).clone()).html()},setOuterHTML:function(e,t){h(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}B(ja(this).html(t),!0)}))},decode:Po.decode,encode:P,insertAfter:function(e,t){var n=g(t);return A(e,(function(e){var t=n.parentNode,r=n.nextSibling;return r?t.insertBefore(e,r):t.appendChild(e),e}))},replace:L,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=D(t),Ha(b(e),(function(t){y(n,t.nodeName,v(e,t.nodeName))})),L(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return f.toHex(dt.trim(e))},run:A,getAttribs:b,isEmpty:function(e,t){var n,r,o=0;if(F(e))return!1;if(e=e.firstChild){var i=new Tr(e,e.parentNode),a=l?l.getWhiteSpaceElements():{};t=t||(l?l.getNonEmptyElements():null);do{if(n=e.nodeType,pn(e)){var c=e.getAttribute("data-mce-bogus");if(c){e=i.next("all"===c);continue}if(r=e.nodeName.toLowerCase(),t&&t[r]){if("br"===r){o++,e=i.next();continue}return!1}if(F(e))return!1}if(8===n)return!1;if(3===n&&!lo(e.nodeValue))return!1;if(3===n&&e.parentNode&&a[e.parentNode.nodeName]&&lo(e.nodeValue))return!1;e=i.next()}while(e)}return o<=1},createRng:j,nodeIndex:Va,split:function(e,t,n){var r,o,i,a=j();if(e&&t)return a.setStart(e.parentNode,Va(e)),a.setEnd(t.parentNode,Va(t)),r=a.extractContents(),(a=j()).setStart(t.parentNode,Va(t)+1),a.setEnd(e.parentNode,Va(e)+1),o=a.extractContents(),(i=e.parentNode).insertBefore(wo(W,r),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(wo(W,o),e),B(e),n||t},bind:H,unbind:U,fire:function(e,t,n){return d.fire(e,t,n)},getContentEditable:z,getContentEditableParent:function(e){for(var t=w(),n=null;e&&e!==t&&null===(n=z(e));e=e.parentNode);return n},destroy:function(){if(u.length>0)for(var e=u.length;e--;){var t=u[e];d.unbind(t[0],t[1],t[2])}ce(i,(function(e,t){c.unload(t),delete i[t]})),Zi.setDocument&&Zi.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},V=function(e,t,n){var r=t.keep_values,o={set:function(e,r,o){t.url_converter&&(r=t.url_converter.call(t.url_converter_scope||n(),r,o,e[0])),e.attr("data-mce-"+o,r).attr(o,r)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},i={style:{set:function(t,n){null===n||"object"!=typeof n?(r&&t.attr("data-mce-style",n),null!==n&&"string"==typeof n?(t.removeAttr("style"),t.css(e.parse(n))):t.attr("style",n)):t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return n=e.serialize(e.parse(n),t[0].nodeName)}}};return r&&(i.href=i.src=o),i}(f,t,(function(){return W}));return W}!function(e){e.DOM=e(document),e.nodeIndex=Va}($a||($a={}));var Ka=$a,Ja=Ka.DOM,Ga=dt.each,Xa=dt.grep,Ya=function(){function e(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}return e.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},e.prototype.loadScript=function(e,t,n){var r,o=Ja,i=function(){o.remove(a),r&&(r.onerror=r.onload=r=null)},a=o.uniqueId();(r=document.createElement("script")).id=a,r.type="text/javascript",r.src=dt._addCacheSuffix(e),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=function(){i(),t()},r.onerror=function(){i(),B(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(r)},e.prototype.isDone=function(e){return 2===this.states[e]},e.prototype.markDone=function(e){this.states[e]=2},e.prototype.add=function(e,t,n,r){var o=this.states[e];this.queue.push(e),void 0===o&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},e.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},e.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},e.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},e.prototype.loadScripts=function(e,t,n,r){var o=this,i=[],a=function(e,t){Ga(o.scriptLoadedCallbacks[t],(function(t){B(t[e])&&t[e].call(t.scope)})),o.scriptLoadedCallbacks[t]=void 0};o.queueLoadedCallbacks.push({success:t,failure:r,scope:n||this});var c=function(){var t=Xa(e);if(e.length=0,Ga(t,(function(e){2!==o.states[e]?3!==o.states[e]?1!==o.states[e]&&(o.states[e]=1,o.loading++,o.loadScript(e,(function(){o.states[e]=2,o.loading--,a("success",e),c()}),(function(){o.states[e]=3,o.loading--,i.push(e),a("failure",e),c()}))):a("failure",e):a("success",e)})),!o.loading){var n=o.queueLoadedCallbacks.slice(0);o.queueLoadedCallbacks.length=0,Ga(n,(function(e){0===i.length?B(e.success)&&e.success.call(e.scope):B(e.failure)&&e.failure.call(e.scope,i)}))}};c()},e.ScriptLoader=new e,e}(),Qa=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Za={},ec=Qa("en"),tc=function(){return ge(Za,ec.get())},nc={getData:function(){return ue(Za,(function(e){return Ee({},e)}))},setCode:function(e){e&&ec.set(e)},getCode:function(){return ec.get()},add:function(e,t){var n=Za[e];n||(Za[e]=n={}),ce(t,(function(e,t){n[t.toLowerCase()]=e}))},translate:function(e){var t,n=tc().getOr({}),r=function(e){return B(e)?Object.prototype.toString.call(e):o(e)?"":""+e},o=function(e){return""===e||null==e},i=function(e){var t=r(e);return ge(n,t.toLowerCase()).map(r).getOr(t)},a=function(e){return e.replace(/{context:\w+}$/,"")};if(o(e))return"";if(A(t=e)&&he(t,"raw"))return r(e.raw);if(function(e){return N(e)&&e.length>1}(e)){var c=e.slice(1);return a(i(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return he(c,t)?r(c[t]):e})))}return a(i(e))},isRtl:function(){return tc().bind((function(e){return ge(e,"_dir")})).exists((function(e){return"rtl"===e}))},hasCode:function(e){return he(Za,e)}};function rc(){var e=this,t=[],n={},r={},o=[],i=function(e,t){var n=$(o,(function(n){return n.name===e&&n.state===t}));q(n,(function(e){return e.callback()}))},a=function(e){var t;return r[e]&&(t=r[e].dependencies),t||[]},c=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},u=function(e,t,o,l,s){if(!n[e]){var f="string"==typeof t?t:t.prefix+t.resource+t.suffix;0!==f.indexOf("/")&&-1===f.indexOf("://")&&(f=rc.baseURL+"/"+f),n[e]=f.substring(0,f.lastIndexOf("/"));var d=function(){i(e,"loaded"),function(e,t,n,r){var o=a(e);q(o,(function(e){var n=c(t,e);u(n.resource,n,void 0,void 0)})),n&&(r?n.call(r):n.call(Ya))}(e,t,o,l)};r[e]?d():Ya.ScriptLoader.add(f,d,l,s)}},l=function(e,t,i){void 0===i&&(i="added"),he(r,e)&&"added"===i||he(n,e)&&"loaded"===i?t():o.push({name:e,state:i,callback:t})};return{items:t,urls:n,lookup:r,_listeners:o,get:function(e){if(r[e])return r[e].instance},dependencies:a,requireLangPack:function(e,t){!1!==rc.languageLoad&&l(e,(function(){var r=nc.getCode();!r||t&&-1===(","+(t||"")+",").indexOf(","+r+",")||Ya.ScriptLoader.add(n[e]+"/langs/"+r+".js")}),"loaded")},add:function(e,n,o){var a=n;return t.push(a),r[e]={instance:a,dependencies:o},i(e,"added"),a},remove:function(e){delete n[e],delete r[e]},createUrl:c,addComponents:function(t,n){var r=e.urls[t];q(n,(function(e){Ya.ScriptLoader.add(r+"/"+e)}))},load:u,waitFor:l}}!function(e){e.PluginManager=e(),e.ThemeManager=e()}(rc||(rc={}));var oc=rc,ic=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null===n&&(n=setTimeout((function(){e.apply(null,r),n=null}),t))}}},ac=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==n&&clearTimeout(n),n=setTimeout((function(){e.apply(null,r),n=null}),t)}}},cc=function(e,t){var n=Mn(e,t);return void 0===n||""===n?[]:n.split(" ")},uc=function(e){return void 0!==e.dom.classList},lc=function(e,t){return function(e,t,n){var r=cc(e,t).concat([n]);return Pn(e,t,r.join(" ")),!0}(e,"class",t)},sc=function(e,t){return function(e,t,n){var r=$(cc(e,t),(function(e){return e!==n}));return r.length>0?Pn(e,t,r.join(" ")):Fn(e,t),!1}(e,"class",t)},fc=function(e,t){uc(e)?e.dom.classList.add(t):lc(e,t)},dc=function(e){0===(uc(e)?e.dom.classList:function(e){return cc(e,"class")}(e)).length&&Fn(e,"class")},mc=function(e,t){return uc(e)&&e.dom.classList.contains(t)},pc=function(e,t){var n=[];return q(Mt(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(pc(e,t))})),n},gc=function(e,t){return function(e,t){var n=void 0===t?document:t.dom;return vt(n)?[]:W(n.querySelectorAll(e),pt.fromDom)}(t,e)},hc=d("mce-annotation"),vc=d("data-mce-annotation"),bc=d("data-mce-annotation-uid"),yc=function(e,t){var n=e.selection.getRng(),r=pt.fromDom(n.startContainer),o=pt.fromDom(e.getBody()),i=t.fold((function(){return"."+hc()}),(function(e){return"["+vc()+'="'+e+'"]'})),a=Lt(r,n.startOffset).getOr(r),c=gr(a,i,(function(e){return bt(e,o)})),u=function(e,t){return function(e,t){var n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)}(e,t)?k.some(Mn(e,t)):k.none()};return c.bind((function(t){return u(t,""+bc()).bind((function(n){return u(t,""+vc()).map((function(t){var r=wc(e,n);return{uid:n,name:t,elements:r}}))}))}))},wc=function(e,t){var n=pt.fromDom(e.getBody());return gc(n,"["+bc()+'="'+t+'"]')},Cc=function(e,t){var n=Qa({}),r=function(e,t){o(e,(function(e){return t(e),e}))},o=function(e,t){var r=n.get(),o=t(r.hasOwnProperty(e)?r[e]:{listeners:[],previous:Qa(k.none())});r[e]=o,n.set(r)},i=ac((function(){var t,i,a,c=n.get(),u=(t=ie(c),(a=L.call(t,0)).sort(i),a);q(u,(function(t){o(t,(function(n){var o=n.previous.get();return yc(e,k.some(t)).fold((function(){o.isSome()&&(!function(e){r(e,(function(t){q(t.listeners,(function(t){return t(!1,e)}))}))}(t),n.previous.set(k.none()))}),(function(e){var t=e.uid,i=e.name,a=e.elements;o.is(t)||(!function(e,t,n){r(e,(function(r){q(r.listeners,(function(r){return r(!0,e,{uid:t,nodes:W(n,(function(e){return e.dom}))})}))}))}(i,t,a),n.previous.set(k.some(t)))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(function(){i.cancel()})),e.on("NodeChange",(function(){i.throttle()}));return{addListener:function(e,t){o(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))}}},xc=function(e,t){e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){q(e,(function(e){(function(e){return k.from(e.attr(vc())).bind(t.lookup)})(e).each((function(t){!1===t.persistent&&e.unwrap()}))}))}))}))},kc=0,Sc=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++kc+String(t)},Tc=function(e,t){var n,r,o=At(e).dom,i=pt.fromDom(o.createDocumentFragment()),a=(n=t,(r=(o||document).createElement("div")).innerHTML=n,Mt(pt.fromDom(r)));Yt(i,a),Qt(e),Xt(e,i)},Ec=function(e,t){return pt.fromDom(e.dom.cloneNode(t))},_c=function(e){return Ec(e,!1)},Ac=function(e){return Ec(e,!0)},Nc=function(e,t,n){void 0===n&&(n=b);var r=new Tr(e,t),o=function(e){var t;do{t=r[e]()}while(t&&!xn(t)&&!n(t));return k.from(t).filter(xn)};return{current:function(){return k.from(r.current()).filter(xn)},next:function(){return o("next")},prev:function(){return o("prev")},prev2:function(){return o("prev2")}}},Rc=function(e,t){var n=t||function(t){return e.isBlock(t)||En(t)||Nn(t)},r=function(e,t,n,o){if(xn(e)){var i=o(e,t,e.data);if(-1!==i)return k.some({container:e,offset:i})}return n().bind((function(e){return r(e.container,e.offset,n,o)}))};return{backwards:function(e,t,o,i){var a=Nc(e,i,n);return r(e,t,(function(){return a.prev().map((function(e){return{container:e,offset:e.length}}))}),o).getOrNull()},forwards:function(e,t,o,i){var a=Nc(e,i,n);return r(e,t,(function(){return a.next().map((function(e){return{container:e,offset:0}}))}),o).getOrNull()}}},Oc=function(e,t,n){return e.isSome()&&t.isSome()?k.some(n(e.getOrDie(),t.getOrDie())):k.none()},Dc=Math.round,Ic=function(e){return e?{left:Dc(e.left),top:Dc(e.top),bottom:Dc(e.bottom),right:Dc(e.right),width:Dc(e.width),height:Dc(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Pc=function(e,t){return e=Ic(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},Bc=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2},Mc=function(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&Bc(t.top-e.bottom,e,t)},Lc=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&Bc(t.bottom-e.top,e,t)},Fc=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},jc=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Hc=function(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e},Uc=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),zc=function(e){return"string"==typeof e&&e.charCodeAt(0)>=768&&Uc.test(e)},Wc=pn,qc=io,Vc=hn("display","block table"),$c=hn("float","left right"),Kc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}}(Wc,qc,g($c)),Jc=g(hn("white-space","pre pre-line pre-wrap")),Gc=xn,Xc=En,Yc=Ka.nodeIndex,Qc=Hc,Zc=function(e){return"createRange"in e?e.createRange():Ka.DOM.createRng()},eu=function(e){return e&&/[\r\n\t ]/.test(e)},tu=function(e){return!!e.setStart&&!!e.setEnd},nu=function(e){var t,n=e.startContainer,r=e.startOffset;return!!(eu(e.toString())&&Jc(n.parentNode)&&xn(n)&&(t=n.data,eu(t[r-1])||eu(t[r+1])))},ru=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},ou=function(e){var t,n=e.getClientRects();return t=n.length>0?Ic(n[0]):Ic(e.getBoundingClientRect()),!tu(e)&&Xc(e)&&ru(t)?function(e){var t=e.ownerDocument,n=Zc(t),r=t.createTextNode(" "),o=e.parentNode;o.insertBefore(r,e),n.setStart(r,0),n.setEnd(r,1);var i=Ic(n.getBoundingClientRect());return o.removeChild(r),i}(e):ru(t)&&tu(e)?function(e){var t=e.startContainer,n=e.endContainer,r=e.startOffset,o=e.endOffset;if(t===n&&xn(n)&&0===r&&1===o){var i=e.cloneRange();return i.setEndAfter(n),ou(i)}return null}(e):t},iu=function(e,t){var n=Pc(e,t);return n.width=1,n.right=n.left+1,n},au=function(e){var t,n,r=[],o=function(e){var t,n;0!==e.height&&(r.length>0&&(t=e,n=r[r.length-1],t.left===n.left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right)||r.push(e))},i=function(e,t){var n=Zc(e.ownerDocument);if(t<e.data.length){if(zc(e.data[t]))return r;if(zc(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!nu(n)))return o(iu(ou(n),!1)),r}t>0&&(n.setStart(e,t-1),n.setEnd(e,t),nu(n)||o(iu(ou(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),nu(n)||o(iu(ou(n),!0)))};if(Gc(e.container()))return i(e.container(),e.offset()),r;if(Wc(e.container()))if(e.isAtEnd())n=Qc(e.container(),e.offset()),Gc(n)&&i(n,n.data.length),Kc(n)&&!Xc(n)&&o(iu(ou(n),!1));else{if(n=Qc(e.container(),e.offset()),Gc(n)&&i(n,0),Kc(n)&&e.isAtEnd())return o(iu(ou(n),!1)),r;t=Qc(e.container(),e.offset()-1),Kc(t)&&!Xc(t)&&(Vc(t)||Vc(n)||!Kc(n))&&o(iu(ou(t),!1)),Kc(n)&&o(iu(ou(n),!0))}return r};function cu(e,t,n){var r=function(){return n||(n=au(cu(e,t))),n};return{container:d(e),offset:d(t),toRange:function(){var n=Zc(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects:r,isVisible:function(){return r().length>0},isAtStart:function(){return Gc(e),0===t},isAtEnd:function(){return Gc(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return Qc(e,n?t-1:t)}}}!function(e){e.fromRangeStart=function(t){return e(t.startContainer,t.startOffset)},e.fromRangeEnd=function(t){return e(t.endContainer,t.endOffset)},e.after=function(t){return e(t.parentNode,Yc(t)+1)},e.before=function(t){return e(t.parentNode,Yc(t))},e.isAbove=function(e,t){return Oc(ne(t.getClientRects()),re(e.getClientRects()),Mc).getOr(!1)},e.isBelow=function(e,t){return Oc(re(t.getClientRects()),ne(e.getClientRects()),Lc).getOr(!1)},e.isAtStart=function(e){return!!e&&e.isAtStart()},e.isAtEnd=function(e){return!!e&&e.isAtEnd()},e.isTextPosition=function(e){return!!e&&xn(e.container())},e.isElementPosition=function(t){return!1===e.isTextPosition(t)}}(cu||(cu={}));var uu,lu=cu,su=function(e,t){xn(t)&&0===t.data.length&&e.remove(t)},fu=function(e,t,n){Tn(n)?function(e,t,n){var r=k.from(n.firstChild),o=k.from(n.lastChild);t.insertNode(n),r.each((function(t){return su(e,t.previousSibling)})),o.each((function(t){return su(e,t.nextSibling)}))}(e,t,n):function(e,t,n){t.insertNode(n),su(e,n.previousSibling),su(e,n.nextSibling)}(e,t,n)},du=xn,mu=bn,pu=Ka.nodeIndex,gu=function(e){var t=e.parentNode;return mu(t)?gu(t):t},hu=function(e){return e?ke(e.childNodes,(function(e,t){return mu(t)&&"BR"!==t.nodeName?e=e.concat(hu(t)):e.push(t),e}),[]):[]},vu=function(e){return function(t){return e===t}},bu=function(e){return(du(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t,n;t=hu(gu(e)),n=Se(t,vu(e),e),t=t.slice(0,n+1);var r=ke(t,(function(e,n,r){return du(n)&&du(t[r-1])&&e++,e}),0);return t=Ce(t,gn([e.nodeName])),(n=Se(t,vu(e),e))-r}(e)+"]"},yu=function(e,t){var n,r,o,i,a,c=[];return n=t.container(),r=t.offset(),du(n)?o=function(e,t){for(;(e=e.previousSibling)&&du(e);)t+=e.data.length;return t}(n,r):(r>=(i=n.childNodes).length?(o="after",r=i.length-1):o="before",n=i[r]),c.push(bu(n)),a=function(e,t,n){var r=[];for(t=t.parentNode;t!==e&&(!n||!n(t));t=t.parentNode)r.push(t);return r}(e,n),a=Ce(a,g(bn)),(c=c.concat(we(a,(function(e){return bu(e)})))).reverse().join("/")+","+o},wu=function(e,t){var n;if(!t)return null;var r=t.split(","),o=r[0].split("/");n=r.length>1?r[1]:"before";var i=ke(o,(function(e,t){var n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),function(e,t,n){var r=hu(e);return r=Ce(r,(function(e,t){return!du(e)||!du(r[t-1])})),(r=Ce(r,gn([t])))[n]}(e,n[1],parseInt(n[2],10))):null}),e);return i?du(i)?function(e,t){for(var n,r=e,o=0;du(r);){if(n=r.data.length,t>=o&&t<=o+n){e=r,t-=o;break}if(!du(r.nextSibling)){e=r,t=n;break}o+=n,r=r.nextSibling}return du(e)&&t>e.data.length&&(t=e.data.length),lu(e,t)}(i,parseInt(n,10)):(n="after"===n?pu(i)+1:pu(i),lu(i.parentNode,n)):null},Cu=Nn,xu=function(e,t,n,r,o){var i,a=r[o?"startContainer":"endContainer"],c=r[o?"startOffset":"endOffset"],u=[],l=0,s=e.getRoot();for(xn(a)?u.push(n?function(e,t,n){var r,o;for(o=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&xn(r);r=r.previousSibling)o+=e(r.data).length;return o}(t,a,c):c):(c>=(i=a.childNodes).length&&i.length&&(l=1,c=Math.max(0,i.length-1)),u.push(e.nodeIndex(i[c],n)+l));a&&a!==s;a=a.parentNode)u.push(e.nodeIndex(a,n));return u},ku=function(e,t,n){var r=0;return dt.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++})),r},Su=function(e,t){var n,r,o,i=t?"start":"end";n=e[i+"Container"],r=e[i+"Offset"],pn(n)&&"TR"===n.nodeName&&(n=(o=n.childNodes)[Math.min(t?r:r-1,o.length-1)])&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r))},Tu=function(e){return Su(e,!0),Su(e,!1),e},Eu=function(e,t){var n;if(pn(e)&&(e=Hc(e,t),Cu(e)))return e;if(Wr(e)){if(xn(e)&&Ur(e)&&(e=e.parentNode),n=e.previousSibling,Cu(n))return n;if(n=e.nextSibling,Cu(n))return n}},_u=function(e,t,n){var r=n.getNode(),o=r?r.nodeName:null,i=n.getRng();if(Cu(r)||"IMG"===o)return{name:o,index:ku(n.dom,o,r)};var a=function(e){return Eu(e.startContainer,e.startOffset)||Eu(e.endContainer,e.endOffset)}(i);return a?{name:o=a.tagName,index:ku(n.dom,o,a)}:function(e,t,n,r){var o=t.dom,i={};return i.start=xu(o,e,n,r,!0),t.isCollapsed()||(i.end=xu(o,e,n,r,!1)),i}(e,n,t,i)},Au=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},Nu=function(e,t){var n=e.dom,r=e.getRng(),o=n.uniqueId(),i=e.isCollapsed(),a=e.getNode(),c=a.nodeName;if("IMG"===c)return{name:c,index:ku(n,c,a)};var u=Tu(r.cloneRange());if(!i){u.collapse(!1);var l=Au(n,o+"_end",t);fu(n,u,l)}(r=Tu(r)).collapse(!0);var s=Au(n,o+"_start",t);return fu(n,r,s),e.moveToBookmark({id:o,keep:!0}),{id:o}},Ru=function(e,t,n){return 2===t?_u(Fr,n,e):3===t?function(e){var t=e.getRng();return{start:yu(e.dom.getRoot(),lu.fromRangeStart(t)),end:yu(e.dom.getRoot(),lu.fromRangeEnd(t))}}(e):t?function(e){return{rng:e.getRng()}}(e):Nu(e,!1)},Ou=p(_u,m,!0),Du=Ka.DOM,Iu=function(e,t,n){var r=e.getParam(t,n);if(-1!==r.indexOf("=")){var o=e.getParam(t,"","hash");return o.hasOwnProperty(e.id)?o[e.id]:n}return r},Pu=function(e){return e.getParam("content_security_policy","")},Bu=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Mu=function(e){return e.getParam("forced_root_block_attrs",{})},Lu=function(e){return e.getParam("automatic_uploads",!0,"boolean")},Fu=function(e){return e.getParam("images_reuse_filename",!1,"boolean")},ju=function(e){return e.getParam("icons","","string")},Hu=function(e){return e.getParam("images_upload_url","","string")},Uu=function(e){return e.getParam("images_upload_base_path","","string")},zu=function(e){return e.getParam("images_upload_credentials",!1,"boolean")},Wu=function(e){return e.getParam("images_upload_handler",null,"function")},qu=function(e){return e.getParam("content_css_cors",!1,"boolean")},Vu=function(e){return e.getParam("referrer_policy","","string")},$u=function(e){return e.getParam("language","en","string")},Ku=function(e){return e.getParam("indent_use_margin",!1)},Ju=function(e){var t=e.getParam("object_resizing");return!1!==t&&!ct.iOS&&(_(t)?t:"table,img,figure.image,div")},Gu=function(e){return e.getParam("event_root")},Xu=function(e){return e.getParam("theme")},Yu=function(e){return e.getParam("validate")},Qu=function(e){return!1!==e.getParam("inline_boundaries")},Zu=function(e){return e.getParam("content_css_cors")},el=function(e){return e.getParam("plugins","","string")},tl=pn,nl=xn,rl=function(e){var t=e.parentNode;t&&t.removeChild(e)},ol=function(e){var t=Fr(e);return{count:e.length-t.length,text:t}},il=function(e){for(var t;-1!==(t=e.data.lastIndexOf("\ufeff"));)e.deleteData(t,1)},al=function(e,t){return sl(e),t},cl=function(e,t){var n=t.container(),r=function(e,t){var n=H(e,t);return-1===n?k.none():k.some(n)}(oe(n.childNodes),e).map((function(e){return e<t.offset()?lu(n,t.offset()-1):t})).getOr(t);return sl(e),r},ul=function(e,t){return nl(e)&&t.container()===e?function(e,t){var n=ol(e.data.substr(0,t.offset())),r=ol(e.data.substr(t.offset()));return(n.text+r.text).length>0?(il(e),lu(e,t.offset()-n.count)):t}(e,t):al(e,t)},ll=function(e,t){return lu.isTextPosition(t)?ul(e,t):function(e,t){return t.container()===e.parentNode?cl(e,t):al(e,t)}(e,t)},sl=function(e){tl(e)&&Wr(e)&&(qr(e)?e.removeAttribute("data-mce-caret"):rl(e)),nl(e)&&(il(e),0===e.data.length&&rl(e))},fl=Qe().browser,dl=Nn,ml=On,pl=Rn,gl=function(e,t,n){var r,o,i,a,c,u=Pc(t.getBoundingClientRect(),n);return"BODY"===e.tagName?(r=e.ownerDocument.documentElement,o=e.scrollLeft||r.scrollLeft,i=e.scrollTop||r.scrollTop):(c=e.getBoundingClientRect(),o=e.scrollLeft-c.left,i=e.scrollTop-c.top),u.left+=o,u.right+=o,u.top+=i,u.bottom+=i,u.width=1,(a=t.offsetWidth-t.clientWidth)>0&&(n&&(a*=-1),u.left+=a,u.right+=a),u},hl=function(e,t,n,r){var o,i,a=Qa(k.none()),c=Bu(e),u=c.length>0?c:"p",l=function(){!function(e){for(var t=gc(pt.fromDom(e),"*[contentEditable=false],video,audio,embed,object"),n=0;n<t.length;n++){var r,o=t[n].dom,i=o.previousSibling;if(Gr(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(r.length-1,1);if(i=o.nextSibling,Jr(i))1===(r=i.data).length?i.parentNode.removeChild(i):i.deleteData(0,1)}}(t),i&&(sl(i),i=null),a.get().each((function(e){ja(e.caret).remove(),a.set(k.none())})),o&&(wr.clearInterval(o),o=null)},s=function(){o=wr.setInterval((function(){r()?ja("div.mce-visual-caret",t).toggleClass("mce-visual-caret-hidden"):ja("div.mce-visual-caret",t).addClass("mce-visual-caret-hidden")}),500)};return{show:function(e,r){var o,c;if(l(),pl(r))return null;if(!n(r))return i=function(e,t){var n,r=e.ownerDocument.createTextNode("\ufeff"),o=e.parentNode;if(t){if(n=e.previousSibling,Hr(n)){if(Wr(n))return n;if(Gr(n))return n.splitText(n.data.length-1)}o.insertBefore(r,e)}else{if(n=e.nextSibling,Hr(n)){if(Wr(n))return n;if(Jr(n))return n.splitText(1),n}e.nextSibling?o.insertBefore(r,e.nextSibling):o.appendChild(r)}return r}(r,e),c=r.ownerDocument.createRange(),bl(i.nextSibling)?(c.setStart(i,0),c.setEnd(i,0)):(c.setStart(i,1),c.setEnd(i,1)),c;i=Kr(u,r,e),o=gl(t,r,e),ja(i).css("top",o.top);var f=ja('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(o).appendTo(t)[0];return a.set(k.some({caret:f,element:r,before:e})),a.get().each((function(t){e&&ja(t.caret).addClass("mce-visual-caret-before")})),s(),(c=r.ownerDocument.createRange()).setStart(i,0),c.setEnd(i,0),c},hide:l,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){a.get().each((function(e){var n=gl(t,e.element,e.before);ja(e.caret).css(Ee({},n))}))},destroy:function(){return wr.clearInterval(o)}}},vl=function(){return fl.isIE()||fl.isEdge()||fl.isFirefox()},bl=function(e){return dl(e)||ml(e)},yl=function(e){return bl(e)||yn(e)&&vl()},wl=Nn,Cl=On,xl=hn("display","block table table-cell table-caption list-item"),kl=Wr,Sl=Ur,Tl=pn,El=io,_l=function(e){return e>0},Al=function(e){return e<0},Nl=function(e,t){for(var n;n=e(t);)if(!Sl(n))return n;return null},Rl=function(e,t,n,r,o){var i=new Tr(e,r),a=wl(e)||Sl(e);if(Al(t)){if(a&&n(e=Nl(i.prev,!0)))return e;for(;e=Nl(i.prev,o);)if(n(e))return e}if(_l(t)){if(a&&n(e=Nl(i.next,!0)))return e;for(;e=Nl(i.next,o);)if(n(e))return e}return null},Ol=function(e,t){for(;e&&e!==t;){if(xl(e))return e;e=e.parentNode}return null},Dl=function(e,t,n){return Ol(e.container(),n)===Ol(t.container(),n)},Il=function(e,t){if(!t)return null;var n=t.container(),r=t.offset();return Tl(n)?n.childNodes[r+e]:null},Pl=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},Bl=function(e,t,n){return Ol(t,e)===Ol(n,e)},Ml=function(e,t,n){var r,o;for(o=e?"previousSibling":"nextSibling";n&&n!==t;){if(r=n[o],kl(r)&&(r=r[o]),wl(r)||Cl(r)){if(Bl(t,r,n))return r;break}if(El(r))break;n=n.parentNode}return null},Ll=p(Pl,!0),Fl=p(Pl,!1),jl=function(e,t,n){var r,o,i,a=p(Ml,!0,t),c=p(Ml,!1,t);o=n.startContainer;var u=n.startOffset;if(Ur(o)){if(Tl(o)||(o=o.parentNode),"before"===(i=o.getAttribute("data-mce-caret"))&&(r=o.nextSibling,yl(r)))return Ll(r);if("after"===i&&(r=o.previousSibling,yl(r)))return Fl(r)}if(!n.collapsed)return n;if(xn(o)){if(kl(o)){if(1===e){if(r=c(o))return Ll(r);if(r=a(o))return Fl(r)}if(-1===e){if(r=a(o))return Fl(r);if(r=c(o))return Ll(r)}return n}if(Gr(o)&&u>=o.data.length-1)return 1===e&&(r=c(o))?Ll(r):n;if(Jr(o)&&u<=1)return-1===e&&(r=a(o))?Fl(r):n;if(u===o.data.length)return(r=c(o))?Ll(r):n;if(0===u)return(r=a(o))?Fl(r):n}return n},Hl=function(e,t){return k.from(Il(e?0:-1,t)).filter(wl)},Ul=function(e,t,n){var r=jl(e,t,n);return-1===e?cu.fromRangeStart(r):cu.fromRangeEnd(r)},zl=function(e){return k.from(e.getNode()).map(pt.fromDom)},Wl=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},ql=function(e,t){var n=Dl(e,t);return!(n||!En(e.getNode()))||n};!function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"}(uu||(uu={}));var Vl,$l=Nn,Kl=xn,Jl=pn,Gl=En,Xl=io,Yl=function(e){return no(e)||function(e){return!!ao(e)&&!0!==J(oe(e.getElementsByTagName("*")),(function(e,t){return e||Yr(t)}),!1)}(e)},Ql=co,Zl=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},es=function(e,t){if(_l(e)){if(Xl(t.previousSibling)&&!Kl(t.previousSibling))return lu.before(t);if(Kl(t))return lu(t,0)}if(Al(e)){if(Xl(t.nextSibling)&&!Kl(t.nextSibling))return lu.after(t);if(Kl(t))return lu(t,t.data.length)}return Al(e)?Gl(t)?lu.before(t):lu.after(t):lu.before(t)},ts=function(e,t,n){var r,o,i,a;if(!Jl(n)||!t)return null;if(t.isEqual(lu.after(n))&&n.lastChild){if(a=lu.after(n.lastChild),Al(e)&&Xl(n.lastChild)&&Jl(n.lastChild))return Gl(n.lastChild)?lu.before(n.lastChild):a}else a=t;var c=a.container(),u=a.offset();if(Kl(c)){if(Al(e)&&u>0)return lu(c,--u);if(_l(e)&&u<c.length)return lu(c,++u);r=c}else{if(Al(e)&&u>0&&(o=Zl(c,u-1),Xl(o)))return!Yl(o)&&(i=Rl(o,e,Ql,o))?Kl(i)?lu(i,i.data.length):lu.after(i):Kl(o)?lu(o,o.data.length):lu.before(o);if(_l(e)&&u<c.childNodes.length&&(o=Zl(c,u),Xl(o)))return Gl(o)?function(e,t){var n=t.nextSibling;return n&&Xl(n)?Kl(n)?lu(n,0):lu.before(n):ts(uu.Forwards,lu.after(t),e)}(n,o):!Yl(o)&&(i=Rl(o,e,Ql,o))?Kl(i)?lu(i,0):lu.before(i):Kl(o)?lu(o,0):lu.after(o);r=o||a.getNode()}if((_l(e)&&a.isAtEnd()||Al(e)&&a.isAtStart())&&(r=Rl(r,e,y,n,!0),Ql(r,n)))return es(e,r);o=Rl(r,e,Ql,n);var l=Te($(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(c,n),$l));return!l||o&&l.contains(o)?o?es(e,o):null:a=_l(e)?lu.after(l):lu.before(l)},ns=function(e){return{next:function(t){return ts(uu.Forwards,t,e)},prev:function(t){return ts(uu.Backwards,t,e)}}},rs=function(e){return lu.isTextPosition(e)?0===e.offset():io(e.getNode())},os=function(e){if(lu.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return io(e.getNode(!0))},is=function(e,t){return!lu.isTextPosition(e)&&!lu.isTextPosition(t)&&e.getNode()===t.getNode(!0)},as=function(e,t,n){return e?!is(t,n)&&(r=t,!(!lu.isTextPosition(r)&&En(r.getNode())))&&os(t)&&rs(n):!is(n,t)&&rs(t)&&os(n);var r},cs=function(e,t,n){var r=ns(t);return k.from(e?r.next(n):r.prev(n))},us=function(e,t,n){return cs(e,t,n).bind((function(r){return Dl(n,r,t)&&as(e,n,r)?cs(e,t,r):k.some(r)}))},ls=function(e,t,n,r){return us(e,t,n).bind((function(n){return r(n)?ls(e,t,n,r):k.some(n)}))},ss=function(e,t){var n,r=e?t.firstChild:t.lastChild;return xn(r)?k.some(lu(r,e?0:r.data.length)):r?io(r)?k.some(e?lu.before(r):En(n=r)?lu.before(n):lu.after(n)):function(e,t,n){var r=e?lu.before(n):lu.after(n);return cs(e,t,r)}(e,t,r):k.none()},fs=p(cs,!0),ds=p(cs,!1),ms=p(ss,!0),ps=p(ss,!1),gs=function(e){return pn(e)&&"_mce_caret"===e.id},hs=function(e,t){for(;t&&t!==e;){if("_mce_caret"===t.id)return t;t=t.parentNode}return null},vs=function(e,t){return pn(t)&&e.isBlock(t)&&!t.innerHTML&&!ct.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},bs=function(e,t){return ps(e).fold((function(){return!1}),(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},ys=function(e,t,n){return!(!function(e){return!1===e.hasChildNodes()}(t)||!hs(e,t))&&(function(e,t){var n=e.ownerDocument.createTextNode("\ufeff");e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)}(t,n),!0)},ws=function(e,t,n,r){var o,i,a,c,u=n[t?"start":"end"],l=e.getRoot();if(u){for(a=u[0],i=l,o=u.length-1;o>=1;o--){if(c=i.childNodes,ys(l,i,r))return!0;if(u[o]>c.length-1)return!!ys(l,i,r)||bs(i,r);i=c[u[o]]}3===i.nodeType&&(a=Math.min(u[0],i.nodeValue.length)),1===i.nodeType&&(a=Math.min(u[0],i.childNodes.length)),t?r.setStart(i,a):r.setEnd(i,a)}return!0},Cs=function(e){return xn(e)&&e.data.length>0},xs=function(e,t,n){var r,o,i,a,c,u,l=e.get(n.id+"_"+t),s=n.keep;if(l){if(r=l.parentNode,"start"===t?(s?l.hasChildNodes()?(r=l.firstChild,o=1):Cs(l.nextSibling)?(r=l.nextSibling,o=0):Cs(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)+1):o=e.nodeIndex(l),c=r,u=o):(s?l.hasChildNodes()?(r=l.firstChild,o=1):Cs(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)):o=e.nodeIndex(l),c=r,u=o),!s){for(a=l.previousSibling,i=l.nextSibling,dt.each(dt.grep(l.childNodes),(function(e){xn(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));l=e.get(n.id+"_"+t);)e.remove(l,!0);a&&i&&a.nodeType===i.nodeType&&xn(a)&&!ct.opera&&(o=a.nodeValue.length,a.appendData(i.nodeValue),e.remove(i),c=a,u=o)}return k.some(lu(c,u))}return k.none()},ks=function(e,t){var n=e.dom;if(t){if(function(e){return dt.isArray(e.start)}(t))return function(e,t){var n=e.createRng();return ws(e,!0,t,n)&&ws(e,!1,t,n)?k.some(n):k.none()}(n,t);if(function(e){return"string"==typeof e.start}(t))return k.some(function(e,t){var n,r=e.createRng();return n=wu(e.getRoot(),t.start),r.setStart(n.container(),n.offset()),n=wu(e.getRoot(),t.end),r.setEnd(n.container(),n.offset()),r}(n,t));if(function(e){return e.hasOwnProperty("id")}(t))return function(e,t){var n=xs(e,"start",t),r=xs(e,"end",t);return Oc(n,r.or(n),(function(t,n){var r=e.createRng();return r.setStart(vs(e,t.container()),t.offset()),r.setEnd(vs(e,n.container()),n.offset()),r}))}(n,t);if(function(e){return e.hasOwnProperty("name")}(t))return function(e,t){return k.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();return n.selectNode(t),n}))}(n,t);if(function(e){return e.hasOwnProperty("rng")}(t))return k.some(t.rng)}return k.none()},Ss=function(e,t,n){return Ru(e,t,n)},Ts=function(e,t){ks(e,t).each((function(t){e.setRng(t)}))},Es=function(e){return pn(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},_s=(Vl=" ",function(e){return Vl===e}),As=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},Ns=function(e){return!As(e)&&!_s(e)},Rs=function(e){return!!e.nodeType},Os=function(e,t,n){var r,o,i,a=n.startOffset,c=n.startContainer;if((n.startContainer!==n.endContainer||!function(e){return e&&/^(IMG)$/.test(e.nodeName)}(n.startContainer.childNodes[n.startOffset]))&&1===c.nodeType)for(a<(i=c.childNodes).length?(c=i[a],r=new Tr(c,e.getParent(c,e.isBlock))):(c=i[i.length-1],(r=new Tr(c,e.getParent(c,e.isBlock))).next(!0)),o=r.current();o;o=r.next())if(3===o.nodeType&&!Bs(o))return n.setStart(o,0),void t.setRng(n)},Ds=function(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(1===e.nodeType||!Bs(e))return e}},Is=function(e,t){return Rs(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},Ps=function(e,t,n){return e.schema.isValidChild(t,n)},Bs=function(e,t){if(void 0===t&&(t=!1),P(e)&&xn(e)){var n=t?e.data.replace(/ /g," "):e.data;return lo(n)}return!1},Ms=function(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},Ls=function(e,t){return t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()},Fs=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},js=function(e,t,n){return Fs(e,e.getStyle(t,n),n)},Hs=function(e,t){var n;return e.getParent(t,(function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n})),n},Us=function(e,t,n){return e.getParents(t,n,e.getRoot())},zs=function(e,t,n){var r=["inline","block","selector","attributes","styles","classes"],o=function(e){return me(e,(function(e,t){return z(r,(function(e){return e===t}))}))};return z(e.formatter.get(t),(function(t){var r=o(t);return z(e.formatter.get(n),(function(e){var t=o(e);return function(e,t,n){return void 0===n&&(n=l),u(n).eq(e,t)}(r,t)}))}))},Ws=function(e){return ve(e,"block")},qs=function(e){return ve(e,"selector")},Vs=function(e){return ve(e,"inline")},$s=Es,Ks=Us,Js=Bs,Gs=Is,Xs=function(e,t){for(var n=t;n;){if(pn(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},Ys=function(e,t,n,r){for(var o=t.data,i=n;e?i>=0:i<o.length;e?i--:i++)if(r(o.charAt(i)))return e?i+1:i;return-1},Qs=function(e,t,n){return Ys(e,t,n,(function(e){return _s(e)||As(e)}))},Zs=function(e,t,n){return Ys(e,t,n,Ns)},ef=function(e,t,n,r,o,i){var a,c=e.getParent(n,e.isBlock)||t,u=function(t,n,r){var i=Rc(e),u=o?i.backwards:i.forwards;return k.from(u(t,n,(function(e,t){return $s(e.parentNode)?-1:(a=e,r(o,e,t))}),c))};return u(n,r,Qs).bind((function(e){return i?u(e.container,e.offset+(o?-1:0),Zs):k.some(e)})).orThunk((function(){return a?k.some({container:a,offset:o?0:a.length}):k.none()}))},tf=function(e,t,n,r,o){xn(r)&&0===r.nodeValue.length&&r[o]&&(r=r[o]);for(var i=Ks(e,r),a=0;a<i.length;a++)for(var c=0;c<t.length;c++){var u=t[c];if((!("collapsed"in u)||u.collapsed===n.collapsed)&&e.is(i[a],u.selector))return i[a]}return r},nf=function(e,t,n,r){var o,i=e.dom,a=i.getRoot();if(t[0].wrapper||(o=i.getParent(n,t[0].block,a)),!o){var c=i.getParent(n,"LI,TD,TH");o=i.getParent(xn(n)?n.parentNode:n,(function(t){return t!==a&&Gs(e,t)}),c)}if(o&&t[0].wrapper&&(o=Ks(i,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!i.isBlock(o[r])&&(o=o[r],!Ls(o,"br")););return o||n},rf=function(e,t,n,r){var o=n.parentNode;return!P(n[r])&&(!(o!==t&&!I(o)&&!e.isBlock(o))||rf(e,t,o,r))},of=function(e,t,n,r,o){var i,a,c=n,u=o?"previousSibling":"nextSibling",l=e.getRoot();if(xn(n)&&!Js(n)&&(o?r>0:r<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(c))return c;for(i=c[u];i;i=i[u]){var s=xn(i)&&!rf(e,l,i,u);if(!$s(i)&&(!En(a=i)||!a.getAttribute("data-mce-bogus")||a.nextSibling)&&!Js(i,s))return c}if(c===l||c.parentNode===l){n=c;break}c=c.parentNode}return n},af=function(e){return $s(e.parentNode)||$s(e)},cf=function(e,t,n,r){void 0===r&&(r=!1);var o=t.startContainer,i=t.startOffset,a=t.endContainer,c=t.endOffset,u=e.dom;(pn(o)&&o.hasChildNodes()&&(o=Hc(o,i),xn(o)&&(i=0)),pn(a)&&a.hasChildNodes()&&(a=Hc(a,t.collapsed?c:c-1),xn(a)&&(c=a.nodeValue.length)),o=Xs(u,o),a=Xs(u,a),af(o)&&(o=$s(o)?o:o.parentNode,o=t.collapsed?o.previousSibling||o:o.nextSibling||o,xn(o)&&(i=t.collapsed?o.length:0)),af(a)&&(a=$s(a)?a:a.parentNode,a=t.collapsed?a.nextSibling||a:a.previousSibling||a,xn(a)&&(c=t.collapsed?0:a.length)),t.collapsed)&&(ef(u,e.getBody(),o,i,!0,r).each((function(e){var t=e.container,n=e.offset;o=t,i=n})),ef(u,e.getBody(),a,c,!1,r).each((function(e){var t=e.container,n=e.offset;a=t,c=n})));return(n[0].inline||n[0].block_expand)&&(n[0].inline&&xn(o)&&0!==i||(o=of(u,n,o,i,!0)),n[0].inline&&xn(a)&&c!==a.nodeValue.length||(a=of(u,n,a,c,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(o=tf(u,n,t,o,"previousSibling"),a=tf(u,n,t,a,"nextSibling")),(n[0].block||n[0].selector)&&(o=nf(e,n,o,"previousSibling"),a=nf(e,n,a,"nextSibling"),n[0].block&&(u.isBlock(o)||(o=of(u,n,o,i,!0)),u.isBlock(a)||(a=of(u,n,a,c,!1)))),pn(o)&&(i=u.nodeIndex(o),o=o.parentNode),pn(a)&&(c=u.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:i,endContainer:a,endOffset:c}},uf=function(e,t){var n=e.childNodes;return t>=n.length?t=n.length-1:t<0&&(t=0),n[t]||e},lf=function(e,t,n){var r=t.startContainer,o=t.startOffset,i=t.endContainer,a=t.endOffset,c=function(e){var t;return 3===(t=e[0]).nodeType&&t===r&&o>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===a&&e.length>0&&t===i&&3===t.nodeType&&e.splice(e.length-1,1),e},u=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},l=function(e,t){do{if(e.parentNode===t)return e;e=e.parentNode}while(e)},s=function(e,t,r){for(var o=r?"nextSibling":"previousSibling",i=e,a=i.parentNode;i&&i!==t;i=a){a=i.parentNode;var l=u(i===e?i:i[o],o);l.length&&(r||l.reverse(),n(c(l)))}};if(1===r.nodeType&&r.hasChildNodes()&&(r=uf(r,o)),1===i.nodeType&&i.hasChildNodes()&&(i=uf(i,a-1)),r===i)return n(c([r]));for(var f=e.findCommonAncestor(r,i),d=r;d;d=d.parentNode){if(d===i)return s(r,f,!0);if(d===f)break}for(d=i;d;d=d.parentNode){if(d===r)return s(i,f);if(d===f)break}var m=l(r,f)||r,p=l(i,f)||i;s(r,m,!0);var g=u(m===r?m:m.nextSibling,"nextSibling",p===i?p.nextSibling:p);g.length&&n(c(g)),s(i,p)},sf=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},ff=function(e){return $(function(e){return Y(e,(function(e){var t=jc(e);return t?[pt.fromDom(t)]:[]}))}(e),Br)},df=function(e,t){var n=gc(t,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:ff(e)},mf=function(e){return df(sf(e.selection.getSel()),pt.fromDom(e.getBody()))},pf=function(e){return Ft(e).fold(d([e]),(function(t){return[e].concat(pf(t))}))},gf=function(e){return jt(e).fold(d([e]),(function(t){return"br"===Ct(t)?Dt(t).map((function(t){return[e].concat(gf(t))})).getOr([]):[e].concat(gf(t))}))},hf=function(e,t){return Oc(function(e){var t=e.startContainer,n=e.startOffset;return xn(t)?0===n?k.some(pt.fromDom(t)):k.none():k.from(t.childNodes[n]).map(pt.fromDom)}(t),function(e){var t=e.endContainer,n=e.endOffset;return xn(t)?n===t.data.length?k.some(pt.fromDom(t)):k.none():k.from(t.childNodes[n-1]).map(pt.fromDom)}(t),(function(t,n){var r=G(pf(e),p(bt,t)),o=G(gf(e),p(bt,n));return r.isSome()&&o.isSome()})).getOr(!1)},vf=function(e,t,n,r){var o=n,i=new Tr(n,o),a=me(e.schema.getMoveCaretBeforeOnEnterElements(),(function(e,t){return!U(["td","th","table"],t.toLowerCase())}));do{if(xn(n)&&0!==dt.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=r?i.next():i.prev());"BODY"===o.nodeName&&(r?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},bf=function(e){var t=e.selection.getSel();return t&&t.rangeCount>0},yf=function(e,t){var n=mf(e);n.length>0?q(n,(function(n){var r=n.dom,o=e.dom.createRng();o.setStartBefore(r),o.setEndAfter(r),t(o,!0)})):t(e.selection.getRng(),!1)},wf=function(e,t,n){var r=Nu(e,t);n(r),e.moveToBookmark(r)};var Cf=function(e,t){var n=function(t){return e(t)?k.from(t.dom.nodeValue):k.none()};return{get:function(r){if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}}(Tt,"text"),xf=function(e){return Cf.get(e)},kf=function(e,t,n,r){return Ot(t).fold((function(){return"skipping"}),(function(o){return"br"===r||function(e){return Tt(e)&&"\ufeff"===xf(e)}(t)?"valid":function(e){return St(e)&&mc(e,hc())}(t)?"existing":gs(t.dom)?"caret":Ps(e,n,r)&&Ps(e,Ct(o),n)?"valid":"invalid-child"}))},Sf=function(e,t,n,r){var o=t.uid,i=void 0===o?Sc("mce-annotation"):o,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["uid"]),c=pt.fromTag("span",e);fc(c,hc()),Pn(c,""+bc(),i),Pn(c,""+vc(),n);var u=r(i,a),l=u.attributes,s=void 0===l?{}:l,f=u.classes,d=void 0===f?[]:f;return Bn(c,s),function(e,t){q(t,(function(t){fc(e,t)}))}(c,d),c},Tf=function(e,t,n,r,o){var i=[],a=Sf(e.getDoc(),o,n,r),c=Qa(k.none()),u=function(){c.set(k.none())},l=function(e){q(e,s)},s=function(t){switch(kf(e,t,"span",Ct(t))){case"invalid-child":u();var n=Mt(t);l(n),u();break;case"valid":!function(e,t){Kt(e,t),Xt(t,e)}(t,c.get().getOrThunk((function(){var e=_c(a);return i.push(e),c.set(k.some(e)),e})))}};return lf(e.dom,t,(function(e){u(),function(e){var t=W(e,pt.fromDom);l(t)}(e)})),i},Ef=function(e,t,n,r){e.undoManager.transact((function(){var o=e.selection,i=o.getRng(),a=mf(e).length>0;if(i.collapsed&&!a&&function(e,t){var n=cf(e,t,[{inline:!0}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)}(e,i),o.getRng().collapsed&&!a){var c=Sf(e.getDoc(),r,t,n.decorate);Tc(c," "),o.getRng().insertNode(c.dom),o.select(c.dom)}else wf(o,!1,(function(){yf(e,(function(o){Tf(e,o,t,n.decorate,r)}))}))}))},_f=function(e){var t,n=(t={},{register:function(e,n){t[e]={name:e,settings:n}},lookup:function(e){return t.hasOwnProperty(e)?k.from(t[e]).map((function(e){return e.settings})):k.none()}});xc(e,n);var r=Cc(e);return{register:function(e,t){n.register(e,t)},annotate:function(t,r){n.lookup(t).each((function(n){Ef(e,t,n,r)}))},annotationChanged:function(e,t){r.addListener(e,t)},remove:function(t){yc(e,k.some(t)).each((function(e){var t=e.elements;q(t,en)}))},getAll:function(t){var n=function(e,t){var n=pt.fromDom(e.getBody()),r=gc(n,"["+vc()+'="'+t+'"]'),o={};return q(r,(function(e){var t=Mn(e,bc()),n=o.hasOwnProperty(t)?o[t]:[];o[t]=n.concat([e])})),o}(e,t);return ue(n,(function(e){return W(e,(function(e){return e.dom}))}))}}};function Af(e){return{getBookmark:p(Ss,e),moveToBookmark:p(Ts,e)}}!function(e){e.isBookmarkNode=Es}(Af||(Af={}));var Nf=Af,Rf=function(e,t){for(;t&&t!==e;){if(An(t)||Nn(t))return t;t=t.parentNode}return null},Of=function(e,t,n){if(n.collapsed)return!1;if(ct.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var r=n.startContainer.childNodes[n.startOffset];if(pn(r))return z(r.getClientRects(),(function(n){return Fc(n,e,t)}))}return z(n.getClientRects(),(function(n){return Fc(n,e,t)}))},Df={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return ct.mac?e.metaKey:e.ctrlKey&&!e.altKey}},If=Nn,Pf=function(e,t){var n,r,o,i,a,c,u,l,s,f,d,m,p,g,h=t.dom,v=dt.each,b=t.getDoc(),y=document,w=Math.abs,C=Math.round,x=t.getBody(),k={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},S=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},T=function(e){var n=e.target;(function(e,t){if("longpress"===e.type||0===e.type.indexOf("touch")){var n=e.touches[0];return S(e.target)&&!Of(n.clientX,n.clientY,t)}return S(e.target)&&!Of(e.clientX,e.clientY,t)})(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},E=function(e){return t.dom.is(e,"figure.image")?e.querySelector("img"):e},_=function(e){var n=Ju(t);return!!n&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&ht(pt.fromDom(e),n)))},A=function(e,t,n){h.setStyles(E(e),{width:t,height:n})},N=function(e){var v,b,y,k;v=e.screenX-a,b=e.screenY-c,d=v*i[2]+u,m=b*i[3]+l,d=d<5?5:d,m=m<5?5:m,(S(n)&&!1!==function(e){return e.getParam("resize_img_proportional",!0,"boolean")}(t)?!Df.modifierPressed(e):Df.modifierPressed(e))&&(w(v)>w(b)?(m=C(d*s),d=C(m/s)):(d=C(m/s),m=C(d*s))),A(r,d,m),y=(y=i.startPos.x+v)>0?y:0,k=(k=i.startPos.y+b)>0?k:0,h.setStyles(o,{left:y,top:k,display:"block"}),o.innerHTML=d+" &times; "+m,i[2]<0&&r.clientWidth<=d&&h.setStyle(r,"left",void 0+(u-d)),i[3]<0&&r.clientHeight<=m&&h.setStyle(r,"top",void 0+(l-m)),(v=x.scrollWidth-p)+(b=x.scrollHeight-g)!==0&&h.setStyles(o,{left:y-v,top:k-b}),f||(!function(e,t,n,r,o){e.fire("ObjectResizeStart",{target:t,width:n,height:r,origin:o})}(t,n,u,l,"corner-"+i.name),f=!0)},R=function(){var e=f;f=!1;var a=function(e,r){r&&(n.style[e]||!t.schema.isValid(n.nodeName.toLowerCase(),e)?h.setStyle(E(n),e,r):h.setAttrib(E(n),e,""+r))};e&&(a("width",d),a("height",m)),h.unbind(b,"mousemove",N),h.unbind(b,"mouseup",R),y!==b&&(h.unbind(y,"mousemove",N),h.unbind(y,"mouseup",R)),h.remove(r),h.remove(o),O(n),e&&(!function(e,t,n,r,o){e.fire("ObjectResized",{target:t,width:n,height:r,origin:o})}(t,n,d,m,"corner-"+i.name),h.setAttrib(n,"style",h.getAttrib(n,"style"))),t.nodeChanged()},O=function(e){D(),B();var f=h.getPos(e,x),w=f.x,C=f.y,S=e.getBoundingClientRect(),T=S.width||S.right-S.left,O=S.height||S.bottom-S.top;n!==e&&(n=e,d=m=0);var I=t.fire("ObjectSelected",{target:e});_(e)&&!I.isDefaultPrevented()?v(k,(function(e,t){var f;(f=h.get("mceResizeHandle"+t))&&h.remove(f),f=h.add(x,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===ct.ie&&(f.contentEditable=!1),h.bind(f,"mousedown",(function(f){f.stopImmediatePropagation(),f.preventDefault(),function(f){a=f.screenX,c=f.screenY,u=E(n).clientWidth,l=E(n).clientHeight,s=l/u,(i=e).name=t,i.startPos={x:T*e[0]+w,y:O*e[1]+C},p=x.scrollWidth,g=x.scrollHeight,r=n.cloneNode(!0),h.addClass(r,"mce-clonedresizable"),h.setAttrib(r,"data-mce-bogus","all"),r.contentEditable=!1,r.unSelectabe=!0,h.setStyles(r,{left:w,top:C,margin:0}),A(r,T,O),r.removeAttribute("data-mce-selected"),x.appendChild(r),h.bind(b,"mousemove",N),h.bind(b,"mouseup",R),y!==b&&(h.bind(y,"mousemove",N),h.bind(y,"mouseup",R)),o=h.add(x,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},u+" &times; "+l)}(f)})),e.elm=f,h.setStyles(f,{left:T*e[0]+w-f.offsetWidth/2,top:O*e[1]+C-f.offsetHeight/2})})):D(),n.setAttribute("data-mce-selected","1")},D=function(){B(),n&&n.removeAttribute("data-mce-selected"),ce(k,(function(e,t){var n=h.get("mceResizeHandle"+t);n&&(h.unbind(n),h.remove(n))}))},I=function(n){var r,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};f||t.removed||(v(h.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute("data-mce-selected")})),r="mousedown"===n.type?n.target:e.getNode(),o(r=h.$(r).closest("table,img,figure.image,hr")[0],x)&&(M(),o(e.getStart(!0),r)&&o(e.getEnd(!0),r))?O(r):D())},P=function(e){return If(Rf(t.getBody(),e))},B=function(){ce(k,(function(e){e.elm&&(h.unbind(e.elm),delete e.elm)}))},M=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};t.on("init",(function(){if(M(),ct.browser.isIE()||ct.browser.isEdge()){t.on("mousedown click",(function(e){var n=e.target,r=n.nodeName;f||!/^(TABLE|IMG|HR)$/.test(r)||P(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())}));var e=function(e){var n=function(e){wr.setEditorTimeout(t,(function(){return t.selection.select(e)}))};if(P(e.target)||On(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))};h.bind(x,"mscontrolselect",e),t.on("remove",(function(){return h.unbind(x,"mscontrolselect",e)}))}var r=wr.throttle((function(e){t.composing||I(e)}));t.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",r),t.on("keyup compositionend",(function(e){n&&"TABLE"===n.nodeName&&r(e)})),t.on("hide blur",D),t.on("contextmenu longpress",T,!0)})),t.on("remove",B);return{isResizable:_,showResizeRect:O,hideResizeRect:D,updateResizeRect:I,destroy:function(){n=r=null}}},Bf=function(e){return An(e)||Nn(e)},Mf=function(e,t,n){var r,o,i=n;if(i.caretPositionFromPoint)(o=i.caretPositionFromPoint(e,t))&&((r=n.createRange()).setStart(o.offsetNode,o.offset),r.collapse(!0));else if(n.caretRangeFromPoint)r=n.caretRangeFromPoint(e,t);else if(i.body.createTextRange){r=i.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(o){r=function(e,t,n){var r,o=n.elementFromPoint(e,t),i=n.body.createTextRange();if(o&&"HTML"!==o.tagName||(o=n.body),i.moveToElementText(o),(r=(r=dt.toArray(i.getClientRects())).sort((function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-(n=Math.abs(Math.max(n.top-t,n.bottom-t)))}))).length>0){t=(r[0].bottom+r[0].top)/2;try{return i.moveToPoint(e,t),i.collapse(!0),i}catch(e){}}return null}(e,t,n)}return function(e,t){var n=e&&e.parentElement?e.parentElement():null;return Nn(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(n,t,Bf))?null:e}(r,n.body)}return r},Lf=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},Ff=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},jf=function(e,t,n){return Ff(e,t,(function(e){return e.nodeName===n}))},Hf=function(e){return e&&"TABLE"===e.nodeName},Uf=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},zf=function(e,t){return Wr(e)&&!1===Ff(e,t,gs)},Wf=function(e,t,n){for(var r=new Tr(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(En(t))return!0},qf=function(e,t,n,r,o){var i,a,c=e.getRoot(),u=e.schema.getNonEmptyElements(),l=e.getParent(o.parentNode,e.isBlock)||c;if(r&&En(o)&&t&&e.isEmpty(l))return k.some(cu(o.parentNode,e.nodeIndex(o)));for(var s=new Tr(o,l);a=s[r?"prev":"next"]();){if("false"===e.getContentEditableParent(a)||zf(a,c))return k.none();if(xn(a)&&a.nodeValue.length>0)return!1===jf(a,c,"A")?k.some(cu(a,r?a.nodeValue.length:0)):k.none();if(e.isBlock(a)||u[a.nodeName.toLowerCase()])return k.none();i=a}return n&&i?k.some(cu(i,0)):k.none()},Vf=function(e,t,n,r){var o,i,a,c,u=e.getRoot(),l=!1;o=r[(n?"start":"end")+"Container"],i=r[(n?"start":"end")+"Offset"];var s=pn(o)&&i===o.childNodes.length,f=e.schema.getNonEmptyElements();if(c=n,Wr(o))return k.none();if(pn(o)&&i>o.childNodes.length-1&&(c=!1),Sn(o)&&(o=u,i=0),o===u){if(c&&(a=o.childNodes[i>0?i-1:0])){if(Wr(a))return k.none();if(f[a.nodeName]||Hf(a))return k.none()}if(o.hasChildNodes()){if(i=Math.min(!c&&i>0?i-1:i,o.childNodes.length-1),o=o.childNodes[i],i=xn(o)&&s?o.data.length:0,!t&&o===u.lastChild&&Hf(o))return k.none();if(function(e,t){for(;t&&t!==e;){if(Nn(t))return!0;t=t.parentNode}return!1}(u,o)||Wr(o))return k.none();if(o.hasChildNodes()&&!1===Hf(o)){a=o;var d=new Tr(o,u);do{if(Nn(a)||Wr(a)){l=!1;break}if(xn(a)&&a.nodeValue.length>0){i=c?0:a.nodeValue.length,o=a,l=!0;break}if(f[a.nodeName.toLowerCase()]&&!Uf(a)){i=e.nodeIndex(a),o=a.parentNode,c||i++,l=!0;break}}while(a=c?d.next():d.prev())}}}return t&&(xn(o)&&0===i&&qf(e,s,t,!0,o).each((function(e){o=e.container(),i=e.offset(),l=!0})),pn(o)&&((a=o.childNodes[i])||(a=o.childNodes[i-1]),!a||!En(a)||function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t}(a,"A")||Wf(e,a,!1)||Wf(e,a,!0)||qf(e,s,t,!0,a).each((function(e){o=e.container(),i=e.offset(),l=!0})))),c&&!t&&xn(o)&&i===o.nodeValue.length&&qf(e,s,t,!1,o).each((function(e){o=e.container(),i=e.offset(),l=!0})),l?k.some(cu(o,i)):k.none()},$f=function(e,t){var n=t.collapsed,r=t.cloneRange(),o=cu.fromRangeStart(t);return Vf(e,n,!0,r).each((function(e){n&&cu.isAbove(o,e)||r.setStart(e.container(),e.offset())})),n||Vf(e,n,!1,r).each((function(e){r.setEnd(e.container(),e.offset())})),n&&r.collapse(!0),Lf(t,r)?k.none():k.some(r)},Kf=function(e,t){return e.splitText(t)},Jf=function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset;return t===r&&xn(t)?n>0&&n<t.nodeValue.length&&(t=(r=Kf(t,n)).previousSibling,o>n?(t=r=Kf(r,o-=n).previousSibling,o=r.nodeValue.length,n=0):o=0):(xn(t)&&n>0&&n<t.nodeValue.length&&(t=Kf(t,n),n=0),xn(r)&&o>0&&o<r.nodeValue.length&&(o=(r=Kf(r,o).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:o}};function Gf(e){return{walk:function(t,n){return lf(e,t,n)},split:Jf,normalize:function(t){return $f(e,t).fold(b,(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))}}}!function(e){e.compareRanges=Lf,e.getCaretRangeFromPoint=Mf,e.getSelectedNode=jc,e.getNode=Hc}(Gf||(Gf={}));var Xf=Gf;var Yf,Qf=function(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Hn(n,e);return parseFloat(o)||0}return r},r=function(e,t){return J(t,(function(t,n){var r=Hn(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!M(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var r=t.dom;Dn(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}("height",(function(e){var t=e.dom;return tn(e)?t.getBoundingClientRect().height:t.offsetHeight})),Zf=function(e,t){return e.view(t).fold(d([]),(function(t){var n=e.owner(t),r=Zf(e,n);return[t].concat(r)}))},ed=Object.freeze({__proto__:null,view:function(e){var t;return(e.dom===document?k.none():k.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(pt.fromDom)},owner:function(e){return Nt(e)}}),td=function(e){var t=pt.fromDom(document),n=cn(t),r=function(e,t){var n=t.owner(e);return Zf(t,n)}(e,ed),o=an(e),i=K(r,(function(e,t){var n=an(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return rn(i.left+o.left+n.left,i.top+o.top+n.top)},nd=function(e){return"textarea"===Ct(e)},rd=function(e,t){var n=function(e){var t=e.dom.ownerDocument,n=t.body,r=t.defaultView,o=t.documentElement;if(n===e.dom)return rn(n.offsetLeft,n.offsetTop);var i=on(null==r?void 0:r.pageYOffset,o.scrollTop),a=on(null==r?void 0:r.pageXOffset,o.scrollLeft),c=on(o.clientTop,n.clientTop),u=on(o.clientLeft,n.clientLeft);return an(e).translate(a-u,i-c)}(e),r=function(e){return Qf.get(e)}(e);return{element:e,bottom:n.top+r,height:r,pos:n,cleanup:t}},od=function(e,t){var n=function(e,t){var n=Mt(e);if(0===n.length||nd(e))return{element:e,offset:t};if(t<n.length&&!nd(n[t]))return{element:n[t],offset:0};var r=n[n.length-1];return nd(r)?{element:e,offset:t}:"img"===Ct(r)?{element:r,offset:1}:Tt(r)?{element:r,offset:xf(r).length}:{element:r,offset:Mt(r).length}}(e,t),r=pt.fromHtml('<span data-mce-bogus="all">\ufeff</span>');return Kt(n.element,r),rd(r,(function(){return Zt(r)}))},id=function(e,t,n,r){ld(e,(function(o,i){return cd(e,t,n,r)}),n)},ad=function(e,t,n,r,o){var i={elm:r.element.dom,alignToTop:o};(function(e,t){return e.fire("ScrollIntoView",t).isDefaultPrevented()})(e,i)||(n(t,cn(t).top,r,o),function(e,t){e.fire("AfterScrollIntoView",t)}(e,i))},cd=function(e,t,n,r){var o=pt.fromDom(e.getBody()),i=pt.fromDom(e.getDoc());o.dom.offsetWidth;var a=od(pt.fromDom(n.startContainer),n.startOffset);ad(e,i,t,a,r),a.cleanup()},ud=function(e,t,n,r){var o=pt.fromDom(e.getDoc());ad(e,o,n,function(e){return rd(pt.fromDom(e),s)}(t),r)},ld=function(e,t,n){var r=n.startContainer,o=n.startOffset,i=n.endContainer,a=n.endOffset;t(pt.fromDom(r),pt.fromDom(i));var c=e.dom.createRng();c.setStart(r,o),c.setEnd(i,a),e.selection.setRng(n)},sd=function(e,t,n,r){var o=e.pos;if(n)un(o.left,o.top,r);else{var i=o.top-t+e.height;un(o.left,i,r)}},fd=function(e,t,n,r,o){var i=n+t,a=r.pos.top,c=r.bottom,u=c-a>=n;if(a<t)sd(r,n,!1!==o,e);else if(a>i){sd(r,n,u?!1!==o:!0===o,e)}else c>i&&!u&&sd(r,n,!0===o,e)},dd=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;fd(e,t,o,n,r)},md=function(e,t,n,r){var o=e.dom.defaultView.innerHeight;fd(e,t,o,n,r);var i=td(n.element),a=fn(window);i.top<a.y?ln(n.element,!1!==r):i.top>a.bottom&&ln(n.element,!0===r)},pd=function(e,t,n){return id(e,dd,t,n)},gd=function(e,t,n){return ud(e,t,dd,n)},hd=function(e,t,n){return id(e,md,t,n)},vd=function(e,t,n){return ud(e,t,md,n)},bd=function(e,t,n){(e.inline?pd:hd)(e,t,n)},yd=function(e){var t=Wt(e).dom;return e.dom===t.activeElement},wd=function(e){return void 0===e&&(e=pt.fromDom(document)),k.from(e.dom.activeElement).map(pt.fromDom)},Cd=function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}},xd=ar([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),kd=(xd.before,xd.on,xd.after,function(e){return e.fold(m,m,m)}),Sd=ar([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Td={domRange:Sd.domRange,relative:Sd.relative,exact:Sd.exact,exactFromRange:function(e){return Sd.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var t=function(e){return e.match({domRange:function(e){return pt.fromDom(e.startContainer)},relative:function(e,t){return kd(e)},exact:function(e,t,n,r){return e}})}(e);return Rt(t)},range:Cd},Ed=Qe().browser,_d=function(e,t){var n=Tt(t)?xf(t).length:Mt(t).length+1;return e>n?n:e<0?0:e},Ad=function(e){return Td.range(e.start,_d(e.soffset,e.start),e.finish,_d(e.foffset,e.finish))},Nd=function(e,t){return!mn(t.dom)&&(wt(e,t)||bt(e,t))},Rd=function(e){return function(t){return Nd(e,t.start)&&Nd(e,t.finish)}},Od=function(e){return!0===e.inline||Ed.isIE()},Dd=function(e){return Td.range(pt.fromDom(e.startContainer),e.startOffset,pt.fromDom(e.endContainer),e.endOffset)},Id=function(e){return function(e){var t=e.getSelection();return(t&&0!==t.rangeCount?k.from(t.getRangeAt(0)):k.none()).map(Dd)}(Rt(e).dom).filter(Rd(e))},Pd=function(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),k.some(t)}catch(e){return k.none()}},Bd=function(e){var t=Od(e)?Id(pt.fromDom(e.getBody())):k.none();e.bookmark=t.isSome()?t:e.bookmark},Md=function(e){return(e.bookmark?e.bookmark:k.none()).bind((function(t){return function(e,t){return k.from(t).filter(Rd(e)).map(Ad)}(pt.fromDom(e.getBody()),t)})).bind(Pd)},Ld={isEditorUIElement:function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Fd=function(e,t){Qe().browser.isIE()?function(e){e.on("focusout",(function(){Bd(e)}))}(e):function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))}(e,t),e.on("keyup NodeChange",(function(t){(function(e){return"nodechange"===e.type&&e.selectionChange})(t)||Bd(e)}))},jd=function(e){var t=ic((function(){Bd(e)}),0);e.on("init",(function(){e.inline&&function(e,t){var n=function(){t.throttle()};Ka.DOM.bind(document,"mouseup",n),e.on("remove",(function(){Ka.DOM.unbind(document,"mouseup",n)}))}(e,t),Fd(e,t)})),e.on("remove",(function(){t.cancel()}))},Hd=Ka.DOM,Ud=function(e,t){var n=function(e){return e.getParam("custom_ui_selector","","string")}(e);return null!==Hd.getParent(t,(function(t){return function(e){return Ld.isEditorUIElement(e)}(t)||!!n&&e.dom.is(t,n)}))},zd=function(e,t){var n=t.editor;jd(n),n.on("focusin",(function(){var t=e.focusedEditor;t!==this&&(t&&t.fire("blur",{focusedEditor:this}),e.setActive(this),e.focusedEditor=this,this.fire("focus",{blurredEditor:t}),this.focus(!0))})),n.on("focusout",(function(){var t=this;wr.setEditorTimeout(t,(function(){var n=e.focusedEditor;Ud(t,function(e){try{var t=Wt(pt.fromDom(e.getElement()));return wd(t).fold((function(){return document.body}),(function(e){return e.dom}))}catch(e){return document.body}}(t))||n!==t||(t.fire("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),Yf||(Yf=function(t){var n=e.activeEditor;n&&function(e){if(zt()&&P(e.target)){var t=pt.fromDom(e.target);if(St(t)&&$t(t)&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ne(n)}}return k.from(e.target)}(t).each((function(t){t.ownerDocument===document&&(t===document.body||Ud(n,t)||e.focusedEditor!==n||(n.fire("blur",{focusedEditor:null}),e.focusedEditor=null))}))},Hd.bind(document,"focusin",Yf))},Wd=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Hd.unbind(document,"focusin",Yf),Yf=null)},qd=function(e,t){return function(e){return e.collapsed?k.from(Hc(e.startContainer,e.startOffset)).map(pt.fromDom):k.none()}(t).bind((function(t){return Pr(t)?k.some(t):!1===wt(e,t)?k.some(e):k.none()}))},Vd=function(e,t){qd(pt.fromDom(e.getBody()),t).bind((function(e){return ms(e.dom)})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},$d=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},Kd=function(e){return yd(e)||(t=e,wd(Wt(t)).filter((function(e){return t.dom.contains(e.dom)}))).isSome();var t},Jd=function(e){return e.inline?function(e){var t=e.getBody();return t&&Kd(pt.fromDom(t))}(e):function(e){return e.iframeElement&&yd(pt.fromDom(e.iframeElement))}(e)},Gd=function(e){return Jd(e)||function(e){return wd().filter((function(t){return n=t.dom,!(void 0!==(r=n.classList)&&(r.contains("tox-edit-area")||r.contains("tox-edit-area__iframe")||r.contains("mce-content-body")))&&Ud(e,t.dom);var n,r})).isSome()}(e)},Xd=function(e){return e.editorManager.setActive(e)},Yd=function(e,t){e.removed||(t?Xd(e):function(e){var t=e.selection,n=e.getBody(),r=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===Jd(e)&&Md(e).each((function(t){e.selection.setRng(t),r=t}));var o=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))}(e,t.getNode());if(e.$.contains(n,o))return $d(o),Vd(e,r),void Xd(e);e.inline||(ct.opera||$d(n),e.getWin().focus()),(ct.gecko||e.inline)&&($d(n),Vd(e,r)),Xd(e)}(e))},Qd=function(e,t,n,r,o){var i=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return k.from(i).map(pt.fromDom).map((function(e){return r&&t.collapsed?e:Lt(e,o(e,a)).getOr(e)})).bind((function(e){return St(e)?k.some(e):Ot(e).filter(St)})).map((function(e){return e.dom})).getOr(e)},Zd=function(e,t,n){return Qd(e,t,!0,n,(function(e,t){return Math.min(e.dom.childNodes.length,t)}))},em=function(e,t,n){return Qd(e,t,!1,n,(function(e,t){return t>0?t-1:t}))},tm=function(e,t){for(var n=e;e&&xn(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},nm=function(e,t){return W(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},rm=function(e){return B(e)?e:b},om=function(e,t,n){var r=t(e),o=rm(n);return r.orThunk((function(){return o(e)?k.none():function(e,t,n){for(var r=e.dom,o=rm(n);r.parentNode;){r=r.parentNode;var i=pt.fromDom(r),a=t(i);if(a.isSome())return a;if(o(i))break}return k.none()}(e,t,o)}))},im=Ls,am=function(e,t,n){var r=e.formatter.get(n);if(r)for(var o=0;o<r.length;o++)if(!1===r[o].inherit&&e.dom.is(t,r[o].selector))return!0;return!1},cm=function(e,t,n,r){var o=e.dom.getRoot();return t!==o&&(t=e.dom.getParent(t,(function(t){return!!am(e,t,n)||(t.parentNode===o||!!sm(e,t,n,r,!0))})),sm(e,t,n,r))},um=function(e,t,n){return!!im(t,n.inline)||(!!im(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0))},lm=function(e,t,n,r,o,i){var a,c,u,l=n[r];if(n.onmatch)return n.onmatch(t,n,r);if(l)if(void 0===l.length){for(a in l)if(l.hasOwnProperty(a)){if(c="attributes"===r?e.getAttrib(t,a):js(e,t,a),o&&!c&&!n.exact)return;if((!o||n.exact)&&!im(c,Fs(e,Ms(l[a],i),a)))return}}else for(u=0;u<l.length;u++)if("attributes"===r?e.getAttrib(t,l[u]):js(e,t,l[u]))return n;return n},sm=function(e,t,n,r,o){var i,a,c,u,l=e.formatter.get(n),s=e.dom;if(l&&t)for(a=0;a<l.length;a++)if(i=l[a],um(e.dom,t,i)&&lm(s,t,i,"attributes",o,r)&&lm(s,t,i,"styles",o,r)){if(u=i.classes)for(c=0;c<u.length;c++)if(!e.dom.hasClass(t,u[c]))return;return i}},fm=function(e,t,n,r){if(r)return cm(e,r,t,n);if(r=e.selection.getNode(),cm(e,r,t,n))return!0;var o=e.selection.getStart();return!(o===r||!cm(e,o,t,n))},dm=function(e,t){var n=function(t){return bt(t,pt.fromDom(e.getBody()))};return k.from(e.selection.getStart(!0)).bind((function(r){return om(pt.fromDom(r),(function(n){return function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return k.none()}(t,(function(t){return function(t,n){return sm(e,t.dom,n)?k.some(n):k.none()}(n,t)}))}),n)})).getOrNull()},mm=function(e,t,n){return J(n,(function(n,r){var o=function(e,t){return z(e.formatter.get(t),(function(e){var t=function(e){return e.length>1&&"%"===e.charAt(0)};return z(["styles","attributes"],(function(n){return ge(e,n).exists((function(e){var n=N(e)?e:pe(e);return z(n,t)}))}))}))}(e,r);return e.formatter.matchNode(t,r,{},o)?n.concat([r]):n}),[])},pm={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},gm=function(e,t,n){var r=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[r])return e[r];if(e!==t){var i=e[o];if(i)return i;for(var a=e.parent;a&&a!==t;a=a.parent)if(i=a[o])return i}},hm=function(e){if(!lo(e.value))return!1;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},vm=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},bm=function(){function e(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}return e.create=function(t,n){var r=new e(t,pm[t]||1);return n&&ce(n,(function(e,t){r.attr(t,e)})),r},e.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},e.prototype.attr=function(e,t){var n,r=this;if("string"!=typeof e)return null!=e&&ce(e,(function(e,t){r.attr(t,e)})),r;if(n=r.attributes){if(void 0!==t){if(null===t){if(e in n.map){delete n.map[e];for(var o=n.length;o--;)if(n[o].name===e)return n.splice(o,1),r}return r}if(e in n.map){for(o=n.length;o--;)if(n[o].name===e){n[o].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,r}return n.map[e]}},e.prototype.clone=function(){var t,n=new e(this.name,this.type);if(t=this.attributes){var r=[];r.map={};for(var o=0,i=t.length;o<i;o++){var a=t[o];"id"!==a.name&&(r[r.length]={name:a.name,value:a.value},r.map[a.name]=a.value)}n.attributes=r}return n.value=this.value,n.shortEnded=this.shortEnded,n},e.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},e.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},e.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):n.next=t,e.lastChild===this?(e.lastChild=n,n&&(n.next=null)):t.prev=n,this.parent=this.next=this.prev=null),this},e.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},e.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},e.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=gm(n,this))n.name===e&&t.push(n);return t},e.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=gm(t,this))e.push(t);for(var n=e.length;n--;){(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}}return this.firstChild=this.lastChild=null,this},e.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this.firstChild;if(vm(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(vm(r))return!1}if(8===r.type)return!1;if(3===r.type&&!hm(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&lo(r.value))return!1;if(n&&n(r))return!1}while(r=gm(r,this));return!0},e.prototype.walk=function(e){return gm(this,null,e)},e}(),ym=dt.makeMap,wm=function(e){var t=[],n=(e=e||{}).indent,r=ym(e.indent_before||""),o=ym(e.indent_after||""),i=Po.getEncodeFunc(e.entity_encoding||"raw",e.entities),a="html"===e.element_format;return{start:function(e,c,u){var l,s,f,d;if(n&&r[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n"),t.push("<",e),c)for(l=0,s=c.length;l<s;l++)f=c[l],t.push(" ",f.name,'="',i(f.value,!0),'"');t[t.length]=!u||a?">":" />",u&&n&&o[e]&&t.length>0&&(d=t[t.length-1]).length>0&&"\n"!==d&&t.push("\n")},end:function(e){var r;t.push("</",e,">"),n&&o[e]&&t.length>0&&(r=t[t.length-1]).length>0&&"\n"!==r&&t.push("\n")},text:function(e,n){e.length>0&&(t[t.length]=n?e:i(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,r){r?t.push("<?",e," ",i(r),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},Cm=function(e,t){void 0===t&&(t=qo());var n=wm(e);(e=e||{}).validate=!("validate"in e)||e.validate;return{serialize:function(r){var o=e.validate,i={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{a(e)}while(e=e.next)}};n.reset();var a=function(e){var r,c,u,l,s,f,d,m,p,g=i[e.type];if(g)g(e);else{if(r=e.name,c=e.shortEnded,u=e.attributes,o&&u&&u.length>1&&((f=[]).map={},p=t.getElementRule(e.name))){for(d=0,m=p.attributesOrder.length;d<m;d++)(l=p.attributesOrder[d])in u.map&&(s=u.map[l],f.map[l]=s,f.push({name:l,value:s}));for(d=0,m=u.length;d<m;d++)(l=u[d].name)in f.map||(s=u.map[l],f.map[l]=s,f.push({name:l,value:s}));u=f}if(n.start(e.name,u,c),!c){if(e=e.firstChild)do{a(e)}while(e=e.next);n.end(r)}}};return 1!==r.type||e.inner?i[11](r):a(r),n.getContent()}}},xm=function(e,t){return e.replace(new RegExp(t.prefix+"_[0-9]+","g"),(function(e){return ge(t.uris,e).getOr(e)}))},km=["img","video"],Sm=function(e,t,n){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?function(e,t){return!(I(e)?U(km,t):e)}(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))},Tm=function(e,t,n){var r,o,i=1,a=e.getShortEndedElements(),c=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;for(c.lastIndex=r=n;o=c.exec(t);){if(r=c.lastIndex,"/"===o[1])i--;else if(!o[1]){if(o[2]in a)continue;i++}if(0===i)break}return r},Em=function(e,t){var n=e.exec(t);if(n){var r=n[1],o=n[2];return"string"==typeof r&&"data-mce-bogus"===r.toLowerCase()?o:null}return null};function _m(e,t){void 0===t&&(t=qo());var n=function(){};!1!==(e=e||{}).fix_self_closing&&(e.fix_self_closing=!0);var r=e.comment?e.comment:n,o=e.cdata?e.cdata:n,i=e.text?e.text:n,a=e.start?e.start:n,c=e.end?e.end:n,u=e.pi?e.pi:n,l=e.doctype?e.doctype:n,s=function(n,s){void 0===s&&(s="html");for(var f,d,m,p,g,h,v,b,y,w,C,x,k,S,T,E,_,A,N,R=n.html,O=0,D=[],I=0,P=Po.decode,B=dt.makeMap("src,href,data,background,formaction,poster,xlink:href"),M=/((java|vb)script|mhtml):/i,L="html"===s?0:1,F=function(e){var t,n;for(t=D.length;t--&&D[t].name!==e;);if(t>=0){for(n=D.length-1;n>=t;n--)(e=D[n]).valid&&c(e.name);D.length=t}},j=function(e,t){return i(xm(e,n),t)},H=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),r(xm(t,n)))},U=function(e,t){var n=e||"",r=!Be(n,"--"),o=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&function(e,t){return/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t))}(r,n)){var o=r.indexOf("[endif]",n);return r.indexOf(">",o)}if(t){var i=r.indexOf(">",n);return-1!==i?i:r.length}var a=/--!?>/;a.lastIndex=n;var c=a.exec(e);return c?c.index+c[0].length:r.length}(R,r,t);return e=R.substr(t,o-t),H(r?n+e:e),o+1},z=function(t,r,o,i,a){var c,u;if(o=function(e){return ge(n.uris,e).getOr(e)}((r=r.toLowerCase())in K?r:P(o||i||a||"")),J&&!b&&!1===function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")}(r)){if(!(c=S[r])&&T){for(u=T.length;u--&&!(c=T[u]).pattern.test(r););-1===u&&(c=null)}if(!c)return;if(c.validValues&&!(o in c.validValues))return}if(B[r]&&!e.allow_script_urls){var l=o.replace(/[\s\u0000-\u001F]+/g,"");try{l=decodeURIComponent(l)}catch(e){l=unescape(l)}if(M.test(l))return;if(Sm(e,l,t))return}b&&(r in B||0===r.indexOf("on"))||(p.map[r]=o,p.push({name:r,value:o}))},W=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),q=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,V=t.getShortEndedElements(),$=e.self_closing_elements||t.getSelfClosingElements(),K=t.getBoolAttrs(),J=e.validate,G=e.remove_internals,X=e.fix_self_closing,Y=t.getSpecialElements(),Q=R+">";f=W.exec(Q);){var Z=f[0];if(O<f.index&&j(P(R.substr(O,f.index-O))),d=f[7])":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),F(d);else if(d=f[8]){if(f.index+Z.length>R.length){j(P(R.substr(f.index))),O=f.index+Z.length;continue}":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),y=d in V,X&&$[d]&&D.length>0&&D[D.length-1].name===d&&F(d);var ee=Em(q,f[9]);if(null!==ee){if("all"===ee){O=Tm(t,R,W.lastIndex),W.lastIndex=O;continue}C=!1}if(!J||(w=t.getElementRule(d))){if(C=!0,J&&(S=w.attributes,T=w.attributePatterns),(k=f[9])?((b=-1!==k.indexOf("data-mce-type"))&&G&&(C=!1),(p=[]).map={},k.replace(q,(function(e,t,n,r,o){return z(d,t,n,r,o),""}))):(p=[]).map={},J&&!b){if(E=w.attributesRequired,_=w.attributesDefault,A=w.attributesForced,w.removeEmptyAttrs&&!p.length&&(C=!1),A)for(g=A.length;g--;)v=(x=A[g]).name,"{$uid}"===(N=x.value)&&(N="mce_"+I++),p.map[v]=N,p.push({name:v,value:N});if(_)for(g=_.length;g--;)(v=(x=_[g]).name)in p.map||("{$uid}"===(N=x.value)&&(N="mce_"+I++),p.map[v]=N,p.push({name:v,value:N}));if(E){for(g=E.length;g--&&!(E[g]in p.map););-1===g&&(C=!1)}if(x=p.map["data-mce-bogus"]){if("all"===x){O=Tm(t,R,W.lastIndex),W.lastIndex=O;continue}C=!1}}C&&a(d,p,y)}else C=!1;if(m=Y[d]){m.lastIndex=O=f.index+Z.length,(f=m.exec(R))?(C&&(h=R.substr(O,f.index-O)),O=f.index+f[0].length):(h=R.substr(O),O=R.length),C&&(h.length>0&&j(h,!0),c(d)),W.lastIndex=O;continue}y||(k&&k.indexOf("/")===k.length-1?C&&c(d):D.push({name:d,valid:C}))}else if(d=f[1])H(d);else if(d=f[2]){if(!(1===L||e.preserve_cdata||D.length>0&&t.isValidChild(D[D.length-1].name,"#cdata"))){O=U("",f.index+2),W.lastIndex=O;continue}o(d)}else if(d=f[3])l(d);else{if((d=f[4])||"<!"===Z){O=U(d,f.index+Z.length),W.lastIndex=O;continue}if(d=f[5]){if(1!==L){O=U("?",f.index+2),W.lastIndex=O;continue}u(d,f[6])}}O=f.index+Z.length}for(O<R.length&&j(P(R.substr(O))),g=D.length-1;g>=0;g--)(d=D[g]).valid&&c(d.name)};return{parse:function(e,t){void 0===t&&(t="html"),s(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,r=[],o={},i=Sc("img"),a=0,c=0;t=n.exec(e);){var u=t[0],l=i+"_"+c++;o[l]=u,a<t.index&&r.push(e.substr(a,t.index-a)),r.push(l),a=t.index+u.length}return 0===a?{prefix:i,uris:o,html:e}:(a<e.length&&r.push(e.substr(a)),{prefix:i,uris:o,html:r.join("")})}(e),t)}}}!function(e){e.findEndTag=Tm}(_m||(_m={}));var Am=_m,Nm=function(e,t){var n,r,o,i,a=t,c=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,u=e.schema;a=function(e,t){var n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")}(e.getTempAttrs(),a);for(var l=u.getShortEndedElements();i=c.exec(a);)r=c.lastIndex,o=i[0].length,n=l[i[1]]?r:Am.findEndTag(u,a,r),a=a.substring(0,r-o)+a.substring(n),c.lastIndex=r-o;return Fr(a)},Rm=Nm,Om=function(e,t,n,r){var o;return t.format=n,t.get=!0,t.getInner=!0,t.no_events||e.fire("BeforeGetContent",t),o="raw"===t.format?dt.trim(Rm(e.serializer,r.innerHTML)):"text"===t.format?e.dom.isEmpty(r)?"":Fr(r.innerText||r.textContent):"tree"===t.format?e.serializer.serialize(r,t):function(e,t){var n=Bu(e),r=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(r,"")}(e,e.serializer.serialize(r,t)),U(["text","tree"],t.format)||Mr(pt.fromDom(r))?t.content=o:t.content=dt.trim(o),t.no_events||e.fire("GetContent",t),t.content},Dm=dt.each,Im=function(e){this.compare=function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return Dm(e.getAttribs(t),(function(r){var o=r.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))})),n},o=function(e,t){var n,r;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(t.hasOwnProperty(r))return!1;return!0};return!!o(r(t),r(n))&&(!!o(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!Es(t)&&!Es(n)))}},Pm=function(e,t,n){return k.from(n.container()).filter(xn).exists((function(r){var o=e?0:-1;return t(r.data.charAt(n.offset()+o))}))},Bm=p(Pm,!0,As),Mm=p(Pm,!1,As),Lm=function(e){var t=e.container();return xn(t)&&(0===t.data.length||Lr(t.data)&&Nf.isBookmarkNode(t.parentNode))},Fm=function(e,t){return function(n){return k.from(Il(e?0:-1,n)).filter(t).isSome()}},jm=function(e){return _n(e)&&"block"===Hn(pt.fromDom(e),"display")},Hm=function(e){return Nn(e)&&!function(e){return pn(e)&&"all"===e.getAttribute("data-mce-bogus")}(e)},Um=Fm(!0,jm),zm=Fm(!1,jm),Wm=Fm(!0,On),qm=Fm(!1,On),Vm=Fm(!0,yn),$m=Fm(!1,yn),Km=Fm(!0,Hm),Jm=Fm(!1,Hm),Gm=function(e){var t=gc(e,"br"),n=$(function(e){for(var t=[],n=e.dom;n;)t.push(pt.fromDom(n)),n=n.lastChild;return t}(e).slice(-1),Rr);t.length===n.length&&q(n,Zt)},Xm=function(e){Qt(e),Xt(e,pt.fromHtml('<br data-mce-bogus="1">'))},Ym=function(e){jt(e).each((function(t){Dt(t).each((function(n){Ar(e)&&Rr(t)&&Ar(n)&&Zt(t)}))}))},Qm=function(e,t,n){return wt(t,e)?function(e,t){for(var n=B(t)?t:b,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,a=pt.fromDom(i);if(o.push(a),!0===n(a))break;r=i}return o}(e,(function(e){return n(e)||bt(e,t)})).slice(0,-1):[]},Zm=function(e,t){return Qm(e,t,b)},ep=function(e,t){return[e].concat(Zm(e,t))},tp=function(e,t,n){return ls(e,t,n,Lm)},np=function(e,t){return G(ep(pt.fromDom(t.container()),e),Ar)},rp=function(e,t,n){return tp(e,t.dom,n).forall((function(e){return np(t,n).fold((function(){return!1===Dl(e,n,t.dom)}),(function(r){return!1===Dl(e,n,t.dom)&&wt(r,pt.fromDom(e.container()))}))}))},op=function(e,t,n){return np(t,n).fold((function(){return tp(e,t.dom,n).forall((function(e){return!1===Dl(e,n,t.dom)}))}),(function(t){return tp(e,t.dom,n).isNone()}))},ip=p(op,!1),ap=p(op,!0),cp=p(rp,!1),up=p(rp,!0),lp=function(e){return zl(e).exists(Rr)},sp=function(e,t,n){var r=$(ep(pt.fromDom(n.container()),t),Ar),o=ne(r).getOr(t);return cs(e,o.dom,n).filter(lp)},fp=function(e,t){return zl(t).exists(Rr)||sp(!0,e,t).isSome()},dp=function(e,t){return function(e){return k.from(e.getNode(!0)).map(pt.fromDom)}(t).exists(Rr)||sp(!1,e,t).isSome()},mp=p(sp,!1),pp=p(sp,!0),gp=function(e){return cu.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},hp=function(e,t){var n=$(ep(pt.fromDom(t.container()),e),Ar);return ne(n).getOr(e)},vp=function(e,t){return gp(t)?Mm(t):Mm(t)||ds(hp(e,t).dom,t).exists(Mm)},bp=function(e,t){return gp(t)?Bm(t):Bm(t)||fs(hp(e,t).dom,t).exists(Bm)},yp=function(e){return zl(e).bind((function(e){return fr(e,St)})).exists((function(e){return function(e){return U(["pre","pre-wrap"],e)}(Hn(e,"white-space"))}))},wp=function(e,t){return function(e,t){return ds(e.dom,t).isNone()}(e,t)||function(e,t){return fs(e.dom,t).isNone()}(e,t)||ip(e,t)||ap(e,t)||dp(e,t)||fp(e,t)},Cp=function(e,t){return!yp(t)&&(ip(e,t)||cp(e,t)||dp(e,t)||vp(e,t))},xp=function(e,t){return!yp(t)&&(ap(e,t)||up(e,t)||fp(e,t)||bp(e,t))},kp=function(e,t){return Cp(e,t)||xp(e,function(e){var t=e.container(),n=e.offset();return xn(t)&&n<t.data.length?cu(t,n+1):e}(t))},Sp=function(e,t){return _s(e.charAt(t))},Tp=function(e){var t=e.container();return xn(t)&&Pe(t.data," ")},Ep=function(e){var t=e.data,n=function(e){var t=e.split("");return W(t,(function(e,n){return _s(e)&&n>0&&n<t.length-1&&Ns(t[n-1])&&Ns(t[n+1])?" ":e})).join("")}(t);return n!==t&&(e.data=n,!0)},_p=function(e,t){return k.some(t).filter(Tp).bind((function(t){var n=t.container();return function(e,t){var n=t.data,r=cu(t,0);return!(!Sp(n,0)||kp(e,r))&&(t.data=" "+n.slice(1),!0)}(e,n)||Ep(n)||function(e,t){var n=t.data,r=cu(t,n.length-1);return!(!Sp(n,n.length-1)||kp(e,r))&&(t.data=n.slice(0,-1)+" ",!0)}(e,n)?k.some(t):k.none()}))},Ap=function(e){var t=pt.fromDom(e.getBody());e.selection.isCollapsed()&&_p(t,cu.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))},Np=function(e,t,n){if(0!==n){var r=pt.fromDom(e),o=sr(r,Ar).getOr(r),i=e.data.slice(t,t+n),a=t+n>=e.data.length&&xp(o,lu(e,e.data.length)),c=0===t&&Cp(o,lu(e,0));e.replaceData(t,n,function(e,t,n){return J(e,(function(r,o){return As(o)||_s(o)?r.previousCharIsSpace||""===r.str&&t||r.str.length===e.length-1&&n?{previousCharIsSpace:!1,str:r.str+" "}:{previousCharIsSpace:!0,str:r.str+" "}:{previousCharIsSpace:!1,str:r.str+o}}),{previousCharIsSpace:!1,str:""}).str}(i,c,a))}},Rp=function(e,t){var n=e.data.slice(t),r=n.length-Fe(n).length;return Np(e,t,r)},Op=function(e,t){var n=e.data.slice(0,t),r=n.length-je(n).length;return Np(e,t-r,r)},Dp=function(e,t,n,r){void 0===r&&(r=!0);var o=je(e.data).length,i=r?e:t,a=r?t:e;return r?i.appendData(a.data):i.insertData(0,a.data),Zt(pt.fromDom(a)),n&&Rp(i,o),i},Ip=function(e,t){return function(e,t){var n=e.container(),r=e.offset();return!1===lu.isTextPosition(e)&&n===t.parentNode&&r>lu.before(t).offset()}(t,e)?lu(t.container(),t.offset()-1):t},Pp=function(e){return io(e.previousSibling)?k.some((t=e.previousSibling,xn(t)?lu(t,t.data.length):lu.after(t))):e.previousSibling?ps(e.previousSibling):k.none();var t},Bp=function(e){return io(e.nextSibling)?k.some((t=e.nextSibling,xn(t)?lu(t,0):lu.before(t))):e.nextSibling?ms(e.nextSibling):k.none();var t},Mp=function(e,t){return Pp(t).orThunk((function(){return Bp(t)})).orThunk((function(){return function(e,t){var n=lu.before(t.previousSibling?t.previousSibling:t.parentNode);return ds(e,n).fold((function(){return fs(e,lu.after(t))}),k.some)}(e,t)}))},Lp=function(e,t){return Bp(t).orThunk((function(){return Pp(t)})).orThunk((function(){return function(e,t){return fs(e,lu.after(t)).fold((function(){return ds(e,lu.before(t))}),k.some)}(e,t)}))},Fp=function(e,t,n){return function(e,t,n){return e?Lp(t,n):Mp(t,n)}(e,t,n).map(p(Ip,n))},jp=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},Hp=function(e,t){return t&&he(e.schema.getBlockElements(),Ct(t))},Up=function(e){if(ho(e)){var t=pt.fromHtml('<br data-mce-bogus="1">');return Qt(e),Xt(e,t),k.some(lu.before(t.dom))}return k.none()},zp=function(e,t,n){var r,o,i,a,c=Dt(e).filter(Tt),u=It(e).filter(Tt);return Zt(e),(r=c,o=u,i=t,a=function(e,t,r){var o=e.dom,i=t.dom,a=o.data.length;return Dp(o,i,n),r.container()===i?lu(o,a):r},r.isSome()&&o.isSome()&&i.isSome()?k.some(a(r.getOrDie(),o.getOrDie(),i.getOrDie())):k.none()).orThunk((function(){return n&&(c.each((function(e){return Op(e.dom,e.dom.length)})),u.each((function(e){return Rp(e.dom,0)}))),t}))},Wp=function(e,t,n,r){void 0===r&&(r=!0);var o,i=Fp(t,e.getBody(),n.dom),a=sr(n,p(Hp,e),(o=e.getBody(),function(e){return e.dom===o})),c=zp(n,i,function(e,t){return he(e.schema.getTextInlineElements(),Ct(t))}(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(Up).fold((function(){r&&jp(e,t,c)}),(function(n){r&&jp(e,t,k.some(n))}))},qp=function(e,t){return{start:e,end:t}},Vp=ar([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),$p=function(e,t){return gr(pt.fromDom(e),"td,th",t)},Kp=function(e,t){return mr(e,"table",t)},Jp=function(e){return!bt(e.start,e.end)},Gp=function(e,t){return Kp(e.start,t).bind((function(n){return Kp(e.end,t).bind((function(e){return t=bt(n,e),r=n,t?k.some(r):k.none();var t,r}))}))},Xp=function(e){return gc(e,"td,th")},Yp=function(e,t){var n=$p(t.startContainer,e),r=$p(t.endContainer,e);return t.collapsed?k.none():Oc(n,r,qp).fold((function(){return n.fold((function(){return r.bind((function(t){return Kp(t,e).bind((function(e){return ne(Xp(e)).map((function(e){return qp(e,t)}))}))}))}),(function(t){return Kp(t,e).bind((function(e){return re(Xp(e)).map((function(e){return qp(t,e)}))}))}))}),(function(t){return Qp(e,t)?k.none():function(e,t){return Kp(e.start,t).bind((function(t){return re(Xp(t)).map((function(t){return qp(e.start,t)}))}))}(t,e)}))},Qp=function(e,t){return Gp(t,e).isSome()},Zp=function(e,t,n){return e.filter((function(e){return Jp(e)&&Qp(n,e)})).orThunk((function(){return Yp(n,t)})).bind((function(e){return function(e,t){return Gp(e,t).map((function(t){return function(e,t,n){return{rng:e,table:t,cells:n}}(e,t,Xp(t))}))}(e,n)}))},eg=function(e,t){return X(e,(function(e){return bt(e,t)}))},tg=function(e,t,n){return e.filter((function(e){return function(e,t){return!Jp(e)&&Gp(e,t).exists((function(e){var t=e.dom.rows;return 1===t.length&&1===t[0].cells.length}))}(e,n)&&hf(e.start,t)})).map((function(e){return e.start}))},ng=function(e){return function(e){return Oc(eg(e.cells,e.rng.start),eg(e.cells,e.rng.end),(function(t,n){return e.cells.slice(t,n+1)}))}(e).map((function(t){var n=e.cells;return t.length===n.length?Vp.removeTable(e.table):Vp.emptyCells(t)}))},rg=function(e,t){var n=function(e){return function(t){return bt(e,t)}}(e),r=function(e,t){var n=$p(e.startContainer,t),r=$p(e.endContainer,t);return Oc(n,r,qp)}(t,n);return tg(r,t,n).map((function(e){return Vp.deleteCellSelection(t,e)})).orThunk((function(){return Zp(r,t,n).bind(ng)}))},og=function(e){var t;return(8===xt(t=e)||"#comment"===Ct(t)?Dt(e):jt(e)).bind(og).orThunk((function(){return k.some(e)}))},ig=function(e,t){return q(t,Xm),e.selection.setCursorLocation(t[0].dom,0),!0},ag=function(e,t,n){t.deleteContents();var r,o=og(n).getOr(n),i=pt.fromDom(e.dom.getParent(o.dom,e.dom.isBlock));if(ho(i)&&(Xm(i),e.selection.setCursorLocation(i.dom,0)),!bt(n,i)){var a=Ot(i).is(n)?[]:Ot(r=i).map(Mt).map((function(e){return $(e,(function(e){return!bt(r,e)}))})).getOr([]);q(a.concat(Mt(n)),(function(e){bt(e,i)||wt(e,i)||Zt(e)}))}return!0},cg=function(e,t){return Wp(e,!1,t),!0},ug=function(e,t,n,r){return sg(t,r).fold((function(){return function(e,t,n){return rg(t,n).map((function(t){return t.fold(p(cg,e),p(ig,e),p(ag,e))}))}(e,t,n)}),(function(t){return function(e,t){return fg(e,t)}(e,t)})).getOr(!1)},lg=function(e,t){return G(ep(t,e),Br)},sg=function(e,t){return G(ep(t,e),(function(e){return"caption"===Ct(e)}))},fg=function(e,t){return Xm(t),e.selection.setCursorLocation(t.dom,0),k.some(!0)},dg=function(e,t,n,r,o){return us(n,e.getBody(),o).bind((function(i){return function(e,t,n,r){return ms(e.dom).bind((function(o){return ps(e.dom).map((function(e){return t?n.isEqual(o)&&r.isEqual(e):n.isEqual(e)&&r.isEqual(o)}))})).getOr(!0)}(r,n,o,i)?function(e,t){return fg(e,t)}(e,r):function(e,t,n){return sg(e,pt.fromDom(n.getNode())).map((function(e){return!1===bt(e,t)}))}(t,r,i)})).or(k.some(!0))},mg=function(e,t,n,r){var o=lu.fromRangeStart(e.selection.getRng());return lg(n,r).bind((function(r){return ho(r)?fg(e,r):function(e,t,n,r,o){return us(n,e.getBody(),o).bind((function(e){return lg(t,pt.fromDom(e.getNode())).map((function(e){return!1===bt(e,r)}))}))}(e,n,t,r,o)})).getOr(!1)},pg=function(e,t){return e?Vm(t):$m(t)},gg=function(e,t,n){var r=pt.fromDom(e.getBody());return sg(r,n).fold((function(){return mg(e,t,r,n)||function(e,t){var n=lu.fromRangeStart(e.selection.getRng());return pg(t,n)||cs(t,e.getBody(),n).exists((function(e){return pg(t,e)}))}(e,t)}),(function(n){return function(e,t,n,r){var o=lu.fromRangeStart(e.selection.getRng());return ho(r)?fg(e,r):dg(e,n,t,r,o)}(e,t,r,n).getOr(!1)}))},hg=function(e,t){var n=pt.fromDom(e.selection.getStart(!0)),r=mf(e);return e.selection.isCollapsed()&&0===r.length?gg(e,t,n):function(e,t){var n=pt.fromDom(e.getBody()),r=e.selection.getRng(),o=mf(e);return 0!==o.length?ig(e,o):ug(e,n,r,t)}(e,n)},vg=function(e){var t=lu.fromRangeStart(e),n=lu.fromRangeEnd(e),r=e.commonAncestorContainer;return cs(!1,r,n).map((function(o){return!Dl(t,n,r)&&Dl(t,o,r)?function(e,t,n,r){var o=document.createRange();return o.setStart(e,t),o.setEnd(n,r),o}(t.container(),t.offset(),o.container(),o.offset()):e})).getOr(e)},bg=function(e){return e.collapsed?e:vg(e)},yg=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&function(e){return" "===e.data||En(e)}(e.firstChild)},wg=function(e){return e.length>0&&(!(t=e[e.length-1]).firstChild||yg(t))?e.slice(0,-1):e;var t},Cg=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},xg=function(e,t){var n=lu.after(e),r=ns(t).prev(n);return r?r.toRange():null},kg=function(e,t,n){var r=e.parentNode;return dt.each(t,(function(t){r.insertBefore(t,e)})),function(e,t){var n=lu.before(e),r=ns(t).next(n);return r?r.toRange():null}(e,n)},Sg=function(e,t,n,r){var o,i=function(e,t,n){var r=t.serialize(n);return function(e){var t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e}(e.createFragment(r))}(t,e,r),a=Cg(t,n.startContainer),c=wg((o=i.firstChild,dt.grep(o.childNodes,(function(e){return"LI"===e.nodeName})))),u=t.getRoot(),l=function(e){var r=lu.fromRangeStart(n),o=ns(t.getRoot()),i=1===e?o.prev(r):o.next(r);return!i||Cg(t,i.getNode())!==a};return l(1)?kg(a,c,u):l(2)?function(e,t,n,r){return r.insertAfter(t.reverse(),e),xg(t[0],n)}(a,c,u,t):function(e,t,n,r){var o=function(e,t){var n=t.cloneRange(),r=t.cloneRange();return n.setStartBefore(e),r.setEndAfter(e),[n.cloneContents(),r.cloneContents()]}(e,r),i=e.parentNode;return i.insertBefore(o[0],e),dt.each(t,(function(t){i.insertBefore(t,e)})),i.insertBefore(o[1],e),i.removeChild(e),xg(t[t.length-1],n)}(a,c,u,n)},Tg=Rn,Eg=function(e){var t=e.dom,n=bg(e.selection.getRng());e.selection.setRng(n);var r=t.getParent(n.startContainer,Tg);!function(e,t,n){return null!==n&&(n===e.getParent(t.endContainer,Tg)&&hf(pt.fromDom(n),t))}(t,n,r)?e.getDoc().execCommand("Delete",!1,null):ag(e,n,pt.fromDom(r))},_g=function(e,t,n){var r,o,i,a,c,u,l=e.selection,s=e.dom;/^ | $/.test(t)&&(t=function(e,t,n){var r=pt.fromDom(e.getRoot());return n=Cp(r,lu.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=xp(r,lu.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")}(s,l.getRng(),t));var f=e.parser,d=n.merge,m=Cm({validate:Yu(e)},e.schema),p='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';if(i={content:t,format:"html",selection:!0,paste:n.paste},(i=e.fire("BeforeSetContent",i)).isDefaultPrevented())e.fire("SetContent",{content:i.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=i.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,p);var g=(c=l.getRng()).startContainer||(c.parentElement?c.parentElement():null),h=e.getBody();g===h&&l.isCollapsed()&&s.isBlock(h.firstChild)&&function(e,t){return t&&!e.schema.getShortEndedElements()[t.nodeName]}(e,h.firstChild)&&s.isEmpty(h.firstChild)&&((c=s.createRng()).setStart(h.firstChild,0),c.setEnd(h.firstChild,0),l.setRng(c)),l.isCollapsed()||Eg(e);var v,b={context:(r=l.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},y=f.parse(t,b);if(!0===n.paste&&function(e,t){var n=t.firstChild,r=t.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||function(e,t){return e.getBlockElements()[t.name]&&function(e){return e.firstChild&&e.firstChild===e.lastChild}(t)&&function(e){return"br"===e.name||" "===e.value}(t.firstChild)}(e,t))}(e,r)&&(r=r.prev),!(!n||n!==r)&&("ul"===n.name||"ol"===n.name)}(e.schema,y)&&function(e,t){return!!Cg(e,t)}(s,r))return c=Sg(m,s,l.getRng(),y),l.setRng(c),void e.fire("SetContent",i);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(y),"mce_marker"===(u=y.lastChild).attr("id"))for(a=u,u=u.prev;u;u=u.walk(!0))if(3===u.type||!s.isBlock(u.name)){e.schema.isValidChild(u.parent.name,"span")&&u.parent.insert(a,u,"br"===u.name);break}if(e._selectionOverrides.showBlockCaretContainer(r),b.invalid){for(e.selection.setContent(p),r=l.getNode(),o=e.getBody(),9===r.nodeType?r=u=o:u=r;u!==o;)r=u,u=u.parentNode;t=r===o?o.innerHTML:s.getOuterHTML(r),t=m.serialize(f.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return m.serialize(y)})))),r===o?s.setHTML(o,t):s.setOuterHTML(r,t)}else!function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var r=n.firstChild,o=n.lastChild;!r||r===o&&"BR"===r.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}}(e,t=m.serialize(y),r);!function(e,t){var n=e.schema.getTextInlineElements(),r=e.dom;if(t){var o=e.getBody(),i=new Im(r);dt.each(r.select("*[data-mce-fragment]"),(function(e){for(var t=e.parentNode;t&&t!==o;t=t.parentNode)n[e.nodeName.toLowerCase()]&&i.compare(t,e)&&r.remove(e,!0)}))}}(e,d),function(e,t){var n,r,o=e.dom,i=e.selection;if(t){i.scrollIntoView(t);var a=function(t){for(var n=e.getBody();t&&t!==n;t=t.parentNode)if("false"===o.getContentEditable(t))return t;return null}(t);if(a)return o.remove(t),void i.select(a);var c=o.createRng(),u=t.previousSibling;u&&3===u.nodeType?(c.setStart(u,u.nodeValue.length),ct.ie||(r=t.nextSibling)&&3===r.nodeType&&(u.appendData(r.data),r.parentNode.removeChild(r))):(c.setStartBefore(t),c.setEndBefore(t));var l=o.getParent(t,o.isBlock);o.remove(t),l&&o.isEmpty(l)&&(e.$(l).empty(),c.setStart(l,0),c.setEnd(l,0),Tg(l)||function(e){return!!e.getAttribute("data-mce-fragment")}(l)||!(n=function(t){var n=lu.fromRangeStart(t);if(n=ns(e.getBody()).next(n))return n.toRange()}(c))?o.add(l,o.create("br",{"data-mce-bogus":"1"})):(c=n,o.remove(l))),i.setRng(c)}}(e,s.get("mce_marker")),v=e.getBody(),dt.each(v.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")})),function(e,t){k.from(e.getParent(t,"td,th")).map(pt.fromDom).each(Ym)}(s,l.getStart()),e.fire("SetContent",i),e.addVisual()}},Ag=function(e,t){t(e),e.firstChild&&Ag(e.firstChild,t),e.next&&Ag(e.next,t)},Ng=function(e,t,n){var r=function(e,t,n){var r={},o={},i=[];for(var a in n.firstChild&&Ag(n.firstChild,(function(n){q(e,(function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})})),q(t,(function(e){"string"==typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})}))})),r)r.hasOwnProperty(a)&&i.push(r[a]);for(var c in o)o.hasOwnProperty(c)&&i.push(o[c]);return i}(e,t,n);q(r,(function(e){q(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},Rg=function(e){return e instanceof bm},Og=function(e,t){e.dom.setHTML(e.getBody(),t),function(e){Jd(e)&&ms(e.getBody()).each((function(t){var n=t.getNode(),r=yn(n)?ms(n).getOr(t):t;e.selection.setRng(r.toRange())}))}(e)},Dg=function(e,t,n){return n.format=n.format?n.format:"html",n.set=!0,n.content=Rg(t)?"":t,n.no_events||e.fire("BeforeSetContent",n),Rg(t)||(t=n.content),k.from(e.getBody()).fold(d(t),(function(r){return Rg(t)?function(e,t,n,r){Ng(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=Cm({validate:e.validate},e.schema).serialize(n);return r.content=Mr(pt.fromDom(t))?o:dt.trim(o),Og(e,r.content),r.no_events||e.fire("SetContent",r),n}(e,r,t,n):function(e,t,n,r){var o,i;return 0===n.length||/^\s+$/.test(n)?(i='<br data-mce-bogus="1">',"TABLE"===t.nodeName?n="<tr><td>"+i+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+i+"</li>"),(o=Bu(e))&&e.schema.isValidChild(t.nodeName.toLowerCase(),o.toLowerCase())?(n=i,n=e.dom.createHTML(o,Mu(e),n)):n||(n='<br data-mce-bogus="1">'),Og(e,n),e.fire("SetContent",r)):("raw"!==r.format&&(n=Cm({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0}))),r.content=Mr(pt.fromDom(t))?n:dt.trim(n),Og(e,r.content),r.no_events||e.fire("SetContent",r)),r.content}(e,r,t,n)}))},Ig=function(e,t){return function(e,t){var n=e.dom;return n.parentNode?dr(pt.fromDom(n.parentNode),(function(n){return!bt(e,n)&&t(n)})):k.none()}(e,t).isSome()},Pg=function(e){return function(e){for(var t=[];e;){if(3===e.nodeType&&"\ufeff"!==e.nodeValue||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length>0},Bg=function(e){if(e){var t=new Tr(e,e);for(e=t.current();e;e=t.next())if(xn(e))return e}return null},Mg=function(e){var t=pt.fromTag("span");return Bn(t,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&Xt(t,pt.fromText("\ufeff")),t},Lg=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(Pg(t))Wp(e,!1,pt.fromDom(t),n);else{var i=o.getRng(),a=r.getParent(t,r.isBlock),c=i.startContainer,u=i.startOffset,l=i.endContainer,s=i.endOffset,f=function(e){var t=Bg(e);return t&&"\ufeff"===t.nodeValue.charAt(0)&&t.deleteData(0,1),t}(t);r.remove(t,!0),c===f&&u>0&&i.setStart(f,u-1),l===f&&s>0&&i.setEnd(f,s-1),a&&r.isEmpty(a)&&Xm(pt.fromDom(a)),o.setRng(i)}},Fg=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,o=e.selection;if(t)Lg(e,t,n);else if(!(t=hs(e.getBody(),o.getStart())))for(;t=r.get("_mce_caret");)Lg(e,t,!1)},jg=function(e,t){return e.appendChild(t),t},Hg=function(e,t){var n=K(e,(function(e,t){return jg(e,t.cloneNode(!1))}),t);return jg(n,n.ownerDocument.createTextNode("\ufeff"))},Ug=function(e,t,n,r){var o,i,a,c=e.dom,u=e.selection,l=[],s=u.getRng(),f=s.startContainer,d=s.startOffset;for(i=f,3===f.nodeType&&(d!==f.nodeValue.length&&(o=!0),i=i.parentNode);i;){if(sm(e,i,t,n,r)){a=i;break}i.nextSibling&&(o=!0),l.push(i),i=i.parentNode}if(a)if(o){var m=u.getBookmark();s.collapse(!0);var g=cf(e,s,e.formatter.get(t),!0);g=Jf(g),e.formatter.remove(t,n,g,r),u.moveToBookmark(m)}else{var h=hs(e.getBody(),a),v=Mg(!1).dom;!function(e,t,n){var r=e.dom,o=r.getParent(n,p(Is,e));o&&r.isEmpty(o)?n.parentNode.replaceChild(t,n):(Gm(pt.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(t,n):r.insertAfter(t,n))}(e,v,null!==h?h:a);var b=function(e,t,n,r,o,i){var a=e.formatter,c=e.dom,u=$(ie(a.get()),(function(e){return e!==r&&!Pe(e,"removeformat")})),l=mm(e,n,u);if($(l,(function(t){return!zs(e,t,r)})).length>0){var s=n.cloneNode(!1);return c.add(t,s),a.remove(r,o,s,i),c.remove(s),k.some(s)}return k.none()}(e,v,a,t,n,r),y=Hg(l.concat(b.toArray()),v);Lg(e,h,!1),u.setCursorLocation(y,1),c.isEmpty(a)&&c.remove(a)}},zg=function(e){e.on("mouseup keydown",(function(t){!function(e,t){var n=e.selection,r=e.getBody();Fg(e,null,!1),8!==t&&46!==t||!n.isCollapsed()||"\ufeff"!==n.getStart().innerHTML||Fg(e,hs(r,n.getStart())),37!==t&&39!==t||Fg(e,hs(r,n.getStart()))}(e,t.keyCode)}))},Wg=function(e,t){return e.schema.getTextInlineElements().hasOwnProperty(Ct(t))&&!gs(t.dom)&&!bn(t.dom)},qg={},Vg=Ce,$g=ye;!function(e,t){qg[e]||(qg[e]=[]),qg[e].push(t)}("pre",(function(e){var t,n=e.selection.getRng(),r=gn(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),$g(Vg(Vg(t,r),(function(e){return r(e.previousSibling)&&-1!==xe(t,e.previousSibling)})),(function(e){var t,n;t=e.previousSibling,ja(n=e).remove(),ja(t).append("<br><br>").append(n.childNodes)})))}));var Kg=dt.each,Jg=function(e){return pn(e)&&!Es(e)&&!gs(e)&&!bn(e)},Gg=function(e,t){var n;for(n=e;n;n=n[t]){if(xn(n)&&0!==n.nodeValue.length)return e;if(pn(n)&&!Es(n))return n}return e},Xg=function(e,t,n){var r,o,i=new Im(e);if(t&&n&&(t=Gg(t,"previousSibling"),n=Gg(n,"nextSibling"),i.compare(t,n))){for(r=t.nextSibling;r&&r!==n;)o=r,r=r.nextSibling,t.appendChild(o);return e.remove(n),dt.each(dt.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},Yg=function(e,t,n,r){if(r&&!1!==t.merge_siblings){var o=Xg(e,Ds(r),r);Xg(e,o,Ds(o,!0))}},Qg=function(e,t,n){Kg(e.childNodes,(function(e){Jg(e)&&(t(e)&&n(e),e.hasChildNodes()&&Qg(e,t,n))}))},Zg=function(e,t){return function(n){return!(!n||!js(e,n,t))}},eh=function(e,t,n){return function(r){e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)}(e,r)}},th=ar([{keep:[]},{rename:["name"]},{removed:[]}]),nh=/^(src|href|style)$/,rh=dt.each,oh=Ls,ih=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},ah=function(e,t,n){var r,o;if(r=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"],pn(r)){var i=r.childNodes.length-1;!n&&o&&o--,r=r.childNodes[o>i?i:o]}return xn(r)&&n&&o>=r.nodeValue.length&&(r=new Tr(r,e.getBody()).next()||r),xn(r)&&!n&&0===o&&(r=new Tr(r,e.getBody()).prev()||r),r},ch=function(e,t){var n=t?"firstChild":"lastChild";if(function(e){return/^(TR|TH|TD)$/.test(e.nodeName)}(e)&&e[n]){var r=e[n];return"TR"===e.nodeName&&r[n]||r}return e},uh=function(e,t,n,r){var o=e.create(n,r);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},lh=function(e,t,n,r,o){var i=pt.fromDom(t),a=pt.fromDom(e.create(r,o)),c=n?Bt(i):Pt(i);return Yt(a,c),n?(Kt(i,a),Gt(a,i)):(Jt(i,a),Xt(a,i)),a.dom},sh=function(e,t,n,r){return!(t=Ds(t,n,r))||"BR"===t.nodeName||e.isBlock(t)},fh=function(e,t,n,r,o){var i,a=e.dom;if(!function(e,t,n){return!!oh(t,n.inline)||(!!oh(t,n.block)||(n.selector?pn(t)&&e.is(t,n.selector):void 0))}(a,r,t)&&!function(e,t){return t.links&&"A"===e.nodeName}(r,t))return th.keep();var c=r;if(t.inline&&"all"===t.remove&&N(t.preserve_attributes)){var u=$(a.getAttribs(c),(function(e){return U(t.preserve_attributes,e.name.toLowerCase())}));if(a.removeAllAttribs(c),q(u,(function(e){return a.setAttrib(c,e.name,e.value)})),u.length>0)return th.rename("span")}if("all"!==t.remove){rh(t.styles,(function(e,r){e=Fs(a,Ms(e,n),r+""),M(r)&&(r=e,o=null),(t.remove_similar||!o||oh(js(a,o,r),e))&&a.setStyle(c,r,""),i=!0})),i&&""===a.getAttrib(c,"style")&&(c.removeAttribute("style"),c.removeAttribute("data-mce-style")),rh(t.attributes,(function(e,r){var i;if(e=Ms(e,n),M(r)&&(r=e,o=null),t.remove_similar||!o||oh(a.getAttrib(o,r),e)){if("class"===r&&(e=a.getAttrib(c,r))&&(i="",q(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)})),i))return void a.setAttrib(c,r,i);"class"===r&&c.removeAttribute("className"),nh.test(r)&&c.removeAttribute("data-mce-"+r),c.removeAttribute(r)}})),rh(t.classes,(function(e){e=Ms(e,n),o&&!a.hasClass(o,e)||a.removeClass(c,e)}));for(var l=a.getAttribs(c),s=0;s<l.length;s++){var f=l[s].nodeName;if(0!==f.indexOf("_")&&0!==f.indexOf("data-"))return th.keep()}}return"none"!==t.remove?(function(e,t,n){var r,o=t.parentNode,i=e.dom,a=Bu(e);n.block&&(a?o===i.getRoot()&&(n.list_block&&oh(t,n.list_block)||q(oe(t.childNodes),(function(t){Ps(e,a,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=uh(i,t,a),i.setAttribs(r,e.settings.forced_root_block_attrs)):r=0}))):i.isBlock(t)&&!i.isBlock(o)&&(sh(i,t,!1)||sh(i,t.firstChild,!0,!0)||t.insertBefore(i.create("br"),t.firstChild),sh(i,t,!0)||sh(i,t.lastChild,!1,!0)||t.appendChild(i.create("br")))),n.selector&&n.inline&&!oh(n.inline,t)||i.remove(t,!0)}(e,c,t),th.removed()):th.keep()},dh=function(e,t,n,r,o){return fh(e,t,n,r,o).fold(b,(function(t){return e.dom.rename(r,t),!0}),y)},mh=function(e,t,n,r){return fh(e,t,n,r,r).fold(d(r),(function(t){return e.dom.createFragment().appendChild(r),e.dom.rename(r,t)}),d(null))},ph=function(e,t,n,r,o){var i=e.formatter.get(t),a=i[0],c=!0,u=e.dom,l=e.selection,s=function(r){var c=function(e,t,n,r,o){var i;return q(Us(e.dom,t.parentNode).reverse(),(function(t){if(!i&&"_start"!==t.id&&"_end"!==t.id){var a=sm(e,t,n,r,o);a&&!1!==a.split&&(i=t)}})),i}(e,r,t,n,o);return function(e,t,n,r,o,i,a,c){var u,l,s,f=e.dom;if(n){for(var d=n.parentNode,m=r.parentNode;m&&m!==d;m=m.parentNode){u=f.clone(m,!1);for(var p=0;p<t.length&&null!==(u=mh(e,t[p],c,u));p++);u&&(l&&u.appendChild(l),s||(s=u),l=u)}!i||a.mixed&&f.isBlock(n)||(r=f.split(n,r)),l&&(o.parentNode.insertBefore(l,o),s.appendChild(o),a.inline&&Yg(f,a,0,l))}return r}(e,i,c,r,r,!0,a,n)},f=function(t){var r,o;pn(t)&&u.getContentEditable(t)&&(r=c,c="true"===u.getContentEditable(t),o=!0);var l=oe(t.childNodes);if(c&&!o)for(var s=0;s<i.length&&!dh(e,i[s],n,t,t);s++);if(a.deep&&l.length){for(s=0;s<l.length;s++)f(l[s]);o&&(c=r)}},d=function(e){var t=u.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return function(e){return Es(e)&&pn(e)&&("_start"===e.id||"_end"===e.id)}(n)&&(n=n[e?"firstChild":"lastChild"]),xn(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),u.remove(t,!0),n},m=function(t){var n,r,o=cf(e,t,i,t.collapsed);if(a.split){if(o=Jf(o),(n=ah(e,o,!0))!==(r=ah(e,o))){if(n=ch(n,!0),r=ch(r,!1),ih(u,n,r)){var c=k.from(n.firstChild).getOr(n);return s(lh(u,c,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void d(!0)}if(ih(u,r,n)){c=k.from(r.lastChild).getOr(r);return s(lh(u,c,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void d(!1)}n=uh(u,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=uh(u,r,"span",{id:"_end","data-mce-type":"bookmark"});var l=u.createRng();l.setStartAfter(n),l.setEndBefore(r),lf(u,l,(function(e){q(e,(function(e){Es(e)||Es(e.parentNode)||s(e)}))})),s(n),s(r),n=d(!0),r=d()}else n=r=s(n);o.startContainer=n.parentNode?n.parentNode:n,o.startOffset=u.nodeIndex(n),o.endContainer=r.parentNode?r.parentNode:r,o.endOffset=u.nodeIndex(r)+1}lf(u,o,(function(t){q(t,(function(t){f(t);q(["underline","line-through","overline"],(function(n){pn(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&Hs(u,t.parentNode)===n&&dh(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))}))}))};if(r)if(Rs(r)){var p=u.createRng();p.setStartBefore(r),p.setEndAfter(r),m(p)}else m(r);else if("false"!==u.getContentEditable(l.getNode()))l.isCollapsed()&&a.inline&&!mf(e).length?Ug(e,t,n,o):(wf(l,!0,(function(){yf(e,m)})),a.inline&&fm(e,t,n,l.getStart())&&Os(u,l,l.getRng()),e.nodeChanged());else{r=l.getNode();for(var g=0;g<i.length&&(!i[g].ceFalseOverride||!dh(e,i[g],n,r,r));g++);}},gh=dt.each,hh=function(e,t,n,r){gh(t,(function(t){gh(e.dom.select(t.inline,r),(function(r){Jg(r)&&dh(e,t,n,r,t.exact?r:null)})),function(e,t,n){if(t.clear_child_styles){var r=t.links?"*:not(a)":"*";Kg(e.select(r,n),(function(n){Jg(n)&&Kg(t.styles,(function(t,r){e.setStyle(n,r,"")}))}))}}(e.dom,t,r)}))},vh=dt.each,bh=function(e,t){return ve(e,t)},yh=function(e,t,n,r){var o=e.formatter.get(t),i=o[0],a=!r&&e.selection.isCollapsed(),c=e.dom,u=e.selection,l=function(e,t){if(t=t||i,e){if(t.onformat&&t.onformat(e,t,n,r),vh(t.styles,(function(t,r){c.setStyle(e,r,Ms(t,n))})),t.styles){var o=c.getAttrib(e,"style");o&&c.setAttrib(e,"data-mce-style",o)}vh(t.attributes,(function(t,r){c.setAttrib(e,r,Ms(t,n))})),vh(t.classes,(function(t){t=Ms(t,n),c.hasClass(e,t)||c.addClass(e,t)}))}},s=function(e,t){var n=!1;return!!qs(i)&&(vh(e,(function(e){if(!("collapsed"in e)||e.collapsed===a)return c.is(t,e.selector)&&!gs(t)?(l(t,e),n=!0,!1):void 0})),n)},f=function(r,a,c,u){var f=[],d=!0,m=i.inline||i.block,p=r.create(m);l(p),lf(r,a,(function(a){var c,g=function(a){var h=!1,v=d,b=a.nodeName.toLowerCase(),y=a.parentNode.nodeName.toLowerCase();if(pn(a)&&r.getContentEditable(a)&&(v=d,d="true"===r.getContentEditable(a),h=!0),En(a)&&!function(e,t,n,r){if(function(e){return e.getParam("format_empty_lines",!1,"boolean")}(e)&&Vs(t)){var o=Ee(Ee({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),i=Ig(pt.fromDom(n),(function(e){return gs(e.dom)}));return ve(o,r)&&ho(pt.fromDom(n.parentNode),!1)&&!i}return!1}(e,i,a,y))return c=null,void(Ws(i)&&r.remove(a));if(i.wrapper&&sm(e,a,t,n))c=null;else{if(d&&!h&&Ws(i)&&!i.wrapper&&Is(e,b)&&Ps(e,y,m)){var w=r.rename(a,m);return l(w),f.push(w),void(c=null)}if(qs(i)){var C=s(o,a);if(!bh(i,"inline")||C)return void(c=null)}!d||h||!Ps(e,m,b)||!Ps(e,y,m)||!u&&3===a.nodeType&&1===a.nodeValue.length&&65279===a.nodeValue.charCodeAt(0)||gs(a)||bh(i,"inline")&&r.isBlock(a)?(c=null,vh(dt.grep(a.childNodes),g),h&&(d=v),c=null):(c||(c=r.clone(p,!1),a.parentNode.insertBefore(c,a),f.push(c)),c.appendChild(a))}};vh(a,g)})),!0===i.links&&vh(f,(function(e){var t=function(e){"A"===e.nodeName&&l(e,i),vh(dt.grep(e.childNodes),t)};t(e)})),vh(f,(function(a){var c=function(e){var t=!1;return vh(e.childNodes,(function(e){if(function(e){return e&&1===e.nodeType&&!Es(e)&&!gs(e)&&!bn(e)}(e))return t=e,!1})),t},u=function(e){var t=0;return vh(e.childNodes,(function(e){(function(e){return P(e)&&xn(e)&&0===e.length})(e)||Es(e)||t++})),t}(a);!(f.length>1)&&r.isBlock(a)||0!==u?(Vs(i)||i.wrapper)&&(i.exact||1!==u||(a=function(e){var t,n=c(e);return n&&!Es(n)&&um(r,n,i)&&(t=r.clone(n,!1),l(t),r.replace(t,e,!0),r.remove(n,!0)),t||e}(a)),hh(e,o,n,a),function(e,t,n,r,o){sm(e,o.parentNode,n,r)&&dh(e,t,r,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,(function(i){if(sm(e,i,n,r))return dh(e,t,r,o),!0}))}(e,i,t,n,a),function(e,t,n,r){t.styles&&t.styles.backgroundColor&&Qg(r,Zg(e,"fontSize"),eh(e,"backgroundColor",Ms(t.styles.backgroundColor,n)))}(r,i,n,a),function(e,t,n,r){var o=function(t){if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){var n=Hs(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(dt.walk(r,o,"childNodes"),o(r))}(r,i,0,a),function(e,t,n,r){"sub"!==t.inline&&"sup"!==t.inline||(Qg(r,Zg(e,"fontSize"),eh(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",r),!0))}(r,i,0,a),Yg(r,i,0,a)):r.remove(a,!0)}))};if("false"!==c.getContentEditable(u.getNode())){if(i){if(r)if(Rs(r)){if(!s(o,r)){var d=c.createRng();d.setStartBefore(r),d.setEndAfter(r),f(c,cf(e,d,o),0,!0)}}else f(c,r,0,!0);else if(a&&Vs(i)&&!mf(e).length)!function(e,t,n){var r,o,i=e.selection,a=i.getRng(),c=a.startOffset,u=a.startContainer.nodeValue;(r=hs(e.getBody(),i.getStart()))&&(o=Bg(r));var l,s,f=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(u&&c>0&&c<u.length&&f.test(u.charAt(c))&&f.test(u.charAt(c-1))){var d=i.getBookmark();a.collapse(!0);var m=cf(e,a,e.formatter.get(t));m=Jf(m),e.formatter.apply(t,n,m),i.moveToBookmark(d)}else r&&"\ufeff"===o.nodeValue||(l=e.getDoc(),s=Mg(!0).dom,o=(r=l.importNode(s,!0)).firstChild,a.insertNode(r),c=1),e.formatter.apply(t,n,r),i.setCursorLocation(o,c)}(e,t,n);else{var m=u.getNode(),p=o[0];e.settings.forced_root_block||!p.defaultBlock||c.getParent(m,c.isBlock)||yh(e,p.defaultBlock),u.setRng(bg(u.getRng())),wf(u,!0,(function(t){yf(e,(function(t,n){var r=n?t:cf(e,t,o);f(c,r)}))})),Os(c,u,u.getRng()),e.nodeChanged()}!function(e,t){$g(qg[e],(function(e){e(t)}))}(t,e)}}else{r=u.getNode();for(var g=0,h=o.length;g<h;g++){var v=o[g];if(v.ceFalseOverride&&qs(v)&&c.is(r,v.selector))return void l(r,v)}}},wh=function(e,t,n,r){var o=ie(n.get()),i={},a={},c=$(Us(e.dom,t),(function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")}));ce(r,(function(t,n){dt.each(c,(function(r){return e.formatter.matchNode(r,n,{},t.similar)?(-1===o.indexOf(n)&&(q(t.callbacks,(function(e){e(!0,{node:r,format:n,parents:c})})),i[n]=t.callbacks),a[n]=t.callbacks,!1):!am(e,r,n)&&void 0}))}));var u=Ch(n.get(),a,t,c);n.set(Ee(Ee({},i),u))},Ch=function(e,t,n,r){return de(e,(function(e,o){return!!he(t,o)||(q(e,(function(e){e(!1,{node:n,format:o,parents:r})})),!1)})).t},xh=function(e,t,n,r,o){return null===t.get()&&function(e,t){var n=Qa({});e.set({}),t.on("NodeChange",(function(r){wh(t,r.element,n,e.get())}))}(t,e),function(e,t,n,r){var o=e.get();q(t.split(","),(function(e){o[e]||(o[e]={similar:r,callbacks:[]}),o[e].callbacks.push(n)})),e.set(o)}(t,n,r,o),{unbind:function(){return function(e,t,n){var r=e.get();q(t.split(","),(function(e){r[e].callbacks=$(r[e].callbacks,(function(e){return e!==n})),0===r[e].callbacks.length&&delete r[e]})),e.set(r)}(t,n,r)}}},kh=function(e,t){var n=(t||document).createDocumentFragment();return q(e,(function(e){n.appendChild(e.dom)})),pt.fromDom(n)},Sh=function(e,t,n){return{element:e,width:t,rows:n}},Th=function(e,t){return{element:e,cells:t}},Eh=function(e,t){return{x:e,y:t}},_h=function(e,t){var n=parseInt(Mn(e,t),10);return isNaN(n)?1:n},Ah=function(e,t,n){var r=e.rows;return!!(r[n]?r[n].cells:[])[t]},Nh=function(e){return J(e,(function(e,t){return t.cells.length>e?t.cells.length:e}),0)},Rh=function(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var o=n[r].cells,i=0;i<o.length;i++)if(bt(o[i],t))return k.some(Eh(i,r));return k.none()},Oh=function(e,t,n,r,o){for(var i=[],a=e.rows,c=n;c<=o;c++){var u=a[c].cells,l=t<r?u.slice(t,r+1):u.slice(r,t+1);i.push(Th(a[c].element,l))}return i},Dh=function(e){var t=Sh(_c(e),0,[]);return q(gc(e,"tr"),(function(e,n){q(gc(e,"td,th"),(function(r,o){!function(e,t,n,r,o){for(var i=_h(o,"rowspan"),a=_h(o,"colspan"),c=e.rows,u=n;u<n+i;u++){c[u]||(c[u]=Th(Ac(r),[]));for(var l=t;l<t+a;l++){c[u].cells[l]=u===n&&l===t?o:_c(o)}}}(t,function(e,t,n){for(;Ah(e,t,n);)t++;return t}(t,o,n),n,e,r)}))})),Sh(t.element,Nh(t.rows),t.rows)},Ih=function(e){return function(e,t){var n=_c(e.element),r=pt.fromTag("tbody");return Yt(r,t),Xt(n,r),n}(e,function(e){return W(e.rows,(function(e){var t=W(e.cells,(function(e){var t=Ac(e);return Fn(t,"colspan"),Fn(t,"rowspan"),t})),n=_c(e.element);return Yt(n,t),n}))}(e))},Ph=function(e,t,n){return Rh(e,t).bind((function(t){return Rh(e,n).map((function(n){return function(e,t,n){var r=t.x,o=t.y,i=n.x,a=n.y,c=o<a?Oh(e,r,o,i,a):Oh(e,r,a,i,o);return Sh(e.element,Nh(c),c)}(e,t,n)}))}))},Bh=function(e,t){return G(e,(function(e){return"li"===Ct(e)&&hf(e,t)})).fold(d([]),(function(t){return function(e){return G(e,(function(e){return"ul"===Ct(e)||"ol"===Ct(e)}))}(e).map((function(e){var t=pt.fromTag(Ct(e)),n=me(Wn(e),(function(e,t){return Be(t,"list-style")}));return jn(t,n),[pt.fromTag("li"),t]})).getOr([])}))},Mh=function(e,t){var n=pt.fromDom(t.commonAncestorContainer),r=ep(n,e),o=$(r,(function(e){return Nr(e)||_r(e)})),i=Bh(r,t),a=o.concat(i.length?i:function(e){return Ir(e)?Ot(e).filter(Dr).fold(d([]),(function(t){return[e,t]})):Dr(e)?[e]:[]}(n));return W(a,_c)},Lh=function(){return kh([])},Fh=function(e,t){return n=pt.fromDom(t.cloneContents()),r=Mh(e,t),o=J(r,(function(e,t){return Xt(t,e),t}),n),r.length>0?kh([o]):o;var n,r,o},jh=function(e,t){return(n=e,r=t[0],mr(r,"table",p(bt,n))).bind((function(e){var n=t[0],r=t[t.length-1],o=Dh(e);return Ph(o,n,r).map((function(e){return kh([Ih(e)])}))})).getOrThunk(Lh);var n,r},Hh=function(e,t){var n=df(t,e);return n.length>0?jh(e,n):function(e,t){return t.length>0&&t[0].collapsed?Lh():Fh(e,t[0])}(e,t)},Uh=function(e,t){return t>=0&&t<e.length&&As(e.charAt(t))},zh=function(e,t){var n=Fr(e.innerText);return t?function(e){return e.replace(/^[ \f\n\r\t\v]+/,"")}(n):n},Wh=function(e,t,n){if(void 0===n&&(n={}),n.get=!0,n.format=t,n.selection=!0,(n=e.fire("BeforeGetContent",n)).isDefaultPrevented())return e.fire("GetContent",n),n.content;if("text"===n.format)return function(e){return k.from(e.selection.getRng()).map((function(t){var n=k.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),r=e.getBody(),o=function(e){return e.map((function(e){return e.nodeName})).getOr("div").toLowerCase()}(n),i=ct.browser.isIE()&&"pre"!==o,a=e.dom.add(r,o,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),c=zh(a,i),u=Fr(a.textContent);if(e.dom.remove(a),Uh(u,0)||Uh(u,u.length-1)){var l=n.getOr(r),s=zh(l,i),f=s.indexOf(c);return-1===f?c:(Uh(s,f-1)?" ":"")+c+(Uh(s,f+c.length)?" ":"")}return c})).getOr("")}(e);n.getInner=!0;var r=function(e,t){var n=e.selection.getRng(),r=e.dom.create("body"),o=e.selection.getSel(),i=nm(e,sf(o)),a=t.contextual?Hh(pt.fromDom(e.getBody()),i).dom:n.cloneContents();return a&&r.appendChild(a),e.selection.serializer.serialize(r,t)}(e,n);return"tree"===n.format?r:(n.content=e.selection.isCollapsed()?"":r,e.fire("GetContent",n),n.content)},qh=function(e){return pn(e)?e.outerHTML:xn(e)?Po.encodeRaw(e.data,!1):kn(e)?"\x3c!--"+e.data+"--\x3e":""},Vh=function(e,t,n){var r=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r}(t);if(e.hasChildNodes()&&n<e.childNodes.length){var o=e.childNodes[n];o.parentNode.insertBefore(r,o)}else e.appendChild(r)},$h=function(e,t){var n,r,o,i,a,c,u,l,s,f=W(oe(t.childNodes),qh);return function(e,t){var n=0;q(e,(function(e){0===e[0]?n++:1===e[0]?(Vh(t,e[1],n),n++):2===e[0]&&function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}}(t,n)}))}((r=e,o=(n=f).length+r.length+2,i=new Array(o),a=new Array(o),c=function(e,t,o,i,a){var u=l(e,t,o,i);if(null===u||u.start===t&&u.diag===t-i||u.end===e&&u.diag===e-o)for(var s=e,f=o;s<t||f<i;)s<t&&f<i&&n[s]===r[f]?(a.push([0,n[s]]),++s,++f):t-e>i-o?(a.push([2,n[s]]),++s):(a.push([1,r[f]]),++f);else{c(e,u.start,o,u.start-u.diag,a);for(var d=u.start;d<u.end;++d)a.push([0,n[d]]);c(u.end,t,u.end-u.diag,i,a)}},u=function(e,t,o,i){for(var a=e;a-t<i&&a<o&&n[a]===r[a-t];)++a;return function(e,t,n){return{start:e,end:t,diag:n}}(e,a,t)},l=function(e,t,o,c){var l=t-e,s=c-o;if(0===l||0===s)return null;var f,d,m,p,g,h=l-s,v=s+l,b=(v%2==0?v:v+1)/2;for(i[1+b]=e,a[1+b]=t+1,f=0;f<=b;++f){for(d=-f;d<=f;d+=2){for(m=d+b,d===-f||d!==f&&i[m-1]<i[m+1]?i[m]=i[m+1]:i[m]=i[m-1]+1,g=(p=i[m])-e+o-d;p<t&&g<c&&n[p]===r[g];)i[m]=++p,++g;if(h%2!=0&&h-f<=d&&d<=h+f&&a[m-h]<=i[m])return u(a[m-h],d+e-o,t,c)}for(d=h-f;d<=h+f;d+=2){for(m=d+b-h,d===h-f||d!==h+f&&a[m+1]<=a[m-1]?a[m]=a[m+1]-1:a[m]=a[m-1],g=(p=a[m]-1)-e+o-d;p>=e&&g>=o&&n[p]===r[g];)a[m]=p--,g--;if(h%2==0&&-f<=d&&d<=f&&a[m]<=i[m+h])return u(a[m],d+e-o,t,c)}}},s=[],c(0,n.length,0,r.length,s),s),t),t},Kh=Qa(k.none()),Jh=function(e){var t,n=(t=e.getBody(),$(W(oe(t.childNodes),qh),(function(e){return e.length>0}))),r=Y(n,(function(t){var n=Nm(e.serializer,t);return n.length>0?[n]:[]})),o=r.join("");return-1!==o.indexOf("</iframe>")?function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}}(r):function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}}(o)},Gh=function(e,t,n){"fragmented"===t.type?$h(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw"}),e.selection.moveToBookmark(n?t.beforeBookmark:t.bookmark)},Xh=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},Yh=function(e){var t=pt.fromTag("body",Kh.get().getOrThunk((function(){var e=document.implementation.createHTMLDocument("undo");return Kh.set(k.some(e)),e})));return Tc(t,Xh(e)),q(gc(t,"*[data-mce-bogus]"),en),t.dom.innerHTML},Qh=function(e,t){return!(!e||!t)&&(!!function(e,t){return Xh(e)===Xh(t)}(e,t)||function(e,t){return Yh(e)===Yh(t)}(e,t))},Zh=function(e){return 0===e.get()},ev=function(e,t,n){Zh(n)&&(e.typing=t)},tv=function(e,t){e.typing&&(ev(e,!1,t),e.add())},nv=function(e){return e instanceof bm},rv=function(e,t){Ng(e.serializer.getNodeFilters(),e.serializer.getAttributeFilters(),t)},ov=function(e){return{undoManager:{beforeChange:function(t,n){return function(e,t,n){Zh(t)&&n.set(k.some(Ou(e.selection)))}(e,t,n)},addUndoLevel:function(t,n,r,o,i,a){return function(e,t,n,r,o,i,a){var c=Jh(e);if(i=i||{},i=dt.extend(i,c),!1===Zh(r)||e.removed)return null;var u=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:i,lastLevel:u,originalEvent:a}).isDefaultPrevented())return null;if(u&&Qh(u,i))return null;t.data[n.get()]&&o.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var l=function(e){return e.getParam("custom_undo_redo_levels",0,"number")}(e);if(l&&t.data.length>l){for(var s=0;s<t.data.length-1;s++)t.data[s]=t.data[s+1];t.data.length--,n.set(t.data.length)}i.bookmark=Ou(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(i),n.set(t.data.length-1);var f={level:i,lastLevel:u,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.fire("AddUndo",f),e.fire("change",f)):e.fire("AddUndo",f),i}(e,t,n,r,o,i,a)},undo:function(t,n,r){return function(e,t,n,r){var o;return t.typing&&(t.add(),t.typing=!1,ev(t,!1,n)),r.get()>0&&(r.set(r.get()-1),o=t.data[r.get()],Gh(e,o,!0),e.setDirty(!0),e.fire("Undo",{level:o})),o}(e,t,n,r)},redo:function(t,n){return function(e,t,n){var r;return t.get()<n.length-1&&(t.set(t.get()+1),r=n[t.get()],Gh(e,r,!1),e.setDirty(!0),e.fire("Redo",{level:r})),r}(e,t,n)},clear:function(t,n){return function(e,t,n){t.data=[],n.set(0),t.typing=!1,e.fire("ClearUndos")}(e,t,n)},reset:function(e){return function(e){e.clear(),e.add()}(e)},hasUndo:function(t,n){return function(e,t,n){return n.get()>0||t.typing&&t.data[0]&&!Qh(Jh(e),t.data[0])}(e,t,n)},hasRedo:function(e,t){return function(e,t){return t.get()<e.data.length-1&&!e.typing}(e,t)},transact:function(e,t,n){return function(e,t,n){return tv(e,t),e.beforeChange(),e.ignore(n),e.add()}(e,t,n)},ignore:function(e,t){return function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}}(e,t)},extra:function(t,n,r,o){return function(e,t,n,r,o){if(t.transact(r)){var i=t.data[n.get()].bookmark,a=t.data[n.get()-1];Gh(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=i)}}(e,t,n,r,o)}},formatter:{match:function(t,n,r){return fm(e,t,n,r)},matchAll:function(t,n){return function(e,t,n){var r=[],o={},i=e.selection.getStart();return e.dom.getParent(i,(function(i){for(var a=0;a<t.length;a++){var c=t[a];!o[c]&&sm(e,i,c,n)&&(o[c]=!0,r.push(c))}}),e.dom.getRoot()),r}(e,t,n)},matchNode:function(t,n,r,o){return sm(e,t,n,r,o)},canApply:function(t){return function(e,t){var n,r,o,i,a,c=e.formatter.get(t),u=e.dom;if(c)for(n=e.selection.getStart(),r=Us(u,n),i=c.length-1;i>=0;i--){if(!(a=c[i].selector)||c[i].defaultBlock)return!0;for(o=r.length-1;o>=0;o--)if(u.is(r[o],a))return!0}return!1}(e,t)},closest:function(t){return dm(e,t)},apply:function(t,n,r){return yh(e,t,n,r)},remove:function(t,n,r,o){return ph(e,t,n,r,o)},toggle:function(t,n,r){return function(e,t,n,r){var o=e.formatter.get(t);!fm(e,t,n,r)||"toggle"in o[0]&&!o[0].toggle?yh(e,t,n,r):ph(e,t,n,r)}(e,t,n,r)},formatChanged:function(t,n,r,o){return xh(e,t,n,r,o)}},editor:{getContent:function(t,n){return function(e,t,n){return k.from(e.getBody()).fold(d("tree"===t.format?new bm("body",11):""),(function(r){return Om(e,t,n,r)}))}(e,t,n)},setContent:function(t,n){return Dg(e,t,n)},insertContent:function(t,n){return _g(e,t,n)},addVisual:function(t){return function(e,t){var n=e.dom,r=P(t)?t:e.getBody();D(e.hasVisual)&&(e.hasVisual=function(e){return e.getParam("visual",!0,"boolean")}(e)),q(n.select("table,a",r),(function(t){switch(t.nodeName){case"TABLE":var r=function(e){return e.getParam("visual_table_class","mce-item-table","string")}(e),o=n.getAttrib(t,"border");o&&"0"!==o||!e.hasVisual?n.removeClass(t,r):n.addClass(t,r);break;case"A":if(!n.getAttrib(t,"href")){var i=n.getAttrib(t,"name")||t.id,a=function(e){return e.getParam("visual_anchor_class","mce-item-anchor","string")}(e);i&&e.hasVisual?n.addClass(t,a):n.removeClass(t,a)}}})),e.fire("VisualAid",{element:t,hasVisual:e.hasVisual})}(e,t)}},selection:{getContent:function(t,n){return Wh(e,t,n)}},raw:{getModel:function(){return k.none()}}}},iv=function(e,t){var n=function(e){return A(e)?e:{}},r=h("Unimplemented feature for rtc");return{undoManager:{beforeChange:s,addUndoLevel:r,undo:function(){return t.undo(),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},redo:function(){return t.redo(),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},clear:r,reset:r,hasUndo:function(){return t.hasUndo()},hasRedo:function(){return t.hasRedo()},transact:function(e,n,r){return t.transact(r),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},ignore:r,extra:r},formatter:{match:function(e,r,o){return t.matchFormat(e,n(r))},matchAll:r,matchNode:r,canApply:function(e){return t.canApplyFormat(e)},closest:function(e){return t.closestFormat(e)},apply:function(e,r,o){return t.applyFormat(e,n(r))},remove:function(e,r,o,i){return t.removeFormat(e,n(r))},toggle:function(e,r,o){return t.toggleFormat(e,n(r))},formatChanged:function(e,n,r,o){return t.formatChanged(n,r,o)}},editor:{getContent:function(n,r){if("html"===r||"tree"===r){var o=t.getContent(),i=Cm({inner:!0});return rv(e,o),"tree"===r?o:i.serialize(o)}return ov(e).editor.getContent(n,r)},setContent:function(n,r){var o=nv(n)?n:e.parser.parse(n,{isRootContent:!0,insert:!0});return t.setContent(o),n},insertContent:function(n,r){var o,i=(o=e,k.from(o.selection.getStart(!0)).map((function(e){return e.nodeName.toLowerCase()}))).fold((function(){return{}}),(function(e){return{context:e}})),a=nv(n)?n:e.parser.parse(n,Ee(Ee({},i),{insert:!0}));t.insertContent(a)},addVisual:function(e){}},selection:{getContent:function(n,r){if("html"===n||"tree"===n){var o=t.getSelectedContent(),i=Cm({});return rv(e,o),"tree"===n?o:i.serialize(o)}return ov(e).selection.getContent(n,r)}},raw:{getModel:function(){return k.some(t.getRawModel())}}}},av=function(e){return he(e.plugins,"rtc")},cv=function(e){return e.rtcInstance?e.rtcInstance:ov(e)},uv=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},lv=function(e,t){return void 0===t&&(t={}),function(e,t,n){return uv(e).selection.getContent(t,n)}(e,t.format?t.format:"html",t)},sv=function(e){return 0===e.dom.length?(Zt(e),k.none()):k.some(e)},fv=function(e,t,n,r){e.bind((function(e){return(r?Op:Rp)(e.dom,r?e.dom.length:0),t.filter(Tt).map((function(t){return function(e,t,n,r){var o=e.dom,i=t.dom,a=r?o.length:i.length;r?(Dp(o,i,!1,!r),n.setStart(i,a)):(Dp(i,o,!1,!r),n.setEnd(i,a))}(e,t,n,r)}))})).orThunk((function(){return function(e,t){return e.filter((function(e){return Nf.isBookmarkNode(e.dom)})).bind(t?It:Dt)}(t,r).or(t).filter(Tt).map((function(e){return function(e,t){Ot(e).each((function(n){var r=e.dom;t&&Cp(n,lu(r,0))?Rp(r,0):!t&&xp(n,lu(r,r.length))&&Op(r,r.length)}))}(e,r)}))}))},dv=function(e,t,n){void 0===n&&(n={});var r=function(e,t){return Ee(Ee({format:"html"},e),{set:!0,selection:!0,content:t})}(n,t);if(r.no_events||!(r=e.fire("BeforeSetContent",r)).isDefaultPrevented()){n.content=function(e,t){if("raw"!==t.format){var n=e.selection.getRng(),r=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=r?{context:r.nodeName.toLowerCase()}:{},i=e.parser.parse(t.content,Ee(Ee({isRootContent:!0,forced_root_block:!1},o),t));return Cm({validate:e.validate},e.schema).serialize(i)}return t.content}(e,r);var o=e.selection.getRng();!function(e,t){var n=k.from(t.firstChild).map(pt.fromDom),r=k.from(t.lastChild).map(pt.fromDom);e.deleteContents(),e.insertNode(t);var o=n.bind(Dt).filter(Tt).bind(sv),i=r.bind(It).filter(Tt).bind(sv);fv(o,n,e,!0),fv(i,r,e,!1),e.collapse(!1)}(o,o.createContextualFragment(n.content)),e.selection.setRng(o),bd(e,o),r.no_events||e.fire("SetContent",r)}else e.fire("SetContent",r)},mv=function(e,t,n){if(e&&e.hasOwnProperty(t)){var r=$(e[t],(function(e){return e!==n}));0===r.length?delete e[t]:e[t]=r}};var pv=function(e){return!!e.select},gv=function(e){return!(!e||!e.ownerDocument)&&wt(pt.fromDom(e.ownerDocument),pt.fromDom(e))},hv=function(e,t,n,r){var o,i,a=function(e,t){var n,r;return{selectorChangedWithUnbind:function(o,i){return n||(n={},r={},t.on("NodeChange",(function(t){var o=t.element,i=e.getParents(o,null,e.getRoot()),a={};dt.each(n,(function(t,n){dt.each(i,(function(o){if(e.is(o,n))return r[n]||(dt.each(t,(function(e){e(!0,{node:o,selector:n,parents:i})})),r[n]=t),a[n]=t,!1}))})),dt.each(r,(function(e,t){a[t]||(delete r[t],dt.each(e,(function(e){e(!1,{node:o,selector:t,parents:i})})))}))}))),n[o]||(n[o]=[]),n[o].push(i),{unbind:function(){mv(n,o,i),mv(r,o,i)}}}}}(e,r).selectorChangedWithUnbind,c=function(e,t){return dv(r,e,t)},u=function(e){var t=s();t.collapse(!!e),f(t)},l=function(){return t.getSelection?t.getSelection():t.document.selection},s=function(){var n,a,c,u=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}};if(!t)return null;var s=t.document;if(null==s)return null;if(void 0!==r.bookmark&&!1===Jd(r)){var f=Md(r);if(f.isSome())return f.map((function(e){return nm(r,[e])[0]})).getOr(s.createRange())}try{(n=l())&&!mn(n.anchorNode)&&(a=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():s.createRange(),a=nm(r,[a])[0])}catch(e){}return a||(a=s.createRange?s.createRange():s.body.createTextRange()),a.setStart&&9===a.startContainer.nodeType&&a.collapsed&&(c=e.getRoot(),a.setStart(c,0),a.setEnd(c,0)),o&&i&&(0===u(a.START_TO_START,a,o)&&0===u(a.END_TO_END,a,o)?a=i:(o=null,i=null)),a},f=function(e,t){var n;if(function(e){return!!e&&(!!pv(e)||gv(e.startContainer)&&gv(e.endContainer))}(e)){var a=pv(e)?e:null;if(a){i=null;try{a.select()}catch(e){}}else{var c=l();if(e=r.fire("SetSelectionRange",{range:e,forward:t}).range,c){i=e;try{c.removeAllRanges(),c.addRange(e)}catch(e){}!1===t&&c.extend&&(c.collapse(e.endContainer,e.endOffset),c.extend(e.startContainer,e.startOffset)),o=c.rangeCount>0?c.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!c.setBaseAndExtent||ct.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(c.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),c.anchorNode===e.startContainer&&c.focusNode===e.endContainer||c.setBaseAndExtent(n,0,n,1)),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},d=function(){var t=l(),n=null==t?void 0:t.anchorNode,r=null==t?void 0:t.focusNode;if(!t||!n||!r||mn(n)||mn(r))return!0;var o=e.createRng();o.setStart(n,t.anchorOffset),o.collapse(!0);var i=e.createRng();return i.setStart(r,t.focusOffset),i.collapse(!0),o.compareBoundaryPoints(o.START_TO_START,i)<=0},m={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:r,collapse:u,setCursorLocation:function(t,n){var o=e.createRng();t?(o.setStart(t,n),o.setEnd(t,n),f(o),u(!1)):(vf(e,o,r.getBody(),!0),f(o))},getContent:function(e){return lv(r,e)},setContent:c,getBookmark:function(e,t){return p.getBookmark(e,t)},moveToBookmark:function(e){return p.moveToBookmark(e)},select:function(t,n){return function(e,t,n){return k.from(t).map((function(t){var r=e.nodeIndex(t),o=e.createRng();return o.setStart(t.parentNode,r),o.setEnd(t.parentNode,r+1),n&&(vf(e,o,t,!0),vf(e,o,t,!1)),o}))}(e,t,n).each(f),t},isCollapsed:function(){var e=s(),t=l();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:d,setNode:function(t){return c(e.getOuterHTML(t)),t},getNode:function(){return function(e,t){var n,r,o;if(!t)return e;r=t.startContainer,o=t.endContainer;var i=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(r===o&&a-i<2&&r.hasChildNodes()&&(n=r.childNodes[i]),3===r.nodeType&&3===o.nodeType&&(r=r.length===i?tm(r.nextSibling,!0):r.parentNode,o=0===a?tm(o.previousSibling,!1):o.parentNode,r&&r===o))?r:n&&3===n.nodeType?n.parentNode:n}(r.getBody(),s())},getSel:l,setRng:f,getRng:s,getStart:function(e){return Zd(r.getBody(),s(),e)},getEnd:function(e){return em(r.getBody(),s(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,r){var o,i=[],a=e.getRoot();if(n=e.getParent(n||Zd(a,t,t.collapsed),e.isBlock),r=e.getParent(r||em(a,t,t.collapsed),e.isBlock),n&&n!==a&&i.push(n),n&&r&&n!==r){o=n;for(var c=new Tr(n,a);(o=c.next())&&o!==r;)e.isBlock(o)&&i.push(o)}return r&&n!==r&&r!==a&&i.push(r),i}(e,s(),t,n)},normalize:function(){var t=s(),n=l();if(!(sf(n).length>1)&&bf(r)){var o=$f(e,t);return o.each((function(e){f(e,d())})),o.getOr(t)}return t},selectorChanged:function(e,t){return a(e,t),m},selectorChangedWithUnbind:a,getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){return function(e,t,n){(e.inline?gd:vd)(e,t,n)}(r,e,t)},placeCaretAt:function(e,t){return f(Mf(e,t,r.getDoc()))},getBoundingClientRect:function(){var e=s();return e.collapsed?lu.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=o=i=null,g.destroy()}},p=Nf(m),g=Pf(m,r);return m.bookmarkManager=p,m.controlSelection=g,m},vv=function(e,t,n){e.addNodeFilter("font",(function(e){q(e,(function(e){var r=t.parse(e.attr("style")),o=e.attr("color"),i=e.attr("face"),a=e.attr("size");o&&(r.color=o),i&&(r["font-family"]=i),a&&(r["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(r)),function(e,t){q(t,(function(t){e.attr(t,null)}))}(e,["color","face","size"])}))}))},bv=function(e,t){var n=li();t.convert_fonts_to_spans&&vv(e,n,dt.explode(t.font_size_legacy_values)),function(e,t){e.addNodeFilter("strike",(function(e){q(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through",e.name="span",e.attr("style",t.serialize(n))}))}))}(e,n)},yv=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},wv=function(e,t){var n;try{n=atob(t)}catch(e){return k.none()}for(var r=new Uint8Array(n.length),o=0;o<r.length;o++)r[o]=n.charCodeAt(o);return k.some(new Blob([r],{type:e}))},Cv=function(e){return 0===e.indexOf("blob:")?function(e){return new hr((function(t,n){var r=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===this.status?t(this.response):r()},o.onerror=r,o.send()}catch(e){r()}}))}(e):0===e.indexOf("data:")?(t=e,new hr((function(e){var n=yv(t),r=n.type,o=n.data;wv(r,o).fold((function(){return e(new Blob([]))}),e)}))):null;var t},xv=0,kv=function(e){return(e||"blobid")+xv++},Sv=function(e,t,n,r){var o,i;if(0!==t.src.indexOf("blob:")){var a=yv(t.src),c=a.data,u=a.type;o=c,(i=e.getByData(o,u))?n({image:t,blobInfo:i}):Cv(t.src).then((function(r){i=e.create(kv(),r,o),e.add(i),n({image:t,blobInfo:i})}),(function(e){r(e)}))}else(i=e.getByUri(t.src))?n({image:t,blobInfo:i}):Cv(t.src).then((function(r){(function(e){return new hr((function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))})(r).then((function(a){o=yv(a).data,i=e.create(kv(),r,o),e.add(i),n({image:t,blobInfo:i})}))}),(function(e){r(e)}))};function Tv(e,t){var n={};return{findAll:function(r,o){o||(o=y);var i=$(function(e){return e?oe(e.getElementsByTagName("img")):[]}(r),(function(t){var n=t.src;return!!ct.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===ct.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n)&&o(t):0===n.indexOf("data:")&&o(t)))))})),a=W(i,(function(e){if(void 0!==n[e.src])return new hr((function(t){n[e.src].then((function(n){if("string"==typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var r=new hr((function(n,r){Sv(t,e,n,r)})).then((function(e){return delete n[e.image.src],e})).catch((function(t){return delete n[e.src],t}));return n[e.src]=r,r}));return hr.all(a)}}}var Ev,_v,Av=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new bm("br",1)).shortEnded=!0:r.empty().append(new bm("#text",3)).value=" "},Nv=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},Rv=function(e,t,n,r){return r.isEmpty(t,n,(function(t){return function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty}(e,t)}))},Ov=function(e,t){var n=t.blob_cache,r=function(e){var r=e.attr("src");(function(e){return e.attr("src")===ct.transparentSrc||e.attr("data-mce-placeholder")})(e)||function(e){return e.attr("data-mce-bogus")}(e)||function(e){var t=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(e);return t?k.some({type:t[1],data:decodeURIComponent(t[2])}):k.none()}(r).filter((function(){return function(e,t){if(t.images_dataimg_filter){var n=new Image;return n.src=e.attr("src"),ce(e.attributes.map,(function(e,t){n.setAttribute(t,e)})),t.images_dataimg_filter(n)}return!0}(e,t)})).bind((function(e){var t=e.type,r=e.data;return k.from(n.getByData(r,t)).orThunk((function(){return wv(t,r).map((function(e){var t=n.create(kv(),e,r);return n.add(t),t}))}))})).each((function(t){e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(function(e){return q(e,r)}))},Dv=dt.makeMap,Iv=dt.each,Pv=dt.explode,Bv=dt.extend,Mv=function(e,t){void 0===t&&(t=qo());var n={},r=[],o={},i={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var a=function(e){var t,a,c;(a=e.name)in n&&((c=o[a])?c.push(e):o[a]=[e]),t=r.length;for(;t--;)(a=r[t].name)in e.attributes.map&&((c=i[a])?c.push(e):i[a]=[e]);return e},c={schema:t,addAttributeFilter:function(e,t){Iv(Pv(e),(function(e){var n;for(n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})}))},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(e,t){Iv(Pv(e),(function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)}))},getNodeFilters:function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:a,parse:function(c,u){var l,s,f,d,m,p,g,h,v,b=[];u=u||{},o={},i={};var y=Bv(Dv("script,style,head,html,body,title,meta,param"),t.getBlockElements()),w=t.getNonEmptyElements(),C=t.children,x=e.validate,k=function(e){return!1===e?"":!0===e?"p":e}("forced_root_block"in u?u.forced_root_block:e.forced_root_block),S=t.getWhiteSpaceElements(),T=/^[ \t\r\n]+/,E=/[ \t\r\n]+$/,_=/[ \t\r\n]+/g,A=/^[ \t\r\n]+$/;h=S.hasOwnProperty(u.context)||S.hasOwnProperty(e.root_name);var N=function(e,t){var r,i=new bm(e,t);return e in n&&((r=o[e])?r.push(i):o[e]=[i]),i},R=function(e){var n,r,o,i,a=t.getBlockElements();for(n=e.prev;n&&3===n.type;){if((o=n.value.replace(E,"")).length>0)return void(n.value=o);if(r=n.next){if(3===r.type&&r.value.length){n=n.prev;continue}if(!a[r.name]&&"script"!==r.name&&"style"!==r.name){n=n.prev;continue}}i=n.prev,n.remove(),n=i}},O=Am({validate:x,allow_html_data_urls:e.allow_html_data_urls,allow_svg_data_urls:e.allow_svg_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(t.getSelfClosingElements()),cdata:function(e){v.append(N("#cdata",4)).value=e},text:function(e,t){var n;h||(e=e.replace(_," "),function(e,t){return e&&(t[e.name]||"br"===e.name)}(v.lastChild,y)&&(e=e.replace(T,""))),0!==e.length&&((n=N("#text",3)).raw=!!t,v.append(n).value=e)},comment:function(e){v.append(N("#comment",8)).value=e},pi:function(e,t){v.append(N(e,7)).value=t,R(v)},doctype:function(e){v.append(N("#doctype",10)).value=e,R(v)},start:function(e,n,o){var a,c,u,l,s=x?t.getElementRule(e):{};if(s){for((a=N(s.outputName||e,1)).attributes=n,a.shortEnded=o,v.append(a),(l=C[v.name])&&C[a.name]&&!l[a.name]&&b.push(a),c=r.length;c--;)(u=r[c].name)in n.map&&((p=i[u])?p.push(a):i[u]=[a]);y[e]&&R(a),o||(v=a),!h&&S[e]&&(h=!0)}},end:function(n){var r,o,i,a,c=x?t.getElementRule(n):{};if(c){if(y[n]&&!h){if((r=v.firstChild)&&3===r.type)if((o=r.value.replace(T,"")).length>0)r.value=o,r=r.next;else for(i=r.next,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.next,(0===o.length||A.test(o))&&(r.remove(),r=i),r=i;if((r=v.lastChild)&&3===r.type)if((o=r.value.replace(E,"")).length>0)r.value=o,r=r.prev;else for(i=r.prev,r.remove(),r=i;r&&3===r.type;)o=r.value,i=r.prev,(0===o.length||A.test(o))&&(r.remove(),r=i),r=i}if(h&&S[n]&&(h=!1),c.removeEmpty&&Rv(t,w,S,v))return a=v.parent,y[v.name]?v.empty().remove():v.unwrap(),void(v=a);c.paddEmpty&&(function(e){return Nv(e,"#text")&&" "===e.firstChild.value}(v)||Rv(t,w,S,v))&&Av(e,u,y,v),v=v.parent}}},t),D=v=new bm(u.context||e.root_name,11);if(O.parse(c,u.format),x&&b.length&&(u.context?u.invalid=!0:function(e){var n,r,o,i,c,u,l,s,f,d,m,p=Dv("tr,td,th,tbody,thead,tfoot,table"),g=t.getNonEmptyElements(),h=t.getWhiteSpaceElements(),v=t.getTextBlockElements(),b=t.getSpecialElements();for(n=0;n<e.length;n++)if((r=e[n]).parent&&!r.fixed)if(v[r.name]&&"li"===r.parent.name){for(d=r.next;d&&v[d.name];)d.name="li",d.fixed=!0,r.parent.insert(d,r.parent),d=d.next;r.unwrap(r)}else{for(i=[r],o=r.parent;o&&!t.isValidChild(o.name,r.name)&&!p[o.name];o=o.parent)i.push(o);if(o&&i.length>1){for(i.reverse(),c=u=a(i[0].clone()),f=0;f<i.length-1;f++){for(t.isValidChild(u.name,i[f].name)?(l=a(i[f].clone()),u.append(l)):l=u,s=i[f].firstChild;s&&s!==i[f+1];)m=s.next,l.append(s),s=m;u=l}Rv(t,g,h,c)?o.insert(r,i[0],!0):(o.insert(c,i[0],!0),o.insert(r,c)),o=i[0],(Rv(t,g,h,o)||Nv(o,"br"))&&o.empty().remove()}else if(r.parent){if("li"===r.name){if((d=r.prev)&&("ul"===d.name||"ol"===d.name)){d.append(r);continue}if((d=r.next)&&("ul"===d.name||"ol"===d.name)){d.insert(r,d.firstChild,!0);continue}r.wrap(a(new bm("ul",1)));continue}t.isValidChild(r.parent.name,"div")&&t.isValidChild("div",r.name)?r.wrap(a(new bm("div",1))):b[r.name]?r.empty().remove():r.unwrap()}}}(b)),k&&("body"===D.name||u.isRootContent)&&function(){var n,r,o=D.firstChild,i=function(e){e&&((o=e.firstChild)&&3===o.type&&(o.value=o.value.replace(T,"")),(o=e.lastChild)&&3===o.type&&(o.value=o.value.replace(E,"")))};if(t.isValidChild(D.name,k.toLowerCase())){for(;o;)n=o.next,3===o.type||1===o.type&&"p"!==o.name&&!y[o.name]&&!o.attr("data-mce-type")?(r||((r=N(k,1)).attr(e.forced_root_block_attrs),D.insert(r,o)),r.append(o)):(i(r),r=null),o=n;i(r)}}(),!u.invalid){for(g in o)if(o.hasOwnProperty(g)){for(p=n[g],d=(l=o[g]).length;d--;)l[d].parent||l.splice(d,1);for(s=0,f=p.length;s<f;s++)p[s](l,g,u)}for(s=0,f=r.length;s<f;s++)if((p=r[s]).name in i){for(d=(l=i[p.name]).length;d--;)l[d].parent||l.splice(d,1);for(d=0,m=p.callbacks.length;d<m;d++)p.callbacks[d](l,p.name,u)}}return D}};return function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,r,o){var i,a,c,u,l,s,f,d,m=e.length,p=dt.extend({},n.getBlockElements()),g=n.getNonEmptyElements(),h=n.getWhiteSpaceElements();for(p.body=1,i=0;i<m;i++)if(c=(a=e[i]).parent,p[a.parent.name]&&a===c.lastChild){for(l=a.prev;l;){if("span"!==(s=l.name)||"bookmark"!==l.attr("data-mce-type")){"br"===s&&(a=null);break}l=l.prev}a&&(a.remove(),Rv(n,g,h,c)&&(f=n.getElementRule(c.name))&&(f.removeEmpty?c.remove():f.paddEmpty&&Av(t,o,p,c)))}else{for(u=a;c&&c.firstChild===u&&c.lastChild===u&&(u=c,!p[c.name]);)c=c.parent;u===c&&!0!==t.padd_empty_with_br&&((d=new bm("#text",3)).value=" ",a.replace(d))}})),e.addAttributeFilter("href",(function(e){var n,r,o=e.length;if(!t.allow_unsafe_link_target)for(;o--;){var i=e[o];"a"===i.name&&"_blank"===i.attr("target")&&i.attr("rel",(n=i.attr("rel"),r=void 0,r=n?dt.trim(n):"",/\b(noopener)\b/g.test(r)?r:function(e){return e.split(" ").filter((function(e){return e.length>0})).concat(["noopener"]).sort().join(" ")}(r)))}})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){for(var t,n,r,o,i=e.length;i--;)if("a"===(o=e[i]).name&&o.firstChild&&!o.attr("href")){r=o.parent,t=o.lastChild;do{n=t.prev,r.insert(t,o),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){for(var t,n,r=e.length;r--;)if("ul"===(n=(t=e[r]).parent).name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var o=new bm("li",1);o.attr("style","list-style-type: none"),t.wrap(o)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){for(var t,r,o,i,a,c,u,l=e.length,s=n.getValidClasses();l--;){for(r=(t=e[l]).attr("class").split(" "),a="",o=0;o<r.length;o++)i=r[o],u=!1,(c=s["*"])&&c[i]&&(u=!0),c=s[t.name],!u&&c&&c[i]&&(u=!0),u&&(a&&(a+=" "),a+=i);a.length||(a=null),t.attr("class",a)}})),Ov(e,t)}(c,e),function(e,t){t.inline_styles&&bv(e,t)}(c,e),c},Lv=function(e,t,n){return function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events}(e,n)?function(e,t,n){var r,o,i=e.dom;t=t.cloneNode(!0);var a=document.implementation;return a.createHTMLDocument&&(r=a.createHTMLDocument(""),dt.each("BODY"===t.nodeName?t.childNodes:[t],(function(e){r.body.appendChild(r.importNode(e,!0))})),t="BODY"!==t.nodeName?r.body.firstChild:r.body,o=i.doc,i.doc=r),function(e,t){e.fire("PreProcess",t)}(e,Ee(Ee({},n),{node:t})),o&&(i.doc=o),t}(e,t,n):t},Fv=function(e,t,n){-1===dt.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),t.push(n))},jv=function(e,t,n,r,o){return function(e,t,n){return!t.no_events&&e?function(e,t){return e.fire("PostProcess",t)}(e,Ee(Ee({},t),{content:n})).content:n}(e,o,function(e,t,n){return Cm(e,t).serialize(n)}(t,n,r))},Hv=function(e,t){var n=["data-mce-selected"],r=t&&t.dom?t.dom:Ka.DOM,o=t&&t.schema?t.schema:qo(e);e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs;var i=Mv(e,o);!function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){for(var n,r=e.length;r--;)(n=e[r]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)})),e.addAttributeFilter("src,href,style",(function(e,r){for(var o,i,a=e.length,c="data-mce-"+r,u=t.url_converter,l=t.url_converter_scope;a--;)void 0!==(i=(o=e[a]).attr(c))?(o.attr(r,i.length>0?i:null),o.attr(c,null)):(i=o.attr(r),"style"===r?i=n.serializeStyle(n.parseStyle(i),o.name):u&&(i=u.call(l,i,r,o.name)),o.attr(r,i.length>0?i:null))})),e.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)(n=(t=e[r]).attr("class"))&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",n.length>0?n:null))})),e.addAttributeFilter("data-mce-type",(function(e,t,n){for(var r,o=e.length;o--;){if("bookmark"===(r=e[o]).attr("data-mce-type")&&!n.cleanup)k.from(r.firstChild).exists((function(e){return!Lr(e.value)}))?r.unwrap():r.remove()}})),e.addNodeFilter("noscript",(function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=Po.decode(t.value))})),e.addNodeFilter("script,style",(function(e,n){for(var r,o,i,a=e.length,c=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};a--;)o=(r=e[a]).firstChild?r.firstChild.value:"","script"===n?((i=r.attr("type"))&&r.attr("type","mce-no/type"===i?null:i.replace(/^mce\-/,"")),"xhtml"===t.element_format&&o.length>0&&(r.firstChild.value="// <![CDATA[\n"+c(o)+"\n// ]]>")):"xhtml"===t.element_format&&o.length>0&&(r.firstChild.value="\x3c!--\n"+c(o)+"\n--\x3e")})),e.addNodeFilter("#comment",(function(e){for(var r,o=e.length;o--;)r=e[o],t.preserve_cdata&&0===r.value.indexOf("[CDATA[")?(r.name="#cdata",r.type=4,r.value=n.decode(r.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===r.value.indexOf("mce:protected ")&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(r.value).substr(14))})),e.addNodeFilter("xml:namespace,input",(function(e,t){for(var n,r=e.length;r--;)7===(n=e[r]).type?n.remove():1===n.type&&("input"!==t||n.attr("type")||n.attr("type","text"))})),e.addAttributeFilter("data-mce-type",(function(t){q(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}))}(i,e,r);return{schema:o,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:function(n,a){void 0===a&&(a={});var c=Ee({format:"html"},a),u=Lv(t,n,c),l=function(e,t,n){var r=Fr(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Mr(pt.fromDom(t))?r:dt.trim(r)}(r,u,c),s=function(e,t,n){var r=n.selection?Ee({forced_root_block:!1},n):n,o=e.parse(t,r);return function(e){var t=function(e){return e&&"br"===e.name},n=e.lastChild;if(t(n)){var r=n.prev;t(r)&&(n.remove(),r.remove())}}(o),o}(i,l,c);return"tree"===c.format?s:jv(t,e,o,s,c)},addRules:function(e){o.addValidElements(e)},setRules:function(e){o.setValidElements(e)},addTempAttr:p(Fv,i,n),getTempAttrs:function(){return n},getNodeFilters:i.getNodeFilters,getAttributeFilters:i.getAttributeFilters}},Uv=function(e,t){var n=Hv(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters}},zv=function(e,t){return void 0===t&&(t={}),function(e,t,n){return cv(e).editor.getContent(t,n)}(e,t,t.format?t.format:"html")},Wv=function(e,t,n){return void 0===n&&(n={}),function(e,t,n){return cv(e).editor.setContent(t,n)}(e,t,n)},qv=Ka.DOM,Vv=function(e){return k.from(e).each((function(e){return e.destroy()}))},$v=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),o=e.getElement();r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&qv.remove(o.nextSibling),function(e){e.fire("remove")}(e),e.editorManager.remove(e),!e.inline&&r&&function(e){qv.setStyle(e.id,"display",e.orgDisplay)}(e),function(e){e.fire("detach")}(e),qv.remove(e.getContainer()),Vv(t),Vv(n),e.destroy()}},Kv=function(e,t){var n=e.selection,r=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),Vv(n),Vv(r)),function(e){var t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),qv.unbind(t,"submit reset",e.formEventDelegate))}(e),function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)}(e),e.destroyed=!0):e.remove())},Jv=Object.prototype.hasOwnProperty,Gv=(Ev=function(e,t){return A(e)&&A(t)?Gv(e,t):t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)Jv.call(o,i)&&(n[i]=Ev(n[i],o[i]))}return n}),Xv=Qe().deviceType,Yv=Xv.isTouch(),Qv=Xv.isPhone(),Zv=Xv.isTablet(),eb=["lists","autolink","autosave"],tb={table_grid:!1,object_resizing:!1,resize:!1},nb=function(e){var t=N(e)?e.join(" "):e,n=W(_(t)?t.split(" "):[],Le);return $(n,(function(e){return e.length>0}))},rb=function(e,t){var n=de(t,(function(t,n){return U(e,n)}));return function(e,t){return{sections:d(e),settings:d(t)}}(n.t,n.f)},ob=function(e,t){return e.sections().hasOwnProperty(t)},ib=function(e,t){return ge(e,"toolbar_mode").orThunk((function(){return ge(e,"toolbar_drawer").map((function(e){return!1===e?"wrap":e}))})).getOr(t)},ab=function(e,t){var n={resize:!1,toolbar_mode:ib(e,"scrolling"),toolbar_sticky:!1};return Ee(Ee(Ee({},tb),n),t?{menubar:!1}:{})},cb=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?dt.extend({},e.external_plugins,n):n},ub=function(e,t,n,r){return e&&function(e,t,n){var r=e.sections();return ob(e,t)&&r[t].theme===n}(t,"mobile","mobile")?$(r,p(U,eb)):e&&ob(t,"mobile")?r:n},lb=function(e,t,n,r){var o=nb(n.forced_plugins),i=nb(r.plugins),a=function(e,t){return ob(e,t)?e.sections()[t]:{}}(t,"mobile"),c=a.plugins?nb(a.plugins):i,u=function(e,t){return[].concat(nb(e)).concat(nb(t))}(o,ub(e,t,i,c));if(ct.browser.isIE()&&U(u,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return dt.extend(r,{plugins:u.join(" ")})},sb=function(e,t,n,r,o){var i=e?{mobile:ab(o.mobile||{},t)}:{},a=rb(["mobile"],Gv(i,o)),c=dt.extend(n,r,a.settings(),function(e,t){return e&&ob(t,"mobile")}(e,a)?function(e,t,n){void 0===n&&(n={});var r=e.sections(),o=r.hasOwnProperty(t)?r[t]:{};return dt.extend({},n,o)}(a,"mobile"):{},{validate:!0,external_plugins:cb(r,a.settings())});return lb(e,a,r,c)},fb=function(e,t,n,r,o){var i=function(e,t,n,r,o){var i={id:t,theme:"silver",toolbar_mode:ib(e,"floating"),plugins:"",document_base_url:n,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:o.convertURL,url_converter_scope:o};return Ee(Ee({},i),r?tb:{})}(o,t,n,Yv,e);return sb(Qv||Zv,Qv,i,r,o)},db=function(e,t,n){return k.from(t.settings[n]).filter(e)},mb=function(e,t,n,r){var o,i=t in e.settings?e.settings[t]:n;return"hash"===r?function(e){var t={};return"string"==typeof e?q(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[dt.trim(n[0])]=dt.trim(n[1]):t[dt.trim(n[0])]=dt.trim(n[0])})):t=e,t}(i):"string"===r?db(_,e,t).getOr(n):"number"===r?db(M,e,t).getOr(n):"boolean"===r?db(O,e,t).getOr(n):"object"===r?db(A,e,t).getOr(n):"array"===r?db(N,e,t).getOr(n):"string[]"===r?db((o=_,function(e){return N(e)&&Q(e,o)}),e,t).getOr(n):"function"===r?db(B,e,t).getOr(n):i},pb=(_v={},{add:function(e,t){_v[e]=t},get:function(e){return _v[e]?_v[e]:{icons:{}}},has:function(e){return he(_v,e)}}),gb=function(e,t){return t.dom[e]},hb=function(e,t){return parseInt(Hn(t,e),10)},vb=p(gb,"clientWidth"),bb=p(gb,"clientHeight"),yb=p(hb,"margin-top"),wb=p(hb,"margin-left"),Cb=function(e,t,n){var r,o=pt.fromDom(e.getBody()),i=e.inline?o:(r=o,pt.fromDom(Nt(r).dom.documentElement)),a=function(e,t,n,r){var o=function(e){return e.dom.getBoundingClientRect()}(t);return{x:n-(e?o.left+t.dom.clientLeft+wb(t):0),y:r-(e?o.top+t.dom.clientTop+yb(t):0)}}(e.inline,i,t,n);return function(e,t,n){var r=vb(e),o=bb(e);return t>=0&&n>=0&&t<=r&&n<=o}(i,a.x,a.y)},xb=function(e){var t,n=e.inline?e.getBody():e.getContentAreaContainer();return(t=n,k.from(t).map(pt.fromDom)).map(tn).getOr(!1)};function kb(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:t,reposition:t,getArgs:t}},r=function(){return k.from(t[0])},o=function(){t.length>0&&n().reposition(t)},i=function(e){X(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))},a=function(a,c){if(void 0===c&&(c=!0),!e.removed&&xb(e))return c&&e.fire("BeforeOpenNotification",{notification:a}),G(t,(function(e){return t=n().getArgs(e),r=a,!(t.type!==r.type||t.text!==r.text||t.progressBar||t.timeout||r.progressBar||r.timeout);var t,r})).getOrThunk((function(){e.editorManager.setActive(e);var c=n().open(a,(function(){i(c),o(),r().fold((function(){return e.focus()}),(function(e){return pt.fromDom(e.getEl()).dom.focus()}))}));return function(e){t.push(e)}(c),o(),e.fire("OpenNotification",Ee({},c)),c}))};return function(e){e.on("SkinLoaded",(function(){var t=function(e){return e.getParam("service_message")}(e);t&&a({text:t,type:"warning",timeout:0},!1)})),e.on("ResizeEditor ResizeWindow NodeChange",(function(){wr.requestAnimationFrame(o)})),e.on("remove",(function(){q(t.slice(),(function(e){n().close(e)}))}))}(e),{open:a,close:function(){r().each((function(e){n().close(e),i(e),o()}))},getNotifications:function(){return t}}}var Sb=oc.PluginManager,Tb=oc.ThemeManager;var Eb=function(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:t=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:t,alert:t,confirm:t,close:t,getParams:t,setParams:t}},r=function(e,t){return function(){return t?t.apply(e,arguments):void 0}},o=function(n){t.push(n),function(t){e.fire("OpenWindow",{dialog:t})}(n)},i=function(n){!function(t){e.fire("CloseWindow",{dialog:t})}(n),0===(t=$(t,(function(e){return e!==n}))).length&&e.focus()},a=function(t){e.editorManager.setActive(e),Bd(e);var n=t();return o(n),n};return e.on("remove",(function(){q(t,(function(e){n().close(e)}))})),{open:function(e,t){return a((function(){return n().open(e,t,i)}))},openUrl:function(e){return a((function(){return n().openUrl(e,i)}))},alert:function(e,t,o){n().alert(e,r(o||this,t))},confirm:function(e,t,o){n().confirm(e,r(o||this,t))},close:function(){k.from(t[t.length-1]).each((function(e){n().close(e),i(e)}))}}},_b=function(e,t){e.notificationManager.open({type:"error",text:t})},Ab=function(e,t){e._skinLoaded?_b(e,t):e.on("SkinLoaded",(function(){_b(e,t)}))},Nb=function(e,t,n){!function(e,t,n){e.fire(t,n)}(e,t,{message:n}),console.error(n)},Rb=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},Ob=function(e,t,n){Nb(e,"PluginLoadError",Rb("plugin",t,n))},Db=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,_e([e],t)):r.log.apply(r,_e([e],t)))},Ib=function(e){var t=function(e){var t=e.getParam("content_css");return _(t)?W(t.split(","),Le):N(t)?t:!1===t||e.inline?[]:["default"]}(e),n=e.editorManager.baseURL+"/skins/content",r="content"+e.editorManager.suffix+".css",o=!0===e.inline;return W(t,(function(t){return function(e){return/^[a-z0-9\-]+$/i.test(e)}(t)&&!o?n+"/"+t+"/"+r:e.documentBaseURI.toAbsolute(t)}))};function Pb(e,t){var n={},r=function(e,n,r,o){var i=new XMLHttpRequest;i.open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=function(e){o(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){if(i.status<200||i.status>=300)r("HTTP Error: "+i.status);else{var e,o,a=JSON.parse(i.responseText);if(a&&"string"==typeof a.location)n((e=t.basePath,o=a.location,e?e.replace(/\/$/,"")+"/"+o.replace(/^\//,""):o));else r("Invalid JSON: "+i.responseText)}};var a=new FormData;a.append("file",e.blob(),e.filename()),i.send(a)},o=function(e,t){return{url:t,blobInfo:e,status:!0}},i=function(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}},a=function(e,t){dt.each(n[e],(function(e){e(t)})),delete n[e]},c=function(r,c){return r=dt.grep(r,(function(t){return!e.isUploaded(t.blobUri())})),hr.all(dt.map(r,(function(r){return e.isPending(r.blobUri())?function(e){var t=e.blobUri();return new hr((function(e){n[t]=n[t]||[],n[t].push(e)}))}(r):function(t,n,r){return e.markPending(t.blobUri()),new hr((function(c){var u,l=function(){};try{var s=function(){u&&(u.close(),l)};n(t,(function(n){s(),e.markUploaded(t.blobUri(),n),a(t.blobUri(),o(t,n)),c(o(t,n))}),(function(n,r){var o=r||{};s(),e.removeFailed(t.blobUri()),a(t.blobUri(),i(t,n,o)),c(i(t,n,o))}),(function(e){e<0||e>100||(u||(u=r()),u.progressBar.value(e))}))}catch(e){c(i(t,e.message,{}))}}))}(r,t.handler,c)})))};return!1===B(t.handler)&&(t.handler=r),{upload:function(e,n){return t.url||t.handler!==r?c(e,n):new hr((function(e){e([])}))}}}var Bb=0,Mb=function(e){return e+Bb+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t},Lb=function(e){var t,n,r,o,i,a=function(){var e=[],t=function(e){if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var t,n=e.id||Mb("blobid"),r=e.name||n,o=e.blob;return{id:d(n),name:d(r),filename:d(e.filename||r+"."+(t=o.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[t.toLowerCase()]||"dat")),blob:d(o),base64:d(e.base64),blobUri:d(e.blobUri||URL.createObjectURL(o)),uri:d(e.uri)}},n=function(t){return G(e,t).getOrUndefined()},r=function(e){return n((function(t){return t.id()===e}))};return{create:function(e,n,r,o,i){if(_(e))return t({id:e,name:o,filename:i,blob:n,base64:r});if(A(e))return t(e);throw new Error("Unknown input type")},add:function(t){r(t.id())||e.push(t)},get:r,getByUri:function(e){return n((function(t){return t.blobUri()===e}))},getByData:function(e,t){return n((function(n){return n.base64()===e&&n.blob().type===t}))},findFirst:n,removeByUri:function(t){e=$(e,(function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)}))},destroy:function(){q(e,(function(e){URL.revokeObjectURL(e.blobUri())})),e=[]}}}(),c=(r={},o=function(e,t){return{status:e,resultUri:t}},{hasBlobUri:i=function(e){return e in r},getResultUri:function(e){var t=r[e];return t?t.resultUri:null},isPending:function(e){return!!i(e)&&1===r[e].status},isUploaded:function(e){return!!i(e)&&2===r[e].status},markPending:function(e){r[e]=o(1,null)},markUploaded:function(e,t){r[e]=o(2,t)},removeFailed:function(e){delete r[e]},destroy:function(){r={}}}),u=[],l=function(e){var t=Qa(null);e.on("change AddUndo",(function(e){t.set(Ee({},e.level))}));return{fireIfChanged:function(){var n=e.undoManager.data;re(n).filter((function(e){return!Qh(t.get(),e)})).each((function(t){e.setDirty(!0),e.fire("change",{level:t,lastLevel:te(n,n.length-2).getOrNull()})}))}}}(e),s=function(t){return function(n){return e.selection?t(n):[]}},f=function(e,t,n){var r=0;do{-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1)}while(-1!==r);return e},m=function(e,t,n){var r='src="'+n+'"'+(n===ct.transparentSrc?' data-mce-placeholder="1"':"");return e=f(e,'src="'+t+'"',r),e=f(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},p=function(t,n){q(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=W(e.fragments,(function(e){return m(e,t,n)})):e.content=m(e.content,t,n)}))},g=function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},h=function(n){return t||(t=Pb(c,{url:Hu(e),basePath:Uu(e),credentials:zu(e),handler:Wu(e)})),w().then(s((function(r){var o=W(r,(function(e){return e.blobInfo}));return t.upload(o,g).then(s((function(t){var o=[],i=W(t,(function(t,n){var i=r[n].blobInfo,c=r[n].image;return t.status&&function(e){return e.getParam("images_replace_blob_uris",!0,"boolean")}(e)?(a.removeByUri(c.src),function(t,n){var r,o=e.convertURL(n,"src");p(t.src,n),e.$(t).attr({src:Fu(e)?(r=n,r+(-1===r.indexOf("?")?"?":"&")+(new Date).getTime()):n,"data-mce-src":o})}(c,t.url)):t.error&&(t.error.options.remove&&(p(c.getAttribute("src"),ct.transparentSrc),o.push(c)),function(e,t){Ab(e,nc.translate(["Failed to upload image: {0}",t]))}(e,t.error.message)),{element:c,status:t.status,uploadUri:t.url,blobInfo:i}}));return i.length>0&&l.fireIfChanged(),o.length>0&&(av(e)?console.error("Removing images on failed uploads is currently unsupported for RTC"):e.undoManager.transact((function(){q(o,(function(t){e.dom.remove(t),a.removeByUri(t.src)}))}))),n&&n(i),i})))})))},v=function(t){if(Lu(e))return h(t)},b=function(t){return!1!==Q(u,(function(e){return e(t)}))&&(0!==t.getAttribute("src").indexOf("data:")||function(e){return e.getParam("images_dataimg_filter",y,"function")}(e)(t))},w=function(){return n||(n=Tv(c,a)),n.findAll(e.getBody(),b).then(s((function(t){return t=$(t,(function(t){return"string"!=typeof t||(Ab(e,t),!1)})),q(t,(function(e){p(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),t})))},C=function(t){return t.replace(/src="(blob:[^"]+)"/g,(function(t,n){var r=c.getResultUri(n);if(r)return'src="'+r+'"';var o=a.getByUri(n);return o||(o=J(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null)),o?'src="data:'+o.blob().type+";base64,"+o.base64()+'"':t}))};return e.on("SetContent",(function(){Lu(e)?v():w()})),e.on("RawSaveContent",(function(e){e.content=C(e.content)})),e.on("GetContent",(function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=C(e.content))})),e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){q(e,(function(e){var t=e.attr("src");if(!a.getByUri(t)){var n=c.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:a,addFilter:function(e){u.push(e)},uploadImages:h,uploadImagesAuto:v,scanForImages:w,destroy:function(){a.destroy(),c.destroy(),n=t=null}}};function Fb(e){var t={},n=function(e,r){e&&("string"!=typeof e?dt.each(e,(function(e,t){n(t,e)})):(N(r)||(r=[r]),dt.each(r,(function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))})),t[e]=r))};return n(function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]},{inline:"s",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return pn(e)&&e.hasAttribute("href")},onformat:function(t,n,r){dt.each(r,(function(n,r){e.setAttrib(t,r,n)}))}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return dt.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}})),t}(e.dom)),n(function(e){return e.getParam("formats")}(e)),{get:function(e){return e?t[e]:t},has:function(e){return he(t,e)},register:n,unregister:function(e){return e&&t[e]&&delete t[e],t}}}var jb,Hb=dt.each,Ub=Ka.DOM,zb=function(e,t){var n,r,o,i=t&&t.schema||qo({}),a=function(e){r="string"==typeof e?{name:e,classes:[],attrs:{}}:e;var t=Ub.create(r.name);return function(e,t){t.classes.length&&Ub.addClass(e,t.classes.join(" ")),Ub.setAttribs(e,t.attrs)}(t,r),t},c=function(e,t,n){var r,o,u=t.length>0&&t[0],l=u&&u.name,s=function(e,t){var n="string"!=typeof e?e.nodeName.toLowerCase():e,r=i.getElementRule(n),o=r&&r.parentsRequired;return!(!o||!o.length)&&(t&&-1!==dt.inArray(o,t)?t:o[0])}(e,l);if(s)l===s?(o=t[0],t=t.slice(1)):o=s;else if(u)o=t[0],t=t.slice(1);else if(!n)return e;return o&&(r=a(o)).appendChild(e),n&&(r||(r=Ub.create("div")).appendChild(e),dt.each(n,(function(t){var n=a(t);r.insertBefore(n,e)}))),c(r,t,o&&o.siblings)};return e&&e.length?(r=e[0],n=a(r),(o=Ub.create("div")).appendChild(c(n,e.slice(1),r.siblings)),o):""},Wb=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=dt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,r,o,i){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==dt.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}if("["===o){var a=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);a&&(n.attrs[a[1]]=a[2])}return""}))),n.name=t||"div",n},qb=function(e,t){var n,r,o,i="",a=function(e){var t=e.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");return _(t)?t:""}(e);if(""===a)return"";var c=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){var u=ge(t,"preview");if(u.is(!1))return"";a=u.getOr(a)}n=t.block||t.inline||"span";var l,s=(l=t.selector)&&"string"==typeof l?(l=(l=l.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),dt.map(l.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=dt.map(e.split(/(?:~\+|~|\+)/),Wb),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[];s.length?(s[0].name||(s[0].name=n),n=t.selector,r=zb(s,e)):r=zb([n],e);var f=Ub.select(n,r)[0]||r.firstChild;return Hb(t.styles,(function(e,t){var n=c(e);n&&Ub.setStyle(f,t,n)})),Hb(t.attributes,(function(e,t){var n=c(e);n&&Ub.setAttrib(f,t,n)})),Hb(t.classes,(function(e){var t=c(e);Ub.hasClass(f,t)||Ub.addClass(f,t)})),e.fire("PreviewFormats"),Ub.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r),o=Ub.getStyle(e.getBody(),"fontSize",!0),o=/px$/.test(o)?parseInt(o,10):0,Hb(a.split(" "),(function(t){var n=Ub.getStyle(f,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=Ub.getStyle(e.getBody(),t,!0),"#ffffff"===Ub.toHex(n).toLowerCase())||"color"===t&&"#000000"===Ub.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===o)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*o+"px"}"border"===t&&n&&(i+="padding:0 2px;"),i+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),Ub.remove(r),i},Vb=function(e){var t=Fb(e),n=Qa(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(e),zg(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,r){!function(e,t,n,r){uv(e).formatter.apply(t,n,r)}(e,t,n,r)},remove:function(t,n,r,o){!function(e,t,n,r,o){uv(e).formatter.remove(t,n,r,o)}(e,t,n,r,o)},toggle:function(t,n,r){!function(e,t,n,r){uv(e).formatter.toggle(t,n,r)}(e,t,n,r)},match:function(t,n,r){return function(e,t,n,r){return uv(e).formatter.match(t,n,r)}(e,t,n,r)},closest:function(t){return function(e,t){return uv(e).formatter.closest(t)}(e,t)},matchAll:function(t,n){return function(e,t,n){return uv(e).formatter.matchAll(t,n)}(e,t,n)},matchNode:function(t,n,r,o){return function(e,t,n,r,o){return uv(e).formatter.matchNode(t,n,r,o)}(e,t,n,r,o)},canApply:function(t){return function(e,t){return uv(e).formatter.canApply(t)}(e,t)},formatChanged:function(t,r,o){return function(e,t,n,r,o){return void 0===o&&(o=!1),uv(e).formatter.formatChanged(t,n,r,o)}(e,n,t,r,o)},getCssText:p(qb,e)}},$b=function(e){var t=Qa(k.none()),n=Qa(0),r=Qa(0),o={data:[],typing:!1,beforeChange:function(){!function(e,t,n){uv(e).undoManager.beforeChange(t,n)}(e,n,t)},add:function(i,a){return function(e,t,n,r,o,i,a){return uv(e).undoManager.addUndoLevel(t,n,r,o,i,a)}(e,o,r,n,t,i,a)},undo:function(){return function(e,t,n,r){return uv(e).undoManager.undo(t,n,r)}(e,o,n,r)},redo:function(){return function(e,t,n){return uv(e).undoManager.redo(t,n)}(e,r,o.data)},clear:function(){!function(e,t,n){uv(e).undoManager.clear(t,n)}(e,o,r)},reset:function(){!function(e,t){uv(e).undoManager.reset(t)}(e,o)},hasUndo:function(){return function(e,t,n){return uv(e).undoManager.hasUndo(t,n)}(e,o,r)},hasRedo:function(){return function(e,t,n){return uv(e).undoManager.hasRedo(t,n)}(e,o,r)},transact:function(t){return function(e,t,n,r){return uv(e).undoManager.transact(t,n,r)}(e,o,n,t)},ignore:function(t){!function(e,t,n){uv(e).undoManager.ignore(t,n)}(e,n,t)},extra:function(t,n){!function(e,t,n,r,o){uv(e).undoManager.extra(t,n,r,o)}(e,o,r,t,n)}};return av(e)||function(e,t,n){var r=Qa(!1),o=function(e){ev(t,!1,n),t.add({},e)};e.on("init",(function(){t.add()})),e.on("BeforeExecCommand",(function(e){var r=e.command.toLowerCase();"undo"!==r&&"redo"!==r&&"mcerepaint"!==r&&(tv(t,n),t.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command.toLowerCase();"undo"!==t&&"redo"!==t&&"mcerepaint"!==t&&o(e)})),e.on("ObjectResizeStart cut",(function(){t.beforeChange()})),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",(function(n){var i=n.keyCode;n.isDefaultPrevented()||((i>=33&&i<=36||i>=37&&i<=40||45===i||n.ctrlKey)&&(o(),e.nodeChanged()),46!==i&&8!==i||e.nodeChanged(),r.get()&&t.typing&&!1===Qh(Jh(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),r.set(!1),e.nodeChanged()))})),e.on("keydown",(function(e){var i=e.keyCode;if(!e.isDefaultPrevented())if(i>=33&&i<=36||i>=37&&i<=40||45===i)t.typing&&o(e);else{var a=e.ctrlKey&&!e.altKey||e.metaKey;!(i<16||i>20)||224===i||91===i||t.typing||a||(t.beforeChange(),ev(t,!0,n),t.add({},e),r.set(!0))}})),e.on("mousedown",(function(e){t.typing&&o(e)}));e.on("input",(function(e){e.inputType&&("insertReplacementText"===e.inputType||function(e){return"insertText"===e.inputType&&null===e.data}(e)||function(e){return"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType}(e))&&o(e)})),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))}(e,o,n),function(e){e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")}(e),o},Kb=[9,27,Df.HOME,Df.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Df.DOWN,Df.UP,Df.LEFT,Df.RIGHT].concat(ct.browser.isFirefox()?[224]:[]),Jb=function(e){return"keydown"===e.type||"keyup"===e.type},Gb=function(e){var t=e.keyCode;return t===Df.BACKSPACE||t===Df.DELETE},Xb=function(e){var t=e.dom,n=Bu(e),r=function(e){return e.getParam("placeholder",Du.getAttrib(e.getElement(),"placeholder"),"string")}(e),o=function(i,a){if(!function(e){if(Jb(e)){var t=e.keyCode;return!Gb(e)&&(Df.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||U(Kb,t))}return!1}(i)){var c=e.getBody(),u=!function(e){return Jb(e)&&!(Gb(e)||"keyup"===e.type&&229===e.keyCode)}(i)&&function(e,t,n){if(ho(pt.fromDom(t),!1)){var r=""===n,o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(r?!e.isBlock(o):n===o.nodeName.toLowerCase())}return!1}(t,c,n);(""!==t.getAttrib(c,"data-mce-placeholder")!==u||a)&&(t.setAttrib(c,"data-mce-placeholder",u?r:null),t.setAttrib(c,"aria-placeholder",u?r:null),function(e,t){e.fire("PlaceholderToggle",{state:t})}(e,u),e.on(u?"keydown":"keyup",o),e.off(u?"keyup":"keydown",o))}};r&&e.on("init",(function(t){o(t,!0),e.on("change SetContent ExecCommand",o),e.on("paste",(function(t){return wr.setEditorTimeout(e,(function(){return o(t)}))}))}))},Yb=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Qb=function(e,t){return ht(pt.fromDom(t),function(e){return e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string")}(e))},Zb=function(e){return"rtl"===Ka.DOM.getStyle(e,"direction",!0)||(t=e.textContent,Yb.test(t));var t},ey=function(e,t,n){var r=function(e,t,n){return $(Ka.DOM.getParents(n.container(),"*",t),e)}(e,t,n);return k.from(r[r.length-1])},ty=function(e,t){if(!t)return t;var n=t.container(),r=t.offset();return e?zr(n)?xn(n.nextSibling)?lu(n.nextSibling,0):lu.after(n):Vr(t)?lu(n,r+1):t:zr(n)?xn(n.previousSibling)?lu(n.previousSibling,n.previousSibling.data.length):lu.before(n):$r(t)?lu(n,r-1):t},ny=p(ty,!0),ry=p(ty,!1),oy=function(e,t){return wt(e,t)?fr(t,(function(e){return Or(e)||Ir(e)}),function(e){return function(t){return bt(e,pt.fromDom(t.dom.parentNode))}}(e)):k.none()},iy=function(e){e.dom.isEmpty(e.getBody())&&(e.setContent(""),function(e){var t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)}(e))},ay=function(e,t){return{from:e,to:t}},cy=function(e,t){var n=pt.fromDom(e),r=pt.fromDom(t.container());return oy(n,r).map((function(e){return function(e,t){return{block:e,position:t}}(e,t)}))},uy=function(e,t,n){var r=cy(e,lu.fromRangeStart(n)),o=r.bind((function(n){return cs(t,e,n.position).bind((function(n){return cy(e,n).map((function(n){return function(e,t,n){return En(n.position.getNode())&&!1===ho(n.block)?ss(!1,n.block.dom).bind((function(r){return r.isEqual(n.position)?cs(t,e,r).bind((function(t){return cy(e,t)})):k.some(n)})).getOr(n):n}(e,t,n)}))}))}));return Oc(r,o,ay).filter((function(e){return function(e){return!1===bt(e.from.block,e.to.block)}(e)&&function(e){return Ot(e.from.block).bind((function(t){return Ot(e.to.block).filter((function(e){return bt(t,e)}))})).isSome()}(e)&&function(e){return!1===Nn(e.from.block.dom)&&!1===Nn(e.to.block.dom)}(e)}))},ly=function(e){var t=Mt(e);return X(t,Ar).fold((function(){return t}),(function(e){return t.slice(0,e)}))},sy=function(e){var t=ly(e);return q(t,Zt),t},fy=function(e,t){var n=ep(t,e);return G(n.reverse(),(function(e){return ho(e)})).each(Zt)},dy=function(e,t,n,r){if(ho(n))return Xm(n),ms(n.dom);0===$(Pt(r),(function(e){return!ho(e)})).length&&ho(t)&&Kt(r,pt.fromTag("br"));var o=ds(n.dom,lu.before(r.dom));return q(sy(t),(function(e){Kt(r,e)})),fy(e,t),o},my=function(e,t,n){if(ho(n))return Zt(n),ho(t)&&Xm(t),ms(t.dom);var r=ps(n.dom);return q(sy(t),(function(e){Xt(n,e)})),fy(e,t),r},py=function(e,t){return wt(t,e)?function(e,t){var n=ep(t,e);return k.from(n[n.length-1])}(t,e):k.none()},gy=function(e,t){ss(e,t.dom).map((function(e){return e.getNode()})).map(pt.fromDom).filter(Rr).each(Zt)},hy=function(e,t,n){return gy(!0,t),gy(!1,n),py(t,n).fold(p(my,e,t,n),p(dy,e,t,n))},vy=function(e,t,n,r){return t?hy(e,r,n):hy(e,n,r)},by=function(e,t){var n=pt.fromDom(e.getBody()),r=function(e,t,n){return n.collapsed?uy(e,t,n):k.none()}(n.dom,t,e.selection.getRng()).bind((function(e){return vy(n,t,e.from.block,e.to.block)}));return r.each((function(t){e.selection.setRng(t.toRange())})),r.isSome()},yy=function(e,t){var n=pt.fromDom(t),r=p(bt,e);return sr(n,Br,r).isSome()},wy=function(e,t){var n=ds(e.dom,lu.fromRangeStart(t)).isNone(),r=fs(e.dom,lu.fromRangeEnd(t)).isNone();return!function(e,t){return yy(e,t.startContainer)||yy(e,t.endContainer)}(e,t)&&n&&r},Cy=function(e){var t=pt.fromDom(e.getBody()),n=e.selection.getRng();return wy(t,n)?function(e){return e.setContent(""),e.selection.setCursorLocation(),!0}(e):function(e,t){var n=t.getRng();return Oc(oy(e,pt.fromDom(n.startContainer)),oy(e,pt.fromDom(n.endContainer)),(function(r,o){return!1===bt(r,o)&&(n.deleteContents(),vy(e,!0,r,o).each((function(e){t.setRng(e.toRange())})),!0)})).getOr(!1)}(t,e.selection)},xy=function(e,t){return!e.selection.isCollapsed()&&Cy(e)},ky=An,Sy=Nn,Ty=function(e,t,n,r,o){return k.from(t._selectionOverrides.showCaret(e,n,r,o))},Ey=function(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?k.none():k.some(function(e){var t=e.ownerDocument.createRange();return t.selectNode(e),t}(t))},_y=function(e,t,n){var r=jl(1,e.getBody(),t),o=lu.fromRangeStart(r),i=o.getNode();if(bl(i))return Ty(1,e,i,!o.isAtEnd(),!1);var a=o.getNode(!0);if(bl(a))return Ty(1,e,a,!1,!1);var c=e.dom.getParent(o.getNode(),(function(e){return Sy(e)||ky(e)}));return bl(c)?Ty(1,e,c,!1,n):k.none()},Ay=function(e,t,n){return t.collapsed?_y(e,t,n).getOr(t):t},Ny=function(e){return Km(e)||Wm(e)},Ry=function(e){return Jm(e)||qm(e)},Oy=function(e,t,n,r,o,i){return Ty(r,e,i.getNode(!o),o,!0).each((function(n){if(t.collapsed){var r=t.cloneRange();o?r.setEnd(n.startContainer,n.startOffset):r.setStart(n.endContainer,n.endOffset),r.deleteContents()}else t.deleteContents();e.selection.setRng(n)})),function(e,t){xn(t)&&0===t.data.length&&e.remove(t)}(e.dom,n),!0},Dy=function(e,t){return function(e,t){var n=e.selection.getRng();if(!xn(n.commonAncestorContainer))return!1;var r=t?uu.Forwards:uu.Backwards,o=ns(e.getBody()),i=p(Wl,t?o.next:o.prev),a=t?Ny:Ry,c=Ul(r,e.getBody(),n),u=ty(t,i(c));if(!u||!ql(c,u))return!1;if(a(u))return Oy(e,n,c.getNode(),r,t,u);var l=i(u);return!!(l&&a(l)&&ql(u,l))&&Oy(e,n,c.getNode(),r,t,l)}(e,t)},Iy=ar([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Py=function(e,t,n,r){var o=r.getNode(!1===t);return oy(pt.fromDom(e),pt.fromDom(n.getNode())).map((function(e){return ho(e)?Iy.remove(e.dom):Iy.moveToElement(o)})).orThunk((function(){return k.some(Iy.moveToElement(o))}))},By=function(e,t,n){return cs(t,e,n).bind((function(r){return o=r.getNode(),Br(pt.fromDom(o))||Ir(pt.fromDom(o))||function(e,t,n,r){var o=function(t){return Nr(pt.fromDom(t))&&!Dl(n,r,e)};return Hl(!t,n).fold((function(){return Hl(t,r).fold(b,o)}),o)}(e,t,n,r)?k.none():t&&Nn(r.getNode())||!1===t&&Nn(r.getNode(!0))?Py(e,t,n,r):t&&Jm(n)||!1===t&&Km(n)?k.some(Iy.moveToPosition(r)):k.none();var o}))},My=function(e,t,n){return function(e,t){var n=t.getNode(!1===e),r=e?"after":"before";return pn(n)&&n.getAttribute("data-mce-caret")===r}(t,n)?function(e,t){return e&&Nn(t.nextSibling)?k.some(Iy.moveToElement(t.nextSibling)):!1===e&&Nn(t.previousSibling)?k.some(Iy.moveToElement(t.previousSibling)):k.none()}(t,n.getNode(!1===t)).fold((function(){return By(e,t,n)}),k.some):By(e,t,n).bind((function(t){return function(e,t,n){return n.fold((function(e){return k.some(Iy.remove(e))}),(function(e){return k.some(Iy.moveToElement(e))}),(function(n){return Dl(t,n,e)?k.none():k.some(Iy.moveToPosition(n))}))}(e,n,t)}))},Ly=function(e,t){return k.from(Rf(e.getBody(),t))},Fy=function(e,t){var n=e.selection.getNode();return Ly(e,n).filter(Nn).fold((function(){return function(e,t,n){var r=jl(t?1:-1,e,n),o=lu.fromRangeStart(r),i=pt.fromDom(e);return!1===t&&Jm(o)?k.some(Iy.remove(o.getNode(!0))):t&&Km(o)?k.some(Iy.remove(o.getNode())):!1===t&&Km(o)&&dp(i,o)?mp(i,o).map((function(e){return Iy.remove(e.getNode())})):t&&Jm(o)&&fp(i,o)?pp(i,o).map((function(e){return Iy.remove(e.getNode())})):My(e,t,o)}(e.getBody(),t,e.selection.getRng()).exists((function(n){return n.fold(function(e,t){return function(n){return e._selectionOverrides.hideFakeCaret(),Wp(e,t,pt.fromDom(n)),!0}}(e,t),function(e,t){return function(n){var r=t?lu.before(n):lu.after(n);return e.selection.setRng(r.toRange()),!0}}(e,t),function(e){return function(t){return e.selection.setRng(t.toRange()),!0}}(e))}))}),y)},jy=function(e,t){var n=e.selection.getNode();return!!Nn(n)&&Ly(e,n.parentNode).filter(Nn).fold((function(){var n;return n=pt.fromDom(e.getBody()),q(gc(n,".mce-offscreen-selection"),Zt),Wp(e,t,pt.fromDom(e.selection.getNode())),iy(e),!0}),(function(){return!0}))},Hy=function(e){var t=e.dom,n=e.selection,r=Rf(e.getBody(),n.getNode());if(An(r)&&t.isBlock(r)&&t.isEmpty(r)){var o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(r,""),r.appendChild(o),n.setRng(lu.before(o).toRange())}return!0},Uy=function(e,t){return e.selection.isCollapsed()?Fy(e,t):jy(e,t)},zy=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n=lu.fromRangeStart(e.selection.getRng());return cs(t,e.getBody(),n).filter((function(e){return t?Um(e):zm(e)})).bind((function(e){return k.from(Il(t?0:-1,e))})).exists((function(t){return e.selection.select(t),!0}))}(e,t)},Wy=xn,qy=function(e){return Wy(e)&&"\ufeff"===e.data[0]},Vy=function(e){return Wy(e)&&"\ufeff"===e.data[e.data.length-1]},$y=function(e){return e.ownerDocument.createTextNode("\ufeff")},Ky=function(e,t){return e?function(e){if(Wy(e.previousSibling))return Vy(e.previousSibling)||e.previousSibling.appendData("\ufeff"),e.previousSibling;if(Wy(e))return qy(e)||e.insertData(0,"\ufeff"),e;var t=$y(e);return e.parentNode.insertBefore(t,e),t}(t):function(e){if(Wy(e.nextSibling))return qy(e.nextSibling)||e.nextSibling.insertData(0,"\ufeff"),e.nextSibling;if(Wy(e))return Vy(e)||e.appendData("\ufeff"),e;var t=$y(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}(t)},Jy=p(Ky,!0),Gy=p(Ky,!1),Xy=function(e,t){return xn(e.container())?Ky(t,e.container()):Ky(t,e.getNode())},Yy=function(e,t){var n=t.get();return n&&e.container()===n&&zr(n)},Qy=function(e,t){return t.fold((function(t){sl(e.get());var n=Jy(t);return e.set(n),k.some(lu(n,n.length-1))}),(function(t){return ms(t).map((function(t){if(Yy(t,e))return lu(e.get(),1);sl(e.get());var n=Xy(t,!0);return e.set(n),lu(n,1)}))}),(function(t){return ps(t).map((function(t){if(Yy(t,e))return lu(e.get(),e.get().length-1);sl(e.get());var n=Xy(t,!1);return e.set(n),lu(n,n.length-1)}))}),(function(t){sl(e.get());var n=Gy(t);return e.set(n),k.some(lu(n,1))}))},Zy=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return k.none()},ew=ar([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),tw=function(e,t){var n=Ol(t,e);return n||e},nw=function(e,t,n){var r=ny(n),o=tw(t,r.container());return ey(e,o,r).fold((function(){return fs(o,r).bind(p(ey,e,o)).map((function(e){return ew.before(e)}))}),k.none)},rw=function(e,t){return null===hs(e,t)},ow=function(e,t,n){return ey(e,t,n).filter(p(rw,t))},iw=function(e,t,n){var r=ry(n);return ow(e,t,r).bind((function(e){return ds(e,r).isNone()?k.some(ew.start(e)):k.none()}))},aw=function(e,t,n){var r=ny(n);return ow(e,t,r).bind((function(e){return fs(e,r).isNone()?k.some(ew.end(e)):k.none()}))},cw=function(e,t,n){var r=ry(n),o=tw(t,r.container());return ey(e,o,r).fold((function(){return ds(o,r).bind(p(ey,e,o)).map((function(e){return ew.after(e)}))}),k.none)},uw=function(e){return!1===Zb(sw(e))},lw=function(e,t,n){return Zy([nw,iw,aw,cw],[e,t,n]).filter(uw)},sw=function(e){return e.fold(m,m,m,m)},fw=function(e){return e.fold(d("before"),d("start"),d("end"),d("after"))},dw=function(e){return e.fold(ew.before,ew.before,ew.after,ew.after)},mw=function(e){return e.fold(ew.start,ew.start,ew.end,ew.end)},pw=function(e,t,n,r,o,i){return Oc(ey(t,n,r),ey(t,n,o),(function(t,r){return t!==r&&function(e,t,n){var r=Ol(t,e),o=Ol(n,e);return r&&r===o}(n,t,r)?ew.after(e?t:r):i})).getOr(i)},gw=function(e,t){return e.fold(y,(function(e){return r=t,!(fw(n=e)===fw(r)&&sw(n)===sw(r));var n,r}))},hw=function(e,t){return e?t.fold(f(k.some,ew.start),k.none,f(k.some,ew.after),k.none):t.fold(k.none,f(k.some,ew.before),k.none,f(k.some,ew.end))},vw=function(e,t,n,r){var o=ty(e,r),i=lw(t,n,o);return lw(t,n,o).bind(p(hw,e)).orThunk((function(){return function(e,t,n,r,o){var i=ty(e,o);return cs(e,n,i).map(p(ty,e)).fold((function(){return r.map(dw)}),(function(o){return lw(t,n,o).map(p(pw,e,t,n,i,o)).filter(p(gw,r))})).filter(uw)}(e,t,n,i,r)}))},bw=(p(vw,!1),p(vw,!0),function(e,t,n){var r=e?1:-1;return t.setRng(lu(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0}),yw=function(e,t){var n=t.selection.getRng(),r=e?lu.fromRangeEnd(n):lu.fromRangeStart(n);return!!function(e){return B(e.selection.getSel().modify)}(t)&&(e&&Vr(r)?bw(!0,t.selection,r):!(e||!$r(r))&&bw(!1,t.selection,r))},ww=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},Cw=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},xw=function(e,t,n){return Qy(t,n).map((function(t){return ww(e,t),n}))},kw=function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=lu.fromRangeStart(e.selection.getRng());lu.isTextPosition(n)&&!1===function(e){return Vr(e)||$r(e)}(n)&&(ww(e,ll(t.get(),n)),t.set(null))}},Sw=function(e,t,n){return!!Qu(e)&&function(e,t,n){var r=e.getBody(),o=lu.fromRangeStart(e.selection.getRng()),i=p(Qb,e);return vw(n,i,r,o).bind((function(n){return xw(e,t,n)}))}(e,t,n).isSome()},Tw=function(e,t,n){return!!Qu(t)&&yw(e,t)},Ew=function(e){var t=Qa(null),n=p(Qb,e);return e.on("NodeChange",(function(r){!Qu(e)||ct.browser.isIE()&&r.initial||(function(e,t,n){var r=W(gc(pt.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom})),o=$(r,e),i=$(n,e);q(ee(o,i),p(Cw,!1)),q(ee(i,o),p(Cw,!0))}(n,e.dom,r.parents),kw(e,t),function(e,t,n,r){if(t.selection.isCollapsed()){var o=$(r,e);q(o,(function(r){var o=lu.fromRangeStart(t.selection.getRng());lw(e,t.getBody(),o).bind((function(e){return xw(t,n,e)}))}))}}(n,e,t,r.parents))})),t},_w=p(Tw,!0),Aw=p(Tw,!1),Nw=function(e,t){return function(n){return Qy(t,n).exists((function(t){return ww(e,t),!0}))}},Rw=function(e,t,n,r){var o=e.getBody(),i=p(Qb,e);e.undoManager.ignore((function(){e.selection.setRng(function(e,t){var n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n}(n,r)),e.execCommand("Delete"),lw(i,o,lu.fromRangeStart(e.selection.getRng())).map(mw).map(Nw(e,t))})),e.nodeChanged()},Ow=function(e,t,n,r){var o=function(e,t){var n=Ol(t,e);return n||e}(e.getBody(),r.container()),i=p(Qb,e),a=lw(i,o,r);return a.bind((function(e){return n?e.fold(d(k.some(mw(e))),k.none,d(k.some(dw(e))),k.none):e.fold(k.none,d(k.some(dw(e))),k.none,d(k.some(mw(e))))})).map(Nw(e,t)).getOrThunk((function(){var c=us(n,o,r),u=c.bind((function(e){return lw(i,o,e)}));return Oc(a,u,(function(){return ey(i,o,r).exists((function(t){return!!function(e){return Oc(ms(e),ps(e),(function(t,n){var r=ty(!0,t),o=ty(!1,n);return fs(e,r).forall((function(e){return e.isEqual(o)}))})).getOr(!0)}(t)&&(Wp(e,n,pt.fromDom(t)),!0)}))})).orThunk((function(){return u.bind((function(o){return c.map((function(o){return n?Rw(e,t,r,o):Rw(e,t,o,r),!0}))}))})).getOr(!1)}))},Dw=function(e,t,n){if(e.selection.isCollapsed()&&Qu(e)){var r=lu.fromRangeStart(e.selection.getRng());return Ow(e,t,n,r)}return!1},Iw=function(e){return 1===Mt(e).length},Pw=function(e,t,n,r){var o=p(Wg,t),i=W($(r,o),(function(e){return e.dom}));if(0===i.length)Wp(t,e,n);else{var a=function(e,t){var n=Mg(!1),r=Hg(t,n.dom);return Kt(pt.fromDom(e),n),Zt(pt.fromDom(e)),lu(r,0)}(n.dom,i);t.selection.setRng(a.toRange())}},Bw=function(e,t){var n=pt.fromDom(e.getBody()),r=pt.fromDom(e.selection.getStart()),o=$(function(e,t){var n=ep(t,e);return X(n,Ar).fold(d(n),(function(e){return n.slice(0,e)}))}(n,r),Iw);return re(o).exists((function(n){var r,i=lu.fromRangeStart(e.selection.getRng());return!(!function(e,t,n){return Oc(ms(n),ps(n),(function(r,o){var i=ty(!0,r),a=ty(!1,o),c=ty(!1,t);return e?fs(n,c).exists((function(e){return e.isEqual(a)&&t.isEqual(i)})):ds(n,c).exists((function(e){return e.isEqual(i)&&t.isEqual(a)}))})).getOr(!0)}(t,i,n.dom)||(r=n,gs(r.dom)&&Pg(r.dom)))&&(Pw(t,e,n,o),!0)}))},Mw=function(e,t){return!!e.selection.isCollapsed()&&Bw(e,t)},Lw=function(e,t,n){return e._selectionOverrides.hideFakeCaret(),Wp(e,t,pt.fromDom(n)),!0},Fw=function(e,t){return e.selection.isCollapsed()?function(e,t){var n=t?Wm:qm,r=t?uu.Forwards:uu.Backwards,o=Ul(r,e.getBody(),e.selection.getRng());return n(o)?Lw(e,t,o.getNode(!t)):k.from(ty(t,o)).filter((function(e){return n(e)&&ql(o,e)})).exists((function(n){return Lw(e,t,n.getNode(!t))}))}(e,t):function(e,t){var n=e.selection.getNode();return!!On(n)&&Lw(e,t,n)}(e,t)},jw=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},Hw=function(e,t){return(e||"table"===Ct(t)?"margin":"padding")+("rtl"===Hn(t,"direction")?"-right":"-left")},Uw=function(e){var t=Ww(e);return!e.mode.isReadOnly()&&(t.length>1||function(e,t){return Q(t,(function(t){var n=Hw(Ku(e),t),r=zn(t,n).map(jw).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&r>0}))}(e,t))},zw=function(e){return Dr(e)||Ir(e)},Ww=function(e){return $(W(e.selection.getSelectedBlocks(),pt.fromDom),(function(e){return!zw(e)&&!function(e){return Ot(e).map(zw).getOr(!1)}(e)&&fr(e,(function(e){return An(e.dom)||Nn(e.dom)})).exists((function(e){return An(e.dom)}))}))},qw=function(e,t){var n=e.dom,r=e.selection,o=e.formatter,i=function(e){return e.getParam("indentation","40px","string")}(e),a=/[a-z%]+$/i.exec(i)[0],c=parseInt(i,10),u=Ku(e),l=Bu(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==l||n.getParent(r.getNode(),n.isBlock)||o.apply("div"),q(Ww(e),(function(e){!function(e,t,n,r,o,i){var a=Hw(n,pt.fromDom(i));if("outdent"===t){var c=Math.max(0,jw(i.style[a])-r);e.setStyle(i,a,c?c+o:"")}else{c=jw(i.style[a])+r+o;e.setStyle(i,a,c)}}(n,t,u,c,a,e.dom)}))},Vw=function(e,t){if(e.selection.isCollapsed()&&Uw(e)){var n=e.dom,r=e.selection.getRng(),o=lu.fromRangeStart(r),i=n.getParent(r.startContainer,n.isBlock);if(null!==i&&ip(pt.fromDom(i),o))return qw(e,"outdent"),!0}return!1},$w=function(e,t){e.getDoc().execCommand(t,!1,null)},Kw=function(e,t){e.addCommand("delete",(function(){!function(e,t){Vw(e)||Uy(e,!1)||Dy(e,!1)||Dw(e,t,!1)||by(e,!1)||hg(e)||zy(e,!1)||Fw(e,!1)||xy(e)||Mw(e,!1)||($w(e,"Delete"),iy(e))}(e,t)})),e.addCommand("forwardDelete",(function(){!function(e,t){Uy(e,!0)||Dy(e,!0)||Dw(e,t,!0)||by(e,!0)||hg(e)||zy(e,!0)||Fw(e,!0)||xy(e)||Mw(e,!0)||$w(e,"ForwardDelete")}(e,t)}))},Jw=function(e){return void 0===e.touches||1!==e.touches.length?k.none():k.some(e.touches[0])},Gw=function(e){var t=Qa(k.none()),n=Qa(!1),r=ac((function(t){e.fire("longpress",Ee(Ee({},t),{type:"longpress"})),n.set(!0)}),400);e.on("touchstart",(function(e){Jw(e).each((function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:e.target};r.throttle(e),n.set(!1),t.set(k.some(i))}))}),!0),e.on("touchmove",(function(o){r.cancel(),Jw(o).each((function(r){t.get().each((function(o){(function(e,t){var n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y);return n>5||r>5})(r,o)&&(t.set(k.none()),n.set(!1),e.fire("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(function(o){r.cancel(),"touchcancel"!==o.type&&t.get().filter((function(e){return e.target.isEqualNode(o.target)})).each((function(){n.get()?o.preventDefault():e.fire("tap",Ee(Ee({},o),{type:"tap"}))}))}),!0)},Xw=function(e,t){return e.hasOwnProperty(t.nodeName)},Yw=function(e,t){return!!xn(t)||!!pn(t)&&(!Xw(e,t)&&!Es(t))},Qw=function(e,t){if(xn(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||Xw(e,t.nextSibling)))return!0}return!1},Zw=function(e){var t,n,r,o=e.dom,i=e.selection,a=e.schema,c=a.getBlockElements(),u=i.getStart(),l=e.getBody(),s=Bu(e);if(u&&pn(u)&&s){var f=l.nodeName.toLowerCase();if(a.isValidChild(f,s.toLowerCase())&&!function(e,t,n){return z(Zm(pt.fromDom(n),pt.fromDom(t)),(function(t){return Xw(e,t.dom)}))}(c,l,u)){var d=i.getRng(),m=d.startContainer,p=d.startOffset,g=d.endContainer,h=d.endOffset,v=Jd(e);for(u=l.firstChild;u;)if(Yw(c,u)){if(Qw(c,u)){n=u,u=u.nextSibling,o.remove(n);continue}t||(t=o.create(s,Mu(e)),u.parentNode.insertBefore(t,u),r=!0),n=u,u=u.nextSibling,t.appendChild(n)}else t=null,u=u.nextSibling;r&&v&&(d.setStart(m,p),d.setEnd(g,h),i.setRng(d),e.nodeChanged())}}},eC=function(e,t){t.hasAttribute("data-mce-caret")&&(Xr(t),function(e){e.selection.setRng(e.selection.getRng())}(e),e.selection.scrollIntoView(t))},tC=function(e,t){var n=function(e){return pr(pt.fromDom(e.getBody()),"*[data-mce-caret]").fold(d(null),(function(e){return e.dom}))}(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void eC(e,n)):void(qr(n)&&(eC(e,n),e.undoManager.add()))};!function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"}(jb||(jb={}));var nC,rC=function(e,t){return e===uu.Backwards?Z(t):t},oC=function(e,t,n){return e===uu.Forwards?t.next(n):t.prev(n)},iC=function(e,t,n,r){return En(r.getNode(t===uu.Forwards))?jb.Br:!1===Dl(n,r)?jb.Block:jb.Wrap},aC=function(e,t,n,r){for(var o,i=ns(n),a=r,c=[];a&&(o=oC(t,i,a));){if(En(o.getNode(!1)))return t===uu.Forwards?{positions:rC(t,c).concat([o]),breakType:jb.Br,breakAt:k.some(o)}:{positions:rC(t,c),breakType:jb.Br,breakAt:k.some(o)};if(o.isVisible()){if(e(a,o)){var u=iC(0,t,a,o);return{positions:rC(t,c),breakType:u,breakAt:k.some(o)}}c.push(o),a=o}else a=o}return{positions:rC(t,c),breakType:jb.Eol,breakAt:k.none()}},cC=function(e,t,n,r){return t(n,r).breakAt.map((function(r){var o=t(n,r).positions;return e===uu.Backwards?o.concat(r):[r].concat(o)})).getOr([])},uC=function(e,t){return J(e,(function(e,n){return e.fold((function(){return k.some(n)}),(function(r){return Oc(ne(r.getClientRects()),ne(n.getClientRects()),(function(e,o){var i=Math.abs(t-e.left);return Math.abs(t-o.left)<=i?n:r})).or(e)}))}),k.none())},lC=function(e,t){return ne(t.getClientRects()).bind((function(t){return uC(e,t.left)}))},sC=p(aC,cu.isAbove,-1),fC=p(aC,cu.isBelow,1),dC=p(cC,-1,sC),mC=p(cC,1,fC),pC=function(e){var t=function(t){return W(t,(function(t){return(t=Ic(t)).node=e,t}))};if(pn(e))return t(e.getClientRects());if(xn(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},gC=function(e){return Y(e,pC)};!function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(nC||(nC={}));var hC,vC,bC=function(e,t,n,r,o,i){var a=0,c=[],u=function(r){var i,u,s;for(s=gC([r]),-1===e&&(s=s.reverse()),i=0;i<s.length;i++)if(u=s[i],!n(u,l)){if(c.length>0&&t(u,Te(c))&&a++,u.line=a,o(u))return!0;c.push(u)}},l=Te(i.getClientRects());if(!l)return c;var s=i.getNode();return u(s),function(e,t,n,r){for(;r=Rl(r,e,co,t);)if(n(r))return}(e,r,u,s),c},yC=p(bC,nC.Up,Mc,Lc),wC=p(bC,nC.Down,Lc,Mc),CC=function(e){return function(t){return function(e,t){return t.line>e}(e,t)}},xC=function(e){return function(t){return function(e,t){return t.line===e}(e,t)}},kC=Nn,SC=Rl,TC=function(e,t){return Math.abs(e.left-t)},EC=function(e,t){return Math.abs(e.right-t)},_C=function(e,t){return e>=t.left&&e<=t.right},AC=function(e,t){return e>=t.top&&e<=t.bottom},NC=function(e,t){return ke(e,(function(e,n){var r=Math.min(TC(e,t),EC(e,t)),o=Math.min(TC(n,t),EC(n,t));return _C(t,n)?n:_C(t,e)?e:o===r&&kC(n.node)||o<r?n:e}))},RC=function(e,t,n,r,o){var i=SC(r,e,co,t,!o);do{if(!i||n(i))return}while(i=SC(i,e,co,t))},OC=function(e,t,n){var r=gC(function(e){return $(oe(e.getElementsByTagName("*")),yl)}(e)),o=$(r,p(AC,n)),i=NC(o,t);if(i){var a=!yn(i.node)&&!On(i.node);if((i=NC(function(e,t,n){void 0===n&&(n=!0);var r=[],o=function(e,n){var o=$(gC([n]),(function(n){return!e(n,t)}));return r=r.concat(o),0===o.length};return r.push(t),RC(nC.Up,e,p(o,Mc),t.node,n),RC(nC.Down,e,p(o,Lc),t.node,n),r}(e,i,a),t))&&yl(i.node))return function(e,t){return{node:e.node,before:TC(e,t)<EC(e,t)}}(i,t)}return null},DC=function(e,t){e.selection.setRng(t),bd(e,e.selection.getRng())},IC=function(e,t,n){return k.some(Ay(e,t,n))},PC=function(e,t,n,r,o,i){var a=t===uu.Forwards,c=ns(e.getBody()),u=p(Wl,a?c.next:c.prev),l=a?r:o;if(!n.collapsed){var s=jc(n);if(i(s))return Ty(t,e,s,t===uu.Backwards,!1)}var f=Ul(t,e.getBody(),n);if(l(f))return Ey(e,f.getNode(!a));var d=ty(a,u(f)),m=function(e){return Ur(e.startContainer)}(n);if(!d)return m?k.some(n):k.none();if(l(d))return Ty(t,e,d.getNode(!a),a,!1);var g=u(d);return g&&l(g)&&ql(d,g)?Ty(t,e,g.getNode(!a),a,!1):m?IC(e,d.toRange(),!1):k.none()},BC=function(e,t,n,r,o,i){var a=Ul(t,e.getBody(),n),c=Te(a.getClientRects()),u=t===nC.Down;if(!c)return k.none();var l,s=(u?wC:yC)(e.getBody(),CC(1),a),f=$(s,xC(1)),d=c.left,m=NC(f,d);if(m&&i(m.node)){var p=Math.abs(d-m.left),g=Math.abs(d-m.right);return Ty(t,e,m.node,p<g,!1)}if(l=r(a)?a.getNode():o(a)?a.getNode(!0):jc(n)){var h=function(e,t,n,r){var o,i,a,c,u,l=ns(t),s=[],f=0,d=function(e){return Te(e.getClientRects())};1===e?(o=l.next,i=Lc,a=Mc,c=lu.after(r)):(o=l.prev,i=Mc,a=Lc,c=lu.before(r));var m=d(c);do{if(c.isVisible()&&!a(u=d(c),m)){if(s.length>0&&i(u,Te(s))&&f++,(u=Ic(u)).position=c,u.line=f,n(u))return s;s.push(u)}}while(c=o(c));return s}(t,e.getBody(),CC(1),l),v=NC($(h,xC(1)),d);if(v)return IC(e,v.position.toRange(),!1);if(v=Te($(h,xC(0))))return IC(e,v.position.toRange(),!1)}return 0===f.length?MC(e,u).filter(u?o:r).map((function(t){return Ay(e,t.toRange(),!1)})):k.none()},MC=function(e,t){var n=e.selection.getRng(),r=e.getBody();if(t){var o=lu.fromRangeEnd(n),i=fC(r,o);return re(i.positions)}o=lu.fromRangeStart(n),i=sC(r,o);return ne(i.positions)},LC=function(e,t,n){return MC(e,t).filter(n).exists((function(t){return e.selection.setRng(t.toRange()),!0}))},FC=Nn,jC=function(e,t,n){var r=ns(e.getBody()),o=p(Wl,1===t?r.next:r.prev);if(n.collapsed&&function(e){return""!==Bu(e)}(e)){var i=e.dom.getParent(n.startContainer,"PRE");if(!i)return;if(!o(lu.fromRangeStart(n))){var a=function(e){var t=e.dom.create(Bu(e));return(!ct.ie||ct.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">'),t}(e);1===t?e.$(i).after(a):e.$(i).before(a),e.selection.select(a,!0),e.selection.collapse()}}},HC=function(e,t){var n=t?uu.Forwards:uu.Backwards,r=e.selection.getRng();return function(e,t,n){return PC(t,e,n,Km,Jm,FC)}(n,e,r).orThunk((function(){return jC(e,n,r),k.none()}))},UC=function(e,t){var n=t?1:-1,r=e.selection.getRng();return function(e,t,n){return BC(t,e,n,(function(e){return Km(e)||Vm(e)}),(function(e){return Jm(e)||$m(e)}),FC)}(n,e,r).orThunk((function(){return jC(e,n,r),k.none()}))},zC=function(e,t){return HC(e,t).exists((function(t){return DC(e,t),!0}))},WC=function(e,t){return UC(e,t).exists((function(t){return DC(e,t),!0}))},qC=function(e,t){return LC(e,t,t?Jm:Km)},VC=function(e){return U(["figcaption"],Ct(e))},$C=function(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t},KC=function(e,t,n){n?Xt(e,t):Gt(e,t)},JC=function(e,t,n,r){return""===t?function(e,t){var n=pt.fromTag("br");return KC(e,n,t),$C(n)}(e,r):function(e,t,n,r){var o=pt.fromTag(n),i=pt.fromTag("br");return Bn(o,r),Xt(o,i),KC(e,o,t),$C(i)}(e,r,t,n)},GC=function(e,t,n){return t?function(e,t){return fC(e,t).breakAt.isNone()}(e.dom,n):function(e,t){return sC(e,t).breakAt.isNone()}(e.dom,n)},XC=function(e,t){var n=pt.fromDom(e.getBody()),r=lu.fromRangeStart(e.selection.getRng()),o=Bu(e),i=Mu(e);return function(e,t){var n=p(bt,t);return fr(pt.fromDom(e.container()),Ar,n).filter(VC)}(r,n).exists((function(){if(GC(n,t,r)){var a=JC(n,o,i,t);return e.selection.setRng(a),!0}return!1}))},YC=function(e,t){return!!e.selection.isCollapsed()&&XC(e,t)},QC=function(e,t){return Y(function(e){return W(e,(function(e){return Ee({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:s},e)}))}(e),(function(e){return function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey}(e,t)?[e]:[]}))},ZC=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},ex=function(e,t){return G(QC(e,t),(function(e){return e.action()}))},tx=function(e,t){var n=t?uu.Forwards:uu.Backwards,r=e.selection.getRng();return PC(e,n,r,Wm,qm,On).exists((function(t){return DC(e,t),!0}))},nx=function(e,t){var n=t?1:-1,r=e.selection.getRng();return BC(e,n,r,Wm,qm,On).exists((function(t){return DC(e,t),!0}))},rx=function(e,t){return LC(e,t,t?qm:Wm)},ox=function(e,t,n,r,o){var i=gc(pt.fromDom(n),"td,th,caption").map((function(e){return e.dom}));return function(e,t,n){return J(e,(function(e,r){return e.fold((function(){return k.some(r)}),(function(e){var o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),i=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n));return k.some(i<o?r:e)}))}),k.none())}($(function(e,t){return Y(t,(function(t){var n=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}}(Ic(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))}(e,i),(function(e){return t(e,o)})),r,o).map((function(e){return e.cell}))},ix=p(ox,(function(e){return e.bottom}),(function(e,t){return e.y<t})),ax=p(ox,(function(e){return e.top}),(function(e,t){return e.y>t})),cx=function(e,t){return ne(t.getClientRects()).bind((function(t){return ix(e,t.left,t.top)})).bind((function(e){return lC(ps(n=e).map((function(e){return sC(n,e).positions.concat(e)})).getOr([]),t);var n}))},ux=function(e,t){return re(t.getClientRects()).bind((function(t){return ax(e,t.left,t.top)})).bind((function(e){return lC(ms(n=e).map((function(e){return[e].concat(fC(n,e).positions)})).getOr([]),t);var n}))},lx=function(e,t,n){var r=e(t,n);return function(e){return e.breakType===jb.Wrap&&0===e.positions.length}(r)||!En(n.getNode())&&function(e){return e.breakType===jb.Br&&1===e.positions.length}(r)?!function(e,t,n){return n.breakAt.exists((function(n){return e(t,n).breakAt.isSome()}))}(e,t,r):r.breakAt.isNone()},sx=p(lx,sC),fx=p(lx,fC),dx=function(e,t,n,r){var o=e.selection.getRng(),i=t?1:-1;return!(!vl()||!function(e,t,n){var r=lu.fromRangeStart(t);return ss(!e,n).exists((function(e){return e.isEqual(r)}))}(t,o,n))&&(Ty(i,e,n,!t,!1).each((function(t){DC(e,t)})),!0)},mx=function(e,t){var n=t.getNode(e);return pn(n)&&"TABLE"===n.nodeName?k.some(n):k.none()},px=function(e,t,n){var r=mx(!!t,n),o=!1===t;r.fold((function(){return DC(e,n.toRange())}),(function(r){return ss(o,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return DC(e,n.toRange())}),(function(o){return function(e,t,n,r){var o=Bu(t);o?t.undoManager.transact((function(){var r=pt.fromTag(o);Bn(r,Mu(t)),Xt(r,pt.fromTag("br")),e?Jt(pt.fromDom(n),r):Kt(pt.fromDom(n),r);var i=t.dom.createRng();i.setStart(r.dom,0),i.setEnd(r.dom,0),DC(t,i)})):DC(t,r.toRange())}(t,e,r,n)}))}))},gx=function(e,t,n,r){var o=e.selection.getRng(),i=lu.fromRangeStart(o),a=e.getBody();if(!t&&sx(r,i)){var c=function(e,t,n){return cx(t,n).orThunk((function(){return ne(n.getClientRects()).bind((function(n){return uC(dC(e,lu.before(t)),n.left)}))})).getOr(lu.before(t))}(a,n,i);return px(e,t,c),!0}if(t&&fx(r,i)){c=function(e,t,n){return ux(t,n).orThunk((function(){return ne(n.getClientRects()).bind((function(n){return uC(mC(e,lu.after(t)),n.left)}))})).getOr(lu.after(t))}(a,n,i);return px(e,t,c),!0}return!1},hx=function(e,t,n){return k.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(r){return k.from(e.dom.getParent(r,"table")).map((function(o){return n(e,t,o,r)}))})).getOr(!1)},vx=function(e,t){return hx(e,t,dx)},bx=function(e,t){return hx(e,t,gx)},yx=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){var r=Qe().os;ex([{keyCode:Df.RIGHT,action:ZC(zC,e,!0)},{keyCode:Df.LEFT,action:ZC(zC,e,!1)},{keyCode:Df.UP,action:ZC(WC,e,!1)},{keyCode:Df.DOWN,action:ZC(WC,e,!0)},{keyCode:Df.RIGHT,action:ZC(vx,e,!0)},{keyCode:Df.LEFT,action:ZC(vx,e,!1)},{keyCode:Df.UP,action:ZC(bx,e,!1)},{keyCode:Df.DOWN,action:ZC(bx,e,!0)},{keyCode:Df.RIGHT,action:ZC(tx,e,!0)},{keyCode:Df.LEFT,action:ZC(tx,e,!1)},{keyCode:Df.UP,action:ZC(nx,e,!1)},{keyCode:Df.DOWN,action:ZC(nx,e,!0)},{keyCode:Df.RIGHT,action:ZC(Sw,e,t,!0)},{keyCode:Df.LEFT,action:ZC(Sw,e,t,!1)},{keyCode:Df.RIGHT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:ZC(_w,e,t)},{keyCode:Df.LEFT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:ZC(Aw,e,t)},{keyCode:Df.UP,action:ZC(YC,e,!1)},{keyCode:Df.DOWN,action:ZC(YC,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},wx=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){ex([{keyCode:Df.BACKSPACE,action:ZC(Vw,e,!1)},{keyCode:Df.BACKSPACE,action:ZC(Uy,e,!1)},{keyCode:Df.DELETE,action:ZC(Uy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Dy,e,!1)},{keyCode:Df.DELETE,action:ZC(Dy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Dw,e,t,!1)},{keyCode:Df.DELETE,action:ZC(Dw,e,t,!0)},{keyCode:Df.BACKSPACE,action:ZC(hg,e,!1)},{keyCode:Df.DELETE,action:ZC(hg,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(zy,e,!1)},{keyCode:Df.DELETE,action:ZC(zy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Fw,e,!1)},{keyCode:Df.DELETE,action:ZC(Fw,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(xy,e,!1)},{keyCode:Df.DELETE,action:ZC(xy,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(by,e,!1)},{keyCode:Df.DELETE,action:ZC(by,e,!0)},{keyCode:Df.BACKSPACE,action:ZC(Mw,e,!1)},{keyCode:Df.DELETE,action:ZC(Mw,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)})),e.on("keyup",(function(t){!1===t.isDefaultPrevented()&&function(e,t){ex([{keyCode:Df.BACKSPACE,action:ZC(Hy,e)},{keyCode:Df.DELETE,action:ZC(Hy,e)}],t)}(e,t)}))},Cx=function(e,t){var n,r=t,o=e.dom,i=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var a=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild);a&&/^(UL|OL|DL)$/.test(a.nodeName)&&t.insertBefore(o.doc.createTextNode(" "),t.firstChild)}var c=o.createRng();if(t.normalize(),t.hasChildNodes()){for(var u=new Tr(t,t);n=u.current();){if(xn(n)){c.setStart(n,0),c.setEnd(n,0);break}if(i[n.nodeName.toLowerCase()]){c.setStartBefore(n),c.setEndBefore(n);break}r=n,n=u.next()}n||(c.setStart(r,0),c.setEnd(r,0))}else En(t)?t.nextSibling&&o.isBlock(t.nextSibling)?(c.setStartBefore(t),c.setEndBefore(t)):(c.setStartAfter(t),c.setEndAfter(t)):(c.setStart(t,0),c.setEnd(t,0));e.selection.setRng(c),bd(e,c)}},xx=function(e){return k.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},kx=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},Sx=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},Tx=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},Ex=function(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!pn(r);)r=r[n?"nextSibling":"previousSibling"];return r===t},_x=function(e,t,n,r,o){var i=e.dom,a=e.selection.getRng();if(n!==e.getBody()){var c;Sx(c=n)&&Sx(c.parentNode)&&(o="LI");var u=o?t(o):i.create("BR");if(Ex(n,r,!0)&&Ex(n,r,!1))kx(n,"LI")?i.insertAfter(u,Tx(n)):i.replace(u,n);else if(Ex(n,r,!0))kx(n,"LI")?(i.insertAfter(u,Tx(n)),u.appendChild(i.doc.createTextNode(" ")),u.appendChild(n)):n.parentNode.insertBefore(u,n);else if(Ex(n,r,!1))i.insertAfter(u,Tx(n));else{n=Tx(n);var l=a.cloneRange();l.setStartAfter(r),l.setEndAfter(n);var s=l.extractContents();"LI"===o&&function(e,t){return e.firstChild&&e.firstChild.nodeName===t}(s,"LI")?(u=s.firstChild,i.insertAfter(s,n)):(i.insertAfter(s,n),i.insertAfter(u,n))}i.remove(r),Cx(e,u)}},Ax=function(e,t){return t&&"A"===t.nodeName&&e.isEmpty(t)},Nx=function(e){e.innerHTML='<br data-mce-bogus="1">'},Rx=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},Ox=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},Dx=function(e,t,n){return!1===xn(t)?n:e?1===n&&"\ufeff"===t.data.charAt(n-1)?0:n:n===t.data.length-1&&"\ufeff"===t.data.charAt(n)?t.data.length:n},Ix=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o},Px=function(e,t){var n=Bu(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,t,n){var r=e.dom;k.from(n.style).map(r.parseStyle).each((function(e){var n=Wn(pt.fromDom(t)),o=Ee(Ee({},n),e);r.setStyles(t,o)}));var o=k.from(n.class).map((function(e){return e.split(/\s+/)})),i=k.from(t.className).map((function(e){return $(e.split(/\s+/),(function(e){return""!==e}))}));Oc(o,i,(function(e,n){var o=$(n,(function(t){return!U(e,t)})),i=_e(e,o);r.setAttrib(t,"class",i.join(" "))}));var a=["style","class"],c=me(n,(function(e,t){return!U(a,t)}));r.setAttribs(t,c)}(e,t,Mu(e))},Bx=function(e,t){var n,r,o,i,a,c,u,l,s,f,d=e.dom,m=e.schema,p=m.getNonEmptyElements(),g=e.selection.getRng(),h=function(t){var n,o,a,c=r,u=m.getTextInlineElements();if(a=n=t||"TABLE"===l||"HR"===l?d.create(t||s):i.cloneNode(!1),!1===function(e){return e.getParam("keep_styles",!0)}(e))d.setAttrib(n,"style",null),d.setAttrib(n,"class",null);else do{if(u[c.nodeName]){if(gs(c)||Es(c))continue;o=c.cloneNode(!1),d.setAttrib(o,"id",""),n.hasChildNodes()?(o.appendChild(n.firstChild),n.appendChild(o)):(a=o,n.appendChild(o))}}while((c=c.parentNode)&&c!==C);return Px(e,n),Nx(a),n},v=function(e){var t,n,a=Dx(e,r,o);if(xn(r)&&(e?a>0:a<r.nodeValue.length))return!1;if(r.parentNode===i&&f&&!e)return!0;if(e&&pn(r)&&r===i.firstChild)return!0;if(Rx(r,"TABLE")||Rx(r,"HR"))return f&&!e||!f&&e;var c=new Tr(r,i);for(xn(r)&&(e&&0===a?c.prev():e||a!==r.nodeValue.length||c.next());t=c.current();){if(pn(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),p[n]&&"br"!==n))return!1}else if(xn(t)&&!lo(t.nodeValue))return!1;e?c.prev():c.next()}return!0},b=function(){a=/^(H[1-6]|PRE|FIGURE)$/.test(l)&&"HGROUP"!==x?h(s):h(),function(e){return e.getParam("end_container_on_empty_block",!1)}(e)&&Ox(d,u)&&d.isEmpty(i)?a=d.split(u,i):d.insertAfter(a,i),Cx(e,a)};$f(d,g).each((function(e){g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset)})),r=g.startContainer,o=g.startOffset,s=Bu(e);var y=!(!t||!t.shiftKey),w=!(!t||!t.ctrlKey);pn(r)&&r.hasChildNodes()&&(f=o>r.childNodes.length-1,r=r.childNodes[Math.min(o,r.childNodes.length-1)]||r,o=f&&xn(r)?r.nodeValue.length:0);var C=Ix(d,r);if(C){(s&&!y||!s&&y)&&(r=function(e,t,n,r,o){var i,a,c,u,l,s,f=t||"P",d=e.dom,m=Ix(d,r);if(!(a=d.getParent(r,d.isBlock))||!Ox(d,a)){if(s=(a=a||m)===e.getBody()||function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)}(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return i=d.create(f),Px(e,i),a.appendChild(i),n.setStart(i,0),n.setEnd(i,0),i;for(u=r;u.parentNode!==a;)u=u.parentNode;for(;u&&!d.isBlock(u);)c=u,u=u.previousSibling;if(c&&e.schema.isValidChild(s,f.toLowerCase())){for(i=d.create(f),Px(e,i),c.parentNode.insertBefore(i,c),u=c;u&&!d.isBlock(u);)l=u.nextSibling,i.appendChild(u),u=l;n.setStart(r,o),n.setEnd(r,o)}}return r}(e,s,g,r,o)),i=d.getParent(r,d.isBlock),u=i?d.getParent(i.parentNode,d.isBlock):null,l=i?i.nodeName.toUpperCase():"";var x=u?u.nodeName.toUpperCase():"";"LI"!==x||w||(i=u,u=u.parentNode,l=x),/^(LI|DT|DD)$/.test(l)&&d.isEmpty(i)?_x(e,h,u,i,s):s&&i===e.getBody()||(s=s||"P",Ur(i)?(a=Xr(i),d.isEmpty(i)&&Nx(i),Px(e,a),Cx(e,a)):v()?b():v(!0)?(a=i.parentNode.insertBefore(h(),i),Cx(e,Rx(i,"HR")?a:i)):((n=function(e){var t=e.cloneRange();return t.setStart(e.startContainer,Dx(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Dx(!1,e.endContainer,e.endOffset)),t}(g).cloneRange()).setEndAfter(i),function(e){q(pc(pt.fromDom(e),Tt),(function(e){var t=e.dom;t.nodeValue=Fr(t.nodeValue)}))}(c=n.extractContents()),function(e){do{xn(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)}(c),a=c.firstChild,d.insertAfter(c,i),function(e,t,n){var r,o=n,i=[];if(o){for(;o=o.firstChild;){if(e.isBlock(o))return;pn(o)&&!t[o.nodeName.toLowerCase()]&&i.push(o)}for(r=i.length;r--;)(!(o=i[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue||Ax(e,o))&&e.remove(o)}}(d,p,a),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(d,i),d.isEmpty(i)&&Nx(i),a.normalize(),d.isEmpty(a)?(d.remove(a),b()):(Px(e,a),Cx(e,a))),d.setAttrib(a,"id",""),e.fire("NewBlock",{newBlock:a}))}},Mx=function(e,t,n){var r=e.create("span",{},"&nbsp;");n.parentNode.insertBefore(r,n),t.scrollIntoView(r),e.remove(r)},Lx=function(e,t,n,r){var o=e.createRng();r?(o.setStartBefore(n),o.setEndBefore(n)):(o.setStartAfter(n),o.setEndAfter(n)),t.setRng(o)},Fx=function(e,t){var n,r,o=e.selection,i=e.dom,a=o.getRng();$f(i,a).each((function(e){a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)}));var c=a.startOffset,u=a.startContainer;if(1===u.nodeType&&u.hasChildNodes()){var l=c>u.childNodes.length-1;u=u.childNodes[Math.min(c,u.childNodes.length-1)]||u,c=l&&3===u.nodeType?u.nodeValue.length:0}var s=i.getParent(u,i.isBlock),f=s?i.getParent(s.parentNode,i.isBlock):null,d=f?f.nodeName.toUpperCase():"",m=!(!t||!t.ctrlKey);"LI"!==d||m||(s=f),u&&3===u.nodeType&&c>=u.nodeValue.length&&(function(e,t,n){for(var r,o=new Tr(t,n),i=e.getNonEmptyElements();r=o.next();)if(i[r.nodeName.toLowerCase()]||r.length>0)return!0}(e.schema,u,s)||(n=i.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),r=!0)),n=i.create("br"),fu(i,a,n),Mx(i,o,n),Lx(i,o,n,r),e.undoManager.add()},jx=function(e,t){var n=pt.fromTag("br");Kt(pt.fromDom(t),n),e.undoManager.add()},Hx=function(e,t){Ux(e.getBody(),t)||Jt(pt.fromDom(t),pt.fromTag("br"));var n=pt.fromTag("br");Jt(pt.fromDom(t),n),Mx(e.dom,e.selection,n.dom),Lx(e.dom,e.selection,n.dom,!1),e.undoManager.add()},Ux=function(e,t){return n=lu.after(t),!!En(n.getNode())||fs(e,lu.after(t)).map((function(e){return En(e.getNode())})).getOr(!1);var n},zx=function(e){return e&&"A"===e.nodeName&&"href"in e},Wx=function(e){return e.fold(b,zx,zx,b)},qx=function(e,t){t.fold(s,p(jx,e),p(Hx,e),s)},Vx=function(e,t){var n=function(e){var t=p(Qb,e),n=lu.fromRangeStart(e.selection.getRng());return lw(t,e.getBody(),n).filter(Wx)}(e);n.isSome()?n.each(p(qx,e)):Fx(e,t)},$x=function(e,t){return xx(e).filter((function(e){return t.length>0&&ht(pt.fromDom(e),t)})).isSome()},Kx=ar([{br:[]},{block:[]},{none:[]}]),Jx=function(e,t){return function(e){return $x(e,function(e){return e.getParam("no_newline_selector","")}(e))}(e)},Gx=function(e){return function(t,n){return""===Bu(t)===e}},Xx=function(e){return function(t,n){return function(e){return xx(e).filter((function(e){return Ir(pt.fromDom(e))})).isSome()}(t)===e}},Yx=function(e,t){return function(n,r){return function(e){return xx(e).fold(d(""),(function(e){return e.nodeName.toUpperCase()}))}(n)===e.toUpperCase()===t}},Qx=function(e){return Yx("pre",e)},Zx=function(e){return function(t,n){return function(e){return e.getParam("br_in_pre",!0)}(t)===e}},ek=function(e,t){return function(e){return $x(e,function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")}(e))}(e)},tk=function(e,t){return t},nk=function(e){var t=Bu(e),n=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},rk=function(e,t){return function(n,r){return J(e,(function(e,t){return e&&t(n,r)}),!0)?k.some(t):k.none()}},ok=function(e,t){(function(e,t){return Zy([rk([Jx],Kx.none()),rk([Yx("summary",!0)],Kx.br()),rk([Qx(!0),Zx(!1),tk],Kx.br()),rk([Qx(!0),Zx(!1)],Kx.block()),rk([Qx(!0),Zx(!0),tk],Kx.block()),rk([Qx(!0),Zx(!0)],Kx.br()),rk([Xx(!0),tk],Kx.br()),rk([Xx(!0)],Kx.block()),rk([Gx(!0),tk,nk],Kx.block()),rk([Gx(!0)],Kx.br()),rk([ek],Kx.br()),rk([Gx(!1),tk],Kx.br()),rk([nk],Kx.block())],[e,!(!t||!t.shiftKey)]).getOr(Kx.none())})(e,t).fold((function(){Vx(e,t)}),(function(){Bx(e,t)}),s)},ik=function(e){e.on("keydown",(function(t){t.keyCode===Df.ENTER&&function(e,t){var n;t.isDefaultPrevented()||(t.preventDefault(),(n=e.undoManager).typing&&(n.typing=!1,n.add()),e.undoManager.transact((function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),ok(e,t)})))}(e,t)}))},ak=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){ex([{keyCode:Df.END,action:ZC(qC,e,!0)},{keyCode:Df.HOME,action:ZC(qC,e,!1)},{keyCode:Df.END,action:ZC(rx,e,!0)},{keyCode:Df.HOME,action:ZC(rx,e,!1)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},ck=Qe().browser,uk=function(e){!function(e){var t=ic((function(){e.composing||Ap(e)}),0);ck.isIE()&&(e.on("keypress",(function(e){t.throttle()})),e.on("remove",(function(e){t.cancel()})))}(e),e.on("input",(function(t){!1===t.isComposing&&Ap(e)}))},lk=function(e,t){var n=t.container(),r=t.offset();return xn(n)?(n.insertData(r,e),k.some(cu(n,r+e.length))):zl(t).map((function(n){var r=pt.fromText(e);return t.isAtEnd()?Jt(n,r):Kt(n,r),cu(r.dom,e.length)}))},sk=p(lk," "),fk=p(lk," "),dk=function(e,t){return function(n){return function(e,t){return!yp(t)&&(wp(e,t)||vp(e,t)||bp(e,t))}(e,n)?sk(t):fk(t)}},mk=function(e){var t=lu.fromRangeStart(e.selection.getRng()),n=pt.fromDom(e.getBody());if(e.selection.isCollapsed()){var r=p(Qb,e),o=lu.fromRangeStart(e.selection.getRng());return lw(r,e.getBody(),o).bind(function(e){return function(t){return t.fold((function(t){return ds(e.dom,lu.before(t))}),(function(e){return ms(e)}),(function(e){return ps(e)}),(function(t){return fs(e.dom,lu.after(t))}))}}(n)).bind(dk(n,t)).exists(function(e){return function(t){return e.selection.setRng(t.toRange()),e.nodeChanged(),!0}}(e))}return!1},pk=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){ex([{keyCode:Df.SPACEBAR,action:ZC(mk,e)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},gk=function(e){var t=Ew(e);return function(e){e.on("keyup compositionstart",p(tC,e))}(e),yx(e,t),wx(e,t),ik(e),pk(e),uk(e),ak(e),t},hk=function(){function e(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(n){var r=e.selection.getRng(),o={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};"nodechange"!==n.type&&Lf(o,t)||e.fire("SelectionChange"),t=o})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!ct.range&&e.selection.isCollapsed()||bf(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(function(t){!t.isDefaultPrevented()&&bf(e)&&("IMG"===e.selection.getNode().nodeName?wr.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}return e.prototype.nodeChanged=function(e){var t,n,r,o=this.editor.selection;this.editor.initialized&&o&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),(t=o.getStart(!0)||r).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,r)||(t=r),n=[],this.editor.dom.getParent(t,(function(e){if(e===r)return!0;n.push(e)})),(e=e||{}).element=t,e.parents=n,this.editor.fire("NodeChange",e))},e.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;t>=0&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},e}(),vk=function(e){!function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))}(e),function(e){e.parser.addNodeFilter("details",(function(e){q(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(function(e){q(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",_(t)?t:null),e.attr("data-mce-open",null)}))}))}(e)},bk=function(e){return pn(e)&&Or(pt.fromDom(e))},yk=function(e){e.on("click",(function(t){t.detail>=3&&function(e){var t=e.selection.getRng(),n=cu.fromRangeStart(t),r=cu.fromRangeEnd(t);if(cu.isElementPosition(n)){var o=n.container();bk(o)&&ms(o).each((function(e){return t.setStart(e.container(),e.offset())}))}if(cu.isElementPosition(r)){o=n.container();bk(o)&&ps(o).each((function(e){return t.setEnd(e.container(),e.offset())}))}e.selection.setRng(bg(t))}(e)}))},wk=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.documentElement,o=n.defaultView;return{top:t.top+o.pageYOffset-r.clientTop,left:t.left+o.pageXOffset-r.clientLeft}},Ck=function(e,t){return function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}}(function(e){return e.inline?wk(e.getBody()):{left:0,top:0}}(e),function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}}(e),function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=wk(e.getContentAreaContainer()),r=function(e){var t=e.getBody(),n=e.getDoc().documentElement,r={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?r:o}(e);return{left:t.pageX-n.left+r.left,top:t.pageY-n.top+r.top}}return{left:t.pageX,top:t.pageY}}(e,t))},xk=Nn,kk=An,Sk=function(e,t,n,r){var o=e.dom,i=t.cloneNode(!0);o.setStyles(i,{width:n,height:r}),o.setAttrib(i,"data-mce-selected",null);var a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),o.setStyles(i,{margin:0,boxSizing:"border-box"}),a.appendChild(i),a},Tk=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},Ek=function(e,t){return function(n){if(function(e){return 0===e.button}(n)){var r=G(t.dom.getParents(n.target),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}(xk,kk)).getOr(null);if(c=t.getBody(),xk(u=r)&&u!==c){var o=t.dom.getPos(r),i=t.getBody(),a=t.getDoc().documentElement;e.set({element:r,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?i.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?i.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:r.offsetWidth,height:r.offsetHeight,ghost:Sk(t,r,r.offsetWidth,r.offsetHeight)})}}var c,u}},_k=function(e,t){return function(n){e.on((function(e){if(e.dragging&&function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!xk(t)}(t,(a=t.selection,3===(c=a.getSel().getRangeAt(0).startContainer).nodeType?c.parentNode:c),e.element)){var r=(o=e.element,(i=o.cloneNode(!0)).removeAttribute("data-mce-selected"),i);t.fire("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact((function(){Tk(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()}))}var o,i,a,c})),Ak(e)}},Ak=function(e){e.on((function(e){Tk(e.ghost)})),e.clear()},Nk=function(e){var t,n=(t=Qa(k.none()),{clear:function(){return t.set(k.none())},set:function(e){return t.set(k.some(e))},isSet:function(){return t.get().isSome()},on:function(e){return t.get().each(e)}}),r=Ka.DOM,o=document,i=Ek(n,e),a=function(e,t){var n=wr.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return t.on("remove",n.stop),function(r){return e.on((function(e){var o,i,a=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(!e.dragging&&a>10){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var c=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}}(e,Ck(t,r));o=e.ghost,i=t.getBody(),o.parentNode!==i&&i.appendChild(o),function(e,t,n,r,o,i){var a=0,c=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(a=t.pageX+n-o),t.pageY+r>i&&(c=t.pageY+r-i),e.style.width=n-a+"px",e.style.height=r-c+"px"}(e.ghost,c,e.width,e.height,e.maxX,e.maxY),n(r.clientX,r.clientY)}}))}}(n,e),c=_k(n,e),u=function(e,t){return function(){e.on((function(e){e.dragging&&t.fire("dragend")})),Ak(e)}}(n,e);e.on("mousedown",i),e.on("mousemove",a),e.on("mouseup",c),r.bind(o,"mousemove",a),r.bind(o,"mouseup",u),e.on("remove",(function(){r.unbind(o,"mousemove",a),r.unbind(o,"mouseup",u)}))},Rk=function(e){Nk(e),function(e){e.on("drop",(function(t){var n=void 0!==t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(xk(n)||"false"===e.dom.getContentEditableParent(n))&&t.preventDefault()}))}(e),function(e){return e.getParam("block_unsupported_drop",!0,"boolean")}(e)&&function(e){var t=function(t){if(!t.defaultPrevented){var n=t.dataTransfer;n&&(U(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&Ab(e,"Dropped file type is not supported"))}},n=function(n){Ud(e,n.target)&&t(n)},r=function(){var r=Ka.DOM,o=e.dom,i=document,a=e.inline?e.getBody():e.getDoc(),c=["drop","dragover"];q(c,(function(e){r.bind(i,e,n),o.bind(a,e,t)})),e.on("remove",(function(){q(c,(function(e){r.unbind(i,e,n),o.unbind(a,e,t)}))}))};e.on("init",(function(){wr.setEditorTimeout(e,r,0)}))}(e)},Ok=An,Dk=Nn,Ik=function(e,t){return Rf(e.getBody(),t)},Pk=function(e){var t,n=e.selection,r=e.dom,o=r.isBlock,i=e.getBody(),a=hl(e,i,o,(function(){return Jd(e)})),c="sel-"+r.uniqueId(),u=function(e){return e!==i&&(Dk(e)||On(e))&&r.isChildOf(e,i)},l=function(e){e&&n.setRng(e)},s=n.getRng,f=function(t,r,o,i){return void 0===i&&(i=!0),e.fire("ShowCaret",{target:r,direction:t,before:o}).isDefaultPrevented()?null:(i&&n.scrollIntoView(r,-1===t),a.show(o,r))},d=function(e){return Wr(e)||Jr(e)||Gr(e)},m=function(e){return d(e.startContainer)||d(e.endContainer)},p=function(t){var n=e.schema.getShortEndedElements(),o=r.createRng(),i=t.startContainer,a=t.startOffset,c=t.endContainer,u=t.endOffset;return he(n,i.nodeName.toLowerCase())?0===a?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,a),he(n,c.nodeName.toLowerCase())?0===u?o.setEndBefore(c):o.setEndAfter(c):o.setEnd(c,u),o},g=function(o){var i=o.cloneNode(!0),a=e.fire("ObjectSelected",{target:o,targetClone:i});if(a.isDefaultPrevented())return null;var u=function(t,o,i){var a=e.$,u=pr(pt.fromDom(e.getBody()),"#"+c).fold((function(){return a([])}),(function(e){return a([e.dom])}));0===u.length&&(u=a('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",c)).appendTo(e.getBody());var l=r.createRng();o===i&&ct.ie?(u.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(o),l.setStartAfter(u[0].firstChild.firstChild),l.setEndAfter(o)):(u.empty().append(" ").append(o).append(" "),l.setStart(u[0].firstChild,1),l.setEnd(u[0].lastChild,0)),u.css({top:r.getPos(t,e.getBody()).y}),u[0].focus();var s=n.getSel();return s.removeAllRanges(),s.addRange(l),l}(o,a.targetClone,i),l=pt.fromDom(o);return q(gc(pt.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){bt(l,e)||Fn(e,"data-mce-selected")})),r.getAttrib(o,"data-mce-selected")||o.setAttribute("data-mce-selected","1"),t=o,b(),u},h=function(e,t){if(!e)return null;if(e.collapsed){if(!m(e)){var n=t?1:-1,o=Ul(n,i,e),a=o.getNode(!t);if(yl(a))return f(n,a,!!t&&!o.isAtEnd(),!1);var c=o.getNode(t);if(yl(c))return f(n,c,!t&&!o.isAtEnd(),!1)}return null}var l=e.startContainer,s=e.startOffset,d=e.endOffset;if(3===l.nodeType&&0===s&&Dk(l.parentNode)&&(l=l.parentNode,s=r.nodeIndex(l),l=l.parentNode),1!==l.nodeType)return null;if(d===s+1&&l===e.endContainer){var p=l.childNodes[s];if(u(p))return g(p)}return null},v=function(){t&&t.removeAttribute("data-mce-selected"),pr(pt.fromDom(e.getBody()),"#"+c).each(Zt),t=null},b=function(){a.hide()};return ct.ceFalse&&function(){e.on("mouseup",(function(t){var n=s();n.collapsed&&Cb(e,t.clientX,t.clientY)&&_y(e,n,!1).each(l)})),e.on("click",(function(t){var o=Ik(e,t.target);o&&(Dk(o)&&(t.preventDefault(),e.focus()),Ok(o)&&r.isChildOf(o,n.getNode())&&v())})),e.on("blur NewBlock",v),e.on("ResizeWindow FullscreenStateChanged",a.reposition);var d=function(e){var t=ns(e);if(!e.firstChild)return!1;var n,r=lu.before(e.firstChild),o=t.next(r);return o&&!(Km(n=o)||Jm(n)||Wm(n)||qm(n))},g=function(t,n){var i,a,c=r.getParent(t,o),u=r.getParent(n,o);return!(!c||t===u||!r.isChildOf(c,u)||!1!==Dk(Ik(e,c)))||c&&(i=c,a=u,!(r.getParent(i,o)===r.getParent(a,o)))&&d(c)};e.on("tap",(function(t){var n=t.target,r=Ik(e,n);Dk(r)?(t.preventDefault(),Ey(e,r).each(h)):u(n)&&Ey(e,n).each(h)}),!0),e.on("mousedown",(function(t){var o=t.target;if((o===i||"HTML"===o.nodeName||r.isChildOf(o,i))&&!1!==Cb(e,t.clientX,t.clientY)){var a=Ik(e,o);if(a)Dk(a)?(t.preventDefault(),Ey(e,a).each(h)):(v(),Ok(a)&&t.shiftKey||Of(t.clientX,t.clientY,n.getRng())||(b(),n.placeCaretAt(t.clientX,t.clientY)));else if(u(o))Ey(e,o).each(h);else if(!1===yl(o)){v(),b();var c=OC(i,t.clientX,t.clientY);if(c&&!g(o,c.node)){t.preventDefault();var s=f(1,c.node,c.before,!1);e.getBody().focus(),l(s)}}}})),e.on("keypress",(function(e){Df.modifierPressed(e)||Dk(n.getNode())&&e.preventDefault()})),e.on("GetSelectionRange",(function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);(n=n.cloneRange()).selectNode(t),e.range=n}})),e.on("SetSelectionRange",(function(e){e.range=p(e.range);var t=h(e.range,e.forward);t&&(e.range=t)}));e.on("AfterSetSelectionRange",(function(e){var t=e.range,n=t.startContainer.parentNode;m(t)||"mcepastebin"===n.id||b(),function(e){return r.hasClass(e,"mce-offscreen-selection")}(n)||v()})),e.on("copy",(function(e){var t,n=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!ct.ie){var o=(t=r.get(c))?t.getElementsByTagName("*")[0]:t;o&&(e.preventDefault(),n.clearData(),n.setData("text/html",o.outerHTML),n.setData("text/plain",o.outerText||o.innerText))}})),Rk(e),function(e){var t=ic((function(){if(!e.removed&&e.getBody().contains(document.activeElement)){var t=e.selection.getRng();if(t.collapsed){var n=Ay(e,t,!1);e.selection.setRng(n)}}}),0);e.on("focus",(function(){t.throttle()})),e.on("blur",(function(){t.cancel()}))}(e),function(e){e.on("init",(function(){e.on("focusin",(function(t){var n=t.target;if(On(n)){var r=Rf(e.getBody(),n),o=Nn(r)?r:n;e.selection.getNode()!==o&&Ey(e,o).each((function(t){return e.selection.setRng(t)}))}}))}))}(e)}(),{showCaret:f,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(Xr(e),l(s()),n.scrollIntoView(e))},hideFakeCaret:b,destroy:function(){a.destroy(),t=null}}},Bk=function(e){var t,n,r,o=dt.each,i=Df.BACKSPACE,a=Df.DELETE,c=e.dom,u=e.selection,l=e.parser,s=ct.gecko,f=ct.ie,d=ct.webkit,m=f?"Text":"URL",p=function(t,n){try{e.getDoc().execCommand(t,!1,n)}catch(e){}},g=function(e){return e.isDefaultPrevented()},h=function(){e.shortcuts.add("meta+a",null,"SelectAll")},v=function(){e.on("keydown",(function(e){if(!g(e)&&e.keyCode===i&&u.isCollapsed()&&0===u.getRng().startOffset){var t=u.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},b=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(ct.ie>11)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}})))};return e.on("keydown",(function(t){var n,r;if(!g(t)&&t.keyCode===Df.BACKSPACE){var o=(n=u.getRng()).startContainer,i=n.startOffset,a=c.getRoot();if(r=o,n.collapsed&&0===i){for(;r&&r.parentNode&&r.parentNode.firstChild===r&&r.parentNode!==a;)r=r.parentNode;"BLOCKQUOTE"===r.tagName&&(e.formatter.toggle("blockquote",null,r),(n=c.createRng()).setStart(o,0),n.setEnd(o,0),u.setRng(n))}}})),t=function(e){var t=c.create("body"),n=e.cloneContents();return t.appendChild(n),u.serializer.serialize(t,{format:"html"})},e.on("keydown",(function(n){var r,o,u=n.keyCode;if(!g(n)&&(u===a||u===i)){if(r=e.selection.isCollapsed(),o=e.getBody(),r&&!c.isEmpty(o))return;if(!r&&!function(n){var r=t(n),o=c.createRng();return o.selectNode(e.getBody()),r===t(o)}(e.selection.getRng()))return;n.preventDefault(),e.setContent(""),o.firstChild&&c.isBlock(o.firstChild)?e.selection.setCursorLocation(o.firstChild,0):e.selection.setCursorLocation(o,0),e.nodeChanged()}})),ct.windowsPhone||e.on("keyup focusin mouseup",(function(e){Df.modifierPressed(e)||u.normalize()}),!0),d&&(e.inline||c.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement)if(n=u.getRng(),e.getBody().focus(),"mousedown"===t.type){if(Wr(n.startContainer))return;u.placeCaretAt(t.clientX,t.clientY)}else u.setRng(n)})),e.on("click",(function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==c.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&c.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),u.select(n))})),Bu(e)&&e.on("init",(function(){p("DefaultParagraphSeparator",Bu(e))})),e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))})),v(),l.addNodeFilter("br",(function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()})),ct.iOS?(e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()})),b(),e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):h()),ct.ie>=11&&(b(),v()),ct.ie&&(h(),p("AutoUrlDetect",!1),e.on("dragstart",(function(t){!function(t){var n,r;t.dataTransfer&&(e.selection.isCollapsed()&&"IMG"===t.target.tagName&&u.select(t.target),(n=e.selection.getContent()).length>0&&(r="data:text/mce-internal,"+escape(e.id)+","+escape(n),t.dataTransfer.setData(m,r)))}(t)})),e.on("drop",(function(t){if(!g(t)){var n=function(e){var t;return e.dataTransfer&&(t=e.dataTransfer.getData(m))&&t.indexOf("data:text/mce-internal,")>=0?(t=t.substr("data:text/mce-internal,".length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null}(t);if(n&&n.id!==e.id){t.preventDefault();var r=Mf(t.x,t.y,e.getDoc());u.setRng(r),o=n.html,i=!0,e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:o,internal:i}):e.execCommand("mceInsertContent",!1,o)}}var o,i}))),s&&(e.on("keydown",(function(t){if(!g(t)&&t.keyCode===i){if(!e.getBody().getElementsByTagName("hr").length)return;if(u.isCollapsed()&&0===u.getRng().startOffset){var n=u.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return c.remove(n),void t.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(c.remove(r),t.preventDefault())}}})),Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!g(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur(),wr.setEditorTimeout(e,(function(){n.focus()}))}})),n=function(){var t=c.getAttribs(u.getStart().cloneNode(!1));return function(){var n=u.getStart();n!==e.getBody()&&(c.setAttrib(n,"style",null),o(t,(function(e){n.setAttributeNode(e.cloneNode(!0))})))}},r=function(){return!u.isCollapsed()&&c.getParent(u.getStart(),c.isBlock)!==c.getParent(u.getEnd(),c.isBlock)},e.on("keypress",(function(t){var o;if(!g(t)&&(8===t.keyCode||46===t.keyCode)&&r())return o=n(),e.getDoc().execCommand("delete",!1,null),o(),t.preventDefault(),!1})),c.bind(e.getDoc(),"cut",(function(t){var o;!g(t)&&r()&&(o=n(),wr.setEditorTimeout(e,(function(){o()})))})),function(e){return e.getParam("readonly")}(e)||e.on("BeforeExecCommand mousedown",(function(){p("StyleWithCSS",!1),p("enableInlineTableEditing",!1),Ju(e)||p("enableObjectResizing",!1)})),e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||o(c.select("a"),(function(e){var t=e.parentNode,n=c.getRoot();if(t.lastChild===e){for(;t&&!c.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}c.add(t,"br",{"data-mce-bogus":1})}}))})),e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),ct.mac&&e.on("keydown",(function(t){!Df.metaKeyPressed(t)||t.shiftKey||37!==t.keyCode&&39!==t.keyCode||(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))})),v()),{refreshContentEditable:function(){},isHidden:function(){if(!s||e.removed)return!1;var t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount}}},Mk=Ka.DOM,Lk=function(e){return e.inline?e.getElement().nodeName.toLowerCase():void 0},Fk=function(e){return me(e,(function(e){return!1===D(e)}))},jk=function(e){var t=e.settings,n=e.editorUpload.blobCache;return Fk({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:Lk(e),validate:!0,blob_cache:n,images_dataimg_filter:t.images_dataimg_filter})},Hk=function(e){var t=e.dom.getRoot();e.inline||bf(e)&&e.selection.getStart(!0)!==t||ms(t).each((function(t){var n=t.getNode(),r=yn(n)?ms(n).getOr(t):t;ct.browser.isIE()?function(e,t){var n=pt.fromDom(e.getBody()),r=(Od(e)?k.from(t):k.none()).map(Dd).filter(Rd(n));e.bookmark=r.isSome()?r:e.bookmark}(e,r.toRange()):e.selection.setRng(r.toRange())}))},Uk=function(e){e.bindPendingEventDelegates(),e.initialized=!0,function(e){e.fire("Init")}(e),e.focus(!0),Hk(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),function(e){e.settings.auto_focus&&wr.setEditorTimeout(e,(function(){var t;(t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus)).destroyed||t.focus()}),100)}(e)},zk=function(e,t){var n=e.settings,r=e.getDoc(),o=e.getBody();n.browser_spellcheck||n.gecko_spellcheck||(r.body.spellcheck=!1,Mk.setAttrib(o,"spellcheck","false")),e.quirks=Bk(e),function(e){e.fire("PostRender")}(e);var i=function(e){return e.getParam("directionality",nc.isRtl()?"rtl":void 0)}(e);if(void 0!==i&&(o.dir=i),n.protect&&e.on("BeforeSetContent",(function(e){dt.each(n.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),e.on("SetContent",(function(){e.addVisual(e.getBody())})),!1===t&&e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"}),e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type})),e.contentStyles.length>0){var a="";dt.each(e.contentStyles,(function(e){a+=e+"\r\n"})),e.dom.addStyle(a)}!function(e,t){var n=function(e){return e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader}(e),r=function(){e.on("remove",(function(){return n.unloadAll(t)})),Uk(e)};n.loadAll(t,r,r)}(e,e.contentCSS),n.content_style&&function(e,t){var n=pt.fromDom(e.getBody()),r=qt(Wt(n)),o=pt.fromTag("style");Pn(o,"type","text/css"),Xt(o,pt.fromText(t)),Xt(r,o),e.on("remove",(function(){Zt(o)}))}(e,n.content_style)},Wk=function(e,t){var n=e.settings,r=e.getElement(),o=e.getDoc();n.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline||(o.open(),o.write(e.iframeHTML),o.close()),e.inline&&(Mk.addClass(r,"mce-content-body"),e.contentDocument=o=document,e.contentWindow=window,e.bodyElement=r,e.contentAreaContainer=r);var i=e.getBody();i.disabled=!0,e.readonly=!!n.readonly,e.readonly||(e.inline&&"static"===Mk.getStyle(i,"position",!0)&&(i.style.position="relative"),i.contentEditable=e.getParam("content_editable_state",!0)),i.disabled=!1,e.editorUpload=Lb(e),e.schema=qo(n),e.dom=Ka(o,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:n.force_hex_style_colors,update_styles:!0,root_element:e.inline?e.getBody():null,collect:function(){return e.inline},schema:e.schema,contentCssCors:qu(e),referrerPolicy:Vu(e),onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=function(e){var t=Mv(jk(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(function(t,n){for(var r,o,i=t.length,a=e.dom,c="data-mce-"+n;i--;)if((o=(r=t[i]).attr(n))&&!r.attr(c)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===n?((o=a.serializeStyle(a.parseStyle(o),r.name)).length||(o=null),r.attr(c,o),r.attr(n,o)):"tabindex"===n?(r.attr(c,o),r.attr(n,null)):r.attr(c,e.convertURL(o,n,r.name))}})),t.addNodeFilter("script",(function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}})),e.settings.preserve_cdata&&t.addNodeFilter("#cdata",(function(t){for(var n=t.length;n--;){var r=t[n];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode(r.value)+"]]"}})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){for(var n=t.length,r=e.schema.getNonEmptyElements();n--;){var o=t[n];o.isEmpty(r)&&0===o.getAll("br").length&&(o.append(new bm("br",1)).shortEnded=!0)}})),t}(e),e.serializer=Uv(function(e){var t=e.settings;return Ee(Ee({},jk(e)),Fk({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope,element_format:t.element_format,entities:t.entities,entity_encoding:t.entity_encoding,indent:t.indent,indent_after:t.indent_after,indent_before:t.indent_before,block_elements:t.block_elements,boolean_attributes:t.boolean_attributes,custom_elements:t.custom_elements,extended_valid_elements:t.extended_valid_elements,invalid_elements:t.invalid_elements,invalid_styles:t.invalid_styles,move_caret_before_on_enter_elements:t.move_caret_before_on_enter_elements,non_empty_elements:t.non_empty_elements,schema:t.schema,self_closing_elements:t.self_closing_elements,short_ended_elements:t.short_ended_elements,special:t.special,text_block_elements:t.text_block_elements,text_inline_elements:t.text_inline_elements,valid_children:t.valid_children,valid_classes:t.valid_classes,valid_elements:t.valid_elements,valid_styles:t.valid_styles,verify_html:t.verify_html,whitespace_elements:t.whitespace_elements}))}(e),e),e.selection=hv(e.dom,e.getWin(),e.serializer,e),e.annotator=_f(e),e.formatter=Vb(e),e.undoManager=$b(e),e._nodeChangeDispatcher=new hk(e),e._selectionOverrides=Pk(e),Gw(e),vk(e),av(e)||yk(e);var a=function(e){return av(e)?Qa(null):gk(e)}(e);Kw(e,a),function(e){Bu(e)&&e.on("NodeChange",p(Zw,e))}(e),Xb(e),function(e){e.fire("PreInit")}(e),function(e){var t=e;return ge(e.plugins,"rtc").fold((function(){return t.rtcInstance=ov(e),k.none()}),(function(n){return k.some(n.setup().then((function(n){return t.rtcInstance=iv(e,n),n.isRemote})))}))}(e).fold((function(){zk(e,!1)}),(function(t){e.setProgressState(!0),t.then((function(t){e.setProgressState(!1),zk(e,t)}))}))},qk=Ka.DOM,Vk=function(e){var t=function(e){return e.getParam("doctype","<!DOCTYPE html>")}(e)+"<html><head>";(function(e){return e.getParam("document_base_url","")})(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=function(e){return Iu(e,"body_id","tinymce")}(e),r=function(e){return Iu(e,"body_class","")}(e);return Pu(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+Pu(e)+'" />'),t+='</head><body id="'+n+'" class="mce-content-body '+r+'" data-id="'+e.id+'"><br></body></html>'},$k=function(e,t){var n=e.editorManager.translate("Rich Text Area. Press ALT-0 for help."),r=function(e,t,n,r){var o=pt.fromTag("iframe");return Bn(o,r),Bn(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),fc(o,"tox-edit-area__iframe"),o}(e.id,n,t.height,function(e){return e.getParam("iframe_attrs",{})}(e)).dom;r.onload=function(){r.onload=null,e.fire("load")};var o=function(e,t){if(document.domain!==window.location.hostname&&ct.browser.isIE()){var n=Mb("mce");e[n]=function(){Wk(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return qk.setAttrib(t,"src",r),!0}return!1}(e,r);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=Vk(e),qk.add(t.iframeContainer,r),o},Kk=Ka.DOM,Jk=function(e,t,n){var r=Sb.get(n),o=Sb.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=dt.trim(n),r&&-1===dt.inArray(t,n)){if(dt.each(Sb.dependencies(n),(function(n){Jk(e,t,n)})),e.plugins[n])return;try{var i=new r(e,o,e.$);e.plugins[n]=i,i.init&&(i.init(e,o),t.push(n))}catch(t){!function(e,t,n){var r=nc.translate(["Failed to initialize plugin: {0}",t]);Db(r,n),Ab(e,r)}(e,n,t)}}},Gk=function(e){return e.replace(/^\-/,"")},Xk=function(e){return{editorContainer:e,iframeContainer:e,api:{}}},Yk=function(e){var t=e.getElement();return e.inline?Xk(null):function(e){var t=Kk.create("div");return Kk.insertAfter(t,e),Xk(t)}(t)},Qk=function(e){var t=e.getElement();return e.orgDisplay=t.style.display,_(Xu(e))?function(e){return e.theme.renderUI()}(e):B(Xu(e))?function(e){var t=e.getElement(),n=Xu(e)(e,t);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||e.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||e.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:t.offsetHeight,n}(e):Yk(e)},Zk=function(e){e.fire("ScriptsLoaded"),function(e){var t=dt.trim(ju(e)),n=e.ui.registry.getAll().icons,r=Ee(Ee({},pb.get("default").icons),pb.get(t).icons);ce(r,(function(t,r){he(n,r)||e.ui.registry.addIcon(r,t)}))}(e),function(e){var t=Xu(e);if(_(t)){e.settings.theme=Gk(t);var n=Tb.get(t);e.theme=new n(e,Tb.urls[t]),e.theme.init&&e.theme.init(e,Tb.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}}(e),function(e){var t=[];dt.each(el(e).split(/[ ,]/),(function(n){Jk(e,t,Gk(n))}))}(e);var t=Qk(e);!function(e,t){var n={show:k.from(t.show).getOr(s),hide:k.from(t.hide).getOr(s),disable:k.from(t.disable).getOr(s),isDisabled:k.from(t.isDisabled).getOr(b),enable:function(){e.mode.isReadOnly()||k.from(t.enable).map(v)}};e.ui=Ee(Ee({},e.ui),n)}(e,k.from(t.api).getOr({}));var n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,function(e){e.contentCSS=e.contentCSS.concat(Ib(e))}(e),e.inline?Wk(e):function(e,t){var n=$k(e,t);t.editorContainer&&(qk.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=qk.isHidden(t.editorContainer)),e.getElement().style.display="none",qk.setAttrib(e.id,"aria-hidden","true"),n||Wk(e)}(e,n)},eS=Ka.DOM,tS=function(e){return"-"===e.charAt(0)},nS=function(e,t){var n=$u(t),r=function(e){return e.getParam("language_url","","string")}(t);if(!1===nc.hasCode(n)&&"en"!==n){var o=""!==r?r:t.editorManager.baseURL+"/langs/"+n+".js";e.add(o,s,void 0,(function(){!function(e,t,n){Nb(e,"LanguageLoadError",Rb("language",t,n))}(t,o,n)}))}},rS=function(e,t,n){return k.from(t).filter((function(e){return e.length>0&&!pb.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:k.some(t)}}))},oS=function(e,t,n){var r=rS(t,"default",n),o=function(e){return k.from(function(e){return e.getParam("icons_url","","string")}(e)).filter((function(e){return e.length>0})).map((function(e){return{url:e,name:k.none()}}))}(t).orThunk((function(){return rS(t,ju(t),"")}));q(function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([r,o]),(function(n){e.add(n.url,s,void 0,(function(){!function(e,t,n){Nb(e,"IconsLoadError",Rb("icons",t,n))}(t,n.url,n.name.getOrUndefined())}))}))},iS=function(e,t){var n=Ya.ScriptLoader;!function(e,t,n,r){var o=Xu(t);if(_(o)){if(!tS(o)&&!Tb.urls.hasOwnProperty(o)){var i=function(e){return e.getParam("theme_url")}(t);i?Tb.load(o,t.documentBaseURI.toAbsolute(i)):Tb.load(o,"themes/"+o+"/theme"+n+".js")}e.loadQueue((function(){Tb.waitFor(o,r)}))}else r()}(n,e,t,(function(){nS(n,e),oS(n,e,t),function(e,t){dt.each(function(e){return e.getParam("external_plugins")}(e),(function(t,n){Sb.load(n,t,s,void 0,(function(){Ob(e,t,n)})),e.settings.plugins+=" "+n})),dt.each(el(e).split(/[ ,]/),(function(n){if((n=dt.trim(n))&&!Sb.urls[n])if(tS(n)){n=n.substr(1,n.length);var r=Sb.dependencies(n);dt.each(r,(function(n){var r={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"},o=Sb.createUrl(r,n);Sb.load(o.resource,o,s,void 0,(function(){Ob(e,o.prefix+o.resource+o.suffix,o.resource)}))}))}else{var o={prefix:"plugins/",resource:n,suffix:"/plugin"+t+".js"};Sb.load(n,o,s,void 0,(function(){Ob(e,o.prefix+o.resource+o.suffix,n)}))}}))}(e,t),n.loadQueue((function(){e.removed||Zk(e)}),e,(function(){e.removed||Zk(e)}))}))},aS=function(e){var t=e.id;nc.setCode($u(e));var n=function(){eS.unbind(window,"ready",n),e.render()};if(bi.Event.domLoaded){if(e.getElement()&&ct.contentEditable){var r=pt.fromDom(e.getElement()),o=function(e){return J(e.dom.attributes,(function(e,t){return e[t.name]=t.value,e}),{})}(r);e.on("remove",(function(){V(r.dom.attributes,(function(e){return Fn(r,e.name)})),Bn(r,o)})),e.ui.styleSheetLoader=function(e,t){return Sr.forElement(e,{contentCssCors:Zu(t),referrerPolicy:Vu(t)})}(r,e),!function(e){return e.getParam("inline")}(e)?(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden"):e.inline=!0;var i=e.getElement().form||eS.getParent(t,"form");i&&(e.formElement=i,function(e){return e.getParam("hidden_input")}(e)&&!Cn(e.getElement())&&(eS.insertAfter(eS.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},eS.bind(i,"submit reset",e.formEventDelegate),e.on("reset",(function(){e.resetContent()})),!function(e){return e.getParam("submit_patch")}(e)||i.submit.nodeType||i.submit.length||i._mceOldSubmit||(i._mceOldSubmit=i.submit,i.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),i._mceOldSubmit(i)})),e.windowManager=Eb(e),e.notificationManager=kb(e),function(e){return"xml"===e.getParam("encoding")}(e)&&e.on("GetContent",(function(e){e.save&&(e.content=eS.encode(e.content))})),function(e){return e.getParam("add_form_submit_trigger")}(e)&&e.on("submit",(function(){e.initialized&&e.save()})),function(e){return e.getParam("add_unload_trigger")}(e)&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),iS(e,e.suffix)}}else eS.bind(window,"ready",n)},cS=function(e,t){return function(e,t){return uv(e).editor.addVisual(t)}(e,t)},uS={"font-size":"size","font-family":"face"},lS=function(e,t,n){return om(pt.fromDom(n),(function(t){return function(t){return zn(t,e).orThunk((function(){return"font"===Ct(t)?ge(uS,e).bind((function(e){return Ln(t,e)})):k.none()}))}(t)}),(function(e){return bt(pt.fromDom(t),e)}))},sS=function(e){return function(t,n){return k.from(n).map(pt.fromDom).filter(St).bind((function(n){return lS(e,t,n.dom).or(function(e,t){return k.from(Ka.DOM.getStyle(t,e,!0))}(e,n.dom))})).getOr("")}},fS=sS("font-size"),dS=f((function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")}),sS("font-family")),mS=function(e){return ms(e.getBody()).map((function(e){var t=e.container();return xn(t)?t.parentNode:t}))},pS=function(e,t){return function(e){return k.from(e.selection.getRng()).bind((function(t){var n=e.getBody();return t.startContainer===n&&0===t.startOffset?k.none():k.from(e.selection.getStart(!0))}))}(e).orThunk(p(mS,e)).map(pt.fromDom).filter(St).map(t)},gS=function(e,t){if(/^[0-9.]+$/.test(t)){var n=parseInt(t,10);if(n>=1&&n<=7){var r=function(e){return dt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large"))}(e),o=function(e){return dt.explode(e.getParam("font_size_classes",""))}(e);return o?o[n-1]||t:r[n-1]||t}return t}return t},hS=function(e){var t=e.split(/\s*,\s*/);return W(t,(function(e){return-1===e.indexOf(" ")||Be(e,'"')||Be(e,"'")?e:"'"+e+"'"})).join(",")},vS=function(e,t){var n=function(e){var t;return"string"!=typeof e?(t=dt.extend({paste:e.paste,data:{paste:e.paste}},e),{content:e.content,details:t}):{content:e,details:{}}}(t);!function(e,t,n){cv(e).editor.insertContent(t,n)}(e,n.content,n.details)},bS=dt.each,yS=dt.map,wS=dt.inArray,CS=function(){function e(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}return e.prototype.execCommand=function(e,t,n,r){var o,i=!1,a=this;if(!a.editor.removed){var c;if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||r&&r.skip_focus?(c=a.editor,Md(c).each((function(e){return c.selection.setRng(e)}))):a.editor.focus(),(r=a.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n})).isDefaultPrevented())return!1;var u=e.toLowerCase();if(o=a.commands.exec[u])return o(u,t,n),a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(bS(this.editor.plugins,(function(r){if(r.execCommand&&r.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),i=!0,!1})),i)return i;if(a.editor.theme&&a.editor.theme.execCommand&&a.editor.theme.execCommand(e,t,n))return a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{i=a.editor.getDoc().execCommand(e,t,n)}catch(e){}return!!i&&(a.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},e.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(e){}return!1}},e.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(e){}}},e.prototype.addCommands=function(e,t){void 0===t&&(t="exec");var n=this;bS(e,(function(e,r){bS(r.toLowerCase().split(","),(function(r){n.commands[t][r]=e}))}))},e.prototype.addCommand=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,o,i,a){return t.call(n||r.editor,o,i,a)}},e.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(e){}return!1},e.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},e.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},e.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},e.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},e.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},e.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t?{value:t}:void 0),this.editor.nodeChanged()},e.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},e.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},e.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(n){var r,o=e.getDoc();try{t.execNativeCommand(n)}catch(e){r=!0}if("paste"!==n||o.queryCommandEnabled(n)||(r=!0),r||!o.queryCommandSupported(n)){var i=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");ct.mac&&(i=i.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:i,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var r=n.substring(7);"full"===r&&(r="justify"),bS("left,center,right,justify".split(","),(function(t){r!==t&&e.formatter.remove("align"+t)})),"none"!==r&&t.toggleFormat("align"+r)},"InsertUnorderedList,InsertOrderedList":function(n){var r;t.execNativeCommand(n);var o=e.dom.getParent(e.selection.getNode(),"ol,ul");o&&(r=o.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(r.nodeName)&&(t.storeSelection(),e.dom.split(r,o),t.restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,r){t.toggleFormat(e,r)},FontName:function(t,n,r){!function(e,t){var n=gS(e,t);e.formatter.toggle("fontname",{value:hS(n)}),e.nodeChanged()}(e,r)},FontSize:function(t,n,r){!function(e,t){e.formatter.toggle("fontsize",{value:gS(e,t)}),e.nodeChanged()}(e,r)},LineHeight:function(t,n,r){!function(e,t){e.undoManager.transact((function(){e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()}))}(e,r)},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,r){return t.toggleFormat(r||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,r,o){var i=o||e.selection.getNode();i!==e.getBody()&&(t.storeSelection(),e.dom.remove(i,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,r){var o=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&o++===r)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:function(t,n,r){e.selection.select(r)},mceInsertContent:function(t,n,r){vS(e,r)},mceInsertRawHTML:function(t,n,r){e.selection.setContent("tiny_mce_marker");var o=e.getContent();e.setContent(o.replace(/tiny_mce_marker/g,(function(){return r})))},mceInsertNewLine:function(t,n,r){ok(e,r)},mceToggleFormat:function(e,n,r){t.toggleFormat(r)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){qw(e,t)},mceRepaint:function(){},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,r){e.execCommand("mceInsertContent",!1,r.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,r){"string"==typeof r&&(r={href:r});var o=e.dom.getParent(e.selection.getNode(),"a");r.href=r.href.replace(/ /g,"%20"),o&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,o)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),An);if(t){var n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return Vx(e,r),!0}});var n=function(t){return function(){var n=e.selection,r=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks(),o=yS(r,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==wS(o,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return Uw(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",(function(){return function(e){return pS(e,(function(t){return dS(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("FontSize",(function(){return function(e){return pS(e,(function(t){return fS(e.getBody(),t.dom)})).getOr("")}(e)}),this),t.addQueryValueHandler("LineHeight",(function(){return function(e){return pS(e,(function(t){var n=pt.fromDom(e.getBody());return om(t,(function(e){return zn(e,"line-height")}),p(bt,n)).getOrThunk((function(){var e=parseFloat(Hn(t,"line-height")),n=parseFloat(Hn(t,"font-size"));return String(e/n)}))})).getOr("")}(e)}),this)},e}(),xS=function(e,t,n){mc(e,t)&&!1===n?function(e,t){uc(e)?e.dom.classList.remove(t):sc(e,t);dc(e)}(e,t):n&&fc(e,t)},kS=function(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},SS=function(e,t){e.dom.contentEditable=t?"true":"false"},TS=function(e,t){var n=pt.fromDom(e.getBody());xS(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),function(e){k.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")}))}(e),e.readonly=!0,SS(n,!1),q(gc(n,'*[contenteditable="true"]'),(function(e){Pn(e,"data-mce-contenteditable","true"),SS(e,!1)}))):(e.readonly=!1,SS(n,!0),function(e){q(gc(e,'*[data-mce-contenteditable="true"]'),(function(e){Fn(e,"data-mce-contenteditable"),SS(e,!0)}))}(n),kS(e,"StyleWithCSS",!1),kS(e,"enableInlineTableEditing",!1),kS(e,"enableObjectResizing",!1),Gd(e)&&e.focus(),function(e){e.selection.setRng(e.selection.getRng())}(e),e.nodeChanged())},ES=function(e){return e.readonly},_S=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){ES(e)&&q(t,(function(e){e.attr("data-mce-contenteditable",e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter("data-mce-contenteditable",(function(t){ES(e)&&q(t,(function(e){e.attr("contenteditable",e.attr("data-mce-contenteditable"))}))})),e.serializer.addTempAttr("data-mce-contenteditable")},AS=function(e,t){if(function(e){return"click"===e.type}(t)&&!Df.metaKeyPressed(t)){var n=pt.fromDom(t.target);(function(e,t){return gr(t,"a",(function(t){return bt(t,pt.fromDom(e.getBody()))})).bind((function(e){return Ln(e,"href")}))})(e,n).each((function(n){if(t.preventDefault(),/^#/.test(n)){var r=e.dom.select(n+',[name="'+((Be(o=n,i="#")?function(e,t){return e.substring(t)}(o,i.length):o)+'"]'));r.length&&e.selection.scrollIntoView(r[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes");var o,i}))}},NS=dt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),RS=function(){function e(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||b}return e.isNative=function(e){return!!NS[e.toLowerCase()]},e.prototype.fire=function(e,t){var n=e.toLowerCase(),r=t||{};r.type=n,r.target||(r.target=this.scope),r.preventDefault||(r.preventDefault=function(){r.isDefaultPrevented=y},r.stopPropagation=function(){r.isPropagationStopped=y},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=y},r.isDefaultPrevented=b,r.isPropagationStopped=b,r.isImmediatePropagationStopped=b),this.settings.beforeFire&&this.settings.beforeFire(r);var o=this.bindings[n];if(o)for(var i=0,a=o.length;i<a;i++){var c=o[i];if(c.once&&this.off(n,c.func),r.isImmediatePropagationStopped())return r.stopPropagation(),r;if(!1===c.func.call(this.scope,r))return r.preventDefault(),r}return r},e.prototype.on=function(e,t,n,r){if(!1===t&&(t=b),t){var o={func:t};r&&dt.extend(o,r);for(var i=e.toLowerCase().split(" "),a=i.length;a--;){var c=i[a],u=this.bindings[c];u||(u=this.bindings[c]=[],this.toggleEvent(c,!0)),n?u.unshift(o):u.push(o)}}return this},e.prototype.off=function(e,t){var n=this;if(e)for(var r=e.toLowerCase().split(" "),o=r.length;o--;){var i=r[o],a=this.bindings[i];if(!i)return ce(this.bindings,(function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]})),this;if(a){if(t)for(var c=a.length;c--;)a[c].func===t&&(a=a.slice(0,c).concat(a.slice(c+1)),this.bindings[i]=a);else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[i])}}else ce(this.bindings,(function(e,t){n.toggleEvent(t,!1)})),this.bindings={};return this},e.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},e.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},e}(),OS=function(e){return e._eventDispatcher||(e._eventDispatcher=new RS({scope:e,toggleEvent:function(t,n){RS.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},DS={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var r=OS(this).fire(e,t);if(!1!==n&&this.parent)for(var o=this.parent();o&&!r.isPropagationStopped();)o.fire(e,r,!1),o=o.parent();return r},on:function(e,t,n){return OS(this).on(e,t,n)},off:function(e,t){return OS(this).off(e,t)},once:function(e,t){return OS(this).once(e,t)},hasEventListeners:function(e){return OS(this).has(e)}},IS=Ka.DOM,PS=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=Gu(e);return n?(e.eventRoot||(e.eventRoot=IS.select(n)[0]),e.eventRoot):e.getBody()},BS=function(e,t,n){!function(e){return!e.hidden&&!ES(e)}(e)?ES(e)&&AS(e,n):e.fire(t,n)},MS=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var r=PS(e,t);if(Gu(e)){if(hC||(hC={},e.editorManager.on("removeEditor",(function(){e.editorManager.activeEditor||hC&&(ce(hC,(function(t,n){e.dom.unbind(PS(e,n))})),hC=null)}))),hC[t])return;n=function(n){for(var r=n.target,o=e.editorManager.get(),i=o.length;i--;){var a=o[i].getBody();(a===r||IS.isChildOf(r,a))&&BS(o[i],t,n)}},hC[t]=n,IS.bind(r,t,n)}else n=function(n){BS(e,t,n)},IS.bind(r,t,n),e.delegates[t]=n}},LS=Ee(Ee({},DS),{bindPendingEventDelegates:function(){var e=this;dt.each(e._pendingNativeEvents,(function(t){MS(e,t)}))},toggleNativeEvent:function(e,t){"focus"!==e&&"blur"!==e&&(t?this.initialized?MS(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&(this.dom.unbind(PS(this,e),e,this.delegates[e]),delete this.delegates[e]))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(ce(e.delegates,(function(t,n){e.dom.unbind(PS(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),FS=["design","readonly"],jS=function(e,t,n,r){var o=n[t.get()],i=n[r];try{i.activate()}catch(e){return void console.error("problem while activating editor mode "+r+":",e)}o.deactivate(),o.editorReadOnly!==i.editorReadOnly&&TS(e,i.editorReadOnly),t.set(r),function(e,t){e.fire("SwitchMode",{mode:t})}(e,r)},HS=function(e){var t=Qa("design"),n=Qa({design:{activate:s,deactivate:s,editorReadOnly:!1},readonly:{activate:s,deactivate:s,editorReadOnly:!0}});return function(e){e.serializer?_S(e):e.on("PreInit",(function(){_S(e)}))}(e),function(e){e.on("ShowCaret",(function(t){ES(e)&&t.preventDefault()})),e.on("ObjectSelected",(function(t){ES(e)&&t.preventDefault()}))}(e),{isReadOnly:function(){return ES(e)},set:function(r){return function(e,t,n,r){if(r!==n.get()){if(!he(t,r))throw new Error("Editor mode '"+r+"' is invalid");e.initialized?jS(e,n,t,r):e.on("init",(function(){return jS(e,n,t,r)}))}}(e,n.get(),t,r)},get:function(){return t.get()},register:function(e,t){n.set(function(e,t,n){var r;if(U(FS,t))throw new Error("Cannot override default mode "+t);return Ee(Ee({},e),((r={})[t]=Ee(Ee({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),r))}(n.get(),e,t))}}},US=dt.each,zS=dt.explode,WS={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},qS=dt.makeMap("alt,ctrl,shift,meta,access"),VS=function(){function e(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",(function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(US(t.shortcuts,(function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}return e.prototype.add=function(e,t,n,r){var o=this,i=o.normalizeCommandFunc(n);return US(zS(dt.trim(e)),(function(e){var n=o.createShortcut(e,t,i,r);o.shortcuts[n.id]=n})),!0},e.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},e.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:dt.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},e.prototype.parseShortcut=function(e){var t,n={};US(zS(e.toLowerCase(),"+"),(function(e){e in qS?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=WS[e]||e.toUpperCase().charCodeAt(0))}));var r=[n.keyCode];for(t in qS)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,ct.mac?n.ctrl=!0:n.shift=!0),n.meta&&(ct.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},e.prototype.createShortcut=function(e,t,n,r){var o=dt.map(zS(e,">"),this.parseShortcut);return o[o.length-1]=dt.extend(o[o.length-1],{func:n,scope:r||this.editor}),dt.extend(o[0],{desc:this.editor.translate(t),subpatterns:o.slice(1)})},e.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},e.prototype.isFunctionKey=function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123},e.prototype.matchShortcut=function(e,t){return!!t&&(t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&(t.alt===e.altKey&&t.shift===e.shiftKey&&(!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0))))},e.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},e}(),$S=function(){var e=function(){var e={},t={},n={},r={},o={},i={},a={},c=function(e,t){return function(n,r){return e[n.toLowerCase()]=Ee(Ee({},r),{type:t})}};return{addButton:c(e,"button"),addGroupToolbarButton:c(e,"grouptoolbarbutton"),addToggleButton:c(e,"togglebutton"),addMenuButton:c(e,"menubutton"),addSplitButton:c(e,"splitbutton"),addMenuItem:c(t,"menuitem"),addNestedMenuItem:c(t,"nestedmenuitem"),addToggleMenuItem:c(t,"togglemenuitem"),addAutocompleter:c(n,"autocompleter"),addContextMenu:c(o,"contextmenu"),addContextToolbar:c(i,"contexttoolbar"),addContextForm:c(i,"contextform"),addSidebar:c(a,"sidebar"),addIcon:function(e,t){return r[e.toLowerCase()]=t},getAll:function(){return{buttons:e,menuItems:t,icons:r,popups:n,contextMenus:o,contextToolbars:i,sidebars:a}}}}();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},KS=dt.each,JS=dt.trim,GS="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),XS={ftp:21,http:80,https:443,mailto:25},YS=function(){function e(t,n){t=JS(t),this.settings=n||{};var r=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))o.source=t;else{var i=0===t.indexOf("//");if(0!==t.indexOf("/")||i||(t=(r&&r.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){var a=this.settings.base_uri?this.settings.base_uri.path:new e(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)t="//mce_host"+o.toAbsPath(a,t);else{var c=/([^#?]*)([#?]?.*)/.exec(t);t=(r&&r.protocol||"http")+"://mce_host"+o.toAbsPath(a,c[1])+c[2]}}t=t.replace(/@@/g,"(mce_at)");var u=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);KS(GS,(function(e,t){var n=u[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[e]=n})),r&&(o.protocol||(o.protocol=r.protocol),o.userInfo||(o.userInfo=r.userInfo),o.port||"mce_host"!==o.host||(o.port=r.port),o.host&&"mce_host"!==o.host||(o.host=r.host),o.source=""),i&&(o.protocol="")}}return e.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),r=/data:([^;]+)/.exec(n[0]);return r&&(t=r[1]),{type:t,data:n[1]}},e.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},e.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},e.prototype.toRelative=function(t){var n;if("./"===t)return t;var r=new e(t,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();var o=this.getURI(),i=r.getURI();return o===i||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===i?o:(n=this.toRelPath(this.path,r.path),r.query&&(n+="?"+r.query),r.anchor&&(n+="#"+r.anchor),n)},e.prototype.toAbsolute=function(t,n){var r=new e(t,{base_uri:this});return r.getURI(n&&this.isSameOrigin(r))},e.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=XS[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},e.prototype.toRelPath=function(e,t){var n,r,o=0,i="",a=e.substring(0,e.lastIndexOf("/")).split("/"),c=t.split("/");if(a.length>=c.length)for(n=0,r=a.length;n<r;n++)if(n>=c.length||a[n]!==c[n]){o=n+1;break}if(a.length<c.length)for(n=0,r=c.length;n<r;n++)if(n>=a.length||a[n]!==c[n]){o=n+1;break}if(1===o)return t;for(n=0,r=a.length-(o-1);n<r;n++)i+="../";for(n=o-1,r=c.length;n<r;n++)i+=n!==o-1?"/"+c[n]:c[n];return i},e.prototype.toAbsPath=function(e,t){var n,r,o=0,i=[],a=/\/$/.test(t)?"/":"",c=e.split("/"),u=t.split("/");for(KS(c,(function(e){e&&i.push(e)})),c=i,n=u.length-1,i=[];n>=0;n--)0!==u[n].length&&"."!==u[n]&&(".."!==u[n]?o>0?o--:i.push(u[n]):o++);return 0!==(r=(n=c.length-o)<=0?Z(i).join("/"):c.slice(0,n).join("/")+"/"+Z(i).join("/")).indexOf("/")&&(r="/"+r),a&&r.lastIndexOf("/")!==r.length-1&&(r+=a),r},e.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},e}(),QS=Ka.DOM,ZS=dt.extend,eT=dt.each,tT=dt.resolve,nT=ct.ie,rT=function(){function e(e,t,n){var r=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,ZS(this,LS),this.settings=fb(this,e,this.documentBaseUrl,n.defaultSettings,t),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(Ya.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),Ka.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),oc.languageLoad=this.settings.language_load,oc.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new YS(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new VS(this),this.editorCommands=new CS(this),this.settings.cache_suffix&&(ct.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:$S(),styleSheetLoader:void 0,show:s,hide:s,enable:s,disable:s,isDisabled:b};var o=HS(this);this.mode=o,this.setMode=o.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=ja.overrideDefaults((function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}}))}return e.prototype.render=function(){aS(this)},e.prototype.focus=function(e){Yd(this,e)},e.prototype.hasFocus=function(){return Jd(this)},e.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=this,i=o.settings[e];if(i)return o.callbackLookup&&(r=o.callbackLookup[e])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?tT(r):0,i=tT(i),o.callbackLookup=o.callbackLookup||{},o.callbackLookup[e]={func:i,scope:r}),i.apply(r||o,t)},e.prototype.translate=function(e){return nc.translate(e)},e.prototype.getParam=function(e,t,n){return mb(this,e,t,n)},e.prototype.hasPlugin=function(e,t){return!!U(el(this).split(/[ ,]/),e)&&(!t||void 0!==Sb.get(e))},e.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},e.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},e.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},e.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},e.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},e.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},e.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},e.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},e.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},e.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(QS.show(this.getContainer()),QS.hide(this.id)),this.load(),this.fire("show"))},e.prototype.hide=function(){var e=this.getDoc();this.hidden||(nT&&e&&!this.inline&&e.execCommand("SelectAll"),this.save(),this.inline?(this.getBody().contentEditable="false",this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(QS.hide(this.getContainer()),QS.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.fire("hide"))},e.prototype.isHidden=function(){return!!this.hidden},e.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},e.prototype.load=function(e){var t,n=this.getElement();if(this.removed)return"";if(n){(e=e||{}).load=!0;var r=Cn(n)?n.value:n.innerHTML;return t=this.setContent(r,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=n=null,t}},e.prototype.save=function(e){var t,n,r=this,o=r.getElement();if(o&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=o,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,Cn(o)?o.value=t:(!e.is_removing&&r.inline||(o.innerHTML=t),(n=QS.getParent(r.id,"form"))&&eT(n.elements,(function(e){if(e.name===r.id)return e.value=t,!1}))),e.element=o=null,!1!==e.set_dirty&&r.setDirty(!1),t},e.prototype.setContent=function(e,t){return Wv(this,e,t)},e.prototype.getContent=function(e){return zv(this,e)},e.prototype.insertContent=function(e,t){t&&(e=ZS({content:e},t)),this.execCommand("mceInsertContent",!1,e)},e.prototype.resetContent=function(e){void 0===e?Wv(this,this.startContent,{format:"raw"}):Wv(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},e.prototype.isDirty=function(){return!this.isNotDirty},e.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},e.prototype.getContainer=function(){return this.container||(this.container=QS.get(this.editorContainer||this.id+"_parent")),this.container},e.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},e.prototype.getElement=function(){return this.targetElm||(this.targetElm=QS.get(this.id)),this.targetElm},e.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},e.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},e.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},e.prototype.convertURL=function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,r.remove_script_host)},e.prototype.addVisual=function(e){cS(this,e)},e.prototype.remove=function(){$v(this)},e.prototype.destroy=function(e){Kv(this,e)},e.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},e.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},e.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},e.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},e.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},e.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},e}(),oT=Ka.DOM,iT=dt.explode,aT=dt.each,cT=dt.extend,uT=0,lT=!1,sT=[],fT=[],dT=function(e){var t=e.type;aT(hT.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e)}}))},mT=function(e){e!==lT&&(e?ja(window).on("resize scroll",dT):ja(window).off("resize scroll",dT),lT=e)},pT=function(e){var t=fT;delete sT[e.id];for(var n=0;n<sT.length;n++)if(sT[n]===e){sT.splice(n,1);break}return fT=$(fT,(function(t){return e!==t})),hT.activeEditor===e&&(hT.activeEditor=fT.length>0?fT[0]:null),hT.focusedEditor===e&&(hT.focusedEditor=null),t.length!==fT.length},gT="CSS1Compat"!==document.compatMode,hT=Ee(Ee({},DS),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:ja,majorVersion:"5",minorVersion:"6.1",releaseDate:"2020-11-25",editors:sT,i18n:nc,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t,n="";t=YS.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/"));var r,o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,n=o.suffix;else{for(var i=document.getElementsByTagName("script"),a=0;a<i.length;a++){var c;if(""!==(c=i[a].src||"")){var u=c.substring(c.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(c)){-1!==u.indexOf(".min")&&(n=".min"),e=c.substring(0,c.lastIndexOf("/"));break}}}if(!e&&document.currentScript)-1!==(c=document.currentScript.src).indexOf(".min")&&(n=".min"),e=c.substring(0,c.lastIndexOf("/"))}this.baseURL=new YS(t).toAbsolute(e),this.documentBaseURL=t,this.baseURI=new YS(this.baseURL),this.suffix=n,(r=this).on("AddEditor",p(zd,r)),r.on("RemoveEditor",p(Wd,r))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t);var n=e.suffix;e.suffix&&(this.suffix=n),this.defaultSettings=e;var r=e.plugin_base_urls;void 0!==r&&ce(r,(function(e,t){oc.PluginManager.urls[t]=e}))},init:function(e){var t,n=this,r=dt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=function(e){var t=e.id;return t||(t=ge(e,"name").filter((function(e){return!oT.get(e)})).getOrThunk(oT.uniqueId),e.setAttribute("id",t)),t},i=function(e,t){return t.constructor===RegExp?t.test(e.className):oT.hasClass(e,t)},a=function(e){t=e},c=function(){var t,u=0,l=[],s=function(e,r,o){var i=new rT(e,r,n);l.push(i),i.on("init",(function(){++u===t.length&&a(l)})),i.targetElm=i.targetElm||o,i.render()};oT.unbind(window,"ready",c),function(t){var r=e[t];if(r)r.apply(n,Array.prototype.slice.call(arguments,2))}("onpageload"),t=ja.unique(function(e){var t=[];if(ct.browser.isIE()&&ct.browser.version.major<11)return Db("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(gT)return Db("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(e.types)return aT(e.types,(function(e){t=t.concat(oT.select(e.selector))})),t;if(e.selector)return oT.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":var n=e.elements||"";n.length>0&&aT(iT(n),(function(e){var n=oT.get(e);n?t.push(n):aT(document.forms,(function(n){aT(n.elements,(function(n){n.name===e&&(e="mce_editor_"+uT++,oT.setAttrib(n,"id",e),t.push(n))}))}))}));break;case"textareas":case"specific_textareas":aT(oT.select("textarea"),(function(n){e.editor_deselector&&i(n,e.editor_deselector)||e.editor_selector&&!i(n,e.editor_selector)||t.push(n)}))}return t}(e)),e.types?aT(e.types,(function(n){dt.each(t,(function(t){return!oT.is(t,n.selector)||(s(o(t),cT({},e,n),t),!1)}))})):(dt.each(t,(function(e){var t;(t=n.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(pT(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)})),0===(t=dt.grep(t,(function(e){return!n.get(e.id)}))).length?a([]):aT(t,(function(t){!function(e,t){return e.inline&&t.tagName.toLowerCase()in r}(e,t)?s(o(t),e,t):Db("Could not initialize inline editor on invalid inline target element",t)})))};return n.settings=e,oT.bind(window,"ready",c),new hr((function(e){t?e(t):a=function(t){e(t)}}))},get:function(e){return 0===arguments.length?fT.slice(0):_(e)?G(fT,(function(t){return t.id===e})).getOr(null):M(e)&&fT[e]?fT[e]:null},add:function(e){var t=this;return sT[e.id]===e||(null===t.get(e.id)&&("length"!==e.id&&(sT[e.id]=e),sT.push(e),fT.push(e)),mT(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),vC||(vC=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",vC))),e},createEditor:function(e,t){return this.add(new rT(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!_(e))return n=e,R(r.get(n.id))?null:(pT(n)&&r.fire("RemoveEditor",{editor:n}),0===fT.length&&window.removeEventListener("beforeunload",vC),n.remove(),mT(fT.length>0),n);aT(oT.select(e),(function(e){(n=r.get(e.id))&&r.remove(n)}))}else for(t=fT.length-1;t>=0;t--)r.remove(fT[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new rT(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",0,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){aT(fT,(function(e){e.save()}))},addI18n:function(e,t){nc.add(e,t)},translate:function(e){return nc.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new YS(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new YS(this.baseURL)}});hT.setup();var vT,bT,yT,wT,CT=Math.min,xT=Math.max,kT=Math.round,ST=function(e,t,n){var r=t.x,o=t.y,i=e.w,a=e.h,c=t.w,u=t.h,l=(n||"").split("");return"b"===l[0]&&(o+=u),"r"===l[1]&&(r+=c),"c"===l[0]&&(o+=kT(u/2)),"c"===l[1]&&(r+=kT(c/2)),"b"===l[3]&&(o-=a),"r"===l[4]&&(r-=i),"c"===l[3]&&(o-=kT(a/2)),"c"===l[4]&&(r-=kT(i/2)),TT(r,o,i,a)},TT=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},ET={inflate:function(e,t,n){return TT(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:ST,findBestRelativePosition:function(e,t,n,r){var o,i;for(i=0;i<r.length;i++)if((o=ST(e,t,r[i])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[i];return null},intersect:function(e,t){var n=xT(e.x,t.x),r=xT(e.y,t.y),o=CT(e.x+e.w,t.x+t.w),i=CT(e.y+e.h,t.y+t.h);return o-n<0||i-r<0?null:TT(n,r,o-n,i-r)},clamp:function(e,t,n){var r=e.x,o=e.y,i=e.x+e.w,a=e.y+e.h,c=t.x+t.w,u=t.y+t.h,l=xT(0,t.x-r),s=xT(0,t.y-o),f=xT(0,i-c),d=xT(0,a-u);return r+=l,o+=s,n&&(i+=l,a+=s,r-=f,o-=d),TT(r,o,(i-=f)-r,(a-=d)-o)},create:TT,fromClientRect:function(e){return TT(e.left,e.top,e.width,e.height)}},_T=(vT={},bT={},{load:function(e,t){var n='Script at URL "'+t+'" failed to load',r='Script at URL "'+t+"\" did not call `tinymce.Resource.add('"+e+"', data)` within 1 second";if(void 0!==vT[e])return vT[e];var o=new hr((function(o,i){var a=function(e,t,n){void 0===n&&(n=1e3);var r=!1,o=null,i=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r||(r=!0,null!==o&&(clearTimeout(o),o=null),e.apply(null,t))}},a=i(e),c=i(t);return{start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==o||(o=setTimeout((function(){return c.apply(null,e)}),n))},resolve:a,reject:c}}(o,i);bT[e]=a.resolve,Ya.ScriptLoader.loadScript(t,(function(){return a.start(r)}),(function(){return a.reject(n)}))}));return vT[e]=o,o},add:function(e,t){void 0!==bT[e]&&(bT[e](t),delete bT[e]),vT[e]=hr.resolve(t)}}),AT=dt.each,NT=dt.extend,RT=function(){};RT.extend=yT=function(e){var t=this.prototype,n=function(){var e,t,n,r=this;if(!wT&&(r.init&&r.init.apply(r,arguments),t=r.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(r,arguments)},r=function(){return this};wT=!0;var o=new this;return wT=!1,e.Mixins&&(AT(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),t.Mixins&&(e.Mixins=t.Mixins.concat(e.Mixins))),e.Methods&&AT(e.Methods.split(","),(function(t){e[t]=r})),e.Properties&&AT(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}})),e.Statics&&AT(e.Statics,(function(e,t){n[t]=e})),e.Defaults&&t.Defaults&&(e.Defaults=NT({},t.Defaults,e.Defaults)),ce(e,(function(e,n){"function"==typeof e&&t[n]?o[n]=function(e,n){return function(){var r=this,o=r._super;r._super=t[e];var i=n.apply(r,arguments);return r._super=o,i}}(n,e):o[n]=e})),n.prototype=o,n.constructor=n,n.extend=yT,n};var OT,DT=Math.min,IT=Math.max,PT=Math.round,BT={serialize:function(e){var t=JSON.stringify(e);return _(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t},parse:function(e){try{return JSON.parse(e)}catch(e){}}},MT={callbacks:{},count:0,send:function(e){var t=this,n=Ka.DOM,r=void 0!==e.count?e.count:t.count,o="tinymce_jsonp_"+r;t.callbacks[r]=function(i){n.remove(o),delete t.callbacks[r],e.callback(i)},n.add(n.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),t.count++}},LT=Ee(Ee({},DS),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||n++>1e4?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,n>1e4?"TIMED_OUT":"GENERAL",t,e),t=null):wr.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",LT.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&dt.each(e.requestheaders,(function(e){t.setRequestHeader(e.key,e.value)})),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=LT.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();wr.setTimeout(r,10)}}),FT=dt.extend,jT=function(){function e(e){this.settings=FT({},e),this.count=0}return e.sendRPC=function(t){return(new e).send(t)},e.prototype.send=function(e){var t=e.error,n=e.success,r=FT(this.settings,e);r.success=function(e,o){void 0===(e=BT.parse(e))&&(e={error:"JSON Parse error."}),e.error?t.call(r.error_scope||r.scope,e.error,o):n.call(r.success_scope||r.scope,e.result)},r.error=function(e,n){t&&t.call(r.error_scope||r.scope,e,n)},r.data=BT.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),r.content_type="application/json",LT.send(r)},e}();try{var HT="__storage_test__";(OT=window.localStorage).setItem(HT,HT),OT.removeItem(HT)}catch(e){OT=function(){var e={},t=[],n={getItem:function(t){var n=e[t];return n||null},setItem:function(n,r){t.push(n),e[n]=String(r)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n})),delete e[n]},clear:function(){t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n}()}var UT={geom:{Rect:ET},util:{Promise:hr,Delay:wr,Tools:dt,VK:Df,URI:YS,Class:RT,EventDispatcher:RS,Observable:DS,I18n:nc,XHR:LT,JSON:BT,JSONRequest:jT,JSONP:MT,LocalStorage:OT,Color:function(e){var t={},n=0,r=0,o=0,i=function(e){var i;return"object"==typeof e?"r"in e?(n=e.r,r=e.g,o=e.b):"v"in e&&function(e,t,i){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,i=parseInt(i,10)/100,t=IT(0,DT(t,1)),i=IT(0,DT(i,1)),0!==t){var a=e/60,c=i*t,u=c*(1-Math.abs(a%2-1)),l=i-c;switch(Math.floor(a)){case 0:n=c,r=u,o=0;break;case 1:n=u,r=c,o=0;break;case 2:n=0,r=c,o=u;break;case 3:n=0,r=u,o=c;break;case 4:n=u,r=0,o=c;break;case 5:n=c,r=0,o=u;break;default:n=r=o=0}n=PT(255*(n+l)),r=PT(255*(r+l)),o=PT(255*(o+l))}else n=r=o=PT(255*i)}(e.h,e.s,e.v):(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(i[1],10),r=parseInt(i[2],10),o=parseInt(i[3],10)):(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16)):(i=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(i[1]+i[1],16),r=parseInt(i[2]+i[2],16),o=parseInt(i[3]+i[3],16)),n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,t};return e&&i(e),t.toRgb=function(){return{r:n,g:r,b:o}},t.toHsv=function(){return function(e,t,n){var r,o;o=0;var i=DT(e/=255,DT(t/=255,n/=255)),a=IT(e,IT(t,n));return i===a?{h:0,s:0,v:100*(o=i)}:(r=(a-i)/a,o=a,{h:PT(60*((e===i?3:n===i?1:5)-(e===i?t-n:n===i?e-t:n-e)/(a-i))),s:PT(100*r),v:PT(100*o)})}(n,r,o)},t.toHex=function(){var e=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+e(n)+e(r)+e(o)},t.parse=i,t}},dom:{EventUtils:bi,Sizzle:Zi,DomQuery:ja,TreeWalker:Tr,TextSeeker:Rc,DOMUtils:Ka,ScriptLoader:Ya,RangeUtils:Xf,Serializer:Uv,StyleSheetLoader:Cr,ControlSelection:Pf,BookmarkManager:Nf,Selection:hv,Event:bi.Event},html:{Styles:li,Entities:Po,Node:bm,Schema:qo,SaxParser:Am,DomParser:Mv,Writer:wm,Serializer:Cm},Env:ct,AddOnManager:oc,Annotator:_f,Formatter:Vb,UndoManager:$b,EditorCommands:CS,WindowManager:Eb,NotificationManager:kb,EditorObservable:LS,Shortcuts:VS,Editor:rT,FocusManager:Ld,EditorManager:hT,DOM:Ka.DOM,ScriptLoader:Ya.ScriptLoader,PluginManager:Sb,ThemeManager:Tb,IconManager:pb,Resource:_T,trim:dt.trim,isArray:dt.isArray,is:dt.is,toArray:dt.toArray,makeMap:dt.makeMap,each:dt.each,map:dt.map,grep:dt.grep,inArray:dt.inArray,extend:dt.extend,create:dt.create,walk:dt.walk,createNS:dt.createNS,resolve:dt.resolve,explode:dt.explode,_addCacheSuffix:dt._addCacheSuffix,isOpera:ct.opera,isWebKit:ct.webkit,isIE:ct.ie,isGecko:ct.gecko,isMac:ct.mac},zT=dt.extend(hT,UT);!function(e){window.tinymce=e,window.tinyMCE=e}(zT),function(t){try{e.exports=t}catch(e){}}(zT)}()}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/timers-browserify/main.js").setImmediate)},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/window-or-global/lib/index.js":function(e,t,n){"use strict";(function(t){e.exports="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/editor-plugins/a11ychecker/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/a11ychecker/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/draggable/draggable.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/status-macro/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/editor-plugins/status-macro/styles.scss":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/styles.scss");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/theme-atlassian/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/theme-atlassian/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/index.ts":function(e,t,n){"use strict";n.r(t);var r=n("./node_modules/window-or-global/lib/index.js"),o=n.n(r);n("./node_modules/tinymce/tinymce.js"),n("./node_modules/tinymce/plugins/table/index.js"),n("./node_modules/tinymce/plugins/lists/index.js"),n("./node_modules/tinymce/plugins/paste/index.js");function i(){return"undefined"!=typeof window?window.location:void 0}function a(){if(window&&window.require){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return window.require.apply(window,t)}}function c(e){for(var t=e.split("."),n=window[t.shift()];void 0!==n&&t.length;)n=n[t.shift()];return n}r.tinymce.confluenceEditorVersion="2.2.3";var u=n("confluence.web.resources:jquery/require('jquery')"),l=n.n(u);function s(e,t,n){return"function"==typeof n?l()(o.a).bind(e,t,n):l()(o.a).bind(e,t)}function f(e,t){return l()(o.a).unbind(e,t)}function d(e,t){return l()(o.a).trigger(e,t)}var m="confluence.spa.editor";function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"value",void 0),p(this,"toJSON",void 0),this.value=t,this.valueOf=this.toString=this.toJSON=function(){return n.value}},h=function(e){return new g(e)},v=function(e,t){Object.keys(t).forEach((function(e){t[e]=h(t[e])})),d("analytics",{name:"".concat(m,".plugins.").concat(e),data:t})},b=n("confluence.web.resources:ajs/require('ajs')"),y=n.n(b);function w(e){return e&&3===e.nodeType&&0===e.nodeValue.length}var C={isCursorAtStartOf:function(e,t){return t.collapsed&&this.isRangeAtStartOf(e,t)},isRangeAtStartOf:function(e,t){if(!t||!t.startContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("context is invalid. received: ".concat(e));var n,o=t.startContainer;if(3===o.nodeType){if(0!==t.startOffset)return!1;n=o}else if(void 0===(n=o.childNodes[t.startOffset])&&o.childNodes.length>0)return!1;var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.prev(!0)}while(w(i));return void 0===i},isCursorAtEndOf:function(e,t){return t.collapsed&&this.isRangeAtEndOf(e,t)},isRangeAtEndOf:function(e,t){if(!t||!t.endContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("container is invalid. received: ".concat(e));var n,o=t.endContainer;if(3===o.nodeType){if(t.endOffset!=o.nodeValue.length)return!1;n=o}else n=o.childNodes[0===t.endOffset?t.endOffset:t.endOffset-1];var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.next(!0)}while(w(i));return void 0===i||"BR"===i.nodeName&&void 0===a.next(!0)},setCursorAtStartOfContents:function(e){if(!e)throw new Error("element is required.");if(1!==e.nodeType&&3!==e.nodeType)throw new Error("invalid argument: expected a DOM element or text node, got: ".concat(e));var t=r.tinymce.activeEditor,n=t.dom.createRng();["br","img"].includes(e.nodeName.toLowerCase())?(n.setStartBefore(e),n.setEndBefore(e),t.selection.setRng(n)):(t.selection.select(e,!0),t.selection.collapse(!0))},isCursorAtEnd:function(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var r=t.endContainer;if(3==r.nodeType)return r.wholeText.length==t.endOffset;var o=r.childNodes[t.endOffset];return l()(o).is(":last-child")}},x=C;function k(e,t){var n=e.selection.getSel();if(!n||!n.isCollapsed)return!1;var r,o=t.startContainer;return 3==o.nodeType?!o.previousSibling&&0===t.startOffset&&function(e){if(0==l()(e).closest("td").length)return!0;for(var t=e.parentNode;t&&"td"!=t.nodeName.toLowerCase();){if(l()(t).prevAll().contents().filter((function(){return 3==this.nodeType})).length)return!1;t=t.parentNode}return!0}(o):l()(o).is("p:first-child")?0===t.startOffset:l()(o).is(".wysiwyg-macro-body")?1==t.startOffset&&(3==(r=t.startContainer.childNodes[0]).nodeType&&"\n"==r.nodeValue):void 0}function S(e,t,n){var o=e.dom.create("p",{},r.tinymce.Env.ie?"&nbsp;":'<br data-mce-bogus="1" />');n?t.after(o):t.before(o),e.selection.select(o,!0),e.selection.collapse()}function T(){var e=r.tinymce.activeEditor;r.tinymce.Env.ie&&e.on("KeyPress",(function(t){var n=e.selection,o=n.getNode();if(13==t.keyCode&&"P"==o.nodeName&&e.dom.is(o,":first-child")&&r.tinymce.confluence.MacroUtils.isInMacro(o)){var i=e.dom.create("p","&#x200b");return e.dom.insertAfter(i,o),n.select(i,1),n.collapse(),r.tinymce.dom.Event.cancel(t)}})),r.tinymce.Env.gecko&&e.on("KeyPress",(function(t){if(t.charCode==r.tinymce.util.VK.SPACE){var n=e.selection.getNode(),o=l()(n).closest("a"),i=e.selection.getRng();o.length&&x.isCursorAtEnd(e,e.selection.getRng())&&(i.setStartAfter(o[0]),i.setEndAfter(o[0]),e.selection.setRng(i),e.selection.collapse())}})),e.on("KeyPress",(function(t){if(13==t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=l()(n).closest("pre");if(o.length&&!r.tinymce.confluence.MacroUtils.isInMacro(o)&&x.isCursorAtEnd(e,e.selection.getRng()))return S(e,o,!0),r.tinymce.dom.Event.cancel(t);var i=l()(n).closest("blockquote");if(i.length){var a=l()(n).closest("p");if(a.is(":first-child")&&k(e,e.selection.getRng()))return S(e,i,!1),r.tinymce.dom.Event.cancel(t);if(a.is(":last-child")&&function(e){var t=e.contents();if(!t.length)return!0;if(1==t.length){if(t.is("br"))return!0;if("&nbsp;"==t.html()||160==t.text().charCodeAt(0))return!0;if(3==t[0].nodeType&&t[0].nodeValue==y.a.Rte.HIDDEN_CHAR)return!0}return!1}(a))return e.dom.remove(a[0],!1),S(e,i,!0),r.tinymce.dom.Event.cancel(t)}}return!0}),!0)}var E=function(e){var t=o.a.document.querySelector("meta[name=ajs-enabled-dark-features]");if(t){var n=t.content.split(",");return n.indexOf(e)>-1&&-1===n.indexOf("".concat(e,".disable"))}},_=function(e){return l()("<br>").add(e.contents())},A=function(e){return(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE)&&l.a.trim(e.textContent)},N=function(e){var t=!1;return e.parent().contents().each((function(){if(A(this))return this===e[0]&&(t=!0,!1)})),t},R=function(e){var t=e.attr("style"),n=l()("<p></p>").append(e.contents());t&&n.attr("style",t),e.replaceWith(n)},O=function(e){var t=e.prev("p");t.length?(t.append(_(e)),e.remove()):N(e)?R(e):e.replaceWith(_(e))},D=function(e,t){var n=l()('<table class="wysiwyg-macro" data-macro-name="'.concat(e,'" data-macro-body-type="RICH_TEXT">')+'<tbody><tr><td class="wysiwyg-macro-body"></td></tr></tbody></table>');return n.find(".wysiwyg-macro-body").append(t),n},I=function(e){return""===e.text()},P=R,B=[function(e){e.find(".expand-container").replaceWith((function(){var e=l()(this).find(".expand-content").first().contents();return e.length?D("expand",e):l()("")}))},function(e){e.find("span:empty").remove()},function(e){e.find("p + br").remove()},function(e){var t=!1;e.find("div:not(.content-wrapper)").each((function(){var e=l()(this);I(e)?(e.remove(),t=!0):e.find("div, p, pre").length?e.replaceWith(e.contents()):(t?P(e):O(e),t=!1)}))}];var M={repair:function(e){var t=l()("<div></div>").html(e);return B.forEach((function(e){e(t)})),t.html()}},L=[{repair:function(e){var t=/(<td.*<\/td>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody><tr>'.concat(t[1],"</tr></tbody></table>"):e}},{repair:function(e){var t=/(<tr.*<\/tr>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody>'.concat(t[1],"</tbody></table>"):e}}],F=function(e){return e?(L.forEach((function(t){e=t.repair(e)})),e):e},j={apply:function(e){return e=function(e){return E("editor.advanced.paste.disable")?e:M.repair(e)}(e=F(e))},repair:F},H=n("confluence.web.resources:meta/require('confluence/meta')"),U=n.n(H).a,z=function(e){e.parentNode.removeChild(e)},W=function(e){return function(t){var n=t.classList;n.remove.apply(n,e),""===t.className&&t.removeAttribute("class")}},q=function(e,t,n){r.tinymce.util.Tools.each(e.querySelectorAll(t),n)};var V={apply:function(e,t){!function(e){var t;q(e,"img:not([data-emoticon-name]):not(.editor-inline-macro):not(.confluence-embedded-image):not(.template-constiable)",(t=["confluence-embedded-image","confluence-external-resource"],function(e){var n=e.classList;n.add.apply(n,t)}))}(e),function(e){q(e,"span.Apple-style-span",W(["Apple-style-span"]))}(e),function(e){q(e,"br.Apple-interchange-newline",z)}(e),function(e){q(e,"meta",z)}(e),function(e,t){q(e,"ul.inline-task-list > li[data-inline-task-id]",(function(n){var o,i,a=n.getAttribute("data-inline-task-id");r.tinymce.util.Tools.grep(t.querySelectorAll('li[data-inline-task-id="'.concat(a,'"]')),(i=e,o=function(e){return function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}(e,i)},function(e){return!o(e)})).length>0&&n.setAttribute("data-inline-task-id","")}))}(e,t),function(e){var t;q(e,".mceSelected",W(["mceSelected"])),q(e,"[data-mce-selected]",(t="data-mce-selected",function(e){e.removeAttribute(t)}))}(e),function(e){var t=U.get("base-url");q(e,"a:not([data-base-url='".concat(t,"'])[data-base-url]"),(function(e){for(var n=e.attributes.href?e.attributes.href.value:t;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("href",n)}))}(e)}},$=function(e,t){return"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?l()(e,t||r.document):l()("<div>".concat(e,"</div>"),t||r.document).contents()},K=function(e,t){e.is("ul.inline-task-list")?t.each((function(){var e=l()(this);e.attr("data-inline-task-id")||e.attr("data-inline-task-id","")})):t.removeAttr("data-inline-task-id").removeAttr("data-pasted-task")},J=function(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return r.tinymce.isIE?"LI"===t.nodeName&&0===t.childNodes.length:"LI"===t.nodeName&&1===t.childNodes.length&&"BR"===t.firstChild.nodeName},G=function(e,t){if(!t.collapsed||0!=t.startOffset)return!1;var n=l()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).prev(!0);return void 0===o||l()(o).is("li")},X=function(e){var t=e.filter("ol,ul").length;return e.length===t},Y=function(e,t,n){var r=null;return Q.forEach((function(o){if(o.shouldInsert(e,t,n))return r=o,!1})),r},Q=[{shouldInsert:function(e,t,n){var r=J(t);return(r=r&&X(n))&&n.children("li").length>0},insert:function(e,t,n){var r=l()(3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),o),r.replaceWith(o),e.selection.select(o.last()[0],!0),e.selection.collapse(),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=G(e,t);return(r=r&&X(n))&&n.children("li").length>0},insert:function(e,t,n){var r=l()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),o),r.before(o),e.selection.select(r[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t,n){return function(e,t){if(!t.collapsed)return!1;if(3===t.startContainer.nodeType&&t.startOffset!=t.startContainer.nodeValue.length)return!1;if(1===t.startContainer.nodeType&&t.startOffset!=t.startContainer.childNodes.length)return!1;var n=l()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).next(!0);return void 0===o||l()(o).is("li")}(e,t)&&n.length===n.filter("ol,ul").length&&n.children("li").length>0},insert:function(e,t,n){var r=l()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),o),r.after(o),e.selection.select(o.last()[0],!0),e.selection.collapse(!1),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=n.length>1;return r=(r=(r=r&&!J(t))&&G(e,t))&&function(e){var t=e.filter("ol,ul"),n=e[e.length-1];return 1===t.length&&t[0]===n}(n)},insert:function(e,t,n){var r=l()(t.startContainer).closest("li",e.getBody());e.undoManager.beforeChange(),e.undoManager.add(),K(r.parent(),n.children("li"));var o=l()("<li></li>").append(n);r.before(o),e.undoManager.add()}},{shouldInsert:function(e,t,n){return!t.collapsed&&(!!l()(t.commonAncestorContainer).is("table.confluenceTable > tbody, table.confluenceTable > tbody > tr")&&n.is("table:not(.wysiwyg-macro)"))},insert:function(e,t,n){var r=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),o=r.children("td, th"),i=l()(".mceSelected",e.getDoc()),a=i.parent();function c(e,t){for(var n=e.shift(),r=t.shift();n&&r;n=e.shift(),r=t.shift())l()(r).html(l()(n).html())}if(e.undoManager.beforeChange(),e.undoManager.add(),1===a.length)c(l.a.makeArray(o),l.a.makeArray(i));else for(var u=l.a.makeArray(r),s=l.a.makeArray(a),f=u.shift(),d=s.shift();f&&d;f=u.shift(),d=s.shift())c(l.a.makeArray(l()(f).children()),l.a.makeArray(l()(d).children()));e.selection.setRng(t),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=l()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0===r.length)return!1;var o=r.closest("table.confluenceTable",".mceContent");if(0===o.length||0===o.children("tbody").length)return!1;if(!n.is("table:not(.wysiwyg-macro)"))return!1;var i=!1;return o.find("*[colspan], *[rowspan]").each((function(e,t){if(parseInt(l()(t).attr("rowspan"))>1||parseInt(l()(t).attr("colspan"))>1)return i=!0,!1})),!i},insert:function(e,t,n){var o=l()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent"),i=o.closest("table.confluenceTable",".mceContent"),a=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),c=i.children("tbody").children("tr"),u=a.length,s=a.first().children("td, th").length,f=c.length,d=c.first().children("td, th").length,m=o.parent().index(),p=o.index();e.undoManager.beforeChange(),e.undoManager.add();var g=p+s-d,h=m+u-f;g=g<0?0:g,h=h<0?0:h,c.each((function(e,t){for(var n=l()(t),o=n.children().last(),i=0;i<g;i++)n.append(o.clone().html(r.tinymce.isIE?"":"<br/>"))}));for(var v=c.last(),b=0;b<h;b++){for(var y=l()("<tr></tr>").insertAfter(v),w=0;w<d+g;w++)y.append('<td class="confluenceTd">'.concat(r.tinymce.isIE?"":"<br/>","</td>"));v=y}var C=[];i.children("tbody").children("tr").slice(m).each((function(e,t){C.push(l.a.makeArray(l()(t).children("th, td").slice(p)))}));var x=[];a.each((function(e,t){x.push(l.a.makeArray(l()(t).children("th, td")))}));for(var k=x.shift(),S=C.shift();k&&S;k=x.shift(),S=C.shift())for(var T=k.shift(),E=S.shift();T&&E;T=k.shift(),E=S.shift())l()(E).html(l()(T).html());e.selection.select(o[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t){return l()(t.startContainer).closest("[data-macro-body-type='PLAIN_TEXT']").length>0},insert:function(e,t,n){n.raw&&e.selection.setContent(n.raw())}},{shouldInsert:function(e,t,n){var r=l()(t.startContainer).closest("table").length>0,o=1===n.length&&n.is("table.wysiwyg-macro");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}},{shouldInsert:function(e,t,n){var r=l()(t.startContainer).closest("table").is("table.wysiwyg-macro"),o=1===n.length&&n.is("table.confluenceTable");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}}],Z={insert:function(e,t,n,r){var o=e.selection.getRng();if(o){var i,a,c,u=(i=e,a=t.content,c={content:a,format:"html",selection:!0},i.fire("BeforeSetContent",c),c.content),l=$(u,e.getDoc());l.raw=!!n&&function(){return n};var s=Y(e,o,l);s?(s.insert(e,o,l),e.fire("SetContent",{content:u,format:"html",selection:!0}),e.addVisual()):(e.selection.isCollapsed()||e.undoManager.ignore((function(){e.execCommand("mceDelete",!1,null,{skip_undo:!0})})),t.wasProcessed=!0,e.execCommand("mceInsertContent",!1,t,{skip_undo:r}))}},parse:$};function ee(e,t,n,r){return"function"==typeof r?l()(e).bind(t,n,r):l()(e).bind(t,n)}function te(e,t,n){return l()(e).unbind(t,n)}function ne(e,t,n){return l()(e).trigger(t,n)}function re(e){var t={repair:j.repair,parse:Z.parse},n=null;function o(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(?:\r\n|\r|\n)/g,"<br />")}e.on("PastePreProcess",(function(e){e.content=j.apply(e.content),ne(r.document,"prePaste",[t,e]),r.tinymce.Env.ie&&(n=function(e){var t=l()("<pre>".concat(e.content||"","</pre>"))[0];return o(t.innerText||t.textContent)}(e))})),e.on("PastePostProcess",(function(n){V.apply(n.node,e.getBody()),ne(r.document,"postPaste",[t,n])})),e.on("BeforeExecCommand",(function(t){var r=t.command,o=t.value;"mceInsertContent"===r&&o&&!0===o.paste&&!o.wasProcessed&&(t.preventDefault(),Z.insert(e,o,n,!1))})),e.on("paste",(function(e){if(n=null,!r.tinymce.Env.ie){var t=o(e.clipboardData.getData("text/plain"));n=t}}),!0)}var oe,ie,ae=[],ce={};function ue(e){var t='<span class="text-placeholder">'.concat(oe,"</span>"),n=l()("<div></div>").append(t);e&&n.find(".text-placeholder").html(e),r.tinymce.activeEditor.execCommand("mceInsertContent",!1,n.html())}function le(e){var t=r.tinymce.activeEditor,n=l()(t.getBody()),o=oe,i=e&&e.parentElement;i&&"LI"===i.nodeName&&(o=ie);var a=t.dom.create("span",{id:"placeholder-cursor"},"&nbsp;");i&&e&&i.replaceChild(a,e);var c=n.find("#placeholder-cursor")[0];t.selection.select(c.firstChild),t.dom.remove(c,!1),t.execCommand("mceInsertContent",!1,o)}function se(){return ae}function fe(e){return ce[e]}r.tinymce.Env.ie?(oe="\ufeff{$caret}",ie="<p>{$caret}</p>"):ie=oe=r.tinymce.Env.webKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";var de={insertTextPlaceHolder:ue,removePlaceholder:le,addPlaceholderType:function(e){e&&e.type&&(ae.push(e),ce[e.type]=e)},getPlaceholderTypes:se,getPlaceholderType:fe};function me(){return r.AJS.Rte}var pe={"editor.autocomplete.macros.header.text":"Macro suggestions","editor.autocomplete.macros.dialog.browse":"Open macro browser","editor.autocomplete.macros.error.load.header":"Failed to get macro details","editor.autocomplete.macros.error.load.retrylink":"Try again","editor.autocomplete.links.header.text":"Link suggestions","editor.autocomplete.links.dialog.search":"Search for &lsquo;{0}&rsquo;","editor.autocomplete.links.dialog.search.no.text":"Search","editor.autocomplete.links.web.link":"Insert web link","editor.autocomplete.links.create.link":"Insert link to create page","editor.autocomplete.file.header.text":"File suggestions","editor.autocomplete.media.header.text":"Media suggestions","editor.autocomplete.media.files.dialog.browse":"Open file library","editor.autocomplete.media.macros.dialog.browse":"Insert other media","editor.autoformat.sampletext.firstcell":"first cell","editor.autoformat.sampletext.heading":"heading","calendar3.helptip.learn.more":"Learn More","tinymce.confluence.placeholder.inline.tasks":"Type your task here, using \u0022@\u0022 to assign to a user and \u0022//\u0022 to select a due date","tinymce.confluence.files":"Files","tinymce.confluence.conf_file_desc":"Insert files and images","tinymce.confluence.conf_file_shortcut":"Ctrl+M","tinymce.confluence.conf_wikimarkup_conversion_errors":"Wiki markup conversion errors","tinymce.confluence.conf_wikimarkup_timeout":"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.","tinymce.confluence.conf_wikimarkup_info_title":"Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.","tinymce.confluence.conf_wikimarkup.insert.label":"Insert","tinymce.confluence.conf_wikimarkup_preview_label":"Preview","editor.minor.edit":"Notify watchers","property.panel.textplaceholder.display.default":"Text","property.panel.textplaceholder.display.default.tooltip":"Instructional text is replaced with empty content when a person types.","property.panel.textplaceholder.remove":"Remove","editor.shared.draft.done.desc":"Save draft and close editor","editor.change.comment":"What did you change?","tinymce.tablepicker.insert_table_title":"Insert table","com.atlassian.confluence.extra.team-calendars.calendar.helptip.close":"Got it, thanks!","comment.notification.enable":"Watch this page"},ge=function(e){var t=pe[e];return void 0!==t?t:e};function he(){return{name:"textplaceholder",canHandleElement:function(e){return e.hasClass("text-placeholder")},handle:function(e){if("click"===e.e.type||"mouseup"===e.e.type){var t,n=se(),o=e.containerEl,i=o.getAttribute("data-placeholder-type"),a=[],c=f("default",ge("property.panel.textplaceholder.display.default"),ge("property.panel.textplaceholder.display.default.tooltip"));c.selected=!i,a.push(c);for(var u=0,s=n.length;u<s;u++)t=n[u],a.push(f(t.type,t.label,t.tooltip));a.push(null),a.push({className:"text-placeholder-property-panel-remove-button",text:ge("property.panel.textplaceholder.remove"),click:function(){r.Confluence.PropertyPanel.destroy(),le(o)}}),r.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",o,a,{anchorIframe:me().getEditorFrame()})}function f(e,t,n){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-".concat(e),text:t,tooltip:n,selected:i===e,click:function(){!function(e){"default"===e?o.removeAttribute("data-placeholder-type"):o.setAttribute("data-placeholder-type",e);var t=l()(".text-placeholder-property-panel-type-".concat(e));t.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected"),t.addClass("selected")}(e)}}}}}}function ve(){var e={click:!1,keypress:!0},t=r.tinymce.VK,n=r.tinymce.dom.Event,o="template"===U.get("content-type");function i(e){d("cursor-target-refresh"),l()("#rte-button-insert-placeholder").click((function(e){e.preventDefault(),ue()})),e.on("KeyDown",(function(t){if(13===t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=l()(n).closest(".text-placeholder"),i=e.selection.getRng();if(o.length&&i&&x.isCursorAtEnd(e,i))return S(e,o,!0),r.tinymce.dom.Event.cancel(t)}}),!0)}var a={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};function c(e){return!a[e.nodeName]}function u(o){function i(){var e=f();e&&o.selection.select(e)}function a(e){e.off("KeyDown",u),e.off("KeyPress",s),e.off("Click",s)}function u(e){var r=f();return e.keyCode===t.LEFT||e.keyCode===t.UP?(function(e,t){for(var n,r=t&&t.previousSibling;t&&!r;)r=(t=t.parentNode).previousSibling;if(r){for(n=r;!c(n)&&n.lastChild;)n=n.lastChild;e.selection.select(n.lastChild||n),e.selection.collapse(!1),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.RIGHT||e.keyCode===t.DOWN?(function(e,t){for(var n,r=t&&t.nextSibling;t&&!r;)r=(t=t.parentNode).nextSibling;if(r){for(n=r;!c(n)&&n.firstChild;)n=n.firstChild;e.selection.select(n.firstChild||n),e.selection.collapse(!0),e.selection.normalize()}}(o,r),n.cancel(e)):e.keyCode===t.BACKSPACE||e.keyCode===t.DELETE?(le(r),n.cancel(e)):void 0}function s(t){if(!r.tinymce.Env.gecko||t.isChar||"keypress"!==t.type){var n,o,i,a=f();if(a){var c=a.getAttribute("data-placeholder-type");n=c,o=t.type,i=n&&fe(n),l.a.extend({},e,i&&i.activation)[o]&&(le(a),d("editor.text-placeholder.activated",{placeholderType:c||"",triggerEvent:t}))}}}function f(){var e=l()(o.getBody()).find(".text-placeholder.selected");return e.length?e[0]:(a(o),null)}o.on("NodeChange",(function(e){var t=e.element,n=l()(t).closest(".text-placeholder");l()(o.getBody()).find(".text-placeholder.selected").not(n).removeClass("selected"),n.length?(n.hasClass("selected")||(n.addClass("selected"),function(e){e.on("KeyDown",u,!0),e.on("KeyPress",s,!0),e.on("Click",s,!0)}(o)),setTimeout(i,0)):a(o)}),!0)}return{init:function(e){e.on("init",(function(){(o?i:u)(e),function(e){var t=l()(e.getDoc()).find("head");r.tinymce.Env.ie?t.append('<style type="text/css">.wiki-content .text-placeholder { display: inline; }</style>'):t.append('<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>')}(e)}))},getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}var be,ye=U.get("context-path"),we=0,Ce={updateNode:function(e,t){var n=r.tinymce.activeEditor,o=l()(e,n.getDoc()),i="confluence.update-node-".concat(we++);d("synchrony.stop",{id:i});var a=Ce.prepareNodeForUpdate(o);return Ce.replaceNode(o,t).fail(a).always((function(){d("synchrony.start",{id:i})})).promise()},storeNodeState:function(e,t){for(var n,r={},o=0,i=t.length;o<i;o++)n=t[o],r[n]=e.attr(n);return function(){for(var t in r)e.attr(t,r[t])}},prepareNodeForUpdate:function(e){var t;return e.is("img")&&(t=Ce.storeNodeState(e,["width","height","src","class"]),e.addClass("image-hotswap").attr({src:"".concat(ye,"/images/border/spacer.gif"),width:e.attr("width"),height:e.attr("height")})),t},replaceNode:function(e,t){var n=Ce.getDoc(),o=l()(t,n),i=l()(e,n),a="confluence.replace-node-".concat(we++);return d("synchrony.stop",{id:a}),l.a.Deferred((function(){var e=this;o.is("img")?(o[0].onload=function(){this.onload=null,e.resolve(this)},r.tinymce.Env.opera&&(o[0].src=o.attr("src")),n.createDocumentFragment().appendChild(o[0])):e.resolve(o[0])})).always((function(){d("synchrony.start",{id:a})})).done((function(e){i.replaceWith(e)})).promise()},replaceSelection:function(e){var t=r.tinymce.activeEditor,n=t.selection.getRng(),o=t.getDoc().createRange(),i=l()(e).clone(!0,!1)[0];n.deleteContents(),3===n.startContainer.nodeType&&""===n.startContainer.nodeValue&&(n.startContainer.nodeValue=me().HIDDEN_CHAR),n.insertNode(i);var a=t.getDoc().createTextNode(me().HIDDEN_CHAR);t.dom.insertAfter(a,i);var c=a;return o.setStartBefore(c),o.setEndAfter(c),o.collapse(!1),t.selection.setRng(o),i},normalize:function(e){var t,n,o=r.tinymce.activeEditor,i=o.selection.getRng(),a=null,c=[];if(e&&e.childNodes){if(r.tinymce.Env.webkit?a=i:r.tinymce.Env.gecko&&i&&(a=i.cloneRange(),((t={startIndex:Array.from(e.childNodes).indexOf(i.startContainer),startOffset:a.startOffset,endIndex:Array.from(e.childNodes).indexOf(i.endContainer),endOffset:a.endOffset}).startIndex>-1||t.endIndex>-1)&&(c=function(e){var t=[],n=0;return Array.prototype.forEach.call(e.childNodes,(function(e,r){var o={},i=t[r-1]||{};o.isTextNode=3===e.nodeType,o.textNodesBefore=(o.isTextNode&&i.isTextNode?1:0)+~~i.textNodesBefore,o.precedingTextLength=n,n=o.isTextNode&&e.nodeValue?n+e.nodeValue.length:0,t.push(o)})),t}(e))),e.normalize(),r.tinymce.Env.gecko&&a){if(n=c[t.startIndex]){var u=t.startIndex-n.textNodesBefore,l=t.startOffset+n.precedingTextLength;a.setStart(e.childNodes[u],l)}if(n=c[t.endIndex]){var s=t.endIndex-n.textNodesBefore,f=t.endOffset+n.precedingTextLength;a.setEnd(e.childNodes[s],f)}}a&&o.selection.setRng(a)}},getDoc:function(){return r.tinymce.Env.gecko||r.tinymce.Env.opera?document:r.tinymce.activeEditor.getDoc()},isolateSelectedRange:function(){var e=r.tinymce.activeEditor,t=Ce.getDoc(),n=e.selection,o=n.getRng();if(o){var i,a=o.startContainer,c=o.startOffset,u=o.endContainer,s=o.endOffset;if(o.collapsed)return o;a===u&&(i=s-c);var f=m(a,c);f&&o.setStartBefore(f),a!==o.startContainer&&(s=i||s);var d=m(u,s,!0);return d&&o.setEndAfter(d),n.setRng(o),o}function m(n,r,o){var i=e.dom.getParent(n,e.dom.isBlock);i||(i=e.getBody());var a=function(e,n,r,o){var i,a,c=null,u=null,s=o?"nextSibling":"previousSibling";if(!(i=0===n)&&o&&(i=3===e.nodeType?n===e.length:n===e.childNodes.length),i)for(c=e[s],u=e;null===c;){if(u===r)return;if(u.parentNode===r)break;c=(u=u.parentNode)[s]}else 3===e.nodeType?(a=e.data,e.data=a.slice(n),c=t.createTextNode(a.slice(0,n)),u=e,l()(c).insertBefore(u),o&&(a=u,u=c,c=a)):c=(u=e.childNodes[n-(o?1:0)])[s];return[u,c]}(n,r,i,o);return a?a[1]?function(e,t,n,r){for(var o,i,a,c;t!==n&&t.parentNode!==n;){if(o=(i=t.parentNode).cloneNode(!1),r)for(l()(o).insertAfter(i),a=e;a;)c=a.nextSibling,o.appendChild(a),a=c;else for(l()(o).insertBefore(i),a=i.firstChild;a!==t;)c=a.nextSibling,o.appendChild(a),a=c;e=o,t=i}return t}(a[1],a[0],i,o):a[0]:void 0}}},xe=Ce;var ke=function(){var e,t=r.tinymce.activeEditor,n=Te();t.focus(!1);var o=t.selection.getRng();e=o&&o.cloneRange&&"function"==typeof o.cloneRange?o.cloneRange():o.duplicate&&o.duplicate()||o,be={scrollX:n.scrollX,scrollY:n.scrollY,range:e}},Se=function(){var e=r.tinymce.activeEditor.selection,t=r.tinymce.activeEditor.getWin();be&&(Ee(be),t.focus(),e.setRng(be.range)),be=null},Te=function(){var e=r.tinymce.DOM.getViewPort(r.tinymce.activeEditor.getWin());return{scrollX:e.x,scrollY:e.y}},Ee=function(e){e&&r.tinymce.activeEditor.getWin().scrollTo(e.scrollX,e.scrollY)},_e={storeBookmark:ke,restoreBookmark:Se,getScroll:Te,restoreScroll:Ee};function Ae(){var e=U.get("content-id");return+e||(e=U.get("page-id")),+e||(e="0"),e}function Ne(e){return l()(e).hasClass("wysiwyg-macro")}function Re(e,t){var n;if(e.macro&&e.contentId)n={type:"POST",url:"".concat(ye,"/rest/tinymce/1/macro/placeholder"),contentType:"application/json; charset=utf-8",data:JSON.stringify(e),dataType:"text"};else{if(!e.url||!e.type)throw new Error("illegal argument received: ".concat(e));n=e}var o,i=l.a.Deferred(),a=r.tinymce.activeEditor;if(!t){var c="macro-".concat((new Date).getTime());o=a.dom.create("span",{id:c}),a.selection.setNode(o),t=o=a.dom.select("#".concat(c))[0],i.fail((function(){l()(o).remove()}))}return l.a.extend(n,{timeout:this.DEFAULT_INSERT_MACRO_TIMEOUT}),y.a.Editor.UI.setButtonsState(!1),l.a.ajax(n).done((function(e){var n=e;function r(e){return e&&e.parentNode}"<"!==n[0]&&(n=document.createTextNode(n)),r(t)?xe.updateNode(t,n).done((function(e){i.resolve(e,n)})).fail(i.reject):i.rejectWith(this,Array.from(arguments))})).fail((function(e,t,n){i.rejectWith(this,Array.from(arguments))})),i.done((function(e,t){y.a.Editor.UI.setButtonsState(!0),Ne(e)&&/P|H\d/.test(e.parentNode.nodeName)&&a.dom.split(e.parentNode,e),function(e){var t=r.tinymce.activeEditor,n=t.getDoc(),o=t.selection.getRng();if(Ne(e)){!r.tinymce.isIE&&l()("p, pre",e).each((function(e,t){0===t.childNodes.length&&t.appendChild(n.createElement("br"))}));var i=t.dom.select(".wysiwyg-macro-body",e)[0].firstChild;i&&(o.setStart(i,0),o.setEnd(i,0))}else o.setStartAfter(e),o.setEndAfter(e);t.selection.setRng(o)}(e),a.nodeChanged(),me().showElement(e),a.fire("SetContent",{content:t,format:"html",selection:!0}),r.tinymce.activeEditor.undoManager.add(),d("macro-browser.macro-inserted")})).fail((function(){y.a.Editor.UI.setButtonsState(!0)})),i.promise()}var Oe,De={DEFAULT_INSERT_MACRO_TIMEOUT:5e3,insertMacro:Re,isInMacro:function(e){return l()(e).closest(".wysiwyg-macro").length>0},updateMacro:function(e,t,n,r){return Re({contentId:Ae(),macro:{name:n,params:e,body:t||""}},r)}},Ie=De;var Pe=Oe={storedRange:null,bookmark:null,editedMacroDiv:null,editedMacro:null,getCurrentNode:function(){return l()(r.tinymce.activeEditor.selection.getNode())},isMacroDiv:function(e){return l()(e).hasClass("wysiwyg-macro")},isMacroTag:function(e){var t=l()(e);return t.hasClass("wysiwyg-macro")||t.hasClass("editor-inline-macro")},isBodylessMacro:function(e){return l()(e).hasClass("editor-inline-macro")},isMacroWithBody:function(e){return l()(e).hasClass("wysiwyg-macro")},isMacroStartTag:function(e){return l()(e).hasClass("wysiwyg-macro-starttag")},isMacroEndTag:function(e){return l()(e).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(e){return l()(e).hasClass("wysiwyg-macro-body")},hasMacroBody:function(e){return"true"==l()(e).attr("macrohasbody")},getNestingMacros:function(e){var t=l()(e||Oe.getCurrentNode()),n=[];return t.parents(".wysiwyg-macro").each((function(e,t){n.push(l()(t).attr("data-macro-name"))})),n},logMCESelection:function(e){r.tinymce.activeEditor.selection},getSelectedMacro:function(){var e=Oe.getCurrentNode();return Oe.isMacroDiv(e)?e:Ie.isInMacro(e)},openMacro:function(e){y.a.MacroBrowser.open({selectedMacro:e,onComplete:Oe.macroBrowserComplete,onCancel:Oe.macroBrowserCancel})},editMacro:function(e){var t=l()(e);Oe.editedMacroDiv=t[0];var n=r.tinymce.activeEditor.serializer.serialize(t.clone()[0],{forced_root_block:!1});r.tinymce.activeEditor.selection.select(t[0]),ke(),l.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/macro/definition"),data:JSON.stringify({contentId:Ae(),macroHtml:n}),dataType:"text",success:function(e){Oe.openMacro(JSON.parse(e))}})},macroBrowserToolbarButtonClicked:function(e){var t=r.tinymce.activeEditor,n=Oe.getCurrentNode();ke();var o=l.a.extend({presetMacroName:null,nestingMacros:Oe.getNestingMacros(n),onComplete:Oe.macroBrowserComplete,onCancel:Oe.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},e);if((!e||e&&!e.ignoreEditorSelection)&&(o.selectedHtml=t.selection.getContent(),o.selectedText=t.selection.getContent({format:"text"})),"function"!=typeof y.a.MacroBrowser.Model.addMacro)return y.a.MacroBrowser.open(o);var i=o.presetMacroMetadata&&o.presetMacroMetadata.macroName||o.presetMacroName,a=y.a.MacroBrowser.getMacroMetadata(i);a?(o.presetMacroMetadata=o.presetMacroMetadata||a,y.a.MacroBrowser.open(o)):y.a.MacroBrowser.Rest.fetchMacroMetadataDetails({id:o.presetMacroName,successCallback:function(e){e&&e.details?(y.a.MacroBrowser.Model.addMacro(e.details),o.presetMacroMetadata=y.a.MacroBrowser.getMacroMetadata(o.presetMacroName),s("reset.complete",(function e(){y.a.MacroBrowser.open(o),f("reset.complete",e)})),d("reset.rte")):y.a.MacroBrowser.open(o)},errorCallback:function(e){console.log("AJS.MacroBrowser.Rest.fetchMacroMetadataDetails ERROR",e)}})},macroBrowserComplete:function(e){var t={contentId:U.get("content-id")||"0",macro:{name:e.name,params:e.params,defaultParameterValue:e.defaultParameterValue,body:e.bodyHtml}};Se(),Oe.editedMacroDiv?(Ie.insertMacro(t,Oe.editedMacroDiv),delete Oe.editedMacroDiv):Ie.insertMacro(t)},macroBrowserCancel:function(){Se(),Oe.editedMacroDiv=null,Oe.editedMacro=null}};n("./src/editor-plugins/propertypanel/css/property-panel.css");var Be=function(){var e=r.Confluence.PropertyPanel,t=[];return s("add-handler.property-panel",(function(e,n){n&&t.push(n)})),{init:function(n){var o,i=function(){return!!e.current},a=function(o,a){var c={focusedEl:a,focusedNodeName:a.nodeName&&a.nodeName.toLowerCase(),ed:n,e:l.a.extend({},o)},u=function(e){if(e.is("img"))return e[0];var t=e.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder");return t.length?t[0]:""}(l()(a)),s=!!l()(a).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,f=!!l()(".toolbar-contextual").length;if(c.containerEl=u,d("user-blurred-rte-element",c),u&&!function(e){return"click"==e.type&&(e.which?3===e.which:e.button?2==e.button:void 0)}(o)&&!i()&&e.shouldCreate)for(var m=0,p=t.length;m<p;m++)if(t[m].canHandleElement(l()(u))){if(f||!s)return t[m].handle(c);!function(e){ee(r.document,"shown.contextToolbar",(function(){e.handle(c)}))}(t[m])}};function c(e,t){a(e,t.elem)}function u(t,n){i()&&(!n.containerEl||e.current.hasAnchorChanged(n.containerEl)?e.destroy():d("same-anchor.property-panel"))}function m(){setTimeout((function(){me().bindScroll("property-panel",(function(){e.destroy()}))}),0),l()(n.getDoc()).bind("keydown.property-panel.escape",(function(t){27===t.keyCode&&i()&&e.destroy()}))}function p(){me().unbindScroll("property-panel"),l()(n.getDoc()).unbind("keydown.property-panel.escape")}r.tinymce.Env.ie&&n.on("MouseDown",(function(e){o&&o.unbind("mouseup.IEDragHandlesWorkaround"),(o=l()(e.target)).filter("img, table").bind("mouseup.IEDragHandlesWorkaround",(function(){a(e,e.target)}))})),n.on("Click",(function(e){a(e,e.target)})),n.on("KeyUp",(function(e){27!==e.keyCode&&a(e,n.selection.getNode())}),!0),n.on("ContextMenu",(function(){e.destroy()})),s("trigger.property-panel",c),s("user-blurred-rte-element",u),s("created.property-panel",m),s("destroyed.property-panel",p),n.on("Remove",(function(){f("trigger.property-panel",c),f("user-blurred-rte-element",u),f("created.property-panel",m),f("destroyed.property-panel",p)}))},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};n("./src/editor-plugins/confcharmap/charmap.css");var Me=/^\u200b?(\[)$/;function Le(e){return e.dom.getParent(e.selection.getStart(),"UL,OL")}function Fe(e){return!(!e||"ul"!==e.nodeName.toLowerCase()||!e.classList.contains("inline-task-list"))}function je(e){return e&&"ul"===e.nodeName.toLowerCase()&&!Fe(e)}function He(e){e&&e.classList.contains("inline-task-list")&&(e.classList.remove("inline-task-list"),0===e.classList.length&&e.removeAttribute("class"),e.removeAttribute("data-inline-tasks-content-id"),Array.prototype.slice.call(e.children).forEach((function(e){e.removeAttribute("data-inline-task-id"),e.classList.remove("checked"),e.style.backgroundImage=""})))}function Ue(){return!(e=U.get("use-inline-tasks"),"true"===e||!0===e||"page"===U.get("content-type")||"blogpost"===U.get("content-type")||"template"===U.get("content-type"));var e}var ze=function(){return!!U.get("collaborative-content")&&We()},We=function(){var e=U.get("content-type");return"page"===e||"blogpost"===e};function qe(){return l()("#table-highlight-group").attr("data-highlight-colour")||""}function Ve(e,t,n){if(!t.length)return l()("");for(var r=function(e,t){var n=l()(e.selection.getNode());return!!n.length&&(n[0]===t[0]||!!n.closest(t).length)}(e,t),o=t[0],i=o.ownerDocument.createElement(n),a=o.attributes,c=0,u=a.length;c<u;c++){var s=a[c];i.setAttribute(s.nodeName,s.nodeValue)}for(;o.hasChildNodes();)i.appendChild(o.firstChild);return o.parentNode.replaceChild(i,o),r&&(e.selection.select(i,!0),e.selection.collapse()),l()(i)}var $e,Ke={convertToNormalCells:function(e,t){t.filter("th").each((function(){var t=l()(this);(t=Ve(e,t,"td")).removeClass("confluenceTh"),t.addClass("confluenceTd")}))},convertToHeadingCells:function(e,t){t.filter("td").each((function(){var t=l()(this);(t=Ve(e,t,"th")).removeClass("confluenceTd"),t.addClass("confluenceTh")}))},areCellsHeadings:function(e){var t=e.filter("th").length;return e.length===t},isColumnHeading:function(e,t){var n=l()(e).children("tbody").children("tr");return 1!==n.length&&n.children().filter("th:nth-child(".concat(t,")")).length===n.length},areCellsHighlighted:function(e){var t=e.filter("td[data-highlight-colour],th[data-highlight-colour]"),n=t.length;return e.length===n&&function(e){var t,n,r=qe();for(t=0,n=e.length;t<n;t++)if((e.eq(t).attr("data-highlight-colour")||"")!==r)return!1;return!0}(t)},isColumnHighlighted:function(e,t){var n=l()(e).children("tbody").children("tr").children("th,td").nthCol(t),r=n.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(n.length!==r)return!1;for(var o=n.eq(0).attr("data-highlight-colour"),i=1,a=n.length;i<a;i++)if(o!==n.eq(i).attr("data-highlight-colour"))return!1;return!0},getSelectedHighlightColour:qe},Je=n("com.atlassian.confluence.plugins.confluence-frontend:table-styles-editor/require('confluence/table-color-names')"),Ge=n.n(Je),Xe=function(e){function t(t){var r,o,i=function(t){return e.translate(t)};n(t),Ke.getSelectedHighlightColour()&&(r=Ke.getSelectedHighlightColour(),o=i([i("table.cell_background_color"),Ge.a.colorNames[r.substring(1,r.length)]]),t.attr("data-highlight-colour",r),t.attr("title",o),t.children().attr("title",""),t.addClass("highlight-".concat(r)))}function n(e){var t,n,r;for(t=0,n=e.length;t<n;t++)(r=e.eq(t)).attr("data-highlight-colour")&&r.removeAttr("data-highlight-colour"),r.attr("title")&&r.removeAttr("title"),r[0].className=r[0].className.replace(/( |^)highlight-[#\w]+/g,"")}e.on("init",(function(){var o=function(e){return l()(e.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},i=function(e){var t=l()(e.getBody()).find("th.confluenceTh[data-mce-selected],td.confluenceTd[data-mce-selected]");return t.length?t:o(e)},a=function(e){return 0===e.find("tbody > tr > td").length};function c(e){return l()(e).parents("table").is(".confluenceTable")}function u(t){if(9===t.keyCode){var n=e.selection.getNode();if(c(n)&&!function(t){var n=e.dom.getParent(t,"UL,OL,TR").tagName;return"UL"===n||"OL"===n}(n)){var r=t.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell";return e.execCommand(r),t.preventDefault(),!1}}}e.addCommand("confTableRowToggleHeading",(function(){var t=function(e){var t=l()(e.getBody()).find("td[data-mce-selected],th[data-mce-selected]");t.length||(t=l()(e.selection.getNode()));for(var n=t.closest("tr"),r=n.parent(),o=r.is("tbody")?n.parent().parent():r;0!==n.length&&!o.is(".confluenceTable");)n=o.closest("tr"),o=(r=n.parent()).is("tbody")?n.parent().parent():r;return n}(this),n=t.children("td,th"),r=0;return Ke.areCellsHeadings(n)?(a(t.closest("table"))||(n=n.filter((function(){var e=l()(this),t=e.closest("table");return r+=parseInt(e.attr("colspan"))||1,!Ke.isColumnHeading(t,r)}))),Ke.convertToNormalCells(e,n)):Ke.convertToHeadingCells(e,n),!1})),e.addCommand("confTableColumnToggleHeading",(function(){var t=function(e){var t=l()([]);return e.each((function(){var e=l()(this),n=e.index()+1,r=e.closest("table.confluenceTable").children("tbody").children("tr");t=t.add(r.children().nthCol(n))})),t}(i(this));return Ke.areCellsHeadings(t)?(a(t.closest("table"))||(t=t.filter((function(){var e=l()(this).parent("tr").children(),t=e.filter("th");return e.length!==t.length}))),Ke.convertToNormalCells(e,t)):Ke.convertToHeadingCells(e,t),!1})),e.addCommand("confTableSelectionToggleHighlight",(function(e,r){var o=r&&r.alwaysHighlight,a=i(this);return Ke.areCellsHighlighted(a)&&!o||l()("#table-highlight-group").attr("data-remove-highlight")?n(a):t(a),!1})),(r.tinymce.isIE8||E("confluence-table-enhancements.auto-row"))&&e.on("KeyDown",(function(t){function n(t,n){var r=e.selection.getRng();if(!r)return!1;var o=r.startContainer;if(r.collapsed){var i=function(e,t,n){for(;e!=t;){if(e[n])return!1;e=e.parentNode}return!0}(o,t,n);return 3===o.nodeType?i&&r.startOffset==("nextSibling"==n?o.length:0):o==t?r.startOffset==("nextSibling"==n?o.childNodes.length-1:0):i}return!1}if((37===t.keyCode||39===t.keyCode)&&!t.shiftKey){var i=o(this);if(i.length){var a=i[0];if(37===t.keyCode&&n(a,"previousSibling")&&(c=e.selection.getNode(),l()(c).parents("table").first().find("tr:first-child").children().first()[0]!=c))return e.execCommand("mceTableMoveCaretToPrevCell"),r.tinymce.dom.Event.cancel(t);if(39===t.keyCode&&n(a,"nextSibling")&&!function(){var t=e.selection.getNode();return l()(t).parents("table").first().find("tr:last-child").children().last()[0]==t}())return e.execCommand("mceTableMoveCaretToNextCell"),r.tinymce.dom.Event.cancel(t)}}var c})),e.on("KeyDown",(function(t){u(t),function(t){if(t.altKey&&(38===t.keyCode||40===t.keyCode)){var n=e.selection.getRng(),r=l()(n.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==r.length){e.execCommand(38===t.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var o=r.parent()[38===t.keyCode?"prev":"next"]().find("td:first-child")[0],i=l()(o);i.hasClass("numberingColumn")&&(o=i.next()[0]),n&&(n.setStart(o,0),n.setEnd(o,0),e.selection.setRng(n)),t.preventDefault()}}}(t)})),E("confluence-table-enhancements.auto-row")&&(e.on("Click",(function(){var t=o(this);t.hasClass("numberingColumn")&&!t.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")})),e.on("KeyDown",(function(t){if((38===t.keyCode||40===t.keyCode)&&c(e.selection.getNode())&&o(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),t.preventDefault(),!1}),!0))})),E("confluence-table-enhancements.auto-row")&&e.on("init",(function(){l()(e.getBody()).find(".confluenceTd.numberingColumn").attr("contenteditable","false")}))},Ye={},Qe=0,Ze=function(e,t){if(e&&(Ye[e]?Ye[e]++:Ye[e]=1,t)){var n="".concat(e,"Size");Ye[n]?Ye[n]+=t:Ye[n]=t}},et=function e(){Ye.pageID=U.get("page-id"),Ye.editorVersion=h("2.2.3"),d("analytics",{name:"confluence.editor.action",data:Ye}),Ye={},Object(r.clearTimeout)($e),$e=Object(r.setTimeout)(e,6e4)},tt={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"},nt=Ze;var rt=function(e){e.addCommand("confInsertTable",(function(t,n){return function(e,t,n,o){var i,a,c,u,l,s=r.tinymce.Env,f=s.ie&&s.ie<10?"&nbsp;":'<br data-mce-bogus="1">';for(c='<table id="__mce" class="confluenceTable"><tbody>',i=0;i<n;i++){var d=0===i&&o,m=d?"confluenceTh":"confluenceTd";for(c+="<tr>",a=0;a<t;a++)c+=d?"<th class=".concat(m,">").concat(f,"</th>"):"<td class=".concat(m,">").concat(f,"</td>");c+="</tr>"}c+="</tbody></table>",e.undoManager.transact((function(){e.insertContent(c),(u=e.dom.get("__mce"))&&e.dom.setAttrib(u,"id",""),e.$("tr",u).each((function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each((function(t,n){l=l||n,e.fire("newcell",{node:n})}))})),u&&e.dom.setAttribs(u,e.settings.table_default_attributes||{}),u&&e.dom.setStyles(u,e.settings.table_default_styles||{})})),e.selection.select(l,!0),e.selection.collapse(!0)}(e,n.cols,n.rows,n.heading),nt("insert.table"),!1})),e.addCommand("mceInsertTable",(function(){return r.tinymce.execCommand("confInsertTable",!1,{rows:4,cols:3,heading:!0}),!1}))},ot=function(e){var t,n,r=/([\+\-]?\d*)[nN]([\+\-]?\d*)/;e.fn.nthCol=function(o){var i,a,c,u,l,s,f,d,m;return c={multiplier:0,offset:0},"even"===(i=o)?i="2n":"odd"===i?i="2n+1":/^\d*$/.test(i)&&(i="0n+".concat(i)),null!==(a=r.exec(i))&&(c.multiplier=a[1]-0,c.offset=a[2]-0),n=c,u=this,f=[],d=0,m=[],e.each(u,(function(e,t){var n=0,r=0,o=t.rowSpan||1,i=t.colSpan||1;for(t.parentNode!==l&&((l=t.parentNode).parentNode!==s&&(s=l.parentNode,f=[]),d=0,void 0===f[l.rowIndex]&&(f[l.rowIndex]=[])),n=0;n<f[l.rowIndex].length+1;n+=1)if(void 0===f[l.rowIndex][n]){d=n;break}for(m[e]=d,n=l.rowIndex;n<l.rowIndex+o;n+=1)for(void 0===f[n]&&(f[n]=[]),r=d;r<d+i;r+=1)f[n][r]=!0})),t=m,e(this).filter((function(e){return r=t[e]-(n.offset-1),0===n.multiplier?0===r:r%n.multiplier==0&&r/n.multiplier>=0;var r}))}};function it(e){var t=0;e.find(">tbody >tr").each((function(){var e=0;l()(this).find(">th,>td").each((function(){var t=l()(this);t.attr("colspan")?e+=parseInt(t.attr("colspan")):e++})),e>t&&(t=e)}));var n=e.find(">colgroup"),r=n.find("col"),o=r.length;if(o!==t){var i=n.length>0;if(i||(n=l()("<colgroup>")),t>o)for(var a=0;a<t-o;a++){var c=l()("<col>");n.append(c)}else for(var u=0;u<o-t;u++)r.last().remove();return i||e.prepend(n),n}}function at(e,t,n){var o=e.find(">colgroup>col");0===o.length&&(it(e),o=e.find(">colgroup>col"));for(var i,a,c,u=o.length,s=e.find(">thead>tr,>tbody>tr,>tr"),f=0;f<s.length;f++)if(u===s.eq(f).find(">th, >td").length){i=s.eq(f);break}if(i)a=i.find(">th, >td");else{var d=l()("<tr>");(c=l()("<tfoot>")).append(d);for(var m=0;m<u;m++)d.append(l()("<td>"));e.append(c),a=d.find(">td")}for(var p=e.outerWidth()-1,g=[],h=[],v=0;v<u;v++){var b=a.eq(v),y=b[0].getBoundingClientRect(),w=t?"".concat(y.width/p*100,"%"):b.outerWidth();g[v]=w,h[v]=y}var C=0;r.tinymce.activeEditor&&(C=r.tinymce.activeEditor.getWin().pageXOffset);for(var x=0;x<u;x++)o.eq(x).attr("data-resize-pixel",h[x].width).attr("data-resize-percent",h[x].width/p*100).attr("data-offset-left",h[x].left+C).attr("data-offset-right",h[x].right+C).removeAttr("data-mce-style"),(!n||x===n.index()&&x===n.next().index())&&o.eq(x).css({width:g[x]});c&&c.remove(),e.removeAttr("data-mce-style")}function ct(e,t,n){var r={},o=!1,i=t.find("body");return n.each((function(){var t=l()(this);pt(t)&&t.find("th, td").each((function(){if(!r[t]){var n=l()(this),a=n.offset().left+n.innerWidth();Math.abs(a-parseInt(e.attr("data-offset-right")))<=0&&(r[t]=!0,o=!0,function(e,t){l()('<div contenteditable="false" class="resize-alignment-bar">').css({top:lt(e[0],i[0]),left:t,height:e.height()}).appendTo(i)}(t,a))}}))})),o}function ut(e){e.find(".resize-alignment-bar").remove()}function lt(e,t){return parseInt(e.getBoundingClientRect().top-t.getBoundingClientRect().top,10)}var st=function(e){var t={$doc:l()(r.document)},n=this,o=n.data("uuid");if(!n.data("initialized")){o||(o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),n.data("uuid",o)),e=l.a.extend(t,e||{});var i,a,c,u,s,f,m,p,g,h,v=e.$doc,b=e.editor,y=v.find("body"),w=!1,C=-1,x=!1,k=l()('<div contenteditable="false" class="synchrony-exclude" id="resize-indicator">'),S=l()('<div contenteditable="false" class="synchrony-exclude resize-width-holder" unselectable="on">'),T=!1,_=function(){k.remove(),n.removeClass("active-resizable"),T=!1,m=void 0,u=null,s=null,y.attr("data-table-resizing",!1)},A=function(e){v.find("#resize-indicator").length>0?k=v.find("#resize-indicator"):k.appendTo(y),n.addClass("active-resizable"),k.css({top:lt(n[0],y[0]),left:e,height:n.height()}),T=!0},N=function(e){y.outerWidth(!0)!==y[0].scrollWidth&&(e&&dt(n),y.find("#".concat(o,"-holder")).length||(S.css("width",n.width()+parseInt(l()(b.getBody()).css("margin-right"))),S.attr("id","".concat(o,"-holder")),n.after(S)))};return n.on("mousemove.table-resizable".concat(o),"th, td",(function(e){if(!w&&!(l()(this).parents("table.confluenceTable").length>1||gt(n)&&E("confluence.table.resizable.hide-indicator-on-fluid"))){it(n);var t,r=l()(this),o=r.offset().left,a=Math.round(k.outerWidth()/2),c=r.index(),u=r.parent().children();C=-1;var s=r.closest("tr").index();if(r.closest("table.confluenceTable tr").prevAll("tr").each((function(){var e=l()(this),t=e.index();e.children("td, th").each((function(){if(r.offset().left>l()(this).offset().left){var e=parseInt(l()(this).attr("colspan")),n=parseInt(l()(this).attr("rowspan"));e&&n?t+n>s&&(c+=e):n&&t+n>s&&(c+=1)}}))})),x=!1,e.pageX-r.offset().left<r.outerWidth()/2){if(0===(c-=1)&&r.prev().hasClass("numberingColumn"))return;if(c<0){x=!0;var d=u.eq(0);d.attr("colspan")?C+=parseInt(d.attr("colspan")):C++}else for(var m=0;m<=c;m++){var p=u.eq(m);p.attr("colspan")?C+=parseInt(p.attr("colspan")):C++}t=x?o+r.outerWidth()-a:o-a}else{if(0===c&&r.hasClass("numberingColumn"))return;for(var g=0;g<=c;g++){var h=u.eq(g);h.attr("colspan")?C+=parseInt(h.attr("colspan")):C++}t=o+r.outerWidth()-a}i=r.closest("table").find("col").eq(C),function(){if(Math.abs(f-t)<=1)if(T){if(Math.abs(e.pageX-t-a)<=4)return;_()}else{if(!(Math.abs(e.pageX-t-a)<=4))return;A(t)}else Math.abs(e.pageX-t-a)<=4?A(t):_()}(),f=t,pt(n)&&N()}})),n.on("mousedown.table-resizable".concat(o),(function(e){O(e)})),n.on("mouseout.table-resizable".concat(o),(function(){w||_()})),v.on("keypress.table-resizable".concat(o),(function(){T&&_()})),v.on("mousemove.table-resizable".concat(o),(function(e){w&&(d("synchrony.stop",{id:"confluence.table-resize-plugin"}),R(e.pageX-a,!0,e),e.preventDefault())})),v.on("mouseup.table-resizable".concat(o),(function(){w&&(n[0].releaseCapture&&n[0].releaseCapture(),w=!1,_(),ut(v),dt(n),i&&i.width()!==c&&(gt(n)&&n.addClass("relative-table"),d("analytics",{name:"confluence.table.resize.from.".concat(h),data:{pageId:U.get("page-id")}})),mt(n)&&ft(n),pt(n)&&N(!0),b&&(b.undoManager.add(),d("synchrony.start",{id:"confluence.table-resize-plugin"})))})),n.data("initialized",!0),this}function R(e,t,r){c||(c=i.width()),i.attr("data-mce-style")&&i.removeAttr("data-mce-style");var o=!1;if(p){var a=e-p,f=n.parent().width(),d=n.width()/f*100;mt(n)&&d>99.9&&a>1&&(o=!0,!s&&(s=i.width()+i.next().width()));var h=Math.abs(Math.abs(e)-Math.abs(p));if(h>=7&&(m=!1),m&&h<7)return}var b=c+e;if(b<29&&(b=29),i.width(b),(o||u)&&(i.next().width(s-b),!u&&(u=r.pageX)),u&&u>r.pageX&&(u=null),at(n,!1,i),!x&&t&&(k.css({display:"block",top:lt(n[0],y[0]),left:parseInt(i.attr("data-offset-right"))-1,height:n.height()}),pt(n))){var w=ct(i,v,g)||function(e,t,n){var r;return Math.abs(parseInt(e.next().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=1&&(r=!0,n.find(".resizable-align-right").remove(),l()('<div contenteditable="false" class="resize-alignment-bar resizable-align-right">').css({height:t.height(),top:lt(t[0],n[0]),left:parseInt(e.next().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.attr("data-offset-left"))-1}).appendTo(n)),Math.abs(parseInt(e.prev().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=1&&(r=!0,l()('<div contenteditable="false" class="resize-alignment-bar">').css({height:t.height(),top:lt(t[0],n[0]),left:parseInt(e.prev().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.prev().attr("data-offset-left"))-1}).appendTo(n)),r}(i,n,y);w&&(m=!0),!w&&ut(y)}p=Math.abs(e)}function O(e){i&&T&&(h=pt(n)?"fixed":mt(n)?"relative":"fluid",w=!0,at(n),n.updateTableModeInToolbar(),E("confluence.table.resizable.relative.keep.width")&&i.next().length||n.css({width:""}),a=e.pageX,n[0].setCapture&&n[0].setCapture(),v.find("body").attr("data-table-resizing",!0),c=i.width(),g=function(e){var t=e.nextAll(".confluenceTable").first(),n=e.prevAll(".confluenceTable").first();return l.a.merge(n,t)}(n),e.preventDefault())}},ft=function(e){var t=e.parent().width(),n=e.width()/t*100;return n>100&&(n=100),e.css({width:"".concat(n,"%")}).attr("data-resize-percent",n),function(e){at(e,!0)}(e),e},dt=function(e){return e.parent("body").find("#".concat(e.data("uuid"),"-holder")).remove(),e},mt=function(e){return e.hasClass("relative-table")},pt=function(e){return e.hasClass("fixed-table")},gt=function(e){return!mt(e)&&!pt(e)},ht=function(e){var t={$doc:l()(r.document)},n=(e=l.a.extend(t,e||{})).$doc,o=this.data("uuid");return n.find("#resize-indicator").remove(),this.off("mousemove.table-resizable".concat(o)),this.off("mouseout.table-resizable".concat(o)),this.off("mousedown.table-resizable".concat(o)),n.off("keypress.table-resizable".concat(o)),n.off("mousemove.table-resizable".concat(o)),n.off("mouseup.table-resizable".concat(o)),this.data("initialized",!1),this},vt=function(){return dt(l()(this)).removeClass("relative-table fixed-table").removeAttr("style").find(">colgroup").remove(),this},bt=function(){var e=l()(this);return dt(e),function(e){return at(e),e}(e).css("width","").removeClass("relative-table").addClass("fixed-table"),e.find(">tbody >tr >td, >tbody >tr >th").each((function(e,t){t.style.width=""})),this},yt=function(){var e=r.tinymce.activeEditor;if(this.parent().closest("table.confluenceTable").length)return l()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive")),void l()("#table-mode-picker .aui-dd-parent").addClass("disabled");l()("#table-mode-picker .aui-dd-parent").removeClass("disabled"),pt(this)?l()("#table-mode-picker .dropdown-text").text(e.translate("table.fixed_width")):l()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive"))},wt=function(e,t,n){if(n||n.content){var r=l()("<div/>").append(n.content);r.find("table.confluenceTable.relative-table, table.confluenceTable.relative-table > colgroup > col").each((function(){var e;(e=l()(this)).data("resize-percent")?e.css({width:"".concat(e.data("resize-percent"),"%")}):e.attr("style",e.data("mce-style"))})),n.content=r.html()}},Ct=function(e){var t=l()(e.getWin().document);function n(){t.find("table.confluenceTable").each((function(){l()(this).removeTableResizable({$doc:t})})),t.find("#resize-indicator").remove(),t.find(".resize-width-holder").remove(),l()(e.getBody()).removeAttr("data-table-resizing")}return e.on("Change",(function(){var n=e.selection.getNode(),r=l()(n).parent().closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable");r.is(".confluenceTable")&&r.removeTableResizable({$doc:t}).tableResizable({$doc:t,editor:e,force:!0})})),s("confluence.editor.on.save",n),e.on("Remove",(function(){f("confluence.editor.on.save",n)})),t.on("mousemove","table.confluenceTable",(function(){var n=l()(this);n.parents("table.confluenceTable").length||n.data("initialized")||n.tableResizable({$doc:t,editor:e})})),r.tinymce.isWebKit&&l()(r.document).bind("prePaste",wt),r.tinymce.Env.ie&&l()('<style type="text/css"></style>').html(".confluenceTable td, .confluenceTable th {overflow: hidden !important;}.confluenceTable .content-wrapper {overflow-x : visible !important}").appendTo(t.find("head")),this},xt=function(e){l.a.fn.tableResizable=st,l.a.fn.removeTableResizable=ht,l.a.fn.toggleFluidColumnWidth=vt,l.a.fn.toggleFixedColumnWidth=bt,l.a.fn.updateTableModeInToolbar=yt,e.on("init",(function(){Ct(e)}))};function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e){Array.from(e.getBody().querySelectorAll(".confluenceTable.fixed-table >tbody >tr >td, .confluenceTable.fixed-table >tbody >tr >th")).forEach((function(e){e.style.width=""}))}var Tt=function(){var e=r.tinymce.each,t=r.AJS.storageManager;ot(l.a);var n,i=t("atlassian.editor","tables");function a(e,t){return parseInt(e.getAttribute(t)||"1")}function c(t,o,i){var c,u,s,f,d,m,p=o.dom;b();var g,h;function v(e,t){return(e=e.cloneNode(t)).removeAttribute("id"),t&&D()&&e.removeChild(e.children[0]),e}function b(){var n=0;c=[],e(["thead","tbody","tfoot"],(function(r){var o=p.select("> ".concat(r," > tr"),t);e(o,(function(t,o){o+=n,e(p.select("> td, > th",t),(function(e,t){var n,i;if(c[o])for(;c[o][t];)t++;var u=a(e,"rowspan"),l=a(e,"colspan");for(i=o;i<o+u;i++)for(c[i]||(c[i]=[]),n=t;n<t+l;n++)c[i][n]={part:r,real:i==o&&n==t,elm:e,rowspan:u,colspan:l}}))})),n+=o.length}))}function y(e,t){var n=c[t];if(n)return n[e]}function w(e,t,n){e&&(1===n?e.removeAttribute(t):e.setAttribute(t,n.toString()))}function C(e){return e&&e.elm&&(e.elm.hasAttribute("data-mce-selected")||e==d)}function x(){var n=[];return e(t.rows,(function(t){e(t.cells,(function(e){if(e&&e.hasAttribute("data-mce-selected")||e==d.elm)return n.push(t),!1}))})),n}function k(t){var n;return r.tinymce.walk(t,(function(o){var i;if(3===o.nodeType)return e(p.getParents(o.parentNode,void 0,t).reverse(),(function(e){e=v(e,!1),n?i&&i.appendChild(e):n=i=e,i=e})),i&&(i.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />'),!1}),"childNodes"),w(t=v(t,!1),"rowSpan",1),w(t,"colSpan",1),n?t.appendChild(n):r.tinymce.isIE||(t.innerHTML='<br data-mce-bogus="1" />'),l()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}function S(){var n=p.createRng();if(e(p.select("tr",t),(function(e){0===e.cells.length&&p.remove(e)})),0===p.select("tr",t).length)return n.setStartAfter(t),n.setEndAfter(t),i.setRng(n),void p.remove(t);e(p.select("thead,tbody,tfoot",t),(function(e){0===e.rows.length&&p.remove(e)})),function(){var e;b();var t=c[Math.min(c.length-1,u.y)];t&&(e=t[Math.min(t.length-1,u.x)].elm)&&(n=e,r.tinymce.isIE9||r.tinymce.isIE10up?(i.setCursorLocation(n,0),i.collapse(!0)):(i.select(n,!0),i.collapse(!0)));var n}()}function T(e,t,n,r){var o,i,a,u,l;for(o=c[t][e].elm.parentNode,a=1;a<=n;a++)if(o=p.getNext(o,"tr")){for(i=e;i>=0;i--)if((l=c[t+a][i].elm).parentNode==o){for(u=1;u<=r;u++)p.insertAfter(k(l),l);break}if(-1==i)for(u=1;u<=r;u++)o.insertBefore(k(o.cells[0]),o.cells[0])}}function E(){e(c,(function(t,n){e(t,(function(e,t){var r,o,i;if(C(e)){var c=e.elm;if(r=a(c,"colspan"),o=a(c,"rowspan"),r>1||o>1){for(w(c,"rowSpan",1),w(c,"colSpan",1),i=0;i<r-1;i++)p.insertAfter(k(c),c);T(t,n,o-1,r)}}}))}))}function _(t){var n,o,i,u,l,s,f,d,m,g,h;for(e(c,(function(r,o){if(e(r,(function(e){if(C(e)&&(l=e.elm.parentNode,s=v(l,!1),n=o,t))return!1})),t)return!n})),u=0;u<c[0].length;u++)if(c[n][u]&&(o=c[n][u].elm)!=i){if(t){if(n>0&&c[n-1][u]&&(m=a(d=c[n-1][u].elm,"rowSpan"))>1){w(d,"rowSpan",m+1);continue}}else if((m=a(o,"rowspan"))>1){w(o,"rowSpan",m+1);continue}(f=(h=A(u))?p.create("th"):p.create("td")).colSpan=o.colSpan,f.width=o.width,f.innerHTML=r.tinymce.isIE9?"":r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />',f.className=o.className,h||(p.removeClass(f,r.tinymce.settings.confluence_table_heading_style),p.addClass(f,r.tinymce.settings.confluence_table_cell_style)),g=p.getAttrib(o,"data-highlight-colour",""),N(u)?p.setAttrib(f,"data-highlight-colour",g):p.removeClass(f,"highlight-".concat(g)),s.appendChild(f),i=o}s.hasChildNodes()&&(t?l.parentNode.insertBefore(s,l):p.insertAfter(s,l)),O()}function A(e){if(1===c.length)return!1;for(var t=0;t<c.length;t++)if(c[t]&&c[t][e]&&"TH"!==c[t][e].elm.tagName.toUpperCase())return!1;return!0}function N(e){var t=c[0][e].elm.getAttribute("data-highlight-colour");if(null===t)return!1;for(var n=0;n<c.length;n++)if(c[n][e].elm.getAttribute("data-highlight-colour")!==t)return!1;return!0}function R(t){var o,i,u=[];return e(c,(function(n){if(e(n,(function(e,n){if(C(e)&&(o=n,t))return!1})),t)return!o})),0==o&&t&&D()?[]:(e(c,(function(e,c){var s,f;if(e[o]){var d=e[o].elm;if(0===c){var m=l()(d).closest("table"),g=m.find(">colgroup>col").eq(o),h=l()("<col>");t?h.insertBefore(g):h.insertAfter(g),m.hasClass("fixed-table")&&(n&&0!==parseFloat(n)?h.css({width:n}):h.css({width:29}))}if(d!=i){if(f=a(d,"colspan"),s=a(d,"rowspan"),1==f){var v=function(e){var t=p.create(e.tagName);t.colSpan=e.colSpan,t.width=e.width,t.className=e.className,t.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1"/>';var n=p.getAttrib(e,"data-highlight-colour","");return n&&p.setAttrib(t,"data-highlight-colour",n),l()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}(d);t?(d.parentNode.insertBefore(v,d),T(o,c,s-1,f)):(p.insertAfter(v,d),T(o,c,s-1,f)),u.push(v)}else w(d,"colSpan",d.colSpan+1);i=d}}})),u)}function O(){if(D()){m=1;var n=0,r=0;e(t.rows,(function(e){var t=l()(e);Ke.areCellsHeadings(t.children())?t.children(":first").addClass("numberingColumn").attr("contenteditable","true"):r>0?r--:(t.children(":first").html(m.toString()).attr("contenteditable","false").addClass("numberingColumn"),(n=parseInt(t.children(":first").attr("rowspan")))>1&&(r=n-1),m++)}))}}function D(){return l()(t.rows[0]).children(":first").hasClass("numberingColumn")}function I(e){if(e){l()(t.rows[0]).children(":first").addClass("numberingColumn");var n=l()(t),r=n.find(">colgroup>col").eq(0),o=l()("<col>");o.insertBefore(r),n.hasClass("fixed-table")&&o.css({width:29})}else l()(t.rows[0]).children(":first").removeClass("numberingColumn"),l()(t).find(">colgroup>col").eq(0).remove()}function P(){var t=[];e(c,(function(n){e(n,(function(n,o){C(n)&&-1===r.tinymce.inArray(t,o)&&(l()(n.elm).closest("table").find(">colgroup>col").eq(o).remove(),e(c,(function(e){if(e[o]){var t=e[o].elm,n=a(t,"colSpan");n>1?w(t,"colSpan",n-1):p.remove(t)}})),t.push(o))}))})),S()}function B(){var t={};return e(c,(function(r){e(r,(function(e,r){C(e)&&(n=l()(e.elm).closest("table").find(">colgroup>col").eq(r).css("width"),0===parseFloat(n)&&(n="".concat(e.elm.getBoundingClientRect().width)),t[r]||(t[r]=[]))}))})),e(c,(function(n){e(n,(function(e,n){t[n]&&t[n].push(e.elm.innerHTML)}))})),t}function M(e){e&&e.parentNode&&(i.select(e.parentNode),i.collapse(!0))}function L(e,t){var n=y(e.x,e.y).elm,o=void 0===t||t,a=null;if((r.tinymce.isGecko||r.tinymce.isIE)&&n.firstChild&&(a=n.firstChild),r.tinymce.isIE9||r.tinymce.isIE10up){var c=i.getRng();if(!c)return;o?(c.setStart(a||n,0),c.setEnd(a||n,0)):(c.setStartAfter(a||n),c.setEndAfter(a||n)),i.setRng(c)}else i.select(a||n,!0),i.collapse(o)}function F(){var e,t=c[0].length;return u.x==t-1&&u.y==c.length-1||(u.x==t-1&&D()?(e={x:1,y:u.y+1},Ke.areCellsHeadings(l()(c[e.y][0].elm).parent().children())&&(e.x=0)):e=u.x==t-1?{x:0,y:u.y+1}:{x:u.x+1,y:u.y}),e}function j(){var e,t;return 0==u.x&&0==u.y||(1==u.x&&D()&&u.y>0?(t=u.y-1,e={x:c[t].length-1,y:t}):u.x>0?e={x:u.x-1,y:u.y}:(t=u.y-1,e={x:c[t].length-1,y:t})),e}function H(t){var n;return e(c,(function(r,o){return e(r,(function(e,r){if(e.elm==t)return n={x:r,y:o},!1})),!n})),n}(f=p.select("td[data-mce-selected],th[data-mce-selected]")[0]||l()(i.getStart()).closest(["table.confluenceTable > tbody > tr > th","table.confluenceTable > tbody > tr > td","table.confluenceTable > thead > tr > th","table.confluenceTable > thead > tr > td"].join(","))[0])&&(u=H(f),g=h=0,e(c,(function(t,n){e(t,(function(e,t){var r,o;C(e)&&(e=c[n][t],t>g&&(g=t),n>h&&(h=n),e.real&&(r=e.colspan-1,o=e.rowspan-1,r&&t+r>g&&(g=t+r),o&&n+o>h&&(h=n+o)))}))})),s={x:g,y:h},d=y(u.x,u.y)),r.tinymce.extend(this,{deleteTable:function(){var e=p.createRng();e.setStartAfter(t),e.setEndAfter(t),i.setRng(e),p.remove(t)},split:E,merge:function(t,n,o){var i,a,l,f,d,m,g,h,v;if(t){var C=H(t);i=C.x,a=C.y,l=i+(n-1),f=a+(o-1)}else i=u.x,a=u.y,l=s.x,f=s.y;if(0!=i||!D()){g=y(i,a);var x=y(l,f);if(g&&x&&g.part==x.part){var k=function(){if(E(),b(),!(g=y(i,a)))return{v:void 0};var n=g.elm;for(w(n,"colSpan",l-i+1),w(n,"rowSpan",f-a+1),m=a;m<=f;m++)for(d=i;d<=l;d++)c[m]&&c[m][d]&&(t=c[m][d].elm)!=n&&(h=r.tinymce.grep(t.childNodes),e(h,(function(e){n.appendChild(e)})),h.length&&(h=r.tinymce.grep(n.childNodes),v=0,e(h,(function(e){"BR"===e.nodeName&&p.getAttrib(e,"data-mce-bogus","")&&v++<h.length-1&&n.removeChild(e)}))),p.remove(t));S()}();if("object"===kt(k))return k.v}}},insertRow:_,insertCol:R,insertNumCol:function(){var t;D()?(e(c,(function(e){var t=e[0].elm;l()(t).hasClass("numberingColumn")&&null!==t.parentNode&&t.parentNode.removeChild(t)})),I(!1)):(e(c,(function(e){var n=e[0].elm;if(t!=n){var r=k(n);n.parentNode.insertBefore(r,n),n.rowSpan>1&&(r.rowSpan=n.rowSpan),t=n}})),I(!0)),O()},updateNumCol:O,deleteCols:P,deleteRows:function(){var t=x();(r.tinymce.isIE9||r.tinymce.isIE10)&&M(t[0]),e(t.reverse(),(function(t){!function(t){var n,r;e(t.cells,(function(e){var t=a(e,"rowSpan");t>1&&(w(e,"rowSpan",t-1),T((n=H(e)).x,n.y,1,1))})),n=H(t.cells[0]),e(c[n.y],(function(e){var t,n=e.elm;n!=r&&((t=a(n,"rowSpan"))<=1?p.remove(n):w(n,"rowSpan",t-1),r=n)}))}(t)})),S(),O()},cutRows:function(){var e=x();return(r.tinymce.isIE9||r.tinymce.isIE10)&&M(e[0]),p.remove(e),S(),O(),e},copyRows:function(){var t=x();return e(t,(function(e,n){t[n]=v(e,!0)})),t},pasteRows:function(t,n){var r=x(),o=r[n?0:r.length-1],i=o.cells.length;e(c,(function(t){var n;if(i=0,e(t,(function(e){e.real&&(i+=e.colspan),e.elm.parentNode==o&&(n=1)})),n)return!1})),e(t,(function(e){var t,r=e.cells.length;for(l()(e.cells[0]).hasClass("numberingColumn")&&(e.removeChild(e.cells[0]),r--),m=0;m<r;m++)w(t=e.cells[m],"colSpan",1),w(t,"rowSpan",1);for(D()&&(e.insertBefore(e.firstChild.cloneNode(!1),e.firstChild),l()(e.firstChild).addClass("numberingColumn"),r++);i<r;)R(!1),i++;for(m=r;m<i;m++)e.appendChild(k(e.cells[r-1]));n?o.parentNode.insertBefore(e,o):p.insertAfter(e,o)})),O()},getPos:H,setStartCell:function(e){u=H(e)},setEndCell:function(e){var t,n,r,i,a,f,d,m,p;if(s=H(e),u&&s){t=Math.min(u.x,s.x),n=Math.min(u.y,s.y),a=r=Math.max(u.x,s.x),f=i=Math.max(u.y,s.y);for(var g=n;g<=f;g++)(p=c[g][t]).real||t-(p.colspan-1)<t&&(t-=p.colspan-1);for(var h=t;h<=a;h++)(p=c[n][h]).real||n-(p.rowspan-1)<n&&(n-=p.rowspan-1);for(var v=n;v<=i;v++)for(var b=t;b<=r;b++)(p=c[v][b]).real&&((d=p.colspan-1)&&b+d>a&&(a=b+d),(m=p.rowspan-1)&&v+m>f&&(f=v+m));l()("td[data-mce-selected],th[data-mce-selected]",o.getBody()).removeAttr("data-mce-selected");for(var y=n;y<=f;y++)for(var w=t;w<=a;w++)c[y][w]&&c[y][w].elm.setAttribute("data-mce-selected","1")}},moveCaretToNextCell:function(){var e=F();e||(_(!1),b(),e=F()),L(e)},moveCaretToPrevCell:function(){var e=j();e||(_(!0),b(),u=H(p.getParent(i.getStart(),"th,td")),e=j()),L(e,!1)},cutColumns:function(){var e=B();return P(),e},copyColumns:B,pasteColumns:function(e,t){var n=Object.keys(e);t||n.reverse(),l.a.each(n,(function(n,r){var o=R(t);for(n=0;n<o.length;n++)o[n].innerHTML=e[r][n]||""}))},prepareTableForColPasteAndCheckIfNeedToRepaint:function(t){var n,r,o=t[Object.keys(t)[0]].length,i=!1;if(e(c,(function(t,i){o--,n=i,e(t,(function(e,t){r=t}))})),o>0)for(i=!0,d=y(r,n),m=0;m<o;m++)_(!1);return i},toggleFluidColumnWidth:function(){t&&t.rows&&(l()(t).toggleFluidColumnWidth(),l()("#table-mode-picker .dropdown-text").text(o.translate("table.responsive")))},toggleFixedColumnWidth:function(){t&&t.rows&&(l()(t).toggleFixedColumnWidth(),l()("#table-mode-picker .dropdown-text").text(o.translate("table.fixed_width")))}})}return{init:function(t){var u=!0;function s(e){var n=t.selection;e=e||n.getNode().parentNode;var r=t.dom.getParent(e,"table.confluenceTable");if(r)return new c(r,t,n)}function f(){t.getBody().style.webkitUserSelect="",u&&(l()("td[data-mce-selected],th[data-mce-selected]",t.getBody()).removeAttr("data-mce-selected"),u=!1)}function d(e){for(var n,r=[],o=0;o<e.length;o++)r.push(t.serializer.serialize(e[o],{}));n="<tr>".concat(r.join("</tr><tr>"),"</tr>"),i.setItem("copied",n,7200)}function m(){var e,n=l()(""),r=i.getItem("copied")||"";return r&&((e=t.getDoc().createElement("div")).innerHTML="<table>".concat(r,"</table>"),n=l()(e).find("tr")),n}function p(e){i.setItem("copiedCols",JSON.stringify(e))}function g(){return JSON.parse(i.getItem("copiedCols"))||{}}t.on("PreProcess",(function(e){var n,r,o,i=t.dom,a=i.select("table",e.node);for(n=a.length;n--;)r=a[n],i.setAttrib(r,"data-mce-style",""),(o=i.getAttrib(r,"width"))&&(i.setStyle(r,"width",o),i.setAttrib(r,"width","")),(o=i.getAttrib(r,"height"))&&(i.setStyle(r,"height",o),i.setAttrib(r,"height",""))})),t.on("init",(function(){t.on("Undo",(function(){u=t.dom.select("td[data-mce-selected], th[data-mce-selected]").length>0})),t.on("KeyUp",(function(){f()})),r.tinymce.isWebKit&&t.on("KeyDown",(function(n){var o=r.tinymce.util.VK,i=n.keyCode;function c(e,n,o){var i=e?"previousSibling":"nextSibling",a=t.dom.getParent(n,"tr"),f=a[i];if(f)return s(t,n,f,e),r.tinymce.dom.Event.cancel(o),!0;var d=t.dom.getParent(a,"table"),m=a.parentNode,p=m.nodeName.toLowerCase();if("tbody"===p||p===(e?"tfoot":"thead")){var g=function(e,n,r,o){var i=t.dom.select(">".concat(o),n),a=i.indexOf(r);if(e&&0===a||!e&&a===i.length-1)return function(e,n){var r=e?"thead":"tfoot",o=t.dom.select(">".concat(r),n);return 0!==o.length?o[0]:null}(e,n);if(-1===a){var c="thead"===r.tagName.toLowerCase()?0:i.length-1;return i[c]}return i[a+(e?-1:1)]}(e,d,m,"tbody");if(null!==g)return function(e,n,o,i){var a=u(n,e);return a&&s(t,o,a,e),r.tinymce.dom.Event.cancel(i),!0}(e,g,n,o)}return function(e,n,o,i,a){var s=i[o];if(s)return l(s),!0;var f=t.dom.getParent(i,"td,th");return f?c(e,f,a):(l(u(n,!e)),r.tinymce.dom.Event.cancel(a))}(e,a,i,d,o)}function u(e,n){var r=e&&e[n?"lastChild":"firstChild"];return r&&"BR"===r.nodeName?t.dom.getParent(r,"td,th"):r}function l(e){t.selection.setCursorLocation(e,0)}function s(t,n,r,o){var i=function(t,n){var r=0,o=0;return e(t.children,(function(e,t){if(r+=a(e,"colspan"),o=t,r>n)return!1})),o}(r,function(e){for(var t=0,n=e;n.previousSibling;)t+=a(n=n.previousSibling,"colspan");return t}(t.dom.getParent(n,"td,th"))),c=r.childNodes[i];l(u(c,o)||c)}function f(e){var n,r,o=t.selection.getNode(),i=t.dom.getParent(o,"td,th"),a=t.dom.getParent(e,"td,th");return i&&i!==a&&(n=i,r=a,t.dom.getParent(n,"TABLE")===t.dom.getParent(r,"TABLE"))}if((i==o.UP||i==o.DOWN)&&function(e){var t=e.selection.getNode();return null!==e.dom.getParent(t,"tr")}(t)){var d=t.selection.getNode();setTimeout((function(){f(d)&&c(!n.shiftKey&&i===o.UP,d,n)}),0)}}))})),t.on("copy",(function(){!0===t.selection.isCollapsed()&&t.getBody().querySelectorAll("th[data-mce-selected],td[data-mce-selected]").length>1&&t.selection.select(t.selection.getNode())}),!0),e({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){t.dom.select("td[data-mce-selected],th[data-mce-selected]").length&&e.merge()},mceTableInsertRowBefore:function(e){e.insertRow(!0)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertNumberingCol:function(e){e.insertNumCol()},mceTableUpdateNumberingCol:function(e){e.updateNumCol()},mceAutoWidth:function(e){e.toggleFluidColumnWidth()},mceFixedWidth:function(e){e.toggleFixedColumnWidth()},mceTableInsertColBefore:function(e){n=null,e.insertCol(!0)},mceTableInsertColAfter:function(e){n=null,e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){d(e.cutRows())},mceTableCopyRow:function(e){d(e.copyRows())},mceTablePasteRowBefore:function(e){e.pasteRows(m(),!0)},mceTablePasteRowAfter:function(e){e.pasteRows(m())},mceTableDelete:function(e){e.deleteTable()},mceTableMoveCaretToNextCell:function(e){e.moveCaretToNextCell()},mceTableMoveCaretToPrevCell:function(e){e.moveCaretToPrevCell()},mceTableCopyCol:function(e){p(e.copyColumns())},mceTableCutCol:function(e){p(e.cutColumns())},mceTablePasteColBefore:function(e){var n=g();e.prepareTableForColPasteAndCheckIfNeedToRepaint(n)&&(t.execCommand("mceRepaint"),e=s()),e.pasteColumns(n,!0)},mceTablePasteColAfter:function(e){e.pasteColumns(g(),!1)}},(function(e,n){t.addCommand(n,(function(){var n=s();return n&&(e(n),t.execCommand("mceRepaint"),f()),!1}))})),rt(t),xt(t),Xe(t),ze()?l()(o.a).one("rte-collab-ready",(function(){St(t)})):l()(o.a).one("rte-ready",(function(){St(t)}))}}};n("./src/editor-plugins/iosediting/iosediting.css");var Et=function(e){return e.replace(/[&"'<>`]/g,(function(e){var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"}))};function _t(e,t,n){"cl.ly"==e.host?l.a.get("".concat(ye,"/rest/autoconvert/1.0/cloudappembed?resource=").concat(e.path.substr(1)),(function(e){if(e)switch(e.item_type){case"image":var r=Et(e.content_url);n(l()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(r,'" data-image-src="').concat(r,'"/>'))[0]);break;case"bookmark":t.text(e.name),t.attr("href",Et(e.redirect_url)),n(t)}else n()})):n()}function At(){var e=this,t=function(e,t){return t.anchor&&0!==t.anchor.indexOf("comment-")?"".concat(e,"#").concat(t.anchor.substring(t.anchor.indexOf("-")+1)):e},n=function(n,i,a){if(o(n)){var c=function(e){return ye?e.path.substring(ye.length+1):e.path.substring(1)}(n),u=decodeURIComponent(c).split("/"),s="";n.queryKey=n.queryKey||{},n.queryKey.focusedCommentId?(s="$".concat(n.queryKey.focusedCommentId),s=t(s,n)):n.queryKey.pageId?(s="$".concat(n.queryKey.pageId),s=t(s,n)):"display"===u[0]?s=function(e,n,r){return 2===r.length&&0===r[1].indexOf("~")?n=r[1]:3===r.length?(n="".concat(r[1],":").concat(r[2].replace(/\+/g," ")),n=t(n,e)):4===r.length&&"status"===r[1]?n="$".concat(r[3]):6===r.length&&(n="".concat(r[1],":")+"/".concat(r[2],"/").concat(r[3],"/").concat(r[4],"/").concat(r[5].replace(/\+/g," ")),n=t(n,e)),n}(n,s,u):"spaces"===u[0]?s=(s=(s=e.spaViewPageLinkHandler(u))||e.spaBlogPostLinkHandler(u))?t(s,n):function(e,n,r){return 2!==r.length&&3!==r.length||-1!==r[1].indexOf(".action")||(n="".concat(r[1],":")+"",n=t(n,e)),n}(n,s,u):"users"===u[0]?s=function(e,t,n){return 2===n.length&&"viewuserprofile.action"==n[1]?t="~".concat(e.queryKey.username):2===n.length&&"viewmyprofile.action"==n[1]&&(t="~".concat(U.get("remote-user"))),t}(n,s,u):"pages"===u[0]&&"viewpage.action"===u[1]&&n.queryKey&&n.queryKey.spaceKey&&n.queryKey.title&&(s="".concat(n.queryKey.spaceKey,":").concat(n.queryKey.title.replace(/\+/g," "))),s?(s="[".concat(s,"]"),r.tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(s,(function(e){a(l()(e).children()[0])}),(function(){a()}))):a()}else a()},o=function(e){var t=!0;return t=t&&e.authority===r.document.location.host,t=t&&(!ye||0===e.path.indexOf(ye)),t};this.init=function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(n)}}At.prototype.spaViewPageLinkHandler=function(e){var t="spaces"===e[0]&&"pages"===e[2],n="edit"===e[3]?e[4]:e[3];if(t&&n)return"$".concat(n)},At.prototype.spaBlogPostLinkHandler=function(e){var t="spaces"===e[0]&&"blog"===e[2],n=e[1],r=e[3],o=e[4],i=e[5],a=e[6],c=e[7];if(t&&n&&r&&o&&i&&a&&c)return"".concat(n,":/").concat(r,"/").concat(o,"/").concat(i,"/").concat(c.replace(/\+/g," "))};function Nt(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(/google.*/)&&"/url"===e.path&&e.queryKey&&e.queryKey.url){var r=decodeURIComponent(e.queryKey.url);(t=l()(t)).attr("href",r),t.attr("data-mce-href",r),t.text(r),n(t)}else n()}))}var Rt=function(){var e=[],t=function(e){return e.indexOf("%s")>=0?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):"".concat(e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"(.*)")};r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,r){if(t.source===n.text()){for(var o=0;o<e.length;o++){var i=e[o],a=t.source.match(i.regex);if(a){var c=a[1];if(i.defaultAlias){var u=i.defaultAlias.replace(/%s/,c);return void r(l()(n).text(u))}return void r(l()(n).text(c))}}r()}else r()})),setTimeout((function(){l.a.ajax({url:"".concat(ye,"/rest/autoconvert/latest/shortcutlinkconfigurations"),type:"GET",dataType:"json",success:function(n){e=n.configurations;for(var r=0;r<e.length;r++){var o=e[r];try{o.regex=new RegExp(t(o.expandedValue))}catch(e){console.log("Failed to generated regex for ".concat(o))}}},error:function(e){console.log("Failed to load shortcut link configurations ".concat(e.statusText))}})}),0)},Ot=function(e,t,n){"www.skitch.com"===e.host||"skitch.com"===e.host?l.a.get("".concat(ye,"/rest/autoconvert/1.0/skitchembed?url=").concat(e.source),(function(e){e&&e.url?n(l()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(e.url,'" data-image-src="').concat(e.url,'"/>'))[0]):n()})):n()};function Dt(){var e=[/youtube-nocookie.com\/embed\/?/,/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/[^\.]\.wufoo\.com\/(?:forms|reports)/];r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,o){for(var i=decodeURI(t.source),a=0;a<e.length;a++)if(i.match(e[a])){var c={name:"widget",params:{url:i}};return void r.tinymce.plugins.Autoconvert.convertMacroToDom(c,o,o)}o()}))}function It(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(".*youtu.be.*")){var r=e.path.substr(1),o="http://youtube.com/watch?v=".concat(r);n(l()(t).attr("href",o).text(o))}else n()}))}var Pt={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,t){var n=null;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=o.url;if("/"!==o.url[o.url.length-1]&&(i+="/"),0===e.indexOf(i)){n=o;break}}return n},pasteHandler:function(e,t,n){var o=y.a.Editor.JiraConnector.servers;if(!o)return n(),null;var i=y.a.Editor.JiraAnalytics,a={},c=Pt._getMatchedServerFromLink(e.source,o),u=null;if(c){var l="",s=Pt.jqlRegEx.exec(e.source)||Pt.jqlRegExAlternateFormat.exec(e.source),f=y.a.JQLHelper.isFilterUrl(e.source),d=Pt.issueKeyOnlyRegEx.exec(e.source)||Pt.issueKeyWithinRegex.exec(e.source);if(d?(l=d[2],i&&(a.type=i.linkTypes.jql)):(d=Pt.singleTicketXMLEx.exec(e.source))&&(l=d[1],i&&(a.type=i.linkTypes.xml)),s)a.is_single_issue=!1,a.type=y.a.JQLHelper.checkQueryType(e.source),u={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:decodeURIComponent(s[1].replace(/\+/g,"%20"))}};else if(f){var m=e.source;a.is_single_issue=!1,a.type=y.a.JQLHelper.checkQueryType(m),u={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:y.a.JQLHelper.getFilterFromFilterUrl(m)}}}else l&&(a.is_single_issue=!0,u={name:"jira",params:{server:c.name,serverId:c.id,key:l}})}u?(r.tinymce.plugins.Autoconvert.convertMacroToDom(u,n,n),i&&i.triggerPasteEvent(a)):n()}};var Bt=/^\/(.*?)\/status\/([^/]+\/?$)/,Mt=/^\/(.*?)\/statuses\/([^/]+\/?$)/,Lt=function(e,t,n){var o,i,a;e.host.match(/^twitter.com/)?((o=decodeURI(e.path).match(Bt))?i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/status/").concat(o[2]):(o=decodeURI(e.path).match(Mt))&&(i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/statuses/").concat(o[2])),i?(a={name:"widget",params:{url:i}},r.tinymce.plugins.Autoconvert.convertMacroToDom(a,n,n)):n()):n()};function Ft(){s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(_t)})),s("init.rte",(new At).init),s("init.rte",Nt),s("init.rte",Rt),s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Ot)})),s("init.rte",Dt),s("init.rte",It),s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Pt.pasteHandler)})),s("init.rte",(function(){return r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Lt)}))}var jt={initializeEditor:function(){r.AJS&&r.AJS.Rte&&r.AJS.Rte.BootstrapManager&&r.AJS.Rte.BootstrapManager.addOnInitCallback((function(){var e=r.tinymce.activeEditor;e&&(window.MutationObserver&&!(r.tinymce.Env.gecko||r.tinymce.Env.webkit||r.tinymce.Env.ie>11)?function(e){new MutationObserver((function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.addedNodes.length)for(var r=0;r<n.addedNodes.length;r++){if("img"===n.addedNodes[r].localName)return void window.setTimeout(jt.pasteFromDataURL,0)}}})).observe(e.getDoc(),{childList:!0,subtree:!0})}(e):function(e){e.on("Paste",(function(e){return!!jt.onPaste(e)||(r.tinymce.dom.Event.cancel(e),!1)}))}(e))}))},pasteFromDataURL:function(){var e=l()('img[src^="data:image"]:not(".editor-inline-macro")',r.tinymce.activeEditor.getDoc());l.a.each(e,(function(){var e,t,n,o=this.src;if(E("filestore.direct.upload")&&!E("filestore.direct.upload.force.disable")){var i=o.split(","),a=atob(i[1]),c=a.length;for(t=a.length,e=new Uint8Array(c);c--;)e[c]=a.charCodeAt(c)}else{n="base64",t=3*(e=o.substring(22,o.length)).length/4;for(var u=0,l=e.length-1;"="==e[l];l--)u++;t-=u}r.Confluence.Uploader.upload([jt.createUploadFile(e,t,n)])})),e.remove()},onPaste:function(e){return!e||!e.clipboardData||jt.pasteFromEvent(e)},showClipboardAccessError:function(){var e=r.tinymce.activeEditor;new r.AJS.Dialog({width:400,closeOnOutsideClick:!0}).addPanel("alert",l()("<div />",{text:e.translate("clipboardaccess.browser.not.supported")})).addButton(e.translate("clipboardaccess.ok"),(function(e){e.remove()})).show().updateHeight()},pasteFromEvent:function(e){if(e&&e.clipboardData){if(e.clipboardData.items){var t=e.clipboardData.items[0];if(!t||"file"!=t.kind)return!0;var n=t.getAsFile(),o=jt.createUploadFile(n,n.size);return r.Confluence.Uploader.upload([o]),!1}window.setTimeout((function(e){var t=l()("img[src^='webkit-fake-url://']",r.tinymce.activeEditor.getDoc());t.length&&(t.remove(),e.showClipboardAccessError())}),0,this)}return!0},createUploadFile:function(e,t,n){var r=new Date,o=r.getMonth()+1;return{fileName:"image".concat(r.getFullYear(),"-").concat(o,"-").concat(r.getDate(),"_").concat(r.getHours(),"-").concat(r.getMinutes(),"-").concat(r.getSeconds(),".png"),fileSize:t,slice:function(t,n){return e.slice(t,t+n)},getAsBinary:function(){return e},getData:function(){return e},encoding:n}}};n("./src/editor-plugins/draggable/draggable.css");var Ht=function(){var e,t,n,o,i,a,c,u,s,f,m,p,g,h=r.Confluence.PropertyPanel,v=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100];var b="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img";function y(t){var r=!!o.children(".contentLayout,.contentLayout2").length;function i(){return n.find("#move-indicator")}function a(e){return"move-indicator"===e.attr("id")}function c(e){return r?e.is("div.innerCell,div.cell"):e.is("body")}function u(e,t,r){return e.is("img")?function(e,t){var r=e.offset();return t+n.scrollLeft()-r.left}(e,t)<e.width()/2:s(e,r)<e.height()/2}function s(e,t){var r=e.offset();return t+n.scrollTop()-r.top}return{positionNear:function(e,r){var f=function(e,r){var f=l()(n[0].elementFromPoint(e,r)),d=!0;if(function(e){if(e.is(b)&&!a(e))return(!e.is("td.wysiwyg-macro-body")||"PLAIN_TEXT"!==e.closest("table").attr("data-macro-body-type"))&&!(e.is("img")&&!t.is("img"));return!1}(f))return{target:f,before:u(f,e,r)};if(c(f)){if(function(e,t){return s(e.children().first(),t)<0}(f=function(e){if(e.is("div.cell"))return e.children("div.innerCell").first();return e}(f),r))f=f.children().first();else if(function(e,t){return function(e,t){var n=s(e,t),r=e.height();return n-r}(e.children().last(),t)>0}(f,r))f=f.children().last(),d=!1;else{if(m=f,i().length>0&&i().parent(m).length>0)return null;f=function(e){var n=t.parent(b);n.length||(n=e.find(b).last());n.length||(n=o.find(b).last());return n}(f),d=!1}return{target:f,before:d}}var m;return null}(e,r);f&&function(e,t){if(a(e))return;var n=i();if(e.is("li,td,th")&&e.find(n).length)return;n.length?n.detach():n=l()('<span id="move-indicator">|</span>');!(e=function(e){if(e.is("li,td,th")){var t=e.children().first();t.is("p,h1,h2,h3,h4,h5,h6,blockquote")&&(e=t)}return e}(e)).is("img")&&me().Cursor.isTextContainerEmpty(e[0])?e.prepend(n):e.is("li,td,th")?t?e.prepend(n):e.append(n):t?e.before(n):e.after(n)}(f.target,f.before)},replaceWith:function(t){var n=i();n.length?(t.is("img")&&c(n.parent())&&(t=l()("<p></p>").append(t)),n.replaceWith(t),e.dom.isBlock(t[0])&&t.parent().is("p")&&t.unwrap(),me().showElement(t),e.selection.select(t[0]),e.selection.collapse(!0)):e.undoManager.undo(),me().Cursor.fixCursorTargets(e.getBody())},destroy:function(){var t=i();t.length&&(t.remove(),me().Cursor.fixCursorTargets(e.getBody()))}}}function w(t){if(1===t.which&&t.target===t.currentTarget)if(s)S(t);else{s=l()(t.target),e.selection.select(t.target),t.preventDefault(),n.bind({"mousemove.moveable-zone":k,"mouseup.moveable-zone":S,"keydown.moveable-zone":C,"mouseover.moveable-zone":x});var r,o=s.offset();c=t.pageX,u=t.pageY,i=o.top-u,a=o.left-c,m=!0,f=(r=s).attr("style")||"",s=r}}function C(t){27===t.keyCode&&(p.cancelScrolling(),n.unbind(".moveable-zone"),e.undoManager.undo(),e.selection.select(s[0]),e.selection.collapse(!1),s=null)}function x(){n.find(".mceSelected").removeClass("mceSelected")}function k(n){if(m){if(function(e){var t=Math.abs(c-e.pageX),n=Math.abs(u-e.pageY);return t<10&&n<10}(n))return;ke(),e.undoManager.beforeChange(),e.undoManager.typing=!0,e.undoManager.add(),d("synchrony.stop",{id:"confluence.draggable-plugin"}),(r=e.selection.getSel())&&r.removeAllRanges&&r.removeAllRanges(),s.css({position:"absolute",width:s.css("width"),"max-width":"50%"}),h.current&&h.destroy(),s.detach(),me().Cursor.fixCursorTargets(e.getBody()),o.append(s),g=y(s),m=!1}var r;n.preventDefault(),s.hide(),function(e,n){var r=v.length;if((n=Math.max(n,0))<r)return void p.scrollUp(v[n]);var o=t.height(),i=Math.max(0,o-n);if(i<r)return void p.scrollDown(v[i]);p.cancelScrolling()}(n.clientX,n.clientY),g.positionNear(n.clientX,n.clientY);var l=Math.min(n.pageY+i,p.scrollHeight()-s.outerHeight()),f=n.pageX+a;s.css({top:l,left:f,opacity:.5}),s.show()}function S(t){n.unbind(".moveable-zone"),p.cancelScrolling(),m?s=null:(t.preventDefault(),s.detach(),s.attr("style",f),g.replaceWith(s),g.destroy(),s=null,g=null,x(),e.undoManager.add(),d("synchrony.start",{id:"confluence.draggable-plugin"}))}return{init:function(i){e=i,i.on("Init",(function(){var e,a,c;t=l()(i.getWin()),n=l()(i.getDoc()),o=l()(i.getBody()),e=r.tinymce.Env.webkit?o:n.find("html"),a=e,c=0,p={scrollUp:function(e){if(c!==-e){c=-e;var t=a.scrollTop()/e*1e3;a.stop(!1,!1),a.animate({scrollTop:0},{duration:t})}},scrollDown:function(e){if(c!==e){var t=a[0].scrollHeight,n=(t-a.scrollTop())/e*1e3;a.stop(!1,!1),a.animate({scrollTop:t},{duration:n})}},cancelScrolling:function(){a.stop(!0,!1)},scrollHeight:function(){return a[0].scrollHeight}},n.delegate("img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",{mousedown:w})}))},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}};n("./src/editor-plugins/insert-files/insert-files.css");var Ut=function e(t,n){var i;if(!U.get("remote-user")||!U.get("confluence.prefs.editor.disable.autoformat")){E.prototype={registerHandler:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},executeHandlers:function(e,t,n,r){var o=!0;return l.a.each(this.handlers[e]||[],(function(e,i){if(i.handles(t))return o=i.execute(t,n,r),!1})),o}};var a,c=n.editor,u=new E,s=[new _(")",e.regularExpressions._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile","smile.svg"),new _("(",e.regularExpressions._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.svg"),new _("P",e.regularExpressions._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.svg"),new _("p",e.regularExpressions._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.svg"),new _("D",e.regularExpressions._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink","wink.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.CROSS,"cross","emotions_dlg.error","error.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_ON,"light-on","emotions_dlg.lightbulb_on","lightbulb_on.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.svg"),new _(")",e.regularExpressions._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.svg"),new _("3",e.regularExpressions._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.svg"),new _("3",e.regularExpressions._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.svg")],f=[];for(a=0;a<s.length;a++)f[a]=new o.a.Image,f[a].src=s[a].imagePath;for(l.a.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough","`":"monospace"},(function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"(?=[^\\s").concat(e,"])([^").concat(e,"]*?[^\\s]))$"));u.registerHandler(e.charCodeAt(0),S(n,(function(e){A(t,e[2])}),!0))})),c.formatter.register("code",{inline:"code"}),u.registerHandler("}".charCodeAt(0),S(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,(function(e){A("code",e[2])}),!0)),a=1;a<=6;a++)!function(e){u.registerHandler(" ".charCodeAt(0),S(new RegExp("^\\u200b?(h".concat(e,"\\.)$")),(function(){c.execCommand("formatBlock",!1,"h".concat(e),{skip_undo:!0})}),!0))}(a);u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(bq\.)$/,(function(){c.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})}),!0));var m=S(/^\u200b?(\-\-\-\-)$/,(function(){c.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})}),!0);u.registerHandler(" ".charCodeAt(0),m),u.registerHandler(13,m),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(\#)$/,(function(){c.execCommand("InsertOrderedList")}),!0)),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(\*)$/,(function(){c.execCommand("InsertUnorderedList")}),!0)),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(1\.)$/,(function(){c.execCommand("InsertOrderedList")}),!0)),u.registerHandler(" ".charCodeAt(0),S(/^\u200b?(\-)$/,(function(){var e=c.dom;c.execCommand("InsertUnorderedList");var t=e.getParent(c.selection.getNode(),"OL,UL");t&&(e.setStyles(t,{listStyleType:"square"}),t.removeAttribute("data-mce-style"))}),!0)),d("confluence.editor.registerHandlers",{handlerManager:u,createHandler:S,ed:c});var p=S(/((\<\-\-?\>)([^\s-]*))$/,(function(e){c.execCommand("mceInsertContent",!1,"↔"+e[3],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),p),u.registerHandler(13,p);var g=S(/((\-\-?\>)([^\s-]*))$/,(function(e){c.execCommand("mceInsertContent",!1,"→"+e[3],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),g),u.registerHandler(13,g);var h=S(/((\<\-\-?)([^\s-]*))$/,(function(e){c.execCommand("mceInsertContent",!1,"←"+e[3],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),h),u.registerHandler(13,h),u.registerHandler(" ".charCodeAt(0),S(/[^-]*[\s](\-\-\-?)$/,(function(e){var t=2===e[1].length?"–":"—";c.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1));var v=S(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,(function(e){var t=2===e[3].length?"–":"—";c.execCommand("mceInsertContent",!1,e[2]+t+e[4],{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),v),u.registerHandler(13,v),u.registerHandler(13,S(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n="",r=!0,o=l()(e[1].slice(2,-2).split("||")).map((function(e){return e=l.a.trim(this),r=r&&""===e,e}));r&&(o[0]=ge("editor.autoformat.sampletext.firstcell"));for(var i=0,a=o.length;i<a;i++)t+='<th class="confluenceTh">'.concat(o[i],"</th>"),n+='<td class="confluenceTd">'.concat(me().ZERO_WIDTH_WHITESPACE,"</td>");t+="</tr><tr>".concat(n,"</tr></table>"),c.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),c.selection.select(l()(c.selection.getRng().commonAncestorContainer).parents("table").find(r?"th":"td")[0].childNodes[0]),l()(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0)),u.registerHandler(13,S(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n=!0,r=l()(e[1].slice(1,-1).split("|")).map((function(e){return e=l.a.trim(this),n=n&&""==e,e}));n&&(r[0]=ge("editor.autoformat.sampletext.firstcell"));for(var o=0,i=r.length;o<i;o++)t+='<td class="confluenceTd">'.concat(r[o],"</td>");t+="</tr></table>",c.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),n&&c.selection.select(l()(c.selection.getRng().commonAncestorContainer).parents("table").find("td")[0].childNodes[0]),l()(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0));var b=S(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,(function(e){var t=e[3]?e[1]:"http://".concat(e[1]),n=c.dom.create("a",{href:t});n.appendChild(r.document.createTextNode(e[1])),c.execCommand("mceInsertContent",!1,x(n),{skip_undo:!0}),c.getDoc().execCommand("unlink",!1,{})}),!1,"a");u.registerHandler(" ".charCodeAt(0),b),u.registerHandler(13,b);var y=S(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,(function(e){var t=c.dom.create("a",{href:"mailto:".concat(e[1])});t.appendChild(r.document.createTextNode(e[1])),c.execCommand("mceInsertContent",!1,x(t),{skip_undo:!0}),c.getDoc().execCommand("unlink",!1,{})}),!1,"a");u.registerHandler(" ".charCodeAt(0),y),u.registerHandler(13,y);var w=function(e,t){var n=S(e,(function(){c.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1);u.registerHandler(" ".charCodeAt(0),n),u.registerHandler(13,n)};w(/(?:\b|^)(jira)$/,"Jira"),w(/(?:\b|^)(bitbucket)$/,"Bitbucket"),w(/(?:\b|^)(atlassian)$/,"Atlassian"),w(/(?:\b|^)(hipchat)$/,"Hipchat"),w(/(?:\b|^)(statuspage)$/,"Statuspage"),w(/(?:\b|^)(sourcetree)$/,"Sourcetree"),w(/(?:\b|^)(trello)$/,"Trello");var C={"]":e.regularExpressions._REGEXES.WIKI_LINK,"}":e.regularExpressions._REGEXES.WIKI_MACRO,"!":e.regularExpressions._REGEXES.WIKI_EMBED};l.a.each(C,(function(e,t){u.registerHandler(e.charCodeAt(0),S(t,(function(t){var n=t[1]+e,o={type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(U.get("context-path"),"/rest/tinymce/1/wikixhtmlconverter"),data:JSON.stringify({wiki:n,entityId:U.get("content-id"),spaceKey:U.get("space-key"),contextType:U.get("content-type"),suppressFirstParagraph:!0}),dataType:"text",timeout:5e3};"}"==e?r.tinymce.confluence.MacroUtils.insertMacro(o):"!"==e?l.a.ajax(o).done((function(e){!n===e?r.tinymce.confluence.ImageUtils.insertImagePlaceholder(e):c.execCommand("mceInsertContent",!1,e,{skip_undo:!0})})):l.a.ajax(o).done((function(e){c.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}))}),!0))})),u.registerHandler("`".charCodeAt(0),S(/(``)$/,(function(e){var t={contentId:U.get("content-id"),macro:{name:"code",body:""}};r.tinymce.confluence.MacroUtils.insertMacro(t)}),!0)),c.on("KeyPress",(function(e){return u.executeHandlers(T(e),c,e,t)})),c.on("KeyDown",(function(e){if(13===T(e))return u.executeHandlers(13,c,e,t)}),!0);return{getHandlerCount:function(){return Object.keys(u.handlers).length}}}function x(e){return l()("<div>").append(e.cloneNode(!0)).html()}function k(e){var t,n;if(!e||!e.collapsed)throw new Error("range is null or not collapsed");if(t=e.startContainer,n=e.startOffset,1===t.nodeType&&n>0){if(3!==(t=t.childNodes[e.startOffset-1]).nodeType)return"";n=t.nodeValue.length}else if(3!==t.nodeType)return"";for(var r=t.nodeValue.substring(0,n),o=t.previousSibling;o&&3===o.nodeType;o=o.previousSibling)r=o.nodeValue+r;return r}function S(e,t,n,o){return{handles:function(t){var n=t.selection.getRng();if(!n||!n.collapsed)return!1;var r=n.commonAncestorContainer||{};return!l()(r).closest("pre,.text-placeholder").length&&((!o||!l()(r).closest(o).length)&&e.test(k(n)))},execute:function(o,a,c){var u,s=1,f=T(a);if(32===f?o.execCommand("mceInsertContent",!1,"&nbsp;"):o.execCommand("mceInsertContent",!1,String.fromCharCode(f)),o.undoManager.transact((function(){var n=o.selection.getRng();if(n){"|"==(u=k(n))[u.length-1]&&(u+=" ",s=0);var r=e.exec(u.substring(0,u.length-1)),a=function(e,t,n){var r,o;if(t){3!==t.nodeType&&(n=(t=t.childNodes[n-1]).length);for(var i=t,a=n;i&&3===i.nodeType;i=i.previousSibling){if(-1==a&&(a=i.nodeValue.length),a>e)return{container:i,offset:a-e};if(a==e){for(o=0,r=i.parentNode;i=i.previousSibling;)o++;return{container:r,offset:o}}e-=a,a=-1}return null}}(r[1].length+s,n.commonAncestorContainer,n.startOffset);n.setStart(a.container,a.offset);var c=l()(n.commonAncestorContainer);o.selection.setRng(n),c.closest(".wysiwyg-macro-body").length&&n.toString()==c.text()?(c[0].innerHTML="<br>",o.selection.select(c[0].childNodes[0]),o.selection.collapse(!0)):o.execCommand("delete",!1,{},{skip_undo:!0}),t(r,o.selection.getRng()),i=o.selection.getRng()}})),n)return c.preventDefault(),c.stopPropagation(),r.tinymce.dom.Event.cancel(a),i&&me().showElement(i.startContainer),!1}}}function T(e){return e.which}function E(){this.handlers={}}function _(e,t,n,r,o){var i=e.charCodeAt(0),a="".concat(me().getResourceUrlPrefix(),"/images/icons/emoticons/").concat(o),l=S(t,(function(){var e=c.dom.createHTML("img",{src:a,alt:c.translate("tinymce.".concat(r)),title:c.translate("tinymce.".concat(r)),border:0,class:"emoticon emoticon-".concat(n),"data-emoticon-name":n});c.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}),!0);this.imagePath=a,u.registerHandler(i,l)}function A(e,t){var n=c.formatter.get(e)[0],o=c.dom.create(n.inline,{style:n.styles,class:n.classes});o.appendChild(r.document.createTextNode(t)),c.execCommand("mceInsertContent",!1,"".concat(x(o),"&nbsp;"),{skip_undo:!0})}},zt=(Ut.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}},0),Wt={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:o.a.document,objHead:"head",objWindow:o.a,scrollableArea:o.a,cacheHeaderHeight:!1};function qt(e,t){var n=this;n.$el=l()(e),n.el=e,n.id=zt++,n.$el.bind("destroyed",l.a.proxy(n.teardown,n)),n.$clonedHeader=null,n.$originalHeader=null,n.cachedHeaderHeight=null,n.isSticky=!1,n.hasBeenSticky=!1,n.leftOffset=null,n.topOffset=null,n.init=function(){n.setOptions(t),n.$el.each((function(){var e=l()(this);e.css("padding",0),n.$originalHeader=l()("thead:first",this),n.$clonedHeader=n.$originalHeader.clone(),e.trigger("clonedHeader.".concat("stickyTableHeaders"),[n.$clonedHeader]),n.$clonedHeader.addClass("tableFloatingHeader"),n.$clonedHeader.css("display","none"),n.$originalHeader.addClass("tableFloatingHeaderOriginal"),n.$originalHeader.after(n.$clonedHeader),n.$printStyle=l()('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),n.$head.append(n.$printStyle)})),n.updateWidth(),n.toggleHeaders(),n.bind()},n.destroy=function(){n.$el.unbind("destroyed",n.teardown),n.teardown()},n.teardown=function(){n.isSticky&&n.$originalHeader.css("position","static"),l.a.removeData(n.el,"plugin_".concat("stickyTableHeaders")),n.unbind(),n.$clonedHeader.remove(),n.$originalHeader.removeClass("tableFloatingHeaderOriginal"),n.$originalHeader.css("visibility","visible"),n.$printStyle.remove(),n.el=null,n.$el=null},n.bind=function(){n.$scrollableArea.on("scroll.".concat("stickyTableHeaders"),n.toggleHeaders),n.isWindowScrolling||(n.$window.on("scroll.".concat("stickyTableHeaders").concat(n.id),n.setPositionValues),n.$window.on("resize.".concat("stickyTableHeaders").concat(n.id),n.toggleHeaders)),n.$scrollableArea.on("resize.".concat("stickyTableHeaders"),n.toggleHeaders),n.$scrollableArea.on("resize.".concat("stickyTableHeaders"),n.updateWidth)},n.unbind=function(){n.$scrollableArea.off(".".concat("stickyTableHeaders"),n.toggleHeaders),n.isWindowScrolling||(n.$window.off(".".concat("stickyTableHeaders").concat(n.id),n.setPositionValues),n.$window.off(".".concat("stickyTableHeaders").concat(n.id),n.toggleHeaders)),n.$scrollableArea.off(".".concat("stickyTableHeaders"),n.updateWidth)},n.debounce=function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,o)}),t)}},n.toggleHeaders=n.debounce((function(){n.$el&&n.$el.each((function(){var e,t=l()(this),r=n.isWindowScrolling?isNaN(n.options.fixedOffset)?n.options.fixedOffset.outerHeight():n.options.fixedOffset:n.$scrollableArea.offset().top+(isNaN(n.options.fixedOffset)?0:n.options.fixedOffset),o=t.offset(),i=n.$scrollableArea.scrollTop()+r,a=n.$scrollableArea.scrollLeft(),c=n.options.cacheHeaderHeight?n.cachedHeaderHeight:n.$clonedHeader.height(),u=n.isWindowScrolling?i>o.top:r>o.top,s=(n.isWindowScrolling?i:0)<o.top+t.height()-c-(n.isWindowScrolling?0:r);u&&s?(e=o.left-a+n.options.leftOffset,n.$originalHeader.css({position:"fixed","margin-top":n.options.marginTop,left:e,"z-index":3}),n.leftOffset=e,n.topOffset=r,n.$clonedHeader.css("display",""),n.isSticky||(n.isSticky=!0,n.updateWidth(),t.trigger("enabledStickiness.".concat("stickyTableHeaders"))),n.setPositionValues()):n.isSticky&&(n.$originalHeader.css("position","static"),n.$clonedHeader.css("display","none"),n.isSticky=!1,n.resetWidth(l()("td,th",n.$clonedHeader),l()("td,th",n.$originalHeader)),t.trigger("disabledStickiness.".concat("stickyTableHeaders")))}))}),0),n.setPositionValues=n.debounce((function(){var e=n.$window.scrollTop(),t=n.$window.scrollLeft();!n.isSticky||e<0||e+n.$window.height()>n.$document.height()||t<0||t+n.$window.width()>n.$document.width()||n.$originalHeader.css({top:n.topOffset-(n.isWindowScrolling?0:e),left:n.leftOffset-(n.isWindowScrolling?0:t)})}),0),n.updateWidth=n.debounce((function(){if(n.isSticky){n.$originalHeaderCells||(n.$originalHeaderCells=l()("th,td",n.$originalHeader)),n.$clonedHeaderCells||(n.$clonedHeaderCells=l()("th,td",n.$clonedHeader));var e=n.getWidth(n.$clonedHeaderCells);n.setWidth(e,n.$clonedHeaderCells,n.$originalHeaderCells),n.$originalHeader.css("width",n.$clonedHeader.width()),n.options.cacheHeaderHeight&&(n.cachedHeaderHeight=n.$clonedHeader.height())}}),0),n.getWidth=function(e){var t=[];return e.each((function(e){var r,i=l()(this);if("border-box"===i.css("box-sizing")){var a=i[0].getBoundingClientRect();r=a.width?a.width:a.right-a.left}else{if("collapse"===l()("th",n.$originalHeader).css("border-collapse"))if(o.a.getComputedStyle)r=parseFloat(o.a.getComputedStyle(this,null).width);else{var c=parseFloat(i.css("padding-left")),u=parseFloat(i.css("padding-right")),s=parseFloat(i.css("border-width"));r=i.outerWidth()-c-u-s}else r=i.width()}t[e]=r})),t},n.setWidth=function(e,t,n){t.each((function(t){var r=e[t];n.eq(t).css({"min-width":r,"max-width":r})}))},n.resetWidth=function(e,t){e.each((function(e){var n=l()(this);t.eq(e).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})}))},n.setOptions=function(e){n.options=l.a.extend({},Wt,e),n.$window=l()(n.options.objWindow),n.$head=l()(n.options.objHead),n.$document=l()(n.options.objDocument),n.$scrollableArea=l()(n.options.scrollableArea),n.isWindowScrolling=n.$scrollableArea[0]===n.$window[0]},n.updateOptions=function(e){n.setOptions(e),n.unbind(),n.bind(),n.updateWidth(),n.toggleHeaders()},n.init()}l.a.fn.stickyTableHeaders=function(e){return this.each((function(){var t=l.a.data(this,"plugin_".concat("stickyTableHeaders"));t?"string"==typeof e?t[e].apply(t):t.updateOptions(e):"destroy"!==e&&l.a.data(this,"plugin_".concat("stickyTableHeaders"),new qt(this,e))}))};var Vt=function(e){return!(e.parents("table").length>0)},$t=function(e){return!(e.closest(".columnLayout").length>0)},Kt=function(){return!l()("body").hasClass("theme-documentation")},Jt=function(e){var t=l()(e);return Kt()&&function(e){return!e.hasClass("stickyTableHeaders")}(t)&&$t(t)&&Vt(t)&&function(e){return e.find("> thead:first").is(":visible")}(t)&&function(e){return 1===e.find("thead").children().length}(t)&&function(e){return 1===e.find(".confluenceTh").parent().length}(t)&&function(e){return e.find(".confluenceTh").siblings().hasClass("confluenceTh")}(t)},Gt=function(e,t){var n=t||l()(window);e.closest(".table-wrap").scroll((function(){n.trigger("scroll.stickyTableHeaders")}))},Xt=function(e){l()(e).each((function(){var e=l()(this),t=e.find(".confluenceTh[rowspan]").length>0,n=e.find("> :first-child > :first-child .confluenceTh"),r=n.length&&n.closest("thead").length>0,o=n.length&&0===n.parent().index();if(Vt(e)&&$t(e)&&!r&&o&&!t){var i=l()("<thead />").append(n.parent());e.prepend(i)}}))},Yt=Kt,Qt=function(e,t){var n=e.filter((function(){return Jt(this)}));n.stickyTableHeaders(t).addClass("stickyTableHeaders"),s("sticky-table-headers.change.options",(function(e,t){n.stickyTableHeaders(t)})),Gt(n)},Zt=function(){var e=l()(".confluenceTable"),t=l()(window);if(Yt()){if(Xt(e),window.MutationObserver){var n=document.querySelector("#page");if(!n)return;var r=/sticky|tableFloating|confluenceTh/;new MutationObserver(l.a.debounce((function(e){for(var n,o=!1,i=0,a=e.length;i<a;i++)if(n=e[i].target.className,!r.test(n)){o=!0;break}o&&t.trigger("resize.stickyTableHeaders")}),0)).observe(n,{subtree:!0,attributes:!0,childList:!0})}Qt(e,{cacheHeaderHeight:!0})}},en=function(e,t){var n=r.tinymce.activeEditor;if(n){var o=function(e){var t={};return t.objWindow=l()(e.getWin()),t.scrollableArea=t.objWindow,t.objDocument=l()(e.getDoc()),t.objHead=t.objDocument.find("head"),t}(n),i=l.a.extend({},o,t),a=e.filter((function(){return Jt(this)}));a.stickyTableHeaders(i).addClass("stickyTableHeaders"),Gt(a,i.objWindow)}},tn=function(){var e=r.tinymce.activeEditor;if(e){var t=l()(e.getBody()).find(".confluenceTable");Xt(t),en(t)}};var nn={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.comment.lost")}e.on("Init",(function(){s("beforeunload",n)})),e.on("Remove",(function(){f("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var rn={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.template.lost")}e.on("Init",(function(){s("beforeunload",n)})),e.on("Remove",(function(){f("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var on=function(){return{init:function(e){var t,n=r.Confluence.Editor.Drafts,i=r.Confluence.Editor;function a(){var e,t,n;e=U.get("draft-id"),t=U.get("draft-share-id"),0!==parseInt(e)&&o.a.history&&o.a.history.replaceState&&o.a.history.replaceState(null,"","".concat(ye,"/pages/resumedraft.action?draftId=").concat(e,"&draftShareId=").concat(t,"&").concat(void 0===(n=o.a.location.search)?"":("?"===n.charAt(0)&&(n=n.substr(1)),n.split("&").filter((function(e){return 0===e.indexOf("username=")||0===e.indexOf("userFullName=")||0===e.indexOf("accessType=")||0===e.indexOf("grantAccess=")||0===e.indexOf("src.")})).join("&")))),i.UI.cancelButton.attr("data-tooltip",ge("editor.shared.draft.done.desc")),i.UI.cancelButton.on("click",(function(){d("analytics",{name:"confluence.editor.done.button.clicked"}),d("analytics",{name:"confluence.editor.close",data:{source:"closeButton",contentId:U.get("content-id"),currentVersion:U.get("page-version")||"null"}})}))}function c(){if(!U.get("has-collaborated")&&r.AJS.Rte.Content.editorHasContentChanged()){U.set("has-collaborated",!0);var e=U.get("remote-user-key"),t=U.get("content-id");l.a.ajax({type:"PUT",url:"".concat(ye,"/rest/experimental/relation/user/").concat(e,"/collaborator/toContent/").concat(t,"?targetStatus=draft"),error:function(){U.set("has-collaborated",!1)}}),l.a.ajax({type:"DELETE",url:"".concat(ye,"/rest/experimental/relation/touched/from/user/current/to/content/").concat(t,"?targetStatus=current")}),l.a.ajax({type:"PUT",url:"".concat(ye,"/rest/experimental/relation/user/").concat(e,"/touched/toContent/").concat(t,"?targetStatus=draft"),error:function(){U.set("has-collaborated",!1)}})}}var u=function(e){return l()("#draft-status").show(),n.bindUnloadMessage(),i.UI.cancelButton.click((function(){U.getBoolean("shared-drafts")||n.save({skipErrorHandler:!0})})),U.getBoolean("shared-drafts")&&a(),o.a.setInterval(n.save,+U.get("draft-save-interval")||3e4)};e.on("Init",(function(){s("editor.local.change",c)})),e.on("Remove",(function(){f("editor.local.change",c)})),s("rte-ready",(function(){t=u()})),s("rte-destroyed",(function(){clearInterval(t)}))},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};var an={init:function(e){e.on("Init",(function(){e.addCommand("mceConfMacroBrowser",r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)}))},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},cn={init:function(e){e.on("init",(function(){if(U.get("use-watch")){var e={userWatchingOwnContent:U.get("user-watching-own-content")};l()("#rte-savebar-tinymce-plugin-point").append((t=function(e){return ge(e)},'\n    <ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment">\n        <li class="toolbar-item">\n            <input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" '.concat(e.userWatchingOwnContent?'checked="checked"':"",'/>\n            <label for="watchPage">').concat(t("comment.notification.enable"),"</label>\n        </li>\n    </ul>\n")))}var t}))},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},un={init:function(e){var t=function(e){l()(".tablesorter",e.node).each((function(e,t){var n,r,o=l()(t).find("thead");1===o.length&&"THEAD"===(o=o[0]).nodeName&&1===o.childNodes.length&&(r=o.removeChild(o.childNodes[0]),n=l()(t).find("tbody")[0],t.removeChild(o),n.insertBefore(r,n.childNodes[0]))}))};e.on("PastePostProcess",t),e.on("remove",(function(){e.off("PastePostProcess",t)}))},getInfo:function(){return{longname:"ConfluenceSortableTablesPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}},ln={init:function(e){e.on("Init",(function(){e.getBody().classList.add("resizable")}));var t=0;if(!e.getParam("fullscreen_is_enabled")){var n=parseInt(e.getParam("autoresize_min_height","".concat(e.getElement().offsetHeight))),o=parseInt(e.getParam("autoresize_max_height","0"));e.on("Change SetContent Paste KeyUp Init",i),e.addCommand("mceAutoResize",i)}function i(a){var c=e.getDoc(),u=c.body,s=c.documentElement,f=r.tinymce.DOM,d=n,m=a===Object(a)&&a.forceExec||!1,p=l()(c).height();if(p>n&&(d=p),o&&p>o?(d=o,u.style.overflowY="auto",s.style.overflowY="auto"):(u.style.overflowY="hidden",s.style.overflowY="hidden",u.scrollTop=0),m||d!==t){var g=d-t;f.setStyle(document.querySelectorAll("div.tox-tinymce")[0],"height","".concat(d,"px")),f.setStyle(f.get("".concat(e.id,"_ifr")),"height","".concat(d,"px")),t=d,r.tinymce.Env.webkit&&g<0&&i()}return!0}},getInfo:function(){return{longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},sn=function(){function e(e){return e.nodeValue.toLowerCase()}return{search:function(t,n,r,o,i){var a=t.getSel(),c=function e(t){var n=[];if(t.nodeType===Node.TEXT_NODE)n.push(t);else for(var r=t.childNodes,o=0,i=r.length;o<i;++o)n.push.apply(n,e(r[o]));return n}(o);n=n.replace(/\s/g,"").toLowerCase();var u=c.map(e).join("");r=function(e,t,n){var r=e.getRng();if(r&&r.endContainer.nodeValue){var o=n.indexOf(r.endContainer.nodeValue.toLowerCase(),t)+r.endOffset;t=t!==o&&-1!==t?o:t}return t}(t,r,u);var l,s,f,d,m,p=(l=u,s=n,f=r,(m=(d=i)?l.lastIndexOf(s,f-1):l.indexOf(s,f))<0&&!d?m=l.indexOf(s):0===m&&0===f&&d&&(m=l.lastIndexOf(s)),m);if(p<0)return[!1,p];var g=function(e,t,n){for(var r,o,i,a,c=0,u=0;u<t.length;u++){if(t[u].nodeType===Node.TEXT_NODE){var l=e+n.length;!o&&t[u].length+c>=l&&(o=t[u],a=l-c),!r&&t[u].length+c>e&&(r=t[u],i=e-c),c+=t[u].length}if(r&&o)return{startNode:r,startIndex:i,endNode:o,endIndex:a}}}(p,c,n),h=document.createRange();return h.setStart(g.startNode,g.startIndex),h.setEnd(g.endNode,g.endIndex),a&&a.removeAllRanges(),a&&a.addRange(h),h.startContainer.parentNode&&h.startContainer.parentNode.scrollIntoView(),[!0,p]}}},fn=function(){var e=sn(),t=r.tinymce.Env.browser.isEdge,n=function e(t){var n=t,r=null,o=null,i=null,a=null,c=null,u={initialised:!1,find:function(e,t,n){var o=r.getFindInput().val(),a=i.findText(o,!0,e);a&&t?t():!a&&n&&n()},replace:function(e,t){var n=r.getFindInput(),o=r.getReplaceInput(),a="";o&&(a=o.val());var c=i.replaceText(n.val(),a,!0);c&&e?e():!c&&t&&t()},replaceAll:function(e,t){var n=r.getFindInput(),o=r.getReplaceInput(),a="";o&&(a=o.val());var c=i.replaceAll(n.val(),a);c&&e?e():!c&&t&&t()},focus:function(){r.focusFindTextBox()},isVisible:function(){return null!=r},init:function(){r=e.UI(n,a,c),(o=new e.MarkManager).addListener(r),i=null,i=new e.impl(r,o),r.getFindInput().focus()},onVisible:function(e){if(null!=e&&e.length>0){var t=r.getFindInput(),n=t.val();t.val(n+e)}r.onVisible()},onHide:function(){a=r.getFindInput().val(),c=r.getReplaceInput().val(),i.destroy(),i=null,r.destroy(),r=null,o.destroy(),o=null},_clearSavedValues:function(){a=null,c=null}};return u};return n.utils={moveCursorToEnd:function(e){if(r.tinymce.Env.gecko){var t=l()(e).val().length;e.setSelectionRange(t,t)}},createTextRange:function(e,t){return e.selection?e.selection.createRange():t.getBody().createTextRange()}},n.impl=function(n,o){var i=new r.tinymce.html.Writer,a=o,c=-1,u=function n(o,i,u){if(!o)return!1;var l=r.tinymce.activeEditor,s=l.selection,f=l.getWin();function d(){return l.undoManager.ignore((function(){a.markCurrentlySelectedRange()})),!0}function m(){return l.undoManager.ignore((function(){a.removeCurrentMark(!0),r.tinymce.activeEditor.selection.isCollapsed()||r.tinymce.activeEditor.selection.collapse()})),!1}if(a.isCursorAtCurrentMark()&&l.undoManager.ignore((function(){s=a.selectCurrentMark()})),s.isCollapsed()||s.collapse(u),r.tinymce.Env.gecko)return f.find(o,!1,u)?d():i?(s.select(l.getBody(),!1),s.collapse(!u),n(o,!1,u)):m();if(!t())return f.find(o,!1,u,!0,!1,!1,!1)?d():m();var p=e.search(s,o,c,l.getBody(),u);return c=p[1],p[0]?d():void 0},l=function(e){var t=r.tinymce.activeEditor;i.text(e,!1),t.selection.setContent(i.getContent(),{format:"raw"}),i.reset(),t.selection.collapse(!0)},s={};return s.findText=u,s.replaceText=function(e,t,n){var o=r.tinymce.activeEditor;return a.hasCurrentMark()?(o.undoManager.transact((function(){var e=a.replaceCurrentMark(t);e&&o.selection.select(e)})),u(e,n)):u(e,n)},s.replaceAll=function(n,o){var i=r.tinymce.activeEditor,c=0;return i.undoManager.transact((function(){var u=i.selection,s=i.getWin();if(a.removeCurrentMark(!1),i.execCommand("selectAll"),i.selection.collapse(!0),t())for(var f=-1;;){var d=e.search(u,n,f,i.getBody(),!1);if(!d[0])break;f=d[1],l(o),c++}else for(;s.find(n,!1,!1,!1,!1,!1,!1);)l(o),c++;if(0===c)r.Confluence.EditorNotification.notify("info",i.translate("searchreplace_dlg.notfound"));else if(1===c)r.Confluence.EditorNotification.notify("success",i.translate("searchreplace_dlg.allreplacedsingular"));else if(c>1){var m=i.translate("searchreplace_dlg.allreplacedplural");r.Confluence.EditorNotification.notify("success",m.replace("{0}",c))}})),c},s.destroy=function(){a=null,i=null},s},n.UI=function(e,t,o){var i=null,a=n.utils.moveCursorToEnd;r.tinymce.activeEditor&&r.tinymce.activeEditor.plugins&&r.tinymce.activeEditor.plugins.customtoolbar&&(i=r.tinymce.activeEditor.plugins.customtoolbar.getToolbarRow(e));var c=function(){return l()(".toolbar-find-input",i)},u=function(){return l()(".toolbar-replace-input",i)},s=function(e){if("input"===e.type||"propertychange"===e.type){var t=c(),n="string"==typeof t.val()&&t.val().length>0;d(n),m(n)}},f=function(){var e=c();h(e&&e.val())},d=function(e){e?(r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):(r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},m=function(e){var t=c();p().toggleClass("default-action",e&&t.val().length>0)},p=function(){return l()(".search-toolbar-find-next-button",i).closest(".aui-button")},g=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replace-button"):t.disableToolbarButton("search-toolbar-replace-button")},h=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replaceall-button"):t.disableToolbarButton("search-toolbar-replaceall-button")},v={};return v.getFindInput=c,v.getReplaceInput=u,v.focusFindTextBox=function(){top.focus(),c().focus()},v.onVisible=function(){var e=c();e.focus(),e.val().length>0&&(a(e[0]),d(!0),h(!0))},v.destroy=function(){},v.marked=function(){g(!0)},v.markRemoved=function(){g(!1)},function(e,t){var n=c(),r=!1;(e&&e.length&&(n.val(e),r=!0),t&&t.length)&&u().val(t);!function(){function e(e,t){e&&e.bind("input",t)}var t=c();e(t,s),e(t,f),l()(i).focusin((function(){m(!0)})).focusout((function(){m(!1)})),t.focus((function(){m(!0)}))}(),d(r),h(r),g(!1)}(t,o),v},n.MarkManager=function(){var e=null,t=new r.tinymce.html.Writer,n=null,o=[],i=function(){u()},a=function(){if(!e)return null;var t=r.tinymce.activeEditor;return t.selection.select(e[0]),t.selection},c=function(t){g(),(s(e,t)||n&&r.tinymce.activeEditor.selection.getRng().toString()==n)&&(e=null,n=null,l.a.each(o,(function(e,t){t.markRemoved()})))},u=function(){g(),l()("mark",r.tinymce.activeEditor.getDoc()).each((function(e,t){s(l()(t),!1)})),e=null,n=null,l.a.each(o,(function(e,t){t.markRemoved()}))},s=function(e,t){var n=r.tinymce.activeEditor.selection.getRng();if(!e)return!1;var o=function(e,t){if(e.intersectsNode)return e.intersectsNode(t);var n=r.tinymce.activeEditor.getDoc().createRange();return n.selectNodeContents(t),!(e.compareBoundaryPoints(Range.START_TO_END,n)<=0||e.compareBoundaryPoints(Range.END_TO_START,n)>=0)}(n,e[0]),i=null,a=null;if(e.contents().each((function(t,n){e.before(n),i||(i=n),a=n})),o||t){var c=r.tinymce.activeEditor.selection.getRng();c.setStartBefore(i),c.setEndAfter(a),t||c.collapse(!1),r.tinymce.activeEditor.selection.setRng(c)}return e.remove(),!0},f=function(){return!!e||(n?r.tinymce.activeEditor.selection.getRng().toString()==n:void 0)},d=function(){u()},m=function(){g(),l.a.each(o,(function(e,t){t.markRemoved()}))},p=function(e){var t=r.tinymce.activeEditor;t.on("Change",i),t.on("BeforeSetContent",i),e&&(t.on("Click",m),t.on("DblClick",m))},g=function(){var e=r.tinymce.activeEditor;e.off("Change",i),e.off("BeforeSetContent",i),e.off("Click",m),e.off("DblClick",m)},h={markCurrentlySelectedRange:function(){var t=r.tinymce.activeEditor;if(e){var i=t.selection.getBookmark();c(!1),t.selection.moveToBookmark(i)}n=null;var u=t.selection.getRng();if(e=l()('<mark data-searching class="find-current"></mark>',t.getDoc()),u)try{u.surroundContents(e[0]),p(!1)}catch(t){1==t.code&&(n=u.toString(),e=null,p(!0))}if(l.a.each(o,(function(e,t){t.marked()})),!n){var s=a();s&&s.collapse()}}};return h.removeCurrentMark=c,h.removeAllMarks=u,h.selectCurrentMark=a,h.isCursorAtCurrentMark=function(){if(!e)return!1;var t=r.tinymce.activeEditor.selection;t.isCollapsed()||t.collapse();var n=t.getRng();if(n){if(3===n.startContainer.nodeType)return n.startContainer.parentNode&&n.startContainer.parentNode.normalize(),n.startContainer.nextSibling===e[0]||n.startContainer.previousSibling===e[0];if(1===n.startContainer.nodeType){var o=n.startContainer.childNodes,i=n.startOffset;return i>0&&o[i-1]===e[0]||i+1<o.length&&o[i+1]===e[0]}}},h.hasCurrentMark=f,h.replaceCurrentMark=function(n){if(function(n){if(e||!f())return!1;var o=r.tinymce.activeEditor;return o.undoManager.transact((function(){t.text(n,!1),o.selection.setContent(t.getContent(),{format:"raw"}),t.reset()})),o.undoManager.ignore((function(){c(!1)})),!0}(n))return null;if(!e)return null;var o=r.tinymce.activeEditor,i=[];o.undoManager.ignore((function(){e.contents().each((function(e,t){i.push(t)})),c(!1)}));var a=void 0;return o.undoManager.transact((function(){a=l()(i[0]).before(o.getDoc().createTextNode(n))[0].previousSibling;for(var e=i.length-1;e>=0;e--)l()(i[e]).remove()})),a},h.addListener=function(e){o.push(e)},h.destroy=function(){c(!0),r.tinymce.activeEditor.off("BeforeGetContent",d)},r.tinymce.activeEditor.on("BeforeGetContent",d),h},n},dn=function(){ee(r.document,"initContextToolbars.Toolbar",(function(e,t){var n;r.Confluence.Editor.searchToolbar=(n=r.Confluence.Editor,{initContextToolbars:function(e,t){var o=function(e){if(r.tinymce.Env.gecko){var t=l()(e).val().length;e.setSelectionRange(t,t)}},i=function(e){top.focus(),r.tinymce.activeEditor.plugins.customtoolbar.focusToolbarButton(e)},a=function(){top.focus();var e=l()("#search-toolbar-find-text");e.focus(),o(e[0])},c=function(){top.focus();var e=l()("#search-toolbar-replace-text");e.focus(),o(e[0])},u=function(){if(r.tinymce.Env.gecko){var e=r.tinymce.activeEditor;e.focus(),e.selection.select(e.getBody()),e.selection.collapse(!1),e.focus()}},s=new n.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:t.translate("searchreplace_dlg.findlabel"),name:"find",keydown:function(e){if(!r.tinymce.isIE8&&(e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t={backwards:!1,onFound:a,onNotFound:a};r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,t,{skip_undo:!0})}))}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-find-input"}),f=new n.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:t.translate("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(e){if(!r.tinymce.isIE8&&(e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t=r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:c,onNotFound:a},{skip_undo:!0})}));g(c,a,t)}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-replace-input"}),d=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findprevious"),click:function(){var e={backwards:!0,onFound:function(){top.focus(),i("search-toolbar-find-previous-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-previous-button"}),m=new n.Toolbar.Components.TextButton({text:r.tinymce.Env.ie?t.translate("searchreplace_dlg.findlabel"):t.translate("searchreplace_dlg.findnext"),click:function(){var e={backwards:!1,onFound:function(){top.focus(),i("search-toolbar-find-next-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-next-button"}),p=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replace"),click:function(){g((function(){top.focus(),i("search-toolbar-replace-button")}),a)},textClass:"search-toolbar-replace-button"}),g=function(e,t,n){r.Confluence.Editor.searchManager&&(r.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?r.Confluence.Editor.searchManager.replace(e,t):n&&n())},h=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replaceall"),click:function(){var e={onReplaced:u,onNotReplaced:a};t.undoManager.transact((function(){t.execCommand("mceConfReplaceAll",!1,e)}))},textClass:"search-toolbar-replaceall-button"}),v=new n.Toolbar.Components.Button({text:t.translate("searchreplace_dlg.close"),iconClass:"icon aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){t.undoManager.ignore((function(){t.execCommand("mceConfSearchClose",!1,null)}))}});return{Buttons:[new n.Toolbar.Components.Group([v],{groupClass:"close"}),new n.Toolbar.Components.Group([s,f],{groupClass:"no-separator"}),new n.Toolbar.Components.Group(r.tinymce.Env.ie?[m]:[d,m]),new n.Toolbar.Components.Group([p,h])]}}}).initContextToolbars(e,t)}))};function mn(){var e=r.Confluence.Editor,t=null,n=!1,o=function(e){e.preventDefault(),e.stopPropagation()},i=function(e){o(e);var n=e.which;n||(n=e.charCode?e.charCode:e.keyCode),n<48||t.push(n)},a=function(e){var t=l()("#rte-button-searchreplace a");t.length&&(e?t.unbind("click",!1):t.bind("click",!1))},c=function(){if(!n){n=!0;var c=l()("#rte-button-searchreplace"),u=!c.hasClass("active"),s=l()("body"),f=!s.hasClass("no-tools")||s.hasClass("no-tools-toolbars-visible");u?(c.addClass("active"),e.searchManager||(e.searchManager=new e.SearchManager("searchreplace")),l()(r.document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:f,onVisible:function(){var c=function(){var e=r.tinymce.activeEditor;e.off("KeyDown",i),e.off("KeyPress",o),e.off("KeyUp",o);for(var n,a="",c=0;c<t.length;c++)a+=(n=t[c])>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):String.fromCharCode(n);return a.toLowerCase()}();e.searchManager.onVisible(c),a(!0),n=!1,e.searchManager.initialised=!0}}).trigger("enableContextToolbarRow.Toolbar"),function(){var e=r.tinymce.activeEditor;t=[],e.on("KeyDown",i),e.on("KeyPress",o),e.on("KeyUp",o)}(),e.searchManager.init(),a(!1)):(c.removeClass("active"),e.searchManager.onHide(),l()(r.document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:f,onHide:function(){l()(r.document).trigger("contextToolbarRowRemoved.Toolbar"),a(!0),n=!1,e.searchManager.initialised=!1}}),a(!1),r.tinymce.Env.gecko||frames.wysiwygTextarea_ifr.focus(),r.tinymce.activeEditor.focus())}};return{init:function(t){t.addCommand("mceSearchReplaceToolbar",(function(){return t.undoManager.ignore((function(){c()})),!1})),t.addCommand("mceConfSearch",(function(n,r){return!!e.searchManager&&((r=r||{}).backwards&&!t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button")?(e.searchManager.focus(),!1):r.backwards||t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button")?(e.searchManager.find(r.backwards,r.onFound,r.onNotFound),!1):(e.searchManager.focus(),!1))})),t.addCommand("mceConfReplaceAll",(function(n,r){return!!e.searchManager&&(r=r||{},!!t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&(e.searchManager.replaceAll(r.onReplaced,r.onNotReplaced),!1))})),t.addCommand("mceConfSearchClose",(function(){return!!e.searchManager&&(t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,null)})),!1)})),t.ui.registry.addButton("searchreplace",{text:"searchreplace.search_desc",onAction:function(){t.execCommand("mceSearchReplaceToolbar")}}),8!=r.tinymce.Env.ie&&t.shortcuts.add("meta+f","searchreplace.search_desc",(function(){e.searchManager&&e.searchManager.isVisible()?e.searchManager.focus():t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))}))},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}function pn(e){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var gn="object"===("undefined"==typeof window?"undefined":pn(window))?window.localStorage:{},hn=function(e,t){var n=U.get("remote-user")||"",r="".concat(e,".").concat(n,".").concat(t),o=!1,i=/\d+#/,a=function(e){if(!o)return null;var t,n=gn.getItem("".concat(r,".").concat(e));return n&&(t=i.exec(n))&&(n=n.replace(t[0],""),+new Date>Number(t[0].replace("#","")))?(gn.removeItem("".concat(r,".").concat(e)),null):n};try{o=Object.keys(gn).length}catch(e){console.log("Browser does not support localStorage, Confluence.storageManager will not work.")}return{getItem:a,getAllItems:function(){if(!o)return null;var e={};for(var t in gn)if(gn.hasOwnProperty(t)&&t.indexOf("".concat(r,"."))>-1){var n=t.split("".concat(r,"."))[1];e[n]=a(n)}return e},doesContain:function(e){return!!a(e)},getItemAsBoolean:function(e){var t=a(e);return"false"!==t&&("true"===t||!!t)},setItem:function(e,t,n){var i;o&&(t=((i=1e3*(n||0))?+new Date+i+"#":"")+t,gn.setItem("".concat(r,".").concat(e),t))},setItemQuietly:function(e,t,n){try{this.setItem(e,t,n)}catch(n){console.log("Unable to write to localStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}},removeItem:function(e){o&&gn.removeItem("".concat(r,".").concat(e))}}}("confluence","userSettings");function vn(e,t){return t?"".concat(e,".").concat(t.replace(/\./g,"-")):e}var bn,yn={get:function(e,t,n){var r=vn(e,t),o=hn.getItem(r);return null!==o?JSON.parse(o):void 0!==n?n:null},set:function(e,t,n,r){var o=vn(e,t);if(r===n)hn.removeItem(o);else{hn.setItem(o,JSON.stringify(r),2592e3)}}},wn={init:function(e){e.on("init",(function(){var e={contentId:U.get("content-id")},t=l()("#rte-savebar-tinymce-plugin-point");t.append('\n    <span class="minor-edit toolbar-item">\n        <input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" checked>\n        <label for="notifyWatchers">\n          <span>'.concat(function(e){return ge(e)}("editor.minor.edit"),"</span>\n        </label>\n    </span>\n"));var n=t[0].querySelector('input[id="notifyWatchers"]'),r=yn.get("notifyWatchers",e.contentId,!0);null!==r&&(n.checked=r),ee(n,"change",(function(){yn.set("notifyWatchers",e.contentId,!0,n.checked)}))}))},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function Cn(e,t){var n=l.a.parseHTML(e),r=[Node.ELEMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_FRAGMENT_NODE],o=!1;return n.forEach((function(e){(bn.dom.is(e,t)||r.includes(e.nodeType)&&e.querySelector(t))&&(o=!0)})),o}function xn(){d("analytics",{name:"confluence.table.image.insert",data:{pageId:U.get("page-id"),tableMode:Sn()}})}function kn(){return!!l()(bn.selection.getNode()).closest("table.confluenceTable").length}function Sn(){var e=l()(bn.selection.getNode()).closest("table.confluenceTable");return e.hasClass("fixed-table")?"fixed":e.hasClass("relative-table")?"relative":"fluid"}function Tn(){var e=l()(bn.getBody()).find("table.confluenceTable");d("analytics",{name:"confluence.table.quality.in.page",data:{pageId:U.get("page-id"),total:e.length,fixed:e.filter(".fixed-table").length,fluid:e.filter(":not(.fixed-table,.relative-table)").length,relative:e.filter(".relative-table").length,nested:e.find("table.confluenceTable").length}})}var En={init:function(e){function t(e,t){kn()&&function(e){var t,n;e&&e.name&&e.name.indexOf("confluence.editor.image.resize")>=0&&d("analytics",{name:"confluence.table.img.resize",data:{pageId:U.get("page-id"),tableMode:Sn(),isImgBiggerCell:(t=l()(bn.selection.getNode()),n=t.closest("th, td"),t.width()>n.width())}})}(t)}bn=e,e.on("ExecCommand",(function(e){switch(e.command){case"mceAutoWidth":case"mceRelativeWidth":case"mceFixedWidth":d("analytics",{name:"confluence.table.mode.to.".concat(Sn()),data:{pageId:U.get("page-id")}});break;case"mceTableCopyRow":d("analytics",{name:"confluence.table.row.copy",data:{pageId:U.get("page-id")}});break;case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":d("analytics",{name:"confluence.table.row.paste",data:{pageId:U.get("page-id")}});break;case"mceTableCopyCol":d("analytics",{name:"confluence.table.col.copy",data:{pageId:U.get("page-id")}});break;case"mceTablePasteColBefore":case"mceTablePasteColAfter":d("analytics",{name:"confluence.table.col.paste",data:{pageId:U.get("page-id")}});break;case"mceInsertContent":Cn(t=e.value,"img")&&kn()&&xn(),Cn(t,"table.confluenceTable")&&d("analytics",{name:"confluence.table.paste",data:{pageId:U.get("page-id")}});break;case"confTableSelectionToggleHighlight":d("analytics",{name:"confluence.editor.table.selection.toggle.highlight",data:{color:l()("#table-highlight-group").attr("data-highlight-colour")}})}var t})),e.on("Init",(function(){e.on("SetContent",(function(e){kn()&&e&&function(e){Cn(e.content,".confluence-embedded-image")&&xn()}(e)}))})),s("analyticsEvent",t),s("rte.safe-save.success",Tn),e.on("Remove",(function(){f("analyticsEvent",t),f("rte.safe-save.success",Tn)}))},getInfo:function(){return{longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function _n(e,t,n){n&&n.node&&l()(".inline-comment-marker",n.node).contents().unwrap()}var An={init:function(e){e.on("beforeExecCommand",(function(t){if("Indent"===t.command||"Outdent"===t.command){var n=e.selection.getNode(),r=n.nodeName.toLowerCase();if("li"!==r&&"body"!==r){var o=parseInt(e.dom.getStyle(n,"margin-left",!1)||0,10)+parseInt(e.dom.getStyle(n,"padding-left",!1)||0,10);if(0!==o){var i=e.settings.indentation,a=/[a-z%]+/i.exec(i);e.dom.setStyle(n,"padding-left",""),e.dom.setStyle(n,"margin-left",o+a[0])}}}}))},getInfo:function(){return{longname:"Confluence Indentation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Nn=function(e){if(!e)return null;var t=e.endOffset;return 3===e.endContainer.nodeType?e.endContainer:e.endContainer.childNodes[t-1]},Rn=function(e,t){if(t&&t.previousSibling&&t.previousSibling.hasChildNodes()){var n=t.previousSibling,r=n.childNodes.length,o=n.childNodes[r-1],i=o.length,a=e.dom.createRng();a.setStart(o,i),a.setEnd(o,i),e.selection.setRng(a)}},On={init:function(e){e.on("KeyDown",(function(t){r.tinymce.VK.modifierPressed(t)||32!==t.keyCode||function(e){var t=e.selection.getNode(),n=l()(t).closest("a"),r=e.selection.getRng();n.length&&r&&x.isCursorAtEnd(e,r)&&(r.setStartAfter(n[0]),r.setEndAfter(n[0]),e.selection.setRng(r),e.selection.collapse())}(e),r.tinymce.VK.modifierPressed(t)||8!==t.keyCode&&37!==t.keyCode||function(e){if(e.selection.isCollapsed()&&!function(e){return!!e.dom.getParents(e.selection.getNode(),"#autocomplete-search-text").length}(e)){var t=Nn(e.selection.getRng());t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&function(e,t){return 1==t.nodeValue.length&&1==e.selection.getNode().childNodes.length}(e,t)&&e.undoManager.ignore((function(){Rn(e,t),t.parentNode&&t.parentNode.removeChild(t)}))}}(e)}))}};function Dn(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bn=new(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Pn(this,"_namespace",void 0),Pn(this,"_sessionStorageSupported",void 0);var o=U.get("remote-user")||"";this._namespace="".concat(t,".").concat(o,".").concat(n),this._sessionStorageSupported=!!r.sessionStorage}var t,n,o;return t=e,(n=[{key:"getItem",value:function(e){return this._sessionStorageSupported?r.sessionStorage.getItem("".concat(this._namespace,".").concat(e)):null}},{key:"doesContain",value:function(e){return!!this.getItem(e)}},{key:"setItem",value:function(e,t){if(this._sessionStorageSupported)try{r.sessionStorage.setItem("".concat(this._namespace,".").concat(e),t)}catch(n){console.error("Unable to write to sessionStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}}},{key:"removeItem",value:function(e){this._sessionStorageSupported&&r.sessionStorage.removeItem("".concat(this._namespace,".").concat(e))}}])&&In(t.prototype,n),o&&In(t,o),e}())("atlassian","frontend"),Mn=function(e){var t=[];return Array.from(e).forEach((function(e,n){(function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect(),i=o.top,a=o.bottom,c=n.offsetHeight;return 0<=i&&i<c||0<=a&&a<=c||i<=0&&0<=a&&a>=c}})(e)&&t.push({targetElementIndex:n,visibleBlockEl:e})})),t},Ln=function(e){var t=Mn(e),n=null;return t.some((function(e){return!!function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect().top,i=n.offsetHeight;return 0<=o&&o<i}}(e.visibleBlockEl)&&(n=e,!0)})),!n&&t.length>0?t[0]:n||{targetElementIndex:-1,visibleBlockEl:null}};function Fn(e,t){if(!e||0===t)return null;var n={targetElementIndex:-1,offsetBetweenTargetAndCurrentScroll:0,columnLayoutPosition:{columnIndex:-1,rowIndex:-1}};if(function(e){if(!e)return!1;var t=e.children[0];return t&&t.classList.contains("contentLayout2")}(e)){var r=e.children[0].children,o=Ln(r),i=o.targetElementIndex,a=o.visibleBlockEl;if(a){var c=function(e){var t={targetElementIndexInColumn:-1,columnIndex:-1,visibleBlockEl:null};return Array.from(e).some((function(e,n){var r=Ln(e.children),o=r.visibleBlockEl,i=r.targetElementIndex;return!!o&&(t.columnIndex=n,t.targetElementIndexInColumn=i,t.visibleBlockEl=o,!0)})),t}(a.getElementsByClassName("innerCell")),u=c.columnIndex,l=c.targetElementIndexInColumn,s=c.visibleBlockEl;s&&(n.targetElementIndex=l,n.offsetBetweenTargetAndCurrentScroll=t-Dn(s),n.columnLayoutPosition={rowIndex:i,columnIndex:u})}}else{var f=Ln(e.children),d=f.targetElementIndex,m=f.visibleBlockEl;m&&(n.targetElementIndex=d,n.offsetBetweenTargetAndCurrentScroll=t-Dn(m),delete n.columnLayoutPosition)}return-1!==n.targetElementIndex?n:null}var jn={_saveScrollPosition:function(e){var t,n,i,a,c,u,l,s;e.getDoc()&&e.getWin()&&(t={contentId:Ae(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()},n=t.contentId,i=t.isInViewPage,a=t.docObject,c=void 0===a?r.document:a,u=t.winObject,l=void 0===u?o.a:u,(s=Fn(i?c.getElementById("main-content"):c.body,l.pageYOffset))&&(s.contentId=n,s.isInViewPage=i,Bn.setItem("editor-persit-scroll-position",JSON.stringify(s))))},_restoreScrollPositionIfNeeded:function(e){e.getDoc()&&e.getWin()&&function(e){var t=e.contentId,n=e.isInViewPage,i=e.docObject,a=void 0===i?r.document:i,c=e.winObject,u=void 0===c?o.a:c,l=Bn.getItem("editor-persit-scroll-position");try{l=JSON.parse(l)}catch(e){0}finally{Bn.removeItem("editor-persit-scroll-position")}if(l&&l.contentId===t&&l.isInViewPage!==n){var s;s=n?a.getElementById("main-content"):a.body;var f,d=l.columnLayoutPosition;if(d){var m=s.children[0].children[d.rowIndex].getElementsByClassName("innerCell")[d.columnIndex];f=m&&m.children[l.targetElementIndex]}else f=s.children[l.targetElementIndex];if(f){var p=Dn(f)+l.offsetBetweenTargetAndCurrentScroll;setTimeout((function(){return u.scrollTo(0,p)}),1)}}}({contentId:Ae(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},init:function(e){var t=U.get("content-type");"page"!==t&&"blogpost"!==t||(s("rte-collab-ready",(function(){jn._restoreScrollPositionIfNeeded(e)})),s("rte-ready",(function(){r.Confluence.Editor.UI.cancelButton.click((function(){return jn._saveScrollPosition(e)})),r.Confluence.Editor.UI.saveButton.click((function(){return jn._saveScrollPosition(e)}))})))},getInfo:function(){return{longname:"Persist scroll position for transition between view page and edit page",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Hn={init:function(e){e.on("init",(function(){e.getBody().classList.add("template-editor")}))}};function Un(e){return e.parentNode&&e.parentNode.childNodes||[]}function zn(e){var t=Un(e);return function(e){var t=!0,n=/TABLE|TH|TD/;return t=(t=(t=!n.test(e.nodeName))&&e.previousSibling?!n.test(e.previousSibling.nodeName):t)&&e.nextSibling?!n.test(e.nextSibling.nodeName):t}(e)&&(function(e){var t=function(e){return e&&e.innerHTML&&(e.innerHTML.replace(/\uFEFF|\u200B/g,"")||"&nbsp;")}(e);return/^&nbsp;$/.test(t)}(e)||t.length>1&&"BR"==t[0].nodeName)}function Wn(e,t){e.dom.remove(t)}var qn={init:function(e){var t=e.getParam("atl_macro_class","wysiwyg-macro"),n=function(e){return 3===e.nodeType},o=function(t,n){return e.dom.getParent(t,n)},i=function(e){return n(e)?e.length:e.childNodes.length},a=function(e){return o(e,"table."+t)},c=function(e){return null!==a(e)},u=function(e,t){return e.bottom<=t.top&&e.top<t.bottom},l=function(e,t){return e.top>=t.bottom&&e.bottom>t.top},s=function(e,t){var n=e.childNodes;if(0===n.length)return{node:e,offset:t};if(t<n.length)return{node:n[t],offset:0};var r=n[n.length-1];return"img"===e.nodeName.toLowerCase()?{node:r,offset:1}:{node:r,offset:i(r)}},f=function(t){if(function(e){return 1===e.nodeType}(t))return r.tinymce.toArray(t.getClientRects());if(n(t)){var o=e.dom.createRng();return o.selectNode(t),r.tinymce.toArray(o.getClientRects())}return[]},d=function(t,o){return function(t,r){var o=e.selection.getRng();if(o){var i=s(1===t?o.startContainer:o.endContainer,1===t?o.startOffset:o.endOffset),a=i.node;if(n(a)&&i.offset>0){var c=a.splitText(i.offset),u=r(1===t?a:c);return 0===c.length&&e.dom.remove(c),u}return r(a)}}(o,(function(e){return function(e,t,n,o){var i,a=new r.tinymce.dom.TreeWalker(e,t),c=1===n?a.prev:a.next,s=1===n?u:l,d=e,m=0,p=[];do{var g=f(d).filter((function(e){return 0!==e.height&&0!==e.width}));if(0!==g.length&&(1===n&&g.reverse(),g.forEach((function(e){if(0!==e.height&&0!==e.width){i&&s(e,i)&&m++;var t=p[m];p[m]=t?t.concat([e]):[e],i=e}})),o(p)))return p}while(d=c());return p}(e,t,o,(function(e){return e.length>1})).length<=1}))},m=function(t,n){var r=e.selection.getRng();if(r){var o=1===n?r.startContainer:r.endContainer,a=1===n?r.startOffset:r.endOffset;return(1===n&&a<=0||-1===n&&a>=i(o))&&function(e,t,n){for(var r,o=s(n?t.startContainer:t.endContainer,n?t.startOffset:t.endOffset),a={node:e,offset:n?0:i(e)};!r||a.node!==r.node;){if(o.node===a.node&&o.offset===a.offset)return!0;r=a,a=s(a.node,a.offset)}return!1}(t,r,1===n)}};e.on("init",(function(){e.on("keydown",(function(t){var n,o,u=e.selection.getRng(),l=function(e){return(e.keyCode===r.tinymce.util.VK.LEFT||e.keyCode===r.tinymce.util.VK.RIGHT)&&e.shiftKey}(t),f=function(e){return(e.keyCode===r.tinymce.util.VK.UP||e.keyCode===r.tinymce.util.VK.DOWN)&&e.shiftKey}(t);if((l||f)&&u&&function(e){return c(e.startContainer)&&c(e.endContainer)}(u)){var p=(n=u.startContainer,o=a(n),e.dom.select("th,td",o)[0]),g=t.keyCode===r.tinymce.util.VK.UP||t.keyCode===r.tinymce.util.VK.LEFT?1:-1,h=f&&d(p,g),v=l&&m(p,g);(h||v)&&(!function(t,n){var r=e.selection.getRng();if(r){var o=r.cloneRange(),a=s(t,n?0:i(t));n?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),e.selection.setRng(o,!n)}}(p,1===g),t.preventDefault(),t.stopImmediatePropagation())}if(t.keyCode===r.tinymce.util.VK.ENTER||t.keyCode===r.tinymce.util.VK.BACKSPACE||t.keyCode===r.tinymce.util.VK.DELETE){if(!u||u.collapsed)return;e.getDoc().querySelectorAll("".concat("td.wysiwyg-macro-body","[data-mce-selected]")).forEach((function(e){e.removeAttribute("data-mce-selected")}))}}),!0),e.on("mouseup",(function(t){if(3===t.detail){var n=e.selection.getRng();if(n){var r=o(n.startContainer,"td.wysiwyg-macro-body"),i=o(n.endContainer,"td.wysiwyg-macro-body");if(r===i)return;if(null!==r&&!r.contains(n.endContainer)&&r.lastChild){var a=e.dom.createRng();a.setStart(n.startContainer,n.startOffset),a.setEndAfter(r.lastChild),e.selection.setRng(a,!0)}if(null!==i&&!i.contains(n.startContainer)&&i.firstChild){var c=e.dom.createRng();c.setStartBefore(i.firstChild),c.setEnd(n.endContainer,n.endOffset),e.selection.setRng(c,!0)}}}}))}))},getInfo:function(){return{longname:"Macro Navigation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Vn={offset:function(e){var t=l()(e).offset(),n=r.tinymce.activeEditor.iframeElement,o=l()(n).offset(),i=n.contentWindow.document,a=l()(r.tinymce.activeEditor.getBody()),c=l.a.support.boxModel&&i.documentElement.scrollTop||a.scrollTop(),u=l.a.support.boxModel&&i.documentElement.scrollLeft||a.scrollLeft();return{top:t.top-c+o.top,left:t.left-u+o.left}},getSelectedText:function(){var e=r.tinymce.activeEditor.selection;return e.getRng().text||e.getSel()&&e.getSel().toString&&e.getSel().toString()||""},setHtml:function(e){e&&r.tinymce.activeEditor.setContent(e)},getHtml:function(){return"".concat(r.tinymce.activeEditor.getContent())},isEmpty:function(){var e=r.tinymce.activeEditor.getContent().replace("&nbsp;","").replace("<br />","");return"<p></p>"===e.trim()||0===e.length},editorHasContentChanged:function(){return r.tinymce.activeEditor.isDirty()},editorResetContentChanged:function(){r.tinymce.activeEditor.setDirty(!1)},getChildIndex:function(e,t){for(var n=e.childNodes,r=0,o=n.length;r<o;r++)if(n[r]==t)return r;return-1}},$n=function(){void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Content&&(r.AJS.Rte.Content=Vn)};function Kn(){r.tinymce.activeEditor.getBody().style.height="auto"}var Jn=function(){s("init.rte",(function(){var e;r.Confluence.EditorNotification={notify:function(t,n,r){var o=a("aui/flag");void 0!==e&&"true"!==e.getAttribute("aria-hidden")&&e.close(),void 0===r&&(r="error"===t?"manual":"auto"),e=o({type:t,body:n,close:r})}}}))},Gn=n("./node_modules/@atlassian/aui-template/src/template.js"),Xn=n.n(Gn);function Yn(){return{component:function(e){var t,n=function(e){0};return e=e||{},e=l.a.extend({},{keypressListener:function(r){if(27===r.keyCode)n(),l()(".aui-dropdown",t.popup.element).is(":visible")||("function"==typeof e.onCancel?e.onCancel():t.hide());else if(13===r.keyCode){if(n(),!l()(".aui-dropdown",t.popup.element).is(":visible"))"textarea"!=(r.target.nodeName&&r.target.nodeName.toLowerCase())&&"function"==typeof e.onSubmit&&setTimeout(e.onSubmit)}},width:865,height:530},e),t=new y.a.Dialog(e),r.document.addEventListener("hideLayer",(function(n,r,o){"popup"==r&&o==t&&"function"==typeof e.onCancel&&e.onCancel()})),t},initialiser:function(e){var t=this;s("show.dialog",(function(e,t){var n,r=U.get("page-id"),o=U.get("space-key"),i=U.get("editor-mode"),a=U.get("new-page");y.a.EventQueue=y.a.EventQueue||[],y.a.EventQueue.push({name:t.dialog.id,properties:(n={},r&&(n.pageid=r),o&&(n.spacekey=o),i&&(n.editormode=i),a&&(n.newpage=a),n)})})),r.document.addEventListener("showLayer",(function(t,n,o){r.Confluence.runBinderComponents(),"popup"==n&&o&&function(t){var n,o=e(t);if(!o.attr("data-lasttab-override")){o.attr("data-tab-default")&&(n=o.attr("data-tab-default"));var i=r.Confluence.storageManager(o.attr("id")),a=i.getItem("last-tab"),c=null!=a?a:n;c&&e(".page-menu-item:visible:eq(".concat(c,") button"),o).click(),o.attr("data-lasttab-bound")||(e(".page-menu-item",o).each((function(t,n){e(n).click((function(){i.setItem("last-tab",t)}))})),o.attr("data-lasttab-bound","true"))}}(o.element)})),y.a.Dialog.prototype.overrideLastTab=function(){e(t.popup.element).attr("data-lasttab-override","true")},y.a.Dialog.prototype.addHelpText=function(n,r){if(n){var o=n;r&&(o=Xn()(n).fill(r).toString());var i=t.page[t.curpage];i.buttonpanel||i.addButtonPanel();var a=e("<div class='dialog-tip'></div>").html(o);i.buttonpanel.append(a),e("a",a).click((function(){var e=window.open(t.href,"_blank");return e&&e.focus(),e&&e.opener&&(e.opener=null),!1}))}},y.a.Dialog.prototype.getTitle=function(){return e("#".concat(t.id,".dialog-components:visible h2")).text()},y.a.Dialog.prototype.isVisible=function(){return e("#".concat(t.id)).is(":visible")}}}}var Qn=function(){var e={Button:function(e){var t=e.text,n=e.tooltip,r=e.triggerText,o=e.iconClass,i=e.click,a=!!e.disabled,c=e.id;this.render=function(){var e=l()('<button type="button"></button>').addClass("aui-button aui-button-subtle").attr("data-tooltip",n||t);if(c&&e.attr("id",c),a&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||i()})),o){var u=l()("<span />");u.addClass("icon ".concat(o)),u.text(t),e.append(u)}if(r){var s=l()("<span />");s.addClass("trigger-text"),s.text(r),e.append(s)}return e[0]}},DropDownButton:function(e){var t,n=e.id,r=e.tooltip,o=e.text||"",i=e.iconClass,a=!!e.disabled,c=e.dropDownContent;this.render=function(){var e=l()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",r);e.attr("id",n);var u=l()("<div/>").addClass("aui-dd-parent"),s=l()("<a href='#'></a>");if(s.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button"),o&&s.append('<span class="dropdown-text">'.concat(o,"</span>")),a&&(e.addClass("disabled"),s.addClass("disabled")),i){var f=l()("<span />");f.addClass("icon ".concat(i)),f.text(o),s.append(f)}var d=l()("<span/>");return d.addClass("icon").addClass("icon-dropdown"),s.append(d),t=l()("<div/>").addClass("hidden").addClass("aui-dropdown"),c&&t.append(c),u.append(s),u.append(t),e.append(u),e[0]}},TextButton:function(e){var t=e.text,n=e.textClass,r=e.click,o=!!e.disabled,i=e.tooltip;this.render=function(){var e=l()('<button type="button"></button>').addClass("aui-button aui-button-subtle").addClass(n).text(t);return i&&e.attr("data-tooltip",i),o&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||r()})),e[0]}},TextBox:function(e){var t=e.id,n=e.text,r=e.name,o=e.keydown,i=e.cssClass;this.render=function(){var e=l()("<div></div>").addClass("toolbar-item");e.append(l()('<label for="'.concat(t,'">').concat(n,"</label>")));var a=l()('<input id="'.concat(t,'" type="text" name="').concat(r,'" class="').concat(i,' text" autocomplete="off">'));return a.keydown((function(e){o(e)})),e.append(a),e[0]}},Group:function(e,t){var n=e;this.render=function(){var e=l()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var r=0,o=n.length;r<o;r++)e.append(n[r].render());return e[0]}}};return e.SplitGroup=function(e,t){var n=e,r=t&&t.dropDownOptions||{};this.render=function(){var e=l()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var o=0,i=n.length;o<i;o++)e.append(n[o].render());return e.append(function(){var e=r.id,t=r.disabled,n=r.dropDownContent,o=r.title,i=r.alignment,a=l()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");e&&a.attr("id",e),o&&a.attr({"data-tooltip":o}),i&&a.data("dropdown-alignment",i);var c=l()("<div/>").addClass("aui-dd-parent"),u=l()("<a href='#'></a>");u.addClass("toolbar-trigger aui-dd-trigger aui-button"),t&&(a.addClass("disabled"),u.addClass("disabled"));var s=l()("<span/>");s.addClass("icon").addClass("icon-dropdown"),u.append(s);var f=l()("<div/>").addClass("hidden").addClass("aui-dropdown");return n&&f.append(n),c.append(u),c.append(f),a.append(c),a[0]}()),t&&t.postProcess&&t.postProcess(e),e[0]}},o.a.Confluence.Editor.Toolbar={},o.a.Confluence.Editor.Toolbar.Components=e,e},Zn=function(){var e,t,n,o,i,a,c,u,s,f,d,m,p,g,h,v,b,y,w={},C=!1;var x=function(){c.css({top:l()("#insert-table-dropdown").outerHeight(!0)}),x=function(){}};function k(){var t;c.hasClass("hidden")||(t=l()(r.tinymce.activeEditor.getDoc()),e.unbind(".atlassian-table-picker"),t.unbind(".atlassian-table-picker"),c.addClass("hidden"),n.addClass("hidden"),a.removeClass("active"))}function S(e,t){e==v&&t==b||(e=Math.max(1,Math.min(15,e)),t=Math.max(1,Math.min(20,t)),g=Math.max(4,e),h=Math.max(4,t),v=e,b=t,u.width(25*g+1),u.height(17*h+20),E(s,g,h),E(d,v,b),E(f,g,1),E(m,v,1),T(),p.text("".concat(v," x ").concat(b)))}function T(){f.toggleClass("hidden",!y),m.toggleClass("hidden",!y)}function E(e,t,n){e.width(25*t+1),e.height(17*n+1)}function _(t){var n=s.offset(),r=n.top-e.scrollTop(),o=n.left-e.scrollLeft(),i=r+s.outerHeight(!0)+0,a=i-17-0,c=o+s.outerWidth(!0)+0,u=c-25-0,l=t.clientY,f=t.clientX,d=g,m=h;f>c?d+=~~((f-c)/25+1):f<u&&(d+=~~((f-u)/25-1)),l>i?m+=~~((l-i)/17+1):l<a&&(m+=~~((l-a)/17-1)),S(d,m)}function A(e){e!=y&&(y=e,T())}function N(e){var n=function(e){var t=1+~~(~~(e.offsetX||e.originalEvent.layerX)/25),n=1+~~(~~(e.offsetY||e.originalEvent.layerY)/17);return t<1||t>15||n<1||n>20?null:{width:t,height:n}}(e);e.preventDefault(),n&&(k(),function(e,n,o){var i,a;0;var c=l()("#tinymce-table-form");c.length?(c.find('input[name="rows"]').val(n),c.find('input[name="cols"]').val(e)):(i=r.AJS.renderTemplate("tableForm",n,e),(a=l()("<div></div>").addClass("hidden")).append(i),t.append(a));l()("#table-heading-checkbox").prop("checked",o),Se(),r.tinymce.activeEditor.undoManager.beforeChange();var u={cols:e,rows:n,heading:o};r.tinymce.activeEditor.execCommand("confInsertTable",!1,u),a&&a.remove()}(n.width,n.height,y))}function R(e){r.tinymce.Env.ie?(16===e.keyCode&&A(!e.shiftKey),27===e.keyCode&&k()):(0===e.charCode&&A(!e.shiftKey),27===e.keyCode&&0===e.charCode&&k())}function O(){k()}return w.insertTable=N,{bindToControl:function(){e=l()(r.document),t=e.find("body"),o=l()("#insert-table-dropdown"),i=l()("#rte-button-insert-table"),a=o.find(".aui-dd-parent"),c=l()("#table-picker-container"),u=c.find(".table-picker-box"),s=c.find(".picker-cell"),f=c.find(".picker-heading"),d=c.find(".picker-selected-cell"),m=c.find(".picker-selected-heading"),p=u.find(".desc"),n=l()("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(o),i.click((function(t){var o;t.preventDefault(),C||(ke(),x(),y=!0,S(1,1),o=l()(r.tinymce.activeEditor.getDoc()),e.bind("mousemove.atlassian-table-picker",_),e.bind("keydown.atlassian-table-picker",R),e.bind("keyup.atlassian-table-picker",R),o.bind("keydown.atlassian-table-picker",R),o.bind("keyup.atlassian-table-picker",R),n.removeClass("hidden"),c.removeClass("hidden"),a.addClass("active"),i.focus())})),n.click(O),d.click(N),m.click(N)},disable:function(){C=!0,o.addClass("disabled")},enable:function(){C=!1,o.removeClass("disabled"),i.attr("data-tooltip",ge("tinymce.tablepicker.insert_table_title"))},close:k,_internal:w}};var er=[];function tr(){l()(".tipsy").remove()}function nr(){var e=/\+/g;setTimeout((function(){l()("#rte-savebar .aui-button[title]").each((function(){var t=l()(this),n=t.attr("title");if(t.removeAttr("title"),r.tinymce.Env.mac){var o=n.indexOf("(");o>=0&&(n=n.substr(0,o)+n.substr(o).replace(e,""))}t.attr("data-tooltip",n)}))}),0)}function rr(e,t,n){if("dropdown"===t&&(l()(".tipsy").remove(),n&&n.trigger&&n.trigger.jquery)){var r=n.trigger.data("tipsy");r&&(r.hoverState="out")}}function or(){var e;(e=l.a).fn.tipsy.autoBounds2=function(t,n){return function(){var r={},o=e(document).scrollTop()+t,i=e(document).scrollLeft()+t,a=e(this);return n.length>1?(r.ns=n[0],r.ew=n[1]):"e"==n[0]||"w"==n[0]?r.ew=n[0]:r.ns=n[0],a.offset().top<o&&(r.ns="n"),a.offset().left<i&&(r.ew="w"),e(window).width()+e(document).scrollLeft()-(a.offset().left+a.width())<t&&(r.ew="e"),e(window).height()+e(document).scrollTop()-(a.offset().top+a.height())<t&&(r.ns="s"),r.ns?r.ns+(r.ew?r.ew:""):r.ew}};var t={live:!0,gravity:"n",title:function(){return l()(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},n=l.a.fn.tipsy.autoBounds2(50,"n"),o=l.a.fn.tipsy.autoBounds2(50,"w"),i=l.a.extend({},t,{gravity:n}),a=l.a.extend({},t,{gravity:o}),c=l.a.extend({},t,{gravity:"se"});l()("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(i),l()("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(a),l()("#rte-savebar [data-tooltip]").tooltip(c),l()("#editor-precursor [data-tooltip]").tooltip(i),l()("#property-panel [data-tooltip]").tooltip(i),ee(r.document,"showLayer",rr),ee(r.document,"hideLayer",rr),s("created.property-panel",tr),s("destroyed.property-panel",tr),s("register-contexts.keyboardshortcuts",nr)}function ir(){var e=r.Confluence.Editor,t=!1;function n(e){var t=function(){e&&e.hide()};ee(r.document,"showLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.on("Click",t),a.on("KeyUp",t)}})),ee(r.document,"hideLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.off("Click",t),a.off("KeyUp",t)}}))}function i(e){e.addCallback("show",(function(){e.$.parents(".disabled").length&&e.hide()}))}function a(e,n){if(!t){var r=p(n);l()("#".concat(r)).removeClass("disabled")}}function c(e,t){var n=p(t);l()("#".concat(n)).addClass("disabled")}function u(e,n){n?e.closest(".aui-button").prop("disabled",!0).attr("aria-disabled","true").toggleClass("disabled",n):t||e.closest(".aui-button").prop("disabled",!1).removeAttr("aria-disabled").toggleClass("disabled",n)}function s(e,n,r,o){var i=!!t||e,a=!!t||n,c=!!t||r,u=l()("#toolbar"),s=u.find(".toolbar-item"),f=l()("#insert-menu, #more-menu"),d=l()("#insert-menu, #color-picker-control"),m=l()("#format-dropdown"),p=o||function(){return!0};s.toggleClass("disabled",i),f.toggleClass("disabled",i),d.toggleClass("disabled",i),m.toggleClass("disabled",!!a),me().TablePicker[i?"disable":"enable"](),void 0!==c&&u.find("button, input").filter(p).toggleClass("disabled",c).prop("disabled",c)}var d,m=function(){return function(e){var t,n,r=e.element,o=(t=r,n=l()(t).closest("PRE,BLOCKQUOTE,.text-placeholder"),function(e){return n.is(e)}),i=o("BLOCKQUOTE"),a=o("PRE"),c=o(".text-placeholder");if(a)s(!0,l()(r).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"));else if(c)s(!0);else if(i){s(!1),l()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright").toggleClass("disabled",!0)}else s(!1)}};function p(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-".concat(t)}function g(e){return l()("#".concat(e)).length>0}function h(e,t){var n=t.animate;null==n&&(n=!0);var i=function(){l()(this).remove(),ne(r.document,"resize.resizeplugin"),t.onHide&&t.onHide()};clearTimeout(d),d=o.a.setTimeout((function(){var e=p(t),r=l()("#".concat(e));n?r.slideUp(400,i):(r.hide(),i.call(r))}),100)}function v(e,n){if(!t){var i=p(n),a=n.animate;if(null==a&&(a=!0),g(i))l()("#".concat(i,":hidden")).slideDown(400,(function(){0}));else{var c=l()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");c.attr("id",i),n.editorAdjacent&&c.addClass("editor-adjacent");for(var u=n.topToolbar?l()("#rte-toolbar.aui-toolbar:visible"):l()("#savebar-container .aui-toolbar:visible"),s=0,f=n.buttons.length;s<f;s++){var m=n.buttons[s];c.append(m.render())}if(c.css({display:"none"}),n.editorAdjacent)u.append(c);else{var h=l()(".editor-adjacent",u).filter(":first");h.length?h.before(c):u.append(c)}c.find(".toolbar-dropdown").each((function(){b(this)}));var v=function(){ne(r.document,"resize.resizeplugin"),ne(r.document,"shown.contextToolbar"),n.onVisible&&n.onVisible()};clearTimeout(d),d=o.a.setTimeout((function(){a?c.slideDown(400,v):(c.show(),v())}),100)}}}function b(e){var o=l()(e),a=o.dropDown("Standard",{alignment:o.data("dropdown-alignment")||"left"})[0];o.find(".dropdown-item").click((function(e){!function(e){if(!t){var n=e.attr("data-macro-name"),o=e.attr("data-command"),i=e.attr("data-format"),a=e.attr("data-control-id"),c=r.tinymce.activeEditor;n&&Pe.macroBrowserToolbarButtonClicked({presetMacroName:n}),o&&c.execCommand(o,!1),i&&c.plugins.atlassiantheme.controlHandlers.formatselect.click.dispatch(i),a&&c.plugins.atlassiantheme.controlHandlers.buttons.click.dispatch(a.toLowerCase())}}(l()(this)),a.hide(),e.preventDefault()})),i(a),n(a)}function y(){var e=[];for(var t in{})e.push("hints.".concat(t));var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:function(){var n=e[t];return t=(t+1)%e.length,n}}}(e),o=function(){l()("#rte-savebar .hints-text").html(r.tinymce.activeEditor.translate("tinymce.".concat(n.getNextHint())))};o(),l()("#rte-savebar a.hints-close").click((function(e){l()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()})),l()("#rte-savebar a.hints-next").click((function(e){o(),e.preventDefault()}))}return{init:function(t){var o,u;b("#format-dropdown"),b("#more-menu .aui-dd-parent"),b("#insert-menu .aui-dd-parent"),l()("#pagelayout-menu").length&&b("#pagelayout-menu .aui-dd-parent"),l()("#template-menu").length&&b("#template-menu .aui-dd-parent"),function(){var e=l()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),o=l()("#rte-button-color"),a=o.find(".selected-color"),c=t.dropDown("Standard",{alignment:"left"})[0],u=o.attr("data-color");a.css("background-color","#".concat(u)),e.delegate("a[data-color]","click",(function(e){var t=l()(this),n=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(r.tinymce.execCommand("ForeColor",!1,"#".concat(n)),o.attr("data-color",n),a.css("background-color","#".concat(n)))})),i(c),n(c)}}(),me().TablePicker.bindToControl(r.tinymce.activeEditor,l()("#insert-table-dropdown")),(o=l()("#rte-button-source-mode")).click((function(){o.hasClass("active")?e.changeMode(e.MODE_RICHTEXT):e.changeMode(e.MODE_SOURCE)})),y(),u=t,ne(r.document,"initContextToolbars.Toolbar",u),ee(r.document,"createContextToolbarRow.Toolbar",v),ee(r.document,"removeContextToolbarRow.Toolbar",h),ee(r.document,"enableContextToolbarRow.Toolbar",a),ee(r.document,"disableContextToolbarRow.Toolbar",c);var s=l()("#format-dropdown"),d=s.find("span.dropdown-text");t.on("BeforeExecCommand",(function(e){var n=e.command,r=e.value;if(l.a.each(["pre","blockquote"],(function(){"FormatBlock"==n&&r==this&&(t.formatter.remove("alignleft"),t.formatter.remove("aligncenter"),t.formatter.remove("alignright"))})),l()(t.selection.getNode()).closest("pre,.text-placeholder").length)for(var o=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],i=o.length,a=0;a<i;a++)n==o[a]&&e.preventDefault();if("FormatBlock"==n&&"pre"==r&&(t.undoManager.add(),t.execCommand("removeFormat")),"FormatBlock"==n&&"p"==r){var c=s.find(".dropdown-item[data-format='blockquote']").text();d.text()==c&&t.execCommand("FormatBlock",!1,"blockquote")}})),t.on("ExecCommand",(function(e){var t=e.command,n=e.value;if("FormatBlock"==t){var r=s.find(".dropdown-item[data-format='".concat(n,"']"));r.length||(r=s.find(".dropdown-item[data-format='p']")),d.text(r.text())}})),t.on("NodeChange",m()),t.on("init",(function(){var e={};l()(".aui-toolbar").find("[data-control-id]").each((function(n,r){var o=l()(r),i=o.attr("data-control-id");i&&("formatselect"==i?t.plugins.atlassiantheme.controlHandlers[i].state.add((function(e){if("p"==e){var n=t.selection.getNode();l()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var r=s.find(".dropdown-item[data-format='".concat(e,"']")).text();r&&d.text(r)})):e[i.toLowerCase()]=o)}));var n=t.plugins.atlassiantheme.controlHandlers.buttons;n.state.add((function(t,n,r){var o=e[t];if(o){var i=o.find(".icon-check"),a=o.closest(".toolbar-item");i.length?i.toggleClass("hidden",!r):a.toggleClass(n,r)}})),l()(".aui-toolbar").delegate(".toolbar-item","click",(function(e){var t=l()(this);if(t.hasClass("disabled"))e.preventDefault();else{var r=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");r&&(n.click.dispatch(r.toLowerCase()),e.preventDefault())}})),l.a.support.shrinkWrapBlocks=!1,or()})),t.on("Remove",(function(){te(r.document,"showLayer",rr),te(r.document,"hideLayer",rr),f("created.property-panel",tr),f("destroyed.property-panel",tr),f("register-contexts.keyboardshortcuts",nr)}))},toggleToolbarButton:u,disableToolbarButton:function(e){u(l()(".".concat(e.replace(".",""))),!0)},enableToolbarButton:function(e){t||u(l()(".".concat(e.replace(".",""))),!1)},focusToolbarButton:function(e){t||l()(".".concat(e.replace(".",""))).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var t=p({id:e});return g(t)&&!l()("#".concat(t)).hasClass("disabled")},getToolbarRow:function(e){var t=p({id:e}),n=l()("#".concat(t));return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!l()(".".concat(e.replace(".",""))).closest(".aui-button").prop("disabled")},bindDropdownMenu:b,toggleToolbarButtons:s,disableToolbar:function(e){t=!!e},getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}var ar=n("./node_modules/querystring-es3/index.js"),cr=n.n(ar);function ur(e){return this.message=e.message,this.statusCode=e["status-code"],this.stack=(new Error).stack,this}ur.prototype=new Error;var lr=ur;function sr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){fr(e,t,n[t])}))}return e}function fr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dr=function(e,t){return e.replace(/:([a-zA-Z]+)\?*/g,(function(e,n){var r=t[n];return"string"==typeof r&&-1===r.indexOf("=")?encodeURIComponent(decodeURIComponent(r)):r.toString()}))};function mr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(r instanceof lr){if(401===r.statusCode)return e.onUnauthorized&&e.onUnauthorized(),t(r);var o=n[r.statusCode];return o?o(r,t):t(r)}if(r instanceof TypeError)return t(r);throw r}}function pr(e,t,n){var r=t.body,o=t.callback,i=t.headers,a=t.method,c=t.extraConfig,u=t.responseTransformer,l=r,s=i["Content-Type"];return s||delete i["Content-Type"],s&&-1!==s.indexOf("application/x-www-form-urlencoded")?l=cr.a.stringify(r):"application/json"===s&&(l=JSON.stringify(r)),fetch(e,{headers:i,credentials:"include",method:a,body:l}).then((function(e){if(!e.ok){var t=e.status;return e.text().then((function(e){throw new lr({message:e,"status-code":t})}))}return c&&c.ignoreResponseJson?null:204!==e.status?e.json():e})).then((function(t){if(t&&t["status-code"])throw new lr(t);return o(null,u?u(t,e,n.contextPath,r):t)})).catch(mr(n,o))}var gr,hr=(gr={endpoint:null,contextPath:null,onUnauthorized:function(){},extraHeaders:{}},{configure:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gr=sr({},gr,e)},getConfig:function(){return gr},getFullPath:function(e,t){var n=gr.contextPath+e;return t?dr(n,t):n},getExternalServicePath:function(e,t){if("function"!=typeof e)throw"getExternalServicePath expects path to be a function so it can be lazy evaluated";var n=e();return dr(n,t)},get:function(e,t){var n=t.callback,r=t.headers,o=t.responseTransformer;return pr(e,{callback:n,headers:sr({Accept:"application/json","Content-Type":"application/json"},gr.extraHeaders,r),method:"GET",responseTransformer:o},gr)},post:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.extraConfig,a=t.responseTransformer;return pr(e,{body:n,callback:r,headers:sr({"Content-Type":"application/x-www-form-urlencoded"},gr.extraHeaders,o),method:"POST",extraConfig:i,responseTransformer:a},gr)},put:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return pr(e,{body:n,callback:r,headers:sr({Accept:"application/json","Content-Type":"application/json"},gr.extraHeaders,o),method:"PUT",responseTransformer:i},gr)},delete:function(e,t){var n=t.callback,r=t.headers,o=t.extraConfig,i=t.responseTransformer;return pr(e,{callback:n,headers:sr({Accept:"application/json","Content-Type":"application/json"},gr.extraHeaders,r),method:"DELETE",extraConfig:o,responseTransformer:i},gr)},postLegacyResource:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return fetch(e,{headers:sr({"Content-Type":"application/x-www-form-urlencoded"},gr.extraHeaders,o),credentials:"include",method:"POST",body:"string"==typeof n?n:cr.a.stringify(n)}).then((function(e){if(!e.ok)return new Error("Request failed with ".concat(e.status));var t=e.headers.get("content-type");return t&&-1===t.indexOf("text/html")&&-1===t.indexOf("text/plain")?e.json():e.text()})).then((function(t){return t instanceof Error?r(t):r(null,i?i(t,e,gr.contextPath,n):t)})).catch(mr(gr,r))},fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))}),vr={configure:function(e){hr.configure(e)},getPluginCodeLanguages:function(e){var t=hr.getFullPath("/plugins/newcode/getlanguages.action");hr.get(t,{callback:e})},getWikiConfluenceToXhtml:function(e,t){var n=hr.getFullPath("/rest/tinymce/1/wikixhtmlconverter");hr.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})},getWikiMarkdownToXhtml:function(e,t){var n=hr.getFullPath("/rest/tinymce/1/markdownxhtmlconverter");hr.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})}};function br(){Object(r.redirect)("".concat(ye,"/login.action?os_destination=").concat(Object(r.location)().pathname.replace(ye,"")))}vr.configure({endpoint:("undefined"==typeof window?"http://localhost:8080":"".concat(i().protocol,"//").concat(i().host))+ye,contextPath:ye,onUnauthorized:br});var yr=vr,wr=(n("./src/editor-plugins/insertwiki/insert-wiki-markup.css"),function(){return!E("editor.insert-wiki-markdown")}),Cr={HELP_REST_API:"".concat(ye,"/plugins/tinymce/helplink.action"),WIKI:{CONFLUENCE:{api:yr.getWikiConfluenceToXhtml,val:"CONFLUENCE",label:"confluence.conf_wikimarkup_confluence_label",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{api:yr.getWikiMarkdownToXhtml,val:"MARKDOWN",label:"confluence.conf_wikimarkup_markdown_label",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},xr={dialog:{id:"insert-wiki-markup-dialog",content:"",width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},markupEditId:"insert-wiki-textarea",previewAreaId:"insert-wiki-textarea-preview",selectionMenuId:"wiki-parser-selection-tool",serverRequestTimer:300,entityId:U.get("content-id"),spaceKey:U.get("space-key")},kr=null,Sr=function(){var e=yn.get("insert-wiki-markup-dialog.parser","global","CONFLUENCE");return Cr.WIKI[e]},Tr=function(e,t){var n=l()(function(e,t,n){return'\n    <span class="wiki-parser-selector">\n        <form action="#" method="post" id="d" class="aui">\n            <select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector">\n                <option value="'.concat(t.val,'">').concat(e(t.label),"</option>\n                ").concat(Object.keys(n).filter((function(e){return n[e].val!==t.val})).map((function(t){return'<option value="'.concat(n[t].val,'">').concat(e(n[t].label),"</option>")})),"\n            </select>\n        </form>\n    </span>\n")}(e,t,Cr.WIKI));return l()("#insert-wiki-insert-title").append(n),l()("#".concat(xr.selectionMenuId))},Er=function(){var e=l()("#".concat(xr.selectionMenuId));return e.length?e.val():Sr().val},_r=function(e){var t={wiki:(e=e||{}).textToConvert,entityId:xr.entityId,spaceKey:xr.spaceKey};e.api(JSON.stringify(t),(function(t,n){t?e.errorCallback(t):e.successCallback(n)}))},Ar=function(){var e=l()("#".concat(xr.markupEditId)).val();l.a.trim(e)?_r({api:Cr.WIKI[Er()].api,textToConvert:e,successCallback:function(e){kr.html(e)},errorCallback:function(){kr.html(Rr(e))}}):kr.html(e)},Nr=function(){var e,t,n,r=Er();yn.set("insert-wiki-markup-dialog.parser","global","CONFLUENCE",r),e=r,t=l()("#".concat(xr.dialog.id)).find(".dialog-help-link"),n=Cr.WIKI[e].helpLink,t.load(Cr.HELP_REST_API,{linkUrlKey:n}),Ar()};function Rr(e){if("string"!=typeof e)return"";var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return e.replace(/[&"'<>`]/g,(function(e){return"string"==typeof t[e]?t[e]:"&quot;"}))}var Or={init:function(e,t){var n;xr.dialog.content=wr()?'\n    <p id="insert-wiki-info-title">'.concat((n=function(e){return ge(e)})("tinymce.confluence.conf_wikimarkup_info_title"),'</p>\n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <h3 class="wiki-title">\n            <span id="insert-wiki-insert-title">').concat(n("tinymce.confluence.conf_wikimarkup.insert.label"),'</span>\n            <span id="insert-wiki-preview-title">').concat(n("tinymce.confluence.conf_wikimarkup_preview_label"),'</span>\n        </h3>\n        <textarea class="monospaceInput textarea" id="insert-wiki-textarea" name="wikitext"></textarea>\x3c!--\n            --\x3e<div class="example-container" id="insert-wiki-textarea-preview"></div>\n    </form>\n'):' \n    <form action="#" method="post" id="insert-wiki-markup-form" class="aui">\n        <textarea class="monospaceInput textarea originalDefault" id="insert-wiki-textarea" name="wikitext"></textarea>\n    </form>\n';var i=function(t){var n,o,i,a=xr.dialog.id,c=Er();e.windowManager.setBusy(a,!1),r.tinymce.EditorManager.activeEditor.windowManager.close(a),wr()&&(d("analytics",{name:"insert-wiki-markup-dialog.".concat(c)}),"MARKDOWN"===c&&(n=t,(o=l()(n)).find("img").addClass("confluence-embedded-image"),t=l()("<div>").append(o.clone()).html())),e.execCommand("mceInsertContent",!1,t),i=e,r.tinymce.each(i.dom.select("p > p"),(function(e){try{e.parentNode&&i.dom.split(e.parentNode,e)}catch(e){}}))},a=function(t,n,o){e.windowManager.setBusy(xr.dialog.id,!1);var i=function(e,t){return'\n        <p class="warning">\n            '.concat(e,'\n        </p>\n        <p class="exception-report">\n            <span class="exceptionMessage">\n                ').concat(t,"\n            </span>\n        </p>\n")}(e.translate("confluence.conf_wikimarkup_conversion_errors"),"timeout"===n?e.translate("confluence.conf_wikimarkup_timeout"):"".concat(Rr(n||t.message)," : ").concat(Rr(o)));r.tinymce.EditorManager.activeEditor.windowManager.alert(i)};e.addCommand("InsertWikiMarkup",(function(){var n,r=Sr();return e.windowManager.open(xr.dialog,{buttons:[{label:"confluence.conf_insert_button_title",action:function(){e.windowManager.setBusy(xr.dialog.id,!0),_r({api:Cr.WIKI[Er()].api,successCallback:i,errorCallback:a,textToConvert:l()("#".concat(xr.markupEditId)).val(),setBusy:!0})}}],plugin_url:t,helpLink:r.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"}),wr()&&(!function(e){var t=l()("#wysiwygTextarea_ifr").contents().find("head").html(),n=l()("<iframe tabindex='-1' id='insert-wiki-markup-preview' />");l()("#".concat(e)).append(n);var r=n.contents(),o=r[0];o.open(),o.write('\n    <!DOCTYPE html>\n    <html class="insert-wiki-markup-dialog">\n        <head>\n        </head>\n        <body class="wiki-content previewWiki">\n        </body>\n    </html>\n'),o.close(),r.find("head").html(t),kr=r.find("body")}(xr.previewAreaId),Tr((function(t){return e.translate(t)}),r).on("change",Nr),l()("#".concat(xr.markupEditId)).on("keydown",(function(){clearTimeout(n),n=o.a.setTimeout(Ar,xr.serverRequestTimer)}))),!1})),e.ui.registry.addButton("insertwikimarkup",{text:"confluence.conf_wikimarkup_desc",onAction:function(){e.execCommand("InsertWikiMarkup")}})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}};var Dr={fields:{string:{language:function(e,t){var n,o=l()(r.Confluence.Templates.MacroBrowser.macroParameterSelect()),i=l()("select",o);return null==t&&(t={}),t.setValue=function(e){if(0==i.find("option[value='".concat(e,"']")).length){var t=l()("<option/>");t.val(e),t.text(e),i.append(t)}},n=i,yr.getPluginCodeLanguages((function(e,t){if(!e&&t.length){var r=n.val();n.empty(),n.append(l()("<option/>").attr("value","")),t.forEach((function(e){var t=l()("<option />");t.val(e.aliases[0]),t.text(e.friendlyName),n.append(t)})),n.val(r)}})),new r.AJS.MacroBrowser.Field(o,i,t)}}}};function Ir(){var e;function t(){var t=l()("#breadcrumbs");t.detach(),!t.find(".edited-page-title").length&&e.length&&t.append(e),l()("#editor-precursor .cell").prepend(t)}if("comment"!==U.get("content-type")){var n=l()("#quickedit-breadcrumbs");n.length>0&&(l()("#breadcrumbs").detach(),n.attr("id","breadcrumbs"),l()("#breadcrumb-section").append(n)),e=l()(".edited-page-title").parent().detach(),t(),ee(r.document,"mode-changed",(function(n,r){var o;"preview"===r?(o=l()("#breadcrumbs").detach(),e.detach(),l()("#breadcrumb-section").append(o)):"richtext"===r&&t()}))}}var Pr={};function Br(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mr(e){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Lr=function(e){return function(t,n,r){var o=null!=r&&"object"!==Mr(r),i=null!=r?o?" = ".concat(r):" >":"";console.log("".concat(e," - ").concat(t," : ").concat(n||null).concat(i)),r&&!o&&console.log(r)}},Fr=function e(t,n){var o=Lr("Autocompleter.Control"),i={},a=t.selection,c=a.getRng();if(!c)return null;var u=c.startOffset,s=c.startContainer,f=s.nodeValue,d=n.leadingChar,m=t.getDoc(),p=n.backWords||0,g=n.insertedFromMenu||!1,h=Pr[d||"["],v=h&&void 0!==h.preventStartNodes?h.preventStartNodes:"div.code, a[href], img, pre";if(l()("#".concat("autocomplete"),m).length)return o("init","Autocomplete already exists, returning null."),null;i.backWords=p,i.maxResults=n.maxResults||10,null==f&&c.collapsed&&u&&s.childNodes[u-1]&&(u=(f=(s=s.childNodes[u-1]).nodeValue)&&f.length||0);var b="";if(null!=f){b="".concat(f).substring(0,u);for(var y=s.previousSibling;y&&3===y.nodeType;)b=y.nodeValue+b,y=y.previousSibling}var w;if(!p&&b&&!function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].test(e))return!0;return!1}(b+d,[/([("'<\(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,/(\/\/)$/]))return o("init","Cursor is in wrong word location to start autocomplete, returning null."),null;if(l()(s).closest(v).length)return o("init","Cursor is in wrong node to start autocomplete, returning null."),null;if(r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&(r.Confluence.PropertyPanel.shouldCreate=!1,r.Confluence.PropertyPanel.destroy()),d||null!=f||(o("init","No text available for suggestion, range is",c),f=""),i.getContainer=function(){return l()("#".concat("autocomplete"),m)},c.collapsed&&p&&f){var C=function(e,t,n){var r,o;function i(e,t,n){!t.global&&(t=new RegExp(t.source,"g".concat(t.ignoreCase?"i":"").concat(t.multiline?"m":""))),null==n?n=e.length:n<0&&(n=0);for(var r,o=e.substring(0,n+1),i=-1,a=0;null!=(r=t.exec(o));)i=r.index,t.lastIndex=++a;return i}for(var a=0;a<n;a++)for(t=i(r=e.nodeValue.substring(0,t),/\s+/,t);-1==t;){if(!(o=e.previousSibling)||3!==o.nodeType){a=n;break}e=o,(r=o.nodeValue)&&(t=i(r,/\s+/,r.length))}return{node:e,offset:t+1}}(s,u,p),x=a.getRng();x&&(x.setStart(C.node,C.offset),x.setEnd(s,u),a.setRng(x))}w=a&&a.getNode()&&a.getNode().classList.contains("placeholder-inline-tasks")?"":a.getContent({format:"text"}).replace("\n",""),o("init","suggestionHtml",w);var k,S=function(e,t,n){var o=r.document.createElement(e);return t&&o.setAttribute("id",t),n&&o.appendChild(r.document.createTextNode(n)),o},T=S("span","autocomplete");if(n.classNames)if("string"==typeof n.classNames)(k=T.classList).add.apply(k,Br(n.classNames.split(" ")));else if(Array.isArray(n.classNames)){var E;(E=T.classList).add.apply(E,Br(n.classNames))}d&&T.appendChild(S("span","autocomplete-trigger",d));var _=S("span","autocomplete-search-text",r.AJS.Rte.HIDDEN_CHAR);T.appendChild(_),a.setNode(l()(T)[0]);var A=i.getContainer();i.previousSearchText="",i.settings=h,!1===h.cache||h.cacheManager?!1!==h.cache||h.cacheManager||(h.cacheManager={get:l.a.noop,put:l.a.noop}):h.cacheManager=new r.AJS.Confluence.localStorageCacheManager(h.ch);var N=l()("#".concat("autocomplete-search-text"),i.getContainer()),R=l()(m.createElement("span")).text(w||r.AJS.Rte.HIDDEN_CHAR);N.empty().append(R),a.select(R[0],!0),a.collapse();var O,D,I=function(e){if(i.onBeforeKey&&!i.onBeforeKey(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("before","blocked by onBeforeKey: ".concat(e.keyCode)),!1},P=function(e){var t=a.getRng();if(t){var n=i.getContainer(),c=t.startContainer,u=c.parentNode;3===c.nodeType&&u&&(u=u.parentNode);var l=u?u.parentNode:null,s=l?l.parentNode:null,f=u!==n[0]&&l!==n[0]&&s!==n[0];if(27===e.keyCode||f)o("after","dying because of: ".concat(f?"outside search span":"escape pressed")),i.die();else if(i.onAfterKey&&!i.onAfterKey(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("after","blocked by onAfterKey: ".concat(e.keyCode)),!1}},B=function(e){if(i.onKeyPress&&!i.onKeyPress(e,i.text()))return r.tinymce.dom.Event.cancel(e),o("press","blocked by onKeyPress: ".concat(e.keyCode)),!1},M=function(e){i.getContainer()[0]!=e.target.parentNode&&(o("click","Clicked outside of autocomplete, closing."),i.die())};t.on("KeyDown",I,!0),t.on("KeyUp",P,!0),t.on("KeyPress",B,!0),t.on("Click",M,!0),i.word="",n.keepAlias?o("init","No suggestion based on previous or selected text"):i.word=w,r.AJS.Rte.showElement(A[0]),O=r.tinymce.DOM.getPos(A[0]),D=A.height(),i.left=O.x,i.top=O.y+D,i.text=function(e){var t=l()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=r.AJS.escapeEntities(t.text())).replace(r.AJS.Rte.HIDDEN_CHAR,"")},i.plainText=function(e){var t=l()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=t.text()).replace(r.AJS.Rte.HIDDEN_CHAR,"")};var L=function(t,n){var r=i.getContainer();return e.replaceWithTextAndGetRange(r,t,n)};return i.replaceWithSelectedSearchText=function(){var e=i.text();return o("replaceWithSelectedSearchText",e),L(e,!1),e},i.die=function(e){if(i.dying)o("die","Already dying, returning.");else{if(i.dying=!0,r.Confluence.PropertyPanel&&(r.Confluence.PropertyPanel.shouldCreate=!0),i.getContainer().length){o("die","Tearing down autocomplete, cleaning up autocompleter");var a=(e||n.backWords||g?"":i.settings.ch)+i.text();c=L(a,!0)}setTimeout((function(){o("die","Removing autocomplete-control keyboard listeners."),t.off("KeyDown",I),t.off("KeyUp",P),t.off("Click",M),t.off("KeyPress",B)}),1),r.AJS.Rte.unbindScroll("autocomplete"),l()(r.document).unbind("click.autocomplete-outside"),this.onDeath&&this.onDeath()}},r.AJS.Rte.bindScroll("autocomplete",(function(){o("scrolling:"),r.AJS.Rte.isAnyPartShown(A)?i.onScroll():i.die()})),l()(r.document).bind("click.autocomplete-outside",(function(e){var t=e.srcElement&&"rte-insert-date"===e.srcElement.id;l()(e.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||t||i.die()})),r.AJS.Rte.getEditor().on("BeforeExecCommand",(function(e){"mceConfSavePage"==e.command&&i.die()})),i.update=function(e){ke(),L("",!0),this.settings.update(this,e)},i.removeSpan=function(){i.getContainer().remove()},i};Fr.removeOrphanedControl=function(){var e=l()(r.AJS.Rte.getEditor().getDoc()),t=e.find("#".concat("autocomplete"));if(!t.length)return null;var n=e.find("#".concat("autocomplete-trigger")).text(),o=e.find("#".concat("autocomplete-search-text")).text();return Fr.replaceWithTextAndGetRange(t,o,!1),{leadingChar:n,content:o}},Fr.replaceWithTextAndGetRange=function(e,t,n){if(e.length){t=t||"",n=n||!t;var o=r.AJS.Rte.getEditor(),i=e[0].parentNode,a=r.AJS.Rte.Content.getChildIndex(i,e[0]),c=n?1:0,u=o.selection.getRng();return u.setStart(i,a+c),u.setEnd(i,a+1),e.before(t||r.AJS.Rte.HIDDEN_CHAR).remove(),o.selection.setRng(u),u}console.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")};var jr=function e(t){if(!(this instanceof e))return new e(t);this.cache={},this.cacheStack=[],this.cacheSize=t||30};jr.prototype.get=function(e){var t=this.cache[e];if(t){var n=this.cacheStack[this.cacheStack.length-1][0]+1;return t.weight=n,this.cacheStack.push([n,e]),t.value}},jr.prototype.put=function(e,t){var n,r,o,i=this.cacheStack.length?this.cacheStack[this.cacheStack.length-1][0]+1:0;for(this.cache[e]={weight:i,value:t},this.cacheStack.push([i,e]);this.cacheStack.length>this.cacheSize;)r=(n=this.cacheStack.shift())[0],o=n[1],r===this.cache[o].weight&&delete this.cache[o]},jr.prototype.clear=function(){this.cache={},this.cacheStack=[]};var Hr=jr,Ur=function(e,t){var n,r;if(e&&e.length&&e[0]){for(var o=[],i=0,a=e.length;i<a;i++){var c=e[i];c&&o.push(c.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"))}n=new RegExp("(".concat(o.join("|"),")"),"gi"),r=Xn()(t||"<strong>{highlight}</strong>").fill({highlight:"$1"}).toString()}return{highlight:function(e,t){return e?(t||(e=Xn.a.escape(e)),n?e.replace(n,r):e):e},safeHighlight:function(e){if(!e)return e;var t,o;if(n&&r){var i=r.split("$1");t=i[0],o=i[1],e=e.replace(n,"@@@hl@@@$1@@@endhl@@@")}return Et(e).replace(/@@@hl@@@/gi,t).replace(/@@@endhl@@@/gi,o)}}},zr=function(e,t){var n=e.options;n.ajsDropDownOptions=n.ajsDropDownOptions||{};var o,i=(n.ajsDropDownOptions.Highlighter||Ur)(t.queryTokens||[t.query]);n.ajsDropDownOptions.alignment||(n.ajsDropDownOptions.alignment="left"),n.ajsDropDownOptions.selectionHandler=n.ajsDropDownOptions.selectionHandler||Wr,(o=e.dd)&&(o.hide(),o.$.remove());var a=e.dd=r.AJS.dropDown(t.matrix,n.ajsDropDownOptions)[0];if(n.ajsDropDownOptions.className&&a.$.addClass(n.ajsDropDownOptions.className),a.$.find("li a:not(.dropdown-prevent-highlight) span").each((function(){var e=l()(this);e.html(i.safeHighlight(e.text()))})),a.$.hasClass("fabric")){var c=a.$.find(".insert-mentions-dropdown-option");c.length===t.matrix[1].length&&t.matrix[1].forEach((function(e,t){var n=i.safeHighlight(e.username);if(n){e.lozenge&&(n+=" &middot; ".concat(e.lozenge));var r=l()("<span>").addClass("dropdown-lozenge").html(n);c.eq(t).append(r)}}))}return n.dropdownPlacement?n.dropdownPlacement(a.$):(console.log("No dropdownPlacement function specified. Appending dropdown to the body."),l()("body").append(a.$)),function(e){var t=e.$.closest(".aui-dd-parent").width();t||(e.$.width("25em"),t=e.$.width()),l()("a span:not(.icon)",e.$).each((function(){var e=l()(this),n=r.document.createElement("var");n.innerHTML="&#8230;";var o=l()(n),i=o.width(),a=!1;e.wrapInner(l()("<em>")),l()("em",e).each((function(){var e=l()(this);if(e.show(),this.offsetLeft+this.offsetWidth+i>t-20){for(var n=this.childNodes,r=!1,o=n.length-1;o>=0;o--){var c=n[o],u=1,s=3===c.nodeType?"nodeValue":"innerHTML",f=c[s];do{if(!(u<=f.length))break;c[s]=f.substr(0,f.length-u++)}while(this.offsetLeft+this.offsetWidth+i>t-20);if(u<=f.length){r=!0;break}}r?a=!0:e.hide()}})),a&&(e.append(o),this.elpss=o)}))}(a),function(e){l()("a span:not(.icon)",e.$).each((function(){var e,t=l()(this);try{var n=t.data("properties");e=n?n.spaceName:null}catch(e){console.error("Problem getting space name: ",e.message)}var r=t.text();e&&(r+=" (".concat(l()("<i></i>").html(e).text(),")")),t.attr("title",r)}))}(a),n.dropdownPostprocess&&n.dropdownPostprocess(a.$),a.show(e._effect),"function"==typeof n.onShow&&n.onShow.call(a,a.$),a},Wr=function(e,t){if("click"!=e.type){var n=l()("a",t).first(),i=n.attr("href");if("keydown"===e.type&&(e.metaKey||e.ctrlKey)&&13===e.which){var a=o.a.open(i,"_blank");a&&a.opener&&(a.opener=null)}else n.click(),r.document.location=i;e.preventDefault()}};function qr(e,t){this._effect="appear",this._timer=null,this.id=e,this.options=t,this.inactive=!1,this.busy=!1,this.cacheManager=Hr()}qr.prototype.clearCache=function(){this.cacheManager.clear()},qr.prototype.change=function(e,t,n){var r=this;if(e!=r._value){r._value=e,r.busy=!1,o.a.clearTimeout(r._timer);var i=r.options.minLengthForGetData||2,a=new RegExp("\\S{".concat(i,",}"));if(t||a.test(e)){var c=r.cacheManager.get(e);if(c)zr(r,c);else{r.busy=!0;var u=function(){r.options.getDataAndRunCallback.call(r,e,(function(){r.show.apply(this,arguments),n&&n(e)}))};0===r.options.dropDownDelay?u():r._timer=o.a.setTimeout((function(){u()}),r.options.dropDownDelay||200)}}else r.dd&&r.dd.hide(),n&&n(e)}},qr.prototype.hide=function(){this.dd&&this.dd.hide()},qr.prototype.remove=function(){var e=this.dd;e&&(this.hide(),e.$.remove()),this.inactive=!0,this.options.onDeath&&this.options.onDeath()},qr.prototype.show=function(e,t,n){if(this.inactive)console.log("Quick search abandoned before server response received, ignoring. ",this);else{var r={matrix:e,query:t,queryTokens:n};this.cacheManager.put(t,r),zr(this,r),this.busy=!1}};var Vr,$r;Lr("Autocompleter.Manager");var Kr=function(e){var t=Pr[e.leadingChar];if(e=l.a.extend({minLengthForGetData:t.minLengthForGetData,displayHandler:t.displayHandler,Highlighter:t.Highlighter,classNames:t.autocompleteClassNames},e),!(Vr=Fr(r.AJS.Rte.getEditor(),e)))return!1;function n(e){return l.a.data(e,"properties")}d("synchrony.stop",{id:"confluence.autocomplete-plugin"});var o,i=l()(r.window).width(),a=function(e){var t,n,a=l()("#autocomplete-dropdown"),c=Vr.getContainer();a.length||(a=l()("<div></div>").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));var u=r.AJS.Position.spaceAboveBelow(r.AJS.Rte.getEditorFrame(),c);e.find("ol:has(a.menu-header)").addClass("top-menu-item"),e.find("ol:empty").hide(),a.append(e);var s=r.AJS.Rte.Content.offset(c),f=Math.max(a.width()+s.left-i+10,0),d=s.left-f-0,m=e.outerHeight(!0),p=m+10;o&&(function(e,t){return 1==o?e.above>=t:e.below>=t}(u,p)||(o=null)),o||(o=function(e,t){return e.below>=t?2:e.above>=t?1:e.below>e.above?2:1}(u,p)),(n=a.find(".autocomplete-dropdown-arrow")).length||(n=l()("<div>").addClass("autocomplete-dropdown-arrow").addClass(Vr.settings.autocompleteClassNames)),1===o?(n.addClass("autocomplete-dropdown-bottom-arrow").css({top:m-1}),t=s.top-m-10):(n.removeClass("autocomplete-dropdown-bottom-arrow").css("top",""),t=s.top+c.height()+10),n.css({left:f}).appendTo(a),a.css({position:"absolute",top:t,left:d})};$r=function(e){return new qr("inputdriven-dropdown",e)}({onShow:function(e){d("rte-autocomplete-on-show",{triggerChar:Vr.settings.ch});var t=r.AJS.Rte.getEditorFrame();t&&t.shim&&t.shim.hide(),e.find("a.menu-header").unbind().click((function(e){e.preventDefault(),Vr.die()})),this.reset(),Vr.settings.selectFirstItem&&e.find("a:not('.menu-header')").length&&r.AJS.dropDown.current.moveDown()},dropdownPlacement:a,onDeath:function(){l()("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(e,t){e.preventDefault();var r=n(t[0]);r&&"function"==typeof r.callback?r.callback(Vr):"menu-header"!==r.className&&Vr.update(r),Vr.die()},moveHandler:function(e,t){var n=r.AJS.dropDown.current;e&&e.find("a").is(".menu-header")&&("up"==t?n.moveUp():n.moveDown())},className:"autocomplete ".concat(Vr.settings.dropDownClassName),displayHandler:e.displayHandler,Highlighter:e.Highlighter},getDataAndRunCallback:function(e){Vr&&Vr.settings.getDataAndRunCallback&&Vr.settings.getDataAndRunCallback(Vr,e,(function(t,n,r,o){t.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",name:Vr.settings.getHeaderText(Vr,e)}]),t.push(Vr.settings.getAdditionalLinks(Vr,e,r)),$r&&$r.show(t,n,o||[n])}))},dropDownDelay:Vr.settings.dropDownDelay,minLengthForGetData:Vr.settings.minLengthForGetData}),Vr.onBeforeKey=function(e,t){return 40===e.keyCode||38===e.keyCode||13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):!(27===e.keyCode||9===e.keyCode||8===e.keyCode&&!t)||(this.die(8===e.keyCode),!1)},Vr.onKeyPress=function(e){var t=String.fromCharCode(e.which);return 13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):(this.settings.endChars.includes(t)&&Vr.die(),!0)};var c=e.minLengthForGetData||2,u=new RegExp("\\S{".concat(c,",}"));Vr.onAfterKey=function(e,t){if(40===e.keyCode||38===e.keyCode||13===e.keyCode){var n=r.AJS.dropDown.current;return!!n&&(-1==n.getFocusIndex()&&13===e.keyCode?(Jr(),!0):(e.which||(e.which=e.keyCode),n.moveFocus(e)))}var o=8===e.keyCode&&!t||s(t);return(o||u.test(t))&&$r&&$r.change(t,o),!0};var s=function(e){return/[\u4E00-\u9FFF]/gi.test(e)};return Vr.onDeath=function(){$r&&($r.remove(),$r.closing=!0),d("synchrony.start",{id:"confluence.autocomplete-plugin"})},Vr.onScroll=function(){$r&&$r.dd&&a($r.dd.$)},Vr.getCurrentItem=function(){if(!$r||!$r.dd)return null;var e=$r.dd,t=e.getFocusIndex();return t<0?null:n(e.links[t])},$r&&$r.change(Vr.text(),!0),!0},Jr=function(){Vr.die(),Vr=null},Gr={getInputDrivenDropdown:function(){return $r},triggerListener:function(e){if(!e.metaKey){$r&&$r.closing&&($r=null);var t=String.fromCharCode(e.which);!$r&&t in Pr&&Kr({leadingChar:t})&&r.tinymce.dom.Event.cancel(e)}},shortcutFired:function(e,t){var n=t?0:1;return $r&&$r.closing&&($r=null),$r&&(n=t?0:Vr.backWords+1,Jr()),Kr({leadingChar:e,backWords:n})},reattach:function(){var e=Fr.removeOrphanedControl();e&&Gr.shortcutFired(e.leadingChar)}},Xr=n("com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')"),Yr=n.n(Xr),Qr=function(e,t){Pr[e]=t},Zr=function(e,t,n){return'<a href="#" class="'.concat(t||"",'"><span class="icon ').concat(n||"",'"></span><span>').concat(e,"</span></a>")},eo=function(e,t,n,r,o){var i;if(e.statusMessage)i=[[{html:e.statusMessage,className:"error"}]];else{var a=t?Yr.a.REST.makeRestMatrixFromSearchData(e):Yr.a.REST.makeRestMatrixFromData(e,r);i=Yr.a.REST.convertFromRest(a)}n(i,t,(function(e,t){o&&"function"==typeof o&&o(i,e,t)}))},to=function(e,t,n,r,o,i,a){var c,u=t(r),s=e.settings.cacheManager,f=s.get(r);u?((c=l.a.ajax({type:"GET",url:u,data:n(e,r),dataType:"json",global:!1,timeout:5e3})).done((function(e){s.put(r,e)})),f?eo(f,r,o,i,a):(c.done((function(e){eo(e,r,o,i,a)})),c.fail((function(e,t){"timeout"==t&&eo({statusMessage:"Timeout",query:r},r,o,i)})))):o([],r)};function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"!==no(o.a.Confluence)&&(o.a.Confluence={}),void 0===o.a.Confluence.Editor&&(o.a.Confluence.Editor={}),o.a.Confluence.Editor.Autocompleter={Settings:Pr,log:Lr,Util:{dropdownLink:Zr,getRestData:to},Control:Fr,Manager:Gr},Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager",(function(){return Gr})),Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings",(function(){return{Settings:Pr,log:Lr}}));var ro=function(e){e.on("PostRender",(function(){console.log("Autocomplete enabled, adding keyPress listener"),e.on("keypress",Gr.triggerListener,!0),d("ready-editor-autocomplete")})),e.on("Undo",Gr.reattach),e.on("Redo",Gr.reattach)};var oo=n("confluence.web.components:confluence/require('confluence/root')"),io=function(e){return e?"".concat(ye,"/rest/prototype/1/search.json"):U.get("remote-user")?"".concat(ye,"/rest/prototype/1/session/history.json"):null},ao=function(e,t){var n={"max-results":e.maxResults};return t&&(n.query=Object(oo.unescapeEntities)(t),n.search="name",n.preferredSpaceKey=U.get("space-key")),n},co=function(){return Qr("[",{ch:"[",cache:!1,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:!0,getHeaderText:function(){return ge("editor.autocomplete.links.header.text")},getAdditionalLinks:function(e,t,n){var o;if(t){var i=ge("editor.autocomplete.links.dialog.search");o=r.AJS.format(i,t)}else o=ge("editor.autocomplete.links.dialog.search.no.text");var a=r.Confluence.Editor.LinkBrowser,c=[{className:"search-for",name:o,href:"#",callback:function(e){e.replaceWithSelectedSearchText();var t=a.open({panelKey:a.SEARCH_PANEL});t.doSearch(t.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:Zr(ge("editor.autocomplete.links.web.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),a.open({panelKey:a.WEBLINK_PANEL})}}];return n&&n(t,c),c},getDataAndRunCallback:function(e,t,n){to(e,io,ao,t,n,"content",(function(e,t,n){var o;t&&(e.length<2||("page"!==(o=e[1][0].restObj).type||o.space.key!=U.get("space-key")||o.title.toLowerCase()!==t.toLowerCase()))&&n.push({className:"insert-create-page-link",html:Zr(ge("editor.autocomplete.links.create.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var n=Object(oo.unescapeEntities)(t),o=r.Confluence.Link.createLinkToNewPage(n,U.get("space-key"));e.update(o)}})}))},update:function(e,t){t.restObj&&(t=r.Confluence.Link.fromREST(t.restObj)),t&&t.insert()}})},uo=function(e){e.addCommand("mceConfAutocompleteLink",(function(){return Gr.shortcutFired("["),!1})),e.addShortcut("meta+shift+k",e.translate("AutoCompleteLink"),"mceConfAutocompleteLink"),co()},lo=n("com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')"),so=n.n(lo);function fo(){return{init:function(){!function(){function e(e){l()("#autocomplete-dropdown .top-menu-item").spin(e)}function t(){so.a.reset(),so.a.preLoadMacro()}function n(e,t){var n=t.presetMacroMetadata;e.replaceWithSelectedSearchText(),n?so.a.hasRequiredParameters(n)||n.alwaysShowConfig?Pe.macroBrowserToolbarButtonClicked(t):(ke(),Ie.insertMacro({contentId:U.get("content-id")||"0",macro:{name:n.macroName,body:""}})):Pe.macroBrowserToolbarButtonClicked(t)}function r(e){if(e.hidden&&!so.a.isHiddenMacroShown(e))return null;var t={className:"autocomplete-macro-".concat(e.macroName),callback:function(t){n(t,{ignoreEditorSelection:!0,presetMacroMetadata:e})}};return e.icon?(t.name=e.title,t.href="#",t.icon=(e.icon.relative?U.get("static-resource-url-prefix"):"")+e.icon.location):t.html=Zr(e.title),t}Qr("{",{ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return ge("editor.autocomplete.macros.header.text")},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:Zr(ge("editor.autocomplete.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var t=e.text();n(e,{searchText:t})}}]},getDataAndRunCallback:function(n,o,i){var a=so.a.getMetadataPromise(),c=this,u=arguments;function s(e){var t=[];return l()("#macro-insert-list li").each((function(n,o){var i=l()(o),a=e.find((function(e){return e.macroName===i.attr("data-macro-name")}));if(a){var c=r(a);c&&t.push(c)}})),t}function f(e){for(var t=[],o=so.a.searchSummaries(e,{keywordsField:"keywordsNoDesc"}),i=0,a=o.length;i<a;i++){var c=r(o[i]);if(c&&t.push(c)==n.maxResults)break}return t}function m(){var t;t=o?f(o):s(so.a.metadataList),e(!1),i([t],o)}function p(e){e.preventDefault(),e.stopPropagation(),d("analytics",{name:"autocomplete-macrobrowser.load-retry"}),t(),c.getDataAndRunCallback.apply(c,u)}c.alreadyBinded||(c.alreadyBinded=!0,a.always((function(){m(),c.alreadyBinded=!1})),a.fail((function(){d("analytics",{name:"autocomplete-macrobrowser.fail-to-load"}),y.a.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:ge("editor.autocomplete.macros.error.load.header"),body:'<p><a id="macro-retry-link" href="#">'.concat(ge("editor.autocomplete.macros.error.load.retrylink"),"</a></p>")}),l()("#macro-retry-link").click(p),l()("#autocomplete-dropdown ol").eq(1).show()}))),"pending"===a.state()&&(i([],o),e(!0))},update:function(){throw new Error("All items in the Macro Autocomplete dropdown must have a callback function")}})}()},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}var mo=n("com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')"),po=n.n(mo),go=n("confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')"),ho=n.n(go);function vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bo=function(e){var t=U.get("content-id");return e?"".concat(ye,"/rest/prototype/1/search.json"):+t?"".concat(ye,"/rest/prototype/1/content/").concat(t,"/attachments.json"):null},yo=function(e,t){var n=r.AJS.MacroBrowser.getMacroMetadata("view-file")?[]:["image","word","excel","pdf","powerpoint","multimedia"];return t?{type:"attachment",attachmentType:n,search:"name","max-results":e.maxResults,query:t}:{attachmentType:n,"max-results":e.maxResults}},wo=function(){return Qr("!",{ch:"!",cache:!1,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:!0,getHeaderText:function(){return r.AJS.MacroBrowser.getMacroMetadata("view-file")?ge("editor.autocomplete.file.header.text"):ge("editor.autocomplete.media.header.text")},getAdditionalLinks:function(){var e=ge("editor.autocomplete.media.files.dialog.browse");return[{className:"dropdown-insert-image",html:Zr(e,"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.Confluence.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:Zr(ge("editor.autocomplete.media.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(e,t,n){to(e,bo,yo,t,n,"attachment")},update:function(e,t){d("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:t});var n=t.restObj,o=r.AJS.REST.wikiLink(n),i=n&&n.title||t.name;if("Image"==n.niceType){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vo(e,t,n[t])}))}return e}({filename:i,contentId:t.ownerId||n.ownerId},o.params);r.tinymce.confluence.ImageUtils.insertFromProperties(a)}else{var c=!!r.AJS.MacroBrowser.getMacroMetadata("view-file"),u=n.contentType,l="VANILLA"!==U.get("confluence-flavour");if(c&&(l&&!(u&&"application/x-shockwave-flash"===u)||u&&("audio/mp3"===u||"video/mp4"===u)||"Multimedia"!==n.niceType)){var s={name:i,page:n.parentTitle,space:n.space?n.space.key:"",date:n.datePath,ownerId:n.ownerId};po.a.insertFilePlaceholder(s)}else this._insertFile(i,t,o)}},_insertFile:function(e,t,n){var o;switch(t.restObj.niceType){case"PDF Document":o="viewpdf";break;case"Word Document":o="viewdoc";break;case"Excel Spreadsheet":o="viewxls";break;case"PowerPoint Presentation":o="viewppt";break;case"Multimedia":o="multimedia"}var i={page:n.destination.substring(0,n.destination.indexOf("^")),name:e};ho.a.get("viewdoc").beforeParamsRetrieved(i),i.page||delete i.page;var a={contentId:U.get("content-id")||"0",macro:{name:o,params:i,body:""}};r.tinymce.confluence.MacroUtils.insertMacro(a)}})},Co=function(){s("init.rte",(function(){s("rte-autocomplete-on-show",(function(e,t){"!"===t.triggerChar&&d("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})})),s("rte-autocomplete-on-insert",(function(e,t){var n;"!"===t.triggerChar&&(n=t.selectedFile)&&n.name&&d("analytics",{name:"confluence.editor.autocomplete.insert",data:{extension:n.name.split(".").pop(),type:"media"}})}))})),s("rte-destroyed",(function(){f("rte-autocomplete-on-insert"),f("rte-autocomplete-on-show")}))},xo=function(e){e.addCommand("mceConfAutocompleteImage",(function(){return Gr.shortcutFired("!"),!1})),e.addShortcut("meta+shift+m",e.translate("AutoCompleteImage"),"mceConfAutocompleteImage"),wo(),Co()};var ko=function(){return{initContextToolbars:function(){var e,t,n,o,i=r.tinymce.activeEditor,a=Qn(),c="aui-icon aui-icon-small aui-iconfont-",u=r.AJS.storageManager("atlassian.editor","tables"),s=function(e){var t=i.translate(e),n="".concat(e,"_shortcut"),r=i.translate(n);return r&&r!==n&&(t+=" (".concat(r,")")),t},f={Buttons:[new a.Group([new a.Button({text:s("table.row_before_desc"),iconClass:"".concat(c,"insert-row-before"),click:function(){r.tinymce.execCommand("mceTableInsertRowBefore",!1,"")}}),new a.Button({text:s("table.row_after_desc"),iconClass:"".concat(c,"insert-row-after"),click:function(){r.tinymce.execCommand("mceTableInsertRowAfter",!1,"")}}),new a.Button({text:s("table.delete_row_desc"),iconClass:"".concat(c,"remove-row"),click:function(){r.tinymce.execCommand("mceTableDeleteRow",!1,"")}})]),new a.Group([new a.Button({text:s("table.cut_row_desc"),iconClass:"".concat(c,"cut-table-row"),click:function(){r.tinymce.execCommand("mceTableCutRow",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:s("table.copy_row_desc"),iconClass:"".concat(c,"copy-table-row"),click:function(){r.tinymce.execCommand("mceTableCopyRow",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new a.Button({text:s("table.paste_row_before_desc"),iconClass:"".concat(c,"paste-table-row"),click:function(){r.tinymce.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!u.doesContain("copied")})]),new a.Group([new a.Button({text:s("table.col_before_desc"),iconClass:"".concat(c,"insert-column-before"),click:function(){r.tinymce.execCommand("mceTableInsertColBefore",!1,"")}}),new a.Button({text:s("table.col_after_desc"),iconClass:"".concat(c,"insert-column-after"),click:function(){r.tinymce.execCommand("mceTableInsertColAfter",!1,"")}}),new a.Button({text:s("table.delete_col_desc"),iconClass:"".concat(c,"remove-column"),click:function(){r.tinymce.execCommand("mceTableDeleteCol",!1,"")}})]),new a.Group([new a.Button({text:s("table.merge_cells_desc"),iconClass:"".concat(c,"merge-table-cells"),click:function(){r.tinymce.execCommand("mceTableMergeCells",!1,"")}}),new a.Button({text:s("table.split_cells_desc"),iconClass:"".concat(c,"split-merged-table-cells"),click:function(){r.tinymce.execCommand("mceTableSplitCells",!1,"")}})]),new a.Group([new a.Button({text:s("table.row_highlight"),iconClass:"".concat(c,"heading-row"),click:function(){r.tinymce.execCommand("confTableRowToggleHeading",!1),r.tinymce.execCommand("mceTableUpdateNumberingCol",!1)}}),new a.Button({text:s("table.col_highlight"),iconClass:"".concat(c,"heading-column"),click:function(){r.tinymce.execCommand("confTableColumnToggleHeading",!1)}}),new a.Button({text:s("table.numbering_column_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-numbered-column",id:"insert-numbering-column",click:function(){r.tinymce.execCommand("mceTableInsertNumberingCol",!1,"")}})]),new a.SplitGroup([new a.Button({text:s("table.selection_highlight"),iconClass:"".concat(c,"paint-bucket"),click:function(){r.tinymce.execCommand("confTableSelectionToggleHighlight",!1)}})],{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:(e=l()("<ul/>").addClass("table-highlight-picker"),l.a.each(Ge.a.colorValues,(function(t,n){var r=l()("<li/>"),o=l()("<a href='#'></a>"),i=Ge.a.colorNames[n];"clear"===n?o.addClass("remove-highlight").attr("data-remove-highlight","true"):o.addClass("highlight-#".concat(n)).attr("data-highlight-colour","#".concat(n)),o.attr("title",i),o.attr("aria-label",i),o.tooltip(),r.append(o),e.append(r)})),e),alignment:"left"},postProcess:function(e){e.attr("data-highlight-colour","grey"),e.addClass("highlight-grey");var t=l()("<span>&nbsp;</span>");t.addClass("highlight-indicator"),e.find(".icon.aui-iconfont-paint-bucket").after(t)}}),new a.Group([new a.Button({text:s("table.del"),iconClass:"".concat(c,"remove-table"),click:function(){r.tinymce.execCommand("mceTableDelete",!1,"")}})])],Events:er},d=function(e){var t=l()(e).closest("td,th"),n=l()(".mceSelected",t.closest("table"));!function(e){function t(e,t){return parseInt(e.attr(t),10)}return e.filter((function(){var e=l()(this);return t(e,"rowspan")>1||t(e,"colspan")>1})).length>=1}(t.add(n))?i.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split"):i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split")};function m(e){var t=l()(this),n=l()("#table-highlight-group"),r=n.attr("data-highlight-colour"),o=n.attr("data-remove-highlight");r&&(n.removeClass("highlight-".concat(r)),n.removeAttr("data-highlight-colour")),n.removeClass("remove-highlight"),o&&n.removeAttr("data-remove-highlight");var a=t.attr("data-highlight-colour");a&&(n.addClass("highlight-".concat(a)),n.attr("data-highlight-colour",a)),t.attr("data-remove-highlight")&&(n.addClass("remove-highlight"),n.attr("data-remove-highlight","true")),i.focus(!1),i.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0}),e.preventDefault()}return i.on("NodeChange",(function(e){var n,o=e.element,i=l()("body"),a=!i.hasClass("no-tools")||i.hasClass("no-tools-toolbars-visible");t||null==o.parentNode||"BODY"===o.nodeName||(t=!0,n=o,l()(n).closest("table:not(.wysiwyg-macro)").length?(ne(r.document,"createContextToolbarRow.Toolbar",{buttons:f.Buttons,topToolbar:!0,animate:a}),ne(r.document,"enableContextToolbarRow.Toolbar",{id:"default"}),function(e){l.a.fn.updateTableModeInToolbar&&l()(e).closest("table").updateTableModeInToolbar()}(o),d(o),function(e){l()(e).closest("table").find(".numberingColumn").length>0?l()("#insert-numbering-column").addClass("active"):l()("#insert-numbering-column").removeClass("active")}(o)):ne(r.document,"disableContextToolbarRow.Toolbar",{animate:a}),t=!1)})),i.on("Undo",(function(){i.nodeChanged()})),i.initialized?l()(r.document).on("click","#table-highlight-colour .aui-dropdown a",m):i.on("init",(function(){l()(r.document).on("click","#table-highlight-colour .aui-dropdown a",m)})),i.on("Remove",(function(){l()(r.document).off("click","#table-highlight-colour .aui-dropdown a",m)})),f.Buttons.splice(0,0,new a.Group([new a.DropDownButton({id:"table-mode-picker",text:s("table.auto_width"),dropDownContent:(n=l()("<ul/>").addClass("table-mode-list"),o=[{name:s("table.responsive"),mceCmd:"mceAutoWidth",tooltip:s("table.responsive_tooltip")},{name:s("table.fixed_width"),mceCmd:"mceFixedWidth",tooltip:s("table.fixed_width_tooltip")}],l.a.each(o,(function(e,t){var o=l()("<li/>").addClass("dropdown-item").attr("data-tooltip",t.tooltip),i=l()('<a href="#">'.concat(t.name,"</a>")).addClass("item-link");o.on("click",(function(){r.tinymce.execCommand(t.mceCmd,!1,"")})),n.append(o.append(i))})),n)})])),E("confluence-table-enhancements.copy-cut-paste-cols.disabled")||f.Buttons.splice(3,0,new a.Group([new a.Button({text:s("table.col_cut_desc"),iconClass:"".concat(c,"cut-table-column"),click:function(){r.tinymce.execCommand("mceTableCutCol",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:s("table.col_copy_desc"),iconClass:"".concat(c,"copy-table-column"),click:function(){r.tinymce.execCommand("mceTableCopyCol",!1,""),i.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new a.Button({text:s("table.col_paste_desc"),iconClass:"".concat(c,"paste-table-column"),click:function(){r.tinymce.execCommand("mceTablePasteColBefore",!1,"")},disabled:!u.doesContain("copied")})])),f}}};function So(){var e=function(e){this.fileTypes=e};e.prototype.beforeParamsSet=function(e){if(!e.page&&!e.date&&!e.space){var t=U.get("content-type");"page"==t||"blogpost"==t?e.page=r.document.getElementById("content-title").value:"comment"==t&&(e.page=U.get("page-title"))}if(e.date){var n=e.date.split("/");e.page=["",n[2],n[0],n[1],e.page].join("/")}return e.space&&(e.page="".concat(e.space,":").concat(e.page)),e},e.prototype.beforeParamsRetrieved=function(e){if(e.page){var t=e.page.split(":");t.length>1&&(e.space=t[0],e.page=t[1]);var n=e.page.split("/");n.length>1&&(e.date=[n[2],n[3],n[1]].join("/"),e.page=n[4]);var o=U.get("content-type");(("page"==o||"blogpost"==o)&&e.page==r.document.getElementById("content-title").value||"comment"==o&&e.page==U.get("page-title"))&&delete e.page}return e},e.prototype.fields={attachment:function(e){var t={fileTypes:this.fileTypes},n=r.AJS.MacroBrowser.ParameterFields.attachment(e,t);return n.dependencyUpdated=function(e,t){var n,o,i=(n={},o=t.split(":",2),n.spaceKey=2==o.length&&o[0]||U.get("space-key"),n.title=o[o.length-1],0==n.title.indexOf("/")&&(n.postingDay=n.title.substr(1,10),n.title=n.title.substr(12)),n.title==r.document.getElementById("content-title").value&&(n.title=""),n.title||(U.get("new-page")?n.draftId=U.get("content-id"):n.pageId=U.get("page-id")),n);this.getData(i)},n},spacekey:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},date:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},"confluence-content":function(e){return r.AJS.MacroBrowser.ParameterFields["confluence-content"](e,{dependencies:["name"]})}},r.AJS.MacroBrowser.Macros.viewdoc=new e(["doc","docx"]),r.AJS.MacroBrowser.Macros.viewpdf=new e(["pdf"]),r.AJS.MacroBrowser.Macros.viewxls=new e(["xls","xlsx"]),r.AJS.MacroBrowser.Macros.viewppt=new e(["ppt","pptx"]),r.AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(e){var t=e.params[""]||e.params.name;if(t){var n=t.lastIndexOf(".");if(n>0){var r=t.substring(n+1);r&&("doc"==r&&"docx"==r&&(e.name="viewdoc"),"pdf"==r&&(e.name="viewpdf"),"ppt"==r&&"pptx"==r&&(e.name="viewppt"),"xls"==r&&"xlsx"==r&&(e.name="viewxls"))}}}}}var To,Eo,_o,Ao,No=n("./src/editor-plugins/status-macro/editor-content.scss"),Ro=n.n(No),Oo=(n("./src/editor-plugins/status-macro/styles.scss"),["Grey","Red","Yellow","Green","Blue"]),Do=Oo[0];function Io(){Po();var e=r.Confluence.MacroParameterSerializer.deserialize(l()(Eo).attr("data-macro-parameters")),t=!1,n=!1;return e&&_o&&(t=e.title!==_o.title,n=e.colour!==_o.colour),t||n}function Po(){if(Ao){var e=Mo(_o)==Ao.val(),t=""===Ao.val();e||t?delete _o.title:_o.title=Ao.val()}}function Bo(){if(!To||!To.state||"pending"!==To.state()){Po();var e={contentId:r.Confluence.Editor.getContentId(),macro:{name:"status",params:_o,defaultParameterValue:"",body:""}};(To=r.tinymce.confluence.MacroUtils.insertMacro(e,Eo)).done((function(e){var t;t=Eo=e,r.tinymce.activeEditor.selection.select(t),ke(),r.tinymce.activeEditor.selection.collapse()})).fail((function(e){0}))}}function Mo(e){return e.colour||e.color||Do}function Lo(){var e=l()("<input/>");return e.attr("class","status-macro-title first last editable"),e.keyup((function(e){return 13!==e.keyCode||(r.Confluence.PropertyPanel.destroy(),!1)})),e.keydown((function(e){return 27!==e.keyCode||(Ao=null,!0)})),e}function Fo(e){(Ao=Lo()).val(e.find("span.panel-button-text").text()),e.replaceWith(Ao),Ao.select().focus()}function jo(e){e.on("init",(function(){Ro.a.use()}))}var Ho=n("./src/editor-plugins/theme-atlassian/editor-content.scss"),Uo=n.n(Ho);function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Vo(e,t,n[t])}))}return e}function Wo(e){return(Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $o=function(e,t){if("number"==typeof e)return e;if("string"==typeof e&&/^\d+/.test(e))try{return parseInt(e)}catch(e){return t}return t},Ko=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Vo(this,"scope",void 0),Vo(this,"listeners",void 0),Vo(this,"inDispatch",void 0),this.inDispatch=!1,this.scope=t||this,this.listeners=[]}var t,n,o;return t=e,(n=[{key:"add",value:function(e,t){return this.listeners.push({cb:e,scope:t||this.scope}),e}},{key:"addToTop",value:function(e,t){var n={cb:e,scope:t||this.scope};return this.inDispatch?this.listeners=[n].concat(this.listeners):this.listeners.unshift(n),e}},{key:"remove",value:function(e){var t=this.listeners,n=null;return r.tinymce.each(t,(function(r,o){if(e==r.cb)return n=r,t.splice(o,1),!1})),n}},{key:"dispatch",value:function(){var e,t,n,r=this,o=arguments,i=r.listeners;for(r.inDispatch=!0,t=0;t<i.length&&!1!==(n=(e=i[t]).cb.apply(e.scope,o.length>0?o:[e.scope]));t++);return r.inDispatch=!1,n}}])&&qo(t.prototype,n),o&&qo(t,o),e}();function Jo(e){return"object"===Wo(e)&&e.name}function Go(e,t){return"string"==typeof t?e.queryCommandState(t):!!Jo(t)&&e.queryCommandState(t.name)}function Xo(e){this.init=this.init(e)}function Yo(e){var t={},n={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote",help:"mceConfShortcutDialog"},o=["bold","italic","underline","bullist","numlist","tasklist","justifyleft","justifycenter","justifyright","strikethrough","sub","sup","monospace"];function i(e){var n=e.undoManager;t.buttons.state.dispatch("undo","disabled",!n.hasUndo()&&!n.typing),t.buttons.state.dispatch("redo","disabled",!n.hasRedo())}function a(t){var r=e.ui.registry.getAll().buttons[t];if(!r)return!1;r.cmd?n[t]=r.cmd:n[t]={func:r.onAction,name:t}}function c(){r.tinymce.each(r.tinymce.explode(e.settings.theme_advanced_buttons1),(function(n){if(!a(n))switch(n){case"formatselect":t.formatselect={},t.formatselect.state=new Ko,t.formatselect.click=new Ko,t.formatselect.click.add((function(t){e.execCommand("FormatBlock",!1,t)}))}})),t.buttons={},t.buttons.state=new Ko,t.buttons.click=new Ko,t.buttons.click.add((function(t){var r=n[t];"string"===Wo(r)?e.execCommand(n[t]):Jo(r)&&r.func()})),function(){var t={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,weight:1/0,onclick:null},n=e.ui.registry.getAll().buttons,r=[];for(var o in n)r.push(zo({},t,n[o],{id:o,weight:$o(n[o].weight,1/0)}));r=r.filter((function(e){return!!e.locationGroup})),["toolbar-primary"].forEach((function(e){var t=l()(".".concat(e));r.filter((function(t){return t.toolbar===e})).sort((function(e,t){return e.weight-t.weight})).forEach((function(e){a(e.id);var n,r=t.find(".".concat(e.locationGroup)),o=l()('<li id="'.concat((n=e).id,'" class="toolbar-item ').concat(n.className,'" data-tooltip="').concat(n.tooltip,'" data-weight="').concat(n.weight,'">\n                            <a class="toolbar-trigger aui-button aui-button-subtle" href="#" data-control-id="').concat(n.id,'">\n                                <span class="icon ').concat(n.icon,'"></span>\n                                <span class="trigger-text">').concat(n.title,"</span>\n                            </a>\n                        </li>"));r.append(o).removeClass("hidden")}))}))}()}var u=Xo.shouldInit();return u&&Xo.suppressIncompatiblePlugins(),e.on("init",(function(){c(),e.settings.readonly||(e.on("NodeChange",(function(a){!function(e,a){r.tinymce.each(o,(function(r){t.buttons.state.dispatch(r,"active",!!Go(e,n[r]))})),i(e),t.buttons.state.dispatch("outdent","disabled",!Go(e,"Outdent"));var c=function(e){for(var t=a.parents,n=0;n<t.length;n++)if(e(t[n]))return t[n]}(e.dom.isBlock);c&&t.formatselect.state.dispatch(c.nodeName.toLowerCase())}(e,{parents:a.parents})})),e.on("keyup",(function(){i(e)})),e.on("MouseUp",(function(){i(e)})),e.dom.bind(e.dom.getRoot(),"dragend",(function(){i(e)})),u&&new Xo(e)),Uo.a.use()})),{controlHandlers:t}}Xo.INCOMPATIBLE_PLUGINS=["dfe"],Xo.shouldInit=function(){var e=l()("body");return e.hasClass("edit")||e.hasClass("create")||e.hasClass("copy-page")},Xo.suppressIncompatiblePlugins=function(){for(var e=function(){},t=0,n=Xo.INCOMPATIBLE_PLUGINS.length;t<n;t++)r.tinymce.PluginManager.lookup[Xo.INCOMPATIBLE_PLUGINS[t]]=e},Xo.prototype.init=function(e){var t=r.tinymce.util.VK,n=l()("#content-title"),i=l()("form.editor"),a=l()(e.getBody()),c=l()(e.getDoc()),u=l()("#editor-precursor"),s=l()(e.getWin()),f=l()("#toolbar"),d=c.scrollTop(),m=parseInt(a.css("padding-top"),10)+parseInt(a.css("margin-top"),10),p=parseInt(u.css("padding-top"),10),g=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;function h(t){var n=this;e.plugins.customtoolbar.toggleToolbarButtons(t,t,t,(function(){return!l()(n).parent().hasClass("close")}))}function v(e){return e.getBoundingClientRect().top+document.body.scrollTop}function b(){var e=d-c.scrollTop(),t=v(f[0])-v(i[0]),n=u.outerHeight(),r=f.outerHeight();u.css("top","".concat(t+r+e+p,"px")),a.css("padding-top","".concat(n+m,"px"))}return n.on("keydown",(function(n){var r=n.keyCode||n.which;r!==t.ENTER&&r!==t.DOWN||(n.preventDefault(),n.stopPropagation(),e.focus(!1))})).on("focus click",(function(){h(!0)})),s.on("focus",(function(){h(!1)})),function(e){!function t(){e(t),b()}(),a.on("scroll mousewheel",(function(){setTimeout(b,0)}))}(g),!0};function Qo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Zo(e,t,n[t])}))}return e}function Zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ei=["Next Issue","Previous Issue","Click for more info","Ignore","Repair"],ti=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ed=t,Zo(this,"handleClick",(function(e){n.processAnalytics(e)})),Zo(this,"handleKeyDown",(function(e){r.tinymce.util.VK.SPACEBAR!==e.keyCode&&r.tinymce.util.VK.ENTER!==e.keyCode||n.processAnalytics(e)})),Zo(this,"handleReport",(function(){var e=n.ed.plugins.a11ychecker.getReport(),t={};e.forEach((function(e){t.hasOwnProperty(e.id)?t[e.id]++:t[e.id]=1})),d("analytics",{name:"confluence.editor.a11ychecker.issues",data:Qo({pageId:U.get("page-id"),warning:e.filter((function(e){return"warning"===e.severity})).length,error:e.filter((function(e){return"error"===e.severity})).length,contentType:U.get("content-type")},t)})})),Zo(this,"processAnalytics",(function(e){var t=e.target.closest(".tox-button");if(t){var r=ei.find((function(e){return t.getAttribute("title")===n.ed.translate(e)}));r&&d("analytics",{name:"confluence.editor.a11ychecker.dialog.item.click",data:{item:r,pageId:U.get("page-id"),contentType:U.get("content-type")}})}}))},ni=n("./src/editor-plugins/a11ychecker/editor-content.scss"),ri=n.n(ni);function oi(e){var t=e.translate("a11ychecker.btn_tooltip"),n=new ti(e);e.on("init",(function(){ri.a.use();var r=l()('<li id="'.concat("a11y-check-btn",'" class="toolbar-item aui-button aui-button-subtle" data-tooltip="').concat(t,'">\n                            <a class="toolbar-trigger" href="#" data-control-id="').concat("a11y-check-btn",'" aria-label="').concat(t,'">\n                                <span class="tox-icon tox-tbtn__icon-wrap">\n                                    ').concat('<svg width="18" height="18">\n                                <path fill-rule="nonzero" d="M9 1c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm6 7h-3v8a1 1 0 01-2 0v-3a1 1 0 00-2 0v3a1 1 0 01-2 0V8H3a1 1 0 110-2h12a1 1 0 010 2z"></path>\n                             </svg>',"\n                                </span>\n                            </a>\n                        </li>"));r.on("click",(function(t){t.preventDefault(),t.currentTarget.classList.contains("disabled")||(n.handleReport(),e.plugins.a11ychecker.toggleaudit())})),U.get("content-type").indexOf("question")>0?r.insertAfter(l()("#rte-button-insert-code")):l()(".rte-toolbar-group-undo").prepend(r)})),e.on("OpenWindow",(function(){l()(".tox-dialog").on("click",n.handleClick).on("keydown",n.handleKeyDown)}))}var ii=[function(){var e;function t(){}function n(t){!e&&o.a&&o.a.console&&(e=!0,console.log("Deprecated TinyMCE API call: ".concat(t)))}function i(e,r,o,i){e=e||this;var a=[];r?(this.add=function(t,c,u){function l(n){var a=[];if("string"==typeof o&&(o=o.split(" ")),o&&"function"!=typeof o)for(var u=0;u<o.length;u++)a.push(n[o[u]]);("function"!=typeof o||(a=o(r,n,e)))&&(o||(a=[n]),a.unshift(i||e),!1===t.apply(c||i||e,a)&&n.stopImmediatePropagation())}n("<target>.on".concat(r,".add(..)")),e.on(r,l,u);var s={original:t,patched:l};return a.push(s),l},this.addToTop=function(e,t){this.add(e,t,!0)},this.remove=function(t){return a.forEach((function(n,o){if(n.original===t)return a.splice(o,1),e.off(r,n.patched)})),e.off(r,t)},this.dispatch=function(){return e.fire(r),!0}):this.add=this.addToTop=this.remove=this.dispatch=t}function a(e){function o(t,n){r.tinymce.each(t.split(" "),(function(t){e["on".concat(t)]=new i(e,t,n)}))}function a(e,t,n){return[t.level,n]}function c(e){return function(t,n){if(!n.selection&&!e||n.selection==e)return[n]}}if(!e.controlManager){e.controlManager={buttons:{},setDisabled:function(e,t){n("controlManager.setDisabled(..)"),this.buttons[e]&&this.buttons[e].disabled(t)},setActive:function(e,t){n("controlManager.setActive(..)"),this.buttons[e]&&this.buttons[e].active(t)},onAdd:new i,onPostRender:new i,add:function(e){return e},createButton:u,createColorSplitButton:u,createControl:u,createDropMenu:u,createListBox:u,createMenuButton:u,createSeparator:u,createSplitButton:u,createToolbar:u,createToolbarGroup:u,destroy:t,get:t,setControlType:u},o("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),o("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),o("BeforeExecCommand ExecCommand","command ui value args"),o("PreProcess PostProcess LoadContent SaveContent Change"),o("BeforeSetContent BeforeGetContent SetContent GetContent",c(!1)),o("SetProgressState","state time"),o("VisualAid","element hasVisual"),o("Undo Redo",a),o("NodeChange",(function(t,n){return[e.controlManager,n.element,e.selection.isCollapsed(),n]}));e.addButton;e.addButton=function(t,n){var o,i,a;n.title&&(n.text=(o=n.title,i=[e.settings.language||"en",o].join("."),a=r.tinymce.i18n.translate(i),i!==a?a:r.tinymce.i18n.translate(o))),n.cmd&&(n.onAction=function(){ed.execCommand(n.cmd)}),e.ui.registry.addButton(t,n)},e.on("init",(function(){var t=e.undoManager,n=e.selection;t.onUndo=new i(e,"Undo",a,null,t),t.onRedo=new i(e,"Redo",a,null,t),t.onBeforeAdd=new i(e,"BeforeAddUndo",null,t),t.onAdd=new i(e,"AddUndo",null,t),n.onBeforeGetContent=new i(e,"BeforeGetContent",c(!0),n),n.onGetContent=new i(e,"GetContent",c(!0),n),n.onBeforeSetContent=new i(e,"BeforeSetContent",c(!0),n),n.onSetContent=new i(e,"SetContent",c(!0),n)})),e.on("BeforeRenderUI",(function(){var t=e.windowManager;t.onOpen=new i,t.onClose=new i,t.createInstance=function(e,t,o,i,a,c){return n("windowManager.createInstance(..)"),new(r.tinymce.resolve(e))(t,o,i,a,c)}})),e.getLang=function(t,n){return e.editorManager.i18n.data[(e.settings.language||"en")+"."+t]||(void 0!==n?n:"{#"+t+"}")}}function u(){var e={};function t(){return u()}return n("editor.controlManager.*"),r.tinymce.each("add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update".split(" "),(function(n){e[n]=t})),e}}r.tinymce.util.Dispatcher=i,r.tinymce.onBeforeUnload=new i(r.tinymce,"BeforeUnload"),r.tinymce.onAddEditor=new i(r.tinymce,"AddEditor","editor"),r.tinymce.onRemoveEditor=new i(r.tinymce,"RemoveEditor","editor"),r.tinymce.util.Cookie={get:t,getHash:t,remove:t,set:t,setHash:t},r.tinymce.on("SetupEditor",(function(e){a(e.editor)})),r.tinymce.PluginManager.add("compat3x",a),r.tinymce.addI18n=function(e,t){var n=r.tinymce.util.I18n,o=r.tinymce.each;if("string"!=typeof e||-1!==e.indexOf("."))if(n.data=n.data||{},r.tinymce.is(e,"string"))if(r.tinymce.is(t,"string")){var i=e.split("."),a=i.shift(),c={};c[i.join()]=t,n.add(a,c)}else o(t,(function(t,r){n.data["".concat(e,".").concat(r)]=t;var o=e.split("."),i=o.shift();o.push(r);var a={};a[o.join(".")]=t,n.add(i,a)}));else o(e,(function(e,t){o(e,(function(e,r){o(e,(function(e,o){var i={};"common"===r?(n.data["".concat(t,".").concat(o)]=e,i[o]=e):(n.data["".concat(t,".").concat(r,".").concat(o)]=e,i["".concat(r,".").concat(o)]=e),n.add(t,i)}))}))}));else n.add(e,t)}},function(){r.tinymce.PluginManager.add("atlassiantheme",Yo)},function(){s("init.rte",T)},function(){r.tinymce.PluginManager.add("aePaste",re)},function(){r.tinymce.create("tinymce.plugins.ConfList",{init:function(e){e.editorCommands.addCommands({outdent:function(){var t=e.selection,n=e.dom;function r(t){var r=n.getParent(t,n.isBlock);return r&&parseInt(e.dom.getStyle(r,"margin-left",!1)||0,10)+parseInt(e.dom.getStyle(r,"padding-left",!1)||0,10)>0}return r(t.getStart())||r(t.getEnd())||e.queryCommandState("InsertOrderedList")||e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertInlineTaskList")}},"state")}}),r.tinymce.PluginManager.add("conflist",r.tinymce.plugins.ConfList)},function(){r.tinymce.PluginManager.add("tasklist",(function(e){var t=function(){var t=Le(e);t&&function(t){var n=e.dom.getParent(t.parentElement,"UL");return t&&"UL"===t.tagName&&n&&n.classList.contains("inline-task-list")&&t!=n}(t)&&function(e){return Array.from(e.childNodes).every((function(e){return e.hasAttribute("data-inline-task-id")}))}(t)&&e.undoManager.ignore((function(){t.classList.add("inline-task-list")}))},n=function(){return"page"!==U.get("content-type")&&"blogpost"!==U.get("content-type")&&"template"!==U.get("content-type")||e.undoManager.transact((function(){je(Le(e))&&(e.execCommand("InsertOrderedList"),He(Le(e))),function(e){var t=e.dom.uniqueId();e.execCommand("InsertUnorderedList",!1,{"list-attributes":{"data-task-list-id":t,class:"inline-task-list"},"list-item-attributes":{"data-inline-task-id":""}}),e.dom.select('[data-task-list-id="'.concat(t,'"]')).forEach((function(t){var n=t.querySelectorAll("li")[0];n&&e.dom.isEmpty(t)&&(n.innerHTML='<span class="placeholder-inline-tasks">'.concat(ge("tinymce.confluence.placeholder.inline.tasks"),"</span>"),e.selection.select(n.firstChild,!0)),t.removeAttribute("data-task-list-id")}))}(e)})),!1};function o(t,n){if(!Ue()){var r=n.handlerManager,o=n.createHandler;r.registerHandler("]".charCodeAt(0),o(Me,(function(){e.execCommand("InsertInlineTaskList")}),!0))}}function i(){e.addQueryStateHandler("InsertInlineTaskList",(function(){return Fe(Le(e))})),e.addQueryStateHandler("InsertUnorderedList",(function(){return je(Le(e))}))}function a(t,n,r){if(Ue()){var o=e.dom.createFragment("");o.appendChild(r.node),Array.prototype.slice.call(o.querySelectorAll("ul.inline-task-list, ol.inline-task-list")).forEach((function(e){return He(e)}))}}e.addCommand("InsertInlineTaskListNoToggle",(function(){return Fe(Le(e))||n(),!1})),e.addCommand("InsertInlineTaskList",n),e.on("BeforeExecCommand",(function(t){"InsertUnorderedList"===t.command&&Fe(Le(e))&&!t.value?e.undoManager.ignore((function(){e.execCommand("InsertOrderedList"),He(Le(e))})):"InsertOrderedList"!==t.command||t.value||e.undoManager.ignore((function(){He(Le(e))}))})),e.on("execCommand",(function(e){"Indent"===e.command&&t()})),e.on("Click",(function(t){var n=t.target;if("LI"===n.tagName){var o=e.dom.getParent(n,"ul,ol");"UL"===o.tagName&&e.dom.hasClass(o,"inline-task-list")&&function(t,n){var o,i;if(r.tinymce.Env.gecko){var a=n.getBoundingClientRect();o=t.pageX-(a.left+r.tinymce.DOM.getViewPort(e.getWin()).x),i=t.pageY-(a.top+r.tinymce.DOM.getViewPort(e.getWin()).y)}else o=t.offsetX,i=t.offsetY;return o>=3&&o<=14&&i>=3&&i<=14}(t,n)&&(e.dom.hasClass(n,"checked")?e.dom.removeClass(n,"checked"):e.dom.addClass(n,"checked"))}})),e.on("KeyUp",(function(t){if(t.keyCode===r.tinymce.util.VK.ENTER&&!t.shiftKey){var n=(o=e.selection.getStart())&&o.tagName&&"LI"===o.tagName.toUpperCase()?o:e.dom.getParent(o,"li");if(n){if(e.dom.removeClass(n,"checked"),!n.parentNode)return;e.dom.hasClass(n.parentNode,"inline-task-list")?n.setAttribute("data-inline-task-id",""):n.removeAttribute("data-inline-task-id")}}var o})),e.on("KeyDown",(function(e){e.shiftKey||e.keyCode!==r.tinymce.util.VK.TAB||r.tinymce.util.VK.metaKeyPressed(e)||t()})),s("confluence.editor.registerHandlers",o),s("rte-ready",i),ee(r.document,"postPaste",a),e.on("Remove",(function(){f("confluence.editor.registerHandlers",o),f("rte-ready",i),te(r.document,"postPaste",a)}))}))},function(){s("init.rte",Ut)},function(){r.tinymce.create("tinymce.plugins.DeleteCommandPlugin",{init:function(e){e.addCommand("mceDelete",(function(t,n){return function(){if(r.tinymce.Env.webkit){var t=e.selection.getRng();if(!t||t.collapsed)return!1;var n=l()(t.startContainer).closest(".wysiwyg-macro-body",e.getBody())[0];if(n&&x.isRangeAtStartOf(n,t)&&x.isRangeAtEndOf(n,t)){var o=l()(n.firstChild).is("pre")?"pre":"p",i=l()("<".concat(o,'><br data-mce-bogus="1"></').concat(o,">"))[0];return l()(n).html(i),e.selection.select(i,!0),!0}}return!1}()||e.getDoc().execCommand("Delete",t),!1}))},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("deletecommand",r.tinymce.plugins.DeleteCommandPlugin)},function(){},function(){var e,t,n=(e=o.a.Raphael,t=new r.tinymce.util.Dispatcher,{AUIWindowManager:{init:function(e){e.on("init",(function(){e.windowManager=new r.tinymce.AUIWindowManager(e)}))},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},WindowManager:{AUIWindowManager:function(e){var n=this;n.eventDispatcher=t,n.editor=e,n.params={},n.features={},n.modalDialogsStack=[],n.dialogs={},n.count=0,n.tinymceWM=e.windowManager},open:function(e,t){var n=this;if(e.title===n.editor.translate("Accessibility Checker"))return n.tinymceWM.open(e,t);e=e||{},n.initialiseSettings(e),t=t||{},(t=this.setDefaultParameters(t)).mce_width=e.width,t.mce_height=e.height,t.mce_auto_focus=e.auto_focus,n.features=e,n.params=t,n.eventDispatcher.dispatch("open",{t:n,settings:e,params:t});var o=e.height;e.name&&(o+=56),(t.cancelLink||t.buttons)&&(o+=51),o+=40,e.popup&&(o+=8);var i=e.id||r.tinymce.DOM.uniqueId(),a=(new Yn).component({width:e.width,height:o,id:i,onCancel:function(){a.hide().remove()}});e.name&&a.addHeader(this.editor.translate(e.name)),this.createDialogButtons(a,t,i),e.file=e.file||e.url,e.file&&(e.file=e.file),this.createDialogContent(a,e,t,i),t.helpLink&&this.createHelpLink(a,t.helpLink,t.helpName,i),t.hintText&&this.createHintText(a,t.hintText,i);var c={id:i,settings:e,params:t,dialog:a};return this.modalDialogsStack.push(c),this.dialogs[i]=c,this.count++,ke(),a.show(),null!=a.takeFocus&&a.takeFocus(),i},initialiseSettings:function(e){e.width=parseInt((e.width||400).toString(),10),e.height=parseInt((e.height||250).toString(),10),e.resizable=!1,null==e.popup&&(e.popup=!0),e.popup&&null!=e.content&&(e.popup=!1),e.scrollbars?e.scrollbars="yes":e.scrollbars="no"},createDialogButtons:function(e,t,n){if(t.buttons)for(var o=0;o<t.buttons.length;o++){var i=t.buttons[o];e.addButton(this.editor.translate("".concat(i.label)),i.action)}t.cancelLink&&e.addCancel(this.editor.translate("auiwindowmanager.cancel"),(function(){return r.tinymce.activeEditor.windowManager.close(n)}))},createDialogContent:function(e,t,n,r){var o=this.createContentId(r),i="panel_".concat(o);t.popup?(e.addPanel(i,l()('<iframe id="'.concat(o,'" width="100%" height="').concat(t.height,'px" frameborder="0" name="auidialogiframe" src="').concat(t.file,'" scrolling="').concat(t.scrollbars,'"></iframe>')),n.cssClass),e.takeFocus=function(){l()("#".concat(o)).focus()}):(null==t.content?(e.addPanel(i,l()('<div id="'.concat(o,'"/>')),n.cssClass),l()("#".concat(o)).load(t.file)):e.addPanel(i,l()('<div id="'.concat(o,'">').concat(t.content,"</div>")),n.cssClass),e.takeFocus=function(){var e=l()("#".concat(o,":input"));if(e.length)l()(e[0]).focus();else{var t=l()("#".concat(o," .button-panel button"));t.length&&l()(t[0]).focus()}}),e.gotoPanel(0,0)},createHintText:function(e,t,n){var o=l()("<div></div>").addClass("dialog-tip");o.text(r.tinymce.activeEditor.translate("".concat(t))),l()("#".concat(n," .dialog-button-panel")).append(o)},createHelpLink:function(e,t,n,r){var o=l()("<div></div>").addClass("dialog-help-link");o.load("".concat(ye,"/plugins/tinymce/helplink.action"),{linkUrlKey:t,linkNameKey:n||""}),l()("#".concat(r," .dialog-components .dialog-title")).prepend(o)},close:function(e,t){var n,o;return"string"==typeof e?n=e:t?n=t:(o=this.modalDialogsStack.pop())&&(n=o.id),this.dialogs[n]&&(this.count--,(o=this.dialogs[n]).dialog.remove(),this.dialogs[n]=null,r.tinymce.activeEditor.focus(),Se()),!1},alert:function(e,t,n){if("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."!==e){var o,i={content:"<p>".concat(e,"</p>"),width:500,height:160,popup:!1},a={buttons:[{label:"auiwindowmanager.ok",action:function(){r.tinymce.activeEditor.windowManager.toggleOtherDialogs(o,!0),r.tinymce.activeEditor.windowManager.close(o),t&&t.call(n||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"};o=this.open(i,a),this.toggleOtherDialogs(o,!1)}},createInstance:function(e,t,n,o,i,a){return new(r.tinymce.resolve(e))(t,n,o,i,a)},toggleOtherDialogs:function(e,t){for(var n=0;n<this.modalDialogsStack.length;n++){var r=this.modalDialogsStack[n];r.id!=e&&l()("".concat(r.id," .dialog-button-panel")).toggle(t)}},confirm:function(e,t,n,r){r=r||o.a,t.call(n||this,r.confirm(this._decode(this.editor.translate(e))))},setBusy:function(t,n){var r=this.dialogs[t],o="#".concat(this.createBusyContentId(t)),i="#".concat(this.createContentId(t)),a=l()(i),c=l()(o);if(r)if(n){var u=l()(i);u.hide();var s=u.parent(),f=l()(o,s);f.length||(s.append(l()('<div id="'.concat(o,'" class="spinner"></div>'))),f=l()(o,s),e.spinner(f[0],50,"#666")),l()(".button-panel button",l()("#".concat(t))).each((function(e,t){l()(t).prop("disabled",!0)})),l()(f[0]).show()}else c.length&&c.hide(),l()(".button-panel button",l()("#".concat(t))).each((function(e,t){l()(t).prop("disabled",!1)})),a.show()},logMCESelection:function(e){r.tinymce.activeEditor.selection},setDefaultParameters:function(e){return e.inline=!1,e.cssClass||(e.cssClass="tinymce-auidialog"),0!=e.cancelLink&&(e.cancelLink=!0),e},createContentId:function(e){return"content_".concat(e)},createBusyContentId:function(e){return"content_busy_".concat(e)},resizeBy:function(){}}});r.tinymce.create("tinymce.plugins.AUIWindowManager",n.AUIWindowManager),r.tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",n.WindowManager),r.tinymce.PluginManager.add("auiwindowmanager",r.tinymce.plugins.AUIWindowManager)},function(){var e;e=he(),r.Confluence.PropertyPanel.TextPlaceholder=e,s("init.rte",(function(){"template"===U.get("content-type")&&d("add-handler.property-panel",e)})),r.tinymce.create("tinymce.plugins.TextPlaceholderPlugin",ve()),r.tinymce.PluginManager.add("textplaceholders",r.tinymce.plugins.TextPlaceholderPlugin)},function(){r.tinymce.create("tinymce.plugins.EmotionsPlugin",{init:function(e,t){e.addCommand("mceEmotion",(function(){return e.windowManager.open({file:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/emotions.action"),width:190,height:125,inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:t}),!1})),e.ui.registry.addButton("emotions",{text:"emotions.emotions_desc",onAction:function(){e.execCommand("mceEmotion")}}),e.on("Click",(function(t){var n,o=t.target;if("IMG"===o.nodeName&&o.classList.contains("emoticon"))return(n=e.selection.getRng())&&((t.offsetX||t.layerX-o.x)<o.width/2?(n.setStartBefore(o),n.setEndBefore(o)):(n.setStartAfter(o),n.setEndAfter(o)),e.selection.setRng(n)),e.selection.collapse(),r.tinymce.dom.Event.cancel(t)}))},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("emotions",r.tinymce.plugins.EmotionsPlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluencePlugin",{init:function(e){e.addCommand("mceConfUnlink",(function(t,n){var o=e.selection,i=n||o.getNode(),a=l()(i);if("A"!==i.nodeName){var c=a.closest("a");if(!c.length)return!1;i=c[0],a=c}var u,s,f=a.attr("href");if(f||(f="#",a.attr("href",f)),!a.attr("data-linked-resource-id")&&r.Confluence.Link.isExternalLink(f)&&a.text()==(null!=(s=/(.*)[\/]$/.exec(u=f))?s[1]:u)){var d=e.dom.create("span",{class:"nolink"},f);e.dom.replace(d,i,!1)}else o.select(i),a.removeClass("createlink unresolved"),e.execCommand("UnLink");return!1})),e.ui.registry.addButton("confimage",{text:"confluence.confimage_desc",onAction:function(){e.execCommand("mceConfimage")}}),e.ui.registry.addButton("conf_macro_browser",{text:"confluence.conf_macro_browser_desc",onAction:function(){e.execCommand("mceConfMacroBrowser")}})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluence",r.tinymce.plugins.ConfluencePlugin)},function(){var e;r.tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",(e=r.tinymce.util.VK,{init:function(t){var n=this;function o(e){t.on("KeyDown",e),r.tinymce.isGecko&&(t.on("KeyPress",e),t.on("KeyUp",e))}function i(e,t){return e&&1===e.childNodes.length&&l()(e).is(t)&&l()(e.firstChild).is("br")}function a(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;if(!t||!t.parentNode)return!1;for(;t&&!l()(t).is(".wysiwyg-macro-body");){if(t.previousSibling||t.nextSibling)return!1;t=t.parentNode}return!0}t.on("Init",(function(){t.on("SetContent",(function(e){e.selection&&r.tinymce.each(t.dom.select("p > .wysiwyg-macro"),(function(e){var n=t.dom.getParent(e.parentNode,"p");try{t.dom.split(n,e)}catch(e){}}))}))})),t.on("SetContent",(function(){r.tinymce.each(t.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),(function(e){t.dom.select("pre",e).length||(r.tinymce.isIE?t.dom.setHTML(e,"<pre></pre>"):t.dom.setHTML(e,"<pre><br /></pre>"))}))})),t.on("KeyDown",(function(n){var o=t.selection,i=[e.BACKSPACE,e.DELETE,e.ENTER,e.ESCAPE];if(-1==l.a.inArray(n.keyCode,i)&&!function(t){var n=!1;return 0===t.charCode&&(n=-1!=l.a.inArray(t.keyCode,[e.SHIFT,e.CTRL,e.ALT,e.META])),n}(n)&&!o.isCollapsed()&&!(n.ctrlKey||n.metaKey||!r.tinymce.isMac&&n.altKey)){var a=o.getNode();if(Pe.isMacroWithBody(a)){var c=l()(".wysiwyg-macro-body",a);c.length>0&&o.select(c[0],!0)}}})),t.on("DblClick",(function(e){var t=l()(e.target),n=t.closest("[data-macro-name]");if(n.length){if(n.attr("data-macro-body-type"))if(r.tinymce.isIE){if(!t.hasClass("wysiwyg-macro-body")&&!t.hasClass("wysiwyg-macro"))return}else if(t.closest(".wysiwyg-macro-body").length)return;Pe.editMacro(n),r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&r.Confluence.PropertyPanel.destroy()}})),t.addCommand("mceConfRemoveMacro",(function(e){l()(e).remove(),r.tinymce.isGecko&&t.execCommand("mceRepaint",!1)})),n._isCursorInMostNestedElement=a,function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&t.previousSibling&&!t.nextSibling&&i(t,"p, pre")}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){var o=t.selection.getRng();if(46===n.keyCode&&o&&e(o))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInLastParagraphOrPre=e}(),r.tinymce.isWebKit&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!(function(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return a(e)&&t&&1===t.childNodes.length&&l()(t.firstChild).is("br")}(n)&&(8!==e.keyCode||!l()(o).is("li")))||r.tinymce.dom.Event.cancel(e)})),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t&&0===e.startOffset&&l()(t).is(".wysiwyg-macro-body > ul > li")&&1===t.childNodes.length&&l()(t.firstChild).is("br")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();return 8!==n.keyCode||!o||!e(o)||(t.execCommand("Outdent"),r.tinymce.dom.Event.cancel(n))})),n._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.previousSibling&&t.nextSibling&&i(t.nextSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();if(46!==n.keyCode||!o)return!0;var i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=l()(i);if(e(o)){var c=i.nextSibling;return a.remove(),t.selection.select(c,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&t&&!t.nextSibling&&t.previousSibling&&!t.previousSibling.previousSibling&&i(t.previousSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){var o=t.selection.getRng();if(8!==n.keyCode||!o)return!0;var i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=l()(i);if(e(o)){var c=i.previousSibling;return a.remove(),t.selection.select(c,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return!(!t||e.startOffset>0)&&(xe.normalize(t),t&&0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&!t.nextSibling)}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){return 8!==n.keyCode&&46!==n.keyCode||(e(t.selection.getRng())?r.tinymce.dom.Event.cancel(n):void 0)})),n._isCursorInSoloParagraphOrPreInsidePlaceholder=e}(),function(){function e(e){return e&&e.parentNode&&"BR"===e.nodeName&&e===e.parentNode.lastChild}function i(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&0===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function c(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&1===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function u(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&0===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}function s(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&1===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng();if(!n)return!0;var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!l()(o).closest(".wysiwyg-macro-body").size()||(xe.normalize(o),!(46===e.keyCode&&(i(n)||u(n))||8===e.keyCode&&(c(n)||s(n)))||(o.lastChild&&!l()(o.lastChild).is("br")&&l()(o).append("<br/>"),l()(o.firstChild).remove(),t.selection.select(o,!0),r.tinymce.dom.Event.cancel(e)))})),n._isCursorBehindOnlyCharacterInNestedElement=i,n._isCursorAfterOnlyCharacterInNestedElement=c,n._isCursorBehindOnlyChildInNestedElement=u,n._isCursorAfterOnlyChildInNestedElement=s}(),function(){function e(e){return!e.collapsed&&(0===e.startOffset&&i(e.startContainer,(function(e){return!e.previousSibling}))&&(t=e.endContainer,n=e.endOffset,!!t&&(3===t.nodeType?n===t.nodeValue.length:1===t.nodeType&&(1===t.childNodes.length&&l()(t.firstChild).is("br")?0===n:n===t.childNodes.length)))&&i(e.endContainer,(function(e){return!e.nextSibling})));var t,n}function i(e,t){if(!e)return!1;if(l()(e).is(".wysiwyg-macro-body"))return!0;do{if(!t(e))return!1;e=e.parentNode}while(e&&!l()(e).is(".wysiwyg-macro-body"));return!0}r.tinymce.isWebKit&&o((function(n){if(8!==n.keyCode&&46!==n.keyCode)return!0;var o=t.selection.getRng();if(o&&e(o)){var i=l()(o.startContainer).closest(".wysiwyg-macro-body");if(i.length>0){var a,c=l()(i[0].firstChild).is("pre");return t.undoManager.add(),i.empty(),a=c?l()("<pre><br/></pre>").appendTo(i):l()("<p><br/></p>").appendTo(i),t.selection.select(a[0],!0),r.tinymce.dom.Event.cancel(n)}}return!0})),n._isMacroBodySelected=e}(),function(){function e(e){if(!e||!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=l()(t);return 0===e.startOffset&&i(t,"p")&&n.next().is("table")}r.tinymce.isWebKit&&o((function(n){if(46===n.keyCode&&e(t.selection.getRng()))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInEmptyParagraphPrecedingPlaceholder=e}(),function(){function i(e){return e?3===e.nodeType?e:i(e.firstChild)||i(e.nextSibling):null}function a(e){return e&&"PRE"!==e.nodeName&&"TD"!==e.nodeName?"BR"===e.nodeName?e:a(e.previousSibling)||a(e.parentNode):null}function c(e){var t,n;return l()(e.commonAncestorContainer).closest(".wysiwyg-macro td").length>0&&(a(e.startContainer)||(t=i(function e(t){return!t||l()(t.parentNode).is(".wysiwyg-macro td")?null:l()(t.parentNode).is("p")?t.parentNode:e(t.parentNode)}(e.startContainer)))),(n=l()(e.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length>0&&(a(e.startContainer)||(t=i(n[0]))),t&&(e=e.cloneRange()).setStart(t,0),e}r.tinymce.isWebKit&&r.tinymce.isMac&&o((function(n){var o=t.selection.getRng();if(o&&(n.metaKey||n.ctrlKey)&&n.shiftKey&&n.keyCode===e.LEFT){var i=c(o);if(i!==o)return t.selection.setRng(i),r.tinymce.dom.Event.cancel(n)}})),n._selectTillStart=c}(),t.on("KeyDown",(function(e){if(e.keyCode===r.tinymce.util.VK.TAB){var n=t.selection.getRng();if(n){var o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;if(l()(o).is(".wysiwyg-macro-body > pre")){t.undoManager.beforeChange(),t.undoManager.add();var i=t.getDoc().createTextNode("\t");return n.insertNode(i),t.selection.setCursorLocation(i,1),t.undoManager.add(),r.tinymce.dom.Event.cancel(e)}}}}))},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("macroplaceholder",r.tinymce.plugins.MacroPlaceHolderPlugin)},function(){ee(r.document,"initContextToolbars.Toolbar",(function(){ko().initContextToolbars(),function(e){var t={},n={},r=function(e,n){var r,o;for(o in t)if(t.hasOwnProperty(o)&&t[o].isEnabled)for(var i=0,a=t[o].events.length;i<a;i++)(r=t[o].events[i]).type.toLowerCase().indexOf(n.type)>-1&&(r.shouldTrigger(e,n)?r.callback.apply(this,[n.target]):r.missed&&r.missed())};return{addEventsForComponent:function(o,i){o in t||(t[o]={},t[o].events=[],t[o].isEnabled=!0);for(var a=function(a,c){var u;!(i[a].type in n)&&(n[i[a].type]=!0,e[i[a].type].add(r)),"function"!=typeof i[a].shouldTrigger&&(u=i[a].shouldTrigger,i[a].shouldTrigger=function(e,t){return t.target.tagName.toLowerCase()==u}),t[o].events.push(i[a])},c=0,u=i.length;c<u;c++)a(c)},disableEventsForComponent:function(e){for(var n=0,r=t.length;n<r;n++)if(e in t)return t[e].isEnabled=!1,!0;return!1},enableEventsForComponent:function(e){for(var n=0,r=t.length;n<r;n++)if(e in t)return t[e].isEnabled=!0,!0;return!1}}}(r.tinymce).addEventsForComponent("TableToolbar",er)}))},function(){Qn(),r.AJS.Rte=me()||{},r.AJS.Rte.TablePicker=Zn(),r.tinymce.create("tinymce.plugins.customtoolbar",ir()),r.tinymce.PluginManager.add("customtoolbar",r.tinymce.plugins.customtoolbar)},function(){r.tinymce.create("tinymce.plugins.InsertWikiMarkupPlugin",Or),r.tinymce.PluginManager.add("insertwikimarkup",r.tinymce.plugins.InsertWikiMarkupPlugin)},function(){r.tinymce.create("tinymce.plugins.PropertyPanel",Be()),r.tinymce.PluginManager.add("propertypanel",r.tinymce.plugins.PropertyPanel)},function(){},function(){r.tinymce.create("tinymce.plugins.ConfMonospacePlugin",{init:function(e){e.addCommand("confMonospace",(function(){return e.formatter.toggle("monospace",void 0),!1})),e.on("Init",(function(){e.formatter.register({monospace:{inline:"code"}}),e.editorCommands.addCommands({confMonospace:function(){return e.formatter.match("monospace")}},"state")})),e.ui.registry.addButton("monospace",{text:"monospace",onAction:function(){e.execCommand("confMonospace")}})},getInfo:function(){return{longname:"Monospace Formatting",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confmonospace",r.tinymce.plugins.ConfMonospacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfCharmapPlugin",{init:function(e){e.addCommand("confCharmap",(function(){return e.windowManager.open({id:"insert-char-dialog",url:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/charmap.action"),width:600,height:290,inline:!0,name:"advanced.charmap_desc"},{}),!1}))},getInfo:function(){return{longname:"Confluence Charmap Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confcharmap",r.tinymce.plugins.ConfCharmapPlugin)},function(){var e=this,t=".wysiwyg-macro,.placeholder,table";r.tinymce.create("tinymce.plugins.CursorTargetPlugin",{init:function(n){var o=r.tinymce.util.VK;function i(e,n){l()(t,e).each((function(e,r){!function(e,n){var r=l()(e);function o(e){if(0===e.length)throw new Error("no paragraph element specified");ze()&&e.addClass("auto-cursor-target");var t=e[0];return 0===t.childNodes.length&&(t.innerHTML="<br />"),t}function i(e){return!l()(e).is("ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6")}function a(e,t){var n=l()("<p/>");if(l()(e.parentNode).is("li, td, th"))for(;e[t]&&i(e[t]);)n["previousSibling"==t?"prepend":"append"](e[t]);return o(n)}(!r.prev().length||r.prev(t).length||l()(e.parentNode).is("li, td, th")&&i(e.previousSibling))&&r.before(a(e,"previousSibling")),(!r.next().length||r.next(".synchrony-container").length||l()(e.parentNode).is("li, td, th")&&i(e.nextSibling))&&r.after(a(e,"nextSibling")),ze()&&r.next().length&&!r.next().next().length&&c(r.next()[0])&&r.next().addClass("auto-cursor-target"),n&&function(e){function n(e){("BR"===e[0].nodeName||c(e[0]))&&e.replaceWith(o(l()("<p/>")))}var r=e.prev();r.length&&function(e){for(var n=e.prev();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.prev()}return!0}(r)&&n(r);var i=e.next();i.length&&function(e){for(var n=e.next();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.next()}return!0}(i)&&n(i)}(r)}(r,n)}))}function a(e){return l()("p",e).each((function(e,t){c(t)&&u(t)&&l()(t).attr("data-tag","marked-for-deletion")})),l()("p[data-tag=marked-for-deletion]",e).remove(),e}function c(e){return 1===e.nodeType&&0===e.childNodes.length||function(e){for(var t=0,n=0,r=0,o=e.childNodes.length;r<o;r++){var i=e.childNodes[r];if("BR"===i.nodeName){if(++t>1)return!1}else if(/^[\s|\u00A0]$/.test(i.nodeValue)){if(++n>1)return!1}else if(""!==i.nodeValue)return!1}return!0}(e)}function u(e){if(!e||1!==e.nodeType)return!1;var n=m(e,!1),r=m(e,!0),o=d(n)||l()(n).is(t),i=d(r)||l()(r).is(t),a=d(n)&&d(r);return o&&i&&!a}function d(e){return!e||e.className&&/cell|header|footer/.test(e.className)}function m(e,t){var n=l()(e);do{var r=t?n[0].nextSibling:n[0].previousSibling;if(r)return r;n=n.parent()}while(n.length>0&&!n.is(".cell, .mceContentBody, td, li"));return null}function p(e){var t=e.startContainer;return 3===t.nodeType?!(t.previousSibling&&(3===t.previousSibling.nodeType||l()(t.previousSibling).is("br")))&&0===e.startOffset:1===t.nodeType&&0===e.startOffset}function g(e,t){return t.startContainer==t.endContainer&&1===t.startContainer.nodeType&&function(e,t){var n=t.startOffset;return e||n--,n>=0&&n<t.startContainer.childNodes.length&&"TABLE"===t.startContainer.childNodes[n].nodeName}(e,t)}function h(e){if(!e.collapsed)return!1;if(!function(e){for(var t=/^(TABLE|TR|TD)$/,n=e.startContainer;n&&n;){if(t.test(n.nodeName))return!0;n=n.parentNode}return!1}(e))return!1;var t,n=e.startContainer;if(3===n.nodeType)return t=m(n,!0),e.startOffset==n.nodeValue.length&&(null==t||l()(t).is("br"));if(1===n.nodeType){if(l()(n).is("td, th")&&0===e.startOffset&&n.childNodes.length>0)return l()(n.childNodes[0]).is("br");var r=0===e.startOffset?0:e.startOffset-1;return null==(t=m(n.parentNode.childNodes[r],!0))||l()(t).is("br")}return!1}function v(e){return e&&1===e.childNodes.length&&l()(e.childNodes[0]).is("br")}function b(e,t){return!!(t&&(r.tinymce.isWebKit&&g(!1,t)||r.tinymce.isGecko&&(h(t)||u(e)&&0===t.startOffset&&v(e))))}function y(e,t){return!!(t&&(r.tinymce.isWebKit&&(g(!0,t)||p(t)&&u(e)||function(e){var t=n.getBody();return!!t.childNodes.length&&e.collapsed&&0===e.startOffset&&t.childNodes[0]==e.startContainer}(t))||r.tinymce.isGecko&&p(t)&&u(e)&&v(e)))}function w(e){var t=e.keyCode;return t!==o.BACKSPACE&&t!==o.DELETE||(n.selection.isCollapsed()?(t===o.BACKSPACE&&y(n.selection.getNode(),n.selection.getRng())||t===o.DELETE&&b(n.selection.getNode(),n.selection.getRng()))&&r.tinymce.dom.Event.cancel(e):i(n.getBody())),!0}var C=function(){i(n.getBody(),!0)},x=function(e){i(e,!1),r.tinymce.isIE10&&function(e){l()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,t){(function(e){return e&&""===e.innerHTML})(t)&&l()(t).html("<br />")}))}(e)};function k(){x(n.getBody())}ze()?(s("cursor-target-refresh",k),n.on("Remove",(function(){f("cursor-target-refresh",k)}))):(n.on("SetContent",(function(){var e,t;i(n.getBody()),e=n.getBody(),t=r.tinymce.isIE?"&nbsp;":"<br/>",l()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,n){(function(e){return e&&e.childNodes&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&e.childNodes[0].nodeValue&&1===e.childNodes[0].nodeValue.length&&160===e.childNodes[0].nodeValue.charCodeAt(0)})(n)&&l()(n).html(t)}))})),n.on("GetContent",(function(e){if(""!==e.content){var t="<div class='root-node'>"+e.content+"</div>",r=a(l()(t)),o=l.a.extend({},e,{getInner:!1}),i=n.serializer.serialize(r[0],o);e.content=i.substring("<div class='root-node'>".length,i.length-"</div>".length)}})),n.on("init",(function(){n.dom.events.bind(n.selection,"SetContent",C),n.dom.events.bind(n.getBody(),"cut",C),s("cursor-target-refresh",C)})),n.on("Remove",(function(){f("cursor-target-refresh",C)})),r.tinymce.isGecko&&n.on("KeyDown",(function(e){e.keyCode!==o.ENTER&&e.keyCode!==o.BACKSPACE&&e.keyCode!==o.DELETE||n.selection.normalize()})),n.on("KeyDown",w),n.on("KeyUp",w),r.tinymce.isGecko&&n.on("KeyPress",w),n.on("Paste",C)),l.a.extend(e,{isCursorBeforeAfterTable:g,isCursorTarget:u,_isTextContainerEmpty:c,_removeCollaborativeEditorCursorTargets:function(e){var t=l()("<div>");return t.html(e),t.find("p.auto-cursor-target").each((function(e,t){t.remove()})),t.html()},_processCursorTargets:a,_isCursorAtStartOfContainer:p,_isCursorAtEndOfContainer:function(e){var t=e.startContainer;if(3===t.nodeType)return!(t.nextSibling&&(3===t.nextSibling.nodeType||l()(t.nextSibling).is("br")))&&e.endOffset==t.nodeValue.length;if(1===t.nodeType){var n=t.childNodes[e.startOffset];return!(!l()(n).is("br")||null!=n.nextSibling)||e.endOffset==t.childNodes.length}return!1},_getSiblingWithinBlockDisregardingNesting:m,_doesContainerHaveNestedContent:function e(t){var n,r=l()(t).children();for(n=0;n<r.length;n++)if(!c(r[n])&&(l()(r[n]).contents().filter((function(){return 3===this.nodeType})).length||e(r[n])))return!0;return!1},_addCursorTargetParagraphsToContent:i,_isCursorAtEndOfBottomRightCellInTable:h,_shouldCancelDelete:b,_shouldCancelBackspace:y,_collabEditingCursorTargetRefresh:x}),r.AJS.Rte.Cursor=me().Cursor||{},l.a.extend(r.AJS.Rte.Cursor,{isTextContainerEmpty:c,fixCursorTargets:i})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}),r.tinymce.PluginManager.add("cursorTarget",r.tinymce.plugins.CursorTargetPlugin)},function(){r.tinymce.create("tinymce.plugins.iOSEditing",{init:function(e){r.tinymce.Env.iOS&&setTimeout((function(){l()(e.getBody()).addClass("ios")}),0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("iosediting",r.tinymce.plugins.iOSEditing)},function(){r.tinymce.create("tinymce.plugins.aeTable",Tt()),r.tinymce.PluginManager.add("aeTable",r.tinymce.plugins.aeTable)},function(){var e=function(){var e=function(e){var t=this;e.on("Undo",(function(n){t.cleanLinks(e)})),this.editor=e,this.weightedHandlers=[],this.handlers=[]};function t(e){for(var n=t.options,r=n.parser[n.strictMode?"strict":"loose"].exec(e),o={},i=14;i--;)o[n.key[i]]=r[i]||"";return o[n.q.name]={},o[n.key[12]].replace(n.q.parser,(function(e,t,r){return t&&(o[n.q.name][t]=r),""})),o}e.prototype={addHandler:function(e,t){this.weightedHandlers.push({handler:e,weight:t||0}),this.weightedHandlers.sort((function(e,t){return e.weight-t.weight})),this.handlers=[];for(var n=this.weightedHandlers.length,r=0;r<n;r++)this.handlers.push(this.weightedHandlers[r].handler)},cleanLinks:function(e){return l()("a.atlassian-autoconvert",e.getDoc()).removeClass("atlassian-autoconvert"),!0},callHandlers:function(e){var i=0,a=this,c=l()(e),u=l()(e).clone(),s=u.attr("href"),f=t(n(s));function d(e){if(e&&(1!==e.length||!e.attr("href")))return p(e);if(e)i=0,f=t((u=e).attr("href")),m(a.handlers[i],f,u);else{if(!(++i<a.handlers.length))return p(u);m(a.handlers[i],f,u)}}function m(e,t,n){var i,c=d;i=o.a.setTimeout((function(){c=function(){0},d()}),r.tinymce.plugins.Autoconvert.callbackTimeout),e(t,n,(function(){clearTimeout(i),c.apply(a,arguments),c=function(){0}}))}function p(e){a.editor.undoManager.beforeChange();var t=a.editor.selection,n=a.editor.selection.getBookmark();c.replaceWith(e),t.moveToBookmark(n),a.editor.undoManager.add()}0!==this.handlers.length&&m(this.handlers[0],f,u)}},e.callbackTimeout=5e3,e.convertMacroToDom=function(e,t,n){var r={macro:e,contentId:U.get("content-id")};l.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/macro/placeholder"),data:JSON.stringify(r),dataType:"text",success:t,error:n,timeout:45e3})},e.convertMacroToDomViaWikiText=function(t,n,r){var o=["{",t.name],i=!0;for(var a in t.defaultParameterValue&&(o.push(":",t.defaultParameterValue),i=!1),t.params)i?(o.push(":"),i=!1):o.push("|"),o.push(a,"=",t.params[a]);o.push("}"),e.getHtmlFromWikiMarkup(o.join(""),(function(e){n(l()(e)[0])}),(function(){r()}))},e.getHtmlFromWikiMarkup=function(e,t,n){var r={wiki:e,entityId:U.get("content-id"),contextType:U.get("content-type"),spaceKey:U.get("space-key")};l.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(ye,"/rest/tinymce/1/wikixhtmlconverter"),data:JSON.stringify(r),dataType:"text",success:t,error:n,timeout:45e3})},t.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var n=function(e){return e.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40")},i={init:function(t){var n=new e(t);function o(e,r,o){var i=l()(o.node).children("a");1===i.length&&"A"===i[0].tagName&&i.text()===i.attr("href")&&(i.attr("class","atlassian-autoconvert"),setTimeout((function(){var e=l()("a.atlassian-autoconvert",l()(t.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");n.callHandlers(e)}),0))}r.tinymce.plugins.Autoconvert.autoConvert=n,t.on("init",(function(){l()(document).on("postPaste",o),t.addCommand("addAutoconverter",(function(e,t){return n.addHandler(t),!1}))})),t.on("remove",(function(){l()(document).off("postPaste",o)}))},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}};return{autoConverter:e,plugin:i}}();r.tinymce.plugins.Autoconvert=e.autoConverter,r.tinymce.create("tinymce.plugins.AutoconvertPlugin",e.plugin),r.tinymce.PluginManager.add("autoconvert",r.tinymce.plugins.AutoconvertPlugin),Ft()},function(){s("rte-ready",jt.initializeEditor)},function(){r.tinymce.create("tinymce.plugins.draggable",Ht()),r.tinymce.PluginManager.add("draggable",r.tinymce.plugins.draggable)},function(){r.tinymce.create("tinymce.plugins.InsertFiles",{init:function(e){e.ui.registry.addButton("confluence-insert-files",{text:ge("tinymce.confluence.files"),tooltip:"".concat(ge("tinymce.confluence.conf_file_desc")," (").concat(e.translate("toolbar.insert_files_shortcut_tooltip"),")"),className:"insert-files",icon:"aui-icon aui-icon-small aui-iconfont-image",locationGroup:"rte-toolbar-group-files",weight:0,onAction:function(){e.execCommand("mceConfimage")}})},getInfo:function(){return{longname:"Insert Files",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}),r.tinymce.PluginManager.add("insertfiles",r.tinymce.plugins.InsertFiles)},function(){var e,t,n;r.tinymce.create("tinymce.plugins.flextofullsizeplugin",(n=function(){var e=l()("#wysiwyg").is(":hidden")?l()("#preview"):l()("#wysiwyg");t=e.find("iframe");var n=l()("#header-precursor"),r=l()(o.a).height(),i=n.offset().top+n.height()+l()("#header").height();l()("#content.edit").height(r-i),setTimeout((function(){if(l()("#preview").is(":hidden"))t.height(0).height(e.height());else{l()("#content.edit").height("auto");var n=l()("#savebar-container").height();i+=l()("#editor-precursor").height(),t.height(r-i-n-4)}}),1)},{init:function(t){t.on("Init",(function(){var o,i;l()(t.getBody()).addClass("fullsize");var a=r.tinymce.Env;(a.ie||a.opera)&&(o=t.getWin(),e=l()(o.parent),i=l()(o.parent.document),l()("body").css({overflow:"hidden"}),e.bind("resize.resizeplugin",(function(){n()})),i.bind("messageClose",(function(){setTimeout(n,0)})),i.bind("resize.resizeplugin",(function(){n()})),i.bind("mode-changed",(function(){n()})),t.on("Change",(function(){n()})),n())}))},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("flextofullsize",r.tinymce.plugins.flextofullsizeplugin)},function(){r.tinymce.create("tinymce.plugins.Referrer",{init:function(e){e.on("Init",(function(){var e=l()("#createpageform"),t=e.find("#originalReferrer");e.length&&!t.val()&&document.referrer&&t.val(document.referrer)}))},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("referrer",r.tinymce.plugins.Referrer)},function(){var e,t;r.tinymce.create("tinymce.plugins.TableContentWrapperPlugin",(e=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(","),t="<div class='content-wrapper'>",{init:function(n){function r(){l()(n.dom.select("table.confluenceTable:not(.".concat("wrapped",")"))).each((function(n,r){l()(r).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each((function(n,r){var o=l()(r);!o.find("> .content-wrapper").length&&o.find(e).length&&o.wrapInner(t)}))}))}s("rte-ready",r),n.on("Remove",(function(){f("rte-ready",r)})),n.on("Change",(function(){var r=n.selection;function o(){return r.getBookmark()}function i(e){r.moveToBookmark(e),ke()}var a=r.getNode(),c=l()(a);if(a&&c.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){!function(e){var t=r.getRng();if(e.is("tr")&&t&&l()(t.startContainer).is("tr")&&t.collapsed){var n=e.find(">td, >th").first(),o=n.find(":first-child:not(.content-wrapper)")[0]||n[0].firstChild;t.setStart(o,0),t.setEnd(o,0),r.setRng(t)}}(c);var u,s=c.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(s.find(e).length){var f=s.find("> .content-wrapper");f.length?(u=o(),function(e){for(var t=0;t<e.length;t++)e.eq(t).find("> p, > table, > ul, > ol").length||e.eq(t).wrapInner("<p/>"),t>0&&(e.eq(0).append(e.eq(t).children()),e.eq(t).remove())}(f),i(u)):s.find("> p").length?(u=o(),s.wrapInner(t),i(u)):(u=o(),s.wrapInner("<p/>").wrapInner(t),i(u))}}l()(n.getWin().document).find(".content-wrapper:empty").remove()}))},getInfo:function(){return{longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("tableContentWrapper",r.tinymce.plugins.TableContentWrapperPlugin)},function(){var e;r.tinymce.create("tinymce.plugins.LinkBrowser",(e=r.Confluence.Editor.LinkBrowser,{init:function(t){t.ui.registry.addButton("linkbrowserbutton",{text:"confluence.conflink_desc",className:"mce_conflink",onAction:function(){t.execCommand("mceConflink")}}),t.addCommand("mceConflink",(function(){return e.open({bookmarkManager:_e}),!1})),t.addCommand("mceConfAttachments",(function(){return e.open({panelKey:e.ATTACHMENTS_PANEL,bookmarkManager:_e}),!1}))},getInfo:function(){return{longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}})),r.tinymce.PluginManager.add("linkbrowser",r.tinymce.plugins.LinkBrowser)},function(){r.tinymce.create("tinymce.plugins.ConfluenceVersionComment",{init:function(e){e.on("Init",(function(){var e=U.get("version-comment");l()("#rte-savebar-tinymce-plugin-point").append(function(e,t){return'\n<span class="rte-toolbar-comment toolbar-item">\n    <input id="versionComment" name="versionComment" '.concat(t?'value="'.concat(t,'"'):"",'\n           placeholder="').concat(e("editor.change.comment"),'"\n           class="text" type="text" size="35">\n    <label for="versionComment" class="assistive">').concat(e("editor.change.comment"),"</label>\n</span>\n")}((function(e){return ge(e)}),e))}))},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluenceversioncomment",r.tinymce.plugins.ConfluenceVersionComment)},function(){r.tinymce.PluginManager.add("autocomplete",ro)},function(){},function(){r.tinymce.PluginManager.add("autocompletelink",uo)},function(){r.tinymce.create("tinymce.plugins.AutoCompleteMacro",fo()),r.tinymce.PluginManager.add("autocompletemacro",r.tinymce.plugins.AutoCompleteMacro)},function(){r.tinymce.PluginManager.add("autocompletemedia",xo)},function(){E("confluence-table-enhancements.sticky-headers.disabled")||l()(document).ready(Zt),E("confluence-table-enhancements.sticky-headers-editor")&&(s("rte-ready",tn),s("rte-quick-edit-push-state",tn),s("rte-quick-edit-push-hash",tn))},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveComment",nn),r.tinymce.PluginManager.add("confluenceleavecomment",r.tinymce.plugins.ConfluenceLeaveComment)},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",rn),r.tinymce.PluginManager.add("confluenceleavetemplate",r.tinymce.plugins.ConfluenceLeaveTemplate)},function(){r.Confluence.Editor.SearchManager=fn(),dn(),r.tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",mn()),r.tinymce.PluginManager.add("searchreplace",r.tinymce.plugins.AtlassianSearchReplacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluenceDrafts",on()),r.tinymce.PluginManager.add("confluencedrafts",r.tinymce.plugins.ConfluenceDrafts)},function(){var e=function(e){return!!e.querySelector(".contentLayout, .contentLayout2")},t=function(e){return Array.from(e.querySelectorAll(".contentLayout2 .columnLayout.single"))},n=function(e,t){e.undoManager.ignore((function(){t.forEach((function(t){return t.appendChild(function(e){return e.dom.create("div",{class:"pagelayout-delete-stub synchrony-exclude",style:"display:none;",contenteditable:"true"},".")}(e))}))}))},o=function(e,t){var n=Array.from(t.querySelectorAll(".pagelayout-delete-stub"));e.undoManager.ignore((function(){n.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)}))}))};s("rte-ready",(function(){var i=r.tinymce.activeEditor,a=i.getDoc(),c=i.getBody();c.addEventListener("keydown",(function(r){if((8===r.keyCode||46===r.keyCode)&&e(a))if(i.dom.isEmpty(i.getBody()))r.stopImmediatePropagation();else{var o=t(a);o.length>0&&(n(i,o),r.stopImmediatePropagation())}}),!0),c.addEventListener("keyup",(function(t){8!==t.keyCode&&46!==t.keyCode||!e(a)||o(i,a)}),!0),i.on("beforeExecCommand",(function(r){if("delete"===r.command&&e(a)){var o=t(a);o.length>0&&n(i,o)}})),i.on("ExecCommand",(function(t){"delete"===t.command&&e(a)&&o(i,a)})),i.on("BeforeGetContent",(function(){o(i,a)}))}))},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",an),r.tinymce.PluginManager.add("confluencemacrobrowser",r.tinymce.plugins.ConfluenceMacroBrowser)},function(){r.tinymce.PluginManager.add("statusmacro",jo),r.Confluence.PropertyPanel.Macro.registerInitHandler((function(e,t){var n,o;Eo=e,function(e){var t=function(e){for(var t=0;t<e.length;t++)if(e[t].className.indexOf("macro-placeholder-property-panel-edit-button")>-1)return e[t];return null}(e),n=function(e){Pe.editMacro(e)};t&&(t.click=function(){r.Confluence.PropertyPanel.destroy(),Io()?To.always(n):n(Eo)})}(t),_o=r.Confluence.MacroParameterSerializer.deserialize(l()(Eo).attr("data-macro-parameters")),Ao=null,t.splice(1,0,(n=(o=_o).title||Mo(o),{className:"status-macro-title first last editable",text:Et(n),click:Fo}))}),"status"),l.a.each(Oo,(function(e,t){r.Confluence.PropertyPanel.Macro.registerButtonHandler(t,(function(){_o.colour=t,r.Confluence.PropertyPanel.destroy()}),"status")})),s("destroyed.property-panel",(function(){Io()&&Bo()}))},function(){},function(){},function(){},function(){r.AJS.MacroBrowser.Macros.code=Dr},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceWatch",cn),r.tinymce.PluginManager.add("confluencewatch",r.tinymce.plugins.ConfluenceWatch)},function(){r.tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",un),r.tinymce.PluginManager.add("confluencesortabletablesplugin",r.tinymce.plugins.ConfluenceSortableTablesPlugin)},function(){r.tinymce.create("tinymce.plugins.AutoResizePlugin",ln),r.tinymce.PluginManager.add("autoresize",r.tinymce.plugins.AutoResizePlugin)},function(){},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",wn),r.tinymce.PluginManager.add("confluencenotifywatchers",r.tinymce.plugins.ConfluenceNotifyWatchers)},function(){},function(){r.Confluence.PropertyPanel.Macro.registerButtonHandler("office-connector-download-file-button",(function(e,t){for(var n=(t=t.nodeType?t:t[0]).getAttribute("data-macro-parameters").split("|"),o={},i=0;i<n.length;i++){var a=n[i].split("=");a.length>1&&(o[a[0]]=a[1])}var c=U.get("page-id"),u=U.get("content-type");function l(e,t,n){return e&&t&&("?"!=n.charAt(n.length-1)&&(n+="&"),n="".concat(n).concat(e,"=").concat(encodeURI(t))),n}o.space||(o.space=U.get("space-key"));var s=U.get("context-path")+"/plugins/servlet/oc/getattachment?";s=l("title",o.page,s),s=l("date",o.date,s),s=l("space",o.space,s),s=l("filename",o.name,s),s=l("contextid",c,s),s=l("contexttype",u,s);var f=r.tinymce.Env.ie?"_blank":"download-office-attachment",d=window.open(s,f);d&&d.opener&&(d.opener=null)})),So()},function(){s("rte-ready",(function(){!function(){Object(r.clearTimeout)($e),$e=Object(r.setTimeout)(et,6e4);r.tinymce.activeEditor.on("ExecCommand",(function(e){var t,n="mceToggleFormat"===e.command?(t=e.value).charAt(0).toUpperCase()+t.slice(1):e.command;Ze(tt[n])})),r.tinymce.activeEditor.on("KeyPress",(function(){Ze("keys")})),r.tinymce.activeEditor.on("KeyUp",(function(e){46===e.keyCode?Ze("delete",Qe):8===e.keyCode&&Ze("backspace",Qe),Qe=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("MouseUp",(function(){Qe=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("PastePostProcess",(function(e){var t=e&&e.node?e.node.innerText||e.node.textContent:"";Ze("paste",t.length)})),r.tinymce.activeEditor.on("Remove",(function(){et(),Object(r.clearTimeout)($e)}))}(),o.a.addEventListener("beforeunload",(function(){et()}))}))},function(){r.tinymce.create("tinymce.plugins.TableAnalytics",En),r.tinymce.PluginManager.add("tableAnalytics",r.tinymce.plugins.TableAnalytics)},function(){s("init.rte",Ir)},function(){s("init.rte",(function(){te(r.document,"postPaste",_n),ee(r.document,"postPaste",_n),r.tinymce.activeEditor&&r.tinymce.activeEditor.on("Remove",(function(){te(r.document,"postPaste",_n)}))}))},function(){r.tinymce.create("tinymce.plugins.ConfIndentation",An),r.tinymce.PluginManager.add("confindentation",r.tinymce.plugins.ConfIndentation)},function(){},function(){r.tinymce.create("tinymce.plugins.TextPatternPlugin",On),r.tinymce.PluginManager.add("aetextpattern",r.tinymce.plugins.TextPatternPlugin)},function(){r.tinymce.Env.gecko&&s("rte-ready",Kn)},function(){12===r.tinymce.Env.ie&&s("rte-ready",Kn)},function(){r.tinymce.create("tinymce.plugins.PersistScrollPosition",jn),r.tinymce.PluginManager.add("persit_scroll_position",r.tinymce.plugins.PersistScrollPosition)},function(){r.tinymce.create("tinymce.plugins.templateeditor",Hn),r.tinymce.PluginManager.add("templateeditor",r.tinymce.plugins.templateeditor)},function(){r.tinymce.PluginManager.add("preserve-paragraph-formatting-on-delete",(function(e){return e.on("KeyDown",(function(t){!function(e,t){var n,o,i=r.tinymce.VK,a=i.BACKSPACE,c=i.DELETE,u=e.selection.getNode(),l=u.nextSibling;if(e.selection.isCollapsed()&&u!=e.dom.getRoot())if(t.keyCode===a){if(n=e.selection,(o=n.getRng())&&0===o.startOffset){var s=u.previousSibling;s&&zn(s)&&(Wn(e,s),r.tinymce.dom.Event.cancel(t))}}else if(t.keyCode==c){if(Un(u).length<=1||u.childNodes.length>1)return;l&&zn(u)&&(Wn(e,u),r.tinymce.dom.Event.cancel(t),function(e,t){var n=e.selection,r=n.getRng();e.focus(!1),t.focus(),r&&(r.setStart(t,0),r.setEnd(t,0),n.setRng(r))}(e,l))}}(e,t)})),{getMetadata:function(){return{name:"Preserve paragraph formatting when deleting empty line",author:"Atlassian",url:"http://www.atlassian.com"}}}}))},function(){r.tinymce.create("tinymce.plugins.macroNavigation",qn),r.tinymce.PluginManager.add("macroNavigation",r.tinymce.plugins.macroNavigation)},function(){r.tinymce.PluginManager.add("a11ychecker-helper",oi)}],ai=function(){return ii.forEach((function(e,t){try{e()}catch(n){v("initError",{fnName:e.name||t,message:n.message||"",exceptionName:n.name||""})}})),!0},ci=function(){return new Promise((function(e){!function(e,t){e.listener;var n=e.globalProperty,r=e.interval,o=void 0===r?250:r;if(c(n))return t(),null;var i=setInterval((function(){c(n)&&(clearInterval(i),t())}),o)}({listener:"editor-plugins/index",globalProperty:"AJS.Confluence.PropertyPanel.Macro",interval:20},(function(){e()}))}))},ui=!1,li=function(){if(ui)return v("initError",{message:"Editor was loaded already, stop re-running init phase"}),Promise.reject();var e=o.a.tinymce;return e.VK=e.util.VK,e.confluence=e.confluence||{},r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.macrobrowser=Oe,$n(),r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.NodeUtils=Ce,r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.MacroUtils=De,Jn(),y.a.EditorUtils=C,y.a.Rte=y.a.Rte||{},y.a.Rte.Cursor=y.a.Rte.Cursor||{},l.a.extend(y.a.Rte.Cursor,{insertParagraph:S,isCursorAtStart:k,isCursorAtEnd:x.isCursorAtEnd}),ui=!0,E("confluence.editor.a11ychecker")?Promise.all([ci(),a("wrm/require")("com.atlassian.confluence.plugins.confluence-editor-v4:editor-a11ychecker-plugin")]).then(ai):ci().then(ai)},si=!1,fi="",di={},mi={},pi=function(){si&&(d("analytics",function(){for(var e={},t={name:fi,data:e},n=gi.getEntriesByType("measure"),r=0;r<n.length;r++){var o=n[r],i=o.name;di[i]&&(e["".concat(i,".startTime")]=o.startTime,e["".concat(i,".duration")]=o.duration)}return t}()),si=!1)};var gi=o.a.performance,hi=function(e){return"".concat(e,".start")};function vi(e){!function(e){if(gi&&gi.mark&&di[e]){si||(si=!0);var t=hi(e);gi.mark(t)}}(e)}function bi(e){!function(e){if(gi&&gi.mark&&di[e]){var t=hi(e);if(0!==gi.getEntriesByName(t,"mark").length){var n=function(e){return"".concat(e,".end")}(e);gi.mark(n),gi.measure(e,t,n),mi[e]&&pi()}else o.a.console.warn("Calling debugTimeEnd for ".concat(e," before debugTime"))}}(e)}var yi={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",SearchReplace:".rte-toolbar-group-searchreplace",Help:".rte-toolbar-group-help"},wi=function(e,t,n){!1===t&&function(e,t){Array.prototype.forEach.call(r.document.getElementById(e).querySelectorAll(t),(function(e){e.style.display="none"}))}(e,n)};function Ci(e){return(e=e&&e.jquery?e[0]:e)?("BR"!==e.tagName&&3!==e.nodeType||(e=e.parentNode),e&&9===e.nodeType&&(e=null),e):null}var xi={};xi.Rte={HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:function(){return r.tinymce.activeEditor},getCurrentBaseUrl:function(){if(!this.currentBaseUrl){var e=r.document.location;this.currentBaseUrl="".concat(e.protocol,"//").concat(e.hostname).concat(e.port?":".concat(e.port):"")}return this.currentBaseUrl},showSelection:function(e){me().showElement(r.tinymce.activeEditor.selection.getStart(),e)},isAnyPartShown:function(e){var t=Ci(e);if(!t)return!1;var n=l()(t),r=n.offset().top,o=r+n.outerHeight(),i=l()(me().getEditor().getDoc()).scrollTop(),a=i+l()(me().getEditorFrame()).height();return o>i&&r<a},showElement:function(e,t){var n=Ci(e);if(n){var r=l()(n),o=me().getEditor(),i=l()(o.getDoc()),a=r.offset().top,c=a+r.outerHeight(),u=i.scrollTop(),s=u+l()(me().getEditorFrame()).height(),f=function(){me().bindScroll("AJS.Rte.showElement",(function(){me().unbindScroll("AJS.Rte.showElement"),setTimeout(t,1)}))};a<u?(me().scrollTo(a),t&&f()):c>s?(me().scrollTo(Math.min(a,u+c-s)),t&&f()):t&&t()}},scrollTo:function(e){var t=me().getEditor();e=Math.ceil(e),l()(t.getDoc()).scrollTop(e)},bindScroll:function(e,t){var n=me().getEditor();l()(r.document).add(n.getDoc()).add(n.getWin()).bind("scroll.".concat(e),t)},unbindScroll:function(e){var t=me().getEditor();l()(r.document).add(t.getDoc()).add(t.getWin()).unbind("scroll.".concat(e))},getMainEditor:function(){var e=r.tinymce.EditorManager.editors[me().editorId];if(!e)throw new Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return e},getEditorContainer:function(){return r.document.getElementById("wysiwyg")},getEditorFrame:function(){return r.document.getElementById("".concat(me().getEditor().id,"_ifr"))},getEditorTable:function(){return r.document.getElementById("".concat(me().getEditor().id,"_tbl"))},webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix:function(){return this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+U.get("editor-plugin-resource-prefix")),this.resourceUrlPrefix},getTinyMceBaseUrl:function(){return this.absoluteUrl||(this.absoluteUrl="".concat(this.getResourceUrlPrefix()+this.webResourcePath,"tinymcesource/")),this.absoluteUrl},getMinEditorHeight:function(){return+U.get("min-editor-height")},getTinyMceEditorMinHeight:function(e){e=e||0;var t=me().getMinEditorHeight(),n=0;return t||(Array.prototype.forEach.call(r.document.querySelectorAll("#editor-precursor,#header-precursor,#header"),(function(e){n+=l()(e).outerHeight(!0)})),l()(o.a).height()-n-e)},fixEditorFocus:function(){0},editorFocus:function(e){if(e&&!e.destroyed){var t,n=(t=e.dom.getRoot(),r.tinymce.isWebKit&&!l()(t).parents("body").length&&(t=l()(e.getBody()).find("p:first-child")[0]),t);n&&(e.selection.select(n,!0),e.selection.collapse(!0),n.focus()),e.getBody().focus(),e.getWin().focus()}}},xi.KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91};var ki=xi;function Si(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ti(e,t,n[t])}))}return e}function Ti(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ei=function(){void 0===r.AJS.Rte&&(r.AJS.Rte=Si({},ki.Rte)),void 0===r.AJS.Rte.getEditor&&(r.AJS.Rte=Si({},r.AJS.Rte,ki.Rte))},_i=n("com.atlassian.confluence.plugins.confluence-frontend:locale/require('confluence/locale')");function Ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ni(e,t,n[t])}))}return e}function Ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Oi,Di=!1,Ii={_tinyMceHasInit:!1,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:function(){return Ii._tinyMceHasInit},isEditorActive:function(){return!!(Ii.isInitComplete()&&r.tinymce&&r.tinymce.activeEditor)},onInit:function(){Ii._tinyMceHasInit=!0;var e=r.AJS.Rte.getEditor();if(e.getBody().classList.add("notranslate"),d("init.rte",{editor:e}),!1!==U.get("editor-auto-focus")){var t=r.document.getElementById("content-title");t&&""===t.value?t.focus():r.AJS.Rte.editorFocus(e)}else 0},addOnInitCallback:function(e){if("function"!=typeof e)throw new Error("Attempt made to register an oninit callback that is not a function. Received: ".concat(e));Ii._tinyMceHasInit?e():s("init.rte",e)},addBeforeInitCallback:function(e){Ii._beforeInitCallbacks.push(e)},addTinyMcePluginInit:function(e){Ii._tinymcePluginInits.push(e)},preInitialise:function(e){Ii._settings=e,Di&&(Di=!1,Ii.initialise(Oi))},initialise:function(e){if(vi("confluence.editor.tinymce"),!Ii._settings)return Di=!0,void(Oi=e);e=Ai({},e);var t,n,o,i,c=Ai({},Ii._settings);r.AJS.Rte.isQuickEdit=e.isQuickEdit||!1,Ii._beforeInitCallbacks.forEach((function(e){e(c)})),d("rte-pre-resolveplugins");for(var u=0,l=Ii._tinymcePluginInits.length;u<l;u++)"function"==typeof Ii._tinymcePluginInits[u]&&Ii._tinymcePluginInits[u](c);!function(e){var t=a("confluence-editor/i18n/translations.i18n"),n=a("wrm/require"),o={cs:"cs-CZ",da:"da-DK",de:"de-DE",es:"es-ES",fi:"fi-FI",fr_FR:"fr-FR",it:"it-IT",hu_HU:"hu-HU",ja:"ja-JP",ko_KR:"ko-KR",nl:"nl-NL",nb_NO:"no-NO",pl:"pl-PL",pt_BR:"pt-BR",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sv_SE:"sv-SE",zh_CN:"zh-CN"},i=r.tinymce.EditorManager.addI18n;r.tinymce.EditorManager.addI18n=function(e,t){o.hasOwnProperty(e)?i(Object(_i.getUserLocale)(),t):i(e,t)},Object.values(o).includes(e)&&n("com.atlassian.confluence.editor:editor-a11ychecker-i18n-"+e),Ri(t);var c=new RegExp("".concat(t.ctrl_key,"\\+"),"g"),u=new RegExp("".concat(t.shift_key,"\\+"),"g"),l=function(e){return e.replace(c,"⌘").replace(u,"⇧")};for(var s in t){var f=t[s];if("object"===Ri(f))for(var d in f)r.tinymce.Env.mac&&(f[d]=l(f[d]));r.tinymce.EditorManager.addI18n("".concat(e,".").concat(s),t[s])}r.tinymce.ScriptLoader.markDone("".concat(r.tinymce.baseURL,"/langs/").concat(e,".js")),r.tinymce.Env.mac&&Array.prototype.forEach.call(r.document.querySelectorAll("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button"),(function(e){var t=e.getAttribute("title"),n=e.dataset.tooltip;t&&e.setAttribute("title",l(t)),n&&(e.dataset.tooltip=l(n))}))}(c.locale),function(e,t){var n;if(!1!==t)for(n in t=t||{})t.hasOwnProperty(n)&&yi[n]&&wi(e,t[n],yi[n]);else r.document.getElementById(e).style.display="none"}("toolbar",e.toolbar),c.plugins=(t=c.plugins,n="string"==typeof e.plugins?e.plugins.split(","):e.plugins||[],o=e.excludePlugins||[],i=t.split(","),n.forEach((function(e){i.indexOf(e)<0&&i.push(e)})),(i=i.filter((function(e){return o.indexOf(e)<0}))).join(",")),c.setup=function(t){t.on("PreInit",(function(){t.dom.loadCSS=function(){}})),e&&"function"==typeof e.onInitialise&&e.onInitialise(t)},c.init_instance_callback=function(e){var t=ze();Ei(),r.tinymce.FocusManager.isEditorUIElement=function(e){for(var t=e,n=!1;t;){if("rte-toolbar"===t.id){n=!0;break}t=t.parentElement}return n};try{var n=c.contentCssTags,o=e.getDoc().querySelectorAll("head");if(void 0===o[0])throw"No editor <head>";o[0].innerHTML=n+o[0].innerHTML}catch(e){}r.AJS.Rte.BootstrapManager.onInit(e),Vn.editorResetContentChanged(),r.AJS.Rte.getEditorFrame().setAttribute("tabindex",100),r.tinymce.isIE&&r.AJS.Rte.getEditorFrame().setAttribute("hidefocus","hidefocus"),t&&e.on("AddUndo",(function(t){var n={level:null,lastLevel:null,originalEvent:t};return e.fire("change",n)})),bi("confluence.editor.tinymce"),d("rte-ready"),t&&d("rte-begin-collab-editing"),We()&&e.getBody().classList.add("page-edit")},r.tinymce.IconManager.add("default",{icons:{}}),r.tinymce.IconManager.add("atlassian",{icons:{"accessibility-check":'<svg width="18" height="18"><path fill-rule="nonzero" d="M9 1c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm6 7h-3v8a1 1 0 01-2 0v-3a1 1 0 00-2 0v3a1 1 0 01-2 0V8H3a1 1 0 110-2h12a1 1 0 010 2z"/></svg>',"action-next":'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M17.257 10.473l-4.548 4.558a1 1 0 01-1.415.001l-4.55-4.56A1.051 1.051 0 118.23 8.984l.001.001 3.77 3.776 3.768-3.776a1.05 1.05 0 011.486 0h.001c.411.41.411 1.076.001 1.488" id="i3-a"/></defs><use xlink:href="#i3-a" fill-rule="evenodd"/></svg>',"action-prev":'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11.294 8.968l-4.55 4.56a1.051 1.051 0 101.486 1.488l.001-.001 3.77-3.776 3.768 3.776a1.05 1.05 0 001.486 0h.001a1.054 1.054 0 00.001-1.488L12.71 8.969a1 1 0 00-1.415-.001z" id="i5-a"/></defs><use xlink:href="#i5-a" fill-rule="evenodd"/></svg>',checkmark:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M12 21a9 9 0 110-18 9 9 0 010 18zm-2.293-9.707a1 1 0 10-1.414 1.414l2 2a1 1 0 001.414 0l4-4a1 1 0 10-1.414-1.414L11 12.586l-1.293-1.293z" id="i7-a"/></defs><use xlink:href="#i7-a" fill-rule="evenodd"/></svg>',"chevron-down":'<svg width="16" height="16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11.708 5.804a.989.989 0 00-1.407 0L8.004 8.121 5.697 5.794a.985.985 0 00-1.406 0A1 1 0 004 6.503v.001c0 .256.096.513.291.709l2.939 2.965c.219.215.499.322.778.322.28 0 .557-.107.77-.322l2.93-2.955a1.007 1.007 0 000-1.419" id="i9-a"/></defs><use xlink:href="#i9-a" fill-rule="evenodd"/></svg>',close:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M12 10.586l5.293-5.293a1 1 0 011.414 1.414L13.414 12l5.293 5.293a1 1 0 01-1.414 1.414L12 13.414l-5.293 5.293a1 1 0 11-1.414-1.414L10.586 12 5.293 6.707a1 1 0 011.414-1.414L12 10.586z" id="i11-a"/></defs><use fill-rule="nonzero" xlink:href="#i11-a"/></svg>',help:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M13 17a1 1 0 11-2 0 1 1 0 012 0m2.5-7.5a3.505 3.505 0 01-2.5 3.354V14a1 1 0 01-2 0v-2a1 1 0 011-1c.827 0 1.5-.673 1.5-1.5S12.827 8 12 8s-1.5.673-1.5 1.5a1 1 0 01-2 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5M12 20c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8m0-18C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2" id="i13-a"/></defs><use xlink:href="#i13-a" fill-rule="evenodd"/></svg>',info:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M3 12a9 9 0 019-9 9 9 0 019 9 9 9 0 01-9 9 9 9 0 01-9-9zm8-.997v4.994A.994.994 0 0012 17c.556 0 1-.449 1-1.003v-4.994A.994.994 0 0012 10c-.556 0-1 .449-1 1.003zM12 9a1 1 0 100-2 1 1 0 000 2z" id="i15-a"/></defs><use xlink:href="#i15-a" fill-rule="evenodd"/></svg>',warning:'<svg width="24" height="24" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M13.416 4.417l6.168 6.167c.783.784.782 2.05 0 2.833l-6.168 6.167a2.002 2.002 0 01-2.832 0l-6.168-6.167a2.002 2.002 0 010-2.833l6.168-6.167a2.002 2.002 0 012.832 0zM12 14a1 1 0 001-1V8a1 1 0 00-2 0v5a1 1 0 001 1zm0 3a1 1 0 100-2 1 1 0 000 2z" id="i17-a"/></defs><use xlink:href="#i17-a" fill-rule="evenodd"/></svg>'}}),r.tinymce.init(c)}},Pi=Ii,Bi="".concat(o.a.location.protocol,"//").concat(o.a.location.host),Mi={a11ycheckerIssueUrlCallback:function(e){return"".concat(Bi).concat(ye,"/plugins/a11ychecker/a11ychecker-rules.action#").concat(e)},a11ycheckerFilterIssue:function(e){return!(e.element.classList.contains("wysiwyg-macro")||e.element.classList.contains("editor-inline-macro"))}};function Li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fi="".concat(o.a.location.protocol,"//").concat(o.a.location.host),ji=["compat3x","atlassiantheme","auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","conflist","tasklist","paste","aePaste","cursorTarget","aeTable","confluencepastetableplugin","pagelayoutplugin","iosediting","autoconvert","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics","aetextpattern","persit_scroll_position","confindentation","preserve-paragraph-formatting-on-delete","tableContentWrapper","statusmacro","macroNavigation"],Hi=function(){var e;return E("confluence.editor.a11ychecker")?(ji=ji.concat(["a11ychecker","a11ychecker-helper"]),e={theme:"silver",a11ychecker_html_version:"html5",a11ychecker_ignored_rules:"T1,T2,T3,T4C,H93",a11ychecker_issue_url_callback:Mi.a11ycheckerIssueUrlCallback,a11ychecker_filter_issue:Mi.a11ycheckerFilterIssue}):e={theme:"default"},e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Li(e,t,n[t])}))}return e}({},e,{autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:"".concat(Fi).concat(ye,"/"),plugins:ji.join(","),theme_advanced_buttons1:"formatselect,confimage,conf_macro_browser,code,customtoolbar,monospace,searchreplace,linkbrowserbutton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",toolbar:!1,menubar:!1,skin:!1,statusbar:!1,table_toolbar:"",contextmenu:!1,mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"aui-theme-default mceContentBody wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:ye,plugin_action_base_path:"".concat(ye,"/plugins/tinymce"),editor_plugin_action_base_path:"".concat(ye,"/plugins/editor/tinymce"),page_id:U.get("page-id"),draft_type:null,form_name:U.get("form-name"),space_key:encodeURI(U.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea",indent:!1,table_tab_navigation:!1,inline_boundaries:!1,indent_use_margin:!0,end_container_on_empty_block:!0,atlassian:!0,keep_values:!0,convert_urls:!0,relative_urls:!1,remove_script_host:!1,button_tile_map:!0,gecko_spellcheck:!0,apply_source_formatting:!1,list_outdent_on_enter:!0,visual:!1,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:!0,cleanup:!0,cleanup_on_startup:!0,fix_list_elements:!1,fix_table_elements:!0,valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,#div[*],span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img.confluence-embedded-image",classes:"image-left"},{selector:"img,table",collapsed:!1,styles:{float:"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img.confluence-embedded-image",classes:"image-center"},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img.confluence-embedded-image",classes:"image-right"},{selector:"img,table",collapsed:!1,styles:{float:"right"}}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontWeight:"bold"}}],italic:[{inline:"em",remove:"all",preserve_attributes:["class"]},{inline:"span",styles:{fontStyle:"italic"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"s",remove:"all"}],removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:!1,expand:!1,deep:!0},{selector:":not(li)",attributes:["style","color","bgcolor","title","lang"],split:!1,expand:!1,deep:!0}]},forced_root_block:"p",force_p_newlines:!0,force_br_newlines:!1,padd_empty_with_br:!0,allow_unsafe_link_target:!0,paste_remove_styles_if_webkit:!1,object_resizing:!1,automatic_uploads:!1,allow_html_data_urls:!0,images_dataimg_filter:function(){return!1},icons:"atlassian"})};var Ui={createProfileForCommentEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavecomment","confluencewatch","autoresize"]}},createProfileForPageEditor:function(e){var t=["searchreplace","confluencedrafts","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","flextofullsize","referrer"];return e&&e.versionComment&&t.push("confluenceversioncomment"),e&&e.notifyWatchers&&t.push("confluencenotifywatchers"),{plugins:t}},createProfileForTemplateEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavetemplate","flextofullsize","templateeditor"]}}},zi=function(){return{renderUI:function(){return{iframeContainer:r.tinymce.DOM.get("rte"),editorContainer:"wysiwyg"}}}};function Wi(e){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Ei(),$n(),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BootstrapManager&&(r.AJS.Rte.BootstrapManager=Pi),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Placeholder&&(r.AJS.Rte.Placeholder=de),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BookmarkManager&&(r.AJS.Rte.BookmarkManager=_e),Object(r.define)("confluence-editor/loader/tinymce-bootstrap",(function(){return Pi})),Object(r.define)("confluence-editor/editor/atlassian-editor",(function(){return ki})),Object(r.define)("confluence-editor/editor/atlassian-editor-content",(function(){return Vn})),Object(r.define)("confluence-editor/utils/tinymce-node-utils",(function(){return xe})),Object(r.define)("confluence-editor-v4/build/editor",(function(){li().then((function(){var e={locale:U.get("user-locale").replace("_","-")};r.AJS.toInit((function(){!function(e){r.tinymce.ThemeManager.requireLangPack("advanced"),E("confluence.editor.a11ychecker")||r.tinymce.ThemeManager.add("default",zi),o.a.requestAnimFrame=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;var t=Hi();0===Number(t.page_id)&&(t.page_id=null,t.draft_type=U.get("draft-type")),Pi.addBeforeInitCallback((function(e){e.contentCssTags=r.document.querySelector('script[title="editor-css"]').innerHTML,e.language=U.get("action-locale").replace("_","-");var t=U.get("min-editor-height");t&&(e.autoresize_min_height=t)}));var n=!(U.get("remote-user")&&U.get("confluence.prefs.editor.disable.autocomplete"));if(n&&(t.plugins+=",autocomplete,autocompletelink,autocompletemedia"),t.locale="object"===Wi(e)&&void 0!==e.locale?e.locale:"",!!U.get("auto-start")){if(d("rte-loaded",{editPermission:!0}),ze()){var i=r.document.getElementById(t.editor_id);d("rte-collaborative-content-ready",{title:U.get("page-title")||U.get("original-content-title")||"",editorContent:i.value,confRev:U.get("conf-revision"),syncRev:r.document.getElementById("syncRev").value,syncRevSource:U.get("sync-revision-source")})}vi("confluence.editor"),n&&(t.plugins+=",autocompletemacro");var a="0"==="".concat(U.get("page-id")),c=function(e,t){if("template"===e)return Ui.createProfileForTemplateEditor();if("comment"===e)return Ui.createProfileForCommentEditor();var n={versionComment:!t,notifyWatchers:!t};return Ui.createProfileForPageEditor(n)}(U.get("content-type"),a).plugins.join(",");c&&(t.plugins+=",".concat(c)),Pi.preInitialise(t),Pi.initialise(),bi("confluence.editor")}else Pi.preInitialise(t)}(e)}))}))}))},0:function(e,t,n){e.exports=n("./src/index.ts")},"com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')":function(e,t){e.exports=require("confluence-editor/utils/attachments-insert-utils")},"com.atlassian.confluence.plugins.confluence-frontend:locale/require('confluence/locale')":function(e,t){e.exports=require("confluence/locale")},"com.atlassian.confluence.plugins.confluence-frontend:table-styles-editor/require('confluence/table-color-names')":function(e,t){e.exports=require("confluence/table-color-names")},"com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')":function(e,t){e.exports=require("confluence-macro-browser/macro-browser")},"com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')":function(e,t){e.exports=require("confluence-rest/confluence-rest")},"confluence.web.components:confluence/require('confluence/root')":function(e,t){e.exports=require("confluence/root")},"confluence.web.resources:ajs/require('ajs')":function(e,t){e.exports=require("ajs")},"confluence.web.resources:jquery/require('jquery')":function(e,t){e.exports=require("jquery")},"confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')":function(e,t){e.exports=require("confluence/macro-js-overrides")},"confluence.web.resources:meta/require('confluence/meta')":function(e,t){e.exports=require("confluence/meta")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:bookmark-manager-conf-frontend', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
define("confluence-editor/atlassian-editor-bookmark-manager",["tinymce","ajs"],function(c,e){var b;return{storeBookmark:function(){var a=c.activeEditor,d=c.DOM.getViewPort(c.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"===typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:d.x,scrollY:d.y,range:a};e.log("Storing bookmark");e.log(b)},restoreBookmark:function(){var a=c.activeEditor.selection,d=c.activeEditor.getWin();e.log("Restoring bookmark");
e.log(b);b&&(d.scrollTo(b.scrollX,b.scrollY),d.focus(),a.setRng(b.range));b=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/atlassian-editor-bookmark-manager","AJS.Rte.BookmarkManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:trigger', location = '/includes/js/trigger.js' */
define("confluence/trigger",["jquery","window"],function(b,c){return function(a,d){a=new b.Event(a);b(d||c.top.document).trigger(a);return!a.isDefaultPrevented()}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/trigger","AJS.jiraTrigger");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:keyboard', location = '/includes/js/api/keyboard.js' */
define("confluence/api/keyboard",["jquery"],function(f){function b(a,b,c){h[b]=a;i[a]=b;c&&(j[b]=!0);return a}function g(a){a=a.originalEvent||a;return null==a.which?a.keyCode:0!==a.which&&0!==a.charCode?a.which:null}function k(a){var a=a.originalEvent||a,b=e.specialKeyEntered(a);if(b)return b;if(f.browser.mozilla){if("keypress"===a.type&&(a=g(a),null!==a))return String.fromCharCode(a).toLowerCase()}else if("keypress"!==a.type)return String.fromCharCode(a.keyCode).toLowerCase()}var e={},h={},i={},
j={},c=e.SpecialKey={BACKSPACE:b("backspace",8,!0),TAB:b("tab",9,!0),RETURN:b("return",13,!0),SHIFT:b("shift",16),CTRL:b("ctrl",17),ALT:b("alt",18),PAUSE:b("pause",19),CAPS_LOCK:b("capslock",20),ESC:b("esc",27,!0),SPACE:b("space",32,!0),PAGE_UP:b("pageup",33),PAGE_DOWN:b("pagedown",34),END:b("end",35),HOME:b("home",36),LEFT:b("left",37),UP:b("up",38),RIGHT:b("right",39),DOWN:b("down",40),INSERT:b("insert",45),DELETE:b("del",46),F1:b("f1",112),F2:b("f2",113),F3:b("f3",114),F4:b("f4",115),F5:b("f5",
116),F6:b("f6",117),F7:b("f7",118),F8:b("f8",119),F9:b("f9",120),F10:b("f10",121),F11:b("f11",122),F12:b("f12",123),NUMLOCK:b("numlock",144),SCROLL:b("scroll",145),META:b("meta",224)};c.eventType=function(){return f.browser.mozilla?"keypress":"keydown"};c.fromKeyCode=function(a){return h[a]};c.toKeyCode=function(a){return i[a]};c.isAscii=function(a){return!!j[a]};c.isSpecialKey=function(a){return!!c.toKeyCode(a)};e.characterEntered=function(a){a=a.originalEvent||a;if("keypress"===a.type&&(a=g(a),
null!==a&&(!c.isAscii(a)||c.fromKeyCode(a)===c.SPACE)))return String.fromCharCode(a)};e.specialKeyEntered=function(a){a=a.originalEvent||a;if(f.browser.mozilla){if("keypress"===a.type){var b=g(a);if(null===b)return c.fromKeyCode(a.keyCode);if(c.isAscii(b))return c.fromKeyCode(b)}}else if("keypress"!==a.type)return c.fromKeyCode(a.keyCode)};e.shortcutEntered=function(a){a=a.originalEvent||a;if(a.type===e.SpecialKey.eventType()){var b=e.specialKeyEntered(a),d="";a.altKey&&b!==c.ALT&&(d+=c.ALT+"+");
a.ctrlKey&&b!==c.CTRL&&(d+=c.CTRL+"+");a.metaKey&&(!a.ctrlKey&&b!==c.META)&&(d+=c.META+"+");a.shiftKey&&b!==c.SHIFT&&(d+=c.SHIFT+"+");if(b)return d+b;if(0<d.length&&"shift+"!==d&&(a=k(a)))return d+a}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/keyboard","AJS.Keyboard");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/class.js' */
define("confluence/class",["jquery"],function(f){var j=function(d){var a=function(){};a.prototype=d;return new a},i=!1,l=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,k=function(){};k.extend=function(){function d(){!i&&this.init&&this.init.apply(this,arguments)}var a,g=this.prototype;if(1<arguments.length){var c=f.makeArray(arguments);a=c.pop();var h;f.each(c,function(b,a){h=h?h.extend(a):a});return h.extend(this.prototype).extend(a)}a=arguments[0];i=!0;c=new this;i=!1;for(var b in a)if(c[b]="function"===
typeof a[b]&&"function"===typeof g[b]&&l.test(a[b]))c[b]=function(a,b){return function(){var c=this._super;this._super=g[a];var d=b.apply(this,arguments);this._super=c;return d}}(b,a[b]);else if("object"===typeof g[b]){var e=j(a[b]);f.each(g[b],function(a,b){if(e[a]){if("object"===typeof e[a]){var c=j(e[a]);f.each(b,function(a,b){c[a]||(c[a]=b)});e[a]=c}}else e[a]=b});c[b]=e}else c[b]=a[b];d.prototype=c;d.constructor=d;d.extend=arguments.callee;return d};return k});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/class","Class");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/control.js' */
define("confluence/control","confluence/class confluence/trigger confluence/api/logger confluence/api/keyboard jquery document".split(" "),function(k,l,i,g,d,e){return k.extend({INVALID:"INVALID",_throwReadOnlyError:function(a){Error(this.CLASS_SIGNATURE+": Sorry ["+a+"] is a read-only property")},_assignEvents:function(a,b){this._unassignEvents(a,b);if(typeof b==="string")for(var c in this._events[a])d(e).delegate(b,c,this._getDispatcher(a,c));else{b=d(b);for(c in this._events[a]){b.bind(c,this._getDispatcher(a,
c));i.debug("Control bound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}},_unassignEvents:function(a,b){if(typeof b==="string")for(var c in this._events[a])d(e).undelegate(b,c,this._getDispatcher(a,c));else{b=d(b);try{for(c in this._events[a])b.unbind(c,this._getDispatcher(a,c))}catch(g){var f=d._data(b[0],"events");if(f)for(c in f)if(c in this._events[a]){for(var m=this._getDispatcher(a,c),j=f[c],h=0;h<j.length;h++)if(j[h]===m){j.splice(h,1);break}i.debug("Control unbound eventType '"+
c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}}},_getDispatcher:function(a,b){var c=a+"/"+b;if(!this._dispatchers)this._dispatchers={};if(!this._dispatchers[c]){var e=this._events[a][b],f=this;this._dispatchers[c]=function(c){i.debug("Control dispatching eventType '"+b+"' for group '"+a+"' on instance '"+f.type+"'");return e.call(f,c,d(this))}}return this._dispatchers[c]},_isValidInput:function(){return true},_handleKeyEvent:function(a){if(this._isValidInput(a)){var b=g.SpecialKey,c=
g.shortcutEntered(a);if(c){if(this.keys[c]){this.keys[c].call(this,a);return}if((c===b.BACKSPACE||c===b.DELETE)&&this.keys.onEdit){this.keys.onEdit.call(this,a);return}}(b=g.characterEntered(a))&&this.keys.onEdit&&this.keys.onEdit.call(this,a,b)}},getCustomEventName:function(a){return(this.CLASS_SIGNATURE||"")+"_"+a},_getCustomEventArgs:function(){return[this]},trigger:function(a){return l(a,this)},_supportsBoxShadow:function(){var a=e.body.style;return a.WebkitBoxShadow!==void 0||a.MozBoxShadow!==
void 0||a.boxShadow!==void 0},_setOptions:function(a){var b,c,a=a||{};if(a instanceof d||typeof a==="string"||typeof a==="object"&&a.nodeName)a={element:a};b=d(a.element);c=b.getOptionsFromAttributes();this.options=d.extend(true,this._getDefaultOptions(a),c,a);if(b.length===0)return this.INVALID},getCaret:function(a){var b=a.selectionStart;if(b>=0)return a.selectionEnd>b?-1:b;if(e.selection){b=e.selection.createRange();if(b.text.length===0){var c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToStart",
b);return c.text.length}}return-1},_render:function(){var a,b=arguments[0],c=[];for(a=1;a<arguments.length;a++)c.push(arguments[a]);return this._renders[b].apply(this,c)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/control","AJS.Control");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/api/mouse.js' */
define("confluence/api/mouse",["jquery","window"],function(d,e){var b={MotionDetector:function(){this.reset()}};b.MotionDetector.prototype.reset=function(){this._y=this._x=this._handler=null;this.moved=!1};b.MotionDetector.prototype.wait=function(b){var a=this;a._handler||(this.reset(),d(e.top.document).bind("mousemove",a._handler=function(c){!a._x&&!a._y?(a._x=c.pageX,a._y=c.pageY):c.pageX===a._x&&c.pageY===a._y||(a.unbind(),a.moved=!0,b&&b.call(this,c))}))};b.MotionDetector.prototype.unbind=function(){this._handler&&
(d(e.top.document).unbind("mousemove",this._handler),this.reset())};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/mouse","AJS.Mouse");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/group.js' */
define("confluence/group",["confluence/control","confluence/api/logger","jquery"],function(d,e,c){return d.extend({init:function(){this.type=this.type||"Group";this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(a){this.items.push(a);this._assignEvents("item",a)},removeItem:function(a){var b=c.inArray(a,this.items);if(0>b)throw Error("Group: item ["+a+"] is not a member of this group");a.trigger("blur");b<this.index&&this.index--;this.items.splice(b,1);this._unassignEvents("item",
a)},removeAllItems:function(){for(var a=0;a<this.items.length;a++)this._unassignEvents("item",this.items[a]),this.items[a].trigger("blur");this.index=-1;this.items.length=0;this._unassignEvents("keys",document)},shiftFocus:function(a){e.debug("Group.shiftFocus called with offset: "+a);-1===this.index&&1===a&&(a=0);0<this.items.length&&(a=(Math.max(0,this.index)+this.items.length+a)%this.items.length,this.items[a].trigger("focus"))},prepareForInput:function(){this._assignEvents("keys",document)},_events:{instance:{focus:function(){0!==
this.items.length&&(0>this.index?this.items[0].trigger("focus"):this._assignEvents("keys",document))},blur:function(){0<=this.index?this.items[this.index].trigger("blur"):this._unassignEvents("keys",document)}},keys:{"keydown keypress":function(a){this._handleKeyEvent(a)}},item:{focus:function(a){var b=this.index;this.index=c.inArray(a.target,this.items);0>b?this.trigger("focus"):b!==this.index&&this.items[b].trigger("blur")},blur:function(a){this.index===c.inArray(a.target,this.items)&&(this.index=
-1,this.trigger("blur"))},remove:function(a){this.removeItem(a.target)}}},keys:{}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/group","AJS.Group");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.js' */
define("confluence/select-grid",["ajs","jquery","confluence/templates","confluence/group","confluence/control"],function(g,d,j,e,m){var e=e.extend({init:function(a){this.type=this.type||"SelectGrid";this._super();var b=d(j.SelectGrid.gridOutline()),c=b.find("thead tr");d(a.columns).each(function(a,b){var f=d("<th></th>").addClass(b.getClassName()).text(b.heading);c.append(f)});this.gridContainer=d(a.gridContainer).append(b);this.getRowId=a.getRowId;this.table=b;this.columns=a.columns;this.selectionCallback=
a.selectionCallback;this.body=b.find("tbody");this.body.delegate("a","click",function(a){a.preventDefault()});this.dontShiftFocus=a.dontShiftFocus||function(){}},keys:{up:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(-1),a.preventDefault())},down:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(1),a.preventDefault())}},_addRow:function(a,b,c,h){d.isFunction(c)&&(h=c,c=!1);c?this.body.prepend(a):this.body.append(a);a=new n({row:a,data:b,
callback:h,getRowId:this.getRowId,selectionCallback:h});this.addItem(a);return a},clear:function(){this.removeAllItems();this.body.children().remove()},_addRows:function(a,b){var c=this,h=[];d(a).each(function(a,f){var g=c.columns,e,i,k,l;e=d("<tr></tr>");d(g).each(function(a,b){i={outerClass:b.getClassName(f)||"",href:b.getHref&&b.getHref(f)||"",innerClass:b.getInnerClass&&b.getInnerClass(f)||"",title:b.getTitle&&b.getTitle(f)||"",text:b.getText(f)||""};k=i.href?"cellWithLink":"cellWithoutLink";
l=j.SelectGrid[k](i);e.append(l)});e.attr("data-id",c.getRowId(f));h.push(c._addRow(e,f,b,c.selectionCallback))});return h},update:function(a){this.clear();!a||!a.length?g.debug("SelectGrid.update called with no data, returning."):(this._addRows(a),this.prepareForInput())},prependAndSelect:function(a,b){!a||!a.length?g.debug("SelectGrid.prependAndSelect called with no data, returning."):this._addRows(a,!0)[b||0].selectRow()},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b].getRowId()==
a)return this.items[b];g.debug("SelectGrid.findItem didn't find item, returning null.");return null},select:function(a){(a=this.findItem(a))&&a.selectRow()},selectIndex:function(a){a=a||0;this.items[a]?this.items[a].selectRow():g.debug("SelectGrid.selectIndex couldn't select row with index "+a+", not found")},show:function(){this.gridContainer.removeClass("hidden")},hide:function(){this.gridContainer.addClass("hidden")},isVisible:function(){return!this.gridContainer.hasClass("hidden")}}),n=m.extend({init:function(a){this.type=
"SelectableRow";this.$row=d(a.row);this.$row.data("properties",a.data);this.getRowId=function(){return a.getRowId(a.data)};this.selectionCallback=a.selectionCallback;this._assignEvents("element",this.$row);this._assignEvents("instance",this);g.debug("SelectableRow initialized")},_events:{instance:{focus:function(){var a=this.$row;a.addClass("selected");this.selectionCallback(a,a.data("properties"))},blur:function(){this.$row.removeClass("selected")}},element:{click:function(){this.trigger("focus")}}},
selectRow:function(){this.trigger("focus")}});e.Column=function(a){var b=function(b){return b[a.key]};return{key:a.key,heading:a.heading,getClassName:a.getClassName||function(){return a.className||a.key+"-field"},getHref:a.getHref,getInnerClass:a.getInnerClass,getTitle:a.getTitle,getText:a.getText||b}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/select-grid","AJS.SelectGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.soy' */
// This file was automatically generated from select-grid.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SelectGrid.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SelectGrid == 'undefined') { Confluence.Templates.SelectGrid = {}; }


Confluence.Templates.SelectGrid.gridOutline = function(opt_data, opt_ignored) {
  return '<table class="select-grid aui"><thead><tr class="data-table-header"></tr></thead><tbody></tbody></table>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.gridOutline.soyTemplateName = 'Confluence.Templates.SelectGrid.gridOutline';
}


Confluence.Templates.SelectGrid.cellWithLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><a class="' + soy.$$escapeHtml(opt_data.innerClass) + '" href="' + soy.$$escapeHtml(opt_data.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithLink';
}


Confluence.Templates.SelectGrid.cellWithoutLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><span class="' + soy.$$escapeHtml(opt_data.innerClass) + '" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.text) + '</span></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithoutLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithoutLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/result-grid.js' */
define("confluence/result-grid",["ajs","jquery","confluence/control"],function(d,g,l){return l.extend({init:function(a){this.type=this.type||"ResultGrid";var c,f,k,h,j,e,i;f=a.gridContainer||g(a.baseElement).find(".data-table");f.length||d.debug("gridContainer for AJS.ResultGrid not found!");k=function(b){return b.id};c=new d.SelectGrid({gridContainer:f,columns:a.columns,selectionCallback:a.selectionCallback,getRowId:a.getRowId||k,dontShiftFocus:a.dontShiftFocus});e=a.messageHandler||d.MessageHandler({baseElement:g(a.baseElement).find(".message-panel")});
i=a.noResultMessage||"There are no results.";g.extend(this,{update:function(b,a){e.clearMessages();h&&(h(),j.remove(),h=null);c.clear();if(!b||!b.length){c.hide();var m=g.isFunction(i)?i(a):i;e.displayMessages(m);return!1}c.update(b);c.show();return!0},updateAndSelect:function(b,c,a){this.update(b,c)&&this.selectIndex(a)},prependAndSelect:function(b,a){!b||!b.length?d.debug("ResultGrid.prependAndSelect called with no data, returning."):(e.clearMessages(),c.prependAndSelect(b,
a),c.show())},select:function(b){c.select(b)},selectIndex:function(b){c.selectIndex(b)},clear:function(){e.clearMessages();c.hide()},loading:function(){c.show();var b=f.width(),a=f.height();this.clear();if(!h){var d,e;d=b/2-73;e=a/2-73;j=g("<div></div>").addClass("spinner-container").width(b-d).height(a-e).css({"padding-left":d,"padding-top":e}).insertAfter(f);h=Raphael.spinner(j[0],60,"#666")}},isVisible:function(){return c.isVisible()}})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/result-grid","AJS.ResultGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:breadcrumbs-jquery', location = '/includes/js/breadcrumbs-jquery.js' */
define("confluence/breadcrumbs-jquery",["jquery","confluence/templates"],function(e,h){return function(a){var i=this,f=[],b=0,c=a.length-1,d=a[b],j=i.closest(".breadcrumbs-container").width(),g=function(){return i.width()<j};for(f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));b++<c;)d=a[b],f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));this.html(f.join(""));a=e("li a span",this);a.each(function(a){0!==a&&a!==c&&e(this).shortenUntil(g)});
e(a.get(0)).shortenUntil(g);e(a.get(c)).shortenUntil(g);return this}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/breadcrumbs-jquery","jQuery.fn.renderBreadcrumbs");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/js/dialog-breadcrumbs.js' */
define("confluence/dialog-breadcrumbs",["ajs","jquery","confluence/meta","confluence/templates"],function(b,d,e,k){var h={},l=function(a,e,f){var g=a.userName?a.userName:a.pageId?a.pageId+":"+a.fileName:a.spaceKey+":"+a.title+":"+a.postingDay+":"+a.fileName;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+"/pages/breadcrumb.action",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==
a.type&&/peopledirectory\.action$/.test(c[0].url);)c.shift();"page"===a.type&&(c[1]&&/pages\.action/.test(c[1].url))&&c.splice(1,1);c.type=a.type;h[g]=c;e(c,b)}}})};return{getBreadcrumbsDefault:l,Breadcrumbs:function(a,h){var f=0;return{update:function(g,j){a.html(k.Dialog.breadcrumbLoading());var m=f+=1,c=function(){return m!==f?(b.debug("Breadcrumb response for ",g," is stale, ignoring."),!0):!1};(h||l)(g,function(f,h){if(!c())if("success"!==h||!f)a.html(k.Dialog.breadcrumbError());else{var i=g.spaceKey;
a.renderBreadcrumbs(f);if(!(i=i!==e.get("space-key")))a:{for(i=1;i<f.length;i++)if(f[i].title===e.get("page-title")){i=!1;break a}i=!0}i?(j.clearErrors(),d(j.moveButton).prop("disabled",!1)):(j.error("You cannot move a page to be underneath itself or its children."),d("li:last-child",a).addClass("warning"))}},function(d){c()||(a.html(k.Dialog.breadcrumbError()),404===d.status&&j.error("The specified page was not found."))})}}},getBreadcrumbsLegacy:function(a,e,f){if(!a.id)throw Error("id is a required parameter in 'options'");
if(!a.type)throw Error("type is a required parameter in 'options'");var g=a.id+":"+a.type;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+b.REST.getBaseUrl()+"breadcrumb",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==a.type&&/peopledirectory.action$/.test(c[0].url);)c.shift();c.type=a.type;h[g]=c;e(c,b)}}})}}});
require("confluence/module-exporter").safeRequire("confluence/dialog-breadcrumbs",function(b){var d=require("ajs"),e=require("confluence/legacy");d.toInit(function(){d.MoveDialog||(d.MoveDialog={});d.MoveDialog.Breadcrumbs=b.Breadcrumbs;d.MoveDialog.getBreadcrumbs=b.getBreadcrumbsDefault;d.Breadcrumbs={};d.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs||(e.Dialogs={});e.Dialogs.Breadcrumbs=d.Breadcrumbs;e.Dialogs.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs.Breadcrumbs.Controller=
b.Breadcrumbs;e.Dialogs.Breadcrumbs.defaultGetBreadcrumbs=b.getBreadcrumbsDefault})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/soy/dialog-breadcrumbs.soy' */
// This file was automatically generated from dialog-breadcrumbs.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Dialog == 'undefined') { Confluence.Templates.Dialog = {}; }


Confluence.Templates.Dialog.breadcrumbItem = function(opt_data, opt_ignored) {
  return '<li><a class="' + soy.$$escapeHtml(opt_data.className) + '" title="' + soy.$$escapeHtml(opt_data.title) + '" tabindex="-1"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbItem.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbItem';
}


Confluence.Templates.Dialog.breadcrumbLoading = function(opt_data, opt_ignored) {
  return '<li class="loading"><span>' + soy.$$filterNoAutoescape('Loading breadcrumbs...') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbLoading.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbLoading';
}


Confluence.Templates.Dialog.breadcrumbError = function(opt_data, opt_ignored) {
  return '<li class="warning last"><span>' + soy.$$escapeHtml('Error retrieving breadcrumbs.') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbError.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbError';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-location', location = '/includes/js/page-location.js' */
define("confluence/page-location",["ajs","confluence/meta"],function(c,a){var b=null;return{get:function(){return b?b:{spaceName:a.get("space-name"),spaceKey:a.get("space-key"),parentPageTitle:a.get("parent-page-title")}},set:function(a){b=a}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-location","Confluence.PageLocation");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.components:editor-notifications', location = '/includes/js/editor-notifications.js' */
define("confluence/editor-notifications",[],function(){var a;return{notify:function(b,c,d){var e=require("aui/flag");void 0!==a&&"true"!==a.getAttribute("aria-hidden")&&a.close();void 0===d&&(d="error"===b?"manual":"auto");a=e({type:b,body:c,close:d})}}});require("confluence/module-exporter").safeRequire("confluence/editor-notifications",function(a){var b=require("confluence/api/event"),c=require("confluence/legacy");b.bind("init.rte",function(){c.EditorNotification=a})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE', location = '/includes/js/amd/shim/confluence-editor-amd.js' */
define("confluence-editor/legacy",["confluence/legacy"],function(a){"undefined"===typeof a&&(a={});"undefined"===typeof a.Editor&&(a.Editor={});return a.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/js/draft-changes.js' */
define("confluence/draft-changes","jquery ajs window confluence/legacy confluence/api/ajax confluence/api/event confluence/api/logger confluence/analytics-support confluence/dark-features confluence/meta confluence/aui-overrides wrm/context-path".split(" "),function(b,d,q,c,v,r,n,k,s,j,t,l){return{init:function(){var a,p=function(a){var c="Are you sure you want to discard these unpublished changes?",f=b("#draft-"+a),h;if(confirm(c)){c=l()+"/rest/api/content/"+a+"?status=draft";h=b.ajax;h({url:c,type:"DELETE",data:{draftId:a},
contentType:"application/json",dataType:"json",success:function(a){if(a&&a.actionErrors){for(var b=["<ul>"],a=a.actionErrors,c=0;c<a.length;c++){n.log("error: "+a[c]);b.push("<li>"+a[c]+"</li>")}b.push("</ul>");d.messages.error("#errors",{title:"Error",body:"There were errors discarding your draft."+" "+b.join("\n")})}else{b=f.closest("table");a=b.closest(".drafts-container");f.remove();b.find("tbody tr").length===0&&a.append('<span id="no-drafts-message">'+
"No drafts found."+"</span>")}},error:function(a){d.messages.error("#errors",{title:"There were errors discarding your draft.",body:a.errors||"An unknown error has occurred. Please check your logs."})}});return true}return false};b("body").on("click",".view-diff-link",function(u){var o=this.id,f=b(this);if(!a){var h=o==="view-diff-link-notification";a=new d.Dialog(860,530,"view-diff-draft-dialog");var e="Unpublished Changes for \u0027{0}\u0027";a.addHeader(e.replace(/\{0\}/,""));e=b(c.Templates.DraftChanges.dialogContent());
a.addPanel("Diff",e);if(h){a.addButton("Edit",function(){a.hide();c.Editor&&c.Editor.Drafts?c.Editor.Drafts.useDraft():q.location=b(this).attr("data-href")},"resume-diff-link");a.addButton("Discard",function(){if(s.isEnabled("editor.ajax.save")&&j.get("remote-user")!==""){c.Editor.SafeSave.Draft.discardDraft(d.params.pageId,j.get("existing-draft-id")).done(c.Editor.SafeSave.Draft.onSuccessDiscardDraft).fail(c.Editor.SafeSave.Draft.onErrorDiscardDraft);a.hide()}else if(c.Editor&&
c.Editor.Drafts){a.hide();c.Editor.Drafts.discardDraft(j.get("existing-draft-id"));k.publish("rte.notification.draft.discard")}else{var g=b(this).data("draftid");p(g)&&a.hide()}},"discard-diff-link")}a.addCancel("Close",function(){a.hide();return false});e.removeClass("hidden")}a.addHeader("Loading");b("#diff-view").html("<tr><td id='draft-changes-waiting-icon'>Loading...</td></tr>");var m,e=f.attr("class"),i=/draftPageId:([^ ]*)/.exec(e),f=i?i[1]:j.get("page-id"),
h=(i=/username:([^ ]*)/.exec(e))?i[1]:j.get("remote-user");m=(i=/draftId:([^ ]*)/.exec(e))?i[1]:null;b.ajax({url:l()+"/draftchanges/viewdraftchanges.action",type:"GET",dataType:"json",data:{pageId:f,username:h},success:function(g){if(g.actionErrors){for(var e="",g=g.actionErrors,f=0;f<g.length;f++){n.log("error: "+g[f]);e=e+"<div>"+g[f]+"</div>"}b("#diff-view").html(e)}else{b("#diff-view").html(g.htmlDiff);e=d.format("Unpublished Changes for \u0027\u0027{0}\u0027\u0027",d.escapeHtml(g.title));a.addHeader(e);a.popup.element.find(".dialog-title").prepend(c.Templates.DraftChanges.helpLink());
b(".resume-diff-link").attr("data-href",l()+"/pages/resumedraft.action?draftId="+m);b(".discard-diff-link").data("draftid",m);t.setVisible("#merge-warning",g.isMergeRequired)}},error:function(a){a=a.errors||"An unknown error has occurred. Please check your logs";b("#diff-view").html(a)}});a.show();r.trigger("analytics",{name:"confluence.editor.view-diff-dialog.open",data:{elementTriggerId:o}});u.stopPropagation();return false});b(".drafts-by-space li.draft-actions-list-item").on("click",".discard-draft-link",
function(a){a.preventDefault();k.publish("confluence.draft-list.discard");a=b(this).data("draftid");p(a)}).on("click",".resume-draft-link",function(){k.publish("confluence.drafts.referrer",{referrerPage:"drafts",lozengeType:"Draft"})})}}});require("confluence/module-exporter").safeRequire("confluence/draft-changes",function(b){require("ajs").toInit(b.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/soy/draft-changes-dialog.soy' */
// This file was automatically generated from draft-changes-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DraftChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DraftChanges == 'undefined') { Confluence.Templates.DraftChanges = {}; }


Confluence.Templates.DraftChanges.dialogContent = function(opt_data, opt_ignored) {
  return '<div id="draft-changes-dialog" class="hidden"><div id="diff-view" class="wiki-content"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.dialogContent.soyTemplateName = 'Confluence.Templates.DraftChanges.dialogContent';
}


Confluence.Templates.DraftChanges.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-713/Drafts#viewchange"});
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.helpLink.soyTemplateName = 'Confluence.Templates.DraftChanges.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-soy', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.sharedDraftsEnabled) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save your page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item" id="rte-button-preview" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'blogpost' || opt_data.contentType == 'page')) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Update') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'page' || opt_data.contentType == 'blogpost')) ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit"><button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button></div>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish all changes?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('\x3cp\x3eThere are changes made by you and other people that haven\x27t been published yet.\x3c/p\x3e\x3cp\x3eThese people have made changes:\x3c/p\x3e') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList157 = opt_data.contributors;
  var contributorListLen157 = contributorList157.length;
  for (var contributorIndex157 = 0; contributorIndex157 < contributorListLen157; contributorIndex157++) {
    var contributorData157 = contributorList157[contributorIndex157];
    output += '<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(contributorData157.avatarURL) + '"/></span></span></div><div class="contributor-name"><span>' + soy.$$escapeHtml(contributorData157.fullname) + '</span></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore"],function(d,e){return{triggerEvent:function(b,a,c){a&&a.length&&(a={multiple:1<a.length,number:a.length,isAllImage:void 0===c?this._isAllImages(a):c},d.trigger("analyticsEvent",{name:b,data:a}))},_isAllImages:function(b){return e.every(b,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-owner-id="' + soy.$$escapeHtml(opt_data.file.ownerId) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.tooltip) + '">' + ((opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<i class="abs-icon select">Select</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedImageNameContent) + '</span>' + ((opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedParentTitleContent) + '</span>' : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItem.soyTemplateName = 'Confluence.Templates.File.fileDialogListItem';
}


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + ((opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<div id="docs-progress-bar-' + soy.$$escapeHtml(opt_data.file.fileId) + '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$escapeHtml(opt_data.file.fileName) + '</span><span class="caption owner-title hidden" title=""></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItemPlaceHolder.soyTemplateName = 'Confluence.Templates.File.fileDialogListItemPlaceHolder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
define("confluence-editor/files/file-item/file-item-model",["backbone","confluence/legacy","confluence/api/constants","ajs"],function(e,c,f,d){return e.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:!1,isFilePlaceHolder:!1,isSelect:!1,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.findMetadata();this.findVersion();this.findContainer();this.set("fileName",this.getFileName());this.set("nonceUrl",this.getNonceUrl());
this.set("isImage",this.isImage());this.set("isPreviewable",this.isPreviewable());this.get("isFilePlaceHolder")&&this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?!0:!!this.get("thumbnailUrl")},isPreviewable:function(){return"application/pdf"===(this.get("niceType")||"").toLocaleLowerCase()||
this.isImage()},getFileName:function(){return this.get("fileName")||this.get("title")||""},getDestinationUrl:function(){return d.REST.wikiLink(this.attributes).destination},getNonceUrl:function(){var a=this.get("thumbnailUrl");if(0<=a.indexOf("modificationDate"))return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);a&&(a+=(a.indexOf("?")+1?"&":"?")+"nonce="+b);return a},getRelativeUrl:function(a){var b=a;if(!a)return a;0===a.indexOf(c.getBaseUrl())&&(b=a.replace(c.getBaseUrl(),
""));return f.CONTEXT_PATH+b},_findThumbnailUrl:function(){var a=this.get("_links");!this.get("thumbnailUrl")&&(a&&a.thumbnail)&&this.set("thumbnailUrl",this.getRelativeUrl(a.thumbnail))},_findDownloadUrl:function(){var a=this.get("_links");!this.get("downloadUrl")&&a&&this.set("downloadUrl",this.getRelativeUrl(a.download))},findMetadata:function(){var a=this.get("metadata");!this.get("contentType")&&a&&(this.set("niceType",a.mediaType),this.set("contentType",a.mediaType))},findVersion:function(){var a=
this.get("version");!this.get("versionNumber")&&a&&this.set("versionNumber",a.number)},findContainer:function(){var a=this.get("container");a&&(-1===this.get("ownerId")&&this.set("ownerId",a.id),this.get("parentTitle")||this.set("parentTitle",a.title))},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_parseFileNameToAuiIconClass:function(a){return d.Confluence.FileTypesUtils.getAUIIconFromExt(this._getFileExtension(a))}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-model","Confluence.Editor.FileDialog.FileItemModel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
define("confluence-editor/files/file-item/file-item-view","backbone confluence/templates confluence/highlighter raphael underscore wrm jquery".split(" "),function(f,g,h,i,e,j,d){return f.View.extend({template:g.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},
render:function(){var a=this.highlighter||new h,b=this.model.get("space"),c=this.model.getFileName(),a={file:this.model.attributes,tooltip:this.showContainerInfo&&b?c+" ("+b.name+")":c,highlightedImageNameContent:a.highlight(c),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.get("container").title):null};this.$el=d(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:true});this.$el.attr("data-destination",this.model.getDestinationUrl());
this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",e.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("versionNumber")};
this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b={viewMode:"simple",openPreviewCallback:function(){d("#insert-image-dialog").hide();d(".aui-blanket").hide()},closePreviewCallback:function(){d("#insert-image-dialog").show();d(".aui-blanket").show()}},c=e.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},
this);this.dfd?this.dfd.done(e.partial(c,a,b)):this.dfd=j.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources",e.partial(c,a,b))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=i.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-view","Confluence.Editor.FileDialog.FileItemView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
define("confluence-editor/files/file-item/file-placeholder-view",["backbone","confluence/templates","underscore","ajs","jquery"],function(b,d,e,f,g){return b.View.extend({model:null,template:d.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",e.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=g(this.template({file:this.model.attributes}));
this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),f.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-placeholder-view","Confluence.Editor.FileDialog.FilePlaceHolderView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
define("confluence-editor/files/file-list/file-list-collection",["backbone","confluence-editor/files/file-item/file-item-model","underscore"],function(c,d,e){return c.Collection.extend({model:d,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){e.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();
for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-collection","Confluence.Editor.FileDialog.FileListCollection");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
define("confluence-editor/files/file-list/file-list-view","backbone confluence-editor/files/file-item/file-item-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-item/file-placeholder-view confluence/api/constants jquery".split(" "),function(f,g,h,i,j,c){return f.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;
if(a.eventListener){this.eventListener=a.eventListener;this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile);this.listenTo(this.eventListener,"uploadingfile.cancelled",this._cancelUploadingFile)}this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",
function(){this.context.setSelectItems(this.collection.getAllSelectItems())});this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var d=this;c.get(j.CONTEXT_PATH+"/rest/api/content/"+b+"?expand=version,container,space").done(function(b){var b=new h(b),c=d.collection.get(a);c||(c=d.collection.findWhere({fileName:b.get("fileName")}));c?
d.collection.replaceFile(c,b):d.collection.addFile(b)})},_cancelUploadingFile:function(a){(a=this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);this.collection.length===0&&this.$fileList.before(c("<p></p>").addClass("no-files").text(this.noFileMessage));
b.shouldClearSelection&&this.collection.clearSelection();this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new i({model:a,eventListener:this.eventListener})).render():(new g({model:a,showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||
a.set("isSelect",true)}},_removeItem:function(a){if(this.$fileList&&this.$fileList.length)(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=this._getViewFromModel(b),e=this._getDomElementByFileName(a.get("fileName"));e&&e.length?e.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",true)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var d=c(this);d.attr("data-file-name")===
a&&(b=d)});return b},updatePanelContext:function(a){if(a){this.panelContext=a;this.errors=this.panelContext.errors||[];this.$el=this.fileContainer=this.panelContext.fileContainer;this.el=this.$el[0];this.$fileList=this.$el.find(".file-list");this.delegateEvents();this.noFileMessage=this.panelContext.noFileMessage;this.showContainerInfo=this.panelContext.showContainerInfo;this.highlighter=this.panelContext.highlighter;this.displayErrors=this.panelContext.displayErrors}},updateDialogContext:function(a){if(a){this.context=
a;this.contextOptions=this.context.options}},_checkError:function(a){(a=a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&c(a.target);if(!a||!a.hasClass("close-tip")){this.collection.clearSelection();this.$el.find(".current").removeClass("current")}},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=c(a.target);if(!b.closest(".zoom").length){a.isTrigger||this.$fileList.find(".current").removeClass("current");
a=b.closest("li").attr("data-attachment-id");(a=this.collection.get(a))&&!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect"))}},_doubleClickItem:function(a){var a=c(a.target).closest("li"),b=a.attr("data-attachment-id");if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder")){a.click();this.context.insert()}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-view","Confluence.Editor.FileDialog.FileListView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
define("confluence-editor/files/base-panel/base-panel-view",["backbone","ajs","jquery"],function(b,a,c){return b.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"Error searching for attachments from Confluence. The server may be unavailable.",textErrorRetrieving:"Error retrieving attachments from Confluence. The server may be unavailable.",textDefaultErrorMessage:"Could not upload the file to Confluence. The server may be unavailable.",textUploading:"Image uploading...",initialize:function(){},createPanel:function(d){this.context=
d;this.render();var a=this;if(d=this.context.getPanel(this.panelId))d.onselect=function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return c(this.cssPanel,this.context.baseElement)},getContainer:function(){return c(this.cssContainer)},getForm:function(){return c("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},
displayErrors:function(a){this.uploader.displayErrors(a);this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/base-panel/base-panel-view","Confluence.Editor.FileDialog.BasePanel",function(){var b=require("underscore"),a=require("backbone");require("confluence/legacy").Editor.FileDialog.eventListener=b.extend({},a.Events)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_ignored) {
  return '' + ((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<label id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon aui-icon aui-icon-small aui-iconfont-upload">' + soy.$$escapeHtml('Upload files') + '</span>&nbsp;&nbsp;' + soy.$$escapeHtml('Upload files') + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</label>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml('Image uploading...') + '</div>' : '') + '</div>' : '') + ((opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.File.uploadFileForm.soyTemplateName = 'Confluence.Templates.File.uploadFileForm';
}


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_ignored) {
  return '<div id="attached-files" class="scroll-wrapper">' + aui.message.warning({title: '', closeable: 'true', content: ''}) + '<div class="loading-message hidden">' + soy.$$escapeHtml('Loading...') + '</div><ul class="file-list"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.attachedFilesPanel.soyTemplateName = 'Confluence.Templates.File.attachedFilesPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
define("confluence-editor/files/attachments-panel/attachments-panel-view","confluence-editor/files/file-list/file-list-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/legacy confluence/api/constants ajs confluence/meta underscore window jquery".split(" "),function(n,i,o,j,k,p,l,e,h,m,f,g){return j.extend({id:"attachments",panelId:"",cssPanel:".attachments-panel",
cssContainer:"#attached-files",textNoFileMessage:"There are no files attached to this page.",textPanelTitle:"Attached to this page",initialize:function(a){j.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;this.collection=new o;this.fileListView=new n({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",this);this.fileListView.updateDialogContext(this.context);
this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=g(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:this.textNoFileMessage,showContainerInfo:false,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);this.messenger=this.uploader.getMessageHandler();this.collection.reset();
this._canAttachFiles()?this.refresh({shouldClearSelection:true}):this.refresh({errors:["You\u0027ll need to ask permission to insert files here."],shouldClearSelection:true});return this},getPanel:function(){return k.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),atlToken:h.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+k.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=this;return{onUploadSuccess:function(b){for(var c=0;c<b.length;c++){var d=
b[c].id,e=a.collection.get(d);e&&a.collection.removeFile(e);g.get(l.CONTEXT_PATH+"/rest/api/content/"+d+"?expand=version,container,space").done(function(b){b=new i(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return p.AttachmentUploader({baseElement:this.getPanelElement()},
m.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,c=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):false,d=this.xhrCount=this.xhrCount+1;e.getJSONWrap({url:this._getUrlREST(),messageHandler:this.messenger,loadingElement:c,errorMessage:this.textErrorRetrieving,successCallback:function(c){if(d===b.xhrCount){a.data=c;b._onSuccessLoadFiles(a)}},errorCallback:m.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.results,
a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",a.find("li").length===1)},setUploadInProgress:function(a,b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,
b;try{a=new XMLHttpRequest;b=!(!a.sendAsBinary&&!a.upload)&&!(g.browser.mozilla&&g.browser.version.indexOf("1.9.1")>-1)}catch(c){b=false}return b},addPreviewImage:function(a){var b=require("tinymce");if(f.File&&f.FileReader&&f.FileList&&f.Blob){var c=this,b=b.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&a.nativeFile.size<b){var d=new FileReader;d.onload=function(){c._addFilePlaceHolderToCollection(a,d.result)};d.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,
null)}},_addFilePlaceHolderToCollection:function(a,b){var c=null,d=this.collection.findWhere({fileName:a.name});if(d){this.collection.removeFile(d);d.get("isFilePlaceHolder")?d.get("previousUploadedFile")&&(c=d.get("previousUploadedFile")):c=d}c=new i({isFilePlaceHolder:true,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,url:b||"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b||"",previousUploadedFile:c});this.collection.addFile(c)},_isImageType:function(a){return e.Confluence.FileTypesUtils.isImage(a)},
_canAttachFiles:function(){return h.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(h.get("attachment-source-content-id"),10);return l.CONTEXT_PATH+"/rest/api/content/"+a+"/child/attachment?expand=version,container,space"},focus:function(){this.collection.clearSelection()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/attachments-panel/attachments-panel-view","Confluence.Editor.FileDialog.AttachmentsPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_ignored) {
  return '<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">' + soy.$$escapeHtml('Image URL:') + '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="' + soy.$$escapeHtml('Preview') + '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">' + soy.$$escapeHtml('This image couldn\x27t be loaded for preview. Please check the URL.') + '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.webPanel.soyTemplateName = 'Confluence.Templates.File.webPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
define("confluence-editor/files/external-panel/external-panel-view",["confluence-editor/files/base-panel/base-panel-view","confluence/templates","jquery","raphael","ajs"],function(c,e,d,f,g){return c.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"Images from the web",template:e.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert",
"blur input.image-url":"_checkAllowInsert"},initialize:function(){c.prototype.initialize.call(this);this.context=null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();
this._checkAllowInsert()},getPanel:function(){this.$el=d(e.File.webPanel());this.el=this.$el[0];this.delegateEvents();return this.el},_getImageInput:function(){return d("input.image-url",this.context.baseElement)},_submit:function(b){b.preventDefault();b.stopPropagation();var a=this,b=this._getImageInput().val();if("http://"===b)return!1;this.token++;var c=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=f.spinner(this.throbber[0],
60,"#666"));this.error.addClass("hidden");d("<img>").load(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.preview.removeClass("faraway");a._checkAllowInsert()}}).error(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.error.removeClass("hidden");a._checkAllowInsert()}}).appendTo(this.preview).attr("src",b)},_checkAllowInsert:function(){var b=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==
b&&"http://"!==b?b:[])}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/external-panel/external-panel-view","Confluence.Editor.FileDialog.ExternalPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_ignored) {
  return '<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">' + soy.$$escapeHtml('All Spaces') + '</option><option value="' + soy.$$escapeHtml(opt_data.spaceKey) + '">' + soy.$$escapeHtml(opt_data.spaceName) + '</option></select><button type="submit" class="aui-button search-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">' + soy.$$escapeHtml('Searching...') + '</div><ul class="file-list"></ul></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.searchPanel.soyTemplateName = 'Confluence.Templates.File.searchPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
define("confluence-editor/files/search-panel/search-panel-view","confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-view confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/meta confluence/defaults confluence/highlighter confluence/api/constants underscore ajs jquery".split(" "),function(n,h,i,d,j,e,k,l,m,f,g,c){return d.extend({id:"search",panelId:"",cssPanel:".search-panel",
cssContainer:"#searched-images",template:j.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){d.prototype.initialize.call(this);this.context=null;this.collection=new i;this.fileListView=new h({collection:this.collection})},getPanel:function(){this.$el=c(this.template({spaceKey:e.get("space-key"),spaceName:e.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel("Search on other pages",
this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"No search results found.",showContainerInfo:true})},_submit:function(a){a.preventDefault();a.stopPropagation();if(this._getQuery()){this.clearContainer();this.collection.reset();this._loadImages().then(f.bind(this._onSuccessLoadFiles,this),f.bind(this._onErrorLoadFiles,this))}},_loadImages:function(){var a=this.getForm().find(".search-space").val(),b=this._getQuery(),
b='(title ~ "'+b+'*" OR parent.title ~ "'+b+'*") AND type = attachment';a&&a!==""&&(b=b+(" AND space.key = "+a));return c.ajax({type:"GET",dataType:"json",url:m.CONTEXT_PATH+"/rest/api/search",data:{cql:b,expand:"content.version,content.container,content.space",limit:k.maxResults}})},_onSuccessLoadFiles:function(a){a=a.results.map(function(a){return a.content});this.fileListView.highlighter=new l(this._getQuery().split(" "));this.fileListView.resetFileList(a,{shouldClearSelection:true})},_onErrorLoadFiles:function(){var a=
this.getContainer();a.find(".loading-message").addClass("hidden");a.append(c("<p class='warning'>"+c(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return c("input.search-image-text",this.getForm())},_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();this._getSearchText().focus()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/search-panel/search-panel-view","Confluence.Editor.FileDialog.SearchPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-713/Display+Files+and+Images") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.helpLink.soyTemplateName = 'Confluence.Templates.File.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
define("confluence-editor/files/file-dialog/file-dialog-view","backbone ajs confluence/templates underscore jquery document window".split(" "),function(j,e,k,f,d,i,l){return j.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;this.beforeShowListeners=a.beforeShowListeners;this.panelComponents=a.panelComponents},render:function(){this._createDialog();
this.clearSelection();d(i).on("keydown.insert-image",f.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=new e.Dialog(this.width,this.height,this.dialogId),m="Insert files and images",b="Insert";this.dialog=a;a.addHeader(m);a.addButton(b,f.bind(this._submitDialog,this),"insert");a.addCancel("Close",f.bind(this._killDialog,this));this.el=a.popup.element;this.$el=d(this.el);this.baseElement=this.el;
this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");d("#"+this.dialogId+" .dialog-components .dialog-title").prepend(k.File.helpLink());this.$el.find(".dialog-button-panel").append(d("<div></div>").addClass("dialog-tip").html("Hint: type \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 in the Editor to insert attached images on the page."));this._createPanels();d(i).on("hideLayer",f.bind(function(c,b,d){if(b==="popup"&&d===a.popup){d.remove();this.teardown();typeof this.cancelCallback==="function"&&this.cancelCallback()}},
this));e.bind("remove.dialog",f.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},this));a.show();return a},_createPanels:function(){var a=this;d.each(this.panelComponents,function(){this&&typeof this.createPanel==="function"&&this.createPanel(a)});e.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");d.each(this.beforeShowListeners,function(){typeof this==="function"&&this()})},teardown:function(){d(i).unbind(".insert-image");d(".tipsy").remove();this.undelegateEvents()},
_killDialog:function(){this.dialog.remove();this.clearSelection();typeof this.cancelCallback==="function"&&this.cancelCallback()},_submitDialog:function(){var a={url:this.urlExternalImg,contentId:e.Meta.get("attachment-source-content-id"),selectItems:this.selectItems};this.dialog.remove();typeof this.submitCallback==="function"&&this.submitCallback(a)},setSelectItems:function(a){if(typeof a==="string"){this.urlExternalImg=a;this.selectItems=[]}else{this.urlExternalImg="";this.selectItems=a}a=this.selectItems.length>
0||this.urlExternalImg;if(this.$insertButton){this.$insertButton.prop("disabled",!a);this.$insertButton.attr("aria-disabled",!a)}},clearSelection:function(){this.setSelectItems([])},insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!d("#"+
this.dialog.id).is(":hidden")){var e=this.dialog.getCurrentPanel().body,b=e.find(".attached-file");if(!(b.length===0||d(i.activeElement).is("input[type=text], select, button"))){var c=l.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var f=a.which,g;g=b.filter(".current");g.length||(g=b.filter(".selected"));if(g.length){g=b.index(g);var j=b.length,h={};h[c.LEFT]=-1;h[c.RIGHT]=1;h[c.UP]=-4;h[c.DOWN]=4;c=g+(h[f]?h[f]:0);b=b.eq(c<0||c>=j?g:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");
b.addClass("current");b.length&&e.find(".scroll-wrapper").simpleScrollTo(b);a.stopPropagation();return false;case c.SPACEBAR:e.find("li.attached-file.current").click();a.stopPropagation();return false;case c.ENTER:this.insert();a.stopPropagation();return false}}}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-dialog/file-dialog-view","Confluence.Editor.FileDialog.FileDialogView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_vendors~moment', location = 'vendors~moment.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[31],{107:function(e,t,n){(function(e){e.exports=function(){"use strict";var t,n;function s(){return t.apply(null,arguments)}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(a(e,t))return!1;return!0}function u(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var n,s=[],i=e.length;for(n=0;n<i;++n)s.push(t(e[n],n));return s}function c(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function f(e,t,n,s){return St(e,t,n,s,!0).utc()}function m(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function _(e){if(null==e._isValid){var t=m(e),s=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&s);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function y(e){var t=f(NaN);return null!=e?c(m(t),e):m(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),s=n.length>>>0;for(t=0;t<s;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var g=s.momentProperties=[],w=!1;function p(e,t){var n,s,i,r=g.length;if(u(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),u(t._i)||(e._i=t._i),u(t._f)||(e._f=t._f),u(t._l)||(e._l=t._l),u(t._strict)||(e._strict=t._strict),u(t._tzm)||(e._tzm=t._tzm),u(t._isUTC)||(e._isUTC=t._isUTC),u(t._offset)||(e._offset=t._offset),u(t._pf)||(e._pf=m(t)),u(t._locale)||(e._locale=t._locale),r>0)for(n=0;n<r;n++)u(i=t[s=g[n]])||(e[s]=i);return e}function v(e){p(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,s.updateOffset(this),w=!1)}function k(e){return e instanceof v||null!=e&&null!=e._isAMomentObject}function M(e){!1===s.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function D(e,t){var n=!0;return c((function(){if(null!=s.deprecationHandler&&s.deprecationHandler(null,e),n){var i,r,o,u=[],l=arguments.length;for(r=0;r<l;r++){if(i="","object"==typeof arguments[r]){for(o in i+="\n["+r+"] ",arguments[0])a(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[r];u.push(i)}M(e+"\nArguments: "+Array.prototype.slice.call(u).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var S,Y={};function O(e,t){null!=s.deprecationHandler&&s.deprecationHandler(e,t),Y[e]||(M(t),Y[e]=!0)}function b(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function x(e,t){var n,s=c({},e);for(n in t)a(t,n)&&(r(e[n])&&r(t[n])?(s[n]={},c(s[n],e[n]),c(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)a(e,n)&&!a(t,n)&&r(e[n])&&(s[n]=c({},s[n]));return s}function T(e){null!=e&&this.set(e)}function N(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}s.suppressDeprecationWarnings=!1,s.deprecationHandler=null,S=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)a(e,t)&&n.push(t);return n};var P=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,W=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,R={},C={};function U(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(C[e]=i),t&&(C[t[0]]=function(){return N(i.apply(this,arguments),t[1],t[2])}),n&&(C[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function H(e,t){return e.isValid()?(t=F(t,e.localeData()),R[t]=R[t]||function(e){var t,n,s,i=e.match(P);for(t=0,n=i.length;t<n;t++)C[i[t]]?i[t]=C[i[t]]:i[t]=(s=i[t]).match(/\[[\s\S]/)?s.replace(/^\[|\]$/g,""):s.replace(/\\/g,"");return function(t){var s,r="";for(s=0;s<n;s++)r+=b(i[s])?i[s].call(t,e):i[s];return r}}(t),R[t](e)):e.localeData().invalidDate()}function F(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(W.lastIndex=0;n>=0&&W.test(e);)e=e.replace(W,s),W.lastIndex=0,n-=1;return e}var L={};function V(e,t){var n=e.toLowerCase();L[n]=L[n+"s"]=L[t]=e}function E(e){return"string"==typeof e?L[e]||L[e.toLowerCase()]:void 0}function G(e){var t,n,s={};for(n in e)a(e,n)&&(t=E(n))&&(s[t]=e[n]);return s}var A={};function j(e,t){A[e]=t}function I(e){return e%4==0&&e%100!=0||e%400==0}function Z(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function z(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=Z(t)),n}function $(e,t){return function(n){return null!=n?(q(this,e,n),s.updateOffset(this,t),this):J(this,e)}}function J(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function q(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&I(e.year())&&1===e.month()&&29===e.date()?(n=z(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),ke(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}var B,Q=/\d/,X=/\d\d/,K=/\d{3}/,ee=/\d{4}/,te=/[+-]?\d{6}/,ne=/\d\d?/,se=/\d\d\d\d?/,ie=/\d\d\d\d\d\d?/,re=/\d{1,3}/,ae=/\d{1,4}/,oe=/[+-]?\d{1,6}/,ue=/\d+/,le=/[+-]?\d+/,he=/Z|[+-]\d\d:?\d\d/gi,de=/Z|[+-]\d\d(?::?\d\d)?/gi,ce=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function fe(e,t,n){B[e]=b(t)?t:function(e,s){return e&&n?n:t}}function me(e,t){return a(B,e)?B[e](t._strict,t._locale):new RegExp(_e(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,s,i){return t||n||s||i}))))}function _e(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}B={};var ye,ge={};function we(e,t){var n,s,i=t;for("string"==typeof e&&(e=[e]),l(t)&&(i=function(e,n){n[t]=z(e)}),s=e.length,n=0;n<s;n++)ge[e[n]]=i}function pe(e,t){we(e,(function(e,n,s,i){s._w=s._w||{},t(e,s._w,s,i)}))}function ve(e,t,n){null!=t&&a(ge,e)&&ge[e](t,n._a,n,e)}function ke(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?I(e)?29:28:31-s%7%2}ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},U("M",["MM",2],"Mo",(function(){return this.month()+1})),U("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),U("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),V("month","M"),j("month",8),fe("M",ne),fe("MM",ne,X),fe("MMM",(function(e,t){return t.monthsShortRegex(e)})),fe("MMMM",(function(e,t){return t.monthsRegex(e)})),we(["M","MM"],(function(e,t){t[1]=z(e)-1})),we(["MMM","MMMM"],(function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[1]=i:m(n).invalidMonth=e}));var Me="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),De="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Se=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ye=ce,Oe=ce;function be(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=f([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=ye.call(this._shortMonthsParse,a))?i:null:-1!==(i=ye.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=ye.call(this._shortMonthsParse,a))||-1!==(i=ye.call(this._longMonthsParse,a))?i:null:-1!==(i=ye.call(this._longMonthsParse,a))||-1!==(i=ye.call(this._shortMonthsParse,a))?i:null}function xe(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=z(t);else if(!l(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),ke(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Te(e){return null!=e?(xe(this,e),s.updateOffset(this,!0),this):J(this,"Month")}function Ne(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=f([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=_e(s[t]),i[t]=_e(i[t]);for(t=0;t<24;t++)r[t]=_e(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Pe(e){return I(e)?366:365}U("Y",0,0,(function(){var e=this.year();return e<=9999?N(e,4):"+"+e})),U(0,["YY",2],0,(function(){return this.year()%100})),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),V("year","y"),j("year",1),fe("Y",le),fe("YY",ne,X),fe("YYYY",ae,ee),fe("YYYYY",oe,te),fe("YYYYYY",oe,te),we(["YYYYY","YYYYYY"],0),we("YYYY",(function(e,t){t[0]=2===e.length?s.parseTwoDigitYear(e):z(e)})),we("YY",(function(e,t){t[0]=s.parseTwoDigitYear(e)})),we("Y",(function(e,t){t[0]=parseInt(e,10)})),s.parseTwoDigitYear=function(e){return z(e)+(z(e)>68?1900:2e3)};var We=$("FullYear",!0);function Re(e,t,n,s,i,r,a){var o;return e<100&&e>=0?(o=new Date(e+400,t,n,s,i,r,a),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,n,s,i,r,a),o}function Ce(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Ue(e,t,n){var s=7+t-n;return-(7+Ce(e,0,s).getUTCDay()-t)%7+s-1}function He(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ue(e,s,i);return o<=0?a=Pe(r=e-1)+o:o>Pe(e)?(r=e+1,a=o-Pe(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Fe(e,t,n){var s,i,r=Ue(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Le(i=e.year()-1,t,n):a>Le(e.year(),t,n)?(s=a-Le(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Le(e,t,n){var s=Ue(e,t,n),i=Ue(e+1,t,n);return(Pe(e)-s+i)/7}function Ve(e,t){return e.slice(t,7).concat(e.slice(0,t))}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),V("week","w"),V("isoWeek","W"),j("week",5),j("isoWeek",5),fe("w",ne),fe("ww",ne,X),fe("W",ne),fe("WW",ne,X),pe(["w","ww","W","WW"],(function(e,t,n,s){t[s.substr(0,1)]=z(e)})),U("d",0,"do","day"),U("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),U("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),U("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),V("day","d"),V("weekday","e"),V("isoWeekday","E"),j("day",11),j("weekday",11),j("isoWeekday",11),fe("d",ne),fe("e",ne),fe("E",ne),fe("dd",(function(e,t){return t.weekdaysMinRegex(e)})),fe("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),fe("dddd",(function(e,t){return t.weekdaysRegex(e)})),pe(["dd","ddd","dddd"],(function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:m(n).invalidWeekday=e})),pe(["d","e","E"],(function(e,t,n,s){t[s]=z(e)}));var Ee="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ge="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ae="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),je=ce,Ie=ce,Ze=ce;function ze(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=f([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=ye.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=ye.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=ye.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=ye.call(this._weekdaysParse,a))||-1!==(i=ye.call(this._shortWeekdaysParse,a))||-1!==(i=ye.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=ye.call(this._shortWeekdaysParse,a))||-1!==(i=ye.call(this._weekdaysParse,a))||-1!==(i=ye.call(this._minWeekdaysParse,a))?i:null:-1!==(i=ye.call(this._minWeekdaysParse,a))||-1!==(i=ye.call(this._weekdaysParse,a))||-1!==(i=ye.call(this._shortWeekdaysParse,a))?i:null}function $e(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=f([2e3,1]).day(t),s=_e(this.weekdaysMin(n,"")),i=_e(this.weekdaysShort(n,"")),r=_e(this.weekdays(n,"")),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);a.sort(e),o.sort(e),u.sort(e),l.sort(e),this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Je(){return this.hours()%12||12}function qe(e,t){U(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function Be(e,t){return t._meridiemParse}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Je),U("k",["kk",2],0,(function(){return this.hours()||24})),U("hmm",0,0,(function(){return""+Je.apply(this)+N(this.minutes(),2)})),U("hmmss",0,0,(function(){return""+Je.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)})),U("Hmm",0,0,(function(){return""+this.hours()+N(this.minutes(),2)})),U("Hmmss",0,0,(function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)})),qe("a",!0),qe("A",!1),V("hour","h"),j("hour",13),fe("a",Be),fe("A",Be),fe("H",ne),fe("h",ne),fe("k",ne),fe("HH",ne,X),fe("hh",ne,X),fe("kk",ne,X),fe("hmm",se),fe("hmmss",ie),fe("Hmm",se),fe("Hmmss",ie),we(["H","HH"],3),we(["k","kk"],(function(e,t,n){var s=z(e);t[3]=24===s?0:s})),we(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),we(["h","hh"],(function(e,t,n){t[3]=z(e),m(n).bigHour=!0})),we("hmm",(function(e,t,n){var s=e.length-2;t[3]=z(e.substr(0,s)),t[4]=z(e.substr(s)),m(n).bigHour=!0})),we("hmmss",(function(e,t,n){var s=e.length-4,i=e.length-2;t[3]=z(e.substr(0,s)),t[4]=z(e.substr(s,2)),t[5]=z(e.substr(i)),m(n).bigHour=!0})),we("Hmm",(function(e,t,n){var s=e.length-2;t[3]=z(e.substr(0,s)),t[4]=z(e.substr(s))})),we("Hmmss",(function(e,t,n){var s=e.length-4,i=e.length-2;t[3]=z(e.substr(0,s)),t[4]=z(e.substr(s,2)),t[5]=z(e.substr(i))}));var Qe,Xe=$("Hours",!0),Ke={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Me,monthsShort:De,week:{dow:0,doy:6},weekdays:Ee,weekdaysMin:Ae,weekdaysShort:Ge,meridiemParse:/[ap]\.?m?\.?/i},et={},tt={};function nt(e,t){var n,s=Math.min(e.length,t.length);for(n=0;n<s;n+=1)if(e[n]!==t[n])return n;return s}function st(e){return e?e.toLowerCase().replace("_","-"):e}function it(t){var n=null;if(void 0===et[t]&&void 0!==e&&e&&e.exports&&function(e){return null!=e.match("^[^/\\\\]*$")}(t))try{n=Qe._abbr,function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}(),rt(n)}catch(e){et[t]=null}return et[t]}function rt(e,t){var n;return e&&((n=u(t)?ot(e):at(e,t))?Qe=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Qe._abbr}function at(e,t){if(null!==t){var n,s=Ke;if(t.abbr=e,null!=et[e])O("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=et[e]._config;else if(null!=t.parentLocale)if(null!=et[t.parentLocale])s=et[t.parentLocale]._config;else{if(null==(n=it(t.parentLocale)))return tt[t.parentLocale]||(tt[t.parentLocale]=[]),tt[t.parentLocale].push({name:e,config:t}),null;s=n._config}return et[e]=new T(x(s,t)),tt[e]&&tt[e].forEach((function(e){at(e.name,e.config)})),rt(e),et[e]}return delete et[e],null}function ot(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Qe;if(!i(e)){if(t=it(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=st(e[r]).split("-")).length,n=(n=st(e[r+1]))?n.split("-"):null;t>0;){if(s=it(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&nt(i,n)>=t-1)break;t--}r++}return Qe}(e)}function ut(e){var t,n=e._a;return n&&-2===m(e).overflow&&(t=n[1]<0||n[1]>11?1:n[2]<1||n[2]>ke(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,m(e)._overflowDayOfYear&&(t<0||t>2)&&(t=2),m(e)._overflowWeeks&&-1===t&&(t=7),m(e)._overflowWeekday&&-1===t&&(t=8),m(e).overflow=t),e}var lt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ht=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dt=/Z|[+-]\d\d(?::?\d\d)?/,ct=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ft=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mt=/^\/?Date\((-?\d+)/i,_t=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function gt(e){var t,n,s,i,r,a,o=e._i,u=lt.exec(o)||ht.exec(o),l=ct.length,h=ft.length;if(u){for(m(e).iso=!0,t=0,n=l;t<n;t++)if(ct[t][1].exec(u[1])){i=ct[t][0],s=!1!==ct[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=h;t<n;t++)if(ft[t][1].exec(u[3])){r=(u[2]||" ")+ft[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!dt.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),Mt(e)}else e._isValid=!1}function wt(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function pt(e){var t,n,s,i,r,a,o,u,l=_t.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(l){if(n=l[4],s=l[3],i=l[2],r=l[5],a=l[6],o=l[7],u=[wt(n),De.indexOf(s),parseInt(i,10),parseInt(r,10),parseInt(a,10)],o&&u.push(parseInt(o,10)),t=u,!function(e,t,n){return!e||Ge.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(n).weekdayMismatch=!0,n._isValid=!1,!1)}(l[1],t,e))return;e._a=t,e._tzm=function(e,t,n){if(e)return yt[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(l[8],l[9],l[10]),e._d=Ce.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function vt(e,t,n){return null!=e?e:null!=t?t:n}function kt(e){var t,n,i,r,a,o=[];if(!e._d){for(i=function(e){var t=new Date(s.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[2]&&null==e._a[1]&&function(e){var t,n,s,i,r,a,o,u,l;null!=(t=e._w).GG||null!=t.W||null!=t.E?(r=1,a=4,n=vt(t.GG,e._a[0],Fe(Yt(),1,4).year),s=vt(t.W,1),((i=vt(t.E,1))<1||i>7)&&(u=!0)):(r=e._locale._week.dow,a=e._locale._week.doy,l=Fe(Yt(),r,a),n=vt(t.gg,e._a[0],l.year),s=vt(t.w,l.week),null!=t.d?((i=t.d)<0||i>6)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||t.e>6)&&(u=!0)):i=r),s<1||s>Le(n,r,a)?m(e)._overflowWeeks=!0:null!=u?m(e)._overflowWeekday=!0:(o=He(n,s,i,r,a),e._a[0]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(a=vt(e._a[0],i[0]),(e._dayOfYear>Pe(a)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=Ce(a,0,e._dayOfYear),e._a[1]=n.getUTCMonth(),e._a[2]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[3]&&0===e._a[4]&&0===e._a[5]&&0===e._a[6]&&(e._nextDay=!0,e._a[3]=0),e._d=(e._useUTC?Ce:Re).apply(null,o),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[3]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(m(e).weekdayMismatch=!0)}}function Mt(e){if(e._f!==s.ISO_8601)if(e._f!==s.RFC_2822){e._a=[],m(e).empty=!0;var t,n,i,r,a,o,u,l=""+e._i,h=l.length,d=0;for(u=(i=F(e._f,e._locale).match(P)||[]).length,t=0;t<u;t++)r=i[t],(n=(l.match(me(r,e))||[])[0])&&((a=l.substr(0,l.indexOf(n))).length>0&&m(e).unusedInput.push(a),l=l.slice(l.indexOf(n)+n.length),d+=n.length),C[r]?(n?m(e).empty=!1:m(e).unusedTokens.push(r),ve(r,n,e)):e._strict&&!n&&m(e).unusedTokens.push(r);m(e).charsLeftOver=h-d,l.length>0&&m(e).unusedInput.push(l),e._a[3]<=12&&!0===m(e).bigHour&&e._a[3]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[3]=function(e,t,n){var s;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0),t):t}(e._locale,e._a[3],e._meridiem),null!==(o=m(e).era)&&(e._a[0]=e._locale.erasConvertYear(o,e._a[0])),kt(e),ut(e)}else pt(e);else gt(e)}function Dt(e){var t=e._i,n=e._f;return e._locale=e._locale||ot(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),k(t)?new v(ut(t)):(h(t)?e._d=t:i(n)?function(e){var t,n,s,i,r,a,o=!1,u=e._f.length;if(0===u)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<u;i++)r=0,a=!1,t=p({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Mt(t),_(t)&&(a=!0),r+=m(t).charsLeftOver,r+=10*m(t).unusedTokens.length,m(t).score=r,o?r<s&&(s=r,n=t):(null==s||r<s||a)&&(s=r,n=t,a&&(o=!0));c(e,n||t)}(e):n?Mt(e):function(e){var t=e._i;u(t)?e._d=new Date(s.now()):h(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=mt.exec(e._i);null===t?(gt(e),!1===e._isValid&&(delete e._isValid,pt(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:s.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):i(t)?(e._a=d(t.slice(0),(function(e){return parseInt(e,10)})),kt(e)):r(t)?function(e){if(!e._d){var t=G(e._i),n=void 0===t.day?t.date:t.day;e._a=d([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),kt(e)}}(e):l(t)?e._d=new Date(t):s.createFromInputFallback(e)}(e),_(e)||(e._d=null),e))}function St(e,t,n,s,a){var u,l={};return!0!==t&&!1!==t||(s=t,t=void 0),!0!==n&&!1!==n||(s=n,n=void 0),(r(e)&&o(e)||i(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=a,l._l=n,l._i=e,l._f=t,l._strict=s,(u=new v(ut(Dt(l))))._nextDay&&(u.add(1,"d"),u._nextDay=void 0),u}function Yt(e,t,n,s){return St(e,t,n,s,!1)}s.createFromInputFallback=D("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),s.ISO_8601=function(){},s.RFC_2822=function(){};var Ot=D("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Yt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()})),bt=D("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Yt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()}));function xt(e,t){var n,s;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Yt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var Tt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Nt(e){var t=G(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||t.isoWeek||0,o=t.day||0,u=t.hour||0,l=t.minute||0,h=t.second||0,d=t.millisecond||0;this._isValid=function(e){var t,n,s=!1,i=Tt.length;for(t in e)if(a(e,t)&&(-1===ye.call(Tt,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<i;++n)if(e[Tt[n]]){if(s)return!1;parseFloat(e[Tt[n]])!==z(e[Tt[n]])&&(s=!0)}return!0}(t),this._milliseconds=+d+1e3*h+6e4*l+1e3*u*60*60,this._days=+o+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=ot(),this._bubble()}function Pt(e){return e instanceof Nt}function Wt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Rt(e,t){U(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+N(~~(e/60),2)+t+N(~~e%60,2)}))}Rt("Z",":"),Rt("ZZ",""),fe("Z",de),fe("ZZ",de),we(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=Ut(de,e)}));var Ct=/([\+\-]|\d\d)/gi;function Ut(e,t){var n,s,i=(t||"").match(e);return null===i?null:0===(s=60*(n=((i[i.length-1]||[])+"").match(Ct)||["-",0,0])[1]+z(n[2]))?0:"+"===n[0]?s:-s}function Ht(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(k(e)||h(e)?e.valueOf():Yt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),s.updateOffset(n,!1),n):Yt(e).local()}function Ft(e){return-Math.round(e._d.getTimezoneOffset())}function Lt(){return!!this.isValid()&&this._isUTC&&0===this._offset}s.updateOffset=function(){};var Vt=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Et=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Gt(e,t){var n,s,i,r,o,u,h=e,d=null;return Pt(e)?h={ms:e._milliseconds,d:e._days,M:e._months}:l(e)||!isNaN(+e)?(h={},t?h[t]=+e:h.milliseconds=+e):(d=Vt.exec(e))?(n="-"===d[1]?-1:1,h={y:0,d:z(d[2])*n,h:z(d[3])*n,m:z(d[4])*n,s:z(d[5])*n,ms:z(Wt(1e3*d[6]))*n}):(d=Et.exec(e))?(n="-"===d[1]?-1:1,h={y:At(d[2],n),M:At(d[3],n),w:At(d[4],n),d:At(d[5],n),h:At(d[6],n),m:At(d[7],n),s:At(d[8],n)}):null==h?h={}:"object"==typeof h&&("from"in h||"to"in h)&&(r=Yt(h.from),o=Yt(h.to),i=r.isValid()&&o.isValid()?(o=Ht(o,r),r.isBefore(o)?u=jt(r,o):((u=jt(o,r)).milliseconds=-u.milliseconds,u.months=-u.months),u):{milliseconds:0,months:0},(h={}).ms=i.milliseconds,h.M=i.months),s=new Nt(h),Pt(e)&&a(e,"_locale")&&(s._locale=e._locale),Pt(e)&&a(e,"_isValid")&&(s._isValid=e._isValid),s}function At(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function jt(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function It(e,t){return function(n,s){var i;return null===s||isNaN(+s)||(O(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=s,s=i),Zt(this,Gt(n,s),e),this}}function Zt(e,t,n,i){var r=t._milliseconds,a=Wt(t._days),o=Wt(t._months);e.isValid()&&(i=null==i||i,o&&xe(e,J(e,"Month")+o*n),a&&q(e,"Date",J(e,"Date")+a*n),r&&e._d.setTime(e._d.valueOf()+r*n),i&&s.updateOffset(e,a||o))}Gt.fn=Nt.prototype,Gt.invalid=function(){return Gt(NaN)};var zt=It(1,"add"),$t=It(-1,"subtract");function Jt(e){return"string"==typeof e||e instanceof String}function qt(e){return k(e)||h(e)||Jt(e)||l(e)||function(e){var t=i(e),n=!1;return t&&(n=0===e.filter((function(t){return!l(t)&&Jt(e)})).length),t&&n}(e)||function(e){var t,n,s=r(e)&&!o(e),i=!1,u=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],l=u.length;for(t=0;t<l;t+=1)n=u[t],i=i||a(e,n);return s&&i}(e)||null==e}function Bt(e){var t,n=r(e)&&!o(e),s=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<i.length;t+=1)s=s||a(e,i[t]);return n&&s}function Qt(e,t){if(e.date()<t.date())return-Qt(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(n+1,"months")-s)))||0}function Xt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ot(e))&&(this._locale=t),this)}s.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",s.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Kt=D("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function en(){return this._locale}function tn(e,t){return(e%t+t)%t}function nn(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-126227808e5:new Date(e,t,n).valueOf()}function sn(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-126227808e5:Date.UTC(e,t,n)}function rn(e,t){return t.erasAbbrRegex(e)}function an(){var e,t,n=[],s=[],i=[],r=[],a=this.eras();for(e=0,t=a.length;e<t;++e)s.push(_e(a[e].name)),n.push(_e(a[e].abbr)),i.push(_e(a[e].narrow)),r.push(_e(a[e].name)),r.push(_e(a[e].abbr)),r.push(_e(a[e].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function on(e,t){U(0,[e,e.length],0,t)}function un(e,t,n,s,i){var r;return null==e?Fe(this,s,i).year:(t>(r=Le(e,s,i))&&(t=r),ln.call(this,e,t,n,s,i))}function ln(e,t,n,s,i){var r=He(e,t,n,s,i),a=Ce(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}U("N",0,0,"eraAbbr"),U("NN",0,0,"eraAbbr"),U("NNN",0,0,"eraAbbr"),U("NNNN",0,0,"eraName"),U("NNNNN",0,0,"eraNarrow"),U("y",["y",1],"yo","eraYear"),U("y",["yy",2],0,"eraYear"),U("y",["yyy",3],0,"eraYear"),U("y",["yyyy",4],0,"eraYear"),fe("N",rn),fe("NN",rn),fe("NNN",rn),fe("NNNN",(function(e,t){return t.erasNameRegex(e)})),fe("NNNNN",(function(e,t){return t.erasNarrowRegex(e)})),we(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,s){var i=n._locale.erasParse(e,s,n._strict);i?m(n).era=i:m(n).invalidEra=e})),fe("y",ue),fe("yy",ue),fe("yyy",ue),fe("yyyy",ue),fe("yo",(function(e,t){return t._eraYearOrdinalRegex||ue})),we(["y","yy","yyy","yyyy"],0),we(["yo"],(function(e,t,n,s){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[0]=n._locale.eraYearOrdinalParse(e,i):t[0]=parseInt(e,10)})),U(0,["gg",2],0,(function(){return this.weekYear()%100})),U(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),on("gggg","weekYear"),on("ggggg","weekYear"),on("GGGG","isoWeekYear"),on("GGGGG","isoWeekYear"),V("weekYear","gg"),V("isoWeekYear","GG"),j("weekYear",1),j("isoWeekYear",1),fe("G",le),fe("g",le),fe("GG",ne,X),fe("gg",ne,X),fe("GGGG",ae,ee),fe("gggg",ae,ee),fe("GGGGG",oe,te),fe("ggggg",oe,te),pe(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,s){t[s.substr(0,2)]=z(e)})),pe(["gg","GG"],(function(e,t,n,i){t[i]=s.parseTwoDigitYear(e)})),U("Q",0,"Qo","quarter"),V("quarter","Q"),j("quarter",7),fe("Q",Q),we("Q",(function(e,t){t[1]=3*(z(e)-1)})),U("D",["DD",2],"Do","date"),V("date","D"),j("date",9),fe("D",ne),fe("DD",ne,X),fe("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),we(["D","DD"],2),we("Do",(function(e,t){t[2]=z(e.match(ne)[0])}));var hn=$("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),V("dayOfYear","DDD"),j("dayOfYear",4),fe("DDD",re),fe("DDDD",K),we(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=z(e)})),U("m",["mm",2],0,"minute"),V("minute","m"),j("minute",14),fe("m",ne),fe("mm",ne,X),we(["m","mm"],4);var dn=$("Minutes",!1);U("s",["ss",2],0,"second"),V("second","s"),j("second",15),fe("s",ne),fe("ss",ne,X),we(["s","ss"],5);var cn,fn,mn=$("Seconds",!1);for(U("S",0,0,(function(){return~~(this.millisecond()/100)})),U(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),U(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),U(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),U(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),U(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),U(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),V("millisecond","ms"),j("millisecond",16),fe("S",re,Q),fe("SS",re,X),fe("SSS",re,K),cn="SSSS";cn.length<=9;cn+="S")fe(cn,ue);function _n(e,t){t[6]=z(1e3*("0."+e))}for(cn="S";cn.length<=9;cn+="S")we(cn,_n);fn=$("Milliseconds",!1),U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var yn=v.prototype;function gn(e){return e}yn.add=zt,yn.calendar=function(e,t){1===arguments.length&&(arguments[0]?qt(arguments[0])?(e=arguments[0],t=void 0):Bt(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||Yt(),i=Ht(n,this).startOf("day"),r=s.calendarFormat(this,i)||"sameElse",a=t&&(b(t[r])?t[r].call(this,n):t[r]);return this.format(a||this.localeData().calendar(r,this,Yt(n)))},yn.clone=function(){return new v(this)},yn.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Ht(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=E(t)){case"year":r=Qt(this,s)/12;break;case"month":r=Qt(this,s);break;case"quarter":r=Qt(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:Z(r)},yn.endOf=function(e){var t,n;if(void 0===(e=E(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?sn:nn,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-tn(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-tn(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-tn(t,1e3)-1}return this._d.setTime(t),s.updateOffset(this,!0),this},yn.format=function(e){e||(e=this.isUtc()?s.defaultFormatUtc:s.defaultFormat);var t=H(this,e);return this.localeData().postformat(t)},yn.from=function(e,t){return this.isValid()&&(k(e)&&e.isValid()||Yt(e).isValid())?Gt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},yn.fromNow=function(e){return this.from(Yt(),e)},yn.to=function(e,t){return this.isValid()&&(k(e)&&e.isValid()||Yt(e).isValid())?Gt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},yn.toNow=function(e){return this.to(Yt(),e)},yn.get=function(e){return b(this[e=E(e)])?this[e]():this},yn.invalidAt=function(){return m(this).overflow},yn.isAfter=function(e,t){var n=k(e)?e:Yt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=E(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},yn.isBefore=function(e,t){var n=k(e)?e:Yt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=E(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},yn.isBetween=function(e,t,n,s){var i=k(e)?e:Yt(e),r=k(t)?t:Yt(t);return!!(this.isValid()&&i.isValid()&&r.isValid())&&(("("===(s=s||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===s[1]?this.isBefore(r,n):!this.isAfter(r,n)))},yn.isSame=function(e,t){var n,s=k(e)?e:Yt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=E(t)||"millisecond")?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},yn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},yn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},yn.isValid=function(){return _(this)},yn.lang=Kt,yn.locale=Xt,yn.localeData=en,yn.max=bt,yn.min=Ot,yn.parsingFlags=function(){return c({},m(this))},yn.set=function(e,t){if("object"==typeof e){var n,s=function(e){var t,n=[];for(t in e)a(e,t)&&n.push({unit:t,priority:A[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}(e=G(e)),i=s.length;for(n=0;n<i;n++)this[s[n].unit](e[s[n].unit])}else if(b(this[e=E(e)]))return this[e](t);return this},yn.startOf=function(e){var t,n;if(void 0===(e=E(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?sn:nn,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=tn(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=tn(t,6e4);break;case"second":t=this._d.valueOf(),t-=tn(t,1e3)}return this._d.setTime(t),s.updateOffset(this,!0),this},yn.subtract=$t,yn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},yn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},yn.toDate=function(){return new Date(this.valueOf())},yn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?H(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):b(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",H(n,"Z")):H(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},yn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,s="moment",i="";return this.isLocal()||(s=0===this.utcOffset()?"moment.utc":"moment.parseZone",i="Z"),e="["+s+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=i+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+n)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(yn[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),yn.toJSON=function(){return this.isValid()?this.toISOString():null},yn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},yn.unix=function(){return Math.floor(this.valueOf()/1e3)},yn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},yn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},yn.eraName=function(){var e,t,n,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),s[e].since<=n&&n<=s[e].until)return s[e].name;if(s[e].until<=n&&n<=s[e].since)return s[e].name}return""},yn.eraNarrow=function(){var e,t,n,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),s[e].since<=n&&n<=s[e].until)return s[e].narrow;if(s[e].until<=n&&n<=s[e].since)return s[e].narrow}return""},yn.eraAbbr=function(){var e,t,n,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),s[e].since<=n&&n<=s[e].until)return s[e].abbr;if(s[e].until<=n&&n<=s[e].since)return s[e].abbr}return""},yn.eraYear=function(){var e,t,n,i,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(n=r[e].since<=r[e].until?1:-1,i=this.clone().startOf("day").valueOf(),r[e].since<=i&&i<=r[e].until||r[e].until<=i&&i<=r[e].since)return(this.year()-s(r[e].since).year())*n+r[e].offset;return this.year()},yn.year=We,yn.isLeapYear=function(){return I(this.year())},yn.weekYear=function(e){return un.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},yn.isoWeekYear=function(e){return un.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},yn.quarter=yn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},yn.month=Te,yn.daysInMonth=function(){return ke(this.year(),this.month())},yn.week=yn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},yn.isoWeek=yn.isoWeeks=function(e){var t=Fe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},yn.weeksInYear=function(){var e=this.localeData()._week;return Le(this.year(),e.dow,e.doy)},yn.weeksInWeekYear=function(){var e=this.localeData()._week;return Le(this.weekYear(),e.dow,e.doy)},yn.isoWeeksInYear=function(){return Le(this.year(),1,4)},yn.isoWeeksInISOWeekYear=function(){return Le(this.isoWeekYear(),1,4)},yn.date=hn,yn.day=yn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},yn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},yn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},yn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},yn.hour=yn.hours=Xe,yn.minute=yn.minutes=dn,yn.second=yn.seconds=mn,yn.millisecond=yn.milliseconds=fn,yn.utcOffset=function(e,t,n){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ut(de,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=Ft(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!t||this._changeInProgress?Zt(this,Gt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,s.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Ft(this)},yn.utc=function(e){return this.utcOffset(0,e)},yn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ft(this),"m")),this},yn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ut(he,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},yn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Yt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},yn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},yn.isLocal=function(){return!!this.isValid()&&!this._isUTC},yn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},yn.isUtc=Lt,yn.isUTC=Lt,yn.zoneAbbr=function(){return this._isUTC?"UTC":""},yn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},yn.dates=D("dates accessor is deprecated. Use date instead.",hn),yn.months=D("months accessor is deprecated. Use month instead",Te),yn.years=D("years accessor is deprecated. Use year instead",We),yn.zone=D("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),yn.isDSTShifted=D("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!u(this._isDSTShifted))return this._isDSTShifted;var e,t={};return p(t,this),(t=Dt(t))._a?(e=t._isUTC?f(t._a):Yt(t._a),this._isDSTShifted=this.isValid()&&function(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&z(e[s])!==z(t[s]))&&a++;return a+r}(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var wn=T.prototype;function pn(e,t,n,s){var i=ot(),r=f().set(s,t);return i[n](r,e)}function vn(e,t,n){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return pn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=pn(e,s,n,"month");return i}function kn(e,t,n,s){"boolean"==typeof e?(l(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,l(t)&&(n=t,t=void 0),t=t||"");var i,r=ot(),a=e?r._week.dow:0,o=[];if(null!=n)return pn(t,(n+a)%7,s,"day");for(i=0;i<7;i++)o[i]=pn(t,(i+a)%7,s,"day");return o}wn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return b(s)?s.call(t,n):s},wn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(P).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])},wn.invalidDate=function(){return this._invalidDate},wn.ordinal=function(e){return this._ordinal.replace("%d",e)},wn.preparse=gn,wn.postformat=gn,wn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return b(i)?i(e,t,n,s):i.replace(/%d/i,e)},wn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return b(n)?n(t):n.replace(/%s/i,t)},wn.set=function(e){var t,n;for(n in e)a(e,n)&&(b(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},wn.eras=function(e,t){var n,i,r,a=this._eras||ot("en")._eras;for(n=0,i=a.length;n<i;++n){switch(typeof a[n].since){case"string":r=s(a[n].since).startOf("day"),a[n].since=r.valueOf()}switch(typeof a[n].until){case"undefined":a[n].until=1/0;break;case"string":r=s(a[n].until).startOf("day").valueOf(),a[n].until=r.valueOf()}}return a},wn.erasParse=function(e,t,n){var s,i,r,a,o,u=this.eras();for(e=e.toUpperCase(),s=0,i=u.length;s<i;++s)if(r=u[s].name.toUpperCase(),a=u[s].abbr.toUpperCase(),o=u[s].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(a===e)return u[s];break;case"NNNN":if(r===e)return u[s];break;case"NNNNN":if(o===e)return u[s]}else if([r,a,o].indexOf(e)>=0)return u[s]},wn.erasConvertYear=function(e,t){var n=e.since<=e.until?1:-1;return void 0===t?s(e.since).year():s(e.since).year()+(t-e.offset)*n},wn.erasAbbrRegex=function(e){return a(this,"_erasAbbrRegex")||an.call(this),e?this._erasAbbrRegex:this._erasRegex},wn.erasNameRegex=function(e){return a(this,"_erasNameRegex")||an.call(this),e?this._erasNameRegex:this._erasRegex},wn.erasNarrowRegex=function(e){return a(this,"_erasNarrowRegex")||an.call(this),e?this._erasNarrowRegex:this._erasRegex},wn.months=function(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Se).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone},wn.monthsShort=function(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Se.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},wn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return be.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=f([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},wn.monthsRegex=function(e){return this._monthsParseExact?(a(this,"_monthsRegex")||Ne.call(this),e?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=Oe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},wn.monthsShortRegex=function(e){return this._monthsParseExact?(a(this,"_monthsRegex")||Ne.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=Ye),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},wn.week=function(e){return Fe(e,this._week.dow,this._week.doy).week},wn.firstDayOfYear=function(){return this._week.doy},wn.firstDayOfWeek=function(){return this._week.dow},wn.weekdays=function(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ve(n,this._week.dow):e?n[e.day()]:n},wn.weekdaysMin=function(e){return!0===e?Ve(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},wn.weekdaysShort=function(e){return!0===e?Ve(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},wn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return ze.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=f([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},wn.weekdaysRegex=function(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=je),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},wn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ie),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},wn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ze),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},wn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},wn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},rt("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===z(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),s.lang=D("moment.lang is deprecated. Use moment.locale instead.",rt),s.langData=D("moment.langData is deprecated. Use moment.localeData instead.",ot);var Mn=Math.abs;function Dn(e,t,n,s){var i=Gt(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function Sn(e){return e<0?Math.floor(e):Math.ceil(e)}function Yn(e){return 4800*e/146097}function On(e){return 146097*e/4800}function bn(e){return function(){return this.as(e)}}var xn=bn("ms"),Tn=bn("s"),Nn=bn("m"),Pn=bn("h"),Wn=bn("d"),Rn=bn("w"),Cn=bn("M"),Un=bn("Q"),Hn=bn("y");function Fn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ln=Fn("milliseconds"),Vn=Fn("seconds"),En=Fn("minutes"),Gn=Fn("hours"),An=Fn("days"),jn=Fn("months"),In=Fn("years"),Zn=Math.round,zn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function $n(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}var Jn=Math.abs;function qn(e){return(e>0)-(e<0)||+e}function Bn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,s,i,r,a,o,u=Jn(this._milliseconds)/1e3,l=Jn(this._days),h=Jn(this._months),d=this.asSeconds();return d?(e=Z(u/60),t=Z(e/60),u%=60,e%=60,n=Z(h/12),h%=12,s=u?u.toFixed(3).replace(/\.?0+$/,""):"",i=d<0?"-":"",r=qn(this._months)!==qn(d)?"-":"",a=qn(this._days)!==qn(d)?"-":"",o=qn(this._milliseconds)!==qn(d)?"-":"",i+"P"+(n?r+n+"Y":"")+(h?r+h+"M":"")+(l?a+l+"D":"")+(t||e||u?"T":"")+(t?o+t+"H":"")+(e?o+e+"M":"")+(u?o+s+"S":"")):"P0D"}var Qn=Nt.prototype;return Qn.isValid=function(){return this._isValid},Qn.abs=function(){var e=this._data;return this._milliseconds=Mn(this._milliseconds),this._days=Mn(this._days),this._months=Mn(this._months),e.milliseconds=Mn(e.milliseconds),e.seconds=Mn(e.seconds),e.minutes=Mn(e.minutes),e.hours=Mn(e.hours),e.months=Mn(e.months),e.years=Mn(e.years),this},Qn.add=function(e,t){return Dn(this,e,t,1)},Qn.subtract=function(e,t){return Dn(this,e,t,-1)},Qn.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=E(e))||"quarter"===e||"year"===e)switch(t=this._days+s/864e5,n=this._months+Yn(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(On(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},Qn.asMilliseconds=xn,Qn.asSeconds=Tn,Qn.asMinutes=Nn,Qn.asHours=Pn,Qn.asDays=Wn,Qn.asWeeks=Rn,Qn.asMonths=Cn,Qn.asQuarters=Un,Qn.asYears=Hn,Qn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*z(this._months/12):NaN},Qn._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*Sn(On(o)+a),a=0,o=0),u.milliseconds=r%1e3,e=Z(r/1e3),u.seconds=e%60,t=Z(e/60),u.minutes=t%60,n=Z(t/60),u.hours=n%24,a+=Z(n/24),i=Z(Yn(a)),o+=i,a-=Sn(On(i)),s=Z(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},Qn.clone=function(){return Gt(this)},Qn.get=function(e){return e=E(e),this.isValid()?this[e+"s"]():NaN},Qn.milliseconds=Ln,Qn.seconds=Vn,Qn.minutes=En,Qn.hours=Gn,Qn.days=An,Qn.weeks=function(){return Z(this.days()/7)},Qn.months=jn,Qn.years=In,Qn.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,s,i=!1,r=zn;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(i=e),"object"==typeof t&&(r=Object.assign({},zn,t),null!=t.s&&null==t.ss&&(r.ss=t.s-1)),n=this.localeData(),s=function(e,t,n,s){var i=Gt(e).abs(),r=Zn(i.as("s")),a=Zn(i.as("m")),o=Zn(i.as("h")),u=Zn(i.as("d")),l=Zn(i.as("M")),h=Zn(i.as("w")),d=Zn(i.as("y")),c=r<=n.ss&&["s",r]||r<n.s&&["ss",r]||a<=1&&["m"]||a<n.m&&["mm",a]||o<=1&&["h"]||o<n.h&&["hh",o]||u<=1&&["d"]||u<n.d&&["dd",u];return null!=n.w&&(c=c||h<=1&&["w"]||h<n.w&&["ww",h]),(c=c||l<=1&&["M"]||l<n.M&&["MM",l]||d<=1&&["y"]||["yy",d])[2]=t,c[3]=+e>0,c[4]=s,$n.apply(null,c)}(this,!i,r,n),i&&(s=n.pastFuture(+this,s)),n.postformat(s)},Qn.toISOString=Bn,Qn.toString=Bn,Qn.toJSON=Bn,Qn.locale=Xt,Qn.localeData=en,Qn.toIsoString=D("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Bn),Qn.lang=Kt,U("X",0,0,"unix"),U("x",0,0,"valueOf"),fe("x",le),fe("X",/[+-]?\d+(\.\d{1,3})?/),we("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),we("x",(function(e,t,n){n._d=new Date(z(e))})),
//! moment.js
s.version="2.29.3",t=Yt,s.fn=yn,s.min=function(){var e=[].slice.call(arguments,0);return xt("isBefore",e)},s.max=function(){var e=[].slice.call(arguments,0);return xt("isAfter",e)},s.now=function(){return Date.now?Date.now():+new Date},s.utc=f,s.unix=function(e){return Yt(1e3*e)},s.months=function(e,t){return vn(e,t,"months")},s.isDate=h,s.locale=rt,s.invalid=y,s.duration=Gt,s.isMoment=k,s.weekdays=function(e,t,n){return kn(e,t,n,"weekdays")},s.parseZone=function(){return Yt.apply(null,arguments).parseZone()},s.localeData=ot,s.isDuration=Pt,s.monthsShort=function(e,t){return vn(e,t,"monthsShort")},s.weekdaysMin=function(e,t,n){return kn(e,t,n,"weekdaysMin")},s.defineLocale=at,s.updateLocale=function(e,t){if(null!=t){var n,s,i=Ke;null!=et[e]&&null!=et[e].parentLocale?et[e].set(x(et[e]._config,t)):(null!=(s=it(e))&&(i=s._config),t=x(i,t),null==s&&(t.abbr=e),(n=new T(t)).parentLocale=et[e],et[e]=n),rt(e)}else null!=et[e]&&(null!=et[e].parentLocale?(et[e]=et[e].parentLocale,e===rt()&&rt(e)):null!=et[e]&&delete et[e]);return et[e]},s.locales=function(){return S(et)},s.weekdaysShort=function(e,t,n){return kn(e,t,n,"weekdaysShort")},s.normalizeUnits=E,s.relativeTimeRounding=function(e){return void 0===e?Zn:"function"==typeof e&&(Zn=e,!0)},s.relativeTimeThreshold=function(e,t){return void 0!==zn[e]&&(void 0===t?zn[e]:(zn[e]=t,"s"===e&&(zn.ss=t-1),!0))},s.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},s.prototype=yn,s.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},s}()}).call(this,n(384)(e))},384:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_moment', location = 'moment.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[19],{383:function(a,e,n){"use strict";n.r(e);var c=n(107),s=n.n(c),d=n(13),t=n.n(d),o=n(12);t.a.moment=s.a,Object(o.a)("moment",()=>s.a)}},[[383,0,1,3,4,31,2]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:collaborative-helper', location = 'loader/collaborative-helper.js' */
define("confluence-editor/loader/collaborative-helper",["jquery","ajs","confluence/meta","confluence/legacy"],function(g,h,d,i){function b(a){var c=a||{},a=c.id||i.getContentId(),b=c.type||d.get("content-type"),c=c.editMode||d.get("edit-mode");return"collaborative"===c&&("page"===b||"blogpost"===b)&&a&&"0"!==a}var e,f=g.Deferred();return{registerPlugin:function(a){e=a;f.resolve()},isCollaborativeEditingAvailable:b,getEditorContent:function(){return f.pipe(function(){return b()&&"fake"!==d.get("collaborative-editor-status")?
e.getSynchronisedEditorContent():{content:h.Rte.getEditor().getContent()}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-message.js' */
define("confluence-editor/editor/page-editor-message",["jquery","ajs","aui/flag","document","underscore"],function(f,i,g,h,d){var b=Object.create(null),e=Object.create(null);h.addEventListener("aui-flag-close",function(a){a&&a.target&&(b=d.filter(Object.keys(b),function(c){return!f(a.target).find("span").hasClass(c)}))});return{handleMessage:function(a,c,d){b[a]||(e[a]?delete e[a]:c&&(b[a]=g({title:c.title?c.title:"",type:c.type,close:c.close?c.close:"manual",persistent:!1,body:"<span class='"+a+
"'>"+c.message+"</span>"}),d&&d()))},closeMessages:function(a){d.each(a,function(a){b[a]&&(b[a].close(),delete b[a])})},isDisplayed:function(a){return a in b},displayedErrors:function(){return Object.keys(b)},suppressMessage:function(a){e[a]={}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="There were errors discarding your draft.",d=d.errors||"An unknown error has occurred. Please check your logs.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="This page has already been published";d="You can no longer discard this draft because it\u0027s not a draft anymore!"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"Can\u0027t revert to last published version":h,message:i?"We can\u0027t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.js' */
define("confluence-editor/editor/page-editor","ajs confluence/legacy jquery document window confluence/meta confluence/api/constants confluence-editor/editor/page-editor-message confluence/aui-overrides".split(" "),function(d,c,b,j,O,f,n,k,m){function B(){var a=f.getBoolean("shared-drafts"),e=f.get("content-type")==="page"||f.get("content-type")==="blogpost",b=d.params.pageId!=="0";return e&&(b||a)}function C(a){b("#editpageform").find("input[name='atl_token']").val(a);f.set("atl-token",a);f.set("atlassian-token",
a);b("#atlassian-token").attr("content",a)}var u=d.DarkFeatures.isEnabled("editor.ajax.save")&&!d.DarkFeatures.isEnabled("editor.ajax.save.disable")&&f.get("remote-user")!=="",o=[],p=[],q=[],D=false,l=1,v=false,r,E=function(a){c.Editor.UI.setButtonState(a,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(a,c.Editor.UI.previewButton);c.Editor.UI.setButtonState(a,c.Editor.UI.cancelButton);b("#rte-show-changes").size()>0&&c.Editor.UI.setButtonState(a,b("#rte-show-changes"));b("#rte-show-revert").size()>
0&&c.Editor.UI.setButtonState(a,b("#rte-show-revert"))},s=function(a){var a=a||{},e=a.messageKey||"editor-error-message",c=a.message||"Something went wrong with the editor. Copy your unsaved changes and refresh the page to keep editing.",c={title:a.title,type:"error",message:c};a.close&&b.extend(c,{close:a.close});k.handleMessage(e,c,function(){a.disablePublish&&E(false)})},F=function(){return f.get("edit-mode")==="limited"},Q=function(a){var e=true;k.closeMessages(["offline-before-save-error"]);for(var b=0;b<p.length;b++){p[b](a)===false&&(e=false);if(a.isImmediatePropagationStopped())break}if(!e||
a.isDefaultPrevented()||a.isPropagationStopped())return false;a.preventDefault();G(a).done(w).fail(P)},P=function(a){var e=a||{};s({messageKey:e.messageKey||"offline-before-save-error",message:e.disablePublish?"Something went wrong with the editor. Copy your unsaved changes and refresh the page to keep editing.":"Unable to communicate with server. Saving is not possible at the moment.",disablePublish:e.disablePublish});a&&d.trigger("analytics",{name:"editor.save.error."+a.origin+"."+a.cause});c.Editor.UI.toggleSavebarBusy(false);c.Editor.Drafts.bindUnloadMessage()},G=function(a){var e=
b.Deferred();e.resolve(a);return e.promise()},H=function(){var a=function(){v=true;b(c.Editor.getCurrentForm()).submit();d.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}})},e=c.Editor.Drafts.getDraftSavingPromise();e?e.always(a):a()},w=H;d.bind("rte-ready",function(){d.Meta.getBoolean("collaborative-content")||b('meta[name="ajs-collaborative-editor-status"]').attr("content","off");c.Editor.UI.saveButton.bind("click",Q)});d.bind("editor.error.message",function(a,
e){s(e)});d.bind("dismiss.editor.error.message",function(a,e){k.closeMessages([e.messageKey]);e.enablePublish&&E(true)});var R=function(){var a;for(a=0;a<o.length;a++)c.Editor.UI.cancelButton.click(o[a]);var e=b(c.Editor.getCurrentForm());for(a=0;a<q.length;a++)e.submit(q[a]);b.unbind("init.rte",this)},I=function(a,e,c,h){h.push(c);if(d.Rte&&d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())a.bind(e,c);else if(!D){D=true;b.bind("init.rte",R)}},x=function(a,e,b){var c=null;d.Rte&&(d.Rte.BootstrapManager&&
d.Rte.BootstrapManager.isInitComplete())&&(c=function(a,e,b){a.unbind(e,b)});for(var f=b.pop();f;){c&&c(a,e,f);f=b.pop()}},J=function(a){if(g!==a){g&&g.clear();a.start(c.Editor.heartbeat);g=a}},g,K=f.getNumber("heartbeat-interval")||3E4,y,L;y={start:function(a){d.debug("Changing heartbeat to the normal scheduler");L=setInterval(a,K)},clear:function(){clearInterval(L)}};var M,N=Math.max(K/5,5E3),z,A;M={start:function(a){d.debug("Changing heartbeat to the recovery scheduler");A=0;var e=function(){a();
var b=N*Math.pow(2,A);z=setTimeout(e,Math.min(b,3E5));A++};z=setTimeout(e,N)},clear:function(){clearTimeout(z)}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:false,sourceInitialValue:false,isPublishing:function(a){typeof a!=="undefined"&&(v=a);return v},isLimitedModeEnabled:F,overrideBeforeSave:function(a){G=a},overrideSave:function(a){w=a},restoreDefaultSave:function(){w=H},getNumConcurrentEditors:function(){return l},
addCancelHandler:function(a){I(c.Editor.UI.cancelButton,"click",a,o)},addSaveHandler:function(a){p.push(a)},addSubmitHandler:function(a){I(b(c.Editor.getCurrentForm()),"submit",a,q)},removeAllCancelHandlers:function(){x(c.Editor.UI.cancelButton,"click",o)},removeAllSaveHandlers:function(){x(c.Editor.UI.saveButton,"click",p)},removeAllSubmitHandlers:function(){x(b(c.Editor.getCurrentForm()),"submit",q)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?
false:this.editorHasContentChanged()},editorHasContentChanged:function(){if(d.Rte.getEditor()==null){d.debug("Confluence.Editor: editorHasContentChanged - No active editor present. Returning false.");return false}return d.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(d.Rte.getEditor().getContent()).text();return!b.trim(a)},getResumeDraftUrl:function(){var a=[];a.push(n.CONTEXT_PATH);a.push("/pages/"+(d.params.newPage?"create":"edit")+d.params.draftType+".action");a.push("?useDraft=true");
a.push("&pageId="+d.params.pageId);a.push("&contentChanged="+this.hasContentChanged());this.getCurrentForm().spaceKey&&a.push("&spaceKey="+f.get("space-key"));return a.join("")},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){(F()||!c.Editor.Drafts.isSharedDraftsEnabled())&&c.Editor.Drafts.unBindUnloadMessage();b(".editable-title #content-title").prop("disabled",true);return true},metadataSyncRequired:B,heartbeat:function(){var a={dataType:"json",
contentId:f.get("content-id"),draftType:f.get("content-type"),spaceKey:d.params.spaceKey,contributorsHash:f.get("contributors-hash")};r=d.safe.post(n.CONTEXT_PATH+"/json/startheartbeatactivity.action",a,function(a){if(!B()&&a){C(a.atlToken);d.Meta.set("shared-drafts",a.editMode!=="legacy");d.trigger("rte.heartbeat",a)}else if(!a||!a.atlToken||!(a.activityResponses instanceof Array)){d.trigger("rte.heartbeat-error","Invalid server response");d.logError("Unexpected server response for heartbeat:");
d.log(a)}else{f.set("contributors-hash",a.contributorsHash);d.Meta.set("shared-drafts",a.editMode!=="legacy");var i=a.activityResponses;C(a.atlToken);c.Editor.heartbeatType.normal();d.trigger("rte.heartbeat",i);l=(i.length||0)+1;if(l>1){var h=!u?b("#other-users-span"):b("#reliable-other-users-span").length===0?b("<span id='reliable-other-users-span'></span>"):b("#reliable-other-users-span");h.empty();for(var t=0;t<l-1;++t){t>0&&h.append(", ");var g=i[t];h.append(b("<a></a>").attr("href",n.CONTEXT_PATH+
"/display/~"+encodeURIComponent(g.userName)).text(g.fullName));g.lastEditMessage!=null&&h.append(" ").append(b("<span></span>").addClass("smalltext").text(g.lastEditMessage))}u&&!k.isDisplayed(["heartBeat"])&&h.html().trim()!==""&&k.handleMessage("heartBeat",{type:"info",message:d.format("This page is also being edited by {0}. Your changes will be merged with theirs when you save.","<span id='reliable-other-users-span'>"+h.html()+"</span>")});b("#heartbeat-div").hasClass("hidden")&&d.Confluence.Analytics.publish("rte.notification.concurrent-editing",{numEditors:l,
pageId:d.params.pageId,draftType:d.params.draftType})}u&&l<=1&&k.closeMessages(["heartBeat"]);m.setVisible("#heartbeat-div",l>1);b(j).trigger("resize.resizeplugin");d.trigger("editor-heartbeat",a);a=a.editMode;if(a!==f.get("edit-mode")&&!(a==="collaborative"&&f.get("edit-mode")!=="limited")){f.set("edit-mode",a);a=a==="collaborative"?"Collaborative editing was switched off, but it\u0027s back in business. Copy your changes and refresh the page to keep editing.":"Copy any changes you want to keep, then refresh the page to continue editing.";s({messageKey:"edit-mode-transition",message:a,disablePublish:true})}}},
"json").fail(function(a,b,f){(a.status>=500||a.status===0)&&c.Editor.heartbeatType.recovery();if(a.status===403||a.status===401)d.logError("Heartbeat error: Unauthorized");else if(a.status===405)d.logError("Heartbeat error: Method not allowed");else{d.logError("Server error on heartbeat request:");d.log(f)}d.trigger("rte.heartbeat-error",a)})},heartbeatType:{normal:function(){J(y)},recovery:function(){J(M)},reset:function(){g&&g.clear();g=y;g.start(c.Editor.heartbeat)},cleanup:function(){if(g){g.clear();
g=null}r&&r.abort&&r.abort()}},disableFrame:function(a){b("form",a).each(function(){b(this).unbind();this.onsubmit=function(){return false}});b("a",a).each(function(){var a=b(this),c=a.attr("href");a.unbind();if(c&&c.charAt(0)!=="#"){a.attr("target","_top");a.bind("click",function(b){b.preventDefault();a.blur()})}});b("input, img",a).each(function(){b(this).unbind()})},previewFrameOnload:function(a,e){var i=require("tinymce");c.Editor.setMode(c.Editor.MODE_PREVIEW);i.activeEditor.setProgressState(false);
c.Editor.disableFrame(a);b(".tipsy").remove();var h=b("#main",a)[0];if(f.get("content-type")!=="comment"&&b(h).find("#main-header").length===0){var g=b("#title-heading"),k=g.attr("class");b(h).prepend('<div id="preview-header"><div id="title-heading" class="'+k+'">'+g.html()+"</div></div>")}if(b(d.Rte.getEditor().getBody()).hasClass("resizable")){var n=b(e||"#previewArea iframe"),l=0,m=0,o,p=n.height();h&&function S(){var a;if(b("#editor-preview-iframe").length){a=b(h).outerHeight(true);if(l!==a){a!==
n.height()&&n.height(0).height(Math.max(a,p));l=a;m=0}else m++;m<500&&(o=setTimeout(S,500))}}();b(j).one("mode-changed.resize-editor",function(a,b){b!==c.Editor.MODE_PREVIEW&&o&&clearTimeout(o)})}else if(i.isIE||i.isOpera){i=b(O).height();g=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height();k=b("#savebar-container").height();b("#preview iframe").height(i-g-k-4);b("#content.edit").height("auto")}},showRichText:function(a){var e=require("tinymce");m.setVisible("#wysiwyg",
a);b(".toolbar-group-preview").toggleClass("assistive",!a);b(".toolbar-group-edit").toggleClass("assistive",a);b("#main").toggleClass("active-richtext",a);e.isGecko&&a&&d.Rte.fixEditorFocus(c.Editor.bookmark)},showPreview:function(a){if(f.get("content-type")!=="comment"){var c=b("#content-title");if(c.hasClass("placeholded")){b("#preview-title-text").text("");b("#title-text").text("")}else{b("#preview-title-text").text(c.val());b("#title-text").text(c.val())}}m.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",
a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main").toggleClass("active-preview",a);b("#full-height-container").length&&b("#full-height-container").toggleClass("active-preview",a)},setMode:function(a){d.debug("Set mode: "+a);if(a===c.Editor.MODE_RICHTEXT){this.showRichText(true);this.showPreview(false)}else if(a===c.Editor.MODE_PREVIEW){this.showPreview(true);this.showRichText(false);c.Editor.UI.spinner.removeClass("aui-icon-wait")}setTimeout(function(){var a=b(".toolbar-group-preview");
a.height(0);a.height();a.height("auto")},1);this.currentEditMode=a;b(j).trigger("mode-changed",[a])},getContentId:function(){return c.getContentId()},addErrorMessage:function(a,c,f){var h=b("#"+a),f=f?"#any-messages":"#editor-messages";h.length?h.empty():h=b("<div></div>").attr("id",a).appendTo(f);d.messages.error(h,{closeable:true,body:c})},changeMode:function(a,e){var i=require("tinymce");d.debug("Change mode: "+a);e=e||{};if(this.inRichTextMode()&&!d.Rte.BootstrapManager.isInitComplete()||this.currentEditMode===
a)return false;var h=this.currentEditMode;d.trigger("rte-changeMode",a);if(a===c.Editor.MODE_PREVIEW){var g=d.Rte.getEditor();if(i.isGecko&&h===c.Editor.MODE_RICHTEXT&&!c.Editor.bookmark)c.Editor.bookmark=i.activeEditor.selection.getBookmark();this.currentEditMode=a;i={contentId:c.getContentId(),contentType:f.get("content-type"),spaceKey:f.get("space-key"),xHtml:g.getContent(),outputType:c.Editor.PREVIEW_OUTPUT_TYPE};d.safe.ajax({type:"POST",url:n.CONTEXT_PATH+"/pages/rendercontent.action",data:i,
success:c.Editor.replysetPreviewArea,timeout:2E4,error:function(){d.trigger("rte-preview-action-selected");d.trigger("rte.preview.error",{status:0});k.closeMessages(["server-offline"]);s({messageKey:"server-offline",message:"Can\u0027t reach the server. Check you\u0027re connected to the internet and Confluence is up and running.",disablePublish:false});c.Editor.currentEditMode=h;e.errorCallback&&e.errorCallback()}}).always(function(){f.getBoolean("shared-drafts")&&(f.get("content-type")==="page"||f.get("content-type")==="blogpost")&&c.Editor.Drafts.save({skipErrorHandler:true})})}else this.setMode(a);
a===c.Editor.MODE_RICHTEXT&&b(j).trigger("resize.resizeplugin");if(h===c.Editor.MODE_PREVIEW)if(i=j.getElementById("editor-preview-iframe")){g=i.contentDocument||i.contentWindow.document;g.removeChild(g.documentElement);b(i).remove()}return false},replysetPreviewArea:function(a){var c=require("tinymce");d.trigger("rte-preview-action-selected");b("#preview-error").remove();c.activeEditor.setProgressState(true);var c=b("#previewArea"),f=b('<iframe id="editor-preview-iframe" src="about:blank" scrolling="yes" frameborder="0"></iframe>');
c.html(f);c=f[0].contentDocument||f[0].contentWindow.document;c.open();c.write(a);c.close()},inRichTextMode:function(){return this.currentEditMode===c.Editor.MODE_RICHTEXT},isNewPage:function(){return b("#createpageform, #createpagetemplate").length>0},onInit:function(){c.Editor.setMode(c.Editor.MODE_RICHTEXT);d.Rte.getEditor().on("click",function(){var a=c.Editor.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=true},getCurrentForm:function(){return d.Rte.getEditor().formElement},
setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},isVisible:function(){return b("#wysiwyg:visible").length>0||b("#preview:visible").length>0}}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor",function(d){var c=require("confluence/legacy"),b=require("jquery"),j=require("ajs");c.Editor=b.extend(c.Editor||{},d);j.toInit(function(b){b(document).ajaxError(function(b,c){if(405===c.status)try{var d=JSON.parse(c.responseText).reason;"undefined"!==typeof d&&"READ_ONLY"===d&&(j.log("*** READ_ONLY mode detected ***"),j.trigger("rte.heartbeat-error",null,c))}catch(m){j.logError("Cannot parse xhr.responseText: "+
m)}});j.bind("init.rte",c.Editor.onInit)});j.Editor=c.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-ui.js' */
define("confluence-editor/editor/page-editor-ui","jquery confluence/templates ajs confluence/meta confluence/legacy window moment document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog confluence/form-state-control".split(" "),function(b,f,c,e,d,m,r,h,t,u,n,o){return function(){var a={},k=false,j=function(c,b){for(var b=b||a.buttons,d=0;d<b.length;d++)l(c,b[d])},l=function(a,b){if(b)if(a){b.removeAttr("aria-disabled");b.removeClass("disabled");
b.is("button")&&b.removeAttr("disabled")}else{b.attr("aria-disabled","true");b.addClass("disabled");b.is("button")&&b.attr("disabled","disabled")}},p=function(a){return a.length&&a.attr("aria-disabled")!=="true"},g=function(){return e.get("new-page")},q=function(){var a="";g()||(a="Edit"+" - ");return a};a.spinner=b("#rte-spinner");var i;i=f.Editor.Page.saveButton({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()});b("#rte-button-publish").replaceWith(i);
i=b("#rte-button-publish");a.saveButton=i;a.overwriteButton=b("#rte-button-overwrite");a.editButton=b("#rte-button-edit");a.previewButton=b("#rte-button-preview");a.cancelButton=b("#rte-button-cancel");a.versionCommentInput=b("#versionComment");a.watchPageCheckbox=b("#watchPage");a.watchPageToolbarGroup=b(".toolbar-group-watch-page");a.buttons=[a.saveButton,a.overwriteButton,a.editButton,a.previewButton,a.cancelButton];c.bind("editor-shared-drafts-published",function(){var b=/\(.+\)/g.exec(a.saveButton.data("tooltip"))[0];
a.saveButton.text(f.Editor.Page.saveButtonText({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()})).attr("title",f.Editor.Page.saveButtonTitle({contentType:e.get("content-type"),sharedDraftsEnabled:e.getBoolean("shared-drafts"),isNewPage:g()})+b).tooltip({gravity:"s"})});c.bind("synchrony.history.evicted",function(){k=true;l(false,a.versionCommentInput);try{c.Rte.getEditor().plugins.customtoolbar.disableToolbar(true);c.Rte.getEditor().plugins.customtoolbar.toggleToolbarButtons(true,
true,true)}catch(d){}try{c.Rte.getEditor().setMode("readonly")}catch(e){}try{c.Rte.getEditor().plugins.pagelayoutplugin.disableContent()}catch(h){}try{b("input#content-title").attr("disabled","true")}catch(v){}});a.setButtonsState=j;a.setButtonState=l;a.isButtonEnabled=p;a.registerFormButton=function(b,c){a[b]=c;a.buttons.push(c)};a.postingDatePicker=null;a.isFormEnabled=function(){for(var b=0;b<a.buttons.length;b++)if(p(a.buttons[b]))return true;return false};a.toggleSavebarBusy=function(b){if(k!==
true)if(b){if(!a.isFormEnabled())return false;a.spinner.addClass("aui-icon-wait");j(false)}else{a.spinner.removeClass("aui-icon-wait");j(true)}return true};a.init=function(){function f(){b("#rte-ellipsis-menu").is(":visible")&&b("#rte-button-ellipsis").trigger("aui-button-invoke")}n.init();d.Editor.addSaveHandler(function(b){if(a.isButtonEnabled(a.saveButton)){a.toggleSavebarBusy(true);c.trigger("confluence.editor.on.save")}else{b.stopImmediatePropagation();b.preventDefault()}});c.trigger("rte.init.ui");
d.Editor.isNewPage()&&b("#content-title").focus().select();d.Editor.addCancelHandler(function(b){d.Editor.getNumConcurrentEditors()>1&&c.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",{numEditors:d.Editor.getNumConcurrentEditors(),pageId:c.params.pageId,draftType:c.params.draftType});if(e.getBoolean("shared-drafts")&&(e.get("content-type")==="page"||e.get("content-type")==="blogpost"))if(a.isButtonEnabled(a.cancelButton))a.toggleSavebarBusy(true);else{b.stopImmediatePropagation();
b.preventDefault()}n.process(b)});e.get("content-type")==="comment"&&d.Editor.addSaveHandler(function(){var b=require("confluence/editor-notifications");if(c.Rte.Content.isEmpty()){b.notify("warning","Comment text is empty. Cannot create empty comments.");a.toggleSavebarBusy(false);return false}});(e.get("content-type")==="comment"||e.get("content-type")==="template")&&d.Editor.addCancelHandler(function(b){if(a.isFormEnabled()&&d.Editor.hasContentChanged()&&!d.Editor.isEmpty()){var s=e.get("content-type")==="comment"?"Your comment will be lost.":
"Your unsaved template changes will be lost.";if(!m.confirm(s)){b.stopImmediatePropagation();return false}}});a.versionCommentInput.on("keypress",function(a){a.keyCode===13&&n.process(a)});d.Editor.addSaveHandler(function(){d.Editor.getNumConcurrentEditors()>1&&c.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:d.Editor.getNumConcurrentEditors(),pageId:c.params.pageId,draftType:c.params.draftType})});d.Editor.addSubmitHandler(function(a){return d.Editor.contentFormSubmit(a)});
this.currentEditMode=this.MODE_RICHTEXT;a.editButton.click(function(b){var e=require("tinymce");if(a.isFormEnabled()){d.Editor.changeMode(d.Editor.MODE_RICHTEXT);setTimeout(function(){c.Rte.getEditor().focus();e.isGecko&&d.Editor.bookmark&&c.Rte.getEditor().selection.moveToBookmark(d.Editor.bookmark)},0);k!==true&&o.enableElement(a.cancelButton)}b.preventDefault()});a.previewButton.click(function(b){b.preventDefault();if(k!==true){b=require("tinymce");if(a.isFormEnabled()&&d.Editor.currentEditMode!==
d.Editor.MODE_PREVIEW){f();j(false);a.spinner.addClass("aui-icon-wait");if(b.isGecko&&!d.Editor.bookmark)d.Editor.bookmark=b.activeEditor.selection.getBookmark();d.Editor.changeMode(d.Editor.MODE_PREVIEW,{errorCallback:function(){j(true);a.spinner.removeClass("aui-icon-wait")}});e.get("content-type")==="comment"||e.get("content-type")==="template"?o.disableElement(a.cancelButton):o.enableElement(a.cancelButton)}}});b("#rte-button-labels").bind("updateLabel",function(){var a=+e.get("num-labels")||
0,d="Labels";a===1?d=c.format("{0} Label",a):a>1&&(d=c.format("{0} Labels",a));b("#rte-button-labels").attr("data-tooltip",d)});b("#draft-status-lozenge").length&&b("#draft-status-lozenge").tooltip();var g=b("#PostingDate");if(g.length){g.attr("max",r().format("YYYY-MM-DD"));a.postingDatePicker=g.datePicker({overrideBrowserDefault:true});a.postingDatePicker.hide()}b("#wysiwygTextarea_parent .mceProgress, #wysiwygTextarea_parent .mceBlocker").on("click",
function(){c.Rte.getEditor().focus()});b(m).bind("render-content-loaded",function(c,e){var f=b("#previewArea iframe");if(f.contents().find("body")[0]==e){d.Editor.previewFrameOnload(e,f);[a.saveButton,a.overwriteButton,a.editButton,a.previewButton].forEach(function(a){l(true,a)});f.focus();m.focus();b(h).trigger("iframeAppended",f)}});if(e.get("heartbeat")){d.Editor.heartbeat();d.Editor.heartbeatType.normal();c.bind("rte-destroyed",d.Editor.heartbeatType.cleanup)}c.bind("watchpage.pageoperation",
function(){a.toggleWatchPage(false)});c.bind("unwatchpage.pageoperation",function(){a.toggleWatchPage(true)});if(e.get("new-page")&&e.get("form-name")==="inlinecommentform")h.title="Edit"+h.title;var i=h.title;if(e.get("new-page")&&b.trim(b("input#content-title").val()))h.title=q()+b("input#content-title").val()+" - "+e.get("space-name")+" - "+e.get("site-title");b("input#content-title").on("change input",function(){if(e.get("content-type")!=="template"){var a=q();h.title=b.trim(this.value)?
a+this.value+" - "+e.get("space-name")+" - "+e.get("site-title"):i}});b("body",b("#wysiwygTextarea_ifr").contents()).click(f);c.trigger("init.rte-control")};a.toggleWatchPage=function(b){if(b&&e.get("content-type")==="comment"){a.watchPageToolbarGroup.show();if(a.watchPageCheckbox.length)a.watchPageCheckbox[0].checked=false}else a.watchPageToolbarGroup.hide()};return a}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-ui",function(b){var f=require("confluence/legacy");require("confluence/api/event").bind("init.rte",function(){var c=b();f.Editor.UI=c;c.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'tinymce3/plugins/insertwiki/insert-wiki-markup.soy' */
// This file was automatically generated from insert-wiki-markup.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.InsertWiki.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.InsertWiki == 'undefined') { Confluence.Templates.InsertWiki = {}; }


Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><textarea class=\'monospaceInput textarea originalDefault\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog';
}


Confluence.Templates.InsertWiki.previewWikiIframeContent = function(opt_data, opt_ignored) {
  return '<!DOCTYPE html><html class="insert-wiki-markup-dialog"><head></head><body class="wiki-content previewWiki"></body></html>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.previewWikiIframeContent.soyTemplateName = 'Confluence.Templates.InsertWiki.previewWikiIframeContent';
}


Confluence.Templates.InsertWiki.wikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<p id="insert-wiki-info-title">' + soy.$$escapeHtml('Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.') + '</p><form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><h3 class="wiki-title"><span id="insert-wiki-insert-title">' + soy.$$escapeHtml('Insert') + '</span><span id="insert-wiki-preview-title">' + soy.$$escapeHtml('Preview') + '</span></h3><textarea class=\'monospaceInput textarea\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea><!-- --><div class=\'example-container\' id=\'insert-wiki-textarea-preview\'></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiMarkupDialog';
}


Confluence.Templates.InsertWiki.wikiErrorSubDialog = function(opt_data, opt_ignored) {
  return '<p class=\'warning\'>' + soy.$$escapeHtml(opt_data.warningMessage) + '</p><p class=\'exception-report\'><span class=\'exceptionMessage\'>' + soy.$$escapeHtml(opt_data.exceptionMessage) + '</span></p>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiErrorSubDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiErrorSubDialog';
}


Confluence.Templates.InsertWiki.wikiParserSelector = function(opt_data, opt_ignored) {
  var output = '<span class="wiki-parser-selector"><form action="#" method="post" id="d" class="aui"><select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector"><option value="' + soy.$$escapeHtml(opt_data.DEFAULT.val) + '">' + soy.$$escapeHtml(opt_data.DEFAULT.label) + '</option>';
  var wikiLangList26 = soy.$$getMapKeys(opt_data.WIKI);
  var wikiLangListLen26 = wikiLangList26.length;
  for (var wikiLangIndex26 = 0; wikiLangIndex26 < wikiLangListLen26; wikiLangIndex26++) {
    var wikiLangData26 = wikiLangList26[wikiLangIndex26];
    output += (opt_data.WIKI[wikiLangData26].val != opt_data.DEFAULT.val) ? '<option value="' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].val) + '">' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].label) + '</option>' : '';
  }
  output += '</select></form></span>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiParserSelector.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiParserSelector';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.sharedDraftsEnabled) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save your page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item" id="rte-button-preview" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'blogpost' || opt_data.contentType == 'page')) ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Update') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.sharedDraftsEnabled && (opt_data.contentType == 'page' || opt_data.contentType == 'blogpost')) ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit"><button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button></div>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish all changes?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('\x3cp\x3eThere are changes made by you and other people that haven\x27t been published yet.\x3c/p\x3e\x3cp\x3eThese people have made changes:\x3c/p\x3e') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList157 = opt_data.contributors;
  var contributorListLen157 = contributorList157.length;
  for (var contributorIndex157 = 0; contributorIndex157 < contributorListLen157; contributorIndex157++) {
    var contributorData157 = contributorList157[contributorIndex157];
    output += '<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(contributorData157.avatarURL) + '"/></span></span></div><div class="contributor-name"><span>' + soy.$$escapeHtml(contributorData157.fullname) + '</span></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'insert-image-dialog/insert-image-dialog.js' */
define("confluence-editor/insert-image-dialog/insert-image-dialog",["jquery","ajs","underscore","confluence/legacy"],function(c,f,e,h){var g={beforeShowListeners:[],panelComponent:[],sizeToFit:function(){this.each(function(){var a=this,b=c(this).parent(),d=b.height();b.children().each(function(){this!==a&&c(this).is(":visible")&&(d-=c(this).outerHeight())});b=c(this).outerHeight()-c(this).height();c(this).css("height",Math.max(0,d-b)+"px")});return this},defaultInsertImageDialog:function(){f.Rte.BookmarkManager.storeBookmark();
g.insertImageDialog(function(a){var b=require("tinymce");f.Rte.BookmarkManager.restoreBookmark();var d={};if(a.url)d={url:a.url,filename:a.url,contentId:a.contentId},b.confluence.ImageUtils.insertFromProperties(d);else{var i=!0,h=1<a.selectItems.length;e.each(a.selectItems,function(a){a.isImage()?(d={filename:a.getFileName(),contentId:a.get("ownerId")},b.confluence.ImageUtils.insertFromProperties(d,h)):(i=!1,f.MacroBrowser.getMacroMetadata("view-file")?g._insertFilePlaceholderToEditor(a):g._insertLinkToEditor(a))});
require(["confluence-drag-and-drop/analytics/files-upload-analytics"],function(b){b.triggerEvent("confluence.insert-files-dialog.insert",a.selectItems,i)})}c("#comments-section").length&&f.Rte.fixEditorFocus()},function(){f.Rte.BookmarkManager.restoreBookmark()})},findPanelComponentById:function(a){for(var b=h.Editor.ImageDialog.panelComponent,d=0,c=b.length;d<c;d++)if(b[d].id==a)return b[d]},insertImageDialog:function(a,b){var d=new h.Editor.FileDialog.FileDialogView({submitCallback:a,cancelCallback:b,
beforeShowListeners:g.beforeShowListeners,panelComponents:g.panelComponent});d.render();return d},_insertLinkToEditor:function(a){var b=h.Link.fromREST(a.attributes);b.attrs["data-linked-resource-container-id"]=a.get("ownerId");b.attrs.href=a.get("downloadUrl");b.insert()},_insertFilePlaceholderToEditor:function(a){var b={name:a.get("fileName"),page:a.get("parentTitle"),space:a.get("space")?a.get("space").key:"",date:a.get("datePath"),ownerId:a.get("ownerId")};require(["confluence-editor/utils/attachments-insert-utils"],
function(a){a.insertFilePlaceholder(b)})}};return g});
require("confluence/module-exporter").safeRequire("confluence-editor/insert-image-dialog/insert-image-dialog",function(c){var f=require("jquery"),e=require("confluence/legacy");f.fn.sizeToFit=c.sizeToFit;e.Editor.ImageDialog=c;e.Editor.defaultInsertImageDialog=c.defaultInsertImageDialog;e.Editor.ImageDialog.findPanelComponentById=c.findPanelComponentById;e.Editor.insertImageDialog=c.insertImageDialog;e.Editor.ImageDialog._insertLinkToEditor=c._insertLinkToEditor;e.Editor.ImageDialog._insertFilePlaceholderToEditor=
c._insertFilePlaceholderToEditor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'panel-components/panel-components-init.js' */
define("confluence-editor/panel-components/panel-components-init",["confluence/legacy","confluence/meta"],function(a,d){return function(){if(a.Editor&&a.Editor.ImageDialog&&a.Editor.ImageDialog.panelComponent){var b=a.Editor.FileDialog.eventListener,e=a.Editor.FileDialog.ExternalPanelView,f=a.Editor.FileDialog.SearchPanelView,g=a.Editor.FileDialog.AttachmentsPanelView,c=a.Editor.ImageDialog.panelComponent;"template"!==d.get("content-type")&&(b=new g({eventListener:b}),c.push(b));c.push(new e);c.push(new f)}}});
require("confluence/module-exporter").safeRequire("confluence-editor/panel-components/panel-components-init",function(a){require("ajs").toInit(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'drafts/page-editor-drafts.js' */
define("confluence-editor/page-editor-drafts","jquery ajs confluence/meta confluence/legacy confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/loader/collaborative-helper".split(" "),function(d,a,g,b,n,s,t){var o=false,l=false,h=false,p=null,u=g.get("remote-user")!=="",v=a.DarkFeatures.isEnabled("editor.ajax.save")&&!a.DarkFeatures.isEnabled("editor.ajax.save.disable"),q=false,m=false,i=function(a,b,g){d("<input>").attr({type:"hidden",name:a,value:b}).appendTo(g)},
k=function(){return g.getBoolean("shared-drafts")};a.bind("editor-shared-drafts-published editor-shared-drafts-discarded",function(){l=o=false});a.bind("synchrony.history.evicted",function(){q=true});a.bind("synchrony.connected",function(){m=true});return{isDraftSaved:function(){return o},isDraftManuallySaved:function(){return l},isDraftBlank:function(){return a.Rte.Content.isEmpty()&&!d.trim(b.Editor.getCurrentTitle())},isNewContent:function(){return a.Rte.getEditor()&&g.getBoolean("new-page")===
true},isDraftDirty:function(){return b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved()},unloadMessage:function(){var e=function(){b.Editor.Drafts.isDraftBlank()&&!k()?b.Editor.Drafts.discardDraft(g.get("draft-id")):b.Editor.Drafts.save({skipErrorHandler:true})};if(typeof seleniumAlert!=="undefined")e();else if(b.Editor.isLimitedModeEnabled()||!k()){if(b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved()){e();
return "A draft will be saved. You can resume editing this draft the next time you open the editor or view all your drafts in your profile."}}else{e();if(m&&(h||b.Editor.hasContentChanged()||q))return "We haven\u0027t finished saving your changes. If you leave before seeing the \u0027Draft saved\u0027 message, you might lose your changes."}},hasPendingChanges:function(){return h},setPendingChanges:function(a){h=a},isSharedDraftsEnabled:k,bindUnloadMessage:function(){if(!b.Editor.isLimitedModeEnabled()&&k()){a.bind("synchrony.entity.ack",function(a,b){b.pendingChanges||(h=false)});a.bind("editor.local.change",function(){h=true})}d(window).bind("beforeunload",b.Editor.Drafts.unloadMessage)},
unBindUnloadMessage:function(){d(window).unbind("beforeunload")},useDraft:function(){var e=g.get("existing-draft-id");b.Editor.Drafts.unBindUnloadMessage();var c=b.Editor.getCurrentForm();i("useDraft","true",c);i("contentChanged",""+b.Editor.hasContentChanged(),c);i("pageId",a.params.pageId,c);d("#draftId",b.Editor.getCurrentForm()).val(e);c.spaceKey||i("spaceKey",g.get("space-key"),c);c.action=n.CONTEXT_PATH+"/pages/"+(a.params.newPage?"create":"edit")+a.params.draftType+".action";c.submit()},discardDraft:function(b){return a.safe.ajax({url:n.CONTEXT_PATH+
"/rest/api/content/"+b+"?status=draft",type:"DELETE",dataType:"json",data:{},contentType:"application/json",success:function(){d("#draft-messages").remove();a.messages.success("#editor-messages",{body:"Your draft has been discarded."})},error:function(b){a.messages.error({title:"Error",body:b.errors||"An unknown error has occurred. Please check your logs."})}})},save:function(e){e=e||{};if(!q)if(b.Editor.isPublishing()||!b.Editor.editorHasContentChanged()&&!e.forceSave){a.debug("skipping draft save because:");
b.Editor.isPublishing()?a.debug("The user is publishing the page already."):!b.Editor.editorHasContentChanged()&&!e.forceSave&&a.debug("The content hasn't changed and a forceSave wasn't requested in the options.")}else{a.debug("preparing to save editor draft");var c=d("#content-title"),h=d("#newSpaceKey"),i=d("#originalVersion"),m=b.Editor.inRichTextMode(),r={draftId:g.get("draft-id"),pageId:g.get("page-id"),parentPageId:g.get("parent-page-id"),type:a.params.draftType,title:c.hasClass("placeholded")?
"":c.val(),spaceKey:h.length?h.val():encodeURIComponent(g.get("space-key"))};t.getEditorContent().pipe(function(c){d.extend(r,c);if(i.length)r.pageVersion=parseInt(i.val(),10);p=d.ajax({type:"POST",url:n.CONTEXT_PATH+"/rest/tinymce/1/drafts"+(e.ignoreRelations?"?ignoreRelations=true":""),data:d.toJSON(r),contentType:"application/json",dataType:"text json",success:function(c){if(c!=null&&(!(u&&c.draftId===0)||!v)){b.Editor.contentHasChangedSinceLastSave=false;m&&a.Rte.Content.editorResetContentChanged();
o=true;l=!!e.manualSave;g.set("draft-id",c.draftId+"");d("#draftId",b.Editor.getCurrentForm()).val(c.draftId);d("#draft-error").remove();if(!g.get("collaborative-content")){var h=d("#draft-status"),f;if(!(f=c.time)){var j=new Date;f=j.getHours();var j=j.getMinutes(),i=f>11?"PM":"AM";f=f%12;f=(f==0?"12":f)+":"+(j<10?"0":"")+j+" "+i}j=l?a.format("Draft saved at {0}",f):a.format("Draft autosaved at {0}",f);i=a.params.newPage?j:"<a id='view-diff-link-heartbeat' class='view-diff-link' href='#'>"+
j+"</a>";h.attr("data-tooltip",j);h.html(i)}if(d.isFunction(e.onSuccessHandler))e.onSuccessHandler(c);b.Editor.Drafts.lastSaveTime=f;a.trigger("rte-draft-saved",{draftId:c.draftId})}},error:function(c,g){var f;f=function(){b.Editor.addErrorMessage("draft-error",b.Editor.Drafts.lastSaveTime?a.format("Error saving draft. Last draft saved at {0}",b.Editor.Drafts.lastSaveTime):"Error saving draft. No draft has been saved.",true)};if(!e.skipErrorHandler&&!k()){if(c.status===400)if(c.responseText.indexOf("Legacy drafts deprecated")>=
0)s.handleMessage("legacy-draft-deprecated",{type:"error",message:"Collaborative editing is here! That means we need a little help from you to restart your editing session. All you need to do is copy the content, edit this page again, then paste it in and save."});else if(c.responseText.indexOf("Unsupported character found in content: ")>=0){f=c.responseJSON.message.split("Unsupported character found in content: ")[1];s.handleMessage("utf8-validation-failed",{title:"Unsupported character",type:"error",message:a.format("We can\u0027\u0027t save because the {0} character isn\u0027\u0027t supported by your database.\u003cbr\u003e\u003cbr\u003eRemove this character or use a Confluence symbol or emoticon instead. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eLearn more\u003c/a\u003e",f)})}else f();else f();if(d.isFunction(e.onErrorHandler))e.onErrorHandler(g)}},
timeout:3E4}).always(function(){p=null})})}},getDraftSavingPromise:function(){return p}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/page-editor-drafts","Confluence.Editor.Drafts");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-permissions.js' */
define("confluence-editor/editor/page-editor-permissions",["ajs","jquery"],function(a,d){var c={updateEditPageRestrictions:function(c,b,f,i){var e=d("#rte-button-restrictions"),j=e.find(".icon"),g="",h="";c||b?(j.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass(c?"aui-iconfont-locked icon-red":"aui-iconfont-unlocked icon-red"),g="Restrictions apply",h="Edit page restrictions. Current status: Restrictions apply"):(j.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass("aui-iconfont-unlocked"),
f?(g="Restrictions apply",h="Edit page restrictions. Current status: Restrictions apply"):(g="Unrestricted",h="Edit page restrictions. Current status: Unrestricted"));e.attr("data-tooltip",g);e.attr("aria-label",h);e.data("explicit-restrictions",c);e.data("inherited-restrictions",b);e.data("restrictionsHash",i)},handleHeartbeat:function(k,b){if("undefined"!==typeof b.restrictionsHash){var f=d("#rte-button-restrictions");if(f.data("restrictionsHash")!==
b.restrictionsHash)if(d("#update-page-restrictions-dialog").is(":visible")&&a.PagePermissions.updateRestrictionsDialog)a.PagePermissions.updateRestrictionsDialog(),f.data("restrictionsHash",b.restrictionsHash);else{var i=""!==b.restrictionsHash,e=b.hasViewRestrictions,f=!!f.data("inherited-restrictions");c.updateEditPageRestrictions(e,f,i,b.restrictionsHash)}}},init:function(){a.bind("editor-heartbeat",c.handleHeartbeat);a.bind("edit-page-restrictions-updated",function(a,b){c.updateEditPageRestrictions(b.hasExplicitRestrictions,
b.hasInheritedRestrictions,b.hasAnyExplicitRestrictions,b.restrictionsHash)})}};return c});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-permissions",function(a){var d=require("ajs"),c=require("jquery");d.PagePermissions=d.PagePermissions||{};c.extend(d.PagePermissions,{updateEditPageRestrictions:a.updateEditPageRestrictions});d.toInit(a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:analytics', location = 'analytics/editor-ready-collab-mode-analytics.js' */
define("confluence-editor/analytics/editor-ready-collab-mode-analytics",["ajs","confluence/dark-features","confluence/meta"],function(a,d,b){return{trigger:function(){if(a.Rte&&a.Rte.getEditor()&&(a.$("#editpageform").length||a.$("#createpageform").length)){var c;c="confluence.editor.ready.collab.mode."+(d.isEnabled("site-wide.shared-drafts")?"on":"off");var e=b.get("synchrony-connection-order")?b.get("synchrony-connection-order"):"",f=b.get("synchrony-connection-type")?b.get("synchrony-connection-type"):
"";a.trigger("analyticsEvent",{name:c,data:{connectionOrder:e,connectionType:f}})}}}});require("confluence/module-exporter").safeRequire("confluence-editor/analytics/editor-ready-collab-mode-analytics",function(a){require("ajs").bind("rte-ready",function(){a.trigger()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.UnpublishedChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_ignored) {
  return '<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="' + soy.$$escapeHtml(opt_data.tooltip) + '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">' + soy.$$escapeHtml(opt_data.label) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.UnpublishedChanges.lozenge.soyTemplateName = 'Confluence.Templates.UnpublishedChanges.lozenge';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.js' */
define("confluence-editor/unpublished-changes/unpublished-changes",["jquery","confluence/legacy","ajs","underscore","tinymce"],function(c,a,g,i,h){return{init:function(e){var f=c(a.Templates.UnpublishedChanges.lozenge({tooltip:g.I18n.getText("editor.unpublished.changes.lozenge.tooltip"),label:g.I18n.getText("editor.unpublished.changes.lozenge.label")})),h=function(d){d=i.isBoolean(d)?d:!0;a.Editor.UI.setButtonState(d,c("#rte-button-publish"))},j=function(d,b){var a=b||function(){};(i.isBoolean(d)?
d:1)?f.addClass("visible").fadeIn("fast",a):f.fadeOut("fast",function(){c(this).hide().removeClass("visible");a()})},b={show:function(){f.hasClass("visible")||j(!0,h)},hide:function(){j(!1);h(!1)}};g.bind("rte-ready",function(){var a=c("#content-title-div");b.hide();f.insertBefore(a);f.tooltip();c("#content-title").on("keydown change",b.show);e.onChange.add(b.show);e.onKeyDown.add(b.show);e.onLoad.add(function(){c(e.startContent).text().trim()&&0<g.Meta.get("draft-id")&&b.show()});f.on("mouseenter.tipsy",
function(){g.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});e.addCommand("mceConf.UnpublishedChangesLozenge.show",b.show);e.addCommand("mceConf.UnpublishedChangesLozenge.hide",b.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/unpublished-changes/unpublished-changes",function(c){var a=require("tinymce");a.create("tinymce.plugins.UnpublishedChanges",c);a.PluginManager.add("unpublishedchanges",a.plugins.UnpublishedChanges)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",["jquery","ajs","tinymce"],function(b,g,h){return{init:function(l){!h.isIE8&&l.onKeyDown.add(function(d,k){function j(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&!b(a.lastChild).is("br")&&b(a).append("<br/>")}if(8===k.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&g.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,i=e[0],a;if(0<c.length)return f=c[0],
a=b(i.firstChild),h.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first()),d.undoManager.beforeChange(),d.undoManager.add(),b(f.lastChild).is("p")&&!d.dom.isBlock(i.firstChild)?(j(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(i.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(j(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(i.firstChild).prepend(b(c).detach())})):
j(f),c.append(e.detach().contents()),a[0]&&g.EditorUtils.setCursorAtStartOfContents(a[0]),d.undoManager.add(),h.dom.Event.cancel(k)}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.ConfluenceListPlugin",b);g.PluginManager.add("confluencelist",g.plugins.ConfluenceListPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",["jquery","document"],function(g,c){return{init:function(i){function m(a){var d={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},f=["highlight","nohighlight","relative-table","fixed-table"],b,e=0,c=[],h=g(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=
a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=g("table",a),a.length)g(a).unwrap(),a=a[0];else return null;if((!a.tagName?0:"TABLE"===a.tagName||"TR"===a.tagName||"TH"===a.tagName||"TD"===a.tagName||"TBODY"===a.tagName||"THEAD"===a.tagName||"TFOOT"===a.tagName||"COL"===a.tagName||"COLGROUP"===a.tagName||"CAPTION"===a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!d[b.name]?a.removeAttribute(b.name):e++;k(a)&&c.push(k(a));d=0;for(e=f.length;d<
e;d++)f[d].exec||h.hasClass(f[d])&&c.push(f[d]);(f=h.attr("data-highlight-class"))&&c.push(f);(f=h.attr("data-highlight-colour"))&&c.push("highlight-"+f);h.attr("class",c.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"===a.tagName?"confluenceTable":"TH"===a.tagName?"confluenceTh":"TD"===a.tagName?"confluenceTd":""}function j(a){var d="";a&&a.getAttribute&&(d=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!==a.tagName?!1:!d?!1:-1!==d.indexOf("wysiwyg-macro")}function l(a,d,c){for(var a=
c.node,d=m,b=a,e="";b;)if("function"===typeof d&&(b=d(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;c.node=a}i.on("init",function(){g(c).bind("postPaste",l)});i.on("remove",function(){g(c).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",function(g){var c=require("tinymce");c.create("tinymce.plugins.ConfluencePasteTablePlugin",g);c.PluginManager.add("confluencepastetableplugin",c.plugins.ConfluencePasteTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",["tinymce","jquery"],function(d,f){return{init:function(g){if(d.isWebKit){var h={},i=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=i(h,a),b=i(a,b);b[c]||(b[c]=f(this).attr("data-format"))});g.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),
b=a.dom.select("font.Apple-style-span",a.dom.doc.body),c=c.concat(b),b=0,k=c.length;b<k&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}g.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===c[d].src.substr(0,
8)&&a.dom.remove(c[d])});if(d.isIE9){var j=function(a){a.getBody().childNodes.length||a.setContent("<p>﻿</p>")};g.onNodeChange.add(j);g.onSetContent.add(j)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",function(d){var f=require("tinymce");f.create("tinymce.plugins.ConfluenceCleanupPlugin",d);f.PluginManager.add("confluencecleanupplugin",f.plugins.ConfluenceCleanupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'templates/reliable-save.soy' */
// This file was automatically generated from reliable-save.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Reliable.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Reliable == 'undefined') { Confluence.Templates.Editor.Reliable = {}; }


Confluence.Templates.Editor.Reliable.draftMessage = function(opt_data, opt_ignored) {
  var output = '<div id="draft-messages">';
  if (opt_data.isNewPage) {
    if (opt_data.existingDraft.title) {
      var escapedTitle__soy8 = '' + soy.$$escapeHtml(opt_data.existingDraft.title);
      output += soy.$$filterNoAutoescape(AJS.format('A new page you were adding on {0} called \x26#8216;{1}\x26#8217; was saved as a draft.',opt_data.existingDraft.date,escapedTitle__soy8));
    } else {
      output += soy.$$filterNoAutoescape(AJS.format('A new page you were adding on {0} was saved as a draft.',opt_data.existingDraft.date));
    }
    output += ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}resume editing{1} or {2}discard{3} it?','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft"> ','</a>'));
  } else {
    output += soy.$$filterNoAutoescape(AJS.format('A version of this page you were editing at {0} was saved as a draft.',opt_data.existingDraft.date)) + ((opt_data.mergeRequired) ? ' ' + soy.$$escapeHtml('The page has since been updated. Your changes will be merged with the latest version.') : '') + ((opt_data.conflictFound) ? ' ' + soy.$$filterNoAutoescape(AJS.format('The page has since been updated. The changes made conflict with your changes and cannot be merged. Do you want to {0}view the conflict{1} or {2}discard{3} your changes?','<a href="?pageId=' + opt_data.pageId + '&viewConflict=true&spaceKey=' + opt_data.spaceKey + '" >','</a>','<a href="#" class="discard-draft">','</a>','<a href="' + "" + '/users/viewmydrafts.action">','</a>')) : (opt_data.mergeRequired) ? ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}view{1}, {2}merge and resume editing{3} or {4}discard{5} it?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')) : ' ' + soy.$$filterNoAutoescape(AJS.format('Do you want to {0}view the change{1}, {2}resume editing{3} or {4}discard{5} it?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')));
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Reliable.draftMessage.soyTemplateName = 'Confluence.Templates.Editor.Reliable.draftMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/reliable-save.js' */
define("confluence-editor-reliable-save/reliable-save","ajs confluence/legacy underscore jquery window document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog".split(" "),function(a,c,n,e,u,L,p,b,D){function v(){return a.Meta.get("shared-drafts")}function w(){return a.Meta.getBoolean("new-page")}function x(){c.Editor.UI.toggleSavebarBusy(!1)}function q(c){var e="There was an error processing the request.";b.closeMessages(["generic-error"]);
b.handleMessage("generic-error",{type:"error",message:e},f);a.logError("Generic error: "+JSON.stringify(c))}function f(){var b=e("#draft-messages");0<b.length&&(b.is(":visible")&&a.Confluence.Analytics.publish("rte.notification.draft"),b.find("a.use-draft").click(function(b){b.stopPropagation();b.preventDefault();c.Editor.Drafts.useDraft();a.Confluence.Analytics.publish("rte.notification.draft.resume")}),b.find("a.discard-draft").click(function(b){b.stopPropagation();b.preventDefault();h.Draft.discardDraft(a.Meta.get("page-id"),
a.Meta.get("existing-draft-id")).done(h.Draft.onSuccessDiscardDraft).fail(h.Draft.onErrorDiscardDraft)}))}function G(){e("#editor-restore-title-link").click(function(c){c.stopPropagation();c.preventDefault();e("#content-title").val(a.Meta.get("latest-published-page-title"));b.closeMessages(["rename-during-limited-mode"])})}function r(){a.Meta.set("access-mode","READ_ONLY");b.closeMessages(["read-only-mode"]);b.handleMessage("read-only-mode",{title:"This site is read-only",
type:"error",message:"Starting now, any changes you make won\u0027t be saved. We\u0027ll let you know when you can start editing again."});c.Editor.UI.setButtonsState(!0);c.Editor.UI.toggleSavebarBusy(!1);c.Editor.UI.setButtonState(!1,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(!1,c.Editor.UI.cancelButton)}function A(c){var e="Looks like your session expired. Log in again to keep working.\n \u003cdiv\u003e\u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003eLogin\u003c/a\u003e\u003c/div\u003e";b.closeMessages(["noauthorized"]);b.handleMessage("noauthorized",{title:"Can\u0027t connect to the server",type:"error",message:e},f);c&&a.trigger("rte.safe-save.invalid-xsrf-token")}
function E(){var c="Unable to communicate with server. Saving is not possible at the moment.";b.closeMessages(["server-offline"]);b.handleMessage("server-offline",{type:"error",message:c},f)}var F=[],t=!1,h={Draft:{discardDraft:function(b,c){b={draftId:c,pageId:b,type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};return e.ajax({type:"DELETE",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/discard",data:e.toJSON(b),contentType:"application/json",dataType:"json"})},onSuccessDiscardDraft:function(){w()||a.Meta.set("draft-id",
"0");b.closeMessages(["draft-message"]);b.handleMessage("discarding-successfull",{type:"info",message:"Your draft has been discarded.",close:"auto"},f);a.Confluence.Analytics.publish("rte.notification.draft.discard")},onErrorDiscardDraft:function(c){switch(c.status){case 403:A(!0);break;case 404:b.handleMessage("draft-deleted",{type:"info",message:"This draft has been discarded."},f);break;case 405:r();break;case 422:b.handleMessage("discarding-invalid",{type:"error",
message:"This draft is invalid. It can be deleted by someone or looks like your session expired."},f);break;default:b.handleMessage("discarding-error",{type:"error",message:"An unknown error has occurred. Please check your logs."},f)}}}};h._internal=c.SafeSafe&&c.SafeSave._internal?c.SafeSave._internal:{};h._internal.onSuccessfulResponse=function(b){e("#rte-button-overwrite").unbind("click.overwrite");var f={dataType:"json",contentId:a.Meta.get("content-id"),draftType:a.Meta.get("draft-type")};a.safe.post(p.CONTEXT_PATH+"/json/stopheartbeatactivity.action",
f,function(){a.log("Stop heartbeat activity on",f.draftType,"id",f.contentId)},"json").fail(function(b,c,e){a.logError("Server error on stop heartbeat activity request:");a.log(e)}).always(function(){var a=b._links.webui;a?0!==a.indexOf("/")?u.location=a:u.location=p.CONTEXT_PATH+a:(c.Editor.isPublishing(!1),x())})};h.resetUnrecoverableEditorError=function(){t=!1};h.initialize=function(){function z(d){x();switch(d.status){case 400:b.closeMessages(["empty-title","duplicate-title","title-too-long",
"legacy-draft-deprecated","utf8-validation-failed"]);0<=d.responseText.indexOf(k.duplicatedTitle)?b.handleMessage("duplicate-title",{type:"error",message:a.format("A page with the title \u0027\u0027{0}\u0027\u0027 already exists in this space. Enter a different title for your page.",a.escapeHtml(e("#content-title").val()))}):0<=d.responseText.indexOf(k.titleTooLong)?b.handleMessage("title-too-long",{type:"error",message:"Title cannot be longer than 255 characters."},f):0<=d.responseText.indexOf(k.publishNewDraftDeprecated)||0<=d.responseText.indexOf(k.existingDraftNotFound)?
a.Meta.get("new-page")&&v()&&!c.Editor.hasContentChanged()?(a.trigger("rte.legacy-draft-can-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:a.format("Collaborative editing is here! So that you can keep working on this page, we need to migrate the content to a new draft for you.\u003cbr\u003e \u003ca href={0}\u003eMigrate now\u003c/a\u003e",p.CONTEXT_PATH+"/pages/resumedraft.action?draftId\x3d"+a.Meta.get("draft-id"))},f)):(a.trigger("rte.legacy-draft-cannot-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:"Collaborative editing is here! That means we need a little help from you to restart your editing session. All you need to do is copy the content, edit this page again, then paste it in and save."},f)):0<=d.responseText.indexOf(k.utf8ValidationFailed)?
(d=d.responseJSON.message.split(k.utf8ValidationFailed)[1],b.handleMessage("utf8-validation-failed",{title:"Unsupported character",type:"error",message:a.format("We can\u0027\u0027t save because the {0} character isn\u0027\u0027t supported by your database.\u003cbr\u003e\u003cbr\u003eRemove this character or use a Confluence symbol or emoticon instead. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eLearn more\u003c/a\u003e",d)},f)):q(d);break;case 403:A(!0);break;case 404:b.closeMessages(["page-not-accessible","noauthorized"]);b.handleMessage("page-not-accessible",{title:"This content cannot be accessed.",type:"error",message:a.format("Your session may have expired, you can attempt to \u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003elog in\u003c/a\u003e.",
a.Meta.get("space-key"))},f);break;case 405:r();break;case 410:b.closeMessages(["page-deleted"]);b.handleMessage("page-deleted",{title:"This content has been deleted",type:"error",message:a.format("Copy your content, then add it to a new page or \u003cdiv\u003e\u003ca href=\u0022viewtrash.action?key={0}\u0022 target=\u0022_blank\u0022\u003erestore this page from the trash\u003c/a\u003e and try again.\u003c/div\u003e",a.Meta.get("space-key"))},f);break;case 413:b.closeMessages(["page-too-big"]);b.handleMessage("page-too-big",{type:"error",message:"This page is too big to save. You could split it into multiple pages, then use the \u003ca href=\u0022https://confluence.atlassian.com/conf51/include-page-macro-336169384.html\u0022 target=\u0022_blank\u0022\u003einclude page macro\u003c/a\u003e to display the content."},f);break;case 0:case 500:case 503:E();break;case 501:0<=d.responseText.indexOf(k.renameDuringLimitedMode)?
b.handleMessage("rename-during-limited-mode",{type:"error",message:"Changing page titles isn\u0027t possible right now, as collaborative editing is offline. \u003cdiv\u003e\u003ca id=\u0022editor-restore-title-link\u0022 href=\u0022#\u0022\u003eRestore the page title\u003c/a\u003e if you\u0027d like to publish the page.\u003c/div\u003e"},G):q(d);break;default:q(d)}}function y(d){function I(c){B<J?(B++,C.push(setTimeout(function(){y()},K))):(a.trigger("analyticsEvent",{name:"editor.save.error.conflict"}),B=0,b.handleMessage("page-conflict",{title:"Can\u0027t sync with the server.",type:"error",message:a.format("Refresh the page to try to re-establish the connection.",g.space.key)},f),k(c))}function k(b){a.trigger("rte.safe-save.error",
{status:b.status})}function n(){c.Editor.isPublishing(!0);e.ajax({type:r,url:l,contentType:"application/json; charset\x3dutf-8",dataType:"json",data:JSON.stringify(g),success:function(b){"page"!==g.type&&"blogpost"!==g.type||a.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}});a.trigger("rte.safe-save.success",b);h._internal.onSuccessfulResponse(b)},error:function(b){c.Editor.isPublishing(!1);x();var d=!1;switch(b.status){case 409:v()?(d=!0,I(b)):(c.Editor.restoreDefaultSave(),
c.Editor.UI.saveButton.click());break;case 0:case 500:case 503:for(;C.length;)clearTimeout(C.shift());z(b);break;default:z(b)}d||k(b);a.trigger("synchrony.start",{id:"confluence.editor.publish"})}})}a.trigger("synchrony.stop",{id:"confluence.editor.publish"});d&&d.preventDefault();var m=e("#content-title");if(m.hasClass("placeholded")||""===m.val().trim())a.trigger("rte.safe-save.error"),a.trigger("synchrony.start",{id:"confluence.editor.publish"}),b.closeMessages(["title-too-long","duplicate-title"]),
b.handleMessage("empty-title",{title:"This page needs a name",type:"error",message:"Add a page title before hitting publish."},f),x();else{c.Editor.Drafts.unBindUnloadMessage();var g={};d=a.Meta.get("draft-id");var t=a.Meta.get("content-id"),l=p.CONTEXT_PATH+"/rest/api/content",q=e("#sourceTemplateId").val();g.status="current";g.title=m.val();g.space={key:a.Meta.get("space-key")};g.body={editor:{value:function(a){F.forEach(function(b){a=b(a)});return a}(a.Rte.getEditor().getContent()),
representation:"editor"}};q&&(g.extensions={sourceTemplateId:q});m=(m=c.Editor.UI.postingDatePicker)&&m.getDate();"blogpost"===u.type&&m&&m.toISOString&&(g.history={createdDate:m.toISOString()});if(w()&&!a.Meta.get("shared-drafts")){var r="POST";a.Meta.get("is-blueprint-page")&&(l=l+"/blueprint/instance/"+d);l+="?status\x3ddraft";g.id=d;g.type=a.Meta.get("content-type");g.body.editor.content={id:d}}else r="PUT",w()&&a.Meta.get("is-blueprint-page")&&(l+="/blueprint/instance"),l=l+"/"+t,w()&&v()?(g.id=
d,g.body.editor.content={id:d}):(g.id=a.Meta.get("page-id"),g.body.editor.content={id:a.Meta.get("page-id")}),l="0"===d?l+"?status\x3dcurrent":l+"?status\x3ddraft",d=a.Meta.getNumber("page-version")||0,g.type=a.Meta.get("content-type"),g.version={number:d+1,message:e("#versionComment").val(),minorEdit:!e("#notifyWatchers").is(":checked"),syncRev:e("#syncRev").val()};d=function(){var b={};b.id=a.Meta.get("parent-page-id")||"0";b.type=a.Meta.get("content-type");var c=a.Meta.get("parent-page-id");c&&
g.space.key===a.Meta.get("space-key")||(b.id="0");c&&b.id!==c&&(b.id=e("#parentPageString").val()===a.Meta.get("from-page-title")?b.id:c);return b}();"0"!==d.id&&(g.ancestors=[d]);(d=c.Editor.Drafts.getDraftSavingPromise())?d.always(n):n()}}if(0!==e("#editpageform").length||0!==e("#createpageform").length){var k={duplicatedTitle:"A page with this title already exists",titleTooLong:"Title cannot be longer than 255 characters.",publishNewDraftDeprecated:"Unsupported call to publishNewDraft",existingDraftNotFound:"Could not find existing draft, perhaps you're trying to publish a personal draft?",
renameDuringLimitedMode:"Unable to perform a page rename when limited mode is enabled",utf8ValidationFailed:"Unsupported character found in content: "},u={existingDraftId:a.Meta.get("existing-draft-id")?a.Meta.get("existing-draft-id"):0,pageId:a.Meta.get("page-id"),type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};if(!0===a.Meta.get("show-draft-message")){if(0<e("#conflict-diffs").length)return;e.ajax({type:"GET",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/message",data:u,contentType:"application/json",
dataType:"text json",success:function(d){d&&d.draftData&&(d=c.Templates.Editor.Reliable.draftMessage({existingDraft:d.draftData,conflictFound:d.conflictFound,mergeRequired:d.mergeRequired,isNewPage:d.newPage,pageId:a.Meta.get("page-id"),spaceKey:a.Meta.get("space-key")}),b.handleMessage("draft-message",{type:"info",message:d},f))}})}var H=0<e("#editor-notifications-container #all-messages .aui-message-error").length;v()?(D.init({saveHandler:y,cancelErrorHandler:z}),c.Editor.overrideSave(D.process)):
H?c.Editor.restoreDefaultSave():c.Editor.overrideSave(y);e("#rte-button-overwrite").bind("click.overwrite",y);var B=0,J=3,K=1E3,C=[];a.bind("rte.heartbeat-error",function(d,e){switch(e.status){case 401:case 403:b.isDisplayed(["page-not-accessible"])||A(!1);break;case 405:if(e.responseText){d=JSON.parse(e.responseText);b.isDisplayed(["read-only-mode"])||"READ_ONLY"!==d.reason||r();break}case 0:case 404:case 500:case 503:c.Editor.metadataSyncRequired()||E();break;default:a.logError("Heartbeat action error: "+
JSON.stringify(e))}});a.bind("rte.heartbeat",function(d){var e=!1;n.each(b.displayedErrors(),function(a){n.contains(["noauthorized","server-offline","page-not-accessible","read-only-mode"],a)&&(e=!0,b.closeMessages([a]))});(d="READ_ONLY"===a.Meta.get("access-mode"))&&a.Meta.set("access-mode","READ_WRITE");(e||d)&&b.handleMessage("reconnect",{type:"info",title:"Successfully reconnected",message:"We\u0027re back in business. You\u0027re free to save your page again.",close:"auto"},f);c.Editor.UI.isButtonEnabled(c.Editor.UI.saveButton)||
t||c.Editor.UI.setButtonState(!0,c.Editor.UI.saveButton);c.Editor.UI.isButtonEnabled(c.Editor.UI.cancelButton)||t||c.Editor.UI.setButtonState(!0,c.Editor.UI.cancelButton)});a.bind("synchrony.history.evicted",function(){t=!0})}};h.registerCleanupFunction=function(a){F.push(a)};return h});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/reliable-save",function(a){var c=require("ajs"),n=0<window.document.referrer.indexOf("createDialog\x3dtrue\x26flashId");if(c.DarkFeatures.isEnabled("editor.ajax.save")&&""!==c.Meta.get("remote-user")&&!n){var e=require("confluence/legacy");c.bind("rte.init.ui",function(){a.initialize();e.Editor=e.Editor||{};e.Editor.SafeSave=e.Editor.SafeSave||{};e.Editor.SafeSave.Draft=a.Draft;e.Editor.SafeSave._internal=a._internal||
{}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/ajax-login.js' */
define("confluence-editor-reliable-save/ajax-login",["confluence/dark-features","confluence/meta","ajs","jquery","document"],function(p,k,b,f,y){return function(){function z(A,g,a){function h(a){a=a.getResponseHeader("X-AUSERNAME");return v===a}function k(a){for(var d=0,B=a.length;d<B;d++){var e=a[d];b.debug("Rerunning ajax query to: "+e.url,e);w.call(f,e.url,e.settings).done(function(){b.debug("Rerunning done");e.deferred.resolve(arguments)}).fail(function(){b.debug("Rerunning failed");e.deferred.reject(arguments)})}}
function p(a){r.push({deferred:l,url:A,settings:g,defaultCallback:a});t||(u=!1,m||(m=new b.Dialog(840,700),m.addPanel("ajax-login","ajax-login-content","ajax-login-panel",1),a=f(".ajax-login-panel"),n=f("\x3ciframe\x3e\x3c/iframe\x3e"),n.bind("load",function(a){(a=n[0].contentDocument.location.pathname)&&0<=a.indexOf("/ajaxlogincomplete.action")&&(t=!1,u=!0,m.hide(),n.attr("src","about:blank"))}),a.append(n),f(y).bind("hideLayer",function(a,d,e){if("popup"===d&&e===m.popup){b.debug("hiding login dialog");
if(u)k(r);else for(a=r,d=0,e=a.length;d<e;d++){var c=a[d];b.debug("Executing with original response for: "+c.url,c);c.defaultCallback&&c.defaultCallback()}r=[]}})),n.attr("src",C),m.show(),t=!0)}function q(a,b,f,e){function d(){c.readyState=a.readyState;c.status=a.status;c.statusText=a.statusText;a.responseXML?c.responseXML=a.responseXML:c.responseText=a.responseText;b.apply(f,e)}h(a)?d():p(d)}b.debug("Using authenticatingPromise");var c={abort:function(){a.abort.apply(a,arguments)},getAllResponseHeaders:function(){a.getAllResponseHeaders.apply(a,
arguments)},getResponseHeader:function(){a.getResponseHeader.apply(a,arguments)},overrideMimeType:function(){a.overrideMimeType.apply(a,arguments)},readyState:a.readyState,setRequestHeader:function(c,b){a.setRequestHeader.apply(a,arguments)},state:function(){a.state.apply(a,arguments)},status:a.status,statusCode:function(){a.statusCode.apply(a,arguments)},statusText:a.statusText},l=f.Deferred();l.promise(c);c.success=c.done;c.error=c.fail;a.done(function(a,c,b){q(b,l.resolve,l,arguments)});a.fail(function(a,
c,b){q(a,l.reject,l,arguments)});return c}if(p.isEnabled("ajax.login")){b.debug("AJAX login support enabled");var t=!1,m,n,u,r=[],w=f.ajax,v=k.get("remote-user"),q=k.get("base-url"),x=k.get("context-path"),C=k.get("context-path")+"/login.action?os_destination\x3d%2Fajaxlogincomplete.action";f.ajax=function(b,g){var a=w.call(f,b,g);var h=b&&b.url;h=v&&(!g||g&&!g.preventAjaxLogin)&&h&&(q&&0===h.indexOf(q)||x&&0===h.indexOf(x));return h?z(b,g,a):a}}}});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/ajax-login",function(p){require("ajs").toInit(p)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/linkify",function(){return{RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,f,!0,!1,b,i);
f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;if(0<=b.substring(a,
c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,j)+"...");p&&(a=
a.replace(/([/=])/g,"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/linkify","linkify");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","jquery confluence/legacy confluence-editor/tinymce3/plugins/confluencepaste/linkify ajs document tinymce".split(" "),function(e,B,q,r,y,z){function u(a,b){for(var f=e(a).find("["+b+"]"),c="",d="",g="",h=0,k=f.length;h<k;h++){d=(c=e(f[h]))&&["/",c.attr(b)].join("");g=c&&["/",c.attr("data-mce-"+b)].join("");r.contextPath()&&d.indexOf(r.contextPath())===0&&(f[h]=c.attr(b,d));r.contextPath()&&g.indexOf(r.contextPath())===
0&&(f[h]=c.attr("data-mce-"+b,g))}return f}function m(a,b,f){var a=e(a).find("["+b+"]"),c="",d,g;if(a)for(var h=0,k=a.length;h<k;h++){d=e(a[h]);g=f.standard;for(var n in f)if(f.hasOwnProperty(n)&&d.is(n)){g=f[n];break}if(b.indexOf("style")>-1){var c=d,i=g;g=[];for(var o="",o=void 0,p=c.attr("style"),l=c.attr("data-mce-style"),j=0,m=i.length;j<m;j++)if(p&&p.toLowerCase().indexOf(i[j])>-1)g.push(i[j]+": "+c.css(i[j])+";");else if(l&&l.toLowerCase().indexOf(i[j])>-1){o=RegExp(i[j]+":.+?(?:;|$)");o=l.match(o);
g.push(o[0].indexOf(";")>-1?o:o+";")}c=g.join(" ")}else{c=d;i=b;p=[];if(g){l=0;for(j=g.length;l<j;l++)c.is("["+i+"~="+g[l]+"]")&&p.push(g[l])}c=p.join(" ")}d.removeAttr(b);c.length&&d.attr(b,c)}}function A(a,b){function f(f){var d;if(c.index){d=a.splitText(c.index);a&&b.push(a);a=d}(d=a.splitText(c[0].length))&&b.push(d);e(a).wrap("<a href='"+f+a.data+"'></a>")}var c,d,g;d=s.exec(a.data);g=t.exec(a.data);if(d){c=d;f("mailto:")}else if(g){d=(c=g)&&c[0].indexOf("://")===-1?"http://":"";f(d)}}var t;
q.init();var v=RegExp(q.RE_FULL_URL),w=RegExp(q.RE_OTHER_URL);t={exec:function(a){return v.exec(a)||w.exec(a)},test:function(a){return v.test(a)||w.test(a)}};var s,x=RegExp(q.RE_EMAIL_PATTERN);s={exec:function(a){if((a=x.exec(a))&&/\s/.test(a[0][0])){a[0]=a[0].replace(/\s/,"");a.index++}return a},test:function(a){return x.test(a)}};e(y).bind("postPaste",function(a,b,f){a=f.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],
span:["color","text-decoration"],pre:["margin-left"]};b.td=b.th=["text-align"];b.li=["list-style-type","background-image"];b.col=["width"];b["table.confluenceTable.relative-table"]=["width"];m(a,"style",b);m(a,"data-mce-style",b);if(e.browser.mozilla){u(a,"src");u(a,"href")}m(a,"face",{standard:[]});m(a,"id",{standard:[]});m(a,"data-mce-href",{standard:[]});a=f.node;b=[];b.push({elements:["div"],attribute:"class",blackValue:"aui-buttons"});for(var c=0;c<b.length;c++)for(var d=b[c],g=0;g<d.elements.length;g++)for(var h=
e(a).find(d.elements[g]+"["+d.attribute+"]"),k=0;k<h.length;k++){var n=h.eq(k).attr(d.attribute),n=n.replace(d.blackValue,"");h.eq(k).attr(d.attribute,n)}var i=f.node;e.each([".contentLayout",".contentLayout2",".columnLayout",".header",".footer",".cell",".innerCell",".panelContent",".panel",".panelHeader",".Apple-converted-space","font",".jira-status",".jira-issue",".diff-html-removed",".diff-html-added",".diff-html-changed"],function(a,b){e(b,i).contents().unwrap()});e("img",i).map(function(){e(this).attr("data-attachment-copy",
"");!e(this).attr("src")&&e(this).remove()});e("dl",i).map(function(){e(this).replaceWith(e("<p></p>").text(e(this).text()))});e("a",i).map(function(){e(this).removeClass("confluence-userlink userLogoLink")});for(a=e.makeArray(f.node.childNodes);a.length;){b=a.pop();e(b).is("a")||(b.nodeType===3?A(b,a):b.nodeType===1&&(b.childNodes&&b.nodeName.toLowerCase()!=="pre")&&(a=a.concat(e.makeArray(b.childNodes))))}if(a=e.browser.mozilla){a=e(f.node);a=a.children("br").length&&!a.find(":not(br)").length&&
!e(z.activeEditor.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length}if(a){f=e(f.node);a="<p>"+f.html().replace(/<br>/gi,"</p><p>")+"</p>";f.html(a)}});return{URL:t,EMAIL:s}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","Confluence.Editor.regex");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
define("confluence-editor/tinymceplugin/tinymce-adapter-deprecated",["tinymce","ajs","confluence/legacy","jquery"],function(e,a,g,h){return{putCursorAtPostionInElement:function(b,a,c){var d=e.activeEditor,i=d.getDoc(),b=h(b,c||i),b=b.contents().filter(function(){return 3===this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(b,a);c.setEnd(b,a);d.selection.setRng(c)},storeCurrentSelectionState:a.Rte.BookmarkManager.storeBookmark,restoreSelectionState:a.Rte.BookmarkManager.restoreBookmark,insertLink:function(b,
f){f&&a.Rte.getEditor().selection.select(f);g.Editor.LinkAdapter.setLink(b)},getCurrentBaseUrl:a.Rte.getCurrentBaseUrl,addOnInitCallback:function(b){a.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+a.Rte.BootstrapManager);a.Rte.BootstrapManager.addOnInitCallback(b)},bindScroll:function(b,f){a.Rte.bindScroll(b,f)},unbindScroll:function(b){a.Rte.unbindScroll(b)},getTinyMceHasInit:function(){return a.Rte.BootstrapManager.isInitComplete()},getEditor:a.Rte.getEditor,addTinyMcePluginInit:function(b){a.Rte.BootstrapManager.addTinyMcePluginInit(b)},
isExternalLink:function(a){return g.Link.isExternalLink(a)},isInMacroPlaceholder:function(a){return e.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var b=a.Editor.Adapter;e.EditorManager.preInit.apply(e.EditorManager);e.EditorManager.init(b.settings)},offset:function(b){a.Rte.Content.offset(b)},getSelectedText:function(){return a.Rte.Content.getSelectedText()},setEditorValue:function(b){a.Rte.Content.setHtml(b)},getEditorHTML:function(){return""+a.Rte.getEditor.getContent()},editorHasContentChanged:function(){return a.Rte.getEditor().isDirty()},
editorResetContentChanged:function(){a.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,f){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==f)return d;return-1},getMainEditor:function(){return a.Rte.getMainEditor()},getEditorContainer:function(){return a.Rte.getEditorContainer()},getEditorFrame:function(){return a.Rte.getEditorFrame()},getEditorTable:function(){return a.Rte.getEditorTable()},webResourcePath:a.Rte.webResourcePath,getResourceUrlPrefix:function(){return a.Rte.getResourceUrlPrefix()},
getTinyMceBaseUrl:function(){return a.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return a.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(b){return a.Rte.getTinyMceEditorMinHeight(b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymceplugin/tinymce-adapter-deprecated","AJS.Editor.Adapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--8cfcf1af69', location = 'aui.chunk.a74d9dded03a92620c41--1fa67204f5c8e3af90cc.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--8cfcf1af69"],{iwe4:function(t,e,i){"use strict";i.r(e)},rNKm:function(t,e,i){var s,a,l;
/*! jQuery Fancy File Input plugin - v2.0.4 - 2018-11-23
* Copyright (c) 2018 Atlassian Pty Ltd; Licensed Apache-2.0 */void 0===(l=this)&&void 0!==window&&(l=window),s=[i("oDIA")],void 0===(a=function(t){return l.FancyFileInput=function(t){"use strict";var e=/^.*[\\\/]/,i=/\{0\}/gi,s=function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:document.documentMode}();function a(e,i){var s=t(e).data("FancyFileInput");if(s)return s;i=t.extend({},a.defaults,i),this.el=e,this.$el=t(e),this.$label=this.createLabel(i.buttonText),this._addLabelText(),this.$clearButton=t("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||i.clearButtonText,class:"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||i.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),this.isFocused=!1}return a.defaults={buttonText:"Browse…",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},a.prototype._addLabelText=function(){var e=t('label[for="'+this.el.id+'"]');e.length&&this.$el.attr("aria-label",e.text())},a.prototype.createLabel=function(e){var i=this.$el.parent(".ffi[data-ffi-button-text]");return i.length||(i=this.$el.wrap(t("<label>",{class:"ffi","data-ffi-button-text":e})).parent()),i},a.prototype.isDisabled=function(){return this.$el.is(":disabled")},a.prototype.formatMultipleFileText=function(t){return this.multipleFileTextPattern.replace(i,t)},a.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,t.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,t.proxy(this.change,this)).on("keydown"+this._eventNamespace,t.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,t.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,t.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,t.proxy(this.focus,this)).on("blur"+this._eventNamespace,t.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,t.proxy(this.clear,this))},a.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},a.prototype.fireEvent=function(t){this.$el.trigger(t+this._eventNamespace)},a.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},a.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},a.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},a.prototype.focus=function(){var t=this;this.$label.addClass(this.CLASSES.focused),s&&!this.isFocused&&(this.isFocused=!0,setTimeout((function(){t.$el.blur(),t.$el.focus()}),0))},a.prototype.blur=function(){s&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},a.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},a.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},a.prototype.keydown=function(t){var e=t.which,i=9;if(8!==e&&46!==e||(this.clear(),t.preventDefault()),s&&e===i){var a=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout((function(){a.$el.prop("disabled",!1).blur()}),0)}},a.prototype.checkValidity=function(){if(this.el.required){var t=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,t).toggleClass(this.CLASSES.valid,!t)}},a.prototype.change=function(){var t,i="";this.checkValidity(),(t=this.el.multiple&&this.el.files.length>1?this.formatMultipleFileText(this.el.files.length):this.el.value).length?(i=t.replace(e,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(i),this.fireEvent("value-changed")},a.prototype.setFieldText=function(t){var e="data-ffi-value";t.length?(this.$label.attr(e,t),this.fireEvent("value-added")):(this.$label.removeAttr(e),this.fireEvent("value-cleared"))},t.fn.fancyFileInput=function(e){return this.each((function(){var i=new a(this,e);t(this).data("FancyFileInput",i)}))},a}(t)}.apply(e,s))||(t.exports=a)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.file-select', location = 'aui.chunk.647b6db9cb2996fa83a0--246ac123afad62eb1860.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.file-select"],{"7hWp":function(i,u,c){"use strict";c.r(u),c.d(u,"FancyFileInput",(function(){return a}));c("6fSn"),c("iwe4");var n=c("rNKm"),a=c.n(n).a}},[["7hWp","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--8cfcf1af69","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.d7c46c2734","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.908fe798b4","aui.splitchunk.462ee5f9ef","aui.splitchunk.26116b3cbd","aui.splitchunk.50dca3e042"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-object.js' */
define("confluence-link-browser/link-object",["jquery","ajs","confluence/legacy"],function(c,g,m){function j(a){return c.nodeName(a,"img")?a:a.hasChildNodes()&&1===a.childNodes.length&&c.nodeName(a,"a")&&c.nodeName(a.firstChild,"img")?a.firstChild:null}function k(a){return!a?"":c(a).attr("data-linked-resource-default-alias")||c(a).attr("src")}function l(a){var b={};"A"===a.nodeName&&c(a.attributes).each(function(){b[this.name]=this.value});return b}function i(a,b){for(var c=a;c&&c!=b;){if(3!=c.nodeType)return!1;
c=c.nextSibling}return 3===b.nodeType}var e={isLink:function(a){return a&&!!a.fillNode}},f=function(a){if(e.isLink(a))return a;var b={insert:function(){return m.Editor.LinkAdapter.setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&!c.isFunction(this[b])&&(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&
this.body.jquery?1===this.body.length&&this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&this.attrs["data-linked-resource-container-id"]==a},isCustomAtlassianContentLink:function(){return this.classes&&
this.classes.length?-1!=c.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},isHrefValid:function(){return this.attrs.href&&
"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return c.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},isExternalLink:function(){return!this.isCustomAtlassianContentLink()},showsBreadcrumbs:function(){return!0},getTarget:function(){return this.attrs.target},setTarget:function(a){a?this.attrs.target=a:this.removeTarget()},removeTarget:function(){this.attrs&&this.attrs.target&&delete this.attrs.target}};
if(a&&a.attrs){var f={},h=null;c.each(a.attrs,function(a,b){"class"==a?h=b:f[a]=b});a.attrs=f;if(h){var d=h.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(d):d}}c.extend(b,a);return b};e.fromData=function(a){return f(a)};e.fromNode=function(a,b){f({attrs:{},body:{html:b,text:b}});return f({attrs:l(a),body:{html:b,text:b}})};e.fromSelectedAnchor=function(a,b){var e=c(a),h=j(a),d=!h&&i(a.firstChild,a.lastChild);return f({attrs:l(a),body:{isEditable:d,isImage:!!h,html:e.html(),imgName:k(h),
text:b}})};e.fromSelection=function(a,b,c,e){var b=j(b),d;if(d=!b)if(a.collapsed)d=!0;else if(d=a.startContainer,d==a.endContainer)d=3===d.nodeType?!0:i(d.childNodes[a.startOffset],d.childNodes[a.endOffset-1]);else{var g=require("tinymce").activeEditor.dom;d=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-1]:a.endContainer;a=d&&a&&d.parentNode==a.parentNode?{start:d,end:a}:null;d=!!a&&i(a.start,
a.end)}return f({attrs:{},body:{isEditable:d,isImage:!!b,html:c,imgName:k(b),text:e}})};e.fromREST=function(a){var b=f({attrs:{"data-base-url":g.Confluence.getBaseUrl(),"data-linked-resource-id":a.id,"data-linked-resource-type":a.type,"data-linked-resource-content-type":a.contentType,href:g.REST.findLink(a.link),"data-linked-resource-default-alias":a.title},body:{html:g.escapeHtml(a.title),text:g.escapeHtml(a.title)},classes:["confluence-link"]});"user"===a.type&&(b.attrs["data-linked-resource-type"]=
"userinfo");return b};e.createLinkToNewPage=function(a,b){return f({attrs:{"data-space-key":b,"data-content-title":a,href:g.contextPath()+"/pages/createpage.action?spaceKey="+b+"&title="+a},body:{html:g.escapeEntities(a),text:a},classes:["createlink","confluence-link"]})};e.makeExternalLink=function(a){return f({attrs:{href:a},body:{html:a,text:a}})};e.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||0===a.indexOf("\\"))};return e});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-object","Confluence.Link");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-adapter.js' */
define("confluence-link-browser/link-adapter",["ajs","jquery","confluence/legacy","tinymce"],function(d,e,f,h){return{setLink:function(a){var b=d.Rte.getEditor(),b=e(b.dom.create("a"),b.getDoc());a.fillNode(b);a=h.confluence.NodeUtils.replaceSelection(b);e("#comments-section").length&&d.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=d.Rte.getEditor().selection;var g=a.getNode();if(c=e(g).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),f.Link.fromSelectedAnchor(c,
b);c=a.getRng(!0);b=a.getContent({format:"text"});a=a.getContent();return f.Link.fromSelection(c,g,a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-adapter","Confluence.Editor.LinkAdapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser.js' */
define("confluence-link-browser/link-browser",["ajs","confluence/legacy","jquery"],function(b,o,h){function r(){if(!f.prop("disabled")){f.prop("disabled",!0);b.debug("link-browser.js: submit");i.preSubmit&&i.preSubmit();var a=c.getLink();b.DarkFeatures.isEnabled(s)||a.removeTarget();n();a.insert();b.trigger("closed.link-browser")}}function n(){k.hide().remove();b.Rte.BookmarkManager.restoreBookmark()}function p(){n();b.trigger("closed.link-browser")}function t(a,f,l){var d=f.key,f=f.label,e=d+"-panel",
g=o.Templates.LinkBrowser[d+"Panel"]({atlToken:b.Meta.get("atl-token")});k.addPanel(f,g,e,e+"-id");var a=k.get("panel:"+a),j=l.tabs[d];j.panelObj=a;j.key=d;j.createPanel({baseElement:h(a[0].body)});a[0].onblur=j.onDeselect;a[0].onselect=function(){var a=!!j.hasBreadcrumbs;b.debug("Link Browser: on tab select, breadcrumbs enabled: "+a);j.onSelect();c.refresh(a);i=j};return j}var s="link.openInNewWindow",k,c,f,i;return{SEARCH_PANEL:"search",ATTACHMENTS_PANEL:"attachments",WEBLINK_PANEL:"weblink",ADVANCED_PANEL:"advanced",
open:function(a){h(function(){h('.ffi input[type="file"]#file_0').fancyFileInput()});if(h(".aui-dialog:visible").length)return null;a=a||{};b.Rte.BookmarkManager.storeBookmark();a.linkInfo=a.linkInfo||o.Editor.LinkAdapter.getLink();if(a.opener)return a.opener(a.linkInfo.alias,a.linkInfo);var q=a,a={OPEN_IN_NEW_WINDOW_DARK_FEATURE:s,tabs:{},setLink:function(u,a){c.setLink(u,a)},getLink:function(){return c.getLink()},getSelectedDataTableItem:function(){return h(".data-table:visible tr.selected")},linkValid:function(a){f.prop("disabled",
!a)},focusLinkText:function(){c.focusLinkText()||(b.debug("LinkBrowser: focusing submit button"),f.focus())},getLinkText:function(){return c.getLinkText()},isLinkTextVisible:function(){return c.isLinkTextVisible()},isNewWindowCheckboxVisible:function(){return c.isNewWindowCheckboxVisible()},hasBreadcrumbs:function(a){return c.hasBreadcrumbs(a)},getLocationPresenter:function(){return c},doSearch:function(a){this.tabs.search.doSearch(a)},getSearchTextField:function(){return this.tabs.search.getSearchTextField()},
moveLocationPanel:function(a){c.moveLocationPanel(a)},restoreLocationPanel:function(){c.restoreLocationPanel()},gotoPanel:function(a){this.popup.gotoPanel(a)},getCurrentPanel:function(){return this.popup.getCurrentPanel()},setWebLinkURL:function(a){var c=this.tabs.weblink;i!=c?b.debug("Cannot set URL "+a+" on hidden Web Link panel"):c.setURL(a)},getWebLinkUrl:function(){var a=this.tabs.weblink;return i!=a?(b.debug("Cannot get URL on hidden Web Link panel"),null):a.getURL()},getTitle:function(){return this.popup.getTitle()},
getSubmitButtonText:function(){return f.text()},isSubmitButtonEnabled:function(){return f.is(":enabled")},isVisible:function(){return this.popup.isVisible()},showOpenInNewWindowCheckbox:function(a){return c.showOpenInNewWindowCheckbox(a)},getAdvancedTextField:function(){var a=this.tabs.advanced;return i!=a?(b.debug("Cannot get link text on hidden advanced panel"),null):a.getLink()},setAdvancedTextField:function(a){var c=this.tabs.advanced;i!=c?b.debug("Cannot set link text on hidden advanced panel"):
c.setLink(a)},submit:r,cancel:p},l=q.linkInfo,d=l.isNewLink(),e,g;e=new b.ConfluenceDialog({width:840,height:590,id:"insert-link-dialog",onCancel:p,onSubmit:r});g=d?"Insert link":"Edit link";d=d?"Insert":"Save";e.addHeader(g);e.addButton(d,r);e.addCancel("Cancel",p);e.addHelpText("Hint: type \u0022[\u0022 in the editor to see a list of suggested pages and insert a link.");g=h("#insert-link-dialog .dialog-tip");
g.attr("title",g.text());h("#insert-link-dialog .dialog-components .dialog-title").prepend(o.Templates.LinkBrowser.helpLink());f=e.get("button:0")[0].item;f.attr("id","link-browser-insert");f.prop("disabled",!0);k=e;a.popup=k;b.trigger("dialog-created.link-browser",[a]);c=o.Editor.LinkBrowser.LinkInfoPresenter(a);c.setLinkBody(l.body);q=q.panelKey;e=h("#link-browser-tab-items").find("div").map(function(){var a=h(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,
b){return a.weight-b.weight});var j="template"!==b.Meta.get("content-type");e=h.grep(e,function(a){return j||"attachments"!==a.key});var n;g=null;for(var d=0,v=e.length;d<v;d++){var m=t(d,e[d],a);0===d&&(n=m);!l.isNewLink()&&h.isFunction(m.handlesLink)&&m.handlesLink(l)?(g=m,m.openedLink=l):q==m.key&&(g=m)}g?a.popup.overrideLastTab():g=n;i=g;k.popup.element.find(".dialog-page-body:first").append(c.getContainer());i.panelObj.select();i.openedLink=null;k.show();b.trigger("dialog-shown.link-browser",
k);return a},cancel:p}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser","Confluence.Editor.LinkBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-location.js' */
define("confluence-link-browser/link-browser-location",["jquery","confluence/legacy","ajs","confluence/dialog-breadcrumbs"],function(k,B,i,s){return function(t){function m(){return i.escapeHtml(u())}function u(){return b.val()}function v(a){j.closest(".row").toggleClass("hidden",!a);e.toggleClass("has-breadcrumbs",!!a)}function w(a){var c=a.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/),a=c[2],d=c[3],f=c[5],e=c[7],c=c[9],b="";a&&(b=a.toLowerCase()+":");d&&(b+=d);b+=n(f);e&&(b+=
"?"+n(e));c&&(b+="#"+n(c));return b}function n(a){var c={"'":"%27","\\[":"%5B","\\]":"%5D","`":"%60","\\\\":"%5C"},d;for(d in c)c.hasOwnProperty(d)&&(a=a.replace(RegExp(d,"g"),c[d]));return a}function x(){return b.is(":visible")}function y(a,c){i.trigger("analyticsEvent",{name:a,data:{resourceType:c.getResourceType(),isExternal:c.isExternalLink()}})}var e,j,o,f,g,b,p,z,A,q,l,r,h;e=k(B.Templates.LinkBrowser.locationPanel());j=e.find("#breadcrumbs-container");o=s.Breadcrumbs(j,s.getBreadcrumbsLegacy);
g=e.find("#link-open-in-new-window");z=e.find(".link-image");A=e.find(".link-mixed");l=e.find("#link-image-filename");q=e.find("#link-mixed-content");p=e.find(".link-text");b=p.find("input");b.change(function(a){a.keyCode=a.keyCode||a.which;a.keyCode&&13!==a.keyCode&&b.removeClass("default-alias")});g.change(function(){g.prop("checked")?("attachment"!==f.getResourceType()&&f.setTarget("_blank"),y("editor.linkBrowser.location.openInNewWindow.checked",f)):(f.removeTarget(),y("editor.linkBrowser.location.openInNewWindow.unchecked",
f))});return{setLink:function(a,c){i.debug("Link Browser: setting link : "+a);var d=a.attrs["data-linked-resource-default-alias"]||a.getHtml();if(""===m()||b.hasClass("default-alias"))b.addClass("default-alias"),b.val(d);if(c&&a.getResourceId()&&a.getResourceType()){var e={clearErrors:function(){},error:function(){},select:function(a){o.update(a,e)}},d={id:a.getResourceId(),type:a.getResourceType()};o.update(d,e)}v(c);i.DarkFeatures.isEnabled(t.OPEN_IN_NEW_WINDOW_DARK_FEATURE)?(g.prop("checked")&&
a.setTarget("_blank"),g.prop("checked","_blank"===a.getTarget())):a.removeTarget();f=a;t.linkValid(f&&f.isHrefValid())},getLink:function(){if(!f)return null;var a=r;a||((a=m())||(a=f.getDefaultAlias()||f.getHref()),a={html:a});f.body=a;f.attrs.href=w(f.attrs.href);return f},refresh:function(a){f&&v(a)},setLinkBody:function(a){r||(a.isEditable?b.val(a.text):a.isImage?l.text(a.imgName):q.text(a.text),r=a.isEditable?null:a,p.toggleClass("hidden",!a.isEditable),z.toggleClass("hidden",!a.isImage),A.toggleClass("hidden",
a.isEditable||a.isImage))},getContainer:function(){return e},isLinkTextVisible:x,isLinkImageVisible:function(){return l.is(":visible")},isNewWindowCheckboxVisible:function(){return g.is(":visible")},isNewWindowCheckboxChecked:function(){return g.prop("checked")},isLinkMixedContentVisible:function(){return q.is(":visible")},focusLinkText:function(){return x()?(i.debug("LinkInfoPresenter.focusLinkText focusing alias"),b.select(),!0):!1},getLinkText:m,getRawLinkText:u,getLinkImageName:function(){return l.text()},
moveLocationPanel:function(a){h||(h=e.find(".row:not(.hidden) .field-group"),h.each(function(a,d){k(d).data("original-parent",k(d).parent())}));h.appendTo(a);e.hide()},restoreLocationPanel:function(){h&&h.each(function(a,c){var d=k(c);d.data("original-parent")&&(d.appendTo(d.data("original-parent")),d.removeData("original-parent"))});e.show();h=null},hasBreadcrumbs:function(a){if(!j.is(":visible"))return!1;var c=a.length,d=j.find("li");if(d.length!==c)return!1;for(var b=0;b<c;b++)if(d.eq(b).text()!==
a[b])return!1;return!0},showOpenInNewWindowCheckbox:function(a){g.closest(".row").toggleClass("hidden",!a)},encodeURLSafely:w}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser-location","Confluence.Editor.LinkBrowser.LinkInfoPresenter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-search.js' */
define("confluence-link-browser/link-browser-tab-search",["jquery","ajs","document","confluence/legacy","confluence/page-location"],function(d,b,n,i,o){return{dialogCreatedLinkBrowserSearch:function(n,j){var c,e,f,m,p=b.REST.getBaseUrl()+"search.json",k=function(a,b){i.Link.isLink(a)||(a=i.Link.fromREST(a));b&&c.val(a.attrs["data-linked-resource-default-alias"]);j.setLink(a,!0);j.focusLinkText()},l=function(a){b.debug("link-browser-tab-search.js: doing search");c.trigger("hide.autocomplete");var g=
d.trim(c.val());g?(f.loading(),b.getJSONWrap({url:p,data:{search:"site",query:g,spaceKey:e.val()},successCallback:function(b){d.isFunction(a)?(f.update(b.result),a()):f.updateAndSelect(b.result);c.trigger("hide.autocomplete")},messageHandler:m})):d.isFunction(a)&&a()};j.tabs.search={hasBreadcrumbs:!0,createPanel:function(a){var g=a.baseElement;c=g.find("#link-search-text");e=g.find("#search-panel-space");var h=o.get();e.find("option:eq(1)").text(h.spaceName).val(h.spaceKey);e.change(function(){c.attr("data-spacekey",
e.val());c.trigger("clearCache.autocomplete")});i.Binder.autocompleteSearch(c.parent());c.bind("selected.autocomplete-content",function(a,b){b.searchFor?l():(f.clear(),k(b.content,!1))});h=[b.SelectGrid.Column({key:"title",heading:"Title",getHref:function(a){return b.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),b.SelectGrid.Column({key:"space",heading:"Space",getText:function(a){return a.space&&
a.space.title||""}}),b.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];m=b.MessageHandler({baseElement:a.baseElement.find(".message-panel")});f=new b.ResultGrid({baseElement:a.baseElement,columns:h,selectionCallback:function(a,b){k(b)},noResultMessage:"No search results found.",
dontShiftFocus:function(){return d(c).add(e).is(":focus")}});g.find(".search-form").submit(function(){l();return!1}).keydown(function(a){13===a.keyCode&&!d(".aui-dropdown:visible .active",this).length&&(d("#search-panel-button").focus(),a.stopPropagation())})},onSelect:function(){b.debug("Link Browser Search panel selected");var a=this.openedLink;a?(b.debug("Link Browser Search panel setting link info"),k(a,!0)):c.focus()},handlesLink:function(a){return a.isCustomAtlassianContentLink()&&!a.hasAnchor()&&
!a.isShortcutLink()&&!a.isToAttachmentOnSamePage(b.Meta.get("content-id"))},doSearch:function(a,b){c.val(a);l(b)},isResultGridVisible:function(){return f.isVisible()},getSearchTextField:function(){return c}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-search",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserSearch)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-history.js' */
define("confluence-link-browser/link-browser-tab-history",["ajs","confluence/legacy"],function(a,h){return{dialogCreatedLinkBrowserHistory:function(i,d){var e=a.REST.makeUrl("session/history.json?max-results=20"),f,g;d.tabs.recentlyviewed={createPanel:function(c){var e=[a.SelectGrid.Column({key:"title",heading:"Title",getHref:function(b){return a.REST.findLink(b.link)},getInnerClass:function(b){return b.iconClass||"content-type-"+b.type}}),a.SelectGrid.Column({key:"space",
heading:"Space",getText:function(b){return b.space&&b.space.title||""}}),a.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(b){return b.lastModifiedDate&&b.lastModifiedDate.friendly||""},getTitle:function(b){return b.lastModifiedDate&&b.lastModifiedDate.date||""}})];g=a.MessageHandler({baseElement:c.baseElement.find(".message-panel")});f=new a.ResultGrid({baseElement:c.baseElement,
columns:e,getRowId:function(b){return b.attachmentId},selectionCallback:function(b,a){var c=h.Link.fromREST(a);d.setLink(c);d.focusLinkText()},messageHandler:g,noResultMessage:"You have no recently viewed content."})},onSelect:function(){f.loading();a.getJSONWrap({url:e,messageHandler:g,successCallback:function(c){f.update(c.content);a.trigger("updated.link-browser-recently-viewed")}})}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-history",function(a){require("ajs").bind("dialog-created.link-browser",a.dialogCreatedLinkBrowserHistory)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-attachment.js' */
define("confluence-link-browser/link-browser-tab-attachment",["jquery","ajs","confluence/legacy"],function(h,a,j){return{dialogCreatedLinkBrowserAttachment:function(m,i){var f=a.REST.makeUrl("content/"+a.Meta.get("attachment-source-content-id")+"/attachments.json"),g,k,l,d;i.tabs.attachments={hasBreadcrumbs:!1,createPanel:function(b,c){var e=b.baseElement.find(".attach-file-form");g=h.extend({getUploaderController:function(){return j.AttachmentUploader({baseElement:e},function(){return{onUploadSuccess:function(a){for(var b=
0,c=a.length;b<c;b++)a[b].type="attachment";d.prependAndSelect(a)}}})}},c&&c(b));k=g.getUploaderController(b);l=k.getMessageHandler();var f=[a.SelectGrid.Column({key:"title",heading:"Name",getHref:function(b){return b.link?a.REST.findLink(b.link):b.url},getInnerClass:function(a){return a.iconClass}}),a.SelectGrid.Column({key:"size",heading:"Size",getText:function(a){return a.niceFileSize}}),a.SelectGrid.Column({key:"comment",
heading:"Comment"})];d=new a.ResultGrid({baseElement:b.baseElement,columns:f,selectionCallback:function(b,c){var d=j.Link.fromREST(c);d.attrs["data-linked-resource-container-id"]=a.Meta.get("content-id");if(h.isArray(c.link))for(var e=0,f=c.link.length;e<f;e++){var g=c.link[e];"download"===g.rel&&(d.attrs.href=g.href)}i.setLink(d);i.focusLinkText()},noResultMessage:"There are no files on this page."})},onSelect:function(){var b=this.openedLink,c=i.getLink();
d.loading();a.getJSONWrap({url:f,messageHandler:l,successCallback:function(e){d.update(e.attachment);c?"attachment"==c.getResourceType()&&d.select(c.getResourceId()):b?d.select(b.getResourceId()):e.attachment.length&&d.select(e.attachment[0].id);a.debug("Loaded attachments")}})},handlesLink:function(b){return b.isToAttachmentOnSamePage(a.Meta.get("content-id"))}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-attachment",function(h){var a=require("ajs");"template"!==a.Meta.get("content-type")&&a.bind("dialog-created.link-browser",h.dialogCreatedLinkBrowserAttachment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-weblink.js' */
define("confluence-link-browser/link-browser-tab-weblink",["ajs","jquery","confluence/legacy"],function(d,k,h){return{dialogCreatedLinkBrowserWeblink:function(n,c){function e(){return k.trim(b.val())}function f(){var a=e();if(!(d.Validate.url(a)||0===a.indexOf("mailto:"))){if(d.Validate.email(a))a="mailto:"+a;else{if(l.test(a))return;a="http://"+a}d.debug("Updating Link Browser Web Link URL to: "+a);b.val(a);a=h.Link.makeExternalLink(a);c.setLink(a)}}function i(){var a=e();(a=a?h.Link.makeExternalLink(a):
null)&&c.setLink(a)}function m(){f();i()}var b,g,j,l=/[:/]/;j=c.tabs.weblink={createPanel:function(a){g=a.baseElement;b=g.find("input[name='destination']");b.keyup(function(){i()});b.change(f);b.bind("paste",function(){d.debug("Link Browser web link url pasted");setTimeout(m,0)})},onSelect:function(){d.DarkFeatures.isEnabled(c.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&c.showOpenInNewWindowCheckbox(!0);c.moveLocationPanel(g.find("form:first"));this.openedLink&&(j.setURL(this.openedLink.attrs.href),c.setLink(this.openedLink));
setTimeout(function(){b.focus()})},onDeselect:function(){c.restoreLocationPanel();c.showOpenInNewWindowCheckbox(!1)},preSubmit:f,handlesLink:function(a){return!a.isCustomAtlassianContentLink()},setURL:function(a){b.val(a);b.keyup();b.change()},getURL:e}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-weblink",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserWeblink)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-advanced.js' */
define("confluence-link-browser/link-browser-tab-advanced",["jquery","ajs","confluence/legacy","confluence/api/constants","confluence/meta"],function(g,e,l,m,i){return{dialogCreatedLinkBrowserAdvanced:function(p,d){var c,f,h,k,n=function(b){b=g(b);if(b.length){var a=b.find("a:first");a.length?a.hasClass("unresolved")?(b=a.attr("shortcut-key"),a=a.attr("data-space-key"),b?f.text(e.format("{0} is not a recognized shortcut",b)):a&&f.text(e.format("{0} is not a recognized space",
a))):(b=l.Link.fromNode(a[0],c.val()),d.setLink(b)):f.text("The markup provided is not valid link markup")}},o=function(b,a,c){e.debug("Error during conversion: textStatus = "+a+", errorThrown = "+c);f.text("An internal server error occurred")},j=d.tabs.advanced={createPanel:function(b){h=b.baseElement;c=h.find("input[name='advanced-link']");f=h.find("div[name='advanced-error']");h.find("form").keydown(function(a){13===a.keyCode&&!d.isSubmitButtonEnabled()&&a.preventDefault()});
c.keyup(function(){clearTimeout(k);f.text("");c.val()&&(k=setTimeout(function(){var a=c.val(),a=a.replace(/\[/g,"\\[").replace(/]/g,"\\]"),a={wiki:"["+a+"]",entityId:i.get("content-id"),spaceKey:i.get("space-key"),contextType:i.get("content-type")};g.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:m.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:g.toJSON(a),dataType:"text",success:n,error:o,timeout:1E4})},200))})},setLink:function(b){c.val(b);c.keyup();c.change()},getLink:function(){return c.val()},
onSelect:function(){e.DarkFeatures.isEnabled(d.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&d.showOpenInNewWindowCheckbox(!0);d.moveLocationPanel(h.find("form:first"));this.openedLink&&(this.openedLink.isShortcutLink()?j.setLink(this.openedLink.getShortcut()):this.openedLink.getResourceId()?j.setLink(this.openedLink.getDefaultAlias()):j.setLink("#"+this.openedLink.getAnchor()),d.setLink(this.openedLink));setTimeout(function(){c.focus()})},onDeselect:function(){d.restoreLocationPanel();d.showOpenInNewWindowCheckbox(!1)},
handlesLink:function(b){return b.isShortcutLink()||b.hasAnchor()}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-advanced",function(g){require("ajs").bind("dialog-created.link-browser",g.dialogCreatedLinkBrowserAdvanced)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'templates/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LinkBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.searchPanel = function(opt_data, opt_ignored) {
  return '<form class="aui search-form" onsubmit="return false;"><fieldset class="inline"><div class="search-input"><label for="link-search-text" id="linkSearch-label" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input id="link-search-text" type="text" tabindex="0" class="text autocomplete-search" name="linkSearch" autocomplete="off" data-search-link-message="' + soy.$$escapeHtml('Search for \x26lsquo;{0}\x26rsquo;') + '"></div><select tabindex="0" class="search-space select" id="search-panel-space"><option value="">' + soy.$$escapeHtml('All content') + '</option><option value=""> </option></select><button type="submit" tabindex="0" class="aui-button" id="search-panel-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table hidden"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.searchPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.searchPanel';
}


Confluence.Templates.LinkBrowser.recentlyviewedPanel = function(opt_data, opt_ignored) {
  return '<div class="recently-viewed-panel"><div class="message-panel hidden"></div><div class="data-table"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.recentlyviewedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.recentlyviewedPanel';
}


Confluence.Templates.LinkBrowser.attachmentsPanel = function(opt_data, opt_ignored) {
  return '<div class="attach-file-form"><form method="post" enctype="multipart/form-data" id="attachments-attachfile-form" action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" class="aui"><p>' + soy.$$escapeHtml('Link to a file that is attached to this page or attach a new one.') + '</p><div class="upload-field field-group"><label for="file_0">' + soy.$$escapeHtml('Upload file') + '</label><label id="fancy-file-upload" class="ffi" data-ffi-button-text="Browse"><input type="file" name="file_0" id="file_0"></label><input type="hidden" name="minorEdit_0" value="true"></div><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" /></form><div class="upload-in-progress upload-field hidden">' + soy.$$escapeHtml('Upload in progress...') + '</div><div class="warning"><ul class="hidden message-panel"></ul></div></div><div class="message-panel hidden"></div><div id="attachments-table" class="attachment-list data-table"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.attachmentsPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.attachmentsPanel';
}


Confluence.Templates.LinkBrowser.weblinkPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label id="destination-label" for="weblink-destination">' + soy.$$escapeHtml('Address') + '</label><input type="text" tabindex="0" class="text" id="weblink-destination" name="destination"><div class="web-link-desc description">' + soy.$$escapeHtml('Web, email or any other internet address') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.weblinkPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.weblinkPanel';
}


Confluence.Templates.LinkBrowser.advancedPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="advanced-desc title">' + soy.$$filterNoAutoescape(AJS.format('Here you can insert a link into the page using \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3ewiki markup\x3c/a\x3e.',"https://docs.atlassian.com/confluence/docs-713/Links")) + '</div><div class="field-group"><label id="advanced-label" for="advanced-link">' + soy.$$escapeHtml('Link') + '</label><input type="text" tabindex="0" class="text" id="advanced-link" name="advanced-link"><div class="advanced-desc description">' + soy.$$escapeHtml('To insert a link to a new page, type in the desired page title.') + '<br/>' + soy.$$escapeHtml('To insert an anchor link, type #anchorname.') + '</div><div name="advanced-error" class="advanced-error error"></div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.advancedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.advancedPanel';
}


Confluence.Templates.LinkBrowser.locationPanel = function(opt_data, opt_ignored) {
  return '<div id="link-browser-location" class="location-info"><form class="aui"><div class="row hidden field-group"><label class="link-location-label" for="breadcrumbs-link">' + soy.$$escapeHtml('Link location') + '</label><div class="breadcrumbs-container" id="breadcrumbs-link"><div class="breadcrumbs-line"><ol id="breadcrumbs-container" class="breadcrumbs"></ol></div></div></div></form><div class="row link-text"><form class="aui" onsubmit="return false;"><div class="field-group"><label for="alias" id="alias-label">' + soy.$$escapeHtml('Link text') + '</label><input type="text" tabindex="0" class="text" name="alias" id="alias"></div></form></div><div class="row link-open-in-new-window hidden"><div class="field-group"><div class="checkbox"><input type="checkbox" class="checkbox" name="open-in-new-window" tabindex="0" id="link-open-in-new-window"><label for="link-open-in-new-window" id="open-window-label">' + soy.$$escapeHtml('Open in new tab/window') + '</label></div></div></div><div class="row link-image hidden"><div class="readonly"><label for="link-image-filename">' + soy.$$escapeHtml('Link image') + '</label><span id="link-image-filename" class="content-type-attachment-image"></span></div></div><div class="row link-mixed hidden"><div class="readonly"><label for="link-mixed-content">' + soy.$$escapeHtml('Link text') + '</label><span id="link-mixed-content"></span></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.locationPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.locationPanel';
}


Confluence.Templates.LinkBrowser.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-713/Links") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.helpLink.soyTemplateName = 'Confluence.Templates.LinkBrowser.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/move-hidden-fields-hack.js' */
AJS.toInit(function(a){a("fieldset.create-content-template-fields \x3e input").appendTo("form.editor")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro-fields.js' */
AJS.toInit(function(f){function h(a,b){a=a||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(a,!1,function(d){var e=Confluence.Blueprint.Dialog.loadedWebitems[a];_.isEmpty(e)?AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey \x3e"+a+"\x3c"):b(d,e)},function(){AJS.error("create-from-template-macro-fields: requestWebItems call for spaceKey \x3e"+a+"\x3c failed")})}function g(a,b){h(b,function(b,e){b=a.val();a.empty();_.each(e,function(b){var c=
b.itemModuleCompleteKey;"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"!==c&&"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post"!==c&&(b.templateId||b.contentBlueprintId)&&(c=f("\x3coption\x3e\x3c/option\x3e").text(b.name),c.attr("data-template-id",b.templateId),c.attr("data-blueprint-module-complete-key",b.blueprintModuleCompleteKey),c.attr("data-content-blueprint-id",b.contentBlueprintId),c.attr("data-create-result",b.createResult),
c.val(b.templateId||b.contentBlueprintId),a.append(c))});a.val(b)})}AJS.MacroBrowser.setMacroJsOverride("create-from-template",{fields:{spacekey:{spaceKey:function(a){var b=AJS.MacroBrowser.ParameterFields.spacekey(a),d=b.input.val();a=function(){var a=b.input.val();a!=d&&g(AJS.MacroBrowser.fields.templateName.input,a);d=a};b.input.bind("selected.autocomplete-content",a);b.input.blur(a);return b}}},beforeParamsSet:function(a,b){a.buttonLabel=a.buttonLabel||a.createButtonLabel||"Create from template";
g(f("#macro-param-templateName"),a.spaceKey);return a},beforeParamsRetrieved:function(a,b,d){b=AJS.MacroBrowser.fields.templateName.input.find("option:selected");a.blueprintModuleCompleteKey=b.data("blueprint-module-complete-key");a.contentBlueprintId=b.data("content-blueprint-id");a.templateId=b.data("template-id");a.createResult=b.data("create-result");return a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-manager.js' */
define("confluence-templates/variable-manager",["confluence/api/event","jquery"],function(f,g){function i(c,a){var b=c.toLocaleLowerCase(),d=a.toLocaleLowerCase(),b=b.localeCompare(d);0==b&&(b=c.localCompare(a));return b}function h(c){return g.extend(!0,{},e.defaults[c]||e.defaults.string)}var e=function(){var c={};return{find:function(a){var a=a.toLocaleLowerCase(),b={},d;for(d in c)if(c.hasOwnProperty(d)&&(!a.length||0===d.toLocaleLowerCase().indexOf(a)))b[d]=c[d];return b},contains:function(a){return!!c[a]},
get:function(a){return c[a]},getAll:function(){return g.extend(!0,{},c)},getSortedNames:function(){var a=[],b;for(b in c)a.push(b);return a.sort(i)},add:function(a,b){c[a]=b||h();f.trigger("add.confluence-variable",{name:a,details:g.extend(!0,{},b)})},del:function(a){var b=c[a];delete c[a];f.trigger("delete.confluence-variable",{name:a,details:g.extend(!0,{},b)})},rename:function(a,b){var d=c[a];delete c[a];d&&(c[b]=d,f.trigger("rename.confluence-variable",{oldName:a,newName:b,details:g.extend(!0,
{},details)}))},createDefault:h}};e.defaultVariableManager=e();e.defaults={textarea:{type:"textarea",rows:5,columns:100},list:{type:"list",options:[]},string:{type:"string"}};return e});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-manager",function(f){require("confluence/legacy").VariableManager=f});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-placeholder.js' */
define("confluence-templates/variable-placeholder",["ajs","jquery"],function(a,d){return{component:{insertPlaceholder:function(c,e){var b;b="$"+c;var f=a.Rte.getEditor();a.Rte.BookmarkManager.storeBookmark();b={title:b,src:a.Meta.get("context-path")+"/plugins/servlet/confluence/placeholder/template-variable?name="+encodeURIComponent(c),"data-variable-name":c,"class":"template-variable",alt:"$"+c};e&&d.extend(b,e);b=d("<img/>").attr(b);f.selection.setNode(b[0])}},init:function(){d(a.Rte.getEditor().getBody()).delegate("img.template-variable",
"dragstart",function(a){a.preventDefault()})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-placeholder",function(a){require("confluence/legacy").VariablePlaceHolder=a.component;require("ajs").bind("init.rte",a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-toolbar.js' */
define("confluence-templates/variable-toolbar",["ajs","document","confluence/api/event","jquery","confluence/legacy"],function(e,k,h,f,c){return{init:function(){h.bind("init.rte",function(){var g=c.VariableManager.defaultVariableManager,a=f("#template-menu"),i=a.find(".variables-list");h.bind("add.confluence-variable,delete.confluence-variable,rename.confluence-variable",function(){var b=g.getSortedNames(),j=b.length,d="";i.toggleClass("hidden",!j);for(var a=0;a<j;a++)d+=c.Templates.Variables.renderVariableItem({variableName:"$"+
b[a],tooltip:e.format("Insert the \u0027\u0027{0}\u0027\u0027 field into the page for the template user to fill out.",b[a])});i.html(d)});a.delegate(".variables-list a","click",function(){var b=f(this).attr("data-variable-name");!g.contains(b)&&g.add(b);c.VariablePlaceHolder.insertPlaceholder(b)});a.delegate(".variables-add","click",function(b){var a=c.Editor.Autocompleter.Manager.getInputDrivenDropdown();e.Rte.getEditor().focus();(!a||a.inactive)&&c.Editor.Autocompleter.Manager.shortcutFired("$",!0);b.stopPropagation()});f(k).bind("showLayer",
function(b,c,d){"dropdown"===c&&d.$.closest(a).length&&d.reset()})})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-toolbar",function(e){e.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/autocomplete-settings-variables.js' */
define("confluence-templates/autocomplete-settings-variables",["confluence/legacy","ajs"],function(d,c){return function(){function e(a,b){return{callback:function(c){c.replaceWithSelectedSearchText();!f.contains(a)&&f.add(a);d.VariablePlaceHolder.insertPlaceholder(a,b)},name:c.escapeHtml(a),href:"#"}}function i(a,b){return!a&&!b?0:!a?-1:!b?1:a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())}var f=d.VariableManager.defaultVariableManager;return{ch:"$",cache:!1,endChars:[],dropDownDelay:0,
preventStartNodes:"",dropDownClassName:"autocomplete-variables",selectFirstItem:!0,getHeaderText:function(a,b){return b?"Variable suggestions":"Variable suggestions"},getAdditionalLinks:function(a,b){var e=d.unescapeEntities(b);return f.get(e)||0===b.length?[]:[{className:"dropdown-create-variable",href:"#",callback:function(a){var b=a.plainText();a.replaceWithSelectedSearchText();!f.contains(b)&&f.add(b);d.VariablePlaceHolder.insertPlaceholder(b,
void 0)},name:c.format("Create variable \u0027\u0027{0}\u0027\u0027",b)}]},getDataAndRunCallback:function(a,b,c){var g,k,a=d.unescapeEntities(b),j=f.find(a),h=[],l=[];for(g in j)j.hasOwnProperty(g)&&h.push(g);h.sort(i);a=0;for(k=h.length;a<k;a++)g=h[a],l.push(e(g,j[g]));c([l],b)},update:function(){}}}});
require("confluence/module-exporter").safeRequire("confluence-templates/autocomplete-settings-variables",function(d){var c=require("ajs"),e=require("confluence/legacy"),i=require("confluence/meta");c.bind("init.rte",function(){var c=require("tinymce");"template"===i.get("content-type")&&(e.Editor.Autocompleter||(e.Editor.Autocompleter=c.confluence.Autocompleter),e.Editor.Autocompleter.Settings.$=d())})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/property-panel-variables.js' */
define("confluence-templates/property-panel-variables",["ajs","jquery","confluence/legacy"],function(b,a,h){return{name:"variable",canHandleElement:function(a){return a.hasClass("template-variable")},handle:function(f){function l(d){b.debug("clicked type: "+d);var c=a("#property-panel");c.find(".panel-buttons").toggleClass("no-inputs","string"===d);c.find(".textarea-section,.list-section,.string-section").addClass("hidden");c.find("."+d+"-section").removeClass("hidden");"textarea"===d?(a("#variable-property-panel-textarea-rows").val(e.rows),
a("#variable-property-panel-textarea-columns").val(e.columns)):"list"===d&&a("#variable-property-panel-list-values").val(e.options.join(","))}function i(d,b,c){return{className:"variable-property-panel-type-item variable-property-panel-type-"+d,text:b,tooltip:c,selected:m===d,click:function(){e.type=d;e=j.createDefault(d);j.add(k,e);a(".variable-property-panel-type-item").removeClass("selected");a(".variable-property-panel-type-"+d).addClass("selected");l(d)}}}function g(a){return m===a?"":" hidden"}
if(!("click"!==f.e.type&&"mouseup"!==f.e.type)){var f=f.containerEl,n=a(f),k,c=[],o={originalHeight:n.height(),anchorIframe:b.Rte.getEditorFrame()};k=n.attr("data-variable-name");var j=h.VariableManager.defaultVariableManager,e=j.get(k),m=e&&e.type||"string";c.push(i("string","Text","Single line text input field."));c.push(i("textarea","Multi-line Text","Multi-line text input field."));
c.push(i("list","List","Drop down list."));c.push(null);c.push({className:"editable textarea-section"+g("textarea"),tooltip:"Number of rows to display for the field.",html:'<input id="variable-property-panel-textarea-rows"/>'});c.push({className:"variable-property-panel-textarea-split textarea-section"+g("textarea"),tooltip:"",html:"<span>x</span>"});c.push({className:"editable textarea-section"+
g("textarea"),tooltip:"Number of columns to display for the field.",html:'<input id="variable-property-panel-textarea-columns"/>'});c.push(null);c.push({className:"editable list-section"+g("list"),tooltip:"Enter each item for the list, separating each with a comma.",html:"<input id=\"variable-property-panel-list-values\" size='50'/>"});b.Confluence.PropertyPanel.createFromButtonModel("variable",f,c,o);l(e.type);a("#variable-property-panel-textarea-rows").change(function(){e.rows=
+a(this).val()||h.VariableManager.defaults.textarea.rows});a("#variable-property-panel-textarea-columns").change(function(){e.columns=+a(this).val()||h.VariableManager.defaults.textarea.columns});a("#variable-property-panel-list-values").change(function(){var d,b,c,f=a(this).val().split(",");e.options=[];d=0;for(b=f.length;d<b;d++)(c=a.trim(f[d]))&&e.options.push(c)});a("#variable-property-panel-textarea-rows,#variable-property-panel-textarea-columns,#variable-property-panel-list-values").keypress(function(b){13===
b.which&&a(this).blur()})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-templates/property-panel-variables","AJS.Confluence.PropertyPanel.Variable",function(b){var a=require("ajs");a.bind("init.rte",function(){a.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-marshaller.js' */
define("confluence-templates/variable-marshaller",["ajs","jquery","confluence/legacy"],function(d,b,p){function q(c){var a=c.attr("data-variable-type");return"textarea"===a?{type:a,rows:+c.attr("data-variable-rows")||i,columns:+c.attr("data-variable-columns")||r}:"list"===a?{type:a,options:c.find("li").map(function(){return b(this).attr("data-variable-option")}).toArray()}:{type:"string"}}function m(){var c=b(d.Rte.getEditor().getBody()).find("img[data-variable-name]"),a={};b.map(c,function(c){var f=
{};b(c).attr("data-variable-raw-xhtml")&&(f={"data-variable-raw-xhtml":!0});a[b(c).attr("data-variable-name")]=f});return a}var i=5,r=100;return function(){function c(a){for(var b in a)a.hasOwnProperty(b)&&!f.contains(b)&&(d.debug("adding: ",b),f.add(b,a[b]))}var a=d.Rte.getEditor(),i=b(a.getBody()),f=p.VariableManager.defaultVariableManager;a.on("GetContent",function(a){var d=b("<div></div>"),i=b("<ul></ul>").attr("data-variable-declarations","true"),e;d.append(i);var n=m();c(n);var o=f.getAll(),
l;for(l in o)if(n.hasOwnProperty(l)){var j=l;e=o[l];var g=void 0,k=void 0,g=e.type,h=b("<li></li>");h.attr("data-variable-name",j);h.attr("data-variable-type",g);h.text(j);if("textarea"===g)h.attr("data-variable-rows",e.rows),h.attr("data-variable-columns",e.columns);else if("list"===g){g=b("<ul></ul>");j=void 0;for(j in e.options)k=e.options[j],k=b("<li></li>").text(k).attr("data-variable-option",k),g.append(k);h.append(g)}e=h;i.append(e)}a.content=d.html()+a.content});a=i.find("ul[data-variable-declarations]");
a.remove();a.find("li[data-variable-name]").each(function(){var a=b(this);f.add(a.attr("data-variable-name"),q(a))});c(m())}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-marshaller",function(d){require("ajs").bind("init.rte",d)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-template-resources', location = 'js/variable-templates.soy' */
// This file was automatically generated from variable-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Variables.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Variables == 'undefined') { Confluence.Templates.Variables = {}; }


Confluence.Templates.Variables.renderVariableItem = function(opt_data, opt_ignored) {
  return '<li class="dropdown-item" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltip) + '"><a href="#" class="item-link variable-item" title="' + soy.$$escapeHtml(opt_data.variableName) + '" data-variable-name="' + soy.$$escapeHtml(opt_data.variableName) + '">' + soy.$$escapeHtml(opt_data.variableName) + '</a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Variables.renderVariableItem.soyTemplateName = 'Confluence.Templates.Variables.renderVariableItem';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:confluence-fixed-headers-editor-resources', location = '/js/slow-edit-handler.js' */
require(["confluence/fh/utils/dom","ajs"],function(c,a){a.toInit(function(){var b=a.Meta.get("browse-page-tree-mode");if("create"===b||"edit"===b)c.addClassToPage(),$("#content").css({paddingRight:0})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.pattern.toolbar1', location = 'aui.chunk.2e5a57e4e871239c85ed--04322bc020cb0bd3caaf.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.pattern.toolbar1"],{DHJP:function(i,n,t){"use strict";t.r(n)}},[["DHJP","runtime"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-tinymce-keyboard-shortcuts', location = 'js/tinymce-plugin.js' */
define("confluence-keyboard-shortcuts/tinymce-plugin",["ajs","confluence-keyboard-shortcuts/confluence-keyboard-shortcuts"],function(e,b){return{init:function(a){e.debug("Init Editor Keyboard shortcuts plugin");for(var c=function(b){return function(){a.execCommand("FormatBlock",!1,b)}},d=1;7>d;d++)a.addCommand("FormatBlock-h"+d,c("h"+d));a.addCommand("FormatBlock-p",c("p"));a.addCommand("FormatBlock-pre",c("pre"));a.addCommand("FormatBlock-blockquote",c("blockquote"));a.addCommand("mceConfShortcutDialog",
b.keyboardShortcuts.openDialog);a.ui.registry.addButton("help",{text:"confluence.conf_shortcuts_help_desc",onAction:function(){a.execCommand("mceConfShortcutDialog")}})},getInfo:function(){var a=require("tinymce");return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/tinymce-plugin",function(e){var b=require("tinymce");b.create("tinymce.plugins.KeyboardShortcutsPlugin",e);b.PluginManager.add("keyboardshortcuts",b.plugins.KeyboardShortcutsPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel', location = 'com/atlassian/confluence/image/effects/property-panel.js' */
AJS.toInit(function(e){function r(){AJS.bind("dialog-created.image-properties",function(a,d){b=d.img;l()?b.naturalHeight&&b.naturalWidth&&16E6<b.naturalHeight*b.naturalWidth?Confluence.Editor.ImageProps.registerPanel("image-effects",g("This image is too large to rotate or apply image effects. You\u0027ll need to upload a smaller version of the file."),"image-effects-panel",null):Confluence.Editor.ImageProps.registerPanel("image-effects",g(),"image-effects-panel",t):Confluence.Editor.ImageProps.registerPanel("image-effects",g("Image effects can\u0027t be applied to web images"),
"image-effects-panel",null)});AJS.bind("dialog-before-show.image-properties",function(){m();n(h(e(b)))})}function u(){var a=new AJS.Dialog({width:600,height:500,id:"image-effects-dialog"});a.addHeader("Add Image Effect");a.addPanel("",g(),"");m();a.addSubmit("Save",function(){p(v,w).done(function(){a.hide()})});a.addCancel("Close",function(){a.hide()});AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,
{create:function(d){b=d[0];d=h(d);var c=!l();return{className:"image-effects",text:"Effects...",tooltip:c?"Image effects can\u0027t be applied to web images":"Add an image effect like drop shadow or picture frame",click:function(){if(b.naturalHeight&&b.naturalWidth&&16E6<b.naturalHeight*b.naturalWidth)return alert("This image is too large to rotate or apply image effects. You\u0027ll need to upload a smaller version of the file."),!1;n(h(e(b)));AJS.Confluence.PropertyPanel.destroy();a.show()},disabled:c,selected:!!d}}})}function x(a,
d){var c=a.attr("src"),b=y.exec(c),e=d?"effects\x3d"+d:"";b?c=c.replace(b[2],e):d&&(c=c+(-1!=c.indexOf("?")?"\x26":"?")+e);a.attr("src",c);a.attr("data-mce-src",c);d=(d=a.attr("confluence-query-params"))?(b=q.exec(d))?d.replace(b[2],e):d+"\x26"+e:e;a.attr("confluence-query-params",d)}function h(a){a=a.attr("confluence-query-params");if(a=q.exec(a))return a[3]}function n(a){e(".image-effect-preview.selected").removeClass("selected");a?e(f).each(function(d,c){if(c.effects==a)return e(e(".image-effect-preview")[d]).addClass("selected"),
!1}):e(".image-effect-preview.image-effect-none").addClass("selected");k=a}function g(a){return a?'\x3cdiv class\x3d"aui-message aui-message-warning warning"\x3e\x3cspan class\x3d"aui-icon icon-warning"\x3e\x3c/span\x3e'+a+"\x3c/div\x3e":'\x3cdiv class\x3d"image-effects"\x3e\x3cul class\x3d"image-list"\x3e\x3c/ul\x3e\x3c/div\x3e'}function m(){for(var a=e("div.image-effects ul.image-list"),d=Math.floor(22*Math.random())+1,c=0;c<f.length;c++){var b=e('\x3cli class\x3d"attached-image image-effect-preview'+
(f[c].effects?"":" image-effect-none")+'"\x3e\x3cdiv class\x3d"image-container"\x3e\x3cimg class\x3d"thumbnail" src\x3d"'+AJS.contextPath()+"/plugins/servlet/imgFilter.png?preview\x3dtrue\x26id\x3d"+d+"\x26effects\x3d"+f[c].effects+'" title\x3d"'+f[c].name+'" style\x3d"margin-top: 5px"\x3e\x3c/div\x3e\x3cspan class\x3d"caption filename" title\x3d"'+f[c].name+'"\x3e'+f[c].name+"\x3c/span\x3e\x3c/li\x3e");b.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});a.append(b);
b.click(f[c],function(a){e(".image-effect-preview.selected").removeClass("selected");e(this).addClass("selected");k=a.data.effects})}}function l(){return!e(b).hasClass("confluence-external-resource")}function t(){return p()}function p(a,d){function c(){d&&d();f.resolve();b.onload=null;tinyMCE.activeEditor.undoManager.add()}var f=e.Deferred();a&&a();b.onload=c;a=b.src;x(e(b),k);b.src==a&&c();return f}function v(){var a=dialog.popup.element,b=650/60,c=e('\x3cdiv class\x3d"image-properties-loading-blanket"\x3e\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo(a.find(".dialog-page-body")),
f=c.find(".loading-data");c.css({width:c.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042})}function w(){var a=dialog.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove()}var b,y=/(\?|&)(effects=[^&]+)($|&)/,q=/(^|&)(effects=([^&]+))($|&)/,k=null,f=[];f.push({name:"None",
effects:null});f.push({name:"Taped",effects:"border-simple,blur-border,tape"});f.push({name:"Instant Camera",effects:"border-polaroid,blur-border"});f.push({name:"Curl Shadow",effects:"border-simple,shadow-kn"});f.push({name:"Snapshot",effects:"border-simple,blur-border"});f.push({name:"Drop Shadow",effects:"drop-shadow"});Confluence.Editor.ImageProps?
r():u()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.Helper={getPosXOnMonthTimeline:function(g,e){var j=moment(g.startDate).startOf("month");var f=moment(e).startOf("month");var d=c.DateUtilities.getNumberOfMonths(j,f);var i=d*Roadmap.MONTH_WIDTH;var h=c.DateUtilities.getMilisecondsFromStartMonth(e)*Roadmap.MONTH_WIDTH/c.DateUtilities.getMilisecondsInMonth(e);return Math.round(i+h)},getPosXOnWeekTimeline:function(g,d){var e=moment(g.startDate).startOf("isoWeek");var f=moment(d).diff(e,"weeks",true);var h=f*Roadmap.WEEK_WIDTH;return Math.round(h)},getWidthTimeline:function(f,e){var d=e.duration;if(f.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){d*=Roadmap.MONTH_WIDTH}else{d*=Roadmap.WEEK_WIDTH}return d<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(d-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(i,h){var d=Math.floor(h/Roadmap.MONTH_WIDTH);var g=moment(i.startDate).startOf("month");var e=g.add(d,"months").toDate();var f=Math.abs(h)%Roadmap.MONTH_WIDTH;if(f!==0&&d<0){f=Roadmap.MONTH_WIDTH-f}var j=c.DateUtilities.getMilisecondsInMonth(e)*f/Roadmap.MONTH_WIDTH;return new Date(e.getTime()+j)},getWeekStartDateByPosition:function(f,e){var h=moment(f.startDate).startOf("isoWeek");var d=e/Roadmap.WEEK_WIDTH;var g=d*c.DateUtilities.MILLISECONDS_A_WEEK;return new Date(h.valueOf()+g)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})}};c.ColorHelper={resetColorCounts:function(){a.each(Roadmap.COLORS,function(d){d.count=0})},findColor:function(d){return a.find(Roadmap.COLORS,function(e){return e.lane===d.lane})},adjustColorCount:function(e,f){var d=c.ColorHelper.findColor(e);if(d){d.count=d.count+f}},getColor:function(){return a.min(Roadmap.COLORS,function(d){return d.count})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.DateUtilities={MILLISECONDS_A_DAY:86400000,MILLISECONDS_A_WEEK:604800000,parseDate:function(e){var d=moment(e,Roadmap.SHORT_DATE_FORMAT,true);if(d.isValid()){return d}d=moment(e,Roadmap.TWO_YY_SHORT_DATE_FORMAT,true);return d.isValid()?d:null},getDateStringFromDate:function(e,d){if(d){return moment(e).format(d)}return moment(e).format(Roadmap.DATE_FORMAT)},getDateFromDateString:function(e,d){return moment(e,d||Roadmap.DATE_FORMAT).toDate()},getNumberOfMonths:function(e,d){var g=moment(e),f=moment(d);return f.diff(g,"months")},getMilisecondsInMonth:function(d){return moment(d).daysInMonth()*c.DateUtilities.MILLISECONDS_A_DAY},getMilisecondsFromStartMonth:function(d){return d.getTime()-moment(d).startOf("month").valueOf()},calculateDurationInformation:function(d){var g=c.DateUtilities.getMilisecondsInMonth(d.toDate());var e=c.DateUtilities.getMilisecondsFromStartMonth(d.toDate());var f=g-e;return{totalMillisOfMonth:g,millisFromStartMonth:e,millisRemainingOfMonth:f,durationOfMonth:e/g,remainingDurationOfMonth:f/g}},convertToWeekDuration:function(e,g){var l=moment(e);var j=l.clone();var m=c.DateUtilities.calculateDurationInformation(l);if(g<=m.remainingDurationOfMonth){var f=g*m.totalMillisOfMonth;j=j.add(f,"ms")}else{j=j.add(m.millisRemainingOfMonth,"ms");g=g-m.remainingDurationOfMonth;var h=Math.floor(g);if(h>0){j=j.add(h,"months")}var k=g%1;var i=c.DateUtilities.getMilisecondsInMonth(j.toDate());var d=k*i;j.add(d,"ms")}return j.diff(l,"weeks",true)},convertToMonthDuration:function(e,j){var k=moment(e);var f=j*c.DateUtilities.MILLISECONDS_A_WEEK;var i=k.clone().add(f,"ms");var h=i.get("year")*12+i.get("month");h=h-(k.get("year")*12+k.get("month"));var l=c.DateUtilities.calculateDurationInformation(k);if(h===0){return f/l.totalMillisOfMonth}else{var g=l.remainingDurationOfMonth;var d=c.DateUtilities.calculateDurationInformation(i);g=g+d.durationOfMonth;g=g+(h-1);return g}}};c.FieldUtilities={fixDatePickerFields:function(d){var e=d.find("input[data-aui-dp-uuid]");e.each(function(f,g){var i=b(g),h=i.attr("data-aui-dp-uuid");i.on("click focus",function(){var j=b("[data-aui-dp-popup-uuid="+h+"]");if(AJS.version<="5.4.5"){var k=j.datepicker("option","onSelect");j.datepicker("option","onSelect",function(m,l){k(m,l);i.change()})}j.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bar=Backbone.Model.extend({defaults:function(){return{id:Confluence.Roadmap.Helper.guid(),title:"New Bar",description:"",startDate:new Date(),duration:1,rowIndex:0,pageLink:{}}}});Roadmap.Lane=Backbone.Model.extend({defaults:function(){return{title:"New Lane",color:Confluence.Roadmap.ColorHelper.getColor(),bars:[]}},initialize:function(){var a=new Roadmap.Bars(this.get("bars"));this.set("bars",a)},getNumberOfRows:function(){var a=this.get("bars");if(a.length===0){return 0}var b=0;a.each(function(c){b=Math.max(c.get("rowIndex"),b)});return b+1}});Roadmap.Marker=Backbone.Model.extend({defaults:function(){return{title:"Marker"}}});Roadmap.Timeline=Backbone.Model.extend({defaults:function(){return{displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH}},validate:function(a){var d=[];var c=Confluence.Roadmap.DateUtilities.parseDate(a.startDateString);var b=Confluence.Roadmap.DateUtilities.parseDate(a.endDateString);if(!c||!b){d.push({name:"date",message:"Enter dates in yy-mm-dd"})}else{if(c.diff(b)>=0){d.push({name:"endDate",message:"Start date needs to be before the end date"})}else{if(b.diff(c,"years",true)>Roadmap.TIMELINE_YEARS_LIMIT){d.push({name:"endDate",message:AJS.format("You cannot plan more than {0} years ahead.",Roadmap.TIMELINE_YEARS_LIMIT)})}}}return d.length>0?d:false},calculateTimelineColumns:function(){var d=this.get("startDate");var f=this.get("endDate");var c=[];var e;if(this.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){e=moment(d).clone().startOf("month");var b=moment(f).clone().endOf("month");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.MONTH_FORMAT),year:e.get("year")});e.add(1,"months")}while(e.diff(b)<0)}else{e=moment(d).clone().startOf("isoWeek");var a=moment(f).clone().endOf("isoWeek");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.WEEK_FORMAT),year:e.get("year")});e.add(1,"weeks")}while(e.diff(a)<0)}this.attributes.displayTimelineColumns=c}});Roadmap.Roadmap=Backbone.Model.extend({defaults:function(){return{title:"Roadmap Planner",lanes:[],markers:[]}},initialize:function(){var a=new Roadmap.Lanes(this.get("lanes"));this.set("lanes",a);var c=new Roadmap.Markers(this.get("markers"));this.set("markers",c);var b=new Roadmap.Timeline(this.get("timeline"));this.set("timeline",b)},parse:function(a){if(!a.timeline){return Roadmap.getDefaultRoadmapData()}return this.fromMacroData(a)},fromMacroData:function(c){var b=c.timeline;b.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.endDate);var a=c.lanes;_.each(a,function(e){var f=e.bars;_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(g.startDate);if(!g.id){g.id=Confluence.Roadmap.Helper.guid()}});e.bars=f});c.lanes=a;var d=c.markers;_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(e.markerDate)});c.markers=d;return c},toMacroData:function(){var c=this.toJSON();var b=c.timeline.toJSON();b.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.endDate);delete b.displayTimelineColumns;c.timeline=b;var a=c.lanes.toJSON();_.each(a,function(e){var f=e.bars.toJSON();_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(g.startDate)});e.bars=f});c.lanes=a;var d=c.markers.toJSON();_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.markerDate)});c.markers=d;return c},updateDurationUnit:function(a){this.get("lanes").each(function(b){b.get("bars").each(function(c){var d;d=a===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.convertToMonthDuration(c.get("startDate"),c.get("duration")):Confluence.Roadmap.DateUtilities.convertToWeekDuration(c.get("startDate"),c.get("duration"));c.attributes.duration=d})})}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bars=Backbone.Collection.extend({model:Roadmap.Bar});Roadmap.Lanes=Backbone.Collection.extend({model:Roadmap.Lane});Roadmap.Markers=Backbone.Collection.extend({model:Roadmap.Marker})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">' + aui.buttons.buttons({content: '' + aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml('Add lane'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml('Add bar'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml('Add marker'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'})}) + '</div><div class="aui-toolbar2-secondary">' + Confluence.Templates.Roadmap.timelineOptionsForm(null) + '</div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.toolbar.soyTemplateName = 'Confluence.Templates.Roadmap.toolbar';
}


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'timeline-options-form', action: '#', content: '<fieldset>' + aui.form.selectField({id: 'timeline-display-options-select', labelContent: '' + soy.$$escapeHtml('View by'), options: [{text: 'Months', value: 'MONTH'}, {text: 'Weeks', value: 'WEEK'}], extraClasses: 'view-by'}) + aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}) + ' - ' + aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}) + '<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error"></div></div></fieldset>'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineOptionsForm.soyTemplateName = 'Confluence.Templates.Roadmap.timelineOptionsForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.ToolbarView=Backbone.View.extend({className:"roadmap-toolbar",events:{"click #toolbar-button-add-bar":"onAddBarClick","click #toolbar-button-add-lane":"onAddLaneClick","click #toolbar-button-add-marker":"onAddMarkerClick","change #timeline-display-options-select":"onTimelineOptionChange"},initialize:function(){a.bindAll(this,"render")},render:function(){b(this.$el).html(Confluence.Templates.Roadmap.toolbar());this._initVariables();this._setupTimelineOptionsForm();return this},onAddBarClick:function(i){i.preventDefault();var d=this.model.get("lanes").at(0);var c=d.get("bars");var g=this.model.get("timeline");var f=this.model.get("timeline").get("startDate");var h=g.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?moment(f).startOf("month"):moment(f).startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:d.getNumberOfRows(),startDate:h.toDate()}))},onAddLaneClick:function(d){d.preventDefault();var c=this.model.get("lanes");c.add(new Roadmap.Lane())},onAddMarkerClick:function(f){var g=this.model.get("markers");var d=this.model.get("timeline");var h=moment(d.get("startDate"));var c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?h.date(15):h.isoWeekday(4);g.add(new Roadmap.Marker({markerDate:c.toDate()}))},onTimelineOptionChange:function(d){var c=this.model.get("timeline");c.set({displayOption:this.$timelineSelect.val()})},_initVariables:function(){this.$timelineForm=this.$el.find("#timeline-options-form");this.$startDateInput=this.$timelineForm.find("#timeline-startdate-input");this.$endDateInput=this.$timelineForm.find("#timeline-enddate-input");this.$timelineSelect=this.$timelineForm.find("#timeline-display-options-select");this.$timelineError=this.$timelineForm.find("#roadmap-timeline-error");this.newTimeline=new Roadmap.Timeline()},_clearTimelineErrors:function(){this.$timelineError.empty()},_showTimelineErrors:function(){var c=this;a.each(c.newTimeline.validationError,function(d){c.$timelineError.append(d.message)})},_applyNewTimeline:function(){var c=this.model.get("timeline");var e=Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val());var d=Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val());c.set({startDate:e.toDate(),endDate:d.toDate()});this._showTimeLineFormat()},_showTimeLineFormat:function(){var c=this.model.get("timeline");this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("startDate"),Roadmap.SHORT_DATE_FORMAT));this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("endDate"),Roadmap.SHORT_DATE_FORMAT))},_validate:function(){this._clearTimelineErrors();if(this.newTimeline.isValid()){this._applyNewTimeline()}else{this._showTimelineErrors()}},_setupTimelineOptionsForm:function(){var e=this.model.get("timeline");var g=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("startDate"),Roadmap.SHORT_DATE_FORMAT),c=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("endDate"),Roadmap.SHORT_DATE_FORMAT);this.$startDateInput.val(g);this.$endDateInput.val(c);this.newTimeline.set({startDateString:g,endDateString:c});this.$timelineSelect.val(e.get("displayOption"));var f={overrideBrowserDefault:true,firstDay:1};this.$startDateInput.datePicker(f);this.$endDateInput.datePicker(f);Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);var d=this;this.$startDateInput.on("change",function(){d.newTimeline.set({startDateString:d.$startDateInput.val()});d._validate()});this.$endDateInput.on("change",function(){d.newTimeline.set({endDateString:d.$endDateInput.val()});d._validate()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_ignored) {
  var output = '';
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output += '<div class="roadmap-column-title">' + ((displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '') + soy.$$escapeHtml(displayTimelineData3.month) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timeline.soyTemplateName = 'Confluence.Templates.Roadmap.timeline';
}


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_ignored) {
  var output = '';
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output += '<div class="roadmap-column-item">&nbsp;</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineColumn.soyTemplateName = 'Confluence.Templates.Roadmap.timelineColumn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};var c={};c.Helper=Confluence.Roadmap.Helper;Roadmap.TimelineView=Backbone.View.extend({className:"roadmap-frame-title",initialize:function(){a.bindAll(this,"render")},render:function(){this.model.calculateTimelineColumns();this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines:this.model.get("displayTimelineColumns")}));return this},update:function(){this.render()},getBarPosition:function(d){if(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){return{left:c.Helper.getPosXOnMonthTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}}return{left:c.Helper.getPosXOnWeekTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}},getBarDuration:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?(d/Roadmap.MONTH_WIDTH):(d/Roadmap.WEEK_WIDTH)},getBarStartDate:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?c.Helper.getMonthStartDateByPosition(this.model.attributes,d):c.Helper.getWeekStartDateByPosition(this.model.attributes,d)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.TimelineColumnView=Backbone.View.extend({className:"roadmap-frame-content",initialize:function(){a.bindAll(this,"render")},render:function(){var c=this.model.get("displayTimelineColumns").length;this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns:c}));return this},updateHeight:function(c){this.$el.height(c)},update:function(){this.render()},getSizeAndPosition:function(){return{width:this.$el.width(),height:this.$el.height(),left:this.$el.position().left,top:this.$el.position().top}}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources', location = 'view/dialog-view.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.InlineDialogView=Backbone.View.extend({initialize:function(c){a.bindAll(this,"_onDocumentClick","_onKeyDown","_shouldHide","_onHide");this._trigger=c.trigger;this._dialogOptions=c.dialogOptions;this._reset();var d=this;b(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){d.hide()})},_shouldHideWhenClick:function(c){return !b.contains(this._inlineDialog[0],c.target)},_createInlineDialog:function(d,f){var e,g=this;function h(l,k,j){g._getContent(l);j()}function c(){g._onBeforeShow();a.delay(function(){AJS.InlineDialog.current=null;g._onShow();b(document).on({click:g._onDocumentClick,keydown:g._onKeyDown})},g._inlineDialog.getOptions().fadeTime)}var i={hideCallback:this._onHide,initCallback:c,noBind:true,persistent:true,preHideCallback:this._shouldHide};if(f&&f.isSideInlineDialog){a.extend(i,{calculatePositions:a.compose(this._calculateSidePositions,this._getSideDimensions),offsetX:8,offsetY:0});if(Raphael.version){a.extend(i,{getArrowPath:this._getSideArrowPath})}}e=new AJS.InlineDialog(d,"roadmap-dialog",h,a.extend({},i,f));return e},_onHide:function(){b(document).off({click:this._onDocumentClick,keydown:this._onKeyDown})},hide:function(){this._inlineDialog.remove()},_onDocumentClick:function(c){this._shouldHideWhenClick(c)&&this.hide()},_onBeforeShow:b.noop,_onKeyDown:function(f){var c=f.which===b.ui.keyCode.ESCAPE,d=b(f.target).is(":input");if(c&&!d){this.hide()}},_onShow:b.noop,_reset:function(){this._inlineDialog=this._createInlineDialog(this._trigger,this._dialogOptions);this.setElement(this._inlineDialog)},_shouldHide:function(){return true},show:function(){this._inlineDialog.show()},disable:function(){this.$el.find(":input").attr("disabled","disabled")},enable:function(){this.$el.find(":input").removeAttr("disabled")},_onSubmit:function(){throw new Error("DialogView subclasses must implement _onSubmit().")},_getSideDimensions:function(e,i,p,c){var k=c.container.toLowerCase()!=="body";var d=AJS.$(c.container);var l=k?AJS.$(c.container).parent():AJS.$(window);var n=k?d.offset():{left:0,top:0};var j=k?l.offset():{left:0,top:0};var g=i.target;var q=g.offset();var m=g[0].getBoundingClientRect&&g[0].getBoundingClientRect();var f=m?m.width:g.outerWidth();if(c.timelineWidth){var h=g.position();if(h.left+f>c.timelineWidth){f=c.timelineWidth-h.left-1}}var o={screenPadding:10,arrowMargin:5,window:{top:j.top,left:j.left,scrollTop:l.scrollTop(),scrollLeft:l.scrollLeft(),width:l.width(),height:l.height()},scrollContainer:{width:d.width(),height:d.height()},trigger:{top:q.top-n.top,left:q.left-n.left,width:f,height:m?m.height:g.outerHeight()},dialog:{width:e.width(),height:e.height(),offset:{top:c.offsetY,left:c.offsetX}},arrow:{height:e.find(".arrow").outerHeight()}};return o},_calculateSidePositions:function(i){var g=i.screenPadding;var h=i.window;var o=i.trigger;var y=i.dialog;var f=i.arrow;var s=i.scrollContainer;var A={top:o.top-h.scrollTop,left:o.left-h.scrollLeft};var t=Math.floor(o.height/2);var q=Math.floor(y.height/2);var p=Math.floor(f.height/2);var x=A.left-y.offset.left-g;var B=s.width-A.left-o.width-y.offset.left-g;var u=x>=y.width;var e=B>=y.width;var w=!e&&u?"left":"right";var k=A.top+t-p;var m=h.height-k-f.height;g=Math.min(g,k-i.arrowMargin);g=Math.min(g,m-i.arrowMargin);var l=Math.max(A.top-g,0);var c=Math.max(h.height-A.top-o.height-g,0);var d=Math.max(q-t-y.offset.top-l,0);var v=Math.max(q-t+y.offset.top-c,0);var j=d||-v||0;var r={top:o.top+t-q+y.offset.top+j,left:w==="right"?o.left+o.width+y.offset.left:o.left-y.width-y.offset.left};var z="w";var n={position:"absolute",top:q-p-j};if(w==="right"){n.right="auto";n.left=Raphael.version?"-7px":"0px"}else{n.right="-7px";n.left="auto";z="e"}return{dialogLocation:w,popupCss:r,arrowCss:n,gravity:z}},_getSideArrowPath:function(c){return c.dialogLocation==="right"?"M8,0L0,8,8,16":"M8,0L16,8,8,16"},refresh:function(){this._inlineDialog&&this._inlineDialog.refresh()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog-templates.soy' */
// This file was automatically generated from bar-dialog-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.barDialog = function(opt_data, opt_ignored) {
  var output = '';
  var hasPageLink__soy3 = opt_data.bar.pageLink != null && opt_data.bar.pageLink.id != null;
  output += '<h3 id="bar-title" class="editable-field">' + soy.$$escapeHtml(opt_data.bar.title) + '</h3><div class="information"><div class="bar-page-link-wrapper">' + ((opt_data.linkPageEditable) ? '<div class="link-update-page ' + ((hasPageLink__soy3) ? 'hidden-field' : '') + '"><a href="#">' + soy.$$escapeHtml('Link page') + '</a></div>' : '') + '<div class="bar-page-link editable-field ' + ((! hasPageLink__soy3) ? 'hidden-field' : '') + '">' + ((hasPageLink__soy3) ? Confluence.Templates.Roadmap.buildPageLink({pageLink: opt_data.bar.pageLink, isEditMode: opt_data.renderOption.isEditMode}) : '') + '</div>' + ((opt_data.linkPageEditable) ? '<div class="link-new-page' + ((hasPageLink__soy3) ? ' hidden-field' : '') + '"><span class=\'page-link-separator\'>\u2022</span><a href="#">' + soy.$$escapeHtml('Create page') + '</a></div>' : '') + '</div><div class="clear"></div><div class="bar-description editable-field">' + soy.$$filterNoAutoescape(opt_data.bar.description) + '</div></div>' + ((opt_data.renderOption.isEditMode) ? '<div class="inner">' + aui.buttons.button({id: 'delete-button', text: 'Delete bar', type: 'link'}) + '</div>' : '');
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.barDialog.soyTemplateName = 'Confluence.Templates.Roadmap.barDialog';
}


Confluence.Templates.Roadmap.buildPageLink = function(opt_data, opt_ignored) {
  return '<a href=' + soy.$$escapeHtml("") + '/pages/viewpage.action?pageId=' + soy.$$escapeHtml(opt_data.pageLink.id) + ' ' + ((opt_data.isEditMode) ? 'target=\'_blank\'' : '') + ' class=\'confluence-link content-type-' + soy.$$escapeHtml(opt_data.pageLink.type) + '\'><span class="link-page-title">' + soy.$$escapeHtml(opt_data.pageLink.title) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.buildPageLink.soyTemplateName = 'Confluence.Templates.Roadmap.buildPageLink';
}


Confluence.Templates.Roadmap.inlineEditSaveButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-save', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Save'}, iconClass: 'aui-icon-small aui-iconfont-success'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditSaveButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditSaveButton';
}


Confluence.Templates.Roadmap.inlineEditCancelButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-cancel', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Cancel'}, iconClass: 'aui-icon-small aui-iconfont-close-dialog'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditCancelButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditCancelButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/roadmap-editinplace.js' */
(function(g){g.fn.editInPlace=function(h){var i=g.extend({},g.fn.editInPlace.defaults,h);d(i);e(i.saving_image);return this.each(function(){var j=g(this);if(j.data("editInPlace")){return}j.data("editInPlace",true);new f(i,j).init()})};g.fn.editInPlace.defaults={url:"",bg_over:"#ffc",bg_out:"transparent",hover_class:"",form_extra_classes:[],show_buttons:false,save_button:'<button class="inplace_save">Save</button>',cancel_button:'<button class="inplace_cancel">Cancel</button>',params:"",field_type:"text",field_extra_classes:[],default_text:"(Click here to add text)",use_html:false,textarea_rows:10,textarea_cols:25,select_text:"Choose new value",select_options:"",text_size:null,saving_text:undefined,saving_image:"",saving_animation_color:"transparent",value_required:false,disable_submit_when_empty:false,element_id:"element_id",update_value:"update_value",original_value:"original_value",original_html:"original_html",save_if_nothing_changed:false,on_blur:"save",cancel:"",callback:null,callback_skip_dom_reset:false,success:null,error:null,error_sink:function(h,i){alert(i)},preinit:null,postclose:null,delegate:null,isAutoCompleteField:false};var c={shouldOpenEditInPlace:function(j,i,h){},willOpenEditInPlace:function(i,h){},didOpenEditInPlace:function(i,h){},shouldCloseEditInPlace:function(j,i,h){},willCloseEditInPlace:function(i,h){},didCloseEditInPlace:function(i,h){},missingCommaErrorPreventer:""};function f(h,i){this.settings=h;this.dom=i;this.originalValue=null;this.didInsertDefaultText=false;this.shouldDelayReinit=false}g.extend(f.prototype,{init:function(){this.setDefaultTextIfNeccessary();this.connectOpeningEvents()},reinit:function(){if(this.shouldDelayReinit){return}this.triggerCallback(this.settings.postclose,this.dom);this.triggerDelegateCall("didCloseEditInPlace");this.markEditorAsInactive();this.connectOpeningEvents()},setDefaultTextIfNeccessary:function(){if(""!==this.dom.html()){return}this.dom.html(this.settings.default_text);this.didInsertDefaultText=true},connectOpeningEvents:function(){var h=this;this.dom.bind("mouseenter.editInPlace",function(){h.addHoverEffect()}).bind("mouseleave.editInPlace",function(){h.removeHoverEffect()}).bind("click.editInPlace",function(i){h.openEditor(i)})},disconnectOpeningEvents:function(){this.dom.unbind(".editInPlace")},addHoverEffect:function(){if(this.settings.hover_class){this.dom.addClass(this.settings.hover_class)}else{this.dom.css("background-color",this.settings.bg_over)}},removeHoverEffect:function(){if(this.settings.hover_class){this.dom.removeClass(this.settings.hover_class)}else{this.dom.css("background-color",this.settings.bg_out)}},openEditor:function(h){if(!this.shouldOpenEditor(h)){return}this.disconnectOpeningEvents();this.removeHoverEffect();this.removeInsertedDefaultTextIfNeccessary();this.saveOriginalValue();this.markEditorAsActive();this.replaceContentWithEditor();this.setInitialValue();this.workAroundMissingBlurBug();this.connectClosingEventsToEditor();this.triggerDelegateCall("didOpenEditInPlace")},shouldOpenEditor:function(h){if(this.isClickedObjectCancelled(h.target)){return false}if(false===this.triggerCallback(this.settings.preinit,this.dom)){return false}if(false===this.triggerDelegateCall("shouldOpenEditInPlace",true,h)){return false}if(this.settings.isAutoCompleteField&&g(h.target).hasClass("link-page-title")){return false}return true},removeInsertedDefaultTextIfNeccessary:function(){if(!this.didInsertDefaultText||this.dom.html()!==this.settings.default_text){return}this.dom.html("");this.didInsertDefaultText=false},isClickedObjectCancelled:function(j){if(!this.settings.cancel){return false}var h=g(j).parents().andSelf();var i=h.filter(this.settings.cancel);return 0!==i.length},saveOriginalValue:function(){if(this.settings.use_html){this.originalValue=this.dom.html()}else{this.originalValue=a(this.dom.text())}},restoreOriginalValue:function(){this.setClosedEditorContent(this.originalValue)},setClosedEditorContent:function(h){h=h||this.settings.default_text;if(this.settings.use_html){this.dom.html(h)}else{this.dom.text(h)}},workAroundMissingBlurBug:function(){var h=this.dom.find(":input");this.dom.parents(":last").find(".editInPlace-active :input").not(h).blur()},replaceContentWithEditor:function(){var m=this.createEditorElement();var h="inplace_form";if(this.settings.form_extra_classes instanceof Array){h=h+" "+this.settings.form_extra_classes.join(" ")}this.dom.html('<form class="'+h+'" style="display: inline; margin: 0; padding: 0;"></form>');var j=this.dom.find("form");j.append(m);if(this.settings.show_buttons){var i=g('<div class="inline-edit-buttons"></div>');var k=g(this.settings.save_button);k.addClass("inplace_save");i.append(k);var l=g(this.settings.cancel_button);l.addClass("inplace_cancel");i.append(l);j.append(i)}},createEditorElement:function(){if(-1===g.inArray(this.settings.field_type,["text","textarea","select"])){throw"Unknown field_type <fnord>, supported are 'text', 'textarea' and 'select'"}var h=null;if("select"===this.settings.field_type){h=this.createSelectEditor()}else{if("text"===this.settings.field_type){h=g('<input type="text" '+this.inputNameAndClass()+' size="'+this.settings.text_size+'" />')}else{if("textarea"===this.settings.field_type){h=g("<textarea "+this.inputNameAndClass()+' rows="'+this.settings.textarea_rows+'"  cols="'+this.settings.textarea_cols+'" />')}}}return h},setInitialValue:function(){var h=this.triggerDelegateCall("willOpenEditInPlace",this.originalValue);var i=this.dom.find(":input");i.val(h);if(i.val()!==h){i.val("")}},inputNameAndClass:function(){var h="inplace_field";if(this.settings.field_extra_classes instanceof Array){h=h+" "+this.settings.field_extra_classes.join(" ")}return' name="inplace_value" class="'+h+'"'},createSelectEditor:function(){var m=g("<select"+this.inputNameAndClass()+'><option disabled="true" value="">'+this.settings.select_text+"</option></select>");var j=this.settings.select_options;if(!g.isArray(j)){j=j.split(",")}for(var k=0;k<j.length;k++){var h=j[k];if(!g.isArray(h)){h=h.split(":")}var n=a(h[1]||h[0]);var o=a(h[0]);var l=g("<option>").val(n).text(o);m.append(l)}return m},connectClosingEventsToEditor:function(){var k=this;function j(l){if(!k.settings.isAutoCompleteField){k.handleCancelEditor(l)}return false}function h(l){k.handleSaveEditor(l);return false}var i=this.dom.find("form");i.find(".inplace_field").focus().select();i.find(".inplace_cancel").click(j);i.find(".inplace_save").click(h);if(!this.settings.show_buttons){if("save"===this.settings.on_blur){i.find(".inplace_field").blur(h)}else{i.find(".inplace_field").blur(j)}}i.keyup(function(l){var m=27;if(m===l.which){return j()}});this.bindInputKeyup();i.submit(h)},bindSubmitOnEnterInInput:function(){if("textarea"===this.settings.field_type){return}var h=this;this.dom.find(":input").keyup(function(i){var j=13;if(j===i.which){return h.dom.find("form").submit()}})},bindInputKeyup:function(){if("textarea"===this.settings.field_type){return}var i=this;var h=this.dom.find(":input");var j=this.dom.find(".inplace_save");h.keyup(function(k){var l=13;if(l===k.which){return i.dom.find("form").submit()}else{if(i.settings.disable_submit_when_empty){if(g.trim(h.val()).length){j.removeAttr("disabled")}else{j.attr("disabled","disabled")}}}})},handleCancelEditor:function(h){if(false===this.triggerDelegateCall("shouldCloseEditInPlace",true,h)){return}var i=this.dom.find(":input").val();i=this.triggerDelegateCall("willCloseEditInPlace",i);this.restoreOriginalValue();this.reinit()},handleSaveEditor:function(h){if(false===this.triggerDelegateCall("shouldCloseEditInPlace",true,h)){return}var i=g.trim(this.dom.find(":input").val());i=this.triggerDelegateCall("willCloseEditInPlace",i);if(this.isDisabledDefaultSelectChoice()||this.isUnchangedInput(i)){this.handleCancelEditor(h);return}if(this.didForgetRequiredText(i)){if(this.settings.disable_submit_when_empty){return}this.handleCancelEditor(h);this.reportError("Error: You must enter a value to save this field");return}this.showSaving(i);if(this.settings.callback){this.handleSubmitToCallback(i)}else{this.handleSubmitToServer(i)}},didForgetRequiredText:function(h){return this.settings.value_required&&(""===h||undefined===h||null===h)},isDisabledDefaultSelectChoice:function(){return this.dom.find("option").eq(0).is(":selected:disabled")},isUnchangedInput:function(h){return !this.settings.save_if_nothing_changed&&this.originalValue===h},showSaving:function(i){if(this.settings.callback&&this.settings.callback_skip_dom_reset){return}var h=i;if(b(this.settings.saving_text)){h=this.settings.saving_text}if(b(this.settings.saving_image)){h=g("<img />").attr("src",this.settings.saving_image).attr("alt",h)}this.dom.html(encodeURIComponent(h))},handleSubmitToCallback:function(h){this.enableOrDisableAnimationCallbacks(true,false);var i=this.triggerCallback(this.settings.callback,this.id(),h,this.originalValue,this.settings.params,this.savingAnimationCallbacks());if(this.settings.callback_skip_dom_reset){}else{if(undefined===i){this.reportError("Error: Failed to save value: "+h);this.restoreOriginalValue()}else{this.dom.html(i)}}if(this.didCallNoCallbacks()){this.enableOrDisableAnimationCallbacks(false,false);this.reinit()}},handleSubmitToServer:function(h){var j=this.settings.update_value+"="+encodeURIComponent(h)+"&"+this.settings.element_id+"="+this.dom.attr("id")+((this.settings.params)?"&"+this.settings.params:"")+"&"+this.settings.original_html+"="+encodeURIComponent(this.originalValue)+"&"+this.settings.original_value+"="+encodeURIComponent(this.originalValue);this.enableOrDisableAnimationCallbacks(true,false);this.didStartSaving();var i=this;g.ajax({url:i.settings.url,type:"POST",data:j,dataType:"html",complete:function(k){i.didEndSaving()},success:function(l){var k=l||i.settings.default_text;i.dom.html(k);i.triggerCallback(i.settings.success,l)},error:function(k){i.dom.html(i.originalHTML);if(i.settings.error){i.triggerCallback(i.settings.error,k)}else{i.reportError("Failed to save value: "+k.responseText||"Unspecified Error")}}})},triggerCallback:function(i){if(!i){return}var h=Array.prototype.slice.call(arguments,1);return i.apply(this.dom[0],h)},triggerDelegateCall:function(j,i,h){if(!this.settings.delegate||!g.isFunction(this.settings.delegate[j])){return i}var k=this.settings.delegate[j](this.dom,this.settings,h);return(undefined===k)?i:k},reportError:function(h){this.triggerCallback(this.settings.error_sink,this.id(),h)},id:function(){return this.dom.attr("id")},markEditorAsActive:function(){this.dom.addClass("editInPlace-active")},markEditorAsInactive:function(){this.dom.removeClass("editInPlace-active")},savingAnimationCallbacks:function(){var h=this;return{didStartSaving:function(){h.didStartSaving()},didEndSaving:function(){h.didEndSaving()}}},enableOrDisableAnimationCallbacks:function(i,h){this.didStartSaving.enabled=i;this.didEndSaving.enabled=h},didCallNoCallbacks:function(){return this.didStartSaving.enabled&&!this.didEndSaving.enabled},assertCanCall:function(h){if(!this[h].enabled){throw new Error("Cannot call "+h+" now. See documentation for details.")}},didStartSaving:function(){this.assertCanCall("didStartSaving");this.shouldDelayReinit=true;this.enableOrDisableAnimationCallbacks(false,true);this.startSavingAnimation()},didEndSaving:function(){this.assertCanCall("didEndSaving");this.shouldDelayReinit=false;this.enableOrDisableAnimationCallbacks(false,false);this.reinit();this.stopSavingAnimation()},startSavingAnimation:function(){var h=this;this.dom.animate({backgroundColor:this.settings.saving_animation_color},400).animate({backgroundColor:"transparent"},400,"swing",function(){setTimeout(function(){h.startSavingAnimation()},10)})},stopSavingAnimation:function(){this.dom.stop(true).css({backgroundColor:""})},missingCommaErrorPreventer:""});function d(h){if(h.url||h.callback){return}throw new Error("Need to set either url: or callback: option for the inline editor to work.")}function e(i){if(""===i){return}var h=new Image();h.src=i}function a(h){return h.replace(/^\s+/,"").replace(/\s+$/,"")}function b(h){if(undefined===h||null===h){return false}if(0===h.length){return false}return true}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.BarDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click .link-new-page":"_goToCreateLinkPage","click .link-update-page":"_goToUpdateLinkPage"},initialize:function(){a.bindAll(this,"_onPageLinkOpen","_onPageLinkSelectCompleted","_onPageLinkCallback","_onPageLinkBlur","_goToCreateLinkPage");this.options.dialogOptions={width:260,timelineWidth:this.options.timelineWidth,isSideInlineDialog:true,renderOption:this.options.renderOption,linkPageEditable:this.options.linkPageEditable,createLinkPageCallback:this.options.createLinkPageCallback};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.barDialog({bar:a.extend({},this.model.attributes,{description:AJS.escapeHtml(this.model.attributes.description).replace(/\r?\n/g,"<br />")}),renderOption:this.options.dialogOptions.renderOption,linkPageEditable:this.options.dialogOptions.linkPageEditable}))},_onBeforeShow:function(){this.fields=this._getFields();this._setupInlineEdit()},_getFields:function(){return{$title:this.$el.find("#bar-title"),$description:this.$el.find(".bar-description"),$pageLink:this.$el.find(".bar-page-link"),$pageLinkNew:this.$el.find(".link-new-page"),$pageLinkUpdate:this.$el.find(".link-update-page")}},_setupInlineEdit:function(){var f=this;var d=this.fields;var i=this.options.dialogOptions.renderOption.editInplace;var e={form_extra_classes:["aui"],hover_class:"editable-field-hover aui-icon-small aui-iconfont-edit",field_extra_classes:["text"],show_buttons:true,save_button:Confluence.Templates.Roadmap.inlineEditSaveButton(),cancel_button:Confluence.Templates.Roadmap.inlineEditCancelButton(),error_sink:null,use_html:true,default_text:"Click to add description.",delegate:{shouldOpenEditInPlace:function(){f.$el.find(".inplace_cancel").trigger("click")},didCloseEditInPlace:function(){setTimeout(function(){f.refresh()},0)}}};i.title&&d.$title.editInPlace(c.extend(true,{},e,{callback:function(j,k){f.options.updateTitle(k);return AJS.escapeHtml(k)},value_required:true,disable_submit_when_empty:true,delegate:{willOpenEditInPlace:function(){f.refresh();d.$title.find(".text").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_TITLE)}}}));(c.trim(d.$description.text())==="")?d.$description.addClass("empty-field"):d.$description.removeClass("empty-field");var g=c.extend(true,{},e,{field_type:"textarea",field_extra_classes:["textarea"],value_required:false,save_if_nothing_changed:true,callback:function(j,k){k=c.trim(k);f.options.updateDescription(k);if(k===""){k="Click to add description.";c(this).addClass("empty-field")}else{c(this).removeClass("empty-field");Confluence.Roadmap.Analytics.addDescription()}return AJS.escapeHtml(k).replace(/\r?\n/g,"<br />")},delegate:{willOpenEditInPlace:function(){f.refresh();d.$description.find(".textarea").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);return f.model.attributes.description.replace(/<br\s*[\/]?>/gi,"\n")}}});i.description&&d.$description.editInPlace(g);var h=c.extend(true,{},e,{isAutoCompleteField:true,show_buttons:false,default_text:"",field_extra_classes:["text","autocomplete-confluence-content"],delegate:{willOpenEditInPlace:f._onPageLinkOpen,didCloseEditInPlace:function(){if(a.isEmpty(d.$pageLink.data("linkData"))){d.$pageLink.hide();d.$pageLinkNew.show();d.$pageLinkUpdate.show()}}},on_blur:null,callback:f._onPageLinkCallback});i.pageLink&&this.options.dialogOptions.linkPageEditable&&this.fields.$pageLink.editInPlace(h)},_onPageLinkOpen:function(e){var f=this;e.append('<div class="link-page-dropdown" />');var g=e.find(".autocomplete-confluence-content");g.attr({placeholder:"Search page","data-dropdown-target":"#inline-dialog-roadmap-dialog .link-page-dropdown","data-none-message":"No matches found"});Confluence.Binder.autocompleteConfluenceContent(e);g.bind("selected.autocomplete-content",this._onPageLinkSelectCompleted);g.on("blur",function(){setTimeout(f._onPageLinkBlur,150)});var d=this.model.attributes.pageLink;this.fields.$pageLink.data("linkData",d);if(!a.isEmpty(d)){return d.title}return true},_onPageLinkSelectCompleted:function(d,g){d.stopPropagation();var f=this.fields.$pageLink.find(".autocomplete-confluence-content");var e=g.content;f.val(e.title);this.fields.$pageLink.data("linkData",g.content);a.defer(this._onPageLinkBlur)},_onPageLinkBlur:function(){var d=this.fields.$pageLink.find(".autocomplete-confluence-content");var f=c.Event("keyup");f.which=AJS.keyCode.ENTER;d.trigger(f)},_onPageLinkCallback:function(e,f){var d=(f==="")?{}:this.fields.$pageLink.data("linkData");return this._updatePageLink(d)},_updatePageLink:function(e){if(e.id===this.model.attributes.pageLink.id){return}var d=this.fields;if(a.isEmpty(e)){this.options.updatePageLink({});d.$pageLink.hide();d.$pageLinkNew.show();d.$pageLinkUpdate.show();return "No linked page"}else{var f=a.pick(e,"id","title","type","spaceKey","wikiLink");if(!e.spaceKey){f.spaceKey=e.space.key}this.options.updatePageLink(f);d.$pageLink.show();d.$pageLinkNew.hide();d.$pageLinkUpdate.hide();if(this.options.renderOption.isEditMode){Confluence.Roadmap.Analytics.addPageLinkEditMode({linkedPageId:e.id,pageId:AJS.Meta.get("page-id")>0?AJS.Meta.get("page-id"):AJS.Meta.get("draft-id"),isDraft:AJS.Meta.get("page-id")<=0})}else{Confluence.Roadmap.Analytics.addPageLinkViewMode({linkedPageId:e.id,pageId:AJS.Meta.get("page-id")})}return Confluence.Templates.Roadmap.buildPageLink({pageLink:e,isEditMode:this.options.renderOption.isEditMode})}},_onDeleteClick:function(){this.options.deleteBar();this.remove()},_goToCreateLinkPage:function(f){var e=this.options.dialogOptions;if(e.createLinkPageCallback){var d=a.bind(e.createLinkPageCallback,{me:this},f);d()}},_goToUpdateLinkPage:function(d){d.preventDefault();this.fields.$pageLink.show();this.fields.$pageLinkNew.hide();this.fields.$pageLinkUpdate.hide();this.fields.$pageLink.click()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-link-new-page.js' */
Confluence.RoadmapLink=(function(f,a){Roadmap.trackingBars=[];function c(j,k){var g={};if(parseInt(j.pageId)<=0){j.parentPageId=AJS.Meta.get("parent-page-id")}var h=f.param(j);var i=window.open(AJS.contextPath()+"/plugins/roadmap/create-page.action?"+h,"_blank");i.opener=null;b(j.roadmapBarId).done(function(l){Roadmap.trackingBars.push(j.roadmapBarId)});f(window).off("focus");f(window).on("focus",function(){if(!Roadmap.trackingBars.length){f(window).off("focus")}a.each(Roadmap.trackingBars,function(l){d(l).done(function(n){var m=n.status;if(m=="REDEEM"){e(l);k({barId:l,pageLink:f.parseJSON(n.pageLink)})}else{if(m=="UNKNOWN"){e(l)}}})})})}function e(g){Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(g),1)}function b(g){return f.ajax({contentType:"application/json",type:"PUT",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+g+"/PENDING"})}function d(g){return f.ajax({contentType:"application/json",type:"GET",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+g+"/status"})}return{addCreateLinkPageListener:c}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--825acd7236', location = 'aui.chunk.fc732d2f4ae07aa911a9--c1d71ea3b4c6752064f2.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--825acd7236"],{PTCr:function(e,t,i){var s,o,n;
/*!
 * jQuery UI Droppable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */o=[i("oDIA"),i("z+ct"),i("XPYc"),i("O+lX"),i("yIBB")],void 0===(n="function"==typeof(s=function(e){e.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(i)))},_drop:function(i,s){var o=s||e.ui.ddmanager.current,n=!1;return!(!o||(o.currentItem||o.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var s=e(this).droppable("instance");if(s.options.greedy&&!s.options.disabled&&s.options.scope===o.options.scope&&s.accept.call(s.element[0],o.currentItem||o.element)&&t(o,e.extend(s,{offset:s.element.offset()}),s.options.tolerance,i))return n=!0,!1})),!n&&!!this.accept.call(this.element[0],o.currentItem||o.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",i,this.ui(o)),this.element))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var t=e.ui.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,s,o){if(!i.offset)return!1;var n=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,a=n+t.helperProportions.width,l=r+t.helperProportions.height,p=i.offset.left,c=i.offset.top,d=p+i.proportions().width,h=c+i.proportions().height;switch(s){case"fit":return p<=n&&a<=d&&c<=r&&l<=h;case"intersect":return p<n+t.helperProportions.width/2&&a-t.helperProportions.width/2<d&&c<r+t.helperProportions.height/2&&l-t.helperProportions.height/2<h;case"pointer":return e(o.pageY,c,i.proportions().height)&&e(o.pageX,p,i.proportions().width);case"touch":return(r>=c&&r<=h||l>=c&&l<=h||r<c&&l>h)&&(n>=p&&n<=d||a>=p&&a<=d||n<p&&a>d);default:return!1}}}();return e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var s,o,n=e.ui.ddmanager.droppables[t.options.scope]||[],r=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;s<n.length;s++)if(!(n[s].options.disabled||t&&!n[s].accept.call(n[s].element[0],t.currentItem||t.element))){for(o=0;o<a.length;o++)if(a[o]===n[s].element[0]){n[s].proportions().height=0;continue e}n[s].visible="none"!==n[s].element.css("display"),n[s].visible&&("mousedown"===r&&n[s]._activate.call(n[s],i),n[s].offset=n[s].element.offset(),n[s].proportions({width:n[s].element[0].offsetWidth,height:n[s].element[0].offsetHeight}))}},drop:function(i,s){var o=!1;return e.each((e.ui.ddmanager.droppables[i.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&t(i,this,this.options.tolerance,s)&&(o=this._drop.call(this,s)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,s)))})),o},dragStart:function(t,i){t.element.parentsUntil("body").on("scroll.droppable",(function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}))},drag:function(i,s){i.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(i,s),e.each(e.ui.ddmanager.droppables[i.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var o,n,r,a=t(i,this,this.options.tolerance,s),l=!a&&this.isover?"isout":a&&!this.isover?"isover":null;l&&(this.options.greedy&&(n=this.options.scope,(r=this.element.parents(":data(ui-droppable)").filter((function(){return e(this).droppable("instance").options.scope===n}))).length&&((o=e(r[0]).droppable("instance")).greedyChild="isover"===l)),o&&"isover"===l&&(o.isover=!1,o.isout=!0,o._out.call(o,s)),this[l]=!0,this["isout"===l?"isover":"isout"]=!1,this["isover"===l?"_over":"_out"].call(this,s),o&&"isout"===l&&(o.isout=!1,o.isover=!0,o._over.call(o,s)))}}))},dragStop:function(t,i){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},!1!==e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),e.ui.droppable})?s.apply(t,o):s)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.droppable', location = 'aui.chunk.8214c015c6c7c75dde17--dadf7172b600f50e16fc.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.droppable"],{qe8r:function(u,i,n){"use strict";n.r(i);n("PTCr");i.default="jquery"}},[["qe8r","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--51504ebf10","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--351ae504d7","aui.splitchunk.vendors--06bc6ae5d7","aui.splitchunk.vendors--825acd7236","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--7c76061134', location = 'aui.chunk.c2836e51a0ee32304449--2c05e867cf130e8d8ebe.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--7c76061134"],{TRfs:function(e,t,s){"use strict";s.r(t)},iCCw:function(e,t,s){var l,i,n;
/*!
 * jQuery UI Selectable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */i=[s("oDIA"),s("XPYc"),s("O+lX"),s("yIBB")],void 0===(n="function"==typeof(l=function(e){return e.widget("ui.selectable",e.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t.elementPos=e(t.element[0]).offset(),t.selectees=e(t.options.filter,t.element[0]),t._addClass(t.selectees,"ui-selectee"),t.selectees.each((function(){var s=e(this),l=s.offset(),i={left:l.left-t.elementPos.left,top:l.top-t.elementPos.top};e.data(this,"selectable-item",{element:this,$element:s,left:i.left,top:i.top,right:i.left+s.outerWidth(),bottom:i.top+s.outerHeight(),startselected:!1,selected:s.hasClass("ui-selected"),selecting:s.hasClass("ui-selecting"),unselecting:s.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=e("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(t){var s=this,l=this.options;this.opos=[t.pageX,t.pageY],this.elementPos=e(this.element[0]).offset(),this.options.disabled||(this.selectees=e(l.filter,this.element[0]),this._trigger("start",t),e(l.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),l.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var l=e.data(this,"selectable-item");l.startselected=!0,t.metaKey||t.ctrlKey||(s._removeClass(l.$element,"ui-selected"),l.selected=!1,s._addClass(l.$element,"ui-unselecting"),l.unselecting=!0,s._trigger("unselecting",t,{unselecting:l.element}))})),e(t.target).parents().addBack().each((function(){var l,i=e.data(this,"selectable-item");if(i)return l=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),s._removeClass(i.$element,l?"ui-unselecting":"ui-selected")._addClass(i.$element,l?"ui-selecting":"ui-unselecting"),i.unselecting=!l,i.selecting=l,i.selected=l,l?s._trigger("selecting",t,{selecting:i.element}):s._trigger("unselecting",t,{unselecting:i.element}),!1})))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var s,l=this,i=this.options,n=this.opos[0],c=this.opos[1],a=t.pageX,o=t.pageY;return n>a&&(s=a,a=n,n=s),c>o&&(s=o,o=c,c=s),this.helper.css({left:n,top:c,width:a-n,height:o-c}),this.selectees.each((function(){var s=e.data(this,"selectable-item"),r=!1,u={};s&&s.element!==l.element[0]&&(u.left=s.left+l.elementPos.left,u.right=s.right+l.elementPos.left,u.top=s.top+l.elementPos.top,u.bottom=s.bottom+l.elementPos.top,"touch"===i.tolerance?r=!(u.left>a||u.right<n||u.top>o||u.bottom<c):"fit"===i.tolerance&&(r=u.left>n&&u.right<a&&u.top>c&&u.bottom<o),r?(s.selected&&(l._removeClass(s.$element,"ui-selected"),s.selected=!1),s.unselecting&&(l._removeClass(s.$element,"ui-unselecting"),s.unselecting=!1),s.selecting||(l._addClass(s.$element,"ui-selecting"),s.selecting=!0,l._trigger("selecting",t,{selecting:s.element}))):(s.selecting&&((t.metaKey||t.ctrlKey)&&s.startselected?(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,l._addClass(s.$element,"ui-selected"),s.selected=!0):(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,s.startselected&&(l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0),l._trigger("unselecting",t,{unselecting:s.element}))),s.selected&&(t.metaKey||t.ctrlKey||s.startselected||(l._removeClass(s.$element,"ui-selected"),s.selected=!1,l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0,l._trigger("unselecting",t,{unselecting:s.element})))))})),!1}},_mouseStop:function(t){var s=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each((function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-unselecting"),l.unselecting=!1,l.startselected=!1,s._trigger("unselected",t,{unselected:l.element})})),e(".ui-selecting",this.element[0]).each((function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-selecting")._addClass(l.$element,"ui-selected"),l.selecting=!1,l.selected=!0,l.startselected=!0,s._trigger("selected",t,{selected:l.element})})),this._trigger("stop",t),this.helper.remove(),!1}})})?l.apply(t,i):l)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.selectable', location = 'aui.chunk.e44f4e4256ae4032b5f4--d41b8c0fd130c843a8f9.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.selectable"],{FvNQ:function(u,i,n){"use strict";n.r(i);n("TRfs"),n("iCCw");i.default="jquery"}},[["FvNQ","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--7c76061134","aui.splitchunk.0d131bcbf1"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<div class="roadmap-editor-popup"><div id=\'' + soy.$$escapeHtml(opt_data.roadmapPopupPanelId) + '\'></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapPopupPanel';
}


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapEditor.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapEditor';
}


Confluence.Templates.Roadmap.lane = function(opt_data, opt_ignored) {
  return '<div class="roadmap-lane-title" style="background-color: ' + soy.$$escapeHtml(opt_data.color.lane) + '; color: ' + soy.$$escapeHtml(opt_data.color.text) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><div class="title-outer"><div class="title-inner">' + soy.$$escapeHtml(opt_data.title) + '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.lane.soyTemplateName = 'Confluence.Templates.Roadmap.lane';
}


Confluence.Templates.Roadmap.marker = function(opt_data, opt_ignored) {
  return '<div class="marker-drag-placeholder"></div><div class="marker-title-wrapper"><span class="marker-title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.marker.soyTemplateName = 'Confluence.Templates.Roadmap.marker';
}


Confluence.Templates.Roadmap.bar = function(opt_data, opt_ignored) {
  return '<p class="roadmap-bar-title">' + soy.$$escapeHtml(opt_data.title) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.bar.soyTemplateName = 'Confluence.Templates.Roadmap.bar';
}


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_ignored) {
  return '<hr class="new-row-line" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowLine.soyTemplateName = 'Confluence.Templates.Roadmap.newRowLine';
}


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Macro unavailable') + '</h1></header><div class="aui-dialog2-content">' + soy.$$filterNoAutoescape('\x3cp\x3eThe roadmap macro has been deprecated as of version 12. You can still view your existing roadmap macros but you will no longer be able to edit them or create new ones.\x3c/p\x3e\x3cp\x3ePlease use our new Roadmap Planner macro to plan your roadmap.\x3c/p\x3e') + '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Close') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.deprecationDialog.soyTemplateName = 'Confluence.Templates.Roadmap.deprecationDialog';
}


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_ignored) {
  return '<hr class= "new-row-placeholder" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowPlaceholder.soyTemplateName = 'Confluence.Templates.Roadmap.newRowPlaceholder';
}


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Add bar'}, iconClass: 'aui-icon-small aui-iconfont-add'}) + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename lane'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + Confluence.Templates.Roadmap.laneColorSelect(opt_data) + ((opt_data.canDelete) ? aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete lane'}, iconClass: 'aui-icon-small delete-icon'}) : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneDialog';
}


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename marker'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete marker'}, iconClass: 'aui-icon-small delete-icon'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerDialog';
}


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerRenameDialog';
}


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneRenameDialog';
}


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_ignored) {
  var output = '<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="' + soy.$$escapeHtml('Lane color') + '"><span class="color-item" style="background-color: ' + soy.$$escapeHtml(opt_data.laneColor) + ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">';
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output += '<li class="color-display-item"><a href="#" ><span class="color-item ' + ((colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '') + '" style="background-color: ' + soy.$$escapeHtml(colorData120.lane) + ';"></span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneColorSelect.soyTemplateName = 'Confluence.Templates.Roadmap.laneColorSelect';
}


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_ignored) {
  return '<span class="link-page-title"></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.linkPageTitle.soyTemplateName = 'Confluence.Templates.Roadmap.linkPageTitle';
}


Confluence.Templates.Roadmap.footerActionContent = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({text: 'Insert', id: 'roadmapInsertBtn'}) + aui.buttons.button({text: 'Cancel', type: 'link', id: 'roadmapCancelBtn'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.footerActionContent.soyTemplateName = 'Confluence.Templates.Roadmap.footerActionContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
(function(b,a){Roadmap.BarView=Backbone.View.extend({className:"roadmap-bar",events:{click:"_showDialog",dragstart:"_onDragstart",dragstop:"_onDragStop",dropover:"_onDropOver",dropout:"_onDropOut"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","_updateBar","_beforeResize","updateMaxWidth","_deleteBar","_updateTitle");this._addEvents()},_addEvents:function(){var c=this;this.$el.draggable({opacity:0.3,cursor:"move",appendTo:".roadmap-drag-area",snap:".roadmap-bar-row, .new-bar-row",snapMode:"inner",snapTolerance:17,scroll:true,zIndex:4020,helper:function(){return c.$el.clone().addClass("roadmap-bar-clone").data("View",c)}});this.$el.droppable({accept:".roadmap-bar",tolerance:"touch",hoverClass:"bar-hover-bar"});this.$el.data("View",this)},render:function(){this.updateColor(this.options.color);var c=this.options.timelineView.getBarPosition(this.model.attributes);this.$el.css({left:c.left+"px",width:c.width+"px"});this.$el.attr("title",this.model.get("title"));this.$el.append(Confluence.Templates.Roadmap.bar({title:this.model.get("title")}));this.$el.resizable({handles:"e, w",minWidth:Roadmap.barMinWidth,start:this._beforeResize,stop:this._updateBar});return this},updateMaxWidth:function(d){this.$el.resizable("option","maxWidth",d);var c=this.$el.resizable("option","minWidth");if(d<c){this.$el.resizable("option","minWidth",d)}},_beforeResize:function(d,c){this._barDialog&&this._barDialog.remove();this.trigger("beforeResize",this,this._checkHandleDirection(d))},_checkHandleDirection:function(c){var d=b(c.toElement?c.toElement:c.originalEvent.target);if(d.hasClass("ui-resizable-w")){return"left"}else{if(d.hasClass("ui-resizable-e")){return"right"}}throw"Unsupport resize direction handling = "+d},_updateBar:function(d,c){if(c.originalPosition.left!=c.position.left){this.model.set({startDate:this.options.timelineView.getBarStartDate(c.position.left),duration:this.options.timelineView.getBarDuration(c.element.outerWidth())})}else{if(c.originalSize.width!=c.size.width){this.model.set("duration",this.options.timelineView.getBarDuration(c.element.outerWidth()))}}},appendTo:function(c){this.$el.appendTo(c)},updateColor:function(c){this.$el.css({"background-color":c.bar,"border-color":c.lane,color:c.text})},updatePositionLeft:function(c){this.$el.css("left",c)},_onDragStop:function(d,c){this.options.lane.cleanLaneAfterDrop();this.$el.trigger("BarView.dragstop")},updateDeleteBar:function(c){this.options.deleteBar=c},_showDialog:function(c){if(!b(c.target).is(".ui-resizable-handle")){this._barDialog&&this._barDialog.remove();this._barDialog=this._createDialog();this._barDialog.show();Confluence.Roadmap.Analytics.openBarDialogInEdit()}},_createDialog:function(){return new Roadmap.BarDialogView({trigger:this.$el,model:this.model,timelineWidth:this.options.timelineView.$el.width(),renderOption:{isEditMode:true,editInplace:{title:true,pageLink:true,description:true}},linkPageEditable:true,deleteBar:this._deleteBar,updateTitle:this._updateTitle,updateDescription:this._updateDescription,updatePageLink:this._updatePageLink,createLinkPageCallback:this._goToCreateLinkPage})},_deleteBar:function(){this.options.deleteBar(this)},_updateTitle:function(c){this.model.set("title",c);this.$el.attr("title",c);this.$el.find(".roadmap-bar-title").html(AJS.escapeHtml(c))},_updateDescription:function(c){this.model.set("description",c)},_updatePageLink:function(c){this.model.set("pageLink",c)},_onDragstart:function(d,c){Roadmap.DragDrop.barDraggingOver={};this.$el.trigger("BarView.dragstart",[c])},_onDropOver:function(d,c){Roadmap.DragDrop.barDraggingOver[this.cid]=this.cid;if(Roadmap.DragDrop.barDraggingOver&&c.helper.data("isAddingNewRow")!==true){c.helper.addClass("roadmap-bar-overlapped")}},_onDropOut:function(f,d){var c=this;delete Roadmap.DragDrop.barDraggingOver[c.cid];d.helper.removeClass("roadmap-bar-overlapped");a.each(Roadmap.DragDrop.barDraggingOver,function(g){var e=d.helper.data("isAddingNewRow")!==true;if(e){if(typeof g==="string"){d.helper.addClass("roadmap-bar-overlapped")}else{if(g.className==="roadmap-bar-row"){g.$el.addClass("roadmap-bar-drag-hover")}}}})},_goToCreateLinkPage:function(f){f.preventDefault();var e=this.me;var c=parseInt(AJS.Meta.get("page-id"));var d=c>0?c:AJS.Meta.get("parent-page-id");var g={roadmapBarId:e.model.id,roadmapContentId:d,updateRoadmap:false};Confluence.RoadmapLink.addCreateLinkPageListener(g,function(i){var h=e._updatePageLink(i.pageLink);e.fields.$pageLink.html(h)})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function(b,a){Roadmap.BarRowView=Backbone.View.extend({className:"roadmap-bar-row",initialize:function(){a.bindAll(this,"_addEvents");this._addEvents();return this},attributes:function(){return{cid:this.cid}},_addEvents:function(){var c=this;this.$el.droppable({greedy:true,tolerance:"pointer",hoverClass:"roadmap-bar-drag-hover",activeClass:"roadmap-bar-drag-active",accept:".roadmap-bar",over:function(f,d){Roadmap.DragDrop.barDraggingOver[c.cid]=c;if(d.helper.data("isAddingNewRow")!==true){var g=b(this);g.closest(".roadmap-content").find(".new-row-placeholder").remove()}else{c.$el.removeClass("roadmap-bar-drag-hover")}},out:function(){var d=b(this);delete Roadmap.DragDrop.barDraggingOver[c.cid];d.closest(".roadmap-content").find(".new-row-placeholder").remove()},drop:function(g,f){var d=a.reject(Roadmap.DragDrop.barDraggingOver,function(e){return(typeof e==="object")}).length>0;if(!f.helper.hasClass("roadmap-bar-overlapped")&&!d){b(this).trigger("BarView.drop",[{$barViewHelper:f.helper,$barViewOriginal:f.draggable,$barRow:b(this)},f])}}})},isEmptyRow:function(){return this.$el.is(":empty")}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function(b,a){Roadmap.BarRowNewView=Backbone.View.extend({className:"new-bar-row",overlayTop:3,margin:5,events:{drop:"_onDrop",dropover:"_onDropOver",dropout:"_onDropOut"},initialize:function(){a.bindAll(this,"render","_addEvent");return this},render:function(){this.$el.append(Confluence.Templates.Roadmap.newRowLine());this._addEvent();this._setSizePosition();return this},_addEvent:function(){this.$el.droppable({accept:".roadmap-bar",tolerance:"pointer",hoverClass:"new-bar-row-hover"})},_setSizePosition:function(){var f=this.options.$barRow;var c=this.options.renderBottom===false?(this.margin*-1):f.height();var e=f.index()===0;var d=(e)?this.overlayTop+this.margin:this.overlayTop;this.$el.css({top:f.position().top+c-d,width:f.width()})},_onDrop:function(d,c){this.$el.trigger("BarView.drop",[{barRowNewView:this},c])},_onDropOver:function(d,c){this.$el.trigger("BarRowNew.dropover",[this,c])},_onDropOut:function(d,c){this.$el.trigger("BarRowNew.dropout",[this,c])}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.LaneDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click #rename-button":"_onRenameClick","click #add-bar-button":"_onAddBarClick"},initialize:function(){a.bindAll(this,"_onHide");this.options.dialogOptions={width:this._getDialogWidth(),hideCallback:this._onHide};c(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){c("#lane-color-picker").hide()});b.prototype.initialize.call(this,this.options)},_getContent:function(d){var g=this.options.lane.model.get("color").lane;d.html(Confluence.Templates.Roadmap.laneDialog({canDelete:this.options.canDelete,colors:Roadmap.COLORS,laneColor:g}));this.$el.find(".aui-button").tooltip({gravity:"s"});var e=this;var f=this.$el.find("#lane-color-picker .color-item");f.click(function(i){i.preventDefault();var h=Roadmap.COLORS[f.index(this)];if(h.lane!=g){e.options.changeColor(h)}c("#lane-color-picker").hide()})},_getDialogWidth:function(){var e=29;var f=51;var d=2;if(this.options.canDelete){d++}return d*e+f},_onDeleteClick:function(){this.options.deleteLane();this.remove()},_onRenameClick:function(){if(!this._laneRenameDialog){this._laneRenameDialog=new Roadmap.LaneRenameDialogView({trigger:this.options.trigger,lane:this.options.lane})}this._laneRenameDialog.show();this.hide()},_onAddBarClick:function(){this.options.addBar();this.remove()},_onHide:function(){c("#lane-color-picker").hide();b.prototype._onHide.call(this)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function(d,a){var b=require("confluence/form-state-control");var c=Roadmap.InlineDialogView;Roadmap.LaneRenameDialogView=c.extend({events:{"click .rename-button":"_onRenameButtonClick","keyup .lane-title":"_onChangeLaneTitle"},initialize:function(){this.options.dialogOptions={width:this._getDialogWidth()};c.prototype.initialize.call(this,this.options)},_getContent:function(e){e.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle:this.options.trigger.text()}));this.controls={$renameButton:this.$el.find(".rename-button"),$laneTitle:this.$el.find(".lane-title")}},_getDialogWidth:function(){return 315},_onChangeLaneTitle:function(f){var g=d.trim(this.controls.$laneTitle.val());if(!g){b.disableElement(this.controls.$renameButton)}else{b.enableElement(this.controls.$renameButton);if(f.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(f){this.controls.$laneTitle.select()},_onRenameButtonClick:function(e){e.preventDefault();this.hide();var f=this.controls.$laneTitle.val();this.options.lane.renameTitle(f)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.MarkerDialogView=b.extend({events:{"click #rename-button":"_onRenameButtonClick","click #delete-button":"_onDeleteButtonClick"},initialize:function(){this.options.dialogOptions={width:60};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.markerDialog());this.$el.find(".aui-button.aui-button-compact").tooltip({gravity:"s"})},_onRenameButtonClick:function(){if(!this._markerRenameDialog){this._markerRenameDialog=new Roadmap.MarkerRenameDialogView({trigger:this.options.trigger,marker:this.options.marker})}this._markerRenameDialog.show();this.hide()},_onDeleteButtonClick:function(){this.options.marker.removeMarker();this.hide()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function(d,a){var b=require("confluence/form-state-control");var c=Roadmap.InlineDialogView;Roadmap.MarkerRenameDialogView=c.extend({events:{"click .rename-button":"_onSaveButtonClick","keyup .marker-title":"_onChangeMarkerTitle"},initialize:function(){this.options.dialogOptions={width:315};c.prototype.initialize.call(this,this.options)},_getContent:function(e){e.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle:this.options.marker.model.get("title")}));this.controls={$renameButton:this.$el.find(".rename-button"),$title:this.$el.find(".marker-title")}},_onChangeMarkerTitle:function(f){var g=d.trim(this.controls.$title.val());if(!g){b.disableElement(this.controls.$renameButton)}else{b.enableElement(this.controls.$renameButton);if(f.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(f){this.controls.$title.select()},_onSaveButtonClick:function(f){f.preventDefault();this.hide();this.options.marker.renameTitle(this.controls.$title.val())}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.LaneView=Backbone.View.extend({tagName:"div",className:"roadmap-lane",events:{"click .roadmap-lane-title":"_showDialog","BarView.drop":"_onBarDropped","BarRowNew.dropover":"_onBarRowNewDropover","BarRowNew.dropout":"_onBarRowNewDropout"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","renameTitle","updateRowIndex","removeEmptyRow","cleanLaneAfterDrop","_deleteLane","_updateLaneHeight","_renderComplete","_deleteBar","_addBar","_changeColor","addDefaultBarRow");this._barViews=[];this._barRowViews=[];this.listenTo(this.model.get("bars"),"add",function(d){var c=this._newBarRowView();var e=this._newBarView(d);c.$el.append(e.render().$el);this._$laneContent.append(c.$el);this._barViews.push(e);this.$el.trigger("BarView.add",e);a.defer(this._updateLaneHeight)})},render:function(){var c=this;this.$el.append(Confluence.Templates.Roadmap.lane({title:this.model.get("title"),color:this.model.get("color")}));Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),1);var d=this.model.get("bars").models;d=a.sortBy(d,function(e){return e.attributes.rowIndex});a.each(d,function(e){var f=c._newBarView(e);c._barViews.push(f)});this._renderBars();a.defer(this._renderComplete);return this},_renderComplete:function(){this._updateLaneHeight()},renameTitle:function(c){this.model.set("title",c);this.$el.find(".roadmap-lane-title").attr("title",c);this.$el.find(".title-inner").html(AJS.escapeHtml(c));this._updateLaneHeight()},_updateLaneHeight:function(){var d=this.$el.find(".title-inner");d.hide();var c=this._$laneContent.outerHeight();d.width(c-2*Roadmap.LANE_PADDING);d.show()},_barBeforeResize:function(e,k){var l=e.$el;var g=Math.ceil(l.outerWidth()-l.width());var j;if(k=="left"){var f=this._getNearestBarView(e,k);var c=f==null?0:f.position().left+f.width()+g;var d=l.position().left-c;j=l.width()+d}else{var i=this._getNearestBarView(e,k);var h=i==null?this._getLaneContentWidth()-g:i.position().left-g;j=h-l.position().left}e.updateMaxWidth(j-Roadmap.BAR_MARGIN)},_renderBars:function(){var c=this;this._$laneContent=this.$el.find(".roadmap-lane-content");var d={};a.each(this._barViews,function(f){var g="row-"+f.model.get("rowIndex");var e=d[g];if(!e){e=c._newBarRowView(f.model.get("rowIndex"));d[g]=e}e.$el.append(f.render().$el);c._$laneContent.append(e.$el)})},_newBarRowView:function(){var c=new Roadmap.BarRowView();this._barRowViews.push(c);return c},_newBarView:function(c){var d=new Roadmap.BarView({model:c,lane:this,color:this.model.get("color"),timelineView:this.options.timelineView,deleteBar:this._deleteBar});d.on("beforeResize",a.bind(this._barBeforeResize,this));return d},_getNearestBarView:function(d,e){var f=a.filter(d.options.lane._barViews,function(g){return g.model.get("rowIndex")===d.model.get("rowIndex")});var c=null;if(e=="left"){a.each(f,function(g){if(g.$el.position().left<d.$el.position().left&&(c==null||g.$el.position().left>c.$el.position().left)){c=g}})}else{a.each(f,function(g){if(g.$el.position().left>d.$el.position().left&&(c==null||g.$el.position().left<c.$el.position().left)){c=g}})}return c!=null?c.$el:null},_getLaneContentWidth:function(){return this.$el.find(".roadmap-lane-content").width()},_showDialog:function(){this._laneDialog&&this._laneDialog.remove();this._laneDialog=this._createLaneDialog();this._laneDialog.show()},_createLaneDialog:function(){return new Roadmap.LaneDialogView({trigger:this.$el.find(".title-outer"),canDelete:this.options.canDelete,deleteLane:this._deleteLane,addBar:this._addBar,changeColor:this._changeColor,lane:this})},_onBarDropped:function(i,k,l){var n=!!k.barRowNewView;var f=l.draggable.data("View");var m=f.model;var h=f.options.lane;var j=(h.cid===this.cid);var g=this.model.get("bars");var o=l.position.left;var d=this.options.timelineView.getBarStartDate(o);if(j&&g.models.length===1&&n){return}f.updatePositionLeft(o);f.updateColor(this.model.get("color"));m.attributes.startDate=d;if(n){var c=this._newBarRowView();k.barRowNewView.$el.replaceWith(c.$el);f.appendTo(c.$el)}else{f.appendTo(k.$barRow)}l.helper.remove();if(!j){f.options.lane.removeEmptyRow();g._byId[m.id]=m;this._barViews.push(f);f.updateDeleteBar(this._deleteBar);h.model.get("bars").remove(m);g.models.push(m);h._barViews.splice(a.indexOf(h._barViews,f),1);this.updateRowIndex(h.$el);f.options=a.extend(f.options,{color:this.model.get("color"),lane:this});h._updateLaneHeight()}this.removeEmptyRow();this.updateRowIndex(this.$el);this._updateLaneHeight()},updateRowIndex:function(c){c.find(".roadmap-bar-row").each(function(e,d){b(d).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function(h,f){var g=b(f).data("View");if(g){g.model.attributes.rowIndex=e}})})},removeEmptyRow:function(){var c=0;a.each(this._barRowViews,function(d){if(d.isEmptyRow()){d.remove();c++}});return !!c},cleanLaneAfterDrop:function(){this._$laneContent.find(".roadmap-bar-drag-active").removeClass("roadmap-bar-drag-active");this._$laneContent.find(".new-row-placeholder").remove()},_deleteLane:function(){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.$el.trigger("Lane.delete",this)},updateDeleteStatus:function(c){if(this._laneDialog){this._laneDialog.remove();delete this._laneDialog}this.options.canDelete=c},_deleteBar:function(c){this.model.get("bars").remove(c.model);this._barViews.splice(a.indexOf(this._barViews,c),1);c.remove();if(this.removeEmptyRow()){this.updateRowIndex(this.$el);this._updateLaneHeight();this.$el.trigger("BarRowView.remove")}},_addBar:function(){var c=this.model.get("bars");var e=this.options.timelineView.model;var f=moment(e.get("startDate"));var d=e.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?f.startOf("month"):f.startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:this.model.getNumberOfRows(),startDate:d.toDate()}))},_changeColor:function(c){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.model.set("color",c);Confluence.Roadmap.ColorHelper.adjustColorCount(c,1);this.$el.find(".roadmap-lane-title").css({"background-color":c.lane,color:c.text});a.each(this._barViews,function(d){d.updateColor(c)})},addNewBarRow:function(h){var g=this._$laneContent.find(".roadmap-bar-row");var c=[];var d=function(){g.each(function(){var k=b(this);var j=k.index()===0;if(j){var l=new Roadmap.BarRowNewView({$barRow:k,renderBottom:false});k.before(l.render().$el);c.push(l)}var i=new Roadmap.BarRowNewView({$barRow:k});k.after(i.render().$el);c.push(i)})};if(g.length==0){this.addDefaultBarRow()}else{var e=g.find(".roadmap-bar");if(e.length>0){var f=(e.length>0)&&(e.length==1)&&(e.attr("cid")===h.attr("cid"));if(!f){d()}}}return c},addDefaultBarRow:function(){var c=this._newBarRowView();this._$laneContent.append(c.$el)},_onBarRowNewDropover:function(f,d,c){if(!a.isEmpty(Roadmap.DragDrop.barDraggingOver)){a.each(Roadmap.DragDrop.barDraggingOver,function(e){e.$el&&e.$el.removeClass("new-bar-row-hover roadmap-bar-drag-hover")})}Roadmap.DragDrop.barDraggingOver[d.cid]=d;c.helper.removeClass("roadmap-bar-overlapped");c.helper.data("isAddingNewRow",true)},_onBarRowNewDropout:function(f,d,c){c.helper.data("isAddingNewRow",false);delete Roadmap.DragDrop.barDraggingOver[d.cid];a.each(Roadmap.DragDrop.barDraggingOver,function(e){if(typeof e==="string"){c.helper.addClass("roadmap-bar-overlapped")}else{if(e.className==="roadmap-bar-row"&&c.helper.data("isAddingNewRow")!==true){e.$el.addClass("roadmap-bar-drag-hover")}}})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.MarkerView=Backbone.View.extend({className:"vertical-line",events:{dragstop:"_onDragStop",dragstart:"_onDragStart"},initialize:function(){a.bindAll(this,"render","updateHeight","renameTitle","_renderComplete","_onMarkerClick")},render:function(){var d=this.options.roadmap._timelineView.model;var c;if(d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){c=Confluence.Roadmap.Helper.getPosXOnMonthTimeline(d.attributes,this.model.get("markerDate"))}else{c=Confluence.Roadmap.Helper.getPosXOnWeekTimeline(d.attributes,this.model.get("markerDate"))}if(c<0||c>this.options.roadmap._timelineView.$el.width()){return false}this.$el.css({left:(c+Roadmap.LANE_TITLE_WIDTH)+"px"});this.$el.append(Confluence.Templates.Roadmap.marker({title:this.model.get("title")}));this.updateHeight(this.options.roadmap._getLaneHeight());a.defer(this._renderComplete);return this},_renderComplete:function(){this._setupMarkerDragging();this.$el.click(this._onMarkerClick);this.$el.find(".marker-title").ellipsis({row:Roadmap.MARKER_TITLE_LINE})},_setupMarkerDragging:function(){this.$el.draggable({axis:"x",zIndex:4013,containment:".roadmap-frame-content",cursor:"move"})},_onDragStop:function(g,f){var c=f.position.left-Roadmap.LANE_TITLE_WIDTH;var d=this.options.roadmap._timelineView.model.attributes;var h;if(d.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){h=Confluence.Roadmap.Helper.getMonthStartDateByPosition(d,c)}else{h=Confluence.Roadmap.Helper.getWeekStartDateByPosition(d,c)}this.model.set("markerDate",h)},_onDragStart:function(d,c){this.options.roadmap.hideDialog()},_onMarkerClick:function(c){if(!b(c.target).hasClass("marker-title")){return}this._markerDialog&&this._markerDialog.remove();this._markerDialog=this._createMarkerDialog();this._markerDialog.show()},_createMarkerDialog:function(){return new Roadmap.MarkerDialogView({trigger:this.$el.find(".marker-title"),marker:this})},updateHeight:function(c){this.$el.height(c+Roadmap.MARKER_HEIGHT_PADDING)},renameTitle:function(d){this.model.set("title",d);var c=this.$el.find(".marker-title");c.attr("title",d);c.html(AJS.escapeHtml(d)).ellipsis({row:Roadmap.MARKER_TITLE_LINE})},removeMarker:function(){this.model.collection.remove(this.model);this.remove()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.RoadmapEditorView=Backbone.View.extend({className:"roadmap-editor-container",events:{"BarView.add":"_onAddBar","BarView.dragstart":"_onBarDragstart","BarView.dragstop":"_onBarDragstop","BarView.drop":"_onBarDropped","LaneView.drop":"_onBarDropped","Lane.delete":"_onDeleteLane","BarRowView.remove":"_onBarRowViewRemove","sortstart .roadmap-content":"_onSortStart","sortstop .roadmap-content":"_onSortStop",remove:"_onRemove"},initialize:function(){a.bindAll(this,"render");this.listenTo(this.model.get("lanes"),"add",function(c){var d=new Roadmap.LaneView({model:c,timelineView:this._timelineView,canDelete:true});if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(true)}this._laneViews.push(d);this.$roadmapContent.append(d.render().$el);this._updateTimelineColumnHeight();this._scrollToBottom()});this.listenTo(this.model.get("markers"),"add",function(c){var d=new Roadmap.MarkerView({model:c,roadmap:this});this.$roadmapMarker.append(d.render().$el);this._markerViews.push(d)});this.listenTo(this.model.get("timeline"),"change",function(){if(this._isTimelineChanged()){this._calculateMinWidthOfABar();this._timelineView.update();this._timelineColumnView.update();this.$roadmapContent.empty();a.each(this._laneViews,function(c){c.remove()});this._laneViews=[];this._renderLanes();this.$roadmapMarker.empty();this._markerViews=[];this._renderMarkers();this._updateDragArea()}})},render:function(){this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());this._calculateMinWidthOfABar();this._initVariables();this._renderToolbar();this._renderTimeline();this._renderLanes();this._renderMarkers();this._renderTimelineColumn();this._updateDragArea();return this},_calculateMinWidthOfABar:function(){Roadmap.barMinWidth=this.model.get("timeline").get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Roadmap.MONTH_BAR_MIN_WIDTH:Roadmap.WEEK_BAR_MIN_WIDTH},_initVariables:function(){this.$roadmapContainer=this.$el.find("#roadmap-container");this.$roadmapTimeline=this.$roadmapContainer.find(".roadmap-frame");this.$roadmapContent=this.$roadmapContainer.find(".roadmap-content");this.$roadmapMarker=this.$roadmapContainer.find(".roadmap-marker");this._timelineView=new Roadmap.TimelineView({model:this.model.get("timeline")});this._timelineColumnView=new Roadmap.TimelineColumnView({model:this.model.get("timeline")});this._laneViews=[];this._markerViews=[]},_renderTimeline:function(){this.$roadmapTimeline.prepend(this._timelineView.render().$el)},_renderTimelineColumn:function(){this._updateTimelineColumnHeight();this.$roadmapTimeline.append(this._timelineColumnView.render().$el)},_renderMarkers:function(){var c=this;this.model.get("markers").each(function(d){var e=new Roadmap.MarkerView({model:d,roadmap:c});c.$roadmapMarker.append(e.render().$el);c._markerViews.push(e)})},_renderLanes:function(){Confluence.Roadmap.ColorHelper.resetColorCounts();var d=this;this._updateLaneWidth();var c=this.model.get("lanes").models.length>1;this.model.get("lanes").each(function(e){var f=new Roadmap.LaneView({model:e,timelineView:d._timelineView,canDelete:c});d._laneViews.push(f);d.$roadmapContent.append(f.render().$el)});this._setupLaneReordering()},_onAddBar:function(d,c){this._updateTimelineColumnHeight();var e=c.$el;if(!this._isInViewScreen(e)){this._scrollToBar(e)}},_renderToolbar:function(){var d=b("#"+this.options.dialogId+" .aui-dialog2-content");d.find(".roadmap-toolbar").remove();var c=new Roadmap.ToolbarView({model:this.model,timelineView:this._timelineView});d.prepend(c.render().$el)},_getTimelineWidth:function(){return this.$roadmapTimeline.find(".roadmap-frame-title").width()},_getLaneHeight:function(){return this.$roadmapContent.height()},_updateLaneWidth:function(){this.$roadmapContent.width(this._getTimelineWidth()+Roadmap.LANE_TITLE_WIDTH)},_scrollToBottom:function(){this.options.roadmapEditorPopup.scrollTop(this._getLaneHeight())},_isInViewScreen:function(c){return b.inviewport(c,{threshold:-200})},_scrollToBar:function(c){this.options.roadmapEditorPopup.scrollTop(c.parent().position().top);this.options.roadmapEditorPopup.scrollLeft(0)},_onBarDropped:function(){this._updateTimelineColumnHeight()},_onDeleteLane:function(d,c){this.model.get("lanes").remove(c.model);this._laneViews.splice(a.indexOf(this._laneViews,c),1);c.remove();this._updateTimelineColumnHeight();if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(false)}},_onBarRowViewRemove:function(){this._updateTimelineColumnHeight()},_updateTimelineColumnHeight:function(){var c=this._getLaneHeight();this._timelineColumnView.updateHeight(c);a.each(this._markerViews,function(d){d.updateHeight(c)})},hideDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").hide()},removeDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").remove()},_onBarDragstart:function(f,d){var c=this;this.hideDialog();this._updateDragArea();this._barRowNewViewList=[];a.each(this._laneViews,function(e){c._barRowNewViewList.push(e.addNewBarRow(d.helper))})},_updateDragArea:function(){var c=this.$roadmapContainer.find(".roadmap-drag-area");c.css(this._timelineColumnView.getSizeAndPosition())},_onBarDragstop:function(){a.each(a.flatten(this._barRowNewViewList),function(c){c.remove()});delete this._barRowNewViewList;a.each(this._laneViews,function(c){c.removeEmptyRow()})},_setupLaneReordering:function(){this.$roadmapContent.sortable({axis:"y",cursor:"move",handle:".roadmap-lane-title",opacity:0.3,placeholder:"roadmap-lane lane-sorting-placeholder",helper:function(d,c){return b(c).clone().addClass("lane-sorting-hepler")}})},_onSortStart:function(d,c){this.hideDialog();this._timelineColumnView.$el.hide();c.placeholder.css({height:Math.min(c.helper.height(),100),width:c.helper.width()}).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));c.helper.find(".roadmap-lane-content").css({width:c.helper.width()-(c.helper.find(".roadmap-lane-title").outerWidth()+c.helper.find(".roadmap-separate-content").outerWidth())})},_onSortStop:function(h,g){this._timelineColumnView.$el.show();var d=g.item.attr("cid");var f=a.find(this._laneViews,function(e){return e.cid===d});var c=f.model;var i=this.model.get("lanes");i.remove(c);i.models.splice(g.item.index(),0,c);i._byId[c.cid]=c},_onRemove:function(){this.$roadmapTimeline.remove()},_isMonthYearChanged:function(){var d=function(f,e){if(f.getMonth()!==e.getMonth()||f.getYear()!==e.getYear()){return true}return false};var c=this.model.get("timeline");return d(c._previousAttributes.startDate,c.attributes.startDate)||d(c._previousAttributes.endDate,c.attributes.endDate)},_isWeekChanged:function(){var c=function(l,k){var j=moment(l);var i=moment(k);return j.get("year")===i.get("year")&&j.isoWeek()===i.isoWeek()};var d=this.model.get("timeline");var g=d._previousAttributes.startDate;var h=d.attributes.startDate;var f=d._previousAttributes.endDate;var e=d.attributes.endDate;return !(c(g,h)&&c(f,e))},_isTimelineChanged:function(){var d=this.model.get("timeline");var c=d.changed.displayOption;if(c){this.model.updateDurationUnit(d.get("displayOption"))}else{c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?this._isMonthYearChanged():this._isWeekChanged()}return c},resize:function(){this._updateLaneWidth();this._updateTimelineColumnHeight();this.$roadmapContent.css({top:this.$roadmapTimeline.find(".roadmap-column-title:first").innerHeight()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-analytics-resources', location = 'analytics/roadmap-analytics.js' */
Confluence.Roadmap=Confluence.Roadmap||{};Confluence.Roadmap.Analytics=(function(f,j){var c={INSERT:"confluence.roadmap.insert",CREATE:"confluence.roadmap.create",EDIT:"confluence.roadmap.edit",EDIT_ACTIONS:{OPEN_BAR_DIALOG:"confluence.roadmap.editmode.open_bar_dialog",ADD_DESCRIPTION:"confluence.roadmap.editmode.add_description",ADD_PAGE_LINK:"confluence.roadmap.editmode.add_page_link"},VIEW_ACTIONS:{OPEN_BAR_DIALOG:"confluence.roadmap.viewmode.open_bar_dialog",CLICK_PAGE_LINK:"confluence.roadmap.viewmode.click_page_link",ADD_PAGE_LINK:"confluence.roadmap.viewmode.add_page_link"}};function h(o,p){AJS.trigger("analytics",{name:o,data:p})}function m(p){var o=0;j.each(p.lanes,function(q){o=o+q.bars.length});return{lanes:p.lanes.length,bars:o,markers:p.markers.length,months:Confluence.Roadmap.DateUtilities.getNumberOfMonths(p.timeline.startDate,p.timeline.endDate)+1}}function k(){h(c.INSERT)}function d(p){var o=m(p);h(c.CREATE,o)}function e(p){var o=m(p);h(c.EDIT,o)}function a(){h(c.EDIT_ACTIONS.OPEN_BAR_DIALOG)}function n(){h(c.VIEW_ACTIONS.OPEN_BAR_DIALOG)}function b(){h(c.VIEW_ACTIONS.CLICK_PAGE_LINK)}function l(){h(c.EDIT_ACTIONS.ADD_DESCRIPTION)}function g(o){h(c.EDIT_ACTIONS.ADD_PAGE_LINK,o)}function i(o){h(c.VIEW_ACTIONS.ADD_PAGE_LINK,o)}return{insertRoadmap:k,createRoadmap:d,editRoadmap:e,openBarDialogInEdit:a,addDescription:l,addPageLinkEditMode:g,addPageLinkViewMode:i,openBarDialogInView:n,clickPageLink:b}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.viewport.js' */
(function(a){a.belowthefold=function(c,d){var b=a(window).height()+a(window).scrollTop();return b<=a(c).offset().top-d.threshold};a.abovethetop=function(b,c){var d=a(window).scrollTop();return d>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(c,d){var b=a(window).width()+a(window).scrollLeft();return(b<=a(c).offset().left-d.threshold)||a(c).offset().left<0};a.leftofscreen=function(b,c){var d=a(window).scrollLeft();return d>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return !a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(c,d,b){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c,d,b){return a.abovethetop(c,{threshold:0})},"left-of-screen":function(c,d,b){return a.leftofscreen(c,{threshold:0})},"right-of-screen":function(c,d,b){return a.rightofscreen(c,{threshold:0})},"in-viewport":function(c,d,b){return a.inviewport(c,{threshold:0})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/md5.js' */
var hexcase=0;var b64pad="";function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function b64_md5(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function any_md5(a,b){return rstr2any(rstr_md5(str2rstr_utf8(a)),b)}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_md5(a,b){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_md5(a,c,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(h){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var k=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((k>>>6*(3-d))&63)}}}return b}function rstr2any(m,c){var b=c.length;var l,f,a,n,e;var k=Array(Math.ceil(m.length/2));for(l=0;l<k.length;l++){k[l]=(m.charCodeAt(l*2)<<8)|m.charCodeAt(l*2+1)}var h=Math.ceil(m.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(h);for(f=0;f<h;f++){e=Array();n=0;for(l=0;l<k.length;l++){n=(n<<16)+k[l];a=Math.floor(n/b);n-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=n;k=e}var d="";for(l=g.length-1;l>=0;l--){d+=c.charAt(g[l])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binl(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor.js' */
AJS.toInit(function(){var g,d,a,c,e;var f="~~~~~";AJS.MacroBrowser.setMacroJsOverride("roadmap",{opener:function(l){var n=function(s,q,r,t){var p=r?r.split(f):[];var o=q?q.split(f):[];if(!_.isEmpty(p)){$.ajax({type:"POST",contentType:"application/json",url:AJS.contextPath()+"/rest/roadmap/1.0/extractPageLinks",data:JSON.stringify({wikiLinks:_.object(p,o),roadmapSpace:AJS.Meta.get("space-key")}),success:function(u){_.each(s.lanes,function(v){_.chain(v.bars).filter(function(w){return _.contains(p,w.id)}).each(function(w){if(u[w.id]){w.pageLink=u[w.id]}})});t&&t()},error:function(u){AJS.log(u);t&&t()}})}else{t&&t()}},m=function(p){var q=[];var o=[];p.lanes.forEach(function(r){r.bars.forEach(function(s){if(!_.isEmpty(s.pageLink)){var t=s.pageLink.wikiLink.replace(/[\][]/g,"");q.push(_.escape(t));o.push(s.id)}})});return{pageLinks:q.join(f),mapLinks:o.join(f)}};if(l.params&&l.params.timeline!=="true"){var i="roadmap-deprecation-dialog";var j=$(Confluence.Templates.Roadmap.deprecationDialog({id:i}));AJS.dialog2(j).on("hide",function(){$("#"+i).remove()}).on("show",function(){$("#dialog-close-button",j).click(function(o){o.preventDefault();AJS.dialog2("#"+i).hide()})}).show();return false}var h;var k=function(){var p="confluence-roadmap-dialog";var t="roadmap-popup-panel";var s;if(typeof g=="undefined"){g=aui.dialog.dialog2({id:p,size:"xlarge",titleText:"Insert Roadmap Planner",content:Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId:t}),footerActionContent:Confluence.Templates.Roadmap.footerActionContent(),modal:true});d=$(g).appendTo($("body"));d.find("#roadmapInsertBtn").on("click",function(y){c.removeDialog();var v=c.model.toMacroData();var w=encodeURIComponent(JSON.stringify(v));var x=hex_md5(w);var z=m(v);var u={timeline:"true",source:w,hash:x,title:encodeURIComponent(v.title),pagelinks:z.pageLinks,maplinks:z.mapLinks};tinymce.confluence.macrobrowser.macroBrowserComplete({name:"roadmap",params:u});c.remove();s.hide();if(e){Confluence.Roadmap.Analytics.createRoadmap(v)}else{Confluence.Roadmap.Analytics.editRoadmap(v)}});d.find("#roadmapCancelBtn").on("click",function(u){c.removeDialog();c.remove();s.hide()});a=d.find(".roadmap-editor-popup")}s=AJS.dialog2("#"+p).show();var o=$("#"+t);var q=o.find(".roadmap-view");if(!q.length){q=$('<div class="roadmap-view"/>');o.append(q)}var r=new Roadmap.Roadmap(h,{parse:true});c=new Roadmap.RoadmapEditorView({model:r,dialogId:p,el:q,roadmapEditorPopup:a});c.render();b()};if(l.params&&l.params.source){e=false;h=JSON.parse(decodeURIComponent(l.params.source));n(h,l.params.pagelinks,l.params.maplinks,k)}else{e=true;Confluence.Roadmap.Analytics.insertRoadmap();k()}}});function b(){setTimeout(function(){if(d&&d.is(":visible")){var k=d.height(),j=d.find(".aui-dialog2-header").outerHeight(),l=d.find(".aui-dialog2-footer").outerHeight(),i=d.find("#roadmap-editor-toolbar").outerHeight(),h=d.find(".roadmap-editor-popup");h.css("height",k-j-l-i)}},0)}$(window).resize(function(){b();c&&c.resize()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor-config.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.COLORS=[{lane:"#f6c342",bar:"#fadb8e",text:"#594300"},{lane:"#3b7fc4",bar:"#6c9fd3",text:"#ffffff"},{lane:"#d04437",bar:"#dc7369",text:"#ffffff"},{lane:"#8eb021",bar:"#aac459",text:"#ffffff"},{lane:"#ea632b",bar:"#ef8a60",text:"#ffffff"},{lane:"#654982",bar:"#8c77a1",text:"#ffffff"},{lane:"#f15c75",bar:"#f58598",text:"#ffffff"},{lane:"#815b3a",bar:"#a1846b",text:"#ffffff"}];Roadmap.TIMELINE_DISPLAY_OPTION={MONTH:"MONTH",WEEK:"WEEK"};Roadmap.SHORT_DATE_FORMAT="YYYY-MM-DD";Roadmap.TWO_YY_SHORT_DATE_FORMAT="YY-MM-DD";Roadmap.DATE_FORMAT="YYYY-MM-DD HH:mm:ss";Roadmap.WEEK_FORMAT="DD-MMM";Roadmap.MONTH_FORMAT="MMM";Roadmap.TIMELINE_YEARS_LIMIT=5;Roadmap.LANE_TITLE_WIDTH=45;Roadmap.MARKER_HEIGHT_PADDING=10;Roadmap.MARKER_TITLE_LINE=2;Roadmap.LANE_PADDING=11;Roadmap.BAR_PADDING=8;Roadmap.BAR_MARGIN=1;Roadmap.BAR_BORDER=1;Roadmap.MONTH_WIDTH=101;Roadmap.WEEK_WIDTH=101;Roadmap.EXTRA_SPACE_AROUND=Roadmap.BAR_PADDING*2+Roadmap.BAR_BORDER*2;Roadmap.MONTH_BAR_MIN_WIDTH=Roadmap.MONTH_WIDTH/4-Roadmap.EXTRA_SPACE_AROUND;Roadmap.WEEK_BAR_MIN_WIDTH=Roadmap.WEEK_WIDTH-Roadmap.EXTRA_SPACE_AROUND;Roadmap.barMinWidth=Roadmap.MONTH_BAR_MIN_WIDTH;Roadmap.TRANSPARENT_LANE={title:"",color:{lane:"#ffffff",bar:"#ffffff",text:"#ffffff"}};Roadmap.DragDrop={};Roadmap.BarDialog={MAX_LENGTH_TITLE:100,MAX_LENGTH_DESCRIPTION:150};Roadmap.getDefaultRoadmapData=function(){var a=moment(new Date()).hours(0).minutes(0).seconds(0).milliseconds(0).toDate();var b=moment(a).add(11,"months").toDate();return{title:"Roadmap Planner",timeline:{startDate:new Date(a),endDate:b,displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH},lanes:[{title:"Lane 1",color:Roadmap.COLORS[0],bars:[{title:"Bar 1",description:"This is the first bar.",startDate:new Date(a.setDate(1)),duration:2,rowIndex:0},{title:"Bar 2",description:"This is the second bar.",startDate:new Date(a),duration:1,rowIndex:1}]},{title:"Lane 2",color:Roadmap.COLORS[1],bars:[{title:"Bar 3",description:"This is the third bar.",startDate:a,duration:2.5,rowIndex:0}]}],markers:[{title:"Marker 1",markerDate:moment(a).date(15).toDate()}]}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:include_macro', location = 'com/atlassian/confluence/plugins/macros/advanced/js/include-macro.js' */
AJS.bind("init.rte",function(){var c=AJS.Meta.get("context-path"),d=AJS.Meta.get("content-id");AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-page",function(a,b){a=AJS.$(b).attr("data-macro-default-parameter");a=c+"/plugins/servlet/confluence/include-page-macro/goto?location\x3d"+encodeURIComponent(a)+"\x26contentId\x3d"+d;(b=window.open(a,AJS.$.browser&&AJS.$.browser.msie?"_blank":"confluence-goto-link-include-macro-"+b.id))&&b.focus()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.multimedia:macro-browser-smart-fields', location = 'javascript/macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("multimedia",["swf","avi","mov","mp4","mpeg","mpg","wmv","wma","mp3","ram","rm"])})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.soy' */
// This file was automatically generated from page-layout.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.PageLayout.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.PageLayout == 'undefined') { Confluence.Templates.PageLayout = {}; }


Confluence.Templates.PageLayout.contentLayout = function(opt_data, opt_ignored) {
  return '<div class="contentLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.contentLayout.soyTemplateName = 'Confluence.Templates.PageLayout.contentLayout';
}


Confluence.Templates.PageLayout.cellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.cellLayout';
}


Confluence.Templates.PageLayout.smallCellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell aside"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.smallCellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.smallCellLayout';
}


Confluence.Templates.PageLayout.headerLayout = function(opt_data, opt_ignored) {
  return '<div class="header"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.headerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.headerLayout';
}


Confluence.Templates.PageLayout.footerLayout = function(opt_data, opt_ignored) {
  return '<div class="footer"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.footerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.footerLayout';
}


Confluence.Templates.PageLayout.columnLayout = function(opt_data, opt_ignored) {
  return '<div class="columnLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.columnLayout.soyTemplateName = 'Confluence.Templates.PageLayout.columnLayout';
}


Confluence.Templates.PageLayout.emptyLayout2 = function(opt_data, opt_ignored) {
  return '<div class="contentLayout2">' + Confluence.Templates.PageLayout.emptySection2(null) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptyLayout2.soyTemplateName = 'Confluence.Templates.PageLayout.emptyLayout2';
}


Confluence.Templates.PageLayout.emptySection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptySection2.soyTemplateName = 'Confluence.Templates.PageLayout.emptySection2';
}


Confluence.Templates.PageLayout.newSection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.newSection2.soyTemplateName = 'Confluence.Templates.PageLayout.newSection2';
}


Confluence.Templates.PageLayout.cell2 = function(opt_data, opt_ignored) {
  return '<div class="cell ' + soy.$$escapeHtml(opt_data.type) + '" data-type="' + soy.$$escapeHtml(opt_data.type) + '"><div class="innerCell">' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cell2.soyTemplateName = 'Confluence.Templates.PageLayout.cell2';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout",["jquery","ajs","tinymce"],function(d,e,f){function j(a){a=d(a.getBody());if(a.children(".contentLayout").length)return!1;a.children(".contentLayout2");return!0}var i=function(a){var e=d("#pagelayout-menu"),h=d(".icon-check",e);i=function(a){var c=h.not(".hidden"),a=h.siblings("."+a.name).siblings();c.addClass("hidden");a.removeClass("hidden")};i(a)};return{init:function(a){function l(){j(a)||f.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(c.getLayout())||
f.webkit||e.Rte.editorFocus(a)}function h(){f.isGecko&&setTimeout(function(){a.focus();a.dom.getRoot().focus()},1)}function k(g){var b=d("#pagelayout-menu").parent(),e=d("#page-layout-2-group");if(!g||!g.selection)j(a)?(b.addClass("hidden"),e.removeClass("hidden"),c=new f.plugins.PageLayoutPlugin.PageLayout2(a),f.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&d(a.getBody()).attr("contenteditable","true")):(b.removeClass("hidden"),e.addClass("hidden"),c=new f.plugins.PageLayoutPlugin.PageLayout(a),
f.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(c.getLayout())?c.body.attr("contenteditable","true"):h(),i(c.getLayout()))}var c;this.ed=a;"comment"!==e.Meta.get("content-type")&&(a.on("init",function(){a.undoManager.clear();a.undoManager.add();k();e.bind("editor.remote.change editor.local.change",function(){a.undoManager.ignore(function(){c.setup()})});e.bind("rte-ready",function(){var c=d('[contenteditable="true"]',a.getBody()),b=!1!==e.Meta.get("editor-auto-focus");c.attr("contenteditable",
"false");c.attr("contenteditable","true");b&&e.Rte.editorFocus(a)});a.on("SetContent",l);if(j(a))a.on("Undo",function(){f.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&c.body.attr("contenteditable","true");h()})}),d("#pagelayout-menu").delegate("li.dropdown-item a","click",function(){a.execCommand("mcePageLayout",!1,f.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions(this))}),a.addCommand("mcePageLayoutInitialize",function(){a.undoManager.add();c.createInitialLayoutIfNone()}),
a.addCommand("mcePageLayout",function(g,b){a.undoManager.add();c.setLayout(b);i(c.getLayout())}),a.addCommand("mcePageLayoutAddSection",function(g,b){a.undoManager.add();c.addSection&&c.addSection(b&&b.section)}),a.addCommand("mcePageLayoutChangeSection",function(g,b){a.undoManager.add();c.changeSection&&c.changeSection(b&&b.layout,b&&b.section)}),a.addCommand("mcePageLayoutRemoveSection",function(g,b){a.undoManager.add();c.removeSection&&c.removeSection(b&&b.section)}),a.addCommand("mcePageLayoutMoveSectionUp",
function(g,b){a.undoManager.add();c.moveSectionUp&&c.moveSectionUp(b&&b.section)}),a.addCommand("mcePageLayoutMoveSectionDown",function(g,b){a.undoManager.add();c.moveSectionDown&&c.moveSectionDown(b&&b.section)}),a.on("SetContent",k),a.on("click",function(c){var b=d(c.target);b.is("div.cell")&&b.children(".innerCell").focus();if(f.isWebKit&&(c.target===a.getBody()||c.target===a.getBody().parentNode))b=b.find(".innerCell"),b.length&&(a.execCommand("selectAll"),c=c.target!==a.getBody(),a.selection.collapse(c))}),
a.on("keyup",function(c){var b=c.keyCode;if(8!==b&&46!==b)return!0;b=a.selection.getRng(!0).startContainer;if(d(b).closest(".contentLayout,.contentLayout2",a.getBody()).length&&(b=d(b).closest(".innerCell"))&&b.length&&a.dom.isEmpty(b.clone()[0]))b.html('<p><br data-mce-bogus="1"></p>'),c.preventDefault(),a.selection.select(b[0].firstElementChild.firstChild,!0),a.selection.collapse(!0)}))},execCommand:function(a){if("selectAll"===a){var a=this.ed,e=a.getBody(),d,f;if("true"==a.dom.getAttrib(e,"contenteditable"))return!1;
d=a.dom.select(".innerCell",e);e=d[0];d=d[d.length-1];f=a.dom.createRng();f.setStart(e,0);f.setEnd(d,d.childNodes.length);a.selection.setRng(f);return!0}return!1},disableContent:function(){this.ed.dom.setAttribs(this.ed.dom.select("div.innerCell"),{contenteditable:!1});this.ed.dom.setStyle(this.ed.dom.select(".wiki-content .contentLayout2"),"user-select","auto")},getInfo:function(){return{longname:"Page Layout Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",
version:"1.0"}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout",function(d){var e=require("tinymce");e.create("tinymce.plugins.PageLayoutPlugin",d);e.PluginManager.add("pagelayoutplugin",e.plugins.PageLayoutPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.js' */
define("confluence-page-layout/pagelayout/page-layout",["jquery","confluence/templates","ajs"],function(c,k,r){var h=function(a){this.editor=a;this.body=c(a.getBody());this.setup()};h.DEFAULT_LAYOUT={name:"pagelayout-none",columns:0};h.prototype.setup=function(){var a=c(".contentLayout",this.body);a.length?(n(a),o(a,this.body,this.editor),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};h.prototype.setLayout=function(a){var g=require("tinymce"),b;b=c(".contentLayout",this.body);
if(h.getLayoutOptions(b).name!==a.name){r.trigger("analyticsEvent",{name:"PageLayoutEvent.pageLayoutChanged",data:{name:a.name}});if(1===b.length)b=b.clone();else{var d=this.editor;b=this.body;var e=k.PageLayout.contentLayout(),d=d.dom.create("div");d.innerHTML=e;b=c(d).children().html(b.html())}n(b);var e=b,d=c(".columnLayout > .cell",e).length,i=a.name,j=a.columns,f;if(0===d){f=e.html();for(e.html(k.PageLayout.columnLayout());d!==j.length;)p(e),d++}i=i.substring(i.indexOf("-")+1);i=i.substring(0,
Math.max(0,i.indexOf("-"))||void 0);c(".columnLayout",e).attr("class","columnLayout "+i+"Columns");if(j)for(c(".columnLayout > .cell",e).each(function(a,b){void 0!==j[a]&&c(b).attr("class","cell "+j[a])});d!==j.length;)if(d<j.length)p(e),d++;else{var i=c(".columnLayout .cell:nth-child("+d+") .innerCell",e),s=c(".columnLayout > .cell:nth-child("+(d-1)+") .innerCell",e),t=l(i);s.append(t);i.parent().remove();d--}else{var m="";c(".columnLayout > .cell",e).each(function(){m+=l(c(".innerCell",this))});
c(".columnLayout",e).replaceWith(m)}f&&q(e).html(f);a.header?(f=b,c(".header",f).length||f.prepend(k.PageLayout.headerLayout())):(e=b,f=c(".header",e),e=q(e),d=l(c(".innerCell",f)),e.length?(e.prepend(d),f.remove()):f.replaceWith(d));a.footer?(f=b,c(".footer",f).length||f.append(k.PageLayout.footerLayout())):(e=b,f=c(".footer",e),e=c(".columnLayout > .cell:last-child .innerCell",e),d=l(c(".innerCell",f)),e.length?(e.append(d),f.remove()):f.replaceWith(d));h.needsContentEditableBody(a)?(b=b.contents().unwrap(),
this.body.attr("contenteditable","true")):(o(b,this.body,this.editor),b.attr("data-atlassian-layout",JSON.stringify(a)));this.body.empty().append(b);g.isIE&&this.editor.dom.setRoot();b=this.editor;a=b.selection;g=a.getRng(!0);f=c('[contenteditable="true"]',b.getBody());f.length?(b.focus(),f[0].focus(),b=f.children()[0],g.setStart(b,0),g.setEnd(b,0),a.setRng(g)):b.focus()}};h.prototype.getLayout=function(){var a=c(".contentLayout",this.body);return a.length&&a.attr("data-atlassian-layout")?JSON.parse(a.attr("data-atlassian-layout")):
h.DEFAULT_LAYOUT};h.getLayoutOptions=function(a){return(a=(a.jquery?a:c(a)).attr("data-atlassian-layout"))?JSON.parse(a):h.DEFAULT_LAYOUT};h.needsContentEditableBody=function(a){return!(a.header||a.footer||a.columns)};var l=function(a){a=a.jquery?a:c(a);if(a.length)for(var g=a[0].childNodes,b=0;b<g.length;b++){var d=g[b];if(!("P"===d.nodeName&&1===d.childNodes.length&&"BR"===d.firstChild.nodeName))return a.html()}return""},n=function(a){for(var g,b,a=c(".cell, .header, .footer",a),d=0,e=a.length;d<
e;d++)g=c(a[d]),b=g.html(),c(".innerCell",g).length||(g.removeAttr("contenteditable"),g.html('<div class="innerCell">'+b+"</div>"))},o=function(a,g,b){var d=require("tinymce");g.attr("contenteditable","false");c(".innerCell",a).each(function(){var a=c(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")});d.isIE&&g.delegate(".innerCell","focus.pageLayout",function(){b.dom.settings.root_element=this})},q=function(a){return c(".columnLayout > .cell:first-child .innerCell",
a)},p=function(a){return c(".columnLayout",a).append(k.PageLayout.cellLayout())};return h});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout","tinymce.plugins.PageLayoutPlugin.PageLayout");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout-2.js' */
define("confluence-page-layout/pagelayout/page-layout-2",["jquery","confluence/templates","ajs"],function(g,n,f){function p(a,b,d){var c=a.find(".cell"),e=c.length,f=g(),k=b.cells.length,i=[],l=[],h,j;a.attr("class","columnLayout");a.addClass(b.id);a.attr("data-layout",b.id);h=0;for(j=e;h<j;h++)l=c.eq(h).detach(),i.push(s(l.children(".innerCell")));h=0;for(j=k;h<j;h++)f=f.add(n.PageLayout.cell2({type:b.cells[h].type||""}));if(e<=k)l=i;else{l=i.slice(0,k);h=k;for(j=e;h<j;h++)l[k-1]+=i[h]}a.prepend(f);
h=0;for(j=k;h<j;h++)f.eq(h).find(".innerCell").html(l[h]);o(a,d)}var e=function(a){this.editor=a;this.body=g(a.getBody());this.setup()};e.prototype.setup=function(){var a=this.body.find(".contentLayout2");a.length?(o(a,this.body),this.body.find("> p").each(function(){""===this.id.trim()&&0===this.classList.length&&g(this).remove()}),this.body.find(".contentLayout2 .cell").filter(function(){return 1<g(this).find(".innerCell").length}).each(function(a,d){for(var c=g(d).find(".innerCell"),e=c[0],f=1;f<
c.length;f++){var i=g(c[f]);g(e).append(i.children());i.remove()}}),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};e.prototype.addSection=function(a){var b=this,d=g(n.PageLayout.newSection2()),c=a||i(this.body,this.editor,!0);if(c.length){var r=e.Layouts.get(c.attr("data-layout"));this.editor.undoManager.ignore(function(){p(d,r,b.body,b.editor);c.after(d)});m(this.editor,d);f.trigger("editor.page-layout.add-section",{section:d})}else this.createInitialLayoutIfNone()};e.prototype.changeSection=
function(a,b){var d=this;e.isPageLayout()||this.createInitialLayoutIfNone();var c=b||i(this.body,this.editor,!1);if(c.length){var g=e.Layouts.get(c.attr("data-layout"));this.editor.undoManager.ignore(function(){p(c,a,d.body,d.editor)});m(this.editor,c);f.trigger("editor.page-layout.change-layout",{section:c,originalLayout:g,currentLayout:a})}};e.prototype.removeSection=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next(),d=a.prev(),c;b.length?(c=b,a.remove()):d.length?
(c=d,a.remove()):(a.closest(".contentLayout2").remove(),a=this.body.find(".contentLayout2").find(".columnLayout").first(),a.length?c=a:(a=this.editor,a.getBody().setAttribute("contenteditable",!0),a.setContent("<p></p>"),q(a),a=g("#rte-button-pagelayout-2"),a.hasClass("active")&&a.click()));c&&c.length&&m(this.editor,c);f.trigger("editor.page-layout.remove-section",{})}};e.prototype.moveSectionUp=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.prev();b.length&&(a.detach(),
b.before(a),m(this.editor,a));f.trigger("editor.page-layout.move-section-up",{section:a})}};e.prototype.moveSectionDown=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next();b.length&&(a.detach(),b.after(a),m(this.editor,a));f.trigger("editor.page-layout.move-section-down",{section:a})}};e.prototype.createInitialLayoutIfNone=function(){if(!e.isPageLayout()){var a=g(n.PageLayout.emptyLayout2()),b=a.find(".innerCell"),d=this.body.children().detach();b.append(d);this.body.append(a);
o(a,this.body);q(this.editor)}};e.isPageLayout=function(){return!!g(f.Rte.getEditor().getBody()).find("div.contentLayout2").length};e.needsContentEditableBody=function(){return!e.isPageLayout()};e.Layouts=[{id:"single",icon:"1col",name:"Single column section",cells:[{type:"normal"}]},{id:"two-equal",icon:"2col",name:"Two column section",cells:[{type:"normal"},{type:"normal"}]},{id:"two-left-sidebar",icon:"2col-right",name:"Two column section with left side-bar",
cells:[{type:"aside"},{type:"normal"}]},{id:"two-right-sidebar",icon:"2col-left",name:"Two column section with right side-bar",cells:[{type:"normal"},{type:"aside"}]},{id:"three-equal",icon:"3col",name:"Three column section",cells:[{type:"normal"},{type:"normal"},{type:"normal"}]},{id:"three-with-sidebars",icon:"3col-center",name:"Three column section with side-bars",cells:[{type:"sidebars"},{type:"normal"},{type:"sidebars"}]}];e.Layouts.get=
function(a){for(var b=e.Layouts,d=0,c=b.length;d<c;d++)if(b[d].id===a)return b[d];return null};e.Layouts.findNearestSection=function(a){var b=f.Rte.getEditor(),d=g(b.getBody());return i(d,b,a)};var s=function(a){a=g(a);if(a.length)for(var b=a[0].childNodes,d=0;d<b.length;d++){var c=b[d];if(!("P"===c.nodeName&&1===c.childNodes.length&&"BR"===c.firstChild.nodeName))return a.html()}return""},i=function(a,b,d){b=g(b.selection.getRng(!0).startContainer).closest(".columnLayout");!b.length&&d&&(b=a.find(".columnLayout").last());
return b},o=function(a,b){b.attr("contenteditable","false");g(".innerCell",a).each(function(){var a=g(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")})},q=function(a){var b=a.selection,d=b.getRng(!0),c=g('[contenteditable="true"]',a.getBody());c.length?(a.focus(),c[0].focus(),a=c.children()[0],d.setStart(a,0),d.setEnd(a,0),b.setRng(d)):a.focus()},m=function(a,b){var d=a.selection,c=d.getRng(!0),e=b.find('[contenteditable="true"]').first(),g=e.children();g.length?
(a.focus(),e[0].focus(),e=g[0],c.setStart(e,0),c.setEnd(e,0),d.setRng(c),f.Rte.showElement(e)):a.focus()};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout-2","tinymce.plugins.PageLayoutPlugin.PageLayout2");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout-toolbar.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",["jquery","ajs","tinymce","document","confluence/legacy"],function(d,b,e,f,a){var i=function(a){var a=a||e.plugins.PageLayoutPlugin.PageLayout2.Layouts.findNearestSection(),c=a.attr("data-layout"),a=d("#rte-toolbar-row-pl2-toolbar").find(".layouts button"),c=a.find(".pl2-layout-"+c).closest(".aui-button");c.hasClass("active")||(a.filter(".active").removeClass("active"),c.addClass("active"))};return{initContextToolbars:function(p,
c){var j=d(f),m=d("#page-layout-2"),g=d("#rte-button-pagelayout-2");c.addCommand("mcePageLayoutsToolbar",function(){g.hasClass("active")?j.trigger("removeContextToolbarRow.Toolbar",{id:"pl2-toolbar",animate:!0}):(j.trigger("createContextToolbarRow.Toolbar",{id:"pl2-toolbar",buttons:a.Editor.PageLayoutToolbar.Buttons,topToolbar:!0,animate:!0}),i(),c.execCommand("mcePageLayoutInitialize"));g.toggleClass("active")});g.click(function(a){a.preventDefault();m.hasClass("disabled")||c.execCommand("mcePageLayoutsToolbar",
!1,null)});c.on("NodeChange",function(a){a=d(a.element).closest(".columnLayout");i(a)});for(var k=e.plugins.PageLayoutPlugin.PageLayout2.Layouts,l=[],n=function(b){l.push(new a.Editor.Toolbar.Components.Button({text:b.name,iconClass:"aui-icon aui-icon-small aui-iconfont-layout-"+b.icon+"-large",click:function(){c.execCommand("mcePageLayoutChangeSection",!1,{layout:b})}}))},h=0,o=k.length;h<o;h++)n(k[h]);return{Buttons:[new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"Add section",
id:"add-layout-section",tooltip:"Add a new section below",iconClass:"aui-icon aui-icon-small aui-iconfont-add",click:function(){c.execCommand("mcePageLayoutAddSection")}}),new a.Editor.Toolbar.Components.Button({triggerText:"Remove section",id:"remove-layout-section",tooltip:"Remove the current section",iconClass:"aui-icon aui-icon-small aui-iconfont-delete",click:function(){c.execCommand("mcePageLayoutRemoveSection")}})]),
new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"Move up",id:"move-up-layout-section",tooltip:"Move section up",iconClass:"aui-icon aui-icon-small aui-iconfont-up",click:function(){c.execCommand("mcePageLayoutMoveSectionUp")}}),new a.Editor.Toolbar.Components.Button({triggerText:"Move down",id:"move-down-layout-section",tooltip:"Move section down",
iconClass:"aui-icon aui-icon-small aui-iconfont-down",click:function(){c.execCommand("mcePageLayoutMoveSectionDown")}})]),new a.Editor.Toolbar.Components.Group(l,{id:"pagelayout2-toolbar",text:"Apply layout",groupClass:"layouts"}),new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({text:"Close toolbar",iconClass:"aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){c.execCommand("mcePageLayoutsToolbar",!1,
null)}})],{groupClass:"close"})],Events:[]}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",function(d){var b=require("confluence/meta"),e=require("jquery"),f=require("document"),a=require("confluence/legacy");"comment"!==b.get("content-type")&&e(f).bind("initContextToolbars.Toolbar",function(b,e){a.Editor.PageLayoutToolbar=d.initContextToolbars(b,e)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-v4', location = 'js/editor-v4-init.js' */
require(["ajs","jquery","wrm/require"],function(b,d,c){b.Rte.BootstrapManager.addOnInitCallback(function(){c(["wrc!com.atlassian.confluence.plugins.drag-and-drop:editor-drop-handler"]).then(function(){require(["confluence-drag-and-drop/editor-drop-handler"],function(a){a.initialiseOverlay();a.initialise()})})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(packet&&packet.origin&&packet.origin!=="null"&&typeof packet.data==="string"){if(packet.origin===location.origin){process(gadgets.json.parse(packet.data))}else{AJS.$.get(AJS.contextPath()+"/rest/whitelist/1/check",{url:packet.origin}).done(function(result){if(result&&result.inbound&&result.inbound===true){process(gadgets.json.parse(packet.data))}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}).fail(function(jqXHR,textStatus,errorThrown){AJS.log("RPC: REST "+textStatus,errorThrown)})}}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"undefined origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(g){AJS.MacroBrowser.setMacroJsOverride("gadget",{postPreview:function(b,c){b=b.contentWindow.AJS;for(var a={},d=g("#macro-param-div-preferences input").val().split("\x26"),e=0,f=d.length;e<f;e++){var h=d[e].split("\x3d");try{a[decodeURI(h[0])]=decodeURI(h[1])}catch(q){}}c.needsConfig&&b&&!a.isConfigured&&(c=g("#macro-browser-dialog .dialog-button-panel .ok"),g("#save-warning-span").addClass("gadget-not-configured-warning").text("Please complete the configuration in the preview area first").removeClass("hidden"),
c.prop("disabled",!0))},beforeParamsSet:function(b,c){var a=b.preferences;if(!c&&a){c=a.split("\x26");a=0;for(var d=c.length;a<d;a++){var e=c[a].split("\x3d");b[decodeURI(e[0])]=decodeURI(e[1])}}return b},updateMacroParametersForPreview:function(b){b.forceWrite=!0;return b},manipulateMarkup:function(b){if(AJS.MacroBrowser.gadgetPrefsChanged){b=top.document.getElementById("macro-insert-container");b=g("#macro-param-div-preferences input",b);var c="",a;for(a in AJS.MacroBrowser.gadgetPrefs)0!=c.length&&
(c+="\x26"),c=c+encodeURI(a)+"\x3d"+encodeURI(AJS.MacroBrowser.gadgetPrefs[a]);b.val(c)}},getMacroDetailsFromSelectedMacro:function(b,c){for(var a=c.params.url,d=0,e=b.length;d<e;d++){var f=b[d];if(f.macroName===c.name&&f.gadgetUrl===a)return f}},beforeParamsRetrieved:function(b,c,a){var d="";if(c.nonHiddenUserPrefs){var e=!0,f={},h=b.preferences;if(h){h=h.split("\x26");for(var g=0,n=h.length;g<n;g++){var m=h[g].split("\x3d"),p=decodeURI(m[0]);m=decodeURI(m[1]);f[p]=m}}for(var k in a)f[k]=a[k];for(var l in f){a:{a=
c.formDetails.parameters;for(k=0;k<a.length;k++)if(a[k].name==l){a=f[l]==a[k].defaultValue;break a}AJS.log("Unable to find matching param for "+l);a=!1}a||(e||(d+="\x26"),e=!1,d=d+encodeURI(l)+"\x3d"+encodeURI(f[l]))}b.preferences=d}return b}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(k,g){AJS.log("add-handler.property-panel: panel name \x3d "+g.name);"macro"==g.name&&g.registerButtonHandler("view-in-jira",function(a,c){if(AJS.Editor.JiraConnector.servers){a=AJS.Editor.JiraConnector.servers;c=AJS.$(c);var b=c.attr("data-macro-default-parameter");c=c.attr("data-macro-parameters")||"";var e=Confluence.MacroParameterSerializer.deserialize(c);(b=b||e.jqlQuery||e.key)||(b=c.indexOf("|"),b=0<=b?c.substring(0,b):c);c=b;b=e.server;var h=e.serverId;
e=c.match(/=|!=|~|>|<|!~| is | in /i);for(var f=null,d=0;d<a.length;d++){if(h&&a[d].id==h){f=a[d];break}if(b&&a[d].name==b||!b&&a[d].selected){f=a[d];break}}null!=f&&(a="undefined"!==typeof f.displayUrl?f.displayUrl:f.url,"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),b=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId,(e?window.open(a+"/secure/IssueNavigator.jspa?reset\x3dtrue\x26jqlQuery\x3d"+encodeURIComponent(c),b):window.open(a+"/browse/"+encodeURIComponent(c),b)).opener=
null)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){function a(b,d,e){if(e=AJS.$.grep(d,function(f){return"show-summary"==f.parameterName})[0])c(b)?"false"==AJS.SummaryHelper.getParam(b,"showSummary")?e.text="Show summary":e.text="Hide summary":e.className+=" hidden";else{AJS.logError("Jira Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var g in d)AJS.logError(d[g].text)}}function c(b){var d=
AJS.$(b).attr("src");if(!d)return!0;b=AJS.SummaryHelper.getParam(b,"count");return-1==d.indexOf("confluence.extra.jira/jira-table")&&"true"!=b?!0:!1}AJS.Confluence||AJS.Confluence.PropertyPanel||AJS.Confluence.PropertyPanel.Macro?(AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jira"),AJS.Confluence.PropertyPanel.Macro.registerInitHandler(a,"jiraissues")):AJS.logError("Jira Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined")});
AJS.bind("add-handler.property-panel",function(a,c){"macro"==c.name&&c.registerButtonHandler("show-summary",function(b,d){b=AJS.SummaryHelper.getParam(d,"showSummary");AJS.SummaryHelper.updateMacro("jira",d,"showSummary","false"==b?"true":"false")})});
AJS.SummaryHelper=function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,c){a=AJS.$(a);return AJS.SummaryHelper.getCurrentParams(a)[c]},updateMacro:function(a,c,b,d){c=AJS.$(c);AJS.Rte.getEditor().selection.select(c[0]);AJS.Rte.BookmarkManager.storeBookmark();var e=AJS.SummaryHelper.getCurrentParams(c);e[b]=d;a={contentId:Confluence.Editor.getContentId(),macro:{name:a,params:e,defaultParameterValue:c.attr("data-macro-default-parameter")}};
tinymce.confluence.MacroUtils.insertMacro(a)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:lodash', location = '/custom-lodash/custom-lodash.js' */
/*

 Lodash (Custom Build) <https://lodash.com/>
 Build: `lodash include="bind,map,groupBy,compact,uniq,has,each,extend,filter,reject,bindAll,without,debounce,difference,forEach,take,find,chain,some,values,reduce" moduleId="jira-integration-plugin/custom-lodash"`
 Copyright JS Foundation and other contributors <https://js.foundation/>
 Released under MIT license <https://lodash.com/license>
 Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/
(function(){function va(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function Ic(a,b,c,d){for(var e=-1,g=null==a?0:a.length;++e<g;){var m=a[e];b(d,m,c(m),a)}return d}function C(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&!1!==b(a[c],c,a););return a}function wa(a,b){for(var c=-1,d=null==a?0:a.length,e=0,g=[];++c<d;){var m=a[c];b(m,c,a)&&(g[e++]=m)}return g}function Xa(a,b){var c;
if(c=!(null==a||!a.length)){if(b===b)a:{c=-1;for(var d=a.length;++c<d;)if(a[c]===b){a=c;break a}a=-1}else a=wb(a,Jc,0);c=-1<a}return c}function Kc(a,b,c){for(var d=-1,e=null==a?0:a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function xa(a,b){for(var c=-1,d=null==a?0:a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function W(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function xb(a,b,c,d){var e=-1,g=null==a?0:a.length;for(d&&g&&(c=a[++e]);++e<g;)c=b(c,a[e],e,a);return c}
function yb(a,b){for(var c=-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function wb(a,b,c,d){var e=a.length;for(c+=d?1:-1;d?c--:++c<e;)if(b(a[c],c,a))return c;return-1}function Jc(a){return a!==a}function Lc(a){return function(b){return null==b?k:b[a]}}function Mc(a,b,c,d,e){e(a,function(a,e,h){c=d?(d=!1,a):b(c,a,e,h)});return c}function ya(a){return function(b){return a(b)}}function Nc(a,b){return xa(b,function(b){return a[b]})}function zb(a,b){return a.has(b)}function Ab(a){var b=
-1,c=Array(a.size);a.forEach(function(a,e){c[++b]=[e,a]});return c}function Bb(a,b){return function(c){return a(b(c))}}function da(a,b){for(var c=-1,d=a.length,e=0,g=[];++c<d;){var m=a[c];if(m===b||"__lodash_placeholder__"===m)a[c]="__lodash_placeholder__",g[e++]=c}return g}function za(a){var b=-1,c=Array(a.size);a.forEach(function(a){c[++b]=a});return c}function f(a){if(x(a)&&!v(a)&&!(a instanceof q)){if(a instanceof E)return a;if(w.call(a,"__wrapped__"))return Cb(a)}return new E(a)}function Aa(){}
function E(a,b){this.__wrapped__=a;this.__actions__=[];this.__chain__=!!b;this.__index__=0;this.__values__=k}function q(a){this.__wrapped__=a;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function P(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function J(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function K(a){var b=-1,c=null==
a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function X(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new K;++b<c;)this.add(a[b])}function F(a){this.size=(this.__data__=new J(a)).size}function Db(a,b){var c=v(a),d=!c&&Ba(a),e=!c&&!d&&ea(a),g=!c&&!d&&!e&&Ya(a);if(c=c||d||e||g){d=a.length;for(var m=String,h=-1,n=Array(d);++h<d;)n[h]=m(h);d=n}else d=[];m=d.length;for(var f in a)!b&&!w.call(a,f)||c&&("length"==f||e&&("offset"==f||"parent"==f)||g&&("buffer"==f||"byteLength"==
f||"byteOffset"==f)||fa(f,m))||d.push(f);return d}function Eb(a,b,c){var d=a[b];w.call(a,b)&&ha(d,c)&&(c!==k||b in a)||Ca(a,b,c)}function Da(a,b){for(var c=a.length;c--;)if(ha(a[c][0],b))return c;return-1}function Oc(a,b,c,d){Y(a,function(a,g,m){b(d,a,c(a),m)});return d}function Pc(a,b){return a&&ia(b,G(b),a)}function Qc(a,b){return a&&ia(b,ja(b),a)}function Ca(a,b,c){"__proto__"==b&&Ea?Ea(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function Fa(a,b,c,d,e,g){var m,h=b&1,n=b&2,f=
b&4;c&&(m=e?c(a,d,e,g):c(a));if(m!==k)return m;if(!y(a))return a;if(d=v(a)){if(m=Rc(a),!h)return M(a,m)}else{var l=A(a),p="[object Function]"==l||"[object GeneratorFunction]"==l;if(ea(a))return Sc(a,h);if("[object Object]"==l||"[object Arguments]"==l||p&&!e){if(m=n||p?{}:Tc(a),!h)return n?Uc(a,Qc(m,a)):Vc(a,Pc(m,a))}else{if(!t[l])return e?a:{};m=Wc(a,l,h)}}g||(g=new F);if(e=g.get(a))return e;g.set(a,m);if(Fb(a))return a.forEach(function(d){m.add(Fa(d,b,c,d,a,g))}),m;if(Gb(a))return a.forEach(function(d,
e){m.set(e,Fa(d,b,c,e,a,g))}),m;n=f?n?Xc:Za:n?ja:G;var r=d?k:n(a);C(r||a,function(d,e){r&&(e=d,d=a[e]);Eb(m,e,Fa(d,b,c,e,a,g))});return m}function Hb(a,b,c,d){var e=-1,g=Xa,m=!0,h=a.length,n=[],f=b.length;if(!h)return n;c&&(b=xa(b,ya(c)));d?(g=Kc,m=!1):200<=b.length&&(g=zb,m=!1,b=new X(b));a:for(;++e<h;){var l=a[e],k=null==c?l:c(l);l=d||0!==l?l:0;if(m&&k===k){for(var r=f;r--;)if(b[r]===k)continue a;n.push(l)}else g(b,k,d)||n.push(l)}return n}function Ib(a,b){var c=[];Y(a,function(a,e,g){b(a,e,g)&&
c.push(a)});return c}function $a(a,b,c,d,e){var g=-1,m=a.length;c||(c=Yc);for(e||(e=[]);++g<m;){var h=a[g];0<b&&c(h)?1<b?$a(h,b-1,c,d,e):W(e,h):d||(e[e.length]=h)}return e}function Ga(a,b){return a&&Zc(a,b,G)}function Jb(a,b){return wa(b,function(b){return ka(a[b])})}function ab(a,b){b=bb(b,a);for(var c=0,d=b.length;null!=a&&c<d;)a=a[Z(b[c++])];return c&&c==d?a:k}function Kb(a,b,c){b=b(a);return v(a)?b:W(b,c(a))}function Q(a){if(null==a)return a===k?"[object Undefined]":"[object Null]";if(R&&R in
Object(a)){var b=w.call(a,R),c=a[R];try{a[R]=k;var d=!0}catch(g){}var e=Lb.call(a);d&&(b?a[R]=c:delete a[R]);a=e}else a=Lb.call(a);return a}function $c(a,b){return null!=a&&w.call(a,b)}function ad(a,b){return null!=a&&b in Object(a)}function Mb(a){return x(a)&&"[object Arguments]"==Q(a)}function aa(a,b,c,d,e){if(a===b)return!0;if(null==a||null==b||!x(a)&&!x(b))return a!==a&&b!==b;a:{var g=v(a),m=v(b),h=g?"[object Array]":A(a),n=m?"[object Array]":A(b);h="[object Arguments]"==h?"[object Object]":h;
n="[object Arguments]"==n?"[object Object]":n;var f="[object Object]"==h;m="[object Object]"==n;if((n=h==n)&&ea(a)){if(!ea(b)){b=!1;break a}g=!0;f=!1}if(n&&!f)e||(e=new F),b=g||Ya(a)?Nb(a,b,c,d,aa,e):bd(a,b,h,c,d,aa,e);else{if(!(c&1)&&(g=f&&w.call(a,"__wrapped__"),h=m&&w.call(b,"__wrapped__"),g||h)){a=g?a.value():a;b=h?b.value():b;e||(e=new F);b=aa(a,b,c,d,e);break a}if(n)b:if(e||(e=new F),g=c&1,h=Za(a),m=h.length,n=Za(b).length,m==n||g){for(f=m;f--;){var l=h[f];if(!(g?l in b:w.call(b,l))){b=!1;break b}}if((n=
e.get(a))&&e.get(b))b=n==b;else{n=!0;e.set(a,b);e.set(b,a);for(var p=g;++f<m;){l=h[f];var r=a[l],q=b[l];if(d)var t=g?d(q,r,l,b,a,e):d(r,q,l,a,b,e);if(t===k?r!==q&&!aa(r,q,c,d,e):!t){n=!1;break}p||(p="constructor"==l)}n&&!p&&(c=a.constructor,d=b.constructor,c!=d&&"constructor"in a&&"constructor"in b&&!("function"==typeof c&&c instanceof c&&"function"==typeof d&&d instanceof d)&&(n=!1));e["delete"](a);e["delete"](b);b=n}}else b=!1;else b=!1}}return b}function cd(a){return x(a)&&"[object Map]"==A(a)}
function dd(a,b,c,d){var e=c.length,g=e,m=!d;if(null==a)return!g;for(a=Object(a);e--;){var h=c[e];if(m&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<g;){h=c[e];var f=h[0],z=a[f],l=h[1];if(m&&h[2]){if(z===k&&!(f in a))return!1}else{h=new F;if(d)var p=d(z,l,f,a,b,h);if(p===k?!aa(l,z,3,d,h):!p)return!1}}return!0}function ed(a){return x(a)&&"[object Set]"==A(a)}function fd(a){return x(a)&&Ha(a.length)&&!!u[Q(a)]}function Ob(a){return"function"==typeof a?a:null==a?ba:"object"==typeof a?v(a)?gd(a[0],
a[1]):hd(a):Pb(a)}function id(a,b){var c=-1,d=L(a)?Array(a.length):[];Y(a,function(a,g,m){d[++c]=b(a,g,m)});return d}function hd(a){var b=jd(a);return 1==b.length&&b[0][2]?Qb(b[0][0],b[0][1]):function(c){return c===a||dd(c,a,b)}}function gd(a,b){return cb(a)&&b===b&&!y(b)?Qb(Z(a),b):function(c){var d=db(c,a);return d===k&&d===b?Rb(c,a):aa(b,d,3)}}function kd(a){return function(b){return ab(b,a)}}function la(a,b){return eb(Sb(a,b,ba),a+"")}function Tb(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b);
c=c>e?e:c;0>c&&(c+=e);e=b>c?0:c-b>>>0;b>>>=0;for(c=Array(e);++d<e;)c[d]=a[d+b];return c}function ld(a,b){var c;Y(a,function(a,e,g){c=b(a,e,g);return!c});return!!c}function Ub(a){if("string"==typeof a)return a;if(v(a))return xa(a,Ub)+"";if(ma(a))return Vb?Vb.call(a):"";var b=a+"";return"0"==b&&1/a==-na?"-0":b}function Wb(a,b){a instanceof q&&(a=a.value());return xb(b,function(a,b){return b.func.apply(b.thisArg,W([a],b.args))},a)}function bb(a,b){return v(a)?a:cb(a,b)?[a]:md(Xb(a))}function Sc(a,b){if(b)return a.slice();
b=a.length;b=Yb?Yb(b):new a.constructor(b);a.copy(b);return b}function fb(a){var b=new a.constructor(a.byteLength);(new Ia(b)).set(new Ia(a));return b}function Zb(a,b,c,d){var e=-1,g=a.length,m=c.length,h=-1,f=b.length,k=H(g-m,0),l=Array(f+k);for(d=!d;++h<f;)l[h]=b[h];for(;++e<m;)if(d||e<g)l[c[e]]=a[e];for(;k--;)l[h++]=a[e++];return l}function $b(a,b,c,d){var e=-1,g=a.length,m=-1,h=c.length,f=-1,k=b.length,l=H(g-h,0),p=Array(l+k);for(d=!d;++e<l;)p[e]=a[e];for(l=e;++f<k;)p[l+f]=b[f];for(;++m<h;)if(d||
e<g)p[l+c[m]]=a[e++];return p}function M(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function ia(a,b,c,d){var e=!c;c||(c={});for(var g=-1,m=b.length;++g<m;){var h=b[g],f=d?d(c[h],a[h],h,c,a):k;f===k&&(f=a[h]);e?Ca(c,h,f):Eb(c,h,f)}return c}function Vc(a,b){return ia(a,gb(a),b)}function Uc(a,b){return ia(a,ac(a),b)}function nd(a,b,c){function d(){return(this&&this!==B&&this instanceof d?g:a).apply(e?c:this,arguments)}var e=b&1,g=oa(a);return d}function oa(a){return function(){var b=
arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=Ja(a.prototype);b=a.apply(c,b);return y(b)?b:c}}function od(a,b,c){function d(){for(var g=arguments.length,m=Array(g),h=g,f=hb(d);h--;)m[h]=arguments[h];h=3>g&&m[0]!==
f&&m[g-1]!==f?[]:da(m,f);g-=h.length;return g<c?bc(a,b,Ka,d.placeholder,k,m,h,k,k,c-g):va(this&&this!==B&&this instanceof d?e:a,this,m)}var e=oa(a);return d}function Ka(a,b,c,d,e,g,m,f,n,z){function h(){for(var l=arguments.length,r=Array(l),I=l;I--;)r[I]=arguments[I];if(v){var y=hb(h),x;I=r.length;for(x=0;I--;)r[I]===y&&++x}d&&(r=Zb(r,d,e,v));g&&(r=$b(r,g,m,v));l-=x;if(v&&l<z)return y=da(r,y),bc(a,b,Ka,h.placeholder,c,r,y,f,n,z-l);y=q?c:this;I=t?y[a]:a;l=r.length;if(f){x=r.length;for(var A=S(f.length,
x),D=M(r);A--;){var C=f[A];r[A]=fa(C,x)?D[C]:k}}else u&&1<l&&r.reverse();p&&n<l&&(r.length=n);this&&this!==B&&this instanceof h&&(I=w||oa(I));return I.apply(y,r)}var p=b&128,q=b&1,t=b&2,v=b&24,u=b&512,w=t?k:oa(a);return h}function pd(a,b,c,d){function e(){for(var b=-1,f=arguments.length,k=-1,l=d.length,p=Array(l+f),r=this&&this!==B&&this instanceof e?m:a;++k<l;)p[k]=d[k];for(;f--;)p[k++]=arguments[++b];return va(r,g?c:this,p)}var g=b&1,m=oa(a);return e}function bc(a,b,c,d,e,g,m,h,n,z){var l=b&8,p=
l?m:k;m=l?k:m;var r=l?g:k;g=l?k:g;b=(b|(l?32:64))&~(l?64:32);b&4||(b&=-4);e=[a,b,e,r,p,g,m,h,n,z];c=c.apply(k,e);b:for(h=a.name+"",n=pa[h],z=w.call(pa,h)?n.length:0;z--;)if(l=n[z],p=l.func,null==p||p==a){h=l.name;break b}n=f[h];"function"==typeof n&&h in q.prototype?a===n?h=!0:(h=cc(n),h=!!h&&a===h[0]):h=!1;h&&dc(c,e);c.placeholder=d;return ec(c,a,b)}function Nb(a,b,c,d,e,g){var m=c&1,f=a.length,n=b.length;if(f!=n&&!(m&&n>f))return!1;if((n=g.get(a))&&g.get(b))return n==b;n=-1;var z=!0,l=c&2?new X:
k;g.set(a,b);for(g.set(b,a);++n<f;){var p=a[n],r=b[n];if(d)var q=m?d(r,p,n,b,a,g):d(p,r,n,a,b,g);if(q!==k){if(q)continue;z=!1;break}if(l){if(!yb(b,function(a,b){if(!l.has(b)&&(p===a||e(p,a,c,d,g)))return l.push(b)})){z=!1;break}}else if(p!==r&&!e(p,r,c,d,g)){z=!1;break}}g["delete"](a);g["delete"](b);return z}function bd(a,b,c,d,e,g,f){switch(c){case "[object DataView]":if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)break;a=a.buffer;b=b.buffer;case "[object ArrayBuffer]":if(a.byteLength!=
b.byteLength||!g(new Ia(a),new Ia(b)))break;return!0;case "[object Boolean]":case "[object Date]":case "[object Number]":return ha(+a,+b);case "[object Error]":return a.name==b.name&&a.message==b.message;case "[object RegExp]":case "[object String]":return a==b+"";case "[object Map]":var m=Ab;case "[object Set]":m||(m=za);if(a.size!=b.size&&!(d&1))break;if(c=f.get(a))return c==b;d|=2;f.set(a,b);b=Nb(m(a),m(b),d,e,g,f);f["delete"](a);return b;case "[object Symbol]":if(qa)return qa.call(a)==qa.call(b)}return!1}
function fc(a){return eb(Sb(a,k,gc),a+"")}function Za(a){return Kb(a,G,gb)}function Xc(a){return Kb(a,ja,ac)}function hb(a){return(w.call(f,"placeholder")?f:a).placeholder}function D(){var a=f.iteratee||ib;a=a===ib?Ob:a;return arguments.length?a(arguments[0],arguments[1]):a}function La(a,b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function jd(a){for(var b=G(a),c=b.length;c--;){var d=
b[c],e=a[d];b[c]=[d,e,e===e&&!y(e)]}return b}function T(a,b){a=null==a?k:a[b];b=!y(a)||hc&&hc in a?!1:(ka(a)?qd:rd).test(U(a));return b?a:k}function ic(a,b,c){b=bb(b,a);for(var d=-1,e=b.length,g=!1;++d<e;){var f=Z(b[d]);if(!(g=null!=a&&c(a,f)))break;a=a[f]}if(g||++d!=e)return g;e=null==a?0:a.length;return!!e&&Ha(e)&&fa(f,e)&&(v(a)||Ba(a))}function Rc(a){var b=a.length,c=new a.constructor(b);b&&"string"==typeof a[0]&&w.call(a,"index")&&(c.index=a.index,c.input=a.input);return c}function Tc(a){return"function"!=
typeof a.constructor||jb(a)?{}:Ja(jc(a))}function Wc(a,b,c){var d=a.constructor;switch(b){case "[object ArrayBuffer]":return fb(a);case "[object Boolean]":case "[object Date]":return new d(+a);case "[object DataView]":return b=c?fb(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.byteLength);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return b=
c?fb(a.buffer):a.buffer,new a.constructor(b,a.byteOffset,a.length);case "[object Map]":return new d;case "[object Number]":case "[object String]":return new d(a);case "[object RegExp]":return b=new a.constructor(a.source,sd.exec(a)),b.lastIndex=a.lastIndex,b;case "[object Set]":return new d;case "[object Symbol]":return qa?Object(qa.call(a)):{}}}function Yc(a){return v(a)||Ba(a)||!!(kc&&a&&a[kc])}function fa(a,b){var c=typeof a;b=null==b?9007199254740991:b;return!!b&&("number"==c||"symbol"!=c&&td.test(a))&&
-1<a&&0==a%1&&a<b}function lc(a,b,c){if(!y(c))return!1;var d=typeof b;return("number"==d?L(c)&&fa(b,c.length):"string"==d&&b in c)?ha(c[b],a):!1}function cb(a,b){if(v(a))return!1;var c=typeof a;return"number"==c||"symbol"==c||"boolean"==c||null==a||ma(a)?!0:ud.test(a)||!vd.test(a)||null!=b&&a in Object(b)}function jb(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||Ma)}function Qb(a,b){return function(c){return null==c?!1:c[a]===b&&(b!==k||a in Object(c))}}function Sb(a,b,
c){b=H(b===k?a.length-1:b,0);return function(){for(var d=arguments,e=-1,g=H(d.length-b,0),f=Array(g);++e<g;)f[e]=d[b+e];e=-1;for(g=Array(b+1);++e<b;)g[e]=d[e];g[b]=c(f);return va(a,this,g)}}function ec(a,b,c){var d=b+"";b=eb;var e=(e=d.match(wd))?e[1].split(xd):[];c=yd(e,c);if(e=c.length){var g=e-1;c[g]=(1<e?"\x26 ":"")+c[g];c=c.join(2<e?", ":" ");d=d.replace(zd,"{\n/* [wrapped with "+c+"] */\n")}return b(a,d)}function mc(a){var b=0,c=0;return function(){var d=Ad(),e=16-(d-c);c=d;if(0<e){if(800<=
++b)return arguments[0]}else b=0;return a.apply(k,arguments)}}function Z(a){if("string"==typeof a||ma(a))return a;var b=a+"";return"0"==b&&1/a==-na?"-0":b}function U(a){if(null!=a){try{return nc.call(a)}catch(b){}return a+""}return""}function yd(a,b){C(Bd,function(c){var d="_."+c[0];b&c[1]&&!Xa(a,d)&&a.push(d)});return a.sort()}function Cb(a){if(a instanceof q)return a.clone();var b=new E(a.__wrapped__,a.__chain__);b.__actions__=M(a.__actions__);b.__index__=a.__index__;b.__values__=a.__values__;return b}
function oc(a,b,c){var d=null==a?0:a.length;if(!d)return-1;c=null==c?0:N(c);0>c&&(c=H(d+c,0));return wb(a,D(b,3),c)}function gc(a){return(null==a?0:a.length)?$a(a,1):[]}function pc(a){var b=null==a?0:a.length;return b?a[b-1]:k}function kb(a){return null==a?a:Cd.call(a)}function qc(a){a=f(a);a.__chain__=!0;return a}function Na(a,b){return b(a)}function Dd(){return this}function rc(a,b){return(v(a)?C:Y)(a,D(b,3))}function Oa(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new TypeError("Expected a function");
var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],g=c.cache;if(g.has(e))return g.get(e);d=a.apply(this,d);c.cache=g.set(e,d)||g;return d};c.cache=new (Oa.Cache||K);return c}function lb(a){if("function"!=typeof a)throw new TypeError("Expected a function");return function(){var b=arguments;switch(b.length){case 0:return!a.call(this);case 1:return!a.call(this,b[0]);case 2:return!a.call(this,b[0],b[1]);case 3:return!a.call(this,b[0],b[1],b[2])}return!a.apply(this,b)}}function ha(a,b){return a===
b||a!==a&&b!==b}function L(a){return null!=a&&Ha(a.length)&&!ka(a)}function Pa(a){return x(a)&&L(a)}function ka(a){if(!y(a))return!1;a=Q(a);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a}function Ha(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function y(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function x(a){return null!=a&&"object"==typeof a}function sc(a){return"string"==typeof a||!v(a)&&x(a)&&
"[object String]"==Q(a)}function ma(a){return"symbol"==typeof a||x(a)&&"[object Symbol]"==Q(a)}function tc(a){if(!a)return[];if(L(a))return sc(a)?Ed.test(a)?a.match(Fd)||[]:a.split(""):M(a);if(ra&&a[ra]){a=a[ra]();for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}b=A(a);return("[object Map]"==b?Ab:"[object Set]"==b?za:uc)(a)}function vc(a){if(!a)return 0===a?a:0;a=Qa(a);return a===na||a===-na?1.7976931348623157E308*(0>a?-1:1):a===a?a:0}function N(a){a=vc(a);var b=a%1;return a===a?b?a-b:
a:0}function Qa(a){if("number"==typeof a)return a;if(ma(a))return wc;y(a)&&(a="function"==typeof a.valueOf?a.valueOf():a,a=y(a)?a+"":a);if("string"!=typeof a)return 0===a?a:+a;a=a.replace(Gd,"");var b=Hd.test(a);return b||Id.test(a)?Jd(a.slice(2),b?2:8):Kd.test(a)?wc:+a}function Xb(a){return null==a?"":Ub(a)}function db(a,b,c){a=null==a?k:ab(a,b);return a===k?c:a}function Rb(a,b){return null!=a&&ic(a,b,ad)}function G(a){if(L(a))a=Db(a);else if(jb(a)){var b=[],c;for(c in Object(a))w.call(a,c)&&"constructor"!=
c&&b.push(c);a=b}else a=Ld(a);return a}function ja(a){if(L(a))a=Db(a,!0);else if(y(a)){var b=jb(a),c=[];for(d in a)("constructor"!=d||!b&&w.call(a,d))&&c.push(d);a=c}else{var d=[];if(null!=a)for(b in Object(a))d.push(b);a=d}return a}function uc(a){return null==a?[]:Nc(a,G(a))}function xc(a){return function(){return a}}function ba(a){return a}function ib(a){return Ob("function"==typeof a?a:Fa(a,1))}function mb(a,b,c){var d=G(b),e=Jb(b,d);null!=c||y(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Jb(b,
G(b)));var g=!(y(c)&&"chain"in c)||!!c.chain,f=ka(a);C(e,function(c){var d=b[c];a[c]=d;f&&(a.prototype[c]=function(){var b=this.__chain__;if(g||b){var c=a(this.__wrapped__);(c.__actions__=M(this.__actions__)).push({func:d,args:arguments,thisArg:a});c.__chain__=b;return c}return d.apply(a,W([this.value()],arguments))})});return a}function nb(){}function Pb(a){return cb(a)?Lc(Z(a)):kd(a)}function ob(){return[]}function yc(){return!1}var k,na=1/0,wc=0/0,Bd=[["ary",128],["bind",1],["bindKey",2],["curry",
8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],vd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ud=/^\w*$/,Md=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gd=/^\s+|\s+$/g,zd=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wd=/\{\n\/\* \[wrapped with (.+)\] \*/,xd=/,? & /,Nd=/\\(\\)?/g,sd=/\w*$/,Kd=/^[-+]0x[0-9a-f]+$/i,Hd=/^0b[01]+$/i,rd=/^\[object .+?Constructor\]$/,Id=/^0o[0-7]+$/i,td=/^(?:0|[1-9]\d*)$/,Fd=
/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]?|[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Ed=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff\ufe0e\ufe0f]/,
u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0;u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=
u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1;var t={};t["[object Arguments]"]=t["[object Array]"]=t["[object ArrayBuffer]"]=t["[object DataView]"]=t["[object Boolean]"]=t["[object Date]"]=t["[object Float32Array]"]=t["[object Float64Array]"]=t["[object Int8Array]"]=t["[object Int16Array]"]=t["[object Int32Array]"]=t["[object Map]"]=t["[object Number]"]=t["[object Object]"]=t["[object RegExp]"]=t["[object Set]"]=t["[object String]"]=t["[object Symbol]"]=t["[object Uint8Array]"]=
t["[object Uint8ClampedArray]"]=t["[object Uint16Array]"]=t["[object Uint32Array]"]=!0;t["[object Error]"]=t["[object Function]"]=t["[object WeakMap]"]=!1;var Jd=parseInt,zc="object"==typeof global&&global&&global.Object===Object&&global,Od="object"==typeof self&&self&&self.Object===Object&&self,B=zc||Od||Function("return this")(),pb="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ra=pb&&"object"==typeof module&&module&&!module.nodeType&&module,Ac=Ra&&Ra.exports===pb,qb=Ac&&zc.process;
a:{try{var V=qb&&qb.binding&&qb.binding("util");break a}catch(a){}V=void 0}var Bc=V&&V.isMap,Cc=V&&V.isSet,Dc=V&&V.isTypedArray,rb=Array.prototype,Ma=Object.prototype,sb=B["__core-js_shared__"],nc=Function.prototype.toString,w=Ma.hasOwnProperty,hc=function(){var a=/[^.]+$/.exec(sb&&sb.keys&&sb.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Lb=Ma.toString,qd=RegExp("^"+nc.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+
"$"),Sa=Ac?B.Buffer:k,O=B.Symbol,Ia=B.Uint8Array,Yb=Sa?Sa.allocUnsafe:k,jc=Bb(Object.getPrototypeOf,Object),Ec=Object.create,Fc=Ma.propertyIsEnumerable,Pd=rb.splice,kc=O?O.isConcatSpreadable:k,ra=O?O.iterator:k,R=O?O.toStringTag:k,Ea=function(){try{var a=T(Object,"defineProperty");a({},"",{});return a}catch(b){}}(),tb=Object.getOwnPropertySymbols,Qd=Sa?Sa.isBuffer:k,Ld=Bb(Object.keys,Object),H=Math.max,S=Math.min,Ad=Date.now,Cd=rb.reverse,ub=T(B,"DataView"),sa=T(B,"Map"),vb=T(B,"Promise"),ca=T(B,
"Set"),ta=T(B,"WeakMap"),ua=T(Object,"create"),Ta=ta&&new ta,pa={},Rd=U(ub),Sd=U(sa),Td=U(vb),Ud=U(ca),Vd=U(ta),Ua=O?O.prototype:k,qa=Ua?Ua.valueOf:k,Vb=Ua?Ua.toString:k,Ja=function(){function a(){}return function(b){if(!y(b))return{};if(Ec)return Ec(b);a.prototype=b;b=new a;a.prototype=k;return b}}();f.prototype=Aa.prototype;f.prototype.constructor=f;E.prototype=Ja(Aa.prototype);E.prototype.constructor=E;q.prototype=Ja(Aa.prototype);q.prototype.constructor=q;P.prototype.clear=function(){this.__data__=
ua?ua(null):{};this.size=0};P.prototype["delete"]=function(a){a=this.has(a)&&delete this.__data__[a];this.size-=a?1:0;return a};P.prototype.get=function(a){var b=this.__data__;return ua?(a=b[a],"__lodash_hash_undefined__"===a?k:a):w.call(b,a)?b[a]:k};P.prototype.has=function(a){var b=this.__data__;return ua?b[a]!==k:w.call(b,a)};P.prototype.set=function(a,b){var c=this.__data__;this.size+=this.has(a)?0:1;c[a]=ua&&b===k?"__lodash_hash_undefined__":b;return this};J.prototype.clear=function(){this.__data__=
[];this.size=0};J.prototype["delete"]=function(a){var b=this.__data__;a=Da(b,a);if(0>a)return!1;a==b.length-1?b.pop():Pd.call(b,a,1);--this.size;return!0};J.prototype.get=function(a){var b=this.__data__;a=Da(b,a);return 0>a?k:b[a][1]};J.prototype.has=function(a){return-1<Da(this.__data__,a)};J.prototype.set=function(a,b){var c=this.__data__,d=Da(c,a);0>d?(++this.size,c.push([a,b])):c[d][1]=b;return this};K.prototype.clear=function(){this.size=0;this.__data__={hash:new P,map:new (sa||J),string:new P}};
K.prototype["delete"]=function(a){a=La(this,a)["delete"](a);this.size-=a?1:0;return a};K.prototype.get=function(a){return La(this,a).get(a)};K.prototype.has=function(a){return La(this,a).has(a)};K.prototype.set=function(a,b){var c=La(this,a),d=c.size;c.set(a,b);this.size+=c.size==d?0:1;return this};X.prototype.add=X.prototype.push=function(a){this.__data__.set(a,"__lodash_hash_undefined__");return this};X.prototype.has=function(a){return this.__data__.has(a)};F.prototype.clear=function(){this.__data__=
new J;this.size=0};F.prototype["delete"]=function(a){var b=this.__data__;a=b["delete"](a);this.size=b.size;return a};F.prototype.get=function(a){return this.__data__.get(a)};F.prototype.has=function(a){return this.__data__.has(a)};F.prototype.set=function(a,b){var c=this.__data__;if(c instanceof J){var d=c.__data__;if(!sa||199>d.length)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new K(d)}c.set(a,b);this.size=c.size;return this};var Y=function(a,b){return function(c,d){if(null==c)return c;
if(!L(c))return a(c,d);for(var e=c.length,g=b?e:-1,f=Object(c);(b?g--:++g<e)&&!1!==d(f[g],g,f););return c}}(Ga),Zc=function(a){return function(b,c,d){var e=-1,g=Object(b);d=d(b);for(var f=d.length;f--;){var h=d[a?f:++e];if(!1===c(g[h],h,g))break}return b}}(),Gc=Ta?function(a,b){Ta.set(a,b);return a}:ba,Wd=Ea?function(a,b){return Ea(a,"toString",{configurable:!0,enumerable:!1,value:xc(b),writable:!0})}:ba,Xd=ca&&1/za(new ca([,-0]))[1]==na?function(a){return new ca(a)}:nb,cc=Ta?function(a){return Ta.get(a)}:
nb,gb=tb?function(a){if(null==a)return[];a=Object(a);return wa(tb(a),function(b){return Fc.call(a,b)})}:ob,ac=tb?function(a){for(var b=[];a;)W(b,gb(a)),a=jc(a);return b}:ob,A=Q;if(ub&&"[object DataView]"!=A(new ub(new ArrayBuffer(1)))||sa&&"[object Map]"!=A(new sa)||vb&&"[object Promise]"!=A(vb.resolve())||ca&&"[object Set]"!=A(new ca)||ta&&"[object WeakMap]"!=A(new ta))A=function(a){var b=Q(a);if(a=(a="[object Object]"==b?a.constructor:k)?U(a):"")switch(a){case Rd:return"[object DataView]";case Sd:return"[object Map]";
case Td:return"[object Promise]";case Ud:return"[object Set]";case Vd:return"[object WeakMap]"}return b};var dc=mc(Gc),eb=mc(Wd),md=function(a){a=Oa(a,function(a){500===b.size&&b.clear();return a});var b=a.cache;return a}(function(a){var b=[];46===a.charCodeAt(0)&&b.push("");a.replace(Md,function(a,d,e,g){b.push(e?g.replace(Nd,"$1"):d||a)});return b}),Yd=la(function(a,b){return Pa(a)?Hb(a,$a(b,1,Pa,!0)):[]}),Zd=la(function(a,b){return Pa(a)?Hb(a,b):[]});fc(function(a){var b=a.length,c=b?a[0]:0,d=
this.__wrapped__,e=function(b){for(var c=-1,d=a.length,e=Array(d),g=null==b;++c<d;)e[c]=g?k:db(b,a[c]);return e};if(1<b||this.__actions__.length||!(d instanceof q)||!fa(c))return this.thru(e);d=d.slice(c,+c+(b?1:0));d.__actions__.push({func:Na,args:[e],thisArg:k});return(new E(d,this.__chain__)).thru(function(a){b&&!a.length&&a.push(k);return a})});var $d=function(a){return function(b,c,d){var e=Object(b);if(!L(b)){var g=D(c,3);b=G(b);c=function(a){return g(e[a],a,e)}}c=a(b,c,d);return-1<c?e[g?b[c]:
c]:k}}(oc),ae=function(a,b){return function(c,d){var e=v(c)?Ic:Oc,g=b?b():{};return e(c,a,D(d,2),g)}}(function(a,b,c){w.call(a,c)?a[c].push(b):Ca(a,c,[b])}),Va=function(){return B.Date.now()},Wa=la(function(a,b,c){var d=1;if(c.length){var e=da(c,hb(Wa));d|=32}var g=b,f=c,h=e,n=void 0,q=void 0;c=d&2;if(!c&&"function"!=typeof a)throw new TypeError("Expected a function");b=f?f.length:0;b||(d&=-97,f=h=k);n=n===k?n:H(N(n),0);q=q===k?q:N(q);b-=h?h.length:0;if(d&64){var l=f,p=h;f=h=k}e=c?k:cc(a);l=[a,d,
g,f,h,l,p,void 0,n,q];if(e&&(p=l[1],a=e[1],d=p|a,g=128==a&&8==p||128==a&&256==p&&l[7].length<=e[8]||384==a&&e[7].length<=e[8]&&8==p,131>d||g)){a&1&&(l[2]=e[2],d|=p&1?0:4);if(p=e[3])g=l[3],l[3]=g?Zb(g,p,e[4]):p,l[4]=g?da(l[3],"__lodash_placeholder__"):e[4];if(p=e[5])g=l[5],l[5]=g?$b(g,p,e[6]):p,l[6]=g?da(l[5],"__lodash_placeholder__"):e[6];(p=e[7])&&(l[7]=p);a&128&&(l[8]=null==l[8]?e[8]:S(l[8],e[8]));null==l[9]&&(l[9]=e[9]);l[0]=e[0];l[1]=d}a=l[0];d=l[1];g=l[2];f=l[3];h=l[4];q=l[9]=l[9]===k?c?0:a.length:
H(l[9]-b,0);!q&&d&24&&(d&=-25);c=d&&1!=d?8==d||16==d?od(a,d,q):32!=d&&33!=d||h.length?Ka.apply(k,l):pd(a,d,g,f):nd(a,d,g);return ec((e?Gc:dc)(c,l),a,d)});Oa.Cache=K;var Ba=Mb(function(){return arguments}())?Mb:function(a){return x(a)&&w.call(a,"callee")&&!Fc.call(a,"callee")},v=Array.isArray,ea=Qd||yc,Gb=Bc?ya(Bc):cd,Fb=Cc?ya(Cc):ed,Ya=Dc?ya(Dc):fd,Hc=function(a){return la(function(b,c){var d=-1,e=c.length,g=1<e?c[e-1]:k,f=2<e?c[2]:k;g=3<a.length&&"function"==typeof g?(e--,g):k;f&&lc(c[0],c[1],f)&&
(g=3>e?k:g,e=1);for(b=Object(b);++d<e;)(f=c[d])&&a(b,f,d,g);return b})}(function(a,b){ia(b,ja(b),a)}),be=fc(function(a,b){C(b,function(b){b=Z(b);Ca(a,b,Wa(a[b],a))});return a});f.assignIn=Hc;f.bind=Wa;f.bindAll=be;f.chain=qc;f.compact=function(a){for(var b=-1,c=null==a?0:a.length,d=0,e=[];++b<c;){var g=a[b];g&&(e[d++]=g)}return e};f.constant=xc;f.debounce=function(a,b,c){function d(b){var c=n,d=q;n=q=k;t=b;return l=a.apply(d,c)}function e(a){var c=a-r;a-=t;return r===k||c>=b||0>c||u&&a>=x}function g(){var a=
Va();if(e(a))return f(a);var c=setTimeout;var d=a-t;a=b-(a-r);d=u?S(a,x-d):a;p=c(g,d)}function f(a){p=k;if(w&&n)return d(a);n=q=k;return l}function h(){var a=Va(),c=e(a);n=arguments;q=this;r=a;if(c){if(p===k)return t=a=r,p=setTimeout(g,b),v?d(a):l;if(u)return p=setTimeout(g,b),d(r)}p===k&&(p=setTimeout(g,b));return l}var n,q,l,p,r,t=0,v=!1,u=!1,w=!0;if("function"!=typeof a)throw new TypeError("Expected a function");b=Qa(b)||0;if(y(c)){v=!!c.leading;var x=(u="maxWait"in c)?H(Qa(c.maxWait)||0,b):x;
w="trailing"in c?!!c.trailing:w}h.cancel=function(){p!==k&&clearTimeout(p);t=0;n=r=q=p=k};h.flush=function(){return p===k?l:f(Va())};return h};f.difference=Yd;f.filter=function(a,b){return(v(a)?wa:Ib)(a,D(b,3))};f.flatten=gc;f.groupBy=ae;f.iteratee=ib;f.keys=G;f.keysIn=ja;f.map=function(a,b){return(v(a)?xa:id)(a,D(b,3))};f.memoize=Oa;f.mixin=mb;f.negate=lb;f.property=Pb;f.reject=function(a,b){return(v(a)?wa:Ib)(a,lb(D(b,3)))};f.reverse=kb;f.take=function(a,b,c){if(!a||!a.length)return[];b=c||b===
k?1:N(b);return Tb(a,0,0>b?0:b)};f.tap=function(a,b){b(a);return a};f.thru=Na;f.toArray=tc;f.uniq=function(a){if(a&&a.length)a:{var b=-1,c=Xa,d=a.length,e=!0,f=[];if(200<=d){if(c=Xd(a)){a=za(c);break a}e=!1;c=zb;var m=new X}else m=f;b:for(;++b<d;){var h=a[b],k=h;h=0!==h?h:0;if(e&&k===k){for(var q=m.length;q--;)if(m[q]===k)continue b;f.push(h)}else c(m,k,void 0)||(m!==f&&m.push(k),f.push(h))}a=f}else a=[];return a};f.values=uc;f.without=Zd;f.extend=Hc;mb(f,f);f.eq=ha;f.find=$d;f.findIndex=oc;f.forEach=
rc;f.get=db;f.has=function(a,b){return null!=a&&ic(a,b,$c)};f.hasIn=Rb;f.identity=ba;f.isArguments=Ba;f.isArray=v;f.isArrayLike=L;f.isArrayLikeObject=Pa;f.isBuffer=ea;f.isFunction=ka;f.isLength=Ha;f.isMap=Gb;f.isObject=y;f.isObjectLike=x;f.isSet=Fb;f.isString=sc;f.isSymbol=ma;f.isTypedArray=Ya;f.last=pc;f.stubArray=ob;f.stubFalse=yc;f.noop=nb;f.now=Va;f.reduce=function(a,b,c){var d=v(a)?xb:Mc,e=3>arguments.length;return d(a,D(b,4),c,e,Y)};f.some=function(a,b,c){var d=v(a)?yb:ld;c&&lc(a,b,c)&&(b=k);
return d(a,D(b,3))};f.toFinite=vc;f.toInteger=N;f.toNumber=Qa;f.toString=Xb;f.each=rc;mb(f,function(){var a={};Ga(f,function(b,c){w.call(f.prototype,c)||(a[c]=b)});return a}(),{chain:!1});f.VERSION="4.17.5";Wa.placeholder=f;C(["drop","take"],function(a,b){q.prototype[a]=function(c){c=c===k?1:H(N(c),0);var d=this.__filtered__&&!b?new q(this):this.clone();d.__filtered__?d.__takeCount__=S(c,d.__takeCount__):d.__views__.push({size:S(c,4294967295),type:a+(0>d.__dir__?"Right":"")});return d};q.prototype[a+
"Right"]=function(b){return this.reverse()[a](b).reverse()}});C(["filter","map","takeWhile"],function(a,b){var c=b+1,d=1==c||3==c;q.prototype[a]=function(a){var b=this.clone();b.__iteratees__.push({iteratee:D(a,3),type:c});b.__filtered__=b.__filtered__||d;return b}});C(["head","last"],function(a,b){var c="take"+(b?"Right":"");q.prototype[a]=function(){return this[c](1).value()[0]}});C(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");q.prototype[a]=function(){return this.__filtered__?new q(this):
this[c](1)}});q.prototype.compact=function(){return this.filter(ba)};q.prototype.find=function(a){return this.filter(a).head()};q.prototype.findLast=function(a){return this.reverse().find(a)};q.prototype.invokeMap=la(function(a,b){return"function"==typeof a?new q(this):this.map(function(c){var d=a;d=bb(d,c);c=2>d.length?c:ab(c,Tb(d,0,-1));d=null==c?c:c[Z(pc(d))];return null==d?k:va(d,c,b)})});q.prototype.reject=function(a){return this.filter(lb(D(a)))};q.prototype.slice=function(a,b){a=N(a);var c=
this;if(c.__filtered__&&(0<a||0>b))return new q(c);0>a?c=c.takeRight(-a):a&&(c=c.drop(a));b!==k&&(b=N(b),c=0>b?c.dropRight(-b):c.take(b-a));return c};q.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()};q.prototype.toArray=function(){return this.take(4294967295)};Ga(q.prototype,function(a,b){var c=/^(?:filter|find|map|reject)|While$/.test(b),d=/^(?:head|last)$/.test(b),e=f[d?"take"+("last"==b?"Right":""):b],g=d||/^find/.test(b);e&&(f.prototype[b]=function(){var b=this.__wrapped__,
h=d?[1]:arguments,n=b instanceof q,t=h[0],l=n||v(b),p=function(a){a=e.apply(f,W([a],h));return d&&r?a[0]:a};l&&c&&"function"==typeof t&&1!=t.length&&(n=l=!1);var r=this.__chain__,u=!!this.__actions__.length;t=g&&!r;n=n&&!u;if(!g&&l)return b=n?b:new q(this),b=a.apply(b,h),b.__actions__.push({func:Na,args:[p],thisArg:k}),new E(b,r);if(t&&n)return a.apply(this,h);b=this.thru(p);return t?d?b.value()[0]:b.value():b})});C("pop push shift sort splice unshift".split(" "),function(a){var b=rb[a],c=/^(?:push|sort|unshift)$/.test(a)?
"tap":"thru",d=/^(?:pop|shift)$/.test(a);f.prototype[a]=function(){var a=arguments;if(d&&!this.__chain__){var f=this.value();return b.apply(v(f)?f:[],a)}return this[c](function(c){return b.apply(v(c)?c:[],a)})}});Ga(q.prototype,function(a,b){if(a=f[b]){var c=a.name+"";(pa[c]||(pa[c]=[])).push({name:b,func:a})}});pa[Ka(k,2).name]=[{name:"wrapper",func:k}];q.prototype.clone=function(){var a=new q(this.__wrapped__);a.__actions__=M(this.__actions__);a.__dir__=this.__dir__;a.__filtered__=this.__filtered__;
a.__iteratees__=M(this.__iteratees__);a.__takeCount__=this.__takeCount__;a.__views__=M(this.__views__);return a};q.prototype.reverse=function(){if(this.__filtered__){var a=new q(this);a.__dir__=-1;a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a};q.prototype.value=function(){var a=this.__wrapped__.value(),b=this.__dir__,c=v(a),d=0>b,e=c?a.length:0;var f=0;for(var k=e,h=this.__views__,n=-1,q=h.length;++n<q;){var l=h[n],p=l.size;switch(l.type){case "drop":f+=p;break;case "dropRight":k-=
p;break;case "take":k=S(k,f+p);break;case "takeRight":f=H(f,k-p)}}h=k;k=h-f;f=d?h:f-1;h=this.__iteratees__;n=h.length;q=0;l=S(k,this.__takeCount__);if(!c||!d&&e==k&&l==k)return Wb(a,this.__actions__);c=[];a:for(;k--&&q<l;){f+=b;d=-1;for(e=a[f];++d<n;){var r=h[d];p=r.iteratee;r=r.type;p=p(e);if(2==r)e=p;else if(!p)if(1==r)continue a;else break a}c[q++]=e}return c};f.prototype.chain=function(){return qc(this)};f.prototype.commit=function(){return new E(this.value(),this.__chain__)};f.prototype.next=
function(){this.__values__===k&&(this.__values__=tc(this.value()));var a=this.__index__>=this.__values__.length,b=a?k:this.__values__[this.__index__++];return{done:a,value:b}};f.prototype.plant=function(a){for(var b,c=this;c instanceof Aa;){var d=Cb(c);d.__index__=0;d.__values__=k;b?e.__wrapped__=d:b=d;var e=d;c=c.__wrapped__}e.__wrapped__=a;return b};f.prototype.reverse=function(){var a=this.__wrapped__;return a instanceof q?(this.__actions__.length&&(a=new q(this)),a=a.reverse(),a.__actions__.push({func:Na,
args:[kb],thisArg:k}),new E(a,this.__chain__)):this.thru(kb)};f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=function(){return Wb(this.__wrapped__,this.__actions__)};f.prototype.first=f.prototype.head;ra&&(f.prototype[ra]=Dd);"function"==typeof define?(B.__jira_integration_plugin_lodash__=f,define("jira-integration-plugin/custom-lodash",function(){return f})):Ra?((Ra.exports=f)._=f,pb._=f):B.__jira_integration_plugin_lodash__=f}).call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.soy' */
// This file was automatically generated from fields.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.fields.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.fields == 'undefined') { jiraIntegration.templates.fields = {}; }


jiraIntegration.templates.fields.stringField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.stringField.soyTemplateName = 'jiraIntegration.templates.fields.stringField';
}


jiraIntegration.templates.fields.textareaField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><textarea rows="3" id="' + soy.$$escapeHtml(opt_data.name) + '" class="textarea long-field" data-name="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>' + soy.$$escapeHtml(opt_data.value) + '</textarea>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.textareaField.soyTemplateName = 'jiraIntegration.templates.fields.textareaField';
}


jiraIntegration.templates.fields.arrayField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.arrayField.soyTemplateName = 'jiraIntegration.templates.fields.arrayField';
}


jiraIntegration.templates.fields.numberField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.numberField.soyTemplateName = 'jiraIntegration.templates.fields.numberField';
}


jiraIntegration.templates.fields.allowedValuesField = function(opt_data, opt_ignored) {
  return '' + ((opt_data.options.length) ? jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'select'})) : jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'value', value: 'None'})));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.allowedValuesField.soyTemplateName = 'jiraIntegration.templates.fields.allowedValuesField';
}


jiraIntegration.templates.fields.timeTrackingField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.timeTrackingField.soyTemplateName = 'jiraIntegration.templates.fields.timeTrackingField';
}


jiraIntegration.templates.fields.radioField = function(opt_data, opt_ignored) {
  return '' + aui.form.radioField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.radioField.soyTemplateName = 'jiraIntegration.templates.fields.radioField';
}


jiraIntegration.templates.fields.unrenderableTypeField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field jira-field-unrenderable' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><label>' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label>' + aui.form.value({content: opt_data.reasonContent}) + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.unrenderableTypeField.soyTemplateName = 'jiraIntegration.templates.fields.unrenderableTypeField';
}


jiraIntegration.templates.fields.dateField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.dateField.soyTemplateName = 'jiraIntegration.templates.fields.dateField';
}


jiraIntegration.templates.fields.checkboxField = function(opt_data, opt_ignored) {
  return '' + aui.form.checkboxField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.checkboxField.soyTemplateName = 'jiraIntegration.templates.fields.checkboxField';
}


jiraIntegration.templates.fields.select2WithIconField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><select id="' + soy.$$escapeHtml(opt_data.name) + '" class="medium-field" name="' + soy.$$escapeHtml(opt_data.name) + '" data-name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>';
  var optionList112 = opt_data.options;
  var optionListLen112 = optionList112.length;
  for (var optionIndex112 = 0; optionIndex112 < optionListLen112; optionIndex112++) {
    var optionData112 = optionList112[optionIndex112];
    output += '<option value="' + soy.$$escapeHtml(optionData112.value) + '" ' + ((optionData112.selected) ? 'selected' : '') + ' data-icon-url="' + soy.$$escapeHtml(optionData112.iconUrl) + '">' + soy.$$escapeHtml(optionData112.text) + '</option>';
  }
  output += '</select>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconField.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconField';
}


jiraIntegration.templates.fields.select2WithIconOption = function(opt_data, opt_ignored) {
  return ((opt_data.iconUrl) ? aui.avatar.avatar({avatarImageUrl: opt_data.iconUrl, size: 'xsmall', isProject: opt_data.isProject, extraClasses: 'select-option-image', tagName: 'span'}) : '') + '<span class="select-option" title="' + soy.$$escapeHtml(opt_data.optionValue) + '">' + soy.$$escapeHtml(opt_data.optionValue) + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconOption.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconOption';
}


jiraIntegration.templates.fields.labelFieldResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - (New label)',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.labelFieldResult.soyTemplateName = 'jiraIntegration.templates.fields.labelFieldResult';
}


jiraIntegration.templates.fields.userOptionSelect = function(opt_data, opt_ignored) {
  var output = '';
  var userOption__soy150 = '' + soy.$$escapeHtml(opt_data.displayName) + ((! opt_data.isSystemOption) ? ' - (' + soy.$$escapeHtml(opt_data.name) + ')' : '');
  output += '<span data-value="' + soy.$$escapeHtml(opt_data.name) + '" title="' + soy.$$filterNoAutoescape(userOption__soy150) + '">' + soy.$$filterNoAutoescape(userOption__soy150) + '</span>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.userOptionSelect.soyTemplateName = 'jiraIntegration.templates.fields.userOptionSelect';
}


jiraIntegration.templates.fields.sprintSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '<span class="sprint-detail">' + ((opt_data.state == 'FUTURE') ? soy.$$escapeHtml(AJS.format('(Future sprint in {0})',opt_data.board)) : '') + ((opt_data.state == 'ACTIVE') ? soy.$$escapeHtml(AJS.format('(Active sprint in {0})',opt_data.board)) : '') + '</span></span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.sprintSelect.soyTemplateName = 'jiraIntegration.templates.fields.sprintSelect';
}


jiraIntegration.templates.fields.epicSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + ' (' + soy.$$escapeHtml(opt_data.key) + ')">' + soy.$$escapeHtml(opt_data.name) + ((opt_data.key) ? '<span class="epic-detail">' + soy.$$escapeHtml(opt_data.key) + '</span>' : '') + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.epicSelect.soyTemplateName = 'jiraIntegration.templates.fields.epicSelect';
}


jiraIntegration.templates.fields.errors = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.errorTexts) {
    var errorList195 = opt_data.errorTexts;
    var errorListLen195 = errorList195.length;
    for (var errorIndex195 = 0; errorIndex195 < errorListLen195; errorIndex195++) {
      var errorData195 = errorList195[errorIndex195];
      output += '<div class="error">' + soy.$$escapeHtml(errorData195) + '</div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.errors.soyTemplateName = 'jiraIntegration.templates.fields.errors';
}


jiraIntegration.templates.fields.fieldWithExtraAttributes = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type=' + soy.$$escapeHtml(opt_data.jiraType) + '>' + aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: '' + soy.$$escapeHtml(opt_data.labelText)});
  switch (opt_data.type) {
    case 'select':
      output += aui.form.select({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), options: opt_data.options, isRequired: opt_data.isRequired, isMultiple: opt_data.isMultiple, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
      break;
    case 'value':
      output += aui.form.value({id: opt_data.name, content: '' + soy.$$escapeHtml(opt_data.value)});
      break;
    default:
      output += aui.form.input({id: opt_data.name, name: opt_data.name, type: 'text', value: opt_data.value, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
  }
  output += jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.fieldWithExtraAttributes.soyTemplateName = 'jiraIntegration.templates.fields.fieldWithExtraAttributes';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.js' */
define("jira-integration-plugin/fields",["jquery","jira-integration-plugin/custom-lodash","jira-integration-plugin/label-picker"],function(h,g,W){function D(a,b,c,d){var e=b.schema.system||"customfield_"+b.schema.customId,k=b.schema.system||b.schema.custom||b.schema.customId,l=p[k],E=!(!l||l.canRender&&!l.canRender(b)),F=!(!b.operations||!b.operations.length);l=E&&F?l:X;return l.getContext({labelText:b.name,name:e,isRequired:b.required,value:c[e],errorTexts:d[e],jiraType:k,isRenderable:E,hasOperations:F,
handler:l,extraAttributes:b.required&&{"data-aui-validation-field":"",required:!0}},b,a,c)}function n(a,b,c){var d=a.name;a.value=(h.isPlainObject(a.value)?a.value.name:a.value)||c&&c.fields[d]||b&&b.defaultValue||"";return a}function t(a){return a.val()}function G(a){a=a.val();return/\d/.test(a)&&/^-?\d*\.?\d*$/.test(a)?Number(a):a||null}function H(a,b,c){var d=a.name;a.value=a.value&&a.value.join(",")||c&&c.fields[d]&&c.fields[d].join(",")||b&&b.defaultValue&&b.defaultValue.join(" ");return a}function I(a){return g.map(a.val().split(","),
h.trim)}function J(a,b,c){function d(a){return Array.isArray(a)?a.map(function(a){return a.name||a.id}):[a.name||a.id]}var e=a.name,k=a.value;c=c&&c.fields[e];e=b&&b.defaultValue;var l=k?d(k):c?d(c):e?d(e):[];a.options=g.map(b.allowedValues,function(a){return{value:a.id,text:a.name||a.value,selected:l.includes(a.name||a.id)}});b.required||"option"!==b.schema.type||a.options.unshift({value:-1,text:"None"});a.isMultiple=b.operations.includes("add");delete a.value;
return a}function x(a,b){var c=b.val(),d=function(b){var c={};c[a]=b;return c};return b.attr("multiple")?Array.isArray(c)?g.map(c,d):[d(c)]:d(c)}function K(a,b,c){var d=a.name;a.value=a.value&&a.value.name||c&&c.fields[d]&&c.fields[d].name||("assignee"===q(b)?-1:"")||b&&b.defaultValue&&b.defaultValue.name;a.extraClasses="array"===b.schema.type?"multi-user-picker":"single-user-picker";return a}function L(a,b,c){var d=a.value||c&&c.fields[a.name]||b&&b.defaultValue;a.fields=g.map(b.allowedValues,function(a){return{id:a.id,
value:a.id,labelText:a.name||a.value,isChecked:Array.isArray(d)?d.some(function(b){return b.id===a.id}):d&&d.id===a.id}});delete a.value;return a}function M(a){return a.find("input:checked").toArray().map(function(a){a=h(a);return{id:a.attr("value"),value:a.parent().find("label").text()}})}function y(a,b,c,d,e){var k=a.find("input"),l=a.attr("name");k.removeClass("text").removeClass("long-field").addClass("medium-long-field");k.auiSelect2(h.extend({minimumInputLength:1,id:l,name:l,query:function(a){r(b,
c,a.term,d).done(function(b){a.callback({results:b})})}},e));(e=k.auiSelect2("data"))&&-1!==e.id&&k.auiSelect2("val",e.id);a.find("div.aui-select2-container").addClass("jira-select2-drop-box")}function N(a,b,c,d,e){e=h.extend({},e,{multiple:"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker"===c,formatResult:function(a){return f.fields.userOptionSelect({name:a.id,displayName:a.text,isSystemOption:!!a.isSystemOption})}});y(a,b,c,d,e)}function r(a,b,c,d){a=h.extend({restType:b,issueKey:d&&
d.key||"",term:c},a);return h.ajax({type:"POST",timeout:0,contentType:"application/json",dataType:"json",url:AJS.contextPath()+"/rest/jira-integration/latest/fields/autocomplete",data:JSON.stringify(a)})}function O(a){var b;a.id&&(b=h(a.element).attr("data-icon-url"));return f.fields.select2WithIconOption({optionValue:a.text,iconUrl:b})}function z(a){return(a=a.auiSelect2("data"))&&-1===a.id?void 0:a}function q(a){return a.schema?a.schema.system||a.schema.custom||a.schema.customId:a}function A(a){return p[q(a)]}
function P(a){return(a=Q(a))&&A(a)}function Q(a){return a.closest(".jira-field").attr("data-jira-type")}function Y(a,b){return h.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueType+"/fields-meta"}).pipe(function(a){var c=[];g.each(a.fields,function(a){var d=q(a);a.required&&!b.excludedFields.includes(d)&&c.push(a)});return c})}function R(a,b,c){var d=Q(a),e=d&&A(d);(e=e&&e.behavior)&&e(a,b,d,c)}function S(a){var b=
P(a);return b&&b.getValue&&b.getValue(a)}function u(a,b){return function(c,d){c=a[c.attr("id")];d(c||b)}}var f=window.jiraIntegration.templates,v={template:f.fields.stringField,getContext:n,getValue:t},Z={template:f.fields.stringField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"([a-zA-Z][a-zA-Z0-9-+.]*://.+)|^$","data-aui-validation-pattern-msg":"Enter a valid URL scheme"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},getValue:t},aa=
{template:f.fields.stringField,getContext:K,getInternalValue:z,getValue:function(a){a=a.val();if("-1"!==a)return{name:a}},behavior:function(a,b,c,d){var e={minimumInputLength:0,initSelection:u(b,{id:-1,text:"Automatic",isSystemOption:!0}),query:function(a){function e(b){1===a.page&&(a.element.prop("required")||b.unshift({id:"",text:"Unassigned",isSystemOption:!0}),b.unshift({id:-1,text:"Automatic",isSystemOption:!0}));
a.callback({results:b})}0<a.term.length?r(b,c,a.term,d).done(e):e([])}};N(a,b,c,d,e)}},B={template:f.fields.stringField,getContext:K,getValue:function(a){var b=function(a){return{name:a}},c=a.val();a=a.closest(".jira-field").is(".multi-user-picker");return c?a?g.map(c.split(","),b):b(c):a?[]:null},behavior:function(a,b,c,d){var e=a.find(".long-field").attr("value")||"";e={formatInputTooShort:function(){return "Find users..."},initSelection:u(b,{id:-1,text:e,isSystemOption:!1})};
N(a,b,c,d,e)}},ba={template:f.fields.arrayField,getContext:H,getValue:I,behavior:function(a,b,c,d){a=a.find("input");W.build(a,function(a){return r(b,c,a,d)})}},C={template:f.fields.textareaField,getContext:n,getValue:t},ca={template:f.fields.numberField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"(([0-9]*[.])?[0-9]+)|^$","data-aui-validation-pattern-msg":"Enter a valid number"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},getValue:G},
T={template:f.fields.arrayField,getContext:H,getValue:I},m={template:f.fields.allowedValuesField,getContext:J,getValue:g.bind(x,null,"id"),behavior:function(a){a.find("select[multiple]").auiSelect2()}},U={template:f.fields.allowedValuesField,getContext:J,getValue:g.bind(x,null,"id")},da={template:f.fields.timeTrackingField,getContext:function(a,b,c){b={"data-aui-validation-field":"",pattern:"(([0-9]+w|[0-9]+d|[0-9]+m|[0-9]+h|[0-9]+)\\s*)*","data-aui-validation-pattern-msg":"Enter a valid time estimate (eg. 3w 4d 12h)"};
a.value=a.value&&a.value.remainingEstimate||c&&c.fields[name]&&c.fields[name].remainingEstimate||"";return h.extend(!0,{},a,{extraAttributes:b})},getValue:function(a){return{remainingEstimate:a.val()}}},V={template:f.fields.dateField,getContext:function(a,b,c){var d={"data-aui-validation-field":"",pattern:"^([0-9]{2,4}-(0?[1-9]|10|11|12)-([0-2]?[1-9]|10|20|30|31))$|^$","data-aui-validation-pattern-msg":"Enter a valid date"};return h.extend(!0,{},n(a,b,c),{extraAttributes:d})},
getValue:function(a){a=a.val();return""===a?null:a},behavior:function(a){var b=a.find("input");navigator.userAgent.match(/Trident/)&&"5.3.5">AJS.version?(a="placeholder"in document.createElement("input"),b.attr("placeholder","YYYY-MM-DD"),a||b.on("focus",function(){b.val()===b.attr("placeholder")&&b.val("")}).on("blur",function(){""===b.val()&&b.val(b.attr("placeholder"))}).blur()):WRM.require("wr!com.atlassian.auiplugin:aui-date-picker").done(function(){b.datePicker({overrideBrowserDefault:!0})})}},
ea={template:f.fields.select2WithIconField,getContext:function(a,b,c){var d=a.name,e=a.value&&a.value.id||b&&b.defaultValue&&b.defaultValue.id||"",k=a.value&&a.value.name||c&&c.fields&&c.fields[d]&&c.fields[d].name||b&&b.defaultValue&&b.defaultValue.id||"";delete a.value;a.options=g.map(b.allowedValues,function(a){return{value:a.id,text:a.name,selected:k===a.name||e===a.id,iconUrl:a.iconUrl}});return a},getValue:g.bind(x,null,"id"),behavior:function(a,b,c,d){h.fn.auiSelect2?(a=a.find("select"),a.addClass("jira-select2-drop-box"),
a.auiSelect2({hasAvatar:!0,minimumResultsForSearch:-1,formatSelection:O,formatResult:O})):AJS.log("AUI version 5.2 or greater is required as this plugin needs the .auiSelect2() jQuery plugin.")}},X={template:f.fields.unrenderableTypeField,getContext:function(a,b,c){a.reasonContent=a.isRenderable?a.hasOperations?null:c?AJS.format("{0}Edit{1} this field in Jira.",'\x3ca href\x3d"'+c.url+'"\x3e',"\x3c/a\x3e"):AJS.escapeHtml("Edit this field in Jira after creation."):c?AJS.format("{0}Edit{1} this field in Jira.",
'\x3ca href\x3d"'+c.url+'"\x3e',"\x3c/a\x3e"):AJS.escapeHtml("Edit this field in Jira after creation.");return a}},p={"com.pyxis.greenhopper.jira:gh-epic-label":v,string:v,summary:v,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":v,"com.atlassian.jira.plugin.system.customfieldtypes:url":Z,environment:C,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":C,description:C,"com.atlassian.jira.plugin.system.customfieldtypes:float":ca,array:T,"com.atlassian.jira.plugin.system.customfieldtypes:labels":T,
labels:ba,priority:ea,resolution:m,fixVersions:m,versions:m,components:m,security:m,"com.atlassian.jira.plugin.system.customfieldtypes:version":m,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":m,"com.atlassian.jira.plugin.system.customfieldtypes:project":m,assignee:aa,reporter:B,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":B,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":B,timetracking:da,duedate:V,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":V,
"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":U,"com.atlassian.jira.plugin.system.customfieldtypes:select":U,"com.pyxis.greenhopper.jira:gh-sprint":{template:f.fields.stringField,getContext:n,getInternalValue:z,getValue:G,behavior:function(a,b,c,d){var e={minimumInputLength:0,formatResult:function(a){return f.fields.sprintSelect({name:a.text,state:a.state,board:a.board})},query:function(a){r(b,c,a.term,d).done(function(b){var c=g.groupBy(b,function(a){return a.suggestion?"suggestions":
"all"});b=["suggestions","all"].filter(function(a){return c[a]&&0<c[a].length}).map(function(a){return{text:"suggestions"===a?"Suggestions":"All sprints",children:c[a]}});a.callback({results:g.compact(b)})})},initSelection:u(b,{id:-1,text:"Select a sprint"})};return y(a,b,c,d,e)}},"com.pyxis.greenhopper.jira:gh-epic-link":{template:f.fields.stringField,getContext:n,getInternalValue:z,getValue:function(a){return(a=
t(a))&&""!==a?a:void 0},behavior:function(a,b,c,d){var e={minimumInputLength:0,formatResult:function(a){return f.fields.epicSelect({name:a.text,key:a.id})},query:function(a){r(b,c,a.term,d).done(function(b){var c=g.uniq(b.map(function(a){return a.list})).map(function(a){return{text:a,children:b.filter(function(b){return b.list===a})}});a.callback({results:c})})},initSelection:u(b,{id:-1,text:"Select an epic"})};return y(a,b,c,d,e)}},"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":{template:f.fields.checkboxField,
getContext:L,getValue:M},"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":{template:f.fields.radioField,getContext:L,getValue:function(a){a=M(a);return 1===a.length?a[0]:null}}},fa={ignoreFieldsWithDefaultValue:!1},w={addFieldHandler:function(a,b){g.has(p,a)&&console&&console.warn&&console.warn("Redefining handler for type "+a+".");p[a]=b},getFieldHandler:A,getFieldType:q,isKnownRestType:function(a){return p.hasOwnProperty(a)},canRender:function(a){var b=q(a);return(b=p[b])?a.operations&&
a.operations.length&&(!b.canRender||b.canRender(a)):!1},getContext:function(a,b,c,d){return D(a,b,c||{},d||{})},renderField:function(a,b,c,d){a=D(a,b,c||{},d||{});return a.handler.template(a)},getInternalJSON:function(a){var b=P(a);return b&&b.getInternalValue&&b.getInternalValue(a)||S(a)},getJSON:S,attachFieldBehavior:R,attachFieldBehaviors:function(a,b,c){a.find(".jira-field").each(function(a,e){a=h(e);R(a,b,c)})},setFieldError:function(a,b){a.find(".error").remove();b&&(b=f.fields.errors({errorTexts:b}),
a.append(b))},renderCreateRequiredFields:function(a,b,c,d,e){function f(b){d.ignoreFieldsWithDefaultValue&&(b=g.filter(b,function(a){return!a.hasDefaultValue}));var f=g.filter(b,function(a){return!w.canRender(a)});f.length?e&&e(f):(a.html(g.map(b,function(a){return w.renderField(null,a,null,null)}).join("")),w.attachFieldBehaviors(a,{serverId:c.serverId,projectKey:c.projectKey},null))}d=g.extend({},fa,d);d.requiredFields?f(d.requiredFields):Y(c,d).done(f)}};return w});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/label-picker.js' */
define("jira-integration-plugin/label-picker",[],function(){var d=window.jiraIntegration.templates;return{build:function(c,e){c.auiSelect2({tags:!0,multiple:!0,tokenSeparators:[","," "],createSearchChoice:function(a){return a?{id:a,text:a,isNew:!0}:null},query:function(a){e(a.term).done(function(b){a.callback({results:b})})},formatResult:function(a){return d.fields.labelFieldResult({label:{labelName:a.text,isNew:a.isNew}})},initSelection:function(a,b){a=c.auiSelect2("val").map(function(a){return{id:a,
text:a}});b(a)}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
define("jira-integration-plugin/jira-create-issue-form",["jquery","jira-integration-plugin/custom-lodash","jira-integration-plugin/jira-create-issue-form-data","jira-integration-plugin/jira-create-issue-form-field-helper","jira-integration-plugin/fields"],function(d,f,h,g,k){function b(a){this.configuration=f.extend({},b.defaults,a);this.configuration.renderSummaryAndDescription&&this.configuration.excludedField.push("summary","description");this._init()}function p(a,c){var e={};a.find(".create-issue-required-fields").find("input, select, textarea, fieldset").not(".select2-input, .select2-focusser").each(function(a){var m=
d(this),b=m.attr("data-name");b&&(e[b]=c(m,b,a))});return e}function n(a){d(".aui-message",a).remove()}var l=window.jiraIntegration.templates;b.defaults={allowUnsupportedFields:!1,ignoreFieldsWithDefaultValue:!0,excludedField:["project","issuetype","reporter"],formClass:"jira-interation-create-issue-form",requiredFieldsOnly:!0,renderSummaryAndDescription:!1,get$unsupportedFieldMessage:function(a,c){return d(l.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:a,createIssueUrl:c}))},get$unexpectedError:function(a){return d(aui.message.error({content:AJS.escapeHtml(a)}))},
get$communicationError:function(a){return d(l.jiraCreateIssueForm.communicationErrorMessage({message:a}))},get$unauthorizeMessage:function(a){return d(l.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:a}))},get$unsupportedServerMessage:function(a){return d(l.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:a}))},get$unrenderableRequiredFieldsMessage:function(a,c){var e=a.map(function(a){return AJS.escapeHtml(a.name)}).join(", ");return d(l.jiraCreateIssueForm.unrenderableRequiredFieldsMessage({names:e,
count:a.length,serverUrl:c}))},ajax:function(a){alert("JiraCreateIssueForm requires the option 'ajax(options)' to be specified and respond like jQuery.ajax.\nThis method should handle response status codes other than 200 and 500 (those are handled by us).")}};b.prototype._trigger=function(a,c){var e=this.configuration[a];e&&e.apply(this,Array.prototype.slice.call(arguments,1))};b.prototype._selectServer=function(a,c){var e=this;if(this.currentServerId!==a||c)this.currentServerId=a,this.formIsLoading(this.defaultFields.server),
h.isIssueCreationSupported(a,this.configuration.ajax).done(function(c){c?(e._loadProjectData(a),e.formLoadingCompleted(e.defaultFields.server)):(c=h.getServerById(a).displayUrl,e._handleUnsupportedServer(c))}).fail(function(a){a[0]&&a[0].authenticationUri?e._handleAuthorizeError(a[0]):e._handleAjaxError(a)})};b.prototype._bindEventListener=function(){var a=this;this.defaultFields.server.on("change",function(c){a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());a.resetForm(!0);(c=this.value)?
a._selectServer(c):(g.resetSelectField(a.defaultFields.project),a.defaultFields.project.trigger("change"));a._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){var c=this.value||d(this).select2("data").value,e=d(a.defaultFields.issueType).select2("data");a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());c?(d('option[value\x3d""]',a.defaultFields.project).remove(),a._loadIssueType(a.currentServerId,c,e)):g.resetSelectField(a.defaultFields.issueType);
a._trigger("onProjectChanged",this.value)});this.defaultFields.issueType.on("change",function(){a.fieldValues=f.extend({},a.fieldValues,a._getFieldValues());a.resetForm(!0);this.value?a._loadFields(a.fieldValues):(a.$containerRequireField&&a.$containerRequireField.html(""),n(this.$form));a._trigger("onTypeChanged",this.value)})};b.prototype._getFieldValues=function(){return this._getJSON({getFieldJSON:k.getInternalJSON,$form:this.$form})};b.prototype._init=function(){this.container=d(this.configuration.container);
this.fieldValues={};if(this.container.length)this._renderForm(),this._bindEventListener(),this._loadServerData();else throw Error("container property should be defined.");};b.prototype._renderForm=function(){var a=this;this.$form=d(l.jiraCreateIssueForm.form({formClass:this.configuration.formClass})).on("aui-valid-submit",function(c){a.configuration.onSubmit&&(c.preventDefault(),a.configuration.onSubmit())}).on("focus",".fake-tabbable",function(){const a=d("div#select2-drop.select2-drop-active").children()[0];
a&&a.children.length&&a.getElementsByTagName("input")[0].focus()});this.configuration.renderSummaryAndDescription&&this._renderSummaryAndDescription();this.container.append(this.$form);this.defaultFields=this._getDefaultFields();f.each(this.defaultFields,f.bind(function(a){this.createSelect2WithIcon(d(a))},this));this.$containerRequireField=d(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};b.prototype._renderSummaryAndDescription=function(){var a=d(".create-issue-default-fields",
this.$form);a.append(aui.form.textField({labelContent:"Summary",isRequired:!0,name:"summary",value:this._getSummaryFromConfiguration()}));a.append(aui.form.textareaField({labelContent:"Description",name:"description"}))};b.prototype._getDefaultFields=function(){return{server:d(".server-select",this.$form),project:d(".project-select",this.$form),issueType:d(".issuetype-select",this.$form)}};b.prototype._loadServerData=
function(){var a=this;this.formIsLoading(this.defaultFields.server);h.loadServers(a.configuration.ajax).then(function(c){a.formLoadingCompleted(a.defaultFields.server);a._loadServerDataComplete(c)})};b.prototype._loadFields=function(a){const c=this,e=f.extend({},this.getContextJSON(),a);this.formIsLoading(this.defaultFields.issueType);h.getFieldMetadata(e,c.configuration.ajax).done(function(a){const b=c._filterFields(a);c.configuration.renderSummaryAndDescription&&(a=a.find(a=>"description"===a.fieldId),
c._setDescriptionAsRequiredField(!(!a||!a.required)));a=c._unrenderableRequiredFields(b);0===a.length?(c._renderFields(b,e),c._trigger("onFieldsRendered")):c._handleUnrenderableRequiredFields(a);c._fieldTypeAnalytics(b);c.formLoadingCompleted(c.defaultFields.issueType)}).fail(f.bind(c._handleAjaxError,this))};b.prototype._loadServerDataComplete=function(a){a.length?(1===a.length&&g.hideField(this.defaultFields.server),this._hasMultiServer=1<a.length,g.fillSelectData(this.defaultFields.server,a,this.configuration.serverId||
a[0].id),this._selectServer(this.configuration.serverId||a[0].id)):this._handlerUnexpectedError("Don\u0027t have any Jira server, please check the application link configuration.")};b.prototype._loadProjectData=function(a){var c=this;this.formIsLoading(this.defaultFields.project);h.loadProjects(a,c.configuration.ajax).then(function(a){a.errors&&a.errors.length?(a=a.errors[0],a.authenticationUri?c._handleAuthorizeError(a):c._handlerUnexpectedError(a.message)):a.length?g.fillSelectData(c.defaultFields.project,a,c.configuration.projectId):
c._handlerUnexpectedError("You do not have permission to create issues on this Jira server.");c.formLoadingCompleted(c.defaultFields.project)},f.bind(c._handleAjaxError,this))};b.prototype._loadIssueType=function(a,c,e){const b=this;this.formIsLoading(this.defaultFields.issueType);h.loadIssueTypes(a,c,b.configuration.ajax).then(function(a){g.fillSelectData(b.defaultFields.issueType,a,e&&e.id);b.formLoadingCompleted(b.defaultFields.issueType)}).fail(function(a){404===a.status&&b._handleCommunicationError(AJS.format("Could not communicate with Jira (HTTP error {0})",
404));b.formHasError()})};b.prototype._fieldTypeAnalytics=function(a){var c=a.map(function(a){var c=k.getFieldType(a);return{required:a.required,restType:c,knownRestType:k.isKnownRestType(c)}}).reduce(function(a,c){c.knownRestType?a[c.required?"requiredFields":"otherFields"].push(c.restType):a[c.required?"unknownRequiredFieldsCount":"unknownOtherFieldsCount"]++;return a},{requiredFields:[],otherFields:[],unknownRequiredFieldsCount:0,unknownOtherFieldsCount:0});c=Object.keys(c).reduce(function(a,b){var e=
c[b];if(!Array.isArray(e))return a[b]=e,a;var d=e.length;a[b+".size"]=d;for(var m=0;m<d;m++)a[b+"["+m+"]"]=e[m];return a},{});AJS.trigger("analytics",{name:"jira.integration.issue.create.form.displayed",data:c})};b.prototype._renderFields=function(a,c){this.$containerRequireField.html("");var b=f.reject(a,k.canRender);!this.configuration.allowUnsupportedFields&&b.length?this._handleUnsupportedFields(b):(this.$containerRequireField.html(f.map(a,function(a){return k.renderField(null,a,c,null)}).join("")),
k.attachFieldBehaviors(this.$containerRequireField,c,null),this._trigger("onRequiredFieldsRendered",a,b))};b.prototype._setError=function(a){n(this.$form);this.$form.prepend(a);this.formLoadingCompleted();this.formHasError()};b.prototype._handleCommunicationError=function(a){a=this.configuration.get$communicationError(a);this._setError(a)};b.prototype._handlerUnexpectedError=function(a){a=this.configuration.get$unexpectedError(a);this._setError(a)};b.prototype._handleUnsupportedFields=function(a){a=
f.map(a,function(a){return AJS.escapeHtml(a.name)});a=this.configuration.get$unsupportedFieldMessage(a,this._getCreateJiraIssueUrl());n(this.$form);this.$form.prepend(a);this._trigger("onError");this.formLoadingCompleted()};b.prototype._handleUnsupportedServer=function(a){a=this.configuration.get$unsupportedServerMessage(a);this._setError(a)};b.prototype._handleAjaxError=function(a){if(500<=a.status&&600>a.status){var c=a.responseJSON.errors&&a.responseJSON.errors[0],b=c&&c.exceptionName;b&&"com.atlassian.integration.jira.JiraCommunicationException"===
b?this._handleCommunicationError(c.message):this._handlerUnexpectedError(AJS.format("Could not communicate with Jira (HTTP error {0})",a.status))}else this._handlerUnexpectedError("An unexpected response was received from Jira.");this.formHasError()};b.prototype._handleAuthorizeError=function(a){var c=this;this.formHasError();var b=this.configuration.get$unauthorizeMessage(a.applicationName);this.$form.append(b);d(".applink-authenticate",b).on("click",function(b){AppLinks.authenticateRemoteCredentials(a.authenticationUri,
function(){c.resetForm();c._selectServer(c.currentServerId,!0)},function(){c._handlerUnexpectedError(AJS.format("You have refused to permit access to {0}.",a.applicationName))});b.preventDefault()})};b.prototype._handleUnrenderableRequiredFields=function(a){a=this.configuration.get$unrenderableRequiredFieldsMessage(a,this._getCreateJiraIssueUrl());n(this.$form);this.$form.append(a);this.formLoadingCompleted()};b.prototype._getCreateJiraIssueUrl=function(){var a=this.defaultFields.project.find("option:selected").val(),
c=this.defaultFields.issueType.find("option:selected").val(),b=h.getServerById(this.currentServerId).displayUrl;b=b+"/secure/CreateIssueDetails!Init.jspa?pid\x3d"+a+"\x26issuetype\x3d"+c;a=this._getFieldValue("summary");a.length&&(b=b+"\x26summary\x3d"+encodeURIComponent(a));a=this._getFieldValue("description");a.length&&(b=b+"\x26description\x3d"+encodeURIComponent(a));return b};b.prototype._filterFields=function(a){var c=this;return f.filter(a,function(a){var b=a.schema?a.schema.system||a.schema.custom||
a.schema.customId:a;return!(c.configuration.excludedField&&c.configuration.excludedField.includes(b)||c.configuration.ignoreFieldsWithDefaultValue&&a.hasDefaultValue||c.configuration.requiredFieldsOnly&&!a.required)})};b.prototype._unrenderableRequiredFields=function(a){return a.filter(function(a){return a.required&&!k.canRender(a)})};b.prototype._getFieldValue=function(a){return(a=d("[name\x3d'"+a+"']",this.$form))?d.trim(a.val()):""};b.prototype._setDescriptionAsRequiredField=function(a){var c=
d('.field-group [name\x3d"description"]',this.$form).prev("label");c.find(".aui-icon.aui-icon-required").remove();a&&c.append(aui.icons.icon({icon:"required"}))};b.prototype._getSummaryFromConfiguration=function(){var a=this.configuration.initialSummary;delete this.configuration.initialSummary;return a};b.prototype._getJSON=function(a){if(!a.verbose)return p(a.$form,function(c,b,e){return a.getFieldJSON(c)});var c=h.getCachedFieldMetadataEntry(this.getContextJSON()).value,b=Object.keys(c.fields).reduce(function(a,
b){a[b]=k.getContext(null,c.fields[b],null,null);return a},{});return p(this.$form,function(c,e,d){var f=b[e];return{name:e,jiraType:f.jiraType,required:f.isRequired,label:f.labelText,value:a.getFieldJSON(c),index:d}})};b.prototype.resetForm=function(a){n(this.$form);d(".field-group",this.$form).show();this.configuration.renderSummaryAndDescription&&this._setDescriptionAsRequiredField(!1);this._hasMultiServer||g.hideField(this.defaultFields.server);this.$containerRequireField.html("");this.fieldValues=
a?this.fieldValues:{}};b.prototype.formHasError=function(){d(".field-group",this.$form).hide();this.$containerRequireField.html("");this._hasMultiServer&&g.showField(this.defaultFields.server);g.setFieldDisabled(d(".insert-issue-button"),!0);this._trigger("onError");this.formLoadingCompleted()};b.prototype.getCurrentServer=function(){return h.getServerById(this.currentServerId)};b.prototype.formIsLoading=function(a){a&&g.setIsLoading(a,!0);a=d(":input",d(this.$form));g.setFieldDisabled(a,!0)};b.prototype.formLoadingCompleted=
function(a){a?g.setIsLoading(a,!1):d(".aui-icon.aui-icon-wait",this.$form).remove();a=d(":input",d(this.$form));g.setFieldDisabled(a,!1)};b.prototype.createSelect2WithIcon=function(a){if(a.is(".server-select"))a.auiSelect2({minimumResultsForSearch:-1});else{var c=a.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,
extraAttributes:this.defaultFields};a.auiSelect2(c)}a.auiSelect2("val","")};b.prototype.projectSelectFormat=function(a){var c=this.extraAttributes.server.select2("data").id;c=h.getProjectIconUrl(c,a.id);return l.fields.select2WithIconOption({optionValue:a.text,iconUrl:c,isProject:!0})};b.prototype.issueTypeSelectFormat=function(a){var c=this.extraAttributes.server.select2("data").id,b=this.extraAttributes.project.select2("data").id;c=h.getIssueTypeIconUrl(c,b,a.id);return l.fields.select2WithIconOption({optionValue:a.text,
iconUrl:c,isProject:!1})};b.prototype.getContextJSON=function(){var a=this.defaultFields.project.val()||d(this.defaultFields.project).select2("data").value;return{serverId:this.currentServerId,projectId:a,projectKey:h.getProjectById(this.currentServerId,a).key,issueTypeId:this.defaultFields.issueType.val(),summary:this._getSummaryFromConfiguration()}};b.prototype.getJSON=function(a){return b.prototype._getJSON({getFieldJSON:k.getJSON,verbose:a,$form:this.$form})};b.prototype.renderErrors=function(a){p(this.$form,
function(c,b){c=c.closest(".jira-field");var d=function(a){return 0===a.indexOf(b)};if(a.hasOwnProperty(b)||Object.keys(a).some(d)){a.hasOwnProperty(b)||(b=Object.keys(a).filter(d)[0]);var e=Array.isArray(a[b])?a[b]:[a[b]]}k.setFieldError(c,e)})};b.prototype.submit=function(){this.$form.submit()};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
define("jira-integration-plugin/jira-create-issue-form-data",["jquery"],function(e){function q(a){var c=new URL(a.avatarUrls["16x16"]);const b=c.searchParams;b.get("pid")||b.append("pid",a.id);b.get("avatarId")||(a=c.pathname.split("/"),c=a.lastIndexOf("avatar"),b.append("avatarId",a[c+1]));return b.toString()}function l(a){a=g(a.serverId,a.projectKey,a.issueTypeId);return{key:a,value:m[a]}}function k(a){if(!d[a])throw Error("Can only be called after server is loaded.");return d[a].projects}function g(a,
c,b){return a+(c?"-"+c:"")+(b?"-"+b:"")}var d={},m={},r=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId\x3d{0}\x26iconType\x3d{1}\x26{2}",h=[],f=function(a,c,b){return a({dataType:"json",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers"+(c||""),statusCode:b})};const p=(a,c,b=[])=>{b=b.filter(a=>!a.subtask);const n={};b.forEach(a=>{n[a.id]=a.iconUrl});const d=q(a);h[g(c,a.id)]={iconUrl:AJS.format(r,c,"project",d),issueTypes:n};return b},t=(a,c)=>k(a).filter(function(a){return a.id===
c})[0];return{loadServers:function(a){return f(a,"").done(function(a){a.forEach(function(a){d[a.id]=a})})},loadProjects:function(a,c){var b=d[a]&&d[a].projects;return b?e.Deferred().resolve(b):f(c,"/"+a+"/projects").done(function(b){b.length&&(b.forEach(function(b){p(b,a)}),d[a].projects=b)})},loadIssueTypes:(a,c,b)=>f(b,`/${a}/projects/${c}/issue-types`,{404:!1}).then(b=>{const d=t(a,c);return b?p(d,a,b):[]}),getFieldMetadata:function(a,c){var b=l(a);return b.value?e.Deferred().resolve(b.value):
f(c,"/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueTypeId+"/fields-meta").done(function(a){m[b.key]=a})},getCachedFieldMetadataEntry:l,getServerById:function(a){return d[a]},getProjectIconUrl:function(a,c){a=g(a,c);return h[a]?h[a].iconUrl:""},getIssueTypeIconUrl:function(a,c,b){a=g(a,c);return(a=h[a])&&a.issueTypes[b]?a.issueTypes[b]:""},getProjects:k,getProjectById:function(a,c){a=k(a);if(!a)return null;for(var b=0,d=a.length;b<d;b++){var e=a[b];if(e.id===c)return e}return null},
isIssueCreationSupported:function(a,c){if(!d[a])throw Error("Can only be called after server is loaded.");return"issueCreationSupported"in d[a]?e.Deferred().resolve(d[a].issueCreationSupported):f(c,"/"+a+"/features").then(function(b){if(b.errors)return e.Deferred().reject(b.errors);if(!Array.isArray(b))return e.Deferred().reject("Unexpected response from Jira");d[a].issueCreationSupported=-1!==b.indexOf("CREATE_ISSUE");return d[a].issueCreationSupported})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
define("jira-integration-plugin/jira-create-issue-form-field-helper",["jquery","jira-integration-plugin/custom-lodash"],function(d,g){function f(a){a=a.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:a,iconUrl:""})}return{fillSelectData:function(a,b,d){var e=[],c;b.forEach(function(a){var b={value:AJS.escapeHtml(a.id),text:a.name,iconUrl:a.iconUrl?a.iconUrl:a.avatarUrls?a.avatarUrls["16x16"]:""};d===a.id&&(b.selected=!0,c=a);e.push(aui.form.optionOrOptgroup(b))});c?(c.text=
c.name,a.html(e.join("")),a.auiSelect2("data",c).trigger("change")):(e.unshift(f(a)),a.html(e.join("")),a.auiSelect2("val","").trigger("change"))},resetSelectField:function(a){a.html(f(a));a.auiSelect2("val","").trigger("change")},hideField:function(a){a.parent().hide()},showField:function(a){a.parent().show()},setFieldDisabled:function(a,b){b?d.fn.disable?a.disable():a.prop("disabled",!0):d.fn.enable?a.enable():a.prop("disabled",!1)},setIsLoading:function(a,b){return b?a.after(aui.icons.icon({icon:"wait"})):
a.next(".aui-icon.aui-icon-wait").remove()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.jiraCreateIssueForm.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_ignored) {
  return '' + aui.form.form({extraClasses: (opt_data.formClass ? opt_data.formClass + ' ' : '') + 'jira-create-form', method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="fake-tabbable" tabindex="0" /><div class="field-group" data-jira-type="server"><label>' + soy.$$escapeHtml('Server') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box server-select medium-long-field" name="server" data-placeholder="' + soy.$$escapeHtml('Select a server') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a server') + '</option></select></div><div class="field-group" data-jira-type="project"><label>' + soy.$$escapeHtml('Project') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box project-select medium-long-field" name="project" data-placeholder="' + soy.$$escapeHtml('Select a project') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a project') + '</option></select></div><div class="field-group" data-jira-type="issuetype"><label>' + soy.$$escapeHtml('Issue Type') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml('Select an issue type') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select an issue type') + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.form.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.form';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_ignored) {
  var param28 = '';
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy31 = '<strong>' + soy.$$escapeHtml(opt_data.unsupportedFields) + '</strong>';
    param28 += soy.$$filterNoAutoescape(AJS.format('The required field {0} is not available in this form. You will need to',field__soy31));
  } else {
    var fieldList__soy38 = '' + jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields});
    param28 += soy.$$filterNoAutoescape(AJS.format('The required fields {0} are not available in this form. You will need to',fieldList__soy38));
  }
  param28 += ' <a href="' + soy.$$escapeHtml(opt_data.createIssueUrl) + '" target="_blank">' + soy.$$escapeHtml('create your issue directly in Jira') + '</a>.';
  var output = '' + aui.message.warning({content: param28});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_ignored) {
  var output = '';
  var joinText__soy50 = '' + ((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml('and') + ' ' : ', ');
  var fieldList58 = opt_data.fields;
  var fieldListLen58 = fieldList58.length;
  for (var fieldIndex58 = 0; fieldIndex58 < fieldListLen58; fieldIndex58++) {
    var fieldData58 = fieldList58[fieldIndex58];
    output += ((! (fieldIndex58 == 0)) ? soy.$$escapeHtml(joinText__soy50) : '') + '<strong>' + soy.$$escapeHtml(fieldData58) + '</strong>';
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.buildFieldList.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.buildFieldList';
}


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var applicationNameEscaped__soy67 = '' + soy.$$escapeHtml(opt_data.applicationName);
  output += aui.message.info({content: '' + soy.$$filterNoAutoescape(AJS.format('{0}Log in and approve{1} to retrieve data from {2}','<a class="oauth-init applink-authenticate" href="#">','</a>',applicationNameEscaped__soy67))});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.authorize.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.authorize';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The version of selected Jira server is not supported. You may want to upgrade to at least version 5.x or {0}create issue in Jira{1}.','<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The required {1,choice,1#field|1\x3cfields} \x3cstrong\x3e{0}\x3c/strong\x3e {1,choice,1#is|1\x3care} not available in this dialog. You will need to {2}create your issue directly in Jira{3}.',opt_data.names,opt_data.count,'<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.error({titleContent: '' + soy.$$escapeHtml('Unfortunately, we\x27ve encountered problems connecting to Jira'), content: '<p>' + soy.$$escapeHtml(opt_data.message) + '</p>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:proxy-js', location = '/jira/proxy.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{makeRequest:function(a){var b=contextPath||AJS.contextPath();if(a.processData)a.appId?a.data=AJS.$.extend(a.data||{},{appId:a.appId}):a.appType&&(a.data=AJS.$.extend(a.data||{},{appType:a.appType})),a.data=AJS.$.extend(a.data||{},{path:a.url});else{var d=a.url;a=AJS.$.extend(a,{beforeSend:function(c){a.appId?c.setRequestHeader("X-AppId",a.appId):a.appType&&c.setRequestHeader("X-AppType",a.appType);c.setRequestHeader("X-AppPath",d)}})}a=AJS.$.extend(a,{url:b+
"/plugins/servlet/applinks/proxy"});return AJS.$.ajax(a)},createProxyGetUrl:function(a){var b="";a.includeContext&&(b=contextPath||AJS.contextPath());b+="/plugins/servlet/applinks/proxy";if(a.appId)b+="?appId\x3d"+encodeURIComponent(a.appId);else if(a.appType)b+="?appType\x3d"+encodeURIComponent(a.appType);else return AJS.log("You need to specify an appType or appId"),"";a.path&&(b+="\x26path\x3d"+encodeURIComponent(a.path));return b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jqlHelper', location = '/jira/jqlhelper.js' */
AJS.JQLHelper=function(){var m=/^\s*((key|issuekey)\s*=\s*)?"*([A-Z]+)([0-9]+)?([A-Z]+)?-([0-9]+)"*\s*$/i,h=/\s*([A-Z][A-Z]+)-[0-9]+\s*/,n=/(issue|searchrequest)-xml/i,k=/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/i,p=/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,l=/(jqlQuery|jql)\s*=([^&]+)/i,e=/(\?|&)(requestId|filter)=([^&]+)/i,f=/(searchrequest-xml\/)([0-9]+)\/SearchRequest/i,q=/=|!=|~|>|<|!~| is | in | was | changed /i,g=function(a){var b=
"",c=k.exec(a);c?b="key\x3d"+c[2]:(c=l.exec(a))?b=c[2]:(a=h.exec(a))&&(b="key\x3d"+a[0]);return b=b.replace(/\+/g," ")},r=function(a,b){var c;a=decodeURIComponent(a);AJS.JQLHelper.getJqlQueryFromJiraFilter(a,b,function(d){d.jql&&(c=d.jql)});return c};return{isSingleKeyJQLExp:function(a){return m.exec(a)},isMultipleSingleKeyJQLExp:function(a){a=a.split(",");for(var b in a){var c=AJS.$.trim(a[b]);if(!AJS.JQLHelper.isSingleKeyJQLExp(c))return!1}return!0},isIssueUrlOrXmlUrl:function(a){return k.test(a)||
n.test(a)||l.test(a)||p.test(a)?!0:!1},isFilterUrl:function(a){return e.test(a)||f.test(a)},getFilterFromFilterUrl:function(a){if(e.test(a))return a=e.exec(a),a[2]+"\x3d"+a[3];if(f.test(a))return"filter\x3d"+f.exec(a)[2]},getJqlQueryFromJiraFilter:function(a,b,c,d){a=(e.exec(a)||f.exec(a))[2];b="/rest/jiraanywhere/1.0/jira/appLink/"+b+"/filter/"+a;AJS.$.ajax({async:!1,dataType:"json",url:Confluence.getContextPath()+b,success:c,error:d})},findServerIndexFromUrl:function(a,b){if("undefined"!==typeof b||
0<b.length)for(var c=a.toLowerCase(),d=0;d<b.length;d++)if(0==c.indexOf(b[d].url.toLowerCase())&&"/"==a.charAt(b[d].url.length))return d;return-1},getJqlQueryFromUrl:g,getJqlAndServerIndexFromUrl:function(a,b){var c={};c.serverIndex=this.findServerIndexFromUrl(a,b);c.jqlQuery=g(a);return c},checkQueryType:function(a){if(AJS.Editor.JiraAnalytics&&a&&0!=AJS.$.trim(a).length)return 0!=a.indexOf("http")?AJS.Editor.JiraAnalytics.linkTypes.jqlDirect:-1!=a.indexOf("jira.issueviews:searchrequest-xml")||-1!=
a.indexOf("jira.issueviews:issue-xml")?AJS.Editor.JiraAnalytics.linkTypes.xml:-1!=a.indexOf("jira.issueviews:searchrequest-rss")?AJS.Editor.JiraAnalytics.linkTypes.rss:-1!=a.indexOf("filter\x3d")||-1!=a.indexOf("filter\\\x3d")?AJS.Editor.JiraAnalytics.linkTypes.filter:AJS.Editor.JiraAnalytics.linkTypes.jql},convertToJQL:function(a,b){if(""!==AJS.$.trim(a))if(0===a.indexOf("http")&&this.isFilterUrl(a))var c=r(a,b);else 0===a.indexOf("http")&&this.isIssueUrlOrXmlUrl(a)?(a=g(decodeURIComponent(a)),0<
a.length&&(c=a)):c=0!==a.indexOf("http")&&a.match(q)?a:a.match(h)?"key\x3d"+a:'summary ~ "'+a+'" OR description ~ "'+a+'"';return c}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:editor-resources-v4-exporter', location = 'editor-plugins/tinymce-exporter.js' */
try{require("confluence-editor-v4/build/editor")}catch(a){};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jiraAnalytics', location = '/jira/jiraanalytics.js' */
AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jira.plugin.paste"},search:{key:"confluence.jira.plugin.search"},trigger:{key:"confluence.jira.plugin.trigger"},customizeColumn:{key:"confluence.jira.plugin.column.customize"}},linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},getDisplayType:function(b){var a="single";b.container.find("#opt-table").is(":checked")?a="table":b.container.find("#opt-total").is(":checked")&&(a="count");return a},
setupAnalyticPanelActionObject:function(b,a,d){return{name:b.analyticPanelActionName,properties:this.setupPanelActionProperties(b,a,d)}},setupPanelActionProperties:function(b,a,d){var c={};a===AJS.Editor.JiraConnector.source.instructionalText&&("confluence.jira.plugin.issuecreated"===b.analyticPanelActionName?c.issueType=b.container.find('select[name\x3d"issuetype"] :selected').text():"confluence.jira.plugin.searchadded"===b.analyticPanelActionName&&(c.display=this.getDisplayType(b)),c.label=d);return c},
triggerPasteEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.paste.key,properties:b})},triggerPannelActionEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push(b)},triggerSearchEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.search.key,properties:b})},triggerMarkupEvent:function(b){this.triggerSearchEvent(b)},triggerPannelTriggerEvent:function(b){AJS.EventQueue=
AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.trigger.key,properties:b})},triggerCustomizeColumnEvent:function(b){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,properties:b})}};
(function(b){b.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(a,d){a&&a[0]&&"confluence.extra.jira"==a[0].pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})});b.aop.before({target:tinymce.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(a,d){a&&a[0]&&a[0].presetMacroMetadata&&"confluence.extra.jira"==a[0].presetMacroMetadata.pluginKey&&AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})});
AJS.bind("init.rte",function(){b.aop.before({target:tinyMCE.activeEditor,method:"execCommand"},function(a,d){if(a&&"mceInsertContent"==a[0]&&a[2]&&(d=[Node.ELEMENT_NODE],a=b.parseHTML(a[2]),a.length)){var c=a[0];if(d.includes(c.nodeType)&&(d=c.getAttribute("data-macro-name"),["jira","jiraissues"].includes(d)&&(d=AJS.Editor.JiraAnalytics,a={source:"wiki_markup"},c.getAttribute("data-macro-parameters")))){c=c.getAttribute("data-macro-parameters").split("|");for(var f=0;f<c.length;f++){var e=b.trim(c[f]);
if(0==e.indexOf("jql")||0==e.indexOf("jqlQuery")){a.type=d.linkTypes.jqlDirect;break}else if(0==e.indexOf("url")){c=b.trim(e.substring(e.indexOf("\x3d")+1,e.length));a.type=AJS.JQLHelper.checkQueryType(c);break}else if(0==e.indexOf("http")){c=e;a.type=AJS.JQLHelper.checkQueryType(c);break}}"undefined"===typeof a.type&&(a.type=d.linkTypes.jqlDirect);d.triggerMarkupEvent(a)}}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_jquery-selection-plugin', location = 'jquery-selection-plugin.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[17],{401:function(t,e,n){"use strict";n.r(e);var s=n(13),o=n(105);!function(t,e){if(e.selection){const n=function(t){return t.replace(/\u000D/g,"")};t.fn.selection=function(t){const n=this[0];if(this.focus(),!n)return!1;if(null==t)return e.selection.createRange().text;const{scrollTop:s}=n,o=e.selection.createRange();o.text=t,o.select(),n.focus(),n.scrollTop=s},t.fn.selectionRange=function(t,s){const o=this[0];this.focus();const c=e.selection.createRange();if(null==t){const t=this.val(),e=t.length,s=c.duplicate();s.moveToElementText(o),s.setEndPoint("StartToEnd",c);let i=e-n(s.text).length;s.setEndPoint("StartToStart",c);const l=e-n(s.text).length;return i!==l&&"\n"===t.charAt(i+1)&&(i+=1),{end:i,start:l,text:t.substring(l,i),textBefore:t.substring(0,l),textAfter:t.substring(i)}}c.moveToElementText(o),c.collapse(!0),c.moveStart("character",t),c.moveEnd("character",s-t),c.select()}}else t.fn.selection=function(t){const e=this[0];if(!e)return!1;if(null==t)return!!e.setSelectionRange&&e.value.substring(e.selectionStart,e.selectionEnd);const{scrollTop:n}=e;if(e.setSelectionRange){const{selectionStart:n}=e;e.value=e.value.substring(0,n)+t+e.value.substring(e.selectionEnd),e.selectionStart=n,e.selectionEnd=n+t.length}e.focus(),e.scrollTop=n},t.fn.selectionRange=function(t,e){if(null==t){const t={start:this[0].selectionStart,end:this[0].selectionEnd},e=this.val();return t.text=e.substring(t.start,t.end),t.textBefore=e.substring(0,t.start),t.textAfter=e.substring(t.end),t}this[0].selectionStart=t,this[0].selectionEnd=e};t.fn.wrapSelection=function(t,e){this.selection(t+this.selection()+(e||""))}}(n.n(o).a,s.document)}},[[401,0,1,4,6]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/datatable.js' */
(function(d){AJS.DataTable=function(a,b,c){c=null;a&&a.jquery?c=a:"string"==typeof a&&(c=d(a));c.addClass("data-table");if(b&&b.length){this.columns=b;a=d("\x3ctr\x3e\x3c/tr\x3e").appendTo(c);a.addClass("data-table-header");for(var e=0;e<b.length;e++){var f=b[e];a.append('\x3cth class\x3d"'+f.className+'"\x3e'+f.title+"\x3c/th\x3e")}}this.tbl=c;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(a){for(var b=d("\x3ctr\x3e\x3c/tr\x3e").appendTo(this.tbl),c=this.columns,e=0;e<this.columns.length;e++){var f=
c[e],h=d("\x3ctd\x3e\x3c/td\x3e").appendTo(b);h.addClass(f.className);f.renderCell(h,a)}b.data("row-data",a);this._bindRowJs(b,this.rowIdx,"selected","hover");this.rowIdx+=1;b.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(a){a=d("tbody tr",this.tbl)[a+1];d(a).focus()};AJS.DataTable.prototype._bindRowJs=function(a,b,c,e){var f=this;a.click(function(g){c&&(d(f.tbl).find("."+c).removeClass(c),d(this).addClass(c));g=a.data("row-data");f.tbl.trigger("row-select",[g])});var h=function(g){switch(g.keyCode){case 13:var k,
l=a.data("row-data");a.keyup(k=function(m){f.tbl.trigger("row-action",[l]);a.unbind("keyup",k);m.stopPropagation();return!1});g.stopPropagation();return!1;case 38:return 0<b&&a.prev().focus(),g.stopPropagation(),!1;case 40:var n=d("tbody tr",f.tbl).length;b<n-1&&a.next().focus();g.stopPropagation();return!1}};d.browser.mozilla?a.keypress(h):a.keydown(h);a.focus(function(g){a.click()});e&&a.hover(function(){d(this).addClass(e)},function(){d(this).removeClass(e)})}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/dialogs.js' */
(function(){tinymce.create("tinymce.plugins.JiraLink",{init:function(e){e.addCommand("mceJiralink",AJS.Editor.JiraConnector.hotKey);e.on("PostRender",function(){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(k){AJS.Editor.JiraConnector.servers=k}});AJS.$("#jiralink").click(function(k){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorDropdownLink,!0);k.stopPropagation();return!1});AJS.$("#insert-menu .macro-jiralink").show();
e.addShortcut("ctrl+shift+j","","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("jiraconnector",tinymce.plugins.JiraLink)})();AJS.Editor.Adapter.addTinyMcePluginInit(function(e){e.plugins+=",jiraconnector";var k=e.theme_advanced_buttons1,p=k.indexOf("confimage");e.theme_advanced_buttons1=k.substring(0,p)+"jiralinkButton,"+k.substring(p)});
AJS.Editor.JiraConnector=function(e){var k=require("confluence/form-state-control"),p="Insert Jira Issue/Filter",v="Insert",w="Cancel",q=AJS.format("Hint: type \u0022{0}+Shift+J\u0022 in the editor to quickly access this dialog.",-1!=navigator.platform.toLowerCase().indexOf("mac")?"Cmd":"Ctrl"),l,m,f,x=function(){var a=e("#createPageLabelsString");0<a.length?(m=a.val().split(" ").join(),AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l,
label:m})):e.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(c){var b=[];e.each(c.labels,function(h,n){b.push(n.name)});m=b.join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l,label:m})})},t=function(a){if(!f){f=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});f.addHeader(p);for(var c=AJS.Editor.JiraConnector.Panels,b=0;b<c.length;b++){f.addPanel(c[b].title());var h=f.getCurrentPanel();c[b].init(h)}f.addLink("Select Macro",
function(){f.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");f.addHelpText(q);e("#jira-connector .dialog-tip").attr("title",q);f.addButton(v,function(){var g=f.getCurrentPanel().id;g=c[g];var r=c[0];AJS.Editor.JiraAnalytics&&(AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(g,l,m),r.customizedColumn&&AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:r.customizedColumn}));g.insertLink()},"insert-issue-button");k.disableElement(AJS.$(".insert-issue-button"));
f.addCancel(w,function(){AJS.Editor.JiraConnector.closePopup()});f.gotoPanel(0);if(AJS.Editor.JiraConnector.servers)for(b=0;b<AJS.Editor.JiraConnector.servers.length;b++){var n=AJS.Editor.JiraConnector.servers[b];AppLinks.makeRequest({appId:n.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:b,success:function(g){g&&g.length&&(AJS.Editor.JiraConnector.servers[this.serverIndex].columns=g)},error:function(){AJS.log("Jira Issues Macro: unable to retrieve fields from AppLink: "+n.id)}})}e("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",
label:"Jira Charts"}));e("#jira-connector .dialog-page-menu button").click(function(){var g=AJS.Editor.JiraConnector.Panels[f.getCurrentPanel().id];g.setInsertButtonState&&g.setInsertButtonState();g.focusForm&&g.focusForm()});e("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();AJS.Editor.JiraChart&&AJS.Editor.JiraChart.open()})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(a){f.gotoPanel(1);var d=AJS.Editor.JiraConnector.Panels[1];
d.setSummary(a);setTimeout(function(){d.focusForm&&d.focusForm()},0)}else f.gotoPanel(0);f.overrideLastTab();f.show()},u=function(){AJS.Editor.JiraConnector.clickConfigApplink&&AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:!1,success:function(a){AJS.Editor.JiraConnector.servers=a}});if("undefined"===typeof AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length)return AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin")),!1;AJS.Editor.JiraConnector.clickConfigApplink=
!1;AJS.Editor.JiraConnector.refreshAppLink&&(AJS.Editor.JiraConnector.refreshAppLink.call(),AJS.Editor.JiraConnector.refreshAppLink=!1);return!0};return{warningPopup:function(a){var c=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"}),b="Connect Confluence To Jira";c.addHeader(b);b=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:a});c.addPanel("Panel 1",b);c.get("panel:0").setPadding(0);a?(c.addButton("Set connection",
function(h){AJS.Editor.JiraConnector.clickConfigApplink=!0;h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action").opener=null},"create-dialog-create-button app_link"),c.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")):c.addButton("Contact admin",function(h){h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();
window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action").opener=null});c.addLink("Cancel",function(h){h.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()});c.show();c.gotoPanel(0)},closePopup:function(){f.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},open:function(a,c){if(u()){AJS.Editor.Adapter.storeCurrentSelectionState();l=a;AJS.Editor.JiraAnalytics&&l&&(l===AJS.Editor.JiraConnector.source.instructionalText?
x():(m=null,AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:l})));a=tinymce.confluence.macrobrowser;var b=a.getCurrentNode();a.isMacroTag(b)&&"jira"==e(b).attr("data-macro-name")?a.editMacro(b):AJS.Editor.JiraConnector.openCleanDialog(c)}},openCleanDialog:function(a){a=a&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});t(a);AJS.Editor.JiraConnector.Panels[0].setMacroParams(null)},edit:function(a){if(u())if("undefined"==typeof a.params)AJS.Editor.JiraConnector.openCleanDialog(!1);
else{m=l="";var c={};if(a.params.url)c.searchStr=a.params.url;else{c.maximumIssues=a.params.maximumIssues;var b;if(!(b=a.defaultParameterValue))b:if(b=a.params,b.hasOwnProperty("jqlQuery"))b=b.jqlQuery;else{var h=/^([0-9]\d*)$/,n="count columns columnIds title renderMode cache width height server serverId anonymous baseurl showSummary".split(" ");for(d in b)if(-1==e.inArray(d,n)&&b.hasOwnProperty(d)){b=h.test(d)?b[d]:d+(" \x3d "+b[d]);break b}b=""}var d=b;c.searchStr="undefined"==typeof d?"":d;if("undefined"!=
typeof a.params.server)c.serverName=a.params.server;else for(d=0;d<AJS.Editor.JiraConnector.servers.length;d++)if(AJS.Editor.JiraConnector.servers[d].selected){c.serverName=AJS.Editor.JiraConnector.servers[d].name;break}c.columnIds=a.params.columnIds}d=a.params.count;"undefined"===typeof d&&(d="false");c.count=d;d=a.params.columns;"undefined"!=typeof d&&d.length&&(c.columns=d);a&&!AJS.Editor.inRichTextMode()&&e("#markupTextarea").selectionRange(a.startIndex,a.startIndex+a.markup.length);t();c.searchStr&&
(f.gotoPanel(0),d=AJS.Editor.JiraConnector.Panels[0],d.setMacroParams(c),a={searchValue:c.searchStr,serverName:c.serverName,isJqlQuery:a.params.hasOwnProperty("jqlQuery"),isAutoSearch:!0},d.doSearch(a))}},source:{macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"}}}(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});
AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=!1;AJS.Editor.JiraConnector.hotKey=function(){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorHotKey,!0)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/panelhelper.js' */
(function(AJS){var FormStateControl=require("confluence/form-state-control");AJS.Editor.JiraConnector.Panel=function(){};AJS.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:false,insertIssueLink:function(key){this.insertIssueLinkWithParams({"key":key})},insertJqlLink:function(jql){this.insertIssueLinkWithParams({"jqlQuery":jql})},insertIssueLinkWithParams:function(params){var insertMacroAtSelectionFromMarkup=function(macro){tinymce.confluence.macrobrowser.macroBrowserComplete(macro)};params["server"]=
this.selectedServer.name;params["serverId"]=this.selectedServer.id;if(AJS.Editor.inRichTextMode())insertMacroAtSelectionFromMarkup({name:"jira","params":params});else{var markup="{jira:";for(var key in params)markup=markup+key+"\x3d"+params[key]+"|";if(markup.charAt(markup.length-1)=="|")markup=markup.substr(0,markup.length-1);var textArea=AJS.$("#markupTextarea");var selection=textArea.selectionRange();textArea.selectionRange(selection.start,selection.end);textArea.selection(markup);selection=textArea.selectionRange();
textArea.selectionRange(selection.end,selection.end)}if(AJS.Editor.JiraAnalytics&&AJS.Editor.JiraConnector.analyticPanelActionObject){AJS.Editor.JiraAnalytics.triggerPannelActionEvent(AJS.Editor.JiraConnector.analyticPanelActionObject);AJS.Editor.JiraConnector.analyticPanelActionObject=null}AJS.Editor.JiraConnector.closePopup()},disableInsert:function(){FormStateControl.disableElement(AJS.$(".insert-issue-button"))},isInsertDisabled:function(){return AJS.$(".insert-issue-button").is(":disabled")},
getOAuthRealm:function(xhr){var authHeader=xhr.getResponseHeader("WWW-Authenticate")||"";var realmRegEx=/OAuth realm="([^"]+)"/;var matches=realmRegEx.exec(authHeader);if(matches)return matches[1];else return null},enableInsert:function(){FormStateControl.enableElement(AJS.$(".insert-issue-button"))},handleInsertWaiting:function(isWaiting){var $insertButton=AJS.$(".insert-issue-button");return isWaiting?$insertButton.before(aui.icons.icon({icon:"wait"})):$insertButton.prev(".aui-icon.aui-icon-wait").remove()},
msg:function(container,messageObject,messageType){if(aui&&aui.message)try{var auiMessageContainer=AJS.$('\x3cdiv class\x3d"aui-message-container"/\x3e');var message=messageObject;if(messageObject.html)message=messageObject.html();var templateParameters={"content":message};var formattedMessage;switch(messageType){case "error":formattedMessage=aui.message.error(templateParameters);break;case "success":formattedMessage=aui.message.success(templateParameters);break;case "warning":formattedMessage=aui.message.warning(templateParameters);
break;default:formattedMessage=aui.message.info(templateParameters)}auiMessageContainer.append(formattedMessage);messageObject=auiMessageContainer}catch(e){if(AJS&&AJS.logError)AJS.logError("jira-connector",e)}container.append(messageObject)},errorMsg:function(container,messageObject){this.removeError(container);var errorBlock=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(container):AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(container);
this.msg(errorBlock,messageObject,"error")},warningMsg:function(container,messageObject){this.removeError(container);var warningBlock=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').prependTo(container):AJS.$('\x3cdiv class\x3d"jira-error"\x3e\x3c/div\x3e').appendTo(container);this.msg(warningBlock,messageObject,"warning")},noServerMsg:function(container,messageObject){var dataContainer=AJS.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(container);
var messagePanel=this.SHOW_MESSAGE_ON_TOP?AJS.$('\x3cdiv class\x3d"message-panel"/\x3e').prependTo(dataContainer):AJS.$('\x3cdiv class\x3d"message-panel"/\x3e').appendTo(dataContainer);this.msg(messagePanel,messageObject,"info")},ajaxError:function(xhr,onOauthFail){if(xhr.status==401){var authUrl=this.getOAuthRealm(xhr);this.selectedServer.authUrl=authUrl;onOauthFail.call(this)}else this.errorMsg(this.container,"Received the following HTTP error code from the server"+": "+xhr.status)},removeError:function(container){AJS.$("div.jira-error",
container).remove()},setActionOnEnter:function(input,f,source){input.unbind("keydown").keydown(function(e){if(e.which==13){var keyup=function(e){input.unbind("keyup",keyup);f(source);e.stopPropagation();return false};input.keyup(keyup);e.stopPropagation();return false}})},createOauthForm:function(success){var server=this.selectedServer;var oauthCallbacks={onSuccess:function(){server.authUrl=null;success(server)},onFailure:function(){}};var oauthMessage='\x3ca class\x3d"oauth-init" href\x3d"javascript:void(0)"\x3e'+
"Login & Approve"+"\x3c/a\x3e "+"to retrieve data from"+" "+AJS.escapeHtml(this.selectedServer.name);var oauthForm=AJS.$('\x3cdiv class\x3d"jira-oauth-message-marker"/\x3e');if(!(aui&&aui.message))oauthForm.addClass("oauth-message");this.msg(oauthForm,oauthMessage,"info");AJS.$(".oauth-init",oauthForm).click(function(e){AppLinks.authenticateRemoteCredentials(server.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});
return oauthForm},applinkServerSelect:function(container,onchange){var servers=AJS.Editor.JiraConnector.servers;AJS.$(servers).each(function(){var option="\x3coption ";if(this.selected){selectedServer=this;option+='selected\x3d"selected"'}option+='value\x3d"'+this.id+'"\x3e\x3c/option\x3e';option=AJS.$(option);option.text(this.name);AJS.$(container).append(option);option.data("jiraapplink",this)});AJS.$(container).change(function(e){var option=AJS.$("option:selected",container);var server=option.data("jiraapplink");
onchange(server)})},showSpinner:function(element,radius,centerWidth,centerHeight){AJS.$.data(element,"spinner",Raphael.spinner(element,radius,"#666"));if(centerWidth)AJS.$(element).css("marginLeft",-radius*1.2);if(centerHeight)AJS.$(element).css("marginTop",-radius*1.2)},hideSpinner:function(element){AJS.$(element).css("marginTop","");AJS.$(element).css("marginLeft","");var spinner=AJS.$.data(element,"spinner");if(spinner){spinner();delete spinner;AJS.$.data(element,"spinner",null)}},setSelectedIssue:function(issue){this.selectedIssue=
issue;this.enableInsert()},insertSelected:function(){if(this.selectedIssue)this.insertIssueLink(this.selectedIssue.key)},createIssueTableFromUrl:function(container,appId,url,selectHandler,enterHandler,noRowsHandler,onSuccess,onError,isShowCheckBox){AJS.$("div.data-table",container).remove();var dataContainer=AJS.$('\x3cdiv class\x3d"data-table jiraSearchResults" \x3e\x3c/div\x3e').appendTo(container);var spinnyContainer=AJS.$('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e').appendTo(dataContainer);
this.removeError(container);this.showSpinner(spinnyContainer[0],50,true,true);var thiz=this;this.currentXhr=AppLinks.makeRequest({appId:appId,type:"GET",url:url,dataType:"xml",success:function(data){spinnyContainer.remove();var issues=AJS.$("item",data);FormStateControl.enableElement(AJS.$(":disabled",container));if(issues.length){var table=AJS.$('\x3ctable class\x3d"my-result aui"\x3e\x3c/table\x3e');AJS.$(".jiraSearchResults",container).append(table);var columns=[];if(isShowCheckBox){var checkBoxColumn=
{className:"issue-checkbox-column",title:'\x3cinput type\x3d"checkbox" name\x3d"jira-issue-all" checked/\x3e',renderCell:function(td,issue){var issueCheckbox=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({"issueKey":issue.key});AJS.$(issueCheckbox).appendTo(td)}};columns.push(checkBoxColumn)}var defaultColumns=[{className:"issue-key-column",title:"Key",renderCell:function(td,issue){var issueKey=Confluence.Templates.ConfluenceJiraPlugin.issueKey({"issueIconUrl":issue.iconUrl,
"issueKey":issue.key});AJS.$(issueKey).appendTo(td)}},{className:"issue-summary-column",title:"Summary",renderCell:function(td,issue){td.text(issue.summary)}}];columns=columns.concat(defaultColumns);var dataTable=new AJS.DataTable(table,columns);AJS.$(issues).each(function(){var issue={iconUrl:AJS.$("type",this).attr("iconUrl"),key:AJS.$("key",this).text(),summary:AJS.$("summary",this).text(),url:AJS.$("link",this).text()};dataTable.addRow(issue)});table.bind("row-action",
function(e,data){enterHandler.call(thiz,data)});table.bind("row-select",function(e,data){selectHandler.call(thiz,data)});dataTable.selectRow(0);if(onSuccess){var totalIssues=AJS.$("issue",data).attr("total");onSuccess.call(thiz,totalIssues)}}else{if(noRowsHandler)noRowsHandler();var message="No search results found.";var messagePanel=AJS.$('\x3cdiv class\x3d"message-panel"/\x3e');thiz.msg(messagePanel,message,"info");AJS.$(".jiraSearchResults",container).append(messagePanel)}},
error:function(xhr){FormStateControl.enableElement(AJS.$(":disabled",container));spinnyContainer.remove();onError.call(thiz,xhr)}})},retrieveJson:function(appId,url,onSuccess,onError){AppLinks.makeRequest({appId:appId,type:"GET",url:url,dataType:"json",success:onSuccess,error:onError})}}})(AJS);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",defaultColumnIds:"issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution",aliases:[{id:"issuekey",clauseName:"key"},{id:"issuetype",clauseName:"type"},{id:"duedate",clauseName:"due"}],DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1E3,MINIMUM_MAX_ISSUES_VAL:1,
title:function(){return "Search"},init:function(a){var c=require("confluence/form-state-control");a.html('\x3cdiv id\x3d"my-jira-search"\x3e\x3c/div\x3e');var b=this,d=AJS.$("#my-jira-search");this.container=d;var f=function(){d.children(":not(div.jira-search-form)").remove()},p=function(){c.enableElement(AJS.$("input.text,button",d))},n=function(){c.disableElement(AJS.$("input.text,button",d))},l=function(e){f();b.disableInsert();e&&(b.selectedServer=e);b.selectedServer.authUrl?
(n(),e=b.createOauthForm(function(){f();p()}),d.append(e)):(p(),AJS.$(".search-help").show())};this.authCheck=l;this.doSearch=function(e){var m=e&&e.searchValue,g=e&&e.serverName;m&&AJS.$("input:text",d).val(m);if(g&&g!=this.selectedServer.name){for(var q=AJS.Editor.JiraConnector.servers,t=!1,r=0;r<q.length;r++)if(q[r].name==g){AJS.$('option[value\x3d"'+q[r].id+'"]',d).attr("selected","selected");AJS.$("select",d).change();t=!0;break}if(!t){k(AJS.Meta.get("is-admin"));return}}this.currentXhr&&4!=
this.currentXhr.readyState||(g=m||AJS.$("input",d).val(),AJS.Editor.JiraAnalytics&&(m=AJS.JQLHelper.checkQueryType(g))&&AJS.Editor.JiraAnalytics.triggerSearchEvent({type:m,source:"dialog"}),m=function(w,v,x){v=d.find("#jiraIssueColumnSelector");var y=v.val()&&v.val();c.disableElement(AJS.$("select",d));n();b.lastSearch=w;b.createIssueTableFromUrl(d,b.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3d"+encodeURIComponent(w)+"\x26returnMax\x3dtrue\x26tempMax\x3d20\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink",
b.selectHandler,b.insertLinkFromForm,function(){b.addDisplayOptionPanel();b.loadMacroParams(y);b.bindEventToDisplayOptionPanel(!0,e);b.enableInsert()},function(u){b.addDisplayOptionPanel();b.loadMacroParams(y);b.bindEventToDisplayOptionPanel(!1,e);b.updateTotalIssuesDisplay(u);b.checkAutoSelectColumns();e&&e.isAutoSearch&&b.focusForm()},function(u){b.disableInsert();400==u.status?x?x():(AJS.$("div.data-table",d).remove(),b.warningMsg(d,AJS.format("The Jira server didn\u0027\u0027t understand your search query. If you entered JQL, please ensure that it\u0027\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))):
(AJS.$("div.data-table",d).remove(),b.ajaxError(u,l));e&&e.isAutoSearch&&b.focusForm()},!0)},AJS.JQLHelper.isFilterUrl(g)?(g=decodeURIComponent(g),q=AJS.JQLHelper.findServerIndexFromUrl(g,AJS.Editor.JiraConnector.servers),-1!=q?(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[q].id+'"]',d).attr("selected","selected"),AJS.$("select",d).change(),(g=AJS.JQLHelper.getFilterFromFilterUrl(g))?(AJS.$("input",d).val(g),m(g)):(f(),b.warningMsg(d,AJS.format("The Jira server didn\u0027\u0027t understand your search query. If you entered JQL, please ensure that it\u0027\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",
Confluence.Templates.ConfluenceJiraPlugin.learnMore())))):(f(),b.disableInsert(),k(AJS.Meta.get("is-admin")))):AJS.JQLHelper.isIssueUrlOrXmlUrl(g)?(g=decodeURIComponent(g),g=AJS.JQLHelper.getJqlAndServerIndexFromUrl(g,AJS.Editor.JiraConnector.servers),h(g)&&(AJS.$("input",d).val(g.jqlQuery),m(g.jqlQuery,!1,null))):g.match(b.jql_operators)?m(g,!1,null):AJS.JQLHelper.isSingleKeyJQLExp(g)?m("key \x3d "+g,!0):AJS.JQLHelper.isMultipleSingleKeyJQLExp(g)?m("key in ("+g+")",!0):m('summary ~ "'+g+'" OR description ~ "'+
g+'"',!1,null))};b.addSearchForm();var h=function(e){if(-1!=e.serverIndex)if(AJS.$('option[value\x3d"'+AJS.Editor.JiraConnector.servers[e.serverIndex].id+'"]',d).attr("selected","selected"),AJS.$("select",d).change(),0==e.jqlQuery.length)f(),b.errorMsg(d,"The Jira server didn\u0027t understand your search query. If you entered JQL, please ensure that it\u0027s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}");else var m=e.jqlQuery;else f(),b.disableInsert(),k(AJS.Meta.get("is-admin"));return m};b.processJiraParams=h;var k=function(e){e=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:e,
contextPath:Confluence.getContextPath()});b.noServerMsg(d,e);AJS.$("#open_applinks").bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=!0;AJS.Editor.JiraConnector.refreshAppLink=function(){b.refreshSearchForm()}})};b.bindPasteEvent();AJS.$(a).select(function(){b.validate()});$(document).tooltip({live:".jql-display-opts-open.disabled",title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0})},focusForm:function(){AJS.$('input[name\x3d"jiraSearch"]',
this.container).focus()},addSearchForm:function(){var a=this;a.container.empty();var c=AJS.Editor.JiraConnector.servers;a.selectedServer=c[0];var b=!1;1<c.length&&(b=!0);b=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:b});b=AJS.$(b).appendTo(a.container);1<c.length&&(c=AJS.$('\x3cselect class\x3d"select" tabindex\x3d"0"\x3e\x3c/select\x3e').insertAfter("div.search-input",b),a.applinkServerSelect(c,a.authCheck));a.authCheck(a.selectedServer);AJS.$("button",a.container).click(function(){a.doSearch()});
a.setActionOnEnter(AJS.$("input.text",a.container),a.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var c=this;setTimeout(function(){var b=AJS.$(c).val();AJS.JQLHelper.isFilterUrl(b)?a.doSearch():AJS.JQLHelper.isIssueUrlOrXmlUrl(b)&&(b=decodeURIComponent(b),b=AJS.JQLHelper.getJqlAndServerIndexFromUrl(b,AJS.Editor.JiraConnector.servers),a.processJiraParams(b)&&(AJS.$(c).val(b.jqlQuery),a.doSearch()))},100)})},refreshSearchForm:function(){this.container.empty();
this.addSearchForm();this.bindPasteEvent()},validate:function(a,c){var b=this.container,d=AJS.$("input:checkbox[name\x3djira-issue]",b),f=AJS.Editor.JiraConnector.Panel.Search.prototype;d.length||a?(b=AJS.$("input:checkbox[name\x3djira-issue]:checked",b).length,0<b||a?f.enableInsert():f.disableInsert(),f.changeInsertOptionStatus(b,a,c)):(AJS.$(".jira-oauth-message-marker",b).length&&f.authCheck(this.selectedServer),AJS.$("input",b).focus(),f.disableInsert());f.isInsertDisabled()||f.validateMaxIssues()},
isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL},validateMaxIssues:function(a){function c(){b.next("#jira-max-number-error").remove()}var b=AJS.$("#jira-maximum-issues");switch(AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()){case "insert-single":case "insert-count":c();b.attr("disabled","disabled");break;case "insert-table":var d=AJS.Editor.JiraConnector.Panel.Search.prototype;b.removeAttr("disabled");var f=b.val();
if(""===AJS.$.trim(f)){if(a&&"keyup"===a.type){c();break}if(a&&"blur"===a.type){f=d.MAXIMUM_MAX_ISSUES_VAL;b.val(f);break}}d.isValidMaxIssues(f)?(c(),d.enableInsert()):(c(),b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues()),d.disableInsert())}},customizedColumn:null,checkAndSetDefaultValueMaximumIssues:function(a){if(a){var c=a.element||AJS.$("#jira-maximum-issues");a=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;""===AJS.$.trim(c.val())&&c.val(a)}else AJS.log("Cannot set default value for Maximum Issues")},
setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var a=this,c="insert-count"==AJS.$("input:radio[name\x3dinsert-advanced]:checked").val(),b=[],d=[],f=[],p=[],n=[],l={};AJS.$("#my-jira-search .my-result.aui input:checkbox[name\x3djira-issue]").each(function(h){h=AJS.$(this);h.is(":checked")?d[d.length]=h.val():f[f.length]=h.val()});if(c)l.count="true";else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){l.columns=this.defaultColumns;l.columnIds=this.defaultColumnIds;
return}b=AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.select2("data");b.length?(l.columns=b.map(function(h){return a.selectedServer.columns.find(function(k){return k.id===h.id}).custom?h.text.replace(/%/g,encodeURIComponent("%")).replace(/,/g,encodeURIComponent(",")).replace(/;/g,encodeURIComponent(";")):h.id}).map(function(h){var k=a.aliases.find(function(e){return e.id===h});return k?k.clauseName:h}).join(","),l.columnIds=b.map(function(h){return h.id}).join(","),(p=a.selectedServer.columns.find(function(h){return h.clauseNames.find(function(k){k=
k.toLowerCase();return"epic link"===k||"gh.epic.link.name"===k})}))&&!b.some(function(h){return h.id===p.id})&&(n=a.selectedServer.columns.filter(function(h){return h.clauseNames.find(function(k){k=k.toLowerCase();return"epic name"===k||"gh.epic.label.name"===k||"epic colour"===k||"gh.epic.color.name"===k||"epic status"===k||"gh.epic.status.name"===k})}),b.some(function(h){return n.some(function(k){return k.id===h.id})})&&(l.epicLinkId=p.id))):(l.columns=this.defaultColumns,l.columnIds=this.defaultColumnIds)}c=
AJS.$("input:radio[name\x3dinsert-advanced]:checked").val();"insert-single"===c?l.key=d.toString():l.jqlQuery=0==f.length?this.lastSearch+" ":1==d.length?"key \x3d "+d.toString():"key in ("+d.toString()+")";"insert-table"===c&&(l.maximumIssues=AJS.$("#jira-maximum-issues").val());return l},insertLinkFromForm:function(){var a=this.container;AJS.$("input:checkbox[name\x3djira-issue]",a).length&&0<AJS.$("input:checkbox[name\x3djira-issue]:checked",a).length&&this.insertLink()},insertLink:function(a){a=
a&&"function"===typeof a.insertIssueLinkWithParams?a:this;var c=a.getMacroParamsFromUserInput();a.insertIssueLinkWithParams(c);return!0},loadMacroParams:function(a){var c=this.macroParams;c?(c.maximumIssues||AJS.$("#jira-maximum-issues").attr("disabled","disabled"),"true"==c.count?AJS.$("#opt-total").prop("checked",!0):(AJS.$("#opt-table").prop("checked",!0),AJS.$("#jira-maximum-issues").removeAttr("disabled"),this.checkAndSetDefaultValueMaximumIssues({defaultVal:c.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL}))):
this.checkAndSetDefaultValueMaximumIssues({defaultVal:20});this.prepareColumnSelect(a)},selectHandler:function(){var a=this.container.find("tr.selected");a.length&&a.unbind("keydown.space").bind("keydown.space",function(c){32!=c.which&&32!=c.keyCode||a.find("[type\x3dcheckbox]").trigger("click")})},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(c){return!1})},
updateTotalIssuesDisplay:function(a){var c=this.selectedServer.url+"/issues/?jql\x3d"+this.lastSearch;20<a&&AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:c}));a=AJS.format("{0} issues",a);AJS.$(".total-issues-text").html(a);AJS.$(".total-issues-link").attr("href",c)},prepareColumnSelect:function(a){var c=this,b=!(this.macroParams&&!this.macroParams.columnIds),d=a||this.macroParams&&this.macroParams.columnIds&&this.macroParams.columnIds.split(",")||
this.macroParams&&this.macroParams.columns&&this.macroParams.columns.toLowerCase().split(",")||this.defaultColumnIds.split(","),f=this.selectedServer,p=function(n){var l=AJS.$("#jiraIssueColumnSelector"),h="",k="";n.filter(function(e){return e.navigable}).sort(function(e,m){var g=d.map(function(q){var t=c.aliases.find(function(r){return r.clauseName===q});return t?t.id:q});return g.indexOf(b||!e.custom?e.id:e.name.toLowerCase())-g.indexOf(b||!m.custom?m.id:m.name.toLowerCase())}).forEach(function(e){d.find(function(m){return b?
m===e.id:e.clauseNames.includes(m)||m===e.name.toLowerCase()})?k+=AJS.template('\x3coption selected\x3d"true" value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:e.id,fieldName:e.name}):h+=AJS.template('\x3coption value\x3d"{fieldId}"\x3e{fieldName}\x3c/option\x3e').fill({fieldId:e.id,fieldName:e.name})});l.hide();l.html(k+h);l.show();l.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns"});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=l};f.columns&&
0<f.columns.length?p(f.columns):this.retrieveJson(f.id,"/rest/api/2/field",function(n){n&&n.length&&(f.columns=n,p(f.columns))})},expandDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay"),c=a.height();a.css("top","");a.css("bottom",-(c-40)+"px");a.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:414},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",
!1)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",!0)},checkAutoSelectColumns:function(){AJS.$("#opt-table").prop("checked")?this.enableAutoSelectColumns():(this.disableAutoSelectColumns(),this.enableInsert())},bindEventToDisplayOptionPanel:function(a,c){var b=this,d=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),f=AJS.$(".jql-display-opts-overlay"),p=AJS.$(".jql-display-opts-inner .radio"),n=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]"),
l=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]");AJS.$("#jira-maximum-issues").on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);f.css("top","414px");d.click(function(h){h.preventDefault();AJS.$(this).hasClass("disabled")||(AJS.$(this).hasClass("jql-display-opts-open")?(b.expandDisplayOptPanel(),jQuery(this).addClass("jql-display-opts-close"),jQuery(this).removeClass("jql-display-opts-open")):(b.minimizeDisplayOptPanel(),jQuery(this).removeClass("jql-display-opts-close"),
jQuery(this).addClass("jql-display-opts-open")))});p.change(function(){b.checkAutoSelectColumns();b.validateMaxIssues()});n.bind("click",function(){AJS.$(this).prop("checked")?l.prop("checked","checked"):l.removeAttr("checked");b.validate()});l.change(function(){0<AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:not(:checked)").length?n.removeAttr("checked"):n.prop("checked","checked");b.validate()});b.validate(a,c)},changeInsertOptionStatus:function(a,c,b){var d=AJS.$("#opt-single"),f=AJS.$("#opt-total"),
p=AJS.$("#opt-table"),n=AJS.$("#my-jira-search input:checkbox[name\x3djira-issue]:checked");a="checked"===AJS.$("#my-jira-search input:checkbox[name\x3djira-issue-all]").attr("checked");var l=1===n.length,h=1<n.length;n=0===n.length;var k=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name\x3djiraSearch]").val()),e=function(){b&&b.isJqlQuery?p.click():d.click()},m=function(){f.attr("disabled","disabled");p.removeAttr("disabled");d.removeAttr("disabled");e();setTimeout(function(){e()},
100)},g=function(){d.attr("disabled","disabled");f.removeAttr("disabled");"insert-single"===AJS.$("input[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){p.removeAttr("disabled").click()},100)},q=function(){p.removeAttr("disabled","disabled");f.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");"insert-single"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()&&setTimeout(function(){p.click()},100)};AJS.$(".jql-display-opts-open").removeClass("disabled");
d.removeAttr("disabled");f.removeAttr("disabled");p.removeAttr("disabled");a&&l&&k?m():a&&l&&!k?q():h?g():l&&!a?m():c?g():n&&(d.attr("disabled","disabled"),f.attr("disabled","disabled"),p.attr("disabled","disabled"),AJS.$(".jql-display-opts-close").click(),AJS.$(".jql-display-opts-open").addClass("disabled"))},isInsertTableType:function(){return"insert-table"===AJS.$("input:radio[name\x3dinsert-advanced]:checked").val()},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),
c=AJS.$("#jira-maximum-issues");!a.length||a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(c.val())?this.disableInsert():this.enableInsert()},analyticPanelActionName:"confluence.jira.plugin.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:!0,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(a){var b=AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl);b.length&&b.val(a)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",
this.container);a.length?a.focus():(a=AJS.$(".project-select",this.container),a.length&&a.focus())},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();this.selectedServer.authUrl?this.showOauthChallenge():this.serverSelect()},ajaxAuthCheck:function(a){var b=this;this.endLoading();this.ajaxError(a,function(){b.authCheck(b.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",
this.container).remove();var a=this,b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(!1===this.formHasError&&this.projectOk())return this.enableInsert(),!0;this.disableInsert();return!1},startLoading:function(){var a=require("confluence/form-state-control");this.removeError(this.container);AJS.$(".loading-blanket",
this.container).removeClass("hidden");a.disableElement(AJS.$("input,select,textarea",this.container));this.disableInsert();this.handleInsertWaiting(!0)},endLoading:function(){var a=require("confluence/form-state-control");AJS.$(".loading-blanket",this.container).addClass("hidden");a.enableElement(AJS.$("input,select,textarea",this.container));AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE&&a.disableElement(AJS.$(".issuetype-select",this.container));this.setInsertButtonState();
this.handleInsertWaiting(!1)},bindEvent:function(){var a=this;AJS.$('.field-group [name\x3d"summary"]',this.jipForm.formEl).keyup(function(){a.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var b=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid\x3d"+b+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "Create New Issue"},init:function(a){var b=this;
a.html('\x3cdiv class\x3d"create-issue-container"\x3e\x3c/div\x3e');this.container=AJS.$("div.create-issue-container");this.selectedServer=AJS.Editor.JiraConnector.servers[0];this.jipForm=new (require("jira-integration-plugin/jira-create-issue-form"))({container:".create-issue-container",renderSummaryAndDescription:!0,onError:function(){AJS.$(".field-group .error",this.container).remove();b.formHasError=!0;b.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();
b.setInsertButtonState();b.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(f,d){AJS.$(".field-group .error",this.container).remove();b.formHasError=!!d.length;b.setInsertButtonState()},ajax:AJS.$.ajax});a.onselect=function(){b.onselect()};this.bindEvent()},convertFormToJSON:function(a){const b=require("jira-integration-plugin/fields");if(!b)return AJS.logError("Jira integration plugin is missing!"),"";var f={issues:[]},d={};d.fields={project:{id:AJS.$(".project-select option:selected",
a).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",a).val()},summary:AJS.$('.field-group [name\x3d"summary"]',a).val(),description:AJS.$('.field-group [name\x3d"description"]',a).val()};a.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(c,e){c=AJS.$(e);d.fields[c.attr("name")]=b.getJSON(c)});f.issues.push(d);return JSON.stringify(f)},validateRequiredFieldInForm:function(a){var b=!0,f="placeholder"in
document.createElement("input");a.find(".field-group .icon-required, .field-group .aui-icon-required").each(function(d,c){c=AJS.$(c).parent();d=c.text();var e=c.nextAll("input,select,textarea"),g=AJS.$.trim(e.val());if(!g||!f&&g==e.attr("placeholder"))b=!1,c=c.parent(),d=AJS.format("{0} is required",d),c.append(aui.form.fieldError({message:d}))});return b},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var a=this,b=Confluence.getContextPath()+
"/rest/jira-integration/1.0/issues",f=AJS.$("div.create-issue-container form"),d=this.jipForm.getCurrentServer();a.clearFieldErrors();a.validateRequiredFieldInForm(f)&&(this.startLoading(),AJS.$.ajax({type:"POST",contentType:"application/json",url:b+"?applicationId\x3d"+this.selectedServer.id,data:this.convertFormToJSON(f),success:function(c){var e=c&&c.issues&&c.issues[0]&&c.issues[0].issue&&c.issues[0].issue.key;e?(a.insertIssueLink(e,d.displayUrl+"/browse/"+e),a.resetIssue()):(_.isEmpty(c.errors[0].elementErrors.errorMessages)||
(e=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:c.errors[0].elementErrors.errorMessages,serverUrl:d.displayUrl}),a.errorMsg(AJS.$("div.create-issue-container"),e)),_.each(c.errors[0].elementErrors.errors,function(g,h){g=aui.form.fieldError({message:g});AJS.$(AJS.format(".field-group [name\x3d{0}]",h),f).after(g)}));a.endLoading()},error:function(c,e){a.ajaxAuthCheck(c)}}))},onselect:function(){var a=!!AJS.$(".aui-message \x3e .oauth-init",this.container).length;this.selectedServer&&
!this.selectedServer.authUrl&&a?this.jipForm.defaultFields.server.trigger("change"):this.setInsertButtonState()},analyticPanelActionName:"confluence.jira.plugin.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);
AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "Recently Viewed"},init:function(d){var a=AJS.Editor.JiraConnector.servers;d.html('\x3cdiv id\x3d"my-recent-issues" '+(1<a.length?'class\x3d"multi-server" ':"")+"\x3e\x3c/div\x3e");var b=this;this.selectedServer=a[0];1<a.length&&(a=AJS.$('\x3cdiv class\x3d"jira-server-select"\x3e\x3cform action\x3d"#" method\x3d"post" class\x3d"aui"\x3e\x3cdiv class\x3d"field-group"\x3e\x3clabel\x3eServer\x3c/label\x3e\x3cselect class\x3d"select" \x3e\x3c/select\x3e\x3c/div\x3e\x3c/form\x3e\x3c/div\x3e').appendTo("div#my-recent-issues"),
this.applinkServerSelect(AJS.$(".select",a),function(e){b.selectedServer=e;b.onselect()}));d.onselect=function(){b.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var d=require("confluence/form-state-control"),a=this,b=AJS.$("div#my-recent-issues");this.container=b;var e=function(){b.children().not(".jira-server-select").remove()},g=function(){if(a.selectedServer.authUrl){e();var c=a.createOauthForm(function(){f()});b.append(c)}else f()};var f=function(){if(!a.currentXhr||
4==a.currentXhr.readyState){var c=AJS.$(".select",b);d.disableElement(c);e();a.createIssueTableFromUrl(b,a.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery\x3dkey+in+issueHistory()+ORDER+BY+lastViewed+DESC\x26field\x3dsummary\x26field\x3dtype\x26field\x3dlink\x26tempMax\x3d50\x26returnMax\x3dtrue",a.setSelectedIssue,a.insertLink,a.disableInsert,function(){c.length&&c.focus()},function(h){AJS.$("div.data-table",b).remove();a.ajaxError(h,g)},!1)}};g()},analyticPanelActionName:"confluence.jira.plugin.recentlyviewadded"});
AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-bar data-table\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-overlay data-table\' data-js="display-option-wrapper"><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-js="display-option-trigger" data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a><fieldset class="group"><legend><span>' + soy.$$escapeHtml('Display as') + '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>' + soy.$$escapeHtml('Single issue') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display the macro as a single issue.') + '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>' + soy.$$escapeHtml('Total issue count') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display total number of issues as a link. E.g.') + '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>' + soy.$$escapeHtml(AJS.format('{0} issues',12)) + '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>' + soy.$$escapeHtml('Table') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Customize your columns below.') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('Maximum issues') + '</label><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field" /><div class="description">' + soy.$$escapeHtml('Leave empty to get all issues.') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('Columns to display') + '</label><select id="jiraIssueColumnSelector" data-placeholder="' + soy.$$escapeHtml('Start typing to see possible columns') + '" multiple="true" class="select long-field"></select></div></fieldset></div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_ignored) {
  return '<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'search-input\'><input type=\'text\' class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>' : '<div class=\'search-input one-server\'><input type=\'text\' class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>') + '<button type=\'button\' title="' + soy.$$escapeHtml('Search') + '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter') + '</div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.searchForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.searchForm';
}


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_ignored) {
  return '<div class=\'warning-body\'><p>' + soy.$$escapeHtml('If you connect Confluence to Jira you can easily link issues...') + '</p>' + ((opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml('Your administrator can set this up.') + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningDialog.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningDialog';
}


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_ignored) {
  return '<input type=\'checkbox\' name=\'jira-issue\' value=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\' checked/>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox';
}


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_ignored) {
  return '<span><img class="icon" src="' + soy.$$escapeHtml(opt_data.issueIconUrl) + '"/> ' + soy.$$escapeHtml(opt_data.issueKey) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueKey.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueKey';
}


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_ignored) {
  return '' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer';
}


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_ignored) {
  return '<div class=\'view-all\'>' + soy.$$escapeHtml('Displaying first 20 results.') + '<a href=\'' + soy.$$escapeHtml(opt_data.jiraIssuesLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml('View all.') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.viewAll.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.viewAll';
}


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml('https://confluence.atlassian.com/display/DOC/Jira+Issues+Macro') + '" target=\'_blank\'>' + soy.$$escapeHtml('Learn More') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.learnMore.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.learnMore';
}


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_ignored) {
  return '<div id="jira-chart-content-' + soy.$$escapeHtml(opt_data.chartType) + '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input\'><input type=\'text\' id="jira-chart-search-input" class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div><select id="jira-chart-servers" class="select" name="server" tabindex="0"></select>' : '<div class=\'jira-chart-search-input one-server\'><input type=\'text\' id="jira-chart-search-input" class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('e.g. filter \x3d \x22My Jira filter\x22') + '"/></div>') + '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>' + soy.$$escapeHtml('Preview') + '</button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter') + '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option" data-js="display-option-wrapper" ><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" data-js="display-option-trigger" href="javascript:void(0)"><span class="display-option-icon"></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a>' + ((opt_data.chartType == 'pie') ? Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null) : (opt_data.chartType == 'createdvsresolved') ? Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null) : (opt_data.chartType == 'twodimensional') ? Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null) : '') + '</div></form></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart';
}


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="jira-chart-statType">' + soy.$$escapeHtml('Chart by') + '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.piechartForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.piechartForm';
}


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">' + soy.$$escapeHtml('Period') + '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">' + soy.$$escapeHtml('Hourly') + '</option><option value="daily">' + soy.$$escapeHtml('Daily') + '</option><option value="weekly">' + soy.$$escapeHtml('Weekly') + '</option><option value="monthly">' + soy.$$escapeHtml('Monthly') + '</option><option value="quarterly">' + soy.$$escapeHtml('Quarterly') + '</option><option value="yearly">' + soy.$$escapeHtml('Yearly') + '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">' + soy.$$escapeHtml('Days previously') + '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="' + soy.$$escapeHtml('Number of days to include (counting back from today).') + '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">' + soy.$$escapeHtml('Cumulative totals') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="' + soy.$$escapeHtml('Progressively add totals (1, 2, 3) or show individual values (1,1,1).') + '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">' + soy.$$escapeHtml('Show unresolved trend') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="' + soy.$$escapeHtml('Include a subplot showing unresolved issues.') + '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">' + soy.$$escapeHtml('Show versions') + '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">' + soy.$$escapeHtml('All versions') + '</option><option value="major">' + soy.$$escapeHtml('Only major versions') + '</option><option value="none">' + soy.$$escapeHtml('None') + '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="' + soy.$$escapeHtml('Mark version release dates in the chart.') + '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved';
}


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_ignored) {
  return '<fieldset><div id="jira-chart-support-all-version" class="hidden"></div><div class="field-group"><label for="twodimensional-xaxis">' + soy.$$escapeHtml('XAxis') + '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">' + soy.$$escapeHtml('YAxis') + '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">' + soy.$$escapeHtml('Rows to display') + '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.twoDimensional.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.twoDimensional';
}


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message error closeable shadowed"><span class=\'message\'>' + soy.$$escapeHtml(opt_data.message) + '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage';
}


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.noServerWarning.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.noServerWarning';
}


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">' + soy.$$escapeHtml('More to come...') + '</a></button></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink';
}


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>' + soy.$$escapeHtml('OTHER Jira CONTENT') + '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.label) + '</button></li></ul></div></nav></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink';
}


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('The Jira server didn\x27t understand your search query. If you entered JQL, please ensure that it\x27s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_ignored) {
  return '<div class="error width-error">' + ((opt_data.error == 'wrongFormat') ? soy.$$escapeHtml('The width must be in correct format') : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml('The width must be a number between 100 and 9000') : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_ignored) {
  return '<div id="jira-max-number-error" class="error">' + soy.$$escapeHtml('Must be a number between 1 and 1000.') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues';
}


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_ignored) {
  return '<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira Charts are not available for your version of Jira. Upgrade to Jira 6.1.1 or later to use this macro.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"></div></div><div class="field-group servers"><label>' + soy.$$escapeHtml('Server') + '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>' + soy.$$escapeHtml('Project') + '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>' + soy.$$escapeHtml('Issue Type') + '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>' + soy.$$escapeHtml('Summary') + '<span class="aui-icon icon-required"></span></label><input class="text issue-summary" type="text" name="summary"/></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>' + soy.$$escapeHtml('Description') + '</label><textarea class="issue-description textarea" rows="5" name="description"></textarea></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_ignored) {
  var output = '';
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output += '<option value="' + soy.$$escapeHtml(optionData15.id) + '">' + soy.$$escapeHtml(optionData15.name) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOptions.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOptions';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_ignored) {
  return '<option value="' + soy.$$escapeHtml(opt_data.option.id) + '" data-jira-option-key="' + soy.$$escapeHtml(opt_data.option.key) + '">' + soy.$$escapeHtml(opt_data.option.name) + '</option>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOption.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOption';
}


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_ignored) {
  var output = '<div>' + soy.$$escapeHtml('There were errors creating an issue in') + '<a target="_blank" href=' + soy.$$escapeHtml(opt_data.serverUrl) + '>Jira</a></div><ul>';
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output += '<li>' + soy.$$escapeHtml(errorData36) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:text-placeholders-jira', location = '/jira/placeholder.js' */
(function(){AJS.bind("init.rte",function(){AJS.bind("editor.text-placeholder.activated",function(b,a){a&&"jira"===a.placeholderType&&AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.instructionalText)});AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType&&AJS.Rte.Placeholder.addPlaceholderType({type:"jira",label:"Jira Macro",tooltip:"Instructional text is replaced with a Jira Macro on click.",activation:{click:!0,keypress:!1}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=function(h){var l=require("confluence/form-state-control"),x="Insert",y="Cancel",z="Insert Jira Chart",c,d,u=function(a){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(z);d=AJS.Editor.JiraChart.Panels;for(var b=0;b<d.length;b++){"function"===typeof d[b].title?c.addPanel(d[b].title()):void 0!==d[b].title&&c.addPanel(d[b].title);
var f=c.getCurrentPanel();d[b].init(f)}h("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"Jira Issue/Filter"}));c.addButton(x,function(){var e=d[c.getCurrentPanel().id],g=e.chartType;0<c.getCurrentPanel().body.find("#jira-chart-content-"+g).length&&e.isImageChartExisted()?(e=e.getMacroParamsFromDialog(),t(e),AJS.Editor.JiraChart.close()):m(h("#jira-chart-content-"+e.chartType))},"insert-jira-chart-macro-button");
c.addLink("Select Macro",function(){c.hide();AJS.MacroBrowser.open(!1)},"dialog-back-link");c.addCancel(y,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var e=d[c.getCurrentPanel().id],g=c.getCurrentPanel().body,n=AJS.Editor.JiraChart.Helper.getSelectedServer(g);p(g,n);k(g);e.handleInsertButton();e.focusForm();e.resetDisplayOption()});b=c.getCurrentPanel().body;k(b);var q=q||function(e){var g={};_.each(e,
function(n,A){g[n.chartType]=A});return g}(d);B(q,a);r();b=c;f=b.gotoPanel;a=a&&a.params?q[a.params.chartType]:0;f.call(b,a);c.overrideLastTab();c.show();C()},D=function(){_.each(AJS.Editor.JiraChart.Panels,function(a){a.preBinding&&"function"===typeof a.preBinding&&a.preBinding()})},C=function(){h("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();AJS.Editor.JiraConnector&&AJS.Editor.JiraConnector.openCleanDialog(!1)})},m=function(a){void 0!==AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(a)&&
d[c.getCurrentPanel().id].renderChart()},k=function(a){if(a.find("#jira-chart-support-all-version").length)return!0;var b=AJS.Editor.JiraChart.Helper.getSelectedServer(a).buildNumber;return-1==b||6109<=b&&6155>b?(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion()),a.find("#jira-chart-search-input").attr("disabled","disabled"),a.find("#jira-chart-search-button").attr("disabled","disabled"),a=a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),
a.hasClass("jirachart-display-opts-close")&&a.click(),a.addClass("disabled"),r(),!1):!0},t=function(a){AJS.Editor.inRichTextMode()&&tinymce.confluence.macrobrowser.macroBrowserComplete({name:"jirachart",params:a})},B=function(a,b){for(var f=0;f<d.length;f++)d[f].resetDialogValue();D();b&&b.params&&d[a[b.params.chartType]].bindingDataFromMacroToForm(b.params)},v=function(a){a.find(".jira-oauth-message-marker").remove();a.find(".jira-chart-img").empty();a.find("#jira-chart-search-input").empty()},r=
function(){l.disableElement(h("#jira-chart").find(".insert-jira-chart-macro-button"))},p=function(a,b){h(".jira-oauth-message-marker",a).remove();var f={selectedServer:b,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};b&&b.authUrl&&(b=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(f,function(){h(".jira-oauth-message-marker",a).remove();AJS.Editor.JiraChart.search(a)}),a.find("div.jira-chart-search").append(b))},w=function(a){a.find("#jira-chart-search-input").removeAttr("disabled");
a.find("#jira-chart-search-button").removeAttr("disabled");a.find(".jirachart-display-opts-open").removeClass("disabled")};return{close:function(){c.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},edit:function(a){if(void 0===AJS.Editor.JiraConnector.servers||0===AJS.Editor.JiraConnector.servers.length){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));var b=!1}else b=!0;b&&(u(a),b=c.getCurrentPanel().body,k(b)&&(w(b),void 0!==a.params&&void 0!==a.params.serverId&&m(b),
a=AJS.Editor.JiraChart.Helper.getSelectedServer(b),p(b,a)))},search:m,disableInsert:r,enableInsert:function(){var a=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");a.is(":disabled")&&l.enableElement(a)},disableSearch:function(a){l.disableElement(a.find("#jira-chart-search-button"))},enableSearch:function(a){a.find("#jira-chart-search-button").is(":disabled")&&l.enableElement(a.find("#jira-chart-search-button"))},insertJiraChartMacroWithParams:t,open:u,clearChartContent:v,loadServers:function(a){0<
AJS.Editor.JiraConnector.servers.length&&AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(a.find("#jira-chart-servers"),function(b){v(a);k(a)&&(p(a,b),w(a))})},validateServerSupportedChart:k}}(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=function(p){var m=/^\d+$/,f={},g=function(a){a=a&&"string"===typeof a?a.replace("px",""):"";"auto"===a&&(a="");0<a.indexOf("%")&&(a=4*a.replace("%",""));return a},k=function(a){return m.test(a)},h=function(a){var b=AJS.Editor.JiraConnector.servers;return 1<b.length?a.find("#jira-chart-servers option:selected").data("jiraapplink"):b[0]};return{getSelectedServer:h,bindingCommonChartElements:function(a){return{jql:a.find("#jira-chart-search-input"),width:a.find("#jira-chart-width"),
border:a.find(".jira-chart-show-border"),showinfor:a.find(".jira-chart-show-infor"),displayOption:a.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:a.find("#jira-chart-servers")}},bindingCommonDataFromMacroToForm:function(a,b){a.jql.val(decodeURIComponent(b.jql));a.width.val(b.width);a.border.attr("checked","true"===b.border);a.showinfor.attr("checked","true"===b.showinfor);1<AJS.Editor.JiraConnector.servers.length&&a.server.val(b.serverId)},getCommonMacroParamsFromDialog:function(a,
b){b=h(b);return{jql:encodeURIComponent(a.jql.val()),width:g(a.width.val()),border:a.border.prop("checked"),showinfor:a.showinfor.prop("checked"),serverId:b.id,server:b.name,isAuthenticated:!b.authUrl}},getCommonChartParamsRequest:function(a,b){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:a.jql,serverId:a.serverId,width:a.width,border:a.border,showinfor:a.showinfor,chartType:b}}}},convertSearchTextToJQL:function(a){var b=AJS.Editor.JiraConnector.servers,c=a.find("#jira-chart-search-input").val();
if(0===c.indexOf("http")){var e=AJS.JQLHelper.findServerIndexFromUrl(c,b);if(-1!==e)e=b[e].id,a.find("#jira-chart-servers").val(e);else{b=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});a.find(".jira-chart-img").html(b);AJS.Editor.JiraChart.disableInsert();return}}(b=AJS.JQLHelper.convertToJQL(c,e))?a.find("#jira-chart-search-input").val(b):(a.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid()),
AJS.Editor.JiraChart.disableInsert());return b},convertFormatWidth:g,isChartWidthValid:function(a){a.next().next(".width-error").remove();var b=g(a.val());if(b)if(k(b)){if(100>b||9E3<b)var c="wrongNumber"}else c="wrongFormat";return c?(a.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:c})),AJS.Editor.JiraChart.disableInsert(),!1):!0},isNumber:k,isJqlNotEmpty:function(a){return a?""!==AJS.$.trim(a.val())&&a.val()!==a.attr("placeholder"):!1},populateStatType:function(a,
b){var c=h(a);if(b){var e=f[c.id];e||AppLinks.makeRequest({appId:c.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:!1,success:function(d){d&&(e=f[c.id]=d)},error:function(d){if(d)try{f[c.id]=JSON.parse(d.responseText),e=JSON.parse(d.responseText)}catch(n){AJS.error("Error contacting the server "+c.id+" with response "+d.response)}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+c.id)}}).fail(function(d){if(d)try{f[c.id]=JSON.parse(d.responseText),e=JSON.parse(d.responseText)}catch(n){AJS.error("Error contacting the server "+
c.id+" with response "+d.response)}});var l="";e&&"undefined"!==typeof e.stats&&_.each(e.stats,function(d){l+="\x3coption value \x3d '"+d.value+"'\x3e"+AJS.escapeHtml(d.label)+" \x3c/option\x3e"});b.html(l)}}}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};
AJS.Editor.JiraChart.Panel.prototype={init:function(a){var d=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:1<AJS.Editor.JiraConnector.servers.length,chartType:this.chartType});a.html(d);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var a=this,d=function(){a.isFormValid()?AJS.Editor.JiraChart.search(a.container):
AJS.Editor.JiraChart.disableInsert()};a.container.find(a.clickableElements).click(d);a.container.find(a.onChangeElements).change(d);a.chartElements.jql.change(function(){this.value!==a.jqlWhenEnterKeyPress&&(a.container.find(".jira-chart-img").empty(),AJS.Editor.JiraChart.disableInsert());a.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){a.isFormValid()&&(a.jqlWhenEnterKeyPress=a.chartElements.jql.val(),AJS.Editor.JiraChart.search(a.container))},100)});var c=a.container.find("input[type\x3d'text']");
c.unbind("keydown").keydown(function(b){if(13==b.which){var f=function(e){c.unbind("keyup",f);a.isFormValid()&&AJS.Editor.JiraChart.search(a.container);"jira-chart-search-input"===c.attr("id")&&(a.jqlWhenEnterKeyPress=c.val());e.stopPropagation();return!1};c.keyup(f);b.stopPropagation();return!1}});a.bindSelectOption();a.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)?
AJS.Editor.JiraChart.search(a.container):AJS.Editor.JiraChart.disableInsert()})},renderChart:function(){var a=this,d=this.getChartParamsRequest(),c=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",b=this.container.find(".jira-chart-img");b.html('\x3cdiv class\x3d"loading-data"\x3e\x3c/div\x3e');var f=b.find(".loading-data")[0];AJS.$.data(f,"spinner",Raphael.spinner(f,50,"#666"));a.request&&a.request.abort();a.request=AJS.$.ajax({url:c,type:"POST",contentType:"application/json",data:JSON.stringify(d)}).done(function(e){b.html("").hide();
var g=AJS.$('\x3ciframe frameborder\x3d"0" id\x3d"chart-preview-iframe"\x3e\x3c/iframe\x3e');g.appendTo(b);var k=g[0].contentWindow,h=k.document;g.on("load",function(){k.AJS.$("#main").addClass("chart-preview-main");b.show();a.handleInsertButton()});e=e.replace("window.onload","var chartTest");h.open();h.write(e);h.close()}).error(function(e){"abort"!=e.statusText&&(AJS.log("Jira Chart Macro - Fail to get data from macro preview"),b.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"Unable to render Jira chart macro due to an execution error."})));
AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find("#jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var a=this,d=this.chartElements.displayOption;d.addClass("jirachart-display-opts-open");d.removeClass("jirachart-display-opts-close");setTimeout(function(){var c=a.container.find(".jira-chart-option");
c.scrollTop(0);c.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var a=this.container.find(".jira-chart-option"),d=function(c){var b=a.position().top+"px",f="",e={top:430};c?(b="",f=40-a.find("#jiraChartMacroOption").height()+"px",e={bottom:0},a.css("overflow","auto")):a.css("overflow","hidden");a.css("top",b);a.css("bottom",f);a.animate(e,500)};a.css("top","430px");this.chartElements.displayOption.click(function(c){var b=AJS.$(this);c.preventDefault();b.hasClass("disabled")||
(b.hasClass("jirachart-display-opts-open")?(d(!0),b.addClass("jirachart-display-opts-close"),b.removeClass("jirachart-display-opts-open")):(d(),b.removeClass("jirachart-display-opts-close"),b.addClass("jirachart-display-opts-open")))})},isImageChartExisted:function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length},focusForm:function(){this.container.find("#jira-chart-search-input").focus()},handleInsertButton:function(){this.isFormValid()&&this.isResultValid()?
AJS.Editor.JiraChart.enableInsert():AJS.Editor.JiraChart.disableInsert()}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var b=this;this.title="Pie Chart";this.chartType="pie";this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(b.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};
this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.statType);b.isFormValid()?AJS.Editor.JiraChart.search(b.container):
AJS.Editor.JiraChart.disableInsert()})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),c=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);c.macro.params.statType=a.statType;return c};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,
this.container);a.chartType="pie";a.statType=this.chartElements.statType.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,a),this.chartElements.statType.val(a.statType))};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var c=this,f=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")},g=function(){var a=c.chartElements.periodName.val(),b=e.trim(c.chartElements.daysprevious.val()),d=c.container.find(".days-previous-error");if(""===b)return c.container.find(".days-previous-error").html("Days Previously is required field."),
!1;if(!AJS.Editor.JiraChart.Helper.isNumber(b)||0>b)return d.html("Days Previously must be a number and positive."),!1;switch(a){case "hourly":(isValid=10>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",10,a));break;case "daily":(isValid=300>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",300,a));break;case "weekly":(isValid=1750>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",
1750,a));break;case "monthly":(isValid=7500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",7500,a));break;case "quarterly":(isValid=22500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",22500,a));break;case "yearly":(isValid=36500>=b)||d.html(AJS.format("Days must not exceed {0} for {1} period",36500,a));break;default:isValid=!1}isValid&&d.empty();return isValid};this.title="Created vs Resolved";
this.chartType="createdvsresolved";this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var a=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);
return g()&&a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);f()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");
this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});
this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),b=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);b.macro.params.periodName=a.periodName;b.macro.params.daysprevious=a.daysprevious;b.macro.params.isCumulative=
a.isCumulative;b.macro.params.showUnresolvedTrend=a.showUnresolvedTrend;b.macro.params.versionLabel=a.versionLabel;return b};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="createdvsresolved";a.periodName=this.chartElements.periodName.val();a.daysprevious=e.trim(this.chartElements.daysprevious.val());a.isCumulative=this.chartElements.isCumulative.prop("checked");a.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");
a.versionLabel=this.chartElements.versionLabel.val();return a};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);f()};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,a),c.chartElements.isCumulative.attr("checked","false"!==a.isCumulative),c.chartElements.showUnresolvedTrend.attr("checked","true"===a.showUnresolvedTrend),c.chartElements.periodName.val(""===a.periodName?"daily":
a.periodName),c.chartElements.versionLabel.val(a.versionLabel),c.chartElements.daysprevious.val(""===a.daysprevious?"30":a.daysprevious))}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var b=this,e=function(){b.chartElements.numberToShow.val(5);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="Two Dimensional";this.chartType="twodimensional";this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";
this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var a=d(".twodimensional-number-of-result-error");var c=b.chartElements.numberToShow.val();AJS.Editor.JiraChart.Helper.isNumber(c)&&0<c?(a.empty(),a=!0):(a.html("The number of rows should be a positive integer"),a=!1);return a&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};
this.init=function(a){AJS.Editor.JiraChart.Panel.prototype.init.call(this,a);e()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");
this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var a=this.getMacroParamsFromDialog(),c=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(a,this.chartType);c.macro.params.xstattype=a.xstattype;c.macro.params.ystattype=a.ystattype;c.macro.params.sortBy=a.sortBy;c.macro.params.sortDirection=a.sortDirection;c.macro.params.showTotals=a.showTotals;
c.macro.params.numberToShow=a.numberToShow;return c};this.getMacroParamsFromDialog=function(){var a=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);a.chartType="twodimensional";a.xstattype=this.chartElements.xstattype.val();a.ystattype=d.trim(this.chartElements.ystattype.val());a.sortBy=d.trim(this.chartElements.sortBy.val());a.sortDirection=d.trim(this.chartElements.sortDirection.val());a.showTotals=this.chartElements.showTotals.prop("checked");a.numberToShow=
this.chartElements.numberToShow.val();return a};this.bindingDataFromMacroToForm=function(a){a&&(AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,a),b.chartElements.xstattype.val(a.xstattype),b.chartElements.ystattype.val(a.ystattype),b.chartElements.sortBy.val(a.sortBy),b.chartElements.sortDirection.val(a.sortDirection),b.chartElements.showTotals.attr("checked","true"===a.showTotals),b.chartElements.numberToShow.val(a.numberToShow))};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);
e()};this.isImageChartExisted=function(){return 0<this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=
function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");b.isFormValid()?AJS.Editor.JiraChart.search(b.container):AJS.Editor.JiraChart.disableInsert()})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;
AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-support-util', location = 'support/atlassian-editor-support.js' */
define("confluence-editor/support/atlassian-editor-support",["ajs","confluence/meta"],function(c,b){return{inlineTasks:function(){var a=b.get("use-inline-tasks");return"true"===a||!0===a},isCollaborativeContentType:function(){var a=b.get("content-type");return b.get("collaborative-content")&&("page"===a||"blogpost"===a)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/support/atlassian-editor-support","AJS.Rte.Support");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-quit-dialog', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="There were errors discarding your draft.",d=d.errors||"An unknown error has occurred. Please check your logs.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="This page has already been published";d="You can no longer discard this draft because it\u0027s not a draft anymore!"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"Can\u0027t revert to last published version":h,message:i?"We can\u0027t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/is-valid-uri.js' */
define("confluence-collaborative-editor-plugin/util/is-valid-uri",[],function(){function d(a,c){var b=a.lastIndexOf(c);return-1!==b&&b===a.length-c.length}var e=/^(((?![':"<>])[\s   -   　\$\+<->\^`\|~¢-¦¨©¬®-±´¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂֍-֏؆-؈؋؎؏۞۩۽۾߶৲৳৺৻૱୰௳-௺౿൏൹฿༁-༃༓༕-༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏࿕-࿘႞႟᎐-᎙៛᥀᧞-᧿᭡-᭪᭴-᭼᾽᾿-῁῍-῏῝-῟῭-`´῾⁄⁒⁺-⁼₊-₌₠-₾℀℁℃-℆℈℉℔№-℘℞-℣℥℧℩℮℺℻⅀-⅄⅊-⅍⅏↊↋←-⌇⌌-⌨⌫-⏾␀-␦⑀-⑊⒜-ⓩ─-❧➔-⟄⟇-⟥⟰-⦂⦙-⧗⧜-⧻⧾-⭳⭶-⮕⮘-⮹⮽-⯈⯊-⯑⯬-⯯⳥-⳪⺀-⺙⺛-⻳⼀-⿕⿰-⿻〄〒〓〠〶〷〾〿゛゜㆐㆑㆖-㆟㇀-㇣㈀-㈞㈪-㉇㉐㉠-㉿㊊-㊰㋀-㋾㌀-㏿䷀-䷿꒐-꓆꜀-꜖꜠꜡꞉꞊꠨-꠫꠶-꠹꩷-꩹꭛﬩﮲-﯁﷼﷽﹢﹤-﹦﹩＄＋＜-＞＾｀｜～￠-￦￨-￮￼�!-#%-\*,-/:;\?@\[-\]_\{\}¡§«¶·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰૰෴๏๚๛༄-༒༔༺-༽྅࿐-࿔࿙࿚၊-၏჻፠-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳀-᳇᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎⌈-⌋〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰-⹄、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꣼꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꫰꫱꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9²³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯୲-୷௦-௲౦-౯౸-౾೦-೯൘-൞൦-൸෦-෯๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼ᛮ-ᛰ០-៩៰-៹᠐-᠙᥆-᥏᧐-᧚᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅐-ↂↅ-↉①-⒛⓪-⓿❶-➓⳽〇〡-〩〸-〺㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꘠-꘩ꛦ-ꛯ꠰-꠵꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９])+|\#(\w)+)$/,
f=/^(?:\s*(?:([a-zA-Z]*):\/\/|mailto:|skype:|callto:|facetime:|git:|irc:|irc6:|news:|nntp:|feed:|cvs:|svn:|mvn:|ssh:|itms:|notes:|smb:|sourcetree:|urn:|tel:|xmpp:|telnet:|vnc:|rdp:|whatsapp:|slack:|sip:|sips:|magnet:)[A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9²³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯୲-୷௦-௲౦-౯౸-౾೦-೯൘-൞൦-൸෦-෯๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼ᛮ-ᛰ០-៩៰-៹᠐-᠙᥆-᥏᧐-᧚᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅐-ↂↅ-↉①-⒛⓪-⓿❶-➓⳽〇〡-〩〸-〺㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꘠-꘩ꛦ-ꛯ꠰-꠵꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９\/]+(?:(?!['"<>])[\s   -   　\$\+<->\^`\|~¢-¦¨©¬®-±´¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂֍-֏؆-؈؋؎؏۞۩۽۾߶৲৳৺৻૱୰௳-௺౿൏൹฿༁-༃༓༕-༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏࿕-࿘႞႟᎐-᎙៛᥀᧞-᧿᭡-᭪᭴-᭼᾽᾿-῁῍-῏῝-῟῭-`´῾⁄⁒⁺-⁼₊-₌₠-₾℀℁℃-℆℈℉℔№-℘℞-℣℥℧℩℮℺℻⅀-⅄⅊-⅍⅏↊↋←-⌇⌌-⌨⌫-⏾␀-␦⑀-⑊⒜-ⓩ─-❧➔-⟄⟇-⟥⟰-⦂⦙-⧗⧜-⧻⧾-⭳⭶-⮕⮘-⮹⮽-⯈⯊-⯑⯬-⯯⳥-⳪⺀-⺙⺛-⻳⼀-⿕⿰-⿻〄〒〓〠〶〷〾〿゛゜㆐㆑㆖-㆟㇀-㇣㈀-㈞㈪-㉇㉐㉠-㉿㊊-㊰㋀-㋾㌀-㏿䷀-䷿꒐-꓆꜀-꜖꜠꜡꞉꞊꠨-꠫꠶-꠹꩷-꩹꭛﬩﮲-﯁﷼﷽﹢﹤-﹦﹩＄＋＜-＞＾｀｜～￠-￦￨-￮￼�!-#%-\*,-/:;\?@\[-\]_\{\}¡§«¶·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰૰෴๏๚๛༄-༒༔༺-༽྅࿐-࿔࿙࿚၊-၏჻፠-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳀-᳇᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎⌈-⌋〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰-⹄、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꣼꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꫰꫱꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9²³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯୲-୷௦-௲౦-౯౸-౾೦-೯൘-൞൦-൸෦-෯๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼ᛮ-ᛰ០-៩៰-៹᠐-᠙᥆-᥏᧐-᧚᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅐-ↂↅ-↉①-⒛⓪-⓿❶-➓⳽〇〡-〩〸-〺㆒-㆕㈠-㈩㉈-㉏㉑-㉟㊀-㊉㊱-㊿꘠-꘩ꛦ-ꛯ꠰-꠵꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９])*(?:\s)*)$/;
return function(a){if(null===a)return!1;var c=e.test(a),b=(a=a.match(f))&&a.length&&a[1];a=a&&a.length&&(!b||!d(b,"script")&&!d(b,"data"));return c||a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/synchrony-presence.soy' */
// This file was automatically generated from synchrony-presence.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SynchronyPresence.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SynchronyPresence == 'undefined') { Confluence.Templates.SynchronyPresence = {}; }


Confluence.Templates.SynchronyPresence.container = function(opt_data, opt_ignored) {
  return '<ul id="avatar-list" class="synchrony-doc-' + soy.$$escapeHtml(opt_data.docId) + ' collaborative-avatars-list"></ul><aui-inline-dialog id="more-avatars" alignment="bottom right" responds-to="toggle" aria-hidden="true"><h3>' + soy.$$escapeHtml('Also edited') + '</h3><ul id="more-avatars-list" class="collaborative-avatars-list"></ul></aui-inline-dialog>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.container.soyTemplateName = 'Confluence.Templates.SynchronyPresence.container';
}


Confluence.Templates.SynchronyPresence.avatar = function(opt_data, opt_ignored) {
  return '<li class="avatar-item' + ((opt_data.active) ? ' p' + soy.$$escapeHtml(opt_data.telepointer) + ' active' : '') + ((opt_data.currentUser) ? ' no-animate-entry' : '') + '"><span title="' + soy.$$escapeHtml(opt_data.title) + '" avatar="' + soy.$$escapeHtml(opt_data.initial) + '"' + ((opt_data.active) ? ' data-origin="' + soy.$$escapeHtml(opt_data.origin) + '"' : '') + ' class="avatar' + ((opt_data.active) ? ' active' : '') + '"' + ((opt_data.username) ? ' data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : '') + '><img src="' + soy.$$escapeHtml(opt_data.avatarUrl) + '" alt="' + soy.$$escapeHtml(AJS.format('Profile picture for {0}',opt_data.username)) + '"/></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.avatar.soyTemplateName = 'Confluence.Templates.SynchronyPresence.avatar';
}


Confluence.Templates.SynchronyPresence.overlay = function(opt_data, opt_ignored) {
  return '<span id="synchrony-presence-overlay" class="overlay avatar"><a href="#" aria-controls="more-avatars" class="aui-button" data-aui-trigger></a></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.overlay.soyTemplateName = 'Confluence.Templates.SynchronyPresence.overlay';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-presence.js' */
define("confluence-collaborative-editor-plugin/synchrony-presence","backbone confluence-collaborative-editor-plugin/avatar-list-view confluence-collaborative-editor-plugin/overlay-view ajs confluence/legacy confluence/meta confluence/templates jquery underscore".split(" "),function(w,x,q,d,y,e,z,f,g){function r(){m=f(z.SynchronyPresence.container({docId:y.getContentId()}));f("#rte-toolbar").append(m);new x({el:"#avatar-list",collection:c});h=new q({collection:c});f("#rte-toolbar").append(h.render())}
function t(b){var a=f.extend({},b);a.id=b.origin;a.fullname=b.fullname||"Anonymous";a.name=b.name||"anonymous";a.username=b.name;a.avatarURL=d.contextPath()+b.avatarURL;a.active=b.active||!0;a.currentUser=b.currentUser||n===b.origin;return a}function A(){return c.filter(function(b){return b.get("active")}).length}function p(){var b=[];c.each(function(a){a.get("active")||g.some(k,function(b){return a.get("id")===b.name})||b.push(a)});g.each(b,function(a){c.remove(a)});g.each(k,
function(a){a.name===e.get("remote-user")||c.any(function(b){return b.get("id")===a.name||b.get("name")===a.name})||(a.active=!1,a.id=a.name,c.add(a))})}var c=new w.Collection;c.add(t({origin:"current-user",fullname:e.get("current-user-fullname"),name:e.get("remote-user"),avatarURL:e.get("current-user-avatar-url"),active:!0,currentUser:!0}));var u=!1,n="",l,k=[],m=null,h,v=!1;d.Rte.getEditor()&&d.Rte.getEditor().initialized?r():d.bind("rte-collab-ready",r);return{appendTo:function(b,a,f){n=b;u||(l=
l||require("tinymce"),u=!0,k=f,a.on("presence",function(a){h.hideInlineDialog();a.joined.filter(function(a){return a.origin!==n}).forEach(function(a){a=t(a);var b=c.findWhere({active:!1,id:a.name});b&&c.remove(b);c.add(a,{at:A()})});a.left.forEach(function(a){a.id=a.origin;c.remove(a);p()});p();v||(d.bind("editor-heartbeat",function(a,b){g.isArray(b.contributors)&&(k=b.contributors,p())}),v=!0);d.trigger("analyticsEvent",{name:"confluence.synchrony.user.in.session",data:{numOtherUsers:c.length,draftId:e.get("draft-id"),
contentId:e.get("content-id")}})}),l.EditorManager.activeEditor.on("click",g.bind(q.prototype.hideInlineDialog,h)));return m},setTinyMce:function(b){l=b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-list-view.js' */
define("confluence-collaborative-editor-plugin/avatar-list-view",["backbone","confluence-collaborative-editor-plugin/avatar-view","ajs","jquery","underscore"],function(d,e,c,g,f){return d.View.extend({initialize:function(){this.collection.on("add",this.addAvatar,this);this.collection.on("remove",this.removeAvatar,this);this.collection.each(this.addAvatar,this)},addAvatar:function(a){var b=new e({model:a});a.get("active")?(c.log(a.get("fullname")+" joined. ("+a.get("origin")+")"),a=this.$el.find("li.active").last(),
b=a.length?b.render().insertAfter(a):b.render().prependTo(this.$el)):b=b.render().appendTo(this.$el);a=function(a){a.addClass("show");a.children(".avatar").tooltip({fade:!0,gravity:"ne"})};6===this.collection.length?a(b):f.defer(a,b);this._manageOverlayClass()},removeAvatar:function(a){a.get("active")&&c.log(a.get("fullname")+" left. ("+a.get("origin")+")");this._manageOverlayClass()},_manageOverlayClass:function(){var a=this.collection.length;this.collection.each(function(b,c){b.set("hidden",5<a&&
4<=c)});5<a?this.$el.addClass("has-overlay"):this.$el.removeClass("has-overlay")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-view.js' */
define("confluence-collaborative-editor-plugin/avatar-view",["backbone","ajs","confluence/templates","jquery"],function(f,d,g,e){return f.View.extend({initialize:function(){this.model.on("remove",this.remove,this)},render:function(){return this.$el=e(g.SynchronyPresence.avatar({title:this._determineTitle(),initial:this.model.get("fullname").charAt(0).toUpperCase(),fullname:this.model.get("fullname"),username:this.model.get("username"),avatarUrl:this.model.get("avatarURL"),origin:this.model.get("origin"),
active:this.model.get("active"),currentUser:this.model.get("currentUser"),telepointer:this._synchronyTelepointerId()}))},remove:function(){this.$el.removeClass().addClass("avatar-item animate");this.model.get("hidden")||this.$el.addClass("removing");this.$el.one(this._getSupportedTransition(),function(){e(this).removeClass("animate removing");e(this).remove()})},_determineTitle:function(){if(this.model.get("currentUser")){var a=["It\u0027s you, but smaller!","Look at you, getting stuff done!"];
return a[Math.floor(Math.random()*a.length)]}return this.model.get("fullname")+" "+(this.model.get("active")?"is editing this page.":"has made changes that haven\u0027t been published.")},_getSupportedTransition:function(){var a={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",MsTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"},b=document.createElement("_"),c;for(c in a)if(void 0!==b.style[c])return a[c]},_synchronyTelepointerId:function(){for(var a=
""+(this.model.get("sub")||this.model.get("origin")||""),b=0,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return Math.abs(b)%10}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/overlay-view.js' */
define("confluence-collaborative-editor-plugin/overlay-view","backbone aui/inline-dialog2 confluence-collaborative-editor-plugin/avatar-view confluence/templates ajs jquery underscore".split(" "),function(c,g,d,e,f,b,h){return c.View.extend({initialize:function(){this.collection.on("add remove",this.reconcile,this);this.inlineDialog2=document.querySelector("#more-avatars")},render:function(){this.$el=b(e.SynchronyPresence.overlay());this.$el.children("a").tooltip({fade:!0,gravity:"ne"});this.$el.on("click",
function(){b(".tipsy").remove()});return this.$el},reconcile:function(){var a=this.collection.where({hidden:!0});0<a.length?(this.$el.addClass("show"),this.$el.children(".aui-button").html("+"+a.length).attr("title",a.length+" "+"other users are editing."),b("#more-avatars-list").children().remove(),a.forEach(function(a){a=new d({model:a});b("#more-avatars-list").append(a.render())})):(this.$el.removeClass("show"),this.hideInlineDialog())},hideInlineDialog:function(){this.inlineDialog2&&
this.inlineDialog2.isVisible&&this.inlineDialog2.isVisible()&&(this.inlineDialog2.open=!1)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/status-indicator.soy' */
// This file was automatically generated from status-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.CollaborativeEditor.StatusIndicator.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.CollaborativeEditor == 'undefined') { Confluence.Templates.CollaborativeEditor = {}; }
if (typeof Confluence.Templates.CollaborativeEditor.StatusIndicator == 'undefined') { Confluence.Templates.CollaborativeEditor.StatusIndicator = {}; }


Confluence.Templates.CollaborativeEditor.StatusIndicator.container = function(opt_data, opt_ignored) {
  return '<div class="synchrony-status-indicator"><div class="status-indicator-icon aui-icon aui-icon-small' + ((opt_data.error) ? ' aui-iconfont-warning' : (opt_data.saving) ? ' aui-iconfont-devtools-task-in-progress' : ' aui-iconfont-approve') + '" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '"></div><div class="status-indicator-message" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '">' + soy.$$escapeHtml(opt_data.statusMessage) + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.CollaborativeEditor.StatusIndicator.container.soyTemplateName = 'Confluence.Templates.CollaborativeEditor.StatusIndicator.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/status-indicator-view.js' */
define("confluence-collaborative-editor-plugin/status-indicator-view",["confluence/templates","backbone","ajs","jquery","underscore"],function(e,f,c,g,d){return f.View.extend({initialize:function(){this.$el.addClass("synchrony");this.listenTo(this.model,"change:saving change:error",this.render);this.model.set("confluenceUnreachable",!1);this.model.set("synchronyUnreachable",!1);this.model.set("tokenExpired",!1);c.bind("rte.heartbeat",d.bind(this.onConfluenceConnectedState,this));c.bind("rte.safe-save.error",
d.bind(this._errorPublishing,this));c.bind("rte.preview.error",d.bind(this._errorPublishing,this));this.model.set("connecting",!0);this._setProgressState()},render:function(){g(".tipsy").remove();this.$el.html(e.CollaborativeEditor.StatusIndicator.container(this.model.attributes))},onConnectedState:function(a){this.model.set("synchronyUnreachable",!1);if(!this.model.has("synchronyEntity")){this.model.set("synchronyEntity",a);var b=this;this.model.get("synchronyEntity").on("update",function(a){b._handleSynchronyUpdateEvent(a,
b)});this.model.get("synchronyEntity").on("ack",function(a){b._handleSynchronyAckEvent(a,b)})}this._setSavedState()},onDisconnectedState:function(){this.model.set("synchronyUnreachable",!0);this.model.set("connecting",!0);this._setErrorState()},onConfluenceConnectedState:function(){this.model.get("confluenceUnreachable")&&(this.model.set("confluenceUnreachable",!1),this._setSavedState())},onConfluenceDisconnectedState:function(){this.model.set("confluenceUnreachable",!0);this.model.set("connecting",
!0);this._setErrorState()},onTokenRenewedState:function(){this.model.get("tokenExpired")&&(this.model.set("tokenExpired",!1),this._setSavedState())},onTokenExpiredState:function(){this.model.set("tokenExpired",!0);this.model.set("connecting",!0);this._setErrorState()},_handleSynchronyUpdateEvent:function(a,b){"local"===a.updateType&&(b.model.set("pendingChanges",!0),b._saving())},_handleSynchronyAckEvent:function(a,b){a=0<a.pending.length;b.model.set("pendingChanges",a);a||b.model.set("lastSavedTime",
(new Date).getTime())},_saving:function(){var a=this,b=function(){setTimeout(function(){a.model.get("pendingChanges")||(new Date).getTime()-a.model.get("lastSavedTime")<a.model.get("minActiveTime")?b():a._setSavedState()},a.model.get("minActiveTime"))};this.model.get("saving")||(this.model.set("connecting",!1),this._setProgressState(),b())},_reachable:function(){return!this.model.get("confluenceUnreachable")&&!this.model.get("synchronyUnreachable")&&!this.model.get("tokenExpired")},_errorPublishing:function(a,
b){switch(b.status){case 0:this.onConfluenceDisconnectedState();break;case 500:case 503:this.onConfluenceDisconnectedState()}},_setSavedState:function(){this._reachable()&&"READ_ONLY"!==c.Meta.get("access-mode")?(this.model.set("statusMessage",this.model.get("connecting")?"Ready to go":"Changes saved"),this.model.set("isReadyToGo",!!this.model.get("connecting")),this.model.set("tooltipMessage","We\u0027re automatically saving all of your changes in a draft."),this.model.set("connecting",
!1),this.model.set("saving",!1),this.model.set("error",!1)):this._setErrorState()},_setErrorState:function(){var a="READ_ONLY"!==c.Meta.get("access-mode");this.model.set("statusMessage","Can\u0027t save changes");this.model.set("tooltipMessage",a?"Can\u0027t reach the server. Check your internet connection, and we\u0027ll keep trying to reconnect you.":"This site is read-only. You can\u0027t make changes right now.");this.model.set("saving",!1);this.model.set("error",!0)},_setProgressState:function(){this._reachable()?(this.model.set("statusMessage",
this.model.get("connecting")?"Connecting...":"Saving changes"),this.model.set("tooltipMessage","We\u0027re automatically saving all of your changes in a draft."),this.model.set("saving",!0),this.model.set("error",!1)):this._setErrorState()}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/initialise-metrics.js' */
define("collaborative-editing-initialise-metrics-collection",["confluence/legacy"],function(a){return function(){var b={"confluence.editor":!0,"confluence.editor.preload":!0,"confluence.editor.quick.fetchContent":!0,"confluence.editor.tinymce":!0,"confluence.editor.synchrony":!0,"confluence.editor.synchrony.CR":!0,"confluence.editor.synchrony.connect":!0,"confluence.editor.synchrony.deps":!0,"confluence.editor.synchrony.init":!0,"confluence.editor.synchrony.jsLoad":!0,"confluence.editor.synchrony.snapshot":!0,
"confluence.editor.synchrony.unmarshal":!0},c={"confluence.editor.synchrony.connect":!0};a.registerPerformanceSession&&a.registerPerformanceSession("confluence.editor.quickedit.loading.times",b,c)}});require("confluence/module-exporter").safeRequire("collaborative-editing-initialise-metrics-collection",function(a){a()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/lib/SyncManager.js' */
define("confluence-collaborative-editor-plugin/lib/SyncManager",["ajs","jquery"],function(d,e){var f=["id"],g={START_SYNCHRONIZING_EVENT_NAME:"start",STOP_SYNCHRONIZING_EVENT_NAME:"stop",MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:10,MAX_WAIT_TIME_TO_RESTART:3E4,DEBUG_MODE:!1},h=function(a){return f.every(function(b){return"undefined"!==typeof a[b]})},c=function(a,b){this.entity=a;this.settings=e.extend({},g,b||{});this.controlSyncState={};this.recoveryTimeoutTasks={};a=function(a,b,c){h(c)?a(c):this.displayLogMessage("Invalid payload, missing required params",
b,c)};d.bind("synchrony."+this.settings.START_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.enableSynchronization.bind(this)));d.bind("synchrony."+this.settings.STOP_SYNCHRONIZING_EVENT_NAME,a.bind(this,this.disableSynchronization.bind(this)))};c.prototype.getOrCreateControlSyncState=function(a){return this.controlSyncState[a]=this.controlSyncState[a]||{DISABLED_SYNC_STATUS:!1,RECOVERY_TIMER_RUNNING:!1,CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:0}};c.prototype.enableDebug=function(a){this.settings.DEBUG_MODE=
"undefined"!==typeof a?a:!0};c.prototype.displayLogMessage=function(){if(this.settings.DEBUG_MODE){var a=Array.prototype.slice.call(arguments);a.splice(0,0,"DEBUG: "+(new Date).toLocaleTimeString());console.log.apply(console,a)}};c.prototype.disableSynchronization=function(a){var b=a.id;this.getOrCreateControlSyncState(b).DISABLED_SYNC_STATUS=!0;this.clearAutoRecoveryTimer(b);this.setAutoRecoveryTimer(a);this.entity.stop(b);this.displayLogMessage("Stoping entity synchronization",b,e.extend(!0,{},
this.controlSyncState))};c.prototype.enableSynchronization=function(a){a=a.id;this.getOrCreateControlSyncState(a).DISABLED_SYNC_STATUS=!1;this.clearAutoRecoveryTimer(a);this.entity.start(a);this.displayLogMessage("Starting entity synchronization",a,e.extend(!0,{},this.controlSyncState))};c.prototype.clearAutoRecoveryTimer=function(a){var b=this.getOrCreateControlSyncState(a);clearTimeout(this.recoveryTimeoutTasks[a]);delete this.recoveryTimeoutTasks[a];b.RECOVERY_TIMER_RUNNING=!1};c.prototype.setAutoRecoveryTimer=
function(a){var b=a.id,c=this.getOrCreateControlSyncState(b);c.RECOVERY_TIMER_RUNNING=!0;this.recoveryTimeoutTasks[b]=setTimeout(function(){this.displayLogMessage("Auto recovery has been triggered",b);this.clearAutoRecoveryTimer(b);c.DISABLED_SYNC_STATUS=!1;c.RECOVERY_TIMER_RUNNING=!1;c.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED++;d.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.failed-to-restart",data:{id:b}});c.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED>=this.settings.MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED&&
(this.displayLogMessage("Auto recovery has been triggered too many times for the same action",b,this.controlSyncState[b].CONSECUTIVE_AUTO_RECOVERY_TRIGGERED),d.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.consecutive-failed-to-restart",data:{id:b}}));this.entity.start(b)}.bind(this),a.maxWaitTimeToRestart||this.settings.MAX_WAIT_TIME_TO_RESTART)};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/telepointer-cleaner.js' */
define("confluence-collaborative-editor-plugin/telepointer-cleaner",["confluence-editor-reliable-save/reliable-save","jquery"],function(a,c){a.registerCleanupFunction(function(a){var b=c("\x3cdiv\x3e");b.append(a);b.find(".synchrony-container, .synchrony-tp").remove();return b.html()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/editor-blanket.js' */
define("confluence-collaborative-editor-plugin/editor-blanket",["ajs","jquery","confluence/meta","confluence-editor/support/atlassian-editor-support"],function(l,a,m,h){var c,d;function f(b){switch(b){case "block":c="editor-block";d="aria-disabled";e="";break;default:c="editor-loading editor-loading-spinner",d="aria-busy",e="editor-loading"}b=a("#editpageform, #createpageform");b.addClass(c);b.attr(d,!0);a("#content-title").attr("tabindex",-1);a("#wysiwygTextarea_ifr").attr("tabindex",-1);a(".aui-toolbar2-primary").addClass(e)}
function k(){var b=a("#editpageform, #createpageform");b.removeClass(c);b.attr(d,!1);a("#rte").css("opacity",1).addClass("editor-blanket-ease-in");a("#content-title").attr("tabindex",1);a("#wysiwygTextarea_ifr").attr("tabindex",100);a("#content-title-div").css("opacity",1).addClass("editor-blanket-ease-in");a(".aui-toolbar2-primary").removeClass(e);e=d=c=void 0}function g(){a("#rte").css("opacity",1);a("#content-title-div").css("opacity",1)}var e=d=c=void 0;return{applyBlanket:function(a){h.isCollaborativeContentType()&&
"pending"===a.state()?(f(),a.done(k)):g()},showEditor:g,showBlanket:f}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-auth.js' */
define("confluence-collaborative-editor-plugin/synchrony-auth",["jquery","ajs","confluence/meta","confluence/legacy","confluence-collaborative-editor-plugin/synchrony-util"],function(k,d,l,m,f){function n(c,a){f.time("confluence.editor.synchrony.token");var b=a&&a.errorType?"?errorType\x3d"+a.errorType:"";k.ajax({dataType:"json",method:"GET",url:encodeURI(d.contextPath()+"/rest/synchrony/1.0/token/"+m.getContentId()+"/generate"+b)}).done(function(a){l.set("synchrony-token",a.synchronyToken);l.set("synchrony-expiry",
a.synchronyExpiry);g=0;c.resolve(a.synchronyToken);e&&(e.onConfluenceConnectedState(),e.onTokenRenewedState());d.trigger("dismiss.editor.error.message",{messageKey:"synchrony-token-expired",enablePublish:!0});d.debug("Synchrony JWT token updated.");f.timeEnd("confluence.editor.synchrony.token")}).fail(function(){g++;10<=g&&d.trigger("editor.error.message",{messageKey:"synchrony-token-expired",message:"We couldn\u0027t process your request, as it was missing a required security token. Copy your work, then re-submit the form or reload the page.",disablePublish:!0});e&&(e.onConfluenceDisconnectedState(),
e.onTokenExpiredState());d.log(a?a.message:"Confluence failed to renew JWT token.");c.reject("token")})}function h(c){var a=k.Deferred(),b;if(b=!c)b=parseInt(f.retrieveMetadata("synchrony-expiry")),b=isNaN(b)?!1:b>Date.now()/1E3;b?a.resolve(f.retrieveMetadata("synchrony-token")):(d.log("["+new Date+"] Synchrony JWT expired or invalid, retrieving new token."),n(a,c));return a.promise()}var e,g=0;return{init:function(c){e=c},performRequest:function(c){return h().pipe(c).pipe(function(a){var b="error"===
a[1]&&a[0].responseText?JSON.parse(a[0].responseText):a[0];return"error"===a[1]&&b.type&&b.type.match(/^jwt\//)?h({errorType:b.type,message:b.message}).pipe(c):a})},getTokenPromise:h}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/unsupported-extension.js' */
define("confluence-collaborative-editor-plugin/unsupported-extension","ajs jquery confluence/legacy confluence-editor/editor/page-editor-message window confluence-collaborative-editor-plugin/editor-blanket".split(" "),function(a,c,d,e,f,g){function h(){var b=a.Rte.getEditor().getBody();b.hasAttribute("data-gramm")&&b.hasAttribute("data-gramm_id")&&(a.trigger("synchrony.stop",{id:"confluence.editor.block.by.grammarly",maxWaitTimeToRestart:31536E6}),a.trigger("analyticsEvent",{name:"confluence.synchrony.editor.grammarly.block"}),
b.setAttribute("contentEditable",!1),c(b).find(".contentLayout2 .innerCell").each(function(){this.setAttribute("contentEditable",!1)}),g.showBlanket("block"),d.Editor.UI.setButtonsState(!1,d.Editor.UI.buttons),e.handleMessage("collaborative-editor-unsupported-extension",{type:"error",title:"Grammarly isn\u0027t supported",message:a.format("The Grammarly extension doesn\u0027\u0027t play well with collaborative editing. Disable it and \u003ca {0}\u003ereload the page\u003c/a\u003e to keep working.",'href\x3d"#" id\x3d"collabGrammarlyReload"')}),c("#collabGrammarlyReload").click(function(){a.trigger("analyticsEvent",
{name:"confluence.synchrony.editor.grammarly.reload.click"});f.location.reload();return!1}),a.trigger("synchrony-unsupported-extension"))}return{check:function(){h()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-entity.js' */
define("confluence-collaborative-editor-plugin/synchrony-entity","jquery ajs confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/unsupported-extension confluence-collaborative-editor-plugin/util/is-valid-uri".split(" "),function(c,d,l,f,m,n){function g(a){return function(b){return null===b||a.test(b)}}function k(a){var b=g(/^[\w\.\-\+%]+$/i),e=g(/^[\w-]+$/),h=g(/^data:image\/png;base64,([\w+\/%\-]+)=*$/),
p=a.whitelists.tinymce.attributes.src;return c.extend({},a.whitelists.tinymce,{styles:c.extend({},a.whitelists.tinymce.styles,{"padding-top":!1,"padding-right":!1,"padding-bottom":!1,"padding-left":!1,padding:!1,display:b,"list-style-type":b}),attributes:c.extend({},a.whitelists.tinymce.attributes,{"confluence-query-params":!0,"data-element-title":!0,"data-ref":!0,accesskey:!0,datetime:!0,"data-anchor":!0,"data-encoded-xml":!0,"data-highlight-class":!0,"data-highlight-colour":!0,"data-space-key":!0,
"data-username":!0,"data-emoticon-name":e,"data-hipchat-emoticon":e,"data-entity-id":!0,"data-entity-type":!0,"data-favourites-bound":!0,"data-macro-id":!0,"data-macro-name":!0,"data-macro-schema-version":!0,"data-macro-body-type":!0,"data-macro-parameters":!0,"data-macro-default-parameter":!0,"data-atlassian-layout":!0,"data-placeholder-type":!0,"data-layout":!0,"data-title":!0,"data-type":!0,"data-inline-task-id":!0,"data-inline-tasks-content-id":!0,"data-base-url":!0,"data-linked-resource-id":!0,
"data-linked-resource-type":!0,"data-linked-resource-version":!0,"data-linked-resource-default-alias":!0,"data-linked-resource-container-version":!0,"data-linked-resource-content-type":!0,"data-unresolved-comment-count":!0,"data-location":!0,"data-image-height":!0,"data-image-width":!0,"data-attachment-copy":!0,"data-content-title":!0,"data-filename":!0,username:!0,src:function(a){return h(a)||p(a)},href:n}),classes:function(a){switch(a){case "mceSelected":case "active-resizable":return!1;default:return!0}},
elements:c.extend({},a.whitelists.tinymce.elements,{time:!0,mark:!0,label:!0,form:!0})})}function r(a,b,e){var h=k(a);return{profile:"tinymce",selectionCorrections:!1,telepointer:{refreshOnResize:!0,label:{hover:!0,movement:1E3,text:function(a){try{return(a.fullname||"Anonymous").charAt(0).toUpperCase()}catch(q){d.log(q)}return"\x26#9786;"}}},tinymce:{monkeyPatchUndoManager:!0,instance:b},whitelist:function(b){var c="node"===b.type,d="attribute"===b.type&&"data-title"===b.name;
return b.domNode===e?c||d:a.isWhitelisted(h,b)},domReadHook:function(){d.trigger("cursor-target-refresh");m.check()}}}return{bind:function(a,b,e,c,d){return a.entity({url:f.getServiceUrl(),entityId:f.getEntityId(),jwt:l.getTokenPromise,initRev:d.confRev,history:c,presence:!0,useFallback:f.getXhrFallbackFlag()}).bind(e,r(a,b,e))},makeWhitelist:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/url-parser.js' */
define("confluence-collaborative-editor-plugin/util/url-parser",["window"],function(b){return{parseUrl:function(c){var a=b.document.createElement("a");a.href=c;return{protocol:a.protocol.replace(":",""),hostname:a.hostname,port:a.port,pathname:"/"===a.pathname?"":a.pathname,search:a.search,hash:a.hash.substr(a.hash.indexOf("#")+1,a.hash.length),host:a.host}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/location-provider.js' */
define("confluence-collaborative-editor-plugin/util/location-provider",["window"],function(a){return{getLocation:function(){return a.location}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/editor-format-fixer.js' */
define("confluence-collaborative-editor-plugin/util/editor-format-fixer",["underscore","confluence/meta","confluence-collaborative-editor-plugin/util/url-parser"],function(p,n,k){var r=function(a){a=a.querySelectorAll("a[data-linked-resource-id][data-linked-resource-type\x3d'userinfo'][userkey]");Array.prototype.forEach.call(a,function(a){a.removeAttribute("data-linked-resource-id")});return a.length};return{fixStaleBaseUrl:function(a){var q=0;for(var l=n.get("base-url"),f=k.parseUrl(l),g=a.querySelectorAll("img[data-base-url]"),
h=0;h<g.length;h++){var b=g[h],c=k.parseUrl(b.attributes["data-base-url"].value);if(!p.isEqual(c,f)){var d=b.attributes.src.value,e=b.attributes["data-image-src"].value.replace(c.pathname,f.pathname);c=d.replace(c.pathname,f.pathname);b.setAttribute("data-base-url",l);b.setAttribute("data-image-src",e);b.setAttribute("src",c);q++}}l=0;f=k.parseUrl(n.get("base-url"));g=a.querySelectorAll("img[data-macro-name\x3d'view-file']");for(h=0;h<g.length;h++)for(b=g[h],e=b.attributes.src.value,c=["/rest/documentConversion/latest/",
"/plugins/servlet/confluence/placeholder/unknown-attachment?"],d=0;d<c.length;d++){var m=e.indexOf(c[d]);-1!=m&&e.substr(0,m)!==f.pathname&&(m=f.pathname+e.substr(m),b.setAttribute("src",m),l++)}f=0;g=n.get("base-url");h=k.parseUrl(g);a=a.querySelectorAll("a[data-base-url][href][data-linked-resource-type\x3d'page'],a[data-base-url][href][data-linked-resource-type\x3d'blogpost'],a[data-base-url][href][data-linked-resource-type\x3d'comment'],a[data-base-url][href][data-linked-resource-type\x3d'space'],a[data-base-url][href][data-linked-resource-type\x3d'attachment'],a[data-base-url][href][data-linked-resource-type\x3d'custom']");
for(b=0;b<a.length;b++)e=a[b],c=k.parseUrl(e.attributes["data-base-url"].value),p.isEqual(c,h)||(d=k.parseUrl(e.attributes.href.value),c=g+d.pathname.replace(c.pathname,"")+d.search+(d.hash?"#"+d.hash:""),e.setAttribute("data-base-url",g),e.setAttribute("href",c),f++);return q+l+f},fixMentions:function(a){return r(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-handlers.js' */
define("confluence-collaborative-editor-plugin/synchrony-handlers","underscore jquery ajs confluence/meta confluence/analytics-support confluence/legacy confluence-editor/editor/page-editor-message confluence-collaborative-editor-plugin/lib/SyncManager confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-presence confluence-collaborative-editor-plugin/util/location-provider confluence-collaborative-editor-plugin/util/url-parser confluence-collaborative-editor-plugin/util/editor-format-fixer confluence-collaborative-editor-plugin/editor-blanket confluence/api/event window".split(" "),
function(F,h,c,f,G,n,w,H,k,l,I,J,v,x,K,b,p){function y(a,d){d.contributors&&(z=d.contributors,b.unbind(a,y))}function L(a){t=!0;q.val(a.rev.toString())}function M(a){q.val(a.rev.toString());b.trigger("synchrony.entity.ack",{pendingChanges:0<a.pending.length})}function N(){r.onDisconnectedState();c.log("Synchrony disconnected!")}function O(a){if("null/no-such-sequence"===a.errorType||"null/entity-evicted"===a.errorType||"hub.error/locked"===a.errorType){b.trigger("analyticsEvent",{name:"confluence.editor.data.evicted.error",
data:{errorType:a.errorType,onLoad:!t,afterReload:null!==p.sessionStorage.getItem(u())}});e.destroy();b.trigger("synchrony.history.evicted");a=null===p.sessionStorage.getItem(u());var d=t?"\u003cb\u003eWe couldnt sync your changes\u003c/b\u003e\u003cbr/\u003eCopy the changes you want to keep, then refresh the page to continue editing.":a?"Reloading this page to get it back in sync.":"\u003cb\u003eIts taking a while to sync this page\u003c/b\u003e\u003cbr/\u003eGive it a minute, then refresh the page to start editing. Contact your Confluence admin if this keeps happening.";b.trigger("editor.error.message",{disablePublish:!0,close:"never",message:d});if(t)r.onDisconnectedState();
else K.showBlanket("block"),a&&(p.sessionStorage.setItem(u(),"false"),p.location.reload());P()}else"fatal"===a.level&&b.trigger("editor.error.message",{disablePublish:!0})}function P(){p.onerror=function(a,d,b,e,c){if(!(d||b||e||c)){if(A)return!0;A=!0}else if(c&&c.message&&"entity destroyed"===c.message)return!0;return!1}}function u(){return"_reload_for_"+f.get("draft-id")}function Q(a){k.timeEnd("confluence.editor.synchrony.connect");c.log("Synchrony connected.");I.appendTo(a.sid,e,z);r.onConnectedState(e);
b.trigger("synchrony.connected");l.fixTinymceCaretContainer(m,g);p.sessionStorage.removeItem(u())}function B(a,d,b){return{origin:"synchrony",cause:a,messageKey:d,disablePublish:b}}function R(a){function d(c){c.pending.length||(e.off("ack",d),q.val(c.rev.toString()),b.resolve(a))}var b=h.Deferred();e.ackState().pending.length?(e.on("ack",d),setTimeout(function(){e.off("ack",d);b.reject(B("timeout"))},5E3)):b.resolve(a);return h.when(b,C).promise()}function D(a){return(a=k.getLatestRevisionWithAttr(a.revisions,
"user"))?a.meta.user:"Anonymous"}function S(a){w.handleMessage("editor.synchrony.page-published",{type:"info",message:c.format("{0} published this page.",c.escapeHtml(a)),close:"auto"});b.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.publish"});b.trigger("editor-shared-drafts-published")}function T(a){if("remote"===a.updateType){q.val(a.revisions[a.revisions.length-1].rev.toString());k.hasRevisionTrigger(a.revisions,"reset")&&(w.handleMessage("editor.synchrony.revert-page",
{type:"info",message:c.format("{0} reverted to a previous version of this page.",c.escapeHtml(D(a)))}),f.set("has-collaborated",!1),E(),b.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.revert"}),b.trigger("editor-shared-drafts-discarded"),n.Editor.heartbeat());k.hasRevisionTrigger(a.revisions,"publish")&&(l.isUnpublished()&&(f.set("new-page",!1),f.set("page-id",n.getContentId()),f.set("draft-id","0"),n.Editor.isLimitedModeEnabled()||n.Editor.UI.setButtonState(!0,h("#rte-button-discard"))),
f.set("has-collaborated",!1),E(),S(D(a)),n.Editor.heartbeat());k.hasRevisionType(a.revisions,"external")&&b.trigger("editor.external.change");var d=k.getLatestRevisionWithAttr(a.revisions,"confVersion");d&&d.meta.confVersion&&(h('meta[name\x3d"page-version"]').attr("content",d.meta.confVersion),h('meta[name\x3d"ajs-page-version"]').attr("content",d.meta.confVersion),f.set("page-version",d.meta.confVersion))}setTimeout(function(){if("init"===a.updateType||"remote"===a.updateType)b.trigger("editor.remote.change"),
l.readTitleFromRootElement(m);"init"==a.updateType&&(U(J.getLocation())?g.undoManager.ignore(function(){var a=x.fixStaleBaseUrl(m);0<a&&G.publish("collab.edit.format.stale.fix.count",{staleformatfixed:a})}):c.log("Request url does not match the configured base url. Not performing fixStaleBaseUrl()."),g.undoManager.ignore(function(){x.fixMentions(m)}));l.fixTinymceCaretContainer(m,g);"local"===a.updateType&&(g.undoManager.hasUndo()||g.setDirty(!1),b.trigger("editor.local.change"))},0)}function E(){0===
e.ackState().pending.length&&g.setDirty(!1)}function U(a){var b=f.get("context-path"),c=v.parseUrl(f.get("base-url"));a=v.parseUrl(a);b=v.parseUrl(a.protocol+"://"+a.host+b);return F.isEqual(c,b)}var q,r,g,m,e,C,z=[],t=!1,A=!1;b.bind("editor-heartbeat",y);return{handle:function(a,b,c,f){k.time("confluence.editor.synchrony.connect");e=a;g=b;r=c;C=f.pipe(null,function(a){e.destroy();r.onDisconnectedState();return B(a,"collaborative-editor-load-failure",!0)});q=h("#syncRev");m=g.getBody();e.on("init",
L).on("update",T).on("ack",M).on("connected",Q).on("disconnected",N).on("error",O);new H(e,{DEBUG_MODE:!0});l.bindPostPasteFix();l.readTitleFromRootElement(m);n.Editor.overrideBeforeSave(R);h("#content-title").keyup(l.writeTitleToRootElement)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-editor.js' */
define("confluence-collaborative-editor-plugin/synchrony-editor","window jquery ajs confluence/legacy confluence-collaborative-editor-plugin/editor-blanket confluence-collaborative-editor-plugin/synchrony-util confluence-collaborative-editor-plugin/synchrony-content confluence-collaborative-editor-plugin/synchrony-auth confluence-collaborative-editor-plugin/synchrony-entity confluence-collaborative-editor-plugin/synchrony-handlers confluence-editor/support/atlassian-editor-support confluence-editor/loader/collaborative-helper".split(" "),
function(h,f,c,m,B,d,r,z,C,M,N,O){function t(a){f('meta[name\x3d"ajs-collaborative-editor-status"]').attr("content",a)}function P(){return!c.Rte.isQuickEdit}function Q(){var a=f.Deferred();c.$(function(){c.$("body").addClass("synchrony-active");u=new (require("confluence-collaborative-editor-plugin/status-indicator-view"))({el:"#pluggable-status",model:new Backbone.Model({minActiveTime:500})});z.init(u);a.resolve()});return a}function v(a){if(!0!==D){switch(a){case "timeout":a="The editor didn\u0027t load this time";
var b="The connection timed out. If it happens again, speak to your Confluence admin. You may be using a proxy server that prevents WebSocket connections.\u003c/br\u003e\u003ca href=\u0022#\u0022 id=\u0022websocketRetry\u0022\u003eTry again\u003c/a\u003e&nbsp;.&nbsp;\u003ca href=\u0022https://confluence.atlassian.com/display/CONFKB/Confluence+throws+The+editor+didn%27t+load+this+time+error+when+trying+to+edit+a+page\u0022 target=\u0022_blank\u0022 id=\u0022websocketFindmore\u0022\u003eFind out more\u003c/a\u003e";break;case "synchrony-requests":w=!0;a="";b="Something went wrong after loading the editor. Copy your unsaved changes and refresh the page to keep editing.";break;case "limited-mode":w=!0;a="";b="Something went wrong while loading the editor, please try again.";break;default:w=!0,a="",b="This page is taking longer to load than usual. Give it a few moments, then try refreshing. Still having issues? Contact your Confluence admin."}c.trigger("editor.error.message",{title:a,messageKey:"collaborative-editor-load-failure",message:b,disablePublish:!0,close:"manual"})}}
function E(){c.trigger("dismiss.editor.error.message",{messageKey:"collaborative-editor-load-failure",enablePublish:!0})}function F(a,b){var e=f.Deferred();a.done(function(){d.timeEnd(b)},e.resolve);a.fail(e.resolve);return e.promise()}function G(a,b){var e="error"===b[1]&&b[0].responseText?JSON.parse(b[0].responseText):"",g=!1;"invalid-ancestor"===e.type?g="synchrony":"out-of-order-revision"===e.type&&(g="confluence");return g?(c.log("Performing synchrony recovery"),f.ajax({url:c.contextPath()+"/rest/synchrony/1.0/content/"+
m.getContentId()+"/recovery?behind\x3d"+g+"\x26conflictingRev\x3d"+e["conflicting-rev"],type:"PUT"}),"synchrony-requests"):"success"!==b[1]&&"success"!==a[1]||"success"!==b[1]&&"duplicate-mismatch"!==e.type?(c.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.failure",data:{type:e.type,contentId:m.getContentId()}}),"synchrony-requests"):!1}function H(a){return z.performRequest(function(b){d.time("confluence.editor.synchrony.snapshot");return F(f.ajax({type:"POST",
url:encodeURI(d.getServiceUrl()+"/data"+d.getEntityId()+"?state-at\x3d@head\x26state-format\x3dtype-tagged\x26rewrite-request\x3dtrue\x26cached\x3d"+a),contentType:"text/plain",dataType:"json",data:JSON.stringify({headers:{"content-type":"application/json","x-token":b},method:"GET"})}).pipe(d.asArray,d.asArray),"confluence.editor.synchrony.snapshot")})}function R(a){return a.syncRev||!r.isUnpublished()||0!==a.raw.length&&!/^\s+$/.test(a.raw)?r.isContentEmpty(a.raw)?(c.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.blank-content",
data:{contentId:m.getContentId()}}),f.Deferred().resolve([{},"success"])):z.performRequest(function(b){d.time("confluence.editor.synchrony.CR");return F(f.ajax({type:"POST",url:encodeURI(d.getServiceUrl()+"/data"+d.getEntityId()+"?optimistic\x3dtrue\x26rewrite-request\x3dtrue"),dataType:"json",contentType:"text/plain",data:JSON.stringify({body:{ancestor:a.syncRev,rev:a.confRev,state:{format:"html",value:a.html},merges:{master:{meta:{type:"client-reconciliation"}}}},headers:{"content-type":"application/json",
"x-token":b},method:"PUT"})}).pipe(d.asArray,d.asArray),"confluence.editor.synchrony.CR")}):f.Deferred().resolve([{},"success"])}function S(a){d.time("confluence.editor.synchrony");f.when(Date.now(),a).pipe(function(a){t("on");var b=Date.now();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.loaded",data:{durationMillis:b-a,contentId:m.getContentId()}});c.trigger("rte-collab-ready");d.timeEnd("confluence.editor.synchrony");d.timeEnd("confluence.editor")})}function T(){var a=x("synchrony.connected synchrony.connected.fake");
x("synchrony.connected synchrony.connected.fake synchrony-unsupported-extension",3E4).fail(function(b){v(b);c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.load.timeout",data:{contentId:m.getContentId()}});U();I=!0;a.done(function(){w||(J=!0,E())})})}function V(a,b,e){var g=l._initialiseSynchrony(),A=x("synchrony.connected.fake"),k=x(null);b.pipe(function(){setTimeout(k.reject,3E4,"synchrony-requests")});var K=l._initialiseCollabEditingComponents(k),p=Date.now(),h=null,n=null;c.DarkFeatures.isEnabled("synchrony-pessimistic-snapshot")||
(h=g.pipe(function(){return H(!0)}),h.done(function(a){n=a[1]}));var q=f.when(a,g).pipe(function(){return!h||"rejected"===h.state()||"error"===n||6E5<Date.now()-p?H(!1):h});e.pipe(function(){T();S(A);B.applyBlanket(A)});b.pipe(function(a){var b=g.pipe(function(){return R(a)});q=f.when(q,g).pipe(function(a,b){d.time("confluence.editor.synchrony.unmarshal");var c=a;"success"===a[1]&&(c=[{stateAt:a[0].stateAt,state:b.unmarshal(a[0].state.value)},a[1]]);d.timeEnd("confluence.editor.synchrony.unmarshal");
return c});f.when(q,b).pipe(function(a,b){(a=G(a,b))?k.reject(a):k.resolve()});return c.DarkFeatures.isEnabled("synchrony-pessimistic-CR")||"synchrony-ack"!==a.syncRevSource&&!r.isUnpublished()?f.when(a,e,q,b,K):(c.debug("confluence.editor.synchrony: content up to date, not waiting for CR"),k.fail(v),f.when(a,e,q,[{},"success"],K))}).pipe(function(a,b,e,g){if(!l._bindEditor(a,b,e,g,k))return c.trigger("analyticsEvent",{name:"confluence.synchrony.bind.failure",data:{contentId:m.getContentId()}}),f.Deferred().reject("editor-binding-failed");
A.resolve()}).fail(function(a){e.always(function(){"synchrony-not-enabled"!==a&&(c.log("Failed to load the collaborative editor",a),v(a),c.$(function(){u.onDisconnectedState()}),t("failed"),c.trigger("analyticsEvent",{name:"confluence.synchrony.error",data:{error:a,contentId:m.getContentId()}}))})})}function x(a,b,e){var g=f.Deferred();a&&c.bind(a,function p(b,e){c.debug("confluence.editor.synchrony.event: "+b.type+"."+b.namespace);c.unbind(a,p);g.resolve(e)});b&&setTimeout(g.reject,b,e||"timeout");
return g}function n(a,b,e,g,h){var k=h||f.Deferred();if(d.isEditorInitialised()||b&&d.synchronyReady())return L(k,e);c.bind(a,function W(b,d){c.debug("confluence.editor.event "+b.type+"."+b.namespace);k.always(function(){c.unbind(a,W)});L(k,e,d,g)});return k}function L(a,b,e,c){return d.synchronyReady()?!c||c()?(b=b?b(e):e)&&b.error?a.reject(b.error):a.resolve(b):a:a.reject("synchrony-not-enabled")}function U(){f("#websocketRetry").on("click",function(){c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.retry.click"});
h.location.reload();return!1});f("#websocketFindmore").on("click",function(){c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.findmore.click"})})}var l={};d.time("confluence.editor.synchrony.jsLoad");var u,w=!1,D=!1,J=!1,I=!1,y;f(h).bind("beforeunload",function(){J||c.trigger("analyticsEvent",{name:"confluence.synchrony.exit.before.connecting",data:{afterTimeout:I,contentId:m.getContentId()}})});c.bind("synchrony.history.evicted",function(a){D=!0});l._bindEditor=function(a,
b,e,g,h){d.time("confluence.editor.synchrony.init");if(G(e,g))return null;g=f("#syncRev");var k=null;"success"===e[1]&&(e=e[0],k={base:{rev:Synchrony.rev(e.stateAt),state:e.state}},g.val(k.base.rev.toString()));c.log("Synchrony will load with contentId: ",m.getContentId());try{var l=b.getBody();l.setAttribute("data-title",a.title);y=C.bind(Synchrony,b,l,k,a);M.handle(y,b,u,h);c.trigger("editor.remote.change");b.setDirty(!1);d.timeEnd("confluence.editor.synchrony.init");return y}catch(p){return c.logError(p),
null}};l._initialiseCollabEditingComponents=function(a){var b=Q();f(h).one("synchrony.connected.fake",function(c){"connected.fake"===c.namespace&&(b.resolve(),a.resolve(),E(),t("fake"))});return b};l._initialiseSynchrony=function(){d.time("confluence.editor.synchrony.deps");(function(a){var b=a.Synchrony=a.Synchrony||{};if(!b.ready){var c=b._cbs=b._cbs||[];b.ready=function(a){c.push(a)}}var d=function(){1===b.state&&(b.SockJS=a.SockJS,b.init())};if(a.SockJS)b.init&&d();else{var f=a._sockjs_onload;
a._sockjs_onload=function(){d();f&&f.apply(this,arguments)}}})(h);var a=f.Deferred();Synchrony.ready(a.resolve);return f.when(a.promise(),d.loadScript(["/js/vendor/sockjs.min.js","/js/synchrony.min.js"])).pipe(function(a){d.timeEnd("confluence.editor.synchrony.deps");c.log("Synchrony successfully initialised.");return a})};l.init=function(){if(N.isCollaborativeContentType()){var a=n("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready",!0),b=n("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready rte-collab-editor-loaded",
!1),e=n("rte-collaborative-content-ready rte-initial-raw-content-ready",!1,r.getContent),d=n("rte-collab-editor-loaded",!1,c.Rte.getEditor);d=n("rte-ready rte-begin-collab-editing",!1,c.Rte.getEditor,P,d);a.pipe(function(){V(b.promise(),e.promise(),d.promise())});e.fail(v);c.trigger("synchrony-events-bound");d.fail(function(a){"synchrony-not-enabled"===a&&(B.showEditor(),t("off"),c.log("Synchrony is not available in this context."))})}};l.register=function(){O.registerPlugin(l)};l.getSynchronisedEditorContent=
function(){var a=y.ackState();if(a.rev){var b=Synchrony.makeDom(a.state,{document,whitelist:C.makeWhitelist(Synchrony)});return{content:require("tinymce").activeEditor.serializer.serialize(b),syncRev:a.rev.toString()}}c.logError("Synchrony hasn't acked any data, can't fetch draft data");return null};d.timeEnd("confluence.editor.synchrony.jsLoad");return l});require("confluence/module-exporter").safeRequire("confluence-collaborative-editor-plugin/synchrony-editor",function(h){h.register();h.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:soy-resources', location = 'soy/image-attributes-panel.soy' */
// This file was automatically generated from image-attributes-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.ImageAttributes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.ImageAttributes == 'undefined') { Confluence.Templates.Editor.ImageAttributes = {}; }


Confluence.Templates.Editor.ImageAttributes.content = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label for="image-title-attribute">' + soy.$$escapeHtml('Title text') + '</label><input class="text" type="text" id="image-title-attribute" name="image-title-attribute" value="' + ((opt_data.imgTitle) ? soy.$$escapeHtml(opt_data.imgTitle) : '') + '"><div class="description">' + soy.$$escapeHtml('Appears when the cursor hovers over the image') + '</div></div><div class="field-group"><label for="image-alt-attribute">' + soy.$$escapeHtml('Alt text') + '</label><input class="text" type="text" id="image-alt-attribute" name="image-alt-attribute" value="' + ((opt_data.imgAlt) ? soy.$$escapeHtml(opt_data.imgAlt) : '') + '"><div class="description">' + soy.$$escapeHtml('Used by screen readers and when the image cannot be shown') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.ImageAttributes.content.soyTemplateName = 'Confluence.Templates.Editor.ImageAttributes.content';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:image-attributes', location = 'js/image-attributes-panel.js' */
define("confluence-image-attributes/image-attributes-panel",["jquery","ajs","confluence/legacy"],function(f,h,g){return function(){function k(){var a=c.val();d.attr({"data-element-title":a,title:l(d.attr("data-location"),a),alt:e.val()})}function m(){c.val()===e.val()&&(c.bind("input.chained",function(a){e.val(c.val())}),e.on("change",function(){c.unbind("input.chained")}))}function l(a,b){return a&&0<a.length&&b&&0<b.length?a+" ("+b+")":a&&0<a.length?a:b&&0<b.length?"("+b+")":""}h.bind("dialog-created.image-properties",
function(a,b){d=f(b.img);a=f(g.Templates.Editor.ImageAttributes.content({imgTitle:d.attr("data-element-title"),imgAlt:d.attr("alt")}));c=a.find("#image-title-attribute");e=a.find("#image-alt-attribute");m();g.Editor.ImageProps.registerPanel(n,a,p,k)});var n="image-attributes",p="image-attributes-panel",d,c,e}});require("confluence/module-exporter").safeRequire("confluence-image-attributes/image-attributes-panel",function(f){require("ajs").toInit(f)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",["tinymce","confluence/legacy"],function(a,b){return{init:function(a){a.on("init",function(){a.addCommand("mceConfimage",b.Editor.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceImageDialog",a);b.PluginManager.add("confluenceimagedialog",b.plugins.ConfluenceImageDialog)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'utils/tinymce-image-utils.js' */
define("confluence-editor/utils/tinymce-image-utils","jquery confluence/api/logger confluence/meta ajs tinymce confluence/api/constants".split(" "),function(d,m,n,j,o,r){var p=["imagetext","src","align","border","width","height"],s=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,q=function(a,b,f,c,e){if(c){a.width=b>=e?e:b;a.style.maxWidth=""}else{a.height=f>=e?e:f;a.style.maxHeight=""}},k;k={isScaledByWidth:function(){return false},updateImageElement:function(a,b){var f=d(a),c;c=b.destination;
c=k.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;f.toggleClass("confluence-content-image-border",!!b.border);f.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var e=p.length;c<e;c++){var h=p[c],g=b[h];g!==false&&g!=null?f.attr(h,g):f.removeAttr(h)}o.activeEditor.undoManager.add()},insertFromProperties:function(a,b){d.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:r.CONTEXT_PATH+"/rest/tinymce/1/embed/placeholder/image",
data:d.toJSON(a),dataType:"text",success:function(a){k.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var f,c=k.isScaledByWidth(),e=d(a);f=c?j.Confluence.PropertyPanel.Image.getPresetImageSize("large"):n.get("content-type")==="comment"?j.Confluence.PropertyPanel.Image.getPresetImageSize("small"):j.Confluence.PropertyPanel.Image.getPresetImageSize("medium");e.css(c?"max-width":"max-height",f+"px");var h=o.activeEditor,g="_"+ +new Date,i=d("<div></div>").append(e.attr("id",g));
h.selection.setContent(i.html());var l=h.dom.get(g);h.dom.setAttrib(l,"id","");if(!e.hasClass("confluence-external-resource")){g=e.attr("data-image-width");i=e.attr("data-image-height");if(g===void 0&&i===void 0){g=e.attr("width");i=e.attr("height")}q(l,g,i,c,f);this.updateThumbnailAttribute(l)}d(l).one("load",function(){e.hasClass("confluence-external-resource")&&q(this,this.width,this.height,c,f);j.Rte.showSelection(function(){b||j.trigger("trigger.property-panel",{elem:l});h.undoManager.add()});
h.fire("Change")})},updateThumbnailAttribute:function(a){var b=a.width,f=a.height;if(b||f){var c=d(a),e=c.attr("data-image-width"),h=c.attr("data-image-height"),g=n.get("max-thumb-width"),i=n.get("max-thumb-height"),a=!this.isRemoteImg(a.src)&&this.isThumbnailUsable(b,f,e,h,g,i);c.attr("thumbnail",a);c.toggleClass("confluence-thumbnail",a)}},isRemoteImg:function(a){var b=j.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&a.indexOf(b)===-1},isThumbnailUsable:function(a,b,f,c,e,d){if(a){if(a>
e)return false;if(f===void 0&&c===void 0)return true;e=f/c;return e>=1?true:e*d>=a}a=b;if(a>d)return false;if(f===void 0&&c===void 0)return true;d=c/f;return d>=1?true:d*e>=a}};return{ImageProperties:function(a){if(a&&d.nodeName(a,"img")&&d(a).hasClass("confluence-embedded-image")){var b=d(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&b.attr("class").indexOf("confluence-content-image-border")!==-1?1:0,width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&
!b.attr("height")};if(!k.isRemoteImg(a.destination)&&!d(b).hasClass("confluence-external-resource")){var f=a;var b=d(b).attr("src"),c=b.match(s);if(c&&c.length===3)b=c[2];else{m.log("ERROR: could not parse page id from image url "+b);b="0"}f.pageId=b}return d.extend({},a)}if(a.destination){a.imageFileName=a.imageFileName||a.destination;return d.extend({},a)}return null},ImageUtils:k}});
require("confluence/module-exporter").safeRequire("confluence-editor/utils/tinymce-image-utils",function(d){var m=require("tinymce");m.confluence.ImageProperties=d.ImageProperties;m.confluence.ImageUtils=d.ImageUtils});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-links.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links",["ajs","jquery","confluence/legacy","tinymce","window"],function(a,e,i,j,k){var h=0;return{name:"link",canHandleElement:function(a){return a.is("a")&&"#"!=a.attr("href")&&!a.hasClass("unresolved")},handle:function(f){var c=f.containerEl,g=f.ed,b=function(c){return a.Rte.getEditor().translate(c)},f={anchorIframe:a.Rte.getEditorFrame()},d=0===(c.getAttribute("href")||"").indexOf("#"),b=[{className:"link-property-panel-goto-button",
text:b("propertypanel.links_goto"),tooltip:d?b("propertypanel.links_goto_disabled_tooltip"):c.href,href:c.href,disabled:d,click:function(){a.Confluence.PropertyPanel.destroy();var b=k.open(c.href,j.isIE?"_blank":"confluence-goto-link-"+a.params.pageId+"-"+h);b.focus();b.opener=null}},{className:"link-property-panel-edit-button",text:b("propertypanel.links_edit"),tooltip:b("propertypanel.links_edit_tooltip"),disabled:e(c).hasClass("createlink")||!c.href,click:function(){a.Confluence.PropertyPanel.destroy();
g.selection.select(c);i.Editor.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",text:b("propertypanel.links_unlink"),tooltip:b("propertypanel.links_unlink_tooltip"),click:function(){a.Confluence.PropertyPanel.destroy();g.execCommand("mceConfUnlink",!1,c);g.focus()}}],d=[];a.trigger("link-property-panel-buttons.created",{buttons:d,link:c});b=b.concat(d);a.Confluence.PropertyPanel.createFromButtonModel(this.name,c,b,f);h++}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","AJS.Confluence.PropertyPanel.Link",function(a){var e=require("ajs");e.bind("init.rte",function(){e.trigger("add-handler.property-panel",a)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-macros.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","ajs tinymce jquery confluence/legacy document confluence/macro-js-overrides underscore".split(" "),function(b,m,d,s,n,t,u){var o=[],p=[],l={},k="__PROPERTY_PANEL_SPACER",v=[{key:k}];return{name:"macro",registeredEvents:o,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){function i(){var c="macro-placeholder-property-panel-remove-button";e.length>
0&&e[e.length-1].key==k&&(c=c+" first");h.push({className:c,text:"Remove",click:function(){b.Confluence.PropertyPanel.destroy();b.Rte.getEditor().execCommand("mceConfRemoveMacro",j)}});if(g.attr("data-macro-parameters")){var a=s.MacroParameterSerializer.deserialize(g.attr("data-macro-parameters"));if("atlassian-macro-output-type"in a){c=function(c){return function(b){a["atlassian-macro-output-type"]=c;g.attr("data-macro-parameters",s.MacroParameterSerializer.serialize(a));
c=="INLINE"?d(".macro-placeholder-property-panel-display-newline-button").removeClass("active"):d(".macro-placeholder-property-panel-display-inline-button").removeClass("active");d(b).addClass("active")}};h.push(null);h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"Display on new line",selected:a["atlassian-macro-output-type"]=="BLOCK",click:c("BLOCK")});h.push({className:"macro-placeholder-property-panel-display-inline-button",
tooltip:"Display inline",selected:a["atlassian-macro-output-type"]=="INLINE",click:c("INLINE")})}}d.each(o,function(){(!this.macroName||this.macroName==f)&&d(n).bind(q(this.id,this.macroName),this.handler)});c=p;f&&l[f]&&(c=c.concat(l[f]));d.each(c,function(){try{this(j,h,w)}catch(c){b.debug("Property panel init handler failed for : "+f+".  Is global handler : "+(d.inArray(this,p)>-1),c)}});if(h.length>0){var c=b.Confluence.PropertyPanel.createFromButtonModel("macro",
j,h,w),x=t.getFunction(f,"propertyPanelIFrameInjector");x&&x(c)}}if(!(a.e.type!=="click"&&a.e.type!=="mouseup")){var j=a.containerEl,g=d(j),f,e=[],a=!g.hasClass("editor-inline-macro"),y=!g.hasClass("wysiwyg-unknown-macro"),h=[],w={originalHeight:a&&g.height(),anchorIframe:b.Rte.getEditorFrame()},q=function(c,a){return c+"-button-click"+(a?a+".macro":"")+".property-panel"};if(y){var r=d.Deferred();f=g.attr("data-macro-name");if(b.MacroBrowser.getMacroMetadata(f))e=b.MacroBrowser.getMacroMetadata(f).buttons;
(a=t.getFunction(f,"getControls"))?a(function(a){var b=e,a=u.filter(a,function(a){return a.type==="button"}),a=u.map(a,function(a){return{key:a.key,label:a.name.value}});e=b.concat(v).concat(a).concat(v);r.resolve()}):r.resolve();r.done(function(){var a="macro-placeholder-property-panel-edit-button";e.length>0&&e[0].key==k&&(a=a+" last");h.push({className:a,text:"Edit",click:function(){b.Confluence.PropertyPanel.destroy();m.confluence.macrobrowser.editMacro(g)}});
d.each(e,function(a,c){if(c.key!=k){var i="macro-property-panel-"+c.key;a>0&&e[a-1].key==k&&(i=i+" first");a<e.length-1&&e[a+1].key==k&&(i=i+" last");h.push({className:i,text:c.label,parameterName:c.key,click:function(){d(n).trigger(q(c.key),g);d(n).trigger(q(c.key,f),g);b.Confluence.PropertyPanel.destroy()}})}})}).then(i())}else i()}},registerButtonHandler:function(a,b,d){Array.isArray(a)||(a=[a]);a.forEach(function(a){o.push({id:a,handler:b,macroName:d})})},registerInitHandler:function(a,b){if(b){l[b]=
l[b]||[];l[b].push(a)}else p.push(a)},yieldButtonFor:function(a,b){var j;d.each(a,function(){this.parameterName&&this.parameterName==b&&(j=this)});return j}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","AJS.Confluence.PropertyPanel.Macro",function(b){var m=require("ajs");m.bind("init.rte",function(){m.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-images.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","jquery ajs tinymce confluence-editor/utils/tinymce-image-utils confluence/meta confluence/legacy confluence/api/browser confluence/property-panel".split(" "),function(f,g,s,F,v,w,G,h){function x(){var a=[];f.each(t,function(b,c){a.push(c)});h.current.panel.find(a.join(", ")).removeClass("active")}function p(a,b,c){var e=y(a,b),c=y(a,c),j=e||c;if(j){var d=h.getAnchor(),i=d.width(),d=d.height(),f=v.get("max-thumb-width"),
g=v.get("max-thumb-height");a.thumbnail=k.isRemoteImg(a.destination)?false:k.isThumbnailUsable(e,c,i,d,f,g);a.originalSelected=false;if(b){delete a.height;a.width=j}else{delete a.width;a.height=j}m(a);x();return true}return false}function z(a,b){if(u?p(a,n[b]):p(a,null,n[b])){A(b);m(a);return true}return false}function B(a){delete a.width;delete a.height;a.thumbnail=false;a.originalSelected=true;x();A("original");var b=h,c=b.getAnchor();b.current.updating=true;c.one("load",function(){l(b);q(a);a.width=
Math.floor(c.width());a.height=Math.floor(c.height())});k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);c.each(function(){this.complete&&f(this).trigger("load")});return true}function A(a){h.current.panel.find(t[a]).addClass("active")}function C(a){f(".image-border-toggle").toggleClass("active",!a.border);a.border=+!a.border||false;m(a)}function m(a){var b=h,c=b.getAnchor(),e=c.attr("src"),f=c.height();b.current.updating=true;k.updateImageElement(c,a);s.isGecko&&
g.Rte.getEditor().execCommand("mceRepaint",false);if(a.src!=e){var d=setInterval(function(){var a=c.height();if(a!=f){g.debug("updateImageElement : height changed after image src change - "+f+" to "+a);clearTimeout(d);d=null;l(b)}},10);setTimeout(function(){if(d){clearTimeout(d);d=null;l(b)}},1E3)}else l(b);q(a)}function q(a){a=a.width?a.width:h.getAnchor().width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function y(a,b){b=parseInt(b);if(!isNaN(b)){b<D?b=D:b>E&&(b=E);return b}return null}
var k=F.ImageUtils,u=k.isScaledByWidth(),n;n=u?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};var t={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"},D=16,E=9E4,l=function(a){a.current.updating=false;a.current.snapToElement({animate:true,animateDuration:100})};return{_resizeImage:p,pluginButtons:[],name:"image",getPresetImageSize:function(a){return n[a]},canHandleElement:function(a){return a.is("img")&&!a.hasClass("editor-inline-macro")&&
!a.hasClass("template-variable")},handle:function(a){function b(){p(e,f("#image-size-input").val())?true:q(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})}var c;c=a.nodeName==="IMG"?a:a.containerEl;var a=f(c),e=s.confluence.ImageProperties(c);if(e&&!a.attr("data-resource-id")){var j=g.Rte.getEditor(),d=function(a){return j.translate(a)},i=function(a){return{className:["image-size-"+a,"editor-resize","resize-"+a].join(" "),text:d("propertypanel.images_"+a),tooltip:d("propertypanel.images_"+
a+"_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:function(){z(e,a);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:u?e.width==n[a]:e.height==n[a]}},i=[{className:"editable",tooltip:d("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,i("small"),i("medium"),i("large"),{className:"image-size-original",text:d("propertypanel.images_original"),tooltip:d("propertypanel.images_original_tooltip"),click:function(){B(e);
g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},selected:e.originalSelected},null,{className:"image-border-toggle",text:d("propertypanel.images_border"),tooltip:d("propertypanel.images_border_tooltip"),click:function(){C(e)},selected:e.border||e.border==1}];i.push(null);var k=a.parent();if(k.is("a[href]")){i.push({className:"image-link-edit",text:d("propertypanel.images_link_edit"),tooltip:d("propertypanel.images_link_edit_tooltip"),click:function(){h.destroy();j.selection.select(k[0]);
w.Editor.LinkBrowser.open()}});i.push({className:"image-link-remove",text:d("propertypanel.images_link_remove"),tooltip:d("propertypanel.images_link_remove_tooltip"),click:function(){h.destroy();j.execCommand("mceConfUnlink",false,c);j.focus()}})}else i.push({className:"image-make-link",text:d("propertypanel.images_link_create"),tooltip:d("propertypanel.images_link_create_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-link",click:function(){h.destroy();j.selection.select(c);w.Editor.LinkBrowser.open()}});
for(var l=h.Image.pluginButtons,r=0;r<l.length;r++)if(l[r]===null)i.push(null);else{var m=l[r].create(a);m&&i.push(m)}h.createFromButtonModel(this.name,c,i,{anchorIframe:g.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){b()});(new G(window.navigator.userAgent)).isIE()&&a.bind("keyup",function(a){a.keyCode===13&&b()});h.current.imageProps=e;q(e);var o=e;return{setPresetSize:function(a){z(o,a)},setPixelSize:function(a){p(o,a)},
setToOriginalSize:function(){B(o)},toggleBorder:function(){C(o)},getWidth:function(){return o.width},getHeight:function(){return o.height},getDisplayWidth:function(){return f("#image-size-input").val()},isButtonSelected:function(a){return h.current.panel.find(t[a]).hasClass("active")}}}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","AJS.Confluence.PropertyPanel.Image",function(f){var g=require("ajs");g.bind("init.rte",function(){g.trigger("add-handler.property-panel",f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
define("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog",["jquery","ajs"],function(d,a){function l(){h||(h=d("#image-properties-tab-items > div").map(function(){var a=d(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight}));return h}function m(){var a=c.popup.element,b=650/60,e=d('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(a.find(".dialog-page-body")),
f=e.find(".loading-data");e.css({width:e.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var a=[],g;for(g in i)b=i[g],(b=b.saveFn&&b.saveFn())&&b.done&&a.push(b);d.when.apply(d,a).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}
function o(){c.hide().remove()}var c,h,i={},n;return{init:function(){n||(h=null,0<l().length&&(n=!0,a.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"Properties",tooltip:"Set additional image properties",click:function(h,b){a.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});a.Confluence.PropertyPanel.destroy();d("#image-properties-dialog").remove();c=new a.ConfluenceDialog({id:"image-properties-dialog",
onSubmit:m});a.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("Image Properties");c.addSubmit("Save",m);c.addCancel("Cancel",o);for(var e=c,f=l(),g=0;g<f.length;g++){var j=f[g],k=i[j.key];k&&e.addPanel(j.label,k.content,k.panelClass,j.key)}1===f.length&&e.popup.element.find(".dialog-page-menu").show();a.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog","Confluence.Editor.ImageProps",function(d){var a=require("ajs");a.toInit(d.init);a.bind("quickedit.success",d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:edit-resources', location = 'js/edit-init.js' */
require(["ajs","confluence/meta","confluence/share-page/service/share-page","confluence/share-page/service/share-dialog-loader","confluence/dark-features"],function(b,a,f,g,h){function d(){if("page"===a.get("content-type")||"blogpost"===a.get("content-type")){var c=b.$;if(h.isEnabled("react.share.dialog")){var d=c("\x3cdiv\x3e").addClass("invite-to-edit-container").tooltip({title:function(){return "Invite people to edit with you"},gravity:"ne"});d.append(c("\x3cspan\x3e").attr("id",
"share-react-link"));c("#rte-toolbar").prepend(d);g.init("share-react-link","edit")}else{c("#rte-toolbar").prepend(c(document.createElement("div")).prop("id","#inviteToEditLink".replace("#","")).addClass("aui-button").addClass("invite-to-edit-button").html('\x3cspan class\x3d"invite-plus-icon"\x3e\x3c/span\x3e').tooltip({title:function(){return "Invite people to edit with you"},gravity:"ne"}));var e=c("#inviteToEditLink");c="page"===a.get("content-type")?"Let\u0027s work together on this page":
"Let\u0027s work together on this blog post";f.initDialog("#inviteToEditLink","inviteToEditPopup",{},{heading:"Invite people to edit",notePlaceholder:c,link:function(){return require("confluence/share-page/fetch/content-info")(a.get("content-id"),"draft").pipe(function(b){return a.get("base-url")+b._links.edit})},entityId:function(){return a.get("draft-id")},restriction:function(){return require("confluence/share-page/fetch/content-restrictions")(a.get("content-id")).pipe(function(a){var c=
{};if(a.read.restrictions.user.size||a.read.restrictions.group.size||a.update.restrictions.user.size||a.update.restrictions.group.size)c.type="restrict",c.message="Restrictions on this page may prevent people viewing or editing.";return c})},copyOption:"invite",shareType:"edit",contentType:a.get("content-type"),errorText:"An unexpected error occurred. Please try again.",beforeLoad:function(){e.find(".invite-plus-icon").css("visibility","hidden");e.spin()},afterLoad:function(){e.find(".invite-plus-icon").css("visibility","visible");
e.spinStop()}})}}}"collaborative"===a.get("edit-mode")&&a.get("remote-user")&&(b.Rte.getEditor()&&b.Rte.getEditor().initialized?d():b.bind("rte-collab-ready",d))});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:editor', location = '/js/editor.js' */
require(["internal/browser-metrics","jquery"],function(b,c){function a(){var h=AJS.Meta.get("content-type");var g=AJS.Meta.getBoolean("new-page")?"create":"edit";var f=c("body");var d=f.hasClass("edit")||f.hasClass("create");if(d&&h&&g){if(AJS.Meta.getBoolean("collaborative-content")){var e="confluence."+h+"."+g+".collaborative.view";b.start({key:e,isInitial:true});AJS.bind("rte-collab-ready",function(){b.end({key:e});b.start({key:e+".connected"})});AJS.bind("synchrony.connected",function(){b.end({key:e+".connected"})})}else{if(!AJS.Meta.getBoolean("collaborative-content")){b.start({key:"confluence."+h+"."+g+".view",ready:".active-richtext",isInitial:true})}}}}c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:space-page-picker-shim', location = 'js/space-page-picker-shim.js' */
define("confluence-inline-tasks/space-page-picker-shim",["confluence-ui-components/js/space-page-picker"],function(d){function e(a){var b={page:[],space:[]};if(!a)return b;a.split(",").forEach(function(a){a=a.split(":");b[a[0]].push(a[1])});return b}return{build:function(a){return d.build(a)},setValue:function(a,b){return d.setValue(a,b)},splitStringToMap:e,combineMapToString:function(a){var b=a.space;a=a.page;var c=[];b&&(c=c.concat(_.map(b.split(","),function(a){return"space:"+a})));a&&(c=c.concat(_.map(a.split(","),
function(a){return"page:"+a})));return c.join(",")},getValueAsMap:function(a){return e(a.val())}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser', location = 'js/macro-browser-overrides.js' */
define("confluence-inline-tasks/macro-browser-overrides",["jquery","ajs","confluence/templates","confluence-macro-browser/macro-browser","confluence-inline-tasks/space-page-picker-shim"],function(e,h,k,f,d){return{fields:{string:{spaceAndPage:function(a){var b=a.multiple?"autocomplete-multi-space-and-page":"autocomplete-space-and-page",g=e(k.MacroBrowser.macroParameter()),c=g.find("input[type\x3d'text']");c.addClass(b).attr("data-none-message","Not found");
a.required&&c.keyup(f.processRequiredParameters);c.auiSelect2(d.build({multiple:a.multiple,orgElement:c,inputSpaceId:"legacy-macro-param-spaces",inputSpaceCatId:"legacy-macro-param-space-cats",inputPageId:"legacy-macro-param-pages"}));return f.Field(g,c,{setValue:function(a){d.setValue(a,c)}})}}},beforeParamsSet:function(a){var b=d.combineMapToString({page:a.pages,space:a.spaces});b&&(a.spaceAndPage=b);delete a.pages;delete a.spaces;return a},beforeParamsRetrieved:function(a){var b=d.splitStringToMap(a.spaceAndPage);
b.page.length&&(a.pages=b.page.join(","));b.space.length&&(a.spaces=b.space.join(","));delete a.spaceAndPage;return a}}});require("confluence/module-exporter").safeRequire("confluence-inline-tasks/macro-browser-overrides",function(e){require("confluence-macro-browser/macro-browser").setMacroJsOverride("tasks-report-macro",e)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:confluence-inlineTasks-utils', location = '/js/util.js' */
define("confluence-inline-tasks/util",["jquery"],function(b){return{NODE_TYPE:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},KEY:{BACKSPACE:8,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INS:45,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91},addContentEditableIfApplicable:function(a){a=
b(a);var c=require("tinymce");a.attr({contenteditable:!1,"class":"non-editable",onselectstart:"return false;"});c.isIE&&a.attr({contenteditable:!0,unselectable:"on",oncontrolselect:"return false;"})}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/util","Confluence.InlineTasks.Util");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:datepicker1', location = '/js/date-picker1.js' */
define("confluence-inline-tasks/date-picker1",["jquery","ajs","confluence-editor/utils/tinymce-node-utils"],function(d,h){function f(t,b){var l;var c={};var v=A++;var a=d(t);a.attr("data-aui-dp-uuid",v);b=d.extend(void 0,f.prototype.defaultOptions,b);c.getField=function(){return a};c.getOptions=function(){return b};var C=function(){var e,p,m;c.hide=function(){k.hide()};c.show=function(){k.show()};c.setDate=function(a){"undefined"!==typeof e&&e.datepicker("setDate",a)};c.getDate=function(){if("undefined"!==
typeof e)return e.datepicker("getDate")};var t=function(B){m.off();if(b.hint){var g=d("\x3cdiv/\x3e").addClass("aui-datepicker-hint");g.append("\x3cspan/\x3e").text(b.hint);m.append(g)}e=d("\x3cdiv/\x3e");e.attr("data-aui-dp-popup-uuid",v);m.append(e);g={dateFormat:b.dateFormat,defaultDate:a.val(),maxDate:a.attr("max"),minDate:a.attr("min"),nextText:"\x3e",onSelect:function(d){a.val(d);a.change();c.hide();p=!0;a.focus();b.onSelect&&b.onSelect.call(this,d)},onChangeMonthYear:function(){setTimeout(k.refresh,
0)},prevText:"\x3c"};d.extend(g,B);-1<b.firstDay&&(g.firstDay=b.firstDay);"undefined"!==typeof a.attr("step")&&h.debug("WARNING: The date picker polyfill currently does not support the step attribute!");e.datepicker(g);d("body").on("keydown",q);a.on("focusout keydown",w);a.on("propertychange keyup input paste",x)};var q=function(b){var g=d(b.target),e=g.closest(m).length||g.is(a),f=g.closest(".ui-datepicker-header").length;!e&&!f||b.keyCode===h.keyCode.ESCAPE?c.hide():g[0]!==a[0]&&b.preventDefault()};
var w=function(){u||(d("body").on("focus blur click mousedown","*",q),u=!0)};var y=function(){p?p=!1:c.show()};var x=function(){d(this).val()&&(e.datepicker("setDate",a.val()),e.datepicker("option",{maxDate:a.attr("max"),minDate:a.attr("min")}))};c.destroyPolyfill=function(){c.hide();a.attr("placeholder",null);a.off("propertychange keyup input paste",x);a.off("focus click",y);a.off("focusout keydown",w);d("body").off("keydown",q);f.prototype.browserSupportsDateField&&(a[0].type="date");"undefined"!==
typeof e&&e.datepicker("destroy");delete c.destroyPolyfill;delete c.show;delete c.hide};var u=p=!1;b.languageCode in f.prototype.localisations||(b.languageCode="");var z=f.prototype.localisations,r="",n=9>h.versionDetails.major?240:255;"large"===z.size&&(n=325,r="aui-datepicker-dialog-large");n={hideCallback:function(){d("body").off("focus blur click mousedown","*",q);u=!1;l&&l._datePickerPopup&&delete l._datePickerPopup},hideDelay:null,noBind:!0,persistent:!0,closeOthers:!1,width:n};b.position&&
(n.calculatePositions=function(a,c){a=d(a[0]);return b.position.call(this,a,c)});var k=h.InlineDialog(a,void 0,function(a,b,c){"undefined"===typeof e&&(m=a,t(z));if(l=d(b).closest(".aui-inline-dialog").get(0))l._datePickerPopup=k;c()},n);k.addClass("aui-datepicker-dialog");k.addClass(r);a.on("focus click",y);a.attr("placeholder",b.dateFormat);b.overrideBrowserDefault&&f.prototype.browserSupportsDateField&&(a[0].type="text",r=a[0].getAttribute("value"))&&(a[0].value=r)};c.reset=function(){"function"===
typeof c.destroyPolyfill&&c.destroyPolyfill();f.prototype.browserSupportsDateField&&!b.overrideBrowserDefault||C()};c.reset();return c}var A=0;f.prototype.browserSupportsDateField=h.DatePicker.prototype.browserSupportsDateField;f.prototype.defaultOptions={overrideBrowserDefault:!1,firstDay:-1,languageCode:d("html").attr("lang")||"en-AU",dateFormat:d.datepicker.W3C};f.prototype.localisations=h.DatePicker.prototype.localisations;d.fn.inlineTasksDatePicker1=function(d){return new f(this,d)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:dateutil', location = '/js/dateutil.js' */
define("confluence-inline-tasks/dateutil","jquery ajs moment confluence/position confluence-inline-tasks/util confluence-inline-tasks/date-picker1".split(" "),function(k,l,p,n,q){var f={PATTERN_INSERTING:"DD-MM-YYYY",PATTERN_LOZENGE:"DD MMM YYYY",PATTERN_INSIDE_TIME_ELE:"YYYY-MM-DD",convertDateIntoHtml:function(a,b,d,e){e||(e=f.PATTERN_INSERTING);d||(d="");b||(b="\x3ctime\x3e");var c=k("\x3cdiv\x3e");e=a.format(e);0<=b.indexOf("time")?(a=k(b,{datetime:a.format(f.PATTERN_INSIDE_TIME_ELE)}),q.addContentEditableIfApplicable(a)):
a=k(b);d&&a.attr("class",d);a.text(e);c.append(a);return c.html()},insertDateIntoCurrentCursor:function(a,b,d,e,c){var g=require("tinymce"),h=require("confluence-editor/utils/tinymce-node-utils");g=g.activeEditor;a=f.convertDateIntoHtml(a,b,d,e);a=k(a,g.getDoc())[0];h=h.replaceSelection(a);c&&g.execCommand("mceInsertContent",!1,c,{skip_undo:!0});c={context:k(g.selection.getRng(!0).startContainer).closest("li[data-inline-task-id]").length?"task":"page",trigger:"character"};l.trigger("analyticsEvent",
{name:"confluence-spaces.date.added",data:c});return h},parse:function(a,b){b||(b=f.PATTERN_INSIDE_TIME_ELE);a=p(k.trim(a),b,!0);return a.isValid()?a:null},format:function(a,b){b||(b=f.PATTERN_INSIDE_TIME_ELE);return a?a.format(b):null},guessPartialDate:function(a,b){if(null==a)return null;a=k.trim(a.replace(/[-\.\/]/g,"-"));a=a.split("-");for(var d=p().format(b).split("-"),e=0;3>e;e++)a[e]||(a[e]=d[e]),/^\d$/.test(a[e])&&(a[e]="0"+a[e]);return f.parse(a.join("-"),b)},datepicker:{POSITION_ABOVE:!0,
POSITION_BELOW:!1,POSITION_RIGHT:!0,POSITION_LEFT:!1,dropDownStillFitsVertically:function(a,b,d){return a===this.POSITION_ABOVE?b.above>=d:b.below>=d},dropDownStillFitsHorizontally:function(a,b,d){return a===this.POSITION_RIGHT?b.right>=d:b.left>=d},getPreferredHorizontalPosition:function(a,b){return a.right>=b?this.POSITION_RIGHT:a.left>=b?this.POSITION_LEFT:a.right>a.left?this.POSITION_RIGHT:this.POSITION_LEFT},getPreferredVerticalPosition:function(a,b){return a.below>=b?this.POSITION_BELOW:a.above>=
b?this.POSITION_ABOVE:a.below>a.above?this.POSITION_BELOW:this.POSITION_ABOVE},calculateDatepickerPosition:function(a){var b=this;return function(d,e){var c=require("confluence-editor/editor/atlassian-editor");e=require("confluence-editor/editor/atlassian-editor-content");c=c.Rte.getEditorFrame();void 0===n.spaceLeftRight&&(n.spaceLeftRight=function(a,b){b=b.position().left;return{left:b,right:k(a).width()-b}});var g=n.spaceAboveBelow(c,a);var h=n.spaceLeftRight(c,a);var f=e.offset(a);e=d.outerHeight(!0);
d=d.outerWidth(!0);var r=e+16;var l=d+0;c=b.POSITION_BELOW;var m=b.POSITION_RIGHT;c&&(b.dropDownStillFitsVertically(c,g,r)||(c=null));c||(c=b.getPreferredVerticalPosition(g,r));m&&(b.dropDownStillFitsHorizontally(m,h,r)||(m=null));m=b.getPreferredHorizontalPosition(h,l);g=c===b.POSITION_ABOVE?f.top-e-16:f.top+a.height()+16;h=m===b.POSITION_RIGHT?f.left-0:f.left+a.outerWidth()-d;g={top:g,left:h};m=m===b.POSITION_RIGHT?a.outerWidth()/2:d-a.outerWidth()/2;if(0>m||m>d)m=d/10;return{displayAbove:c,popupCss:g,
arrowCss:{left:m,top:c===b.POSITION_ABOVE?e:-8}}}},getHintTextOfDatePicker:function(a){return a?"Select a due date for this task.":"Select a date."},create:function(a){var b=a.$attachTo,d=a.$positionTo,e=a.startDate,c=a.onSelect;a=a.isSetDueDate;var g=k("\x3cinput\x3e").attr("type","date").addClass("aui-date-picker").css("display","none"),h=g.inlineTasksDatePicker1({overrideBrowserDefault:!0,dateFormat:"yy-mm-dd",languageCode:l.Meta.get("user-locale")&&
l.Meta.get("user-locale").split("_")[0],position:this.calculateDatepickerPosition(d),onSelect:function(a){c(f.parse(a));n()},hint:this.getHintTextOfDatePicker(a)}),n=function(){h&&h.destroyPolyfill&&h.destroyPolyfill();g&&g.remove();k(".aui-datepicker-dialog").remove();g=h=null};h.show();h.setDate(f.format(e));k(".aui-datepicker-dialog .aui-datepicker-hint").addClass(a?"set-duedate":"set-date");b.before(g);return{die:function(){n()},show:function(){h.show()},hide:function(){h.hide()},getContainer:function(){return g},
setDate:function(a){var b=f.guessPartialDate(a,f.PATTERN_INSERTING);l.debug("Set date: "+a);b&&h.setDate(f.format(b))},placeDatePicker:function(){var a=l.InlineDialog.current;(a=a&&a.popup)&&a.refresh()}}}}};return f});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/dateutil","Confluence.InlineTasks.DateUtil",function(k){var l=require("ajs"),p=require("underscore"),n=require("confluence/meta"),q=require("moment");l.toInit(function(){var f=function(a,b,c){return b&&"en_us"===b.toLowerCase()?"MM"+c+"DD"+c+"YYYY":p.uniq(a.replace(/[^MDY]/g,"").split("")).join(c).replace("D","DD").replace("M","MM").replace("Y","YYYY")},a=n.get("user-locale");a&&q.lang(a.split("_")[0].toLowerCase());
var b=n.get("user-date-pattern");b&&(k.PATTERN_LOZENGE=b.toUpperCase(),k.PATTERN_INSERTING=f(b.toUpperCase(),a,"-"),k.PATTERN_INSERTING_ALTERNATE=f(b.toUpperCase(),a,"/"))})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/de.js' */
(function(c){"function"===typeof define&&define.amd?define(["moment"],c):"object"===typeof exports?module.exports=c(require("../moment")):c(window.moment)})(function(c){function a(b,a,c,d){b={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[b+" Tage",b+" Tagen"],M:["ein Monat","einem Monat"],MM:[b+" Monate",b+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[b+" Jahre",b+" Jahren"]};return a?b[c][0]:b[c][1]}return c.lang("de",{months:"Januar Februar März April Mai Juni Juli August September Oktober November Dezember".split(" "),
monthsShort:"Jan. Febr. Mrz. Apr. Mai Jun. Jul. Aug. Sept. Okt. Nov. Dez.".split(" "),weekdays:"Sonntag Montag Dienstag Mittwoch Donnerstag Freitag Samstag".split(" "),weekdaysShort:"So. Mo. Di. Mi. Do. Fr. Sa.".split(" "),weekdaysMin:"So Mo Di Mi Do Fr Sa".split(" "),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",
lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:a,mm:"%d Minuten",h:a,hh:"%d Stunden",d:a,dd:a,M:a,MM:a,y:a,yy:a},ordinal:"%d.",week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/es.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){var b="ene. feb. mar. abr. may. jun. jul. ago. sep. oct. nov. dic.".split(" "),c="ene feb mar abr may jun jul ago sep oct nov dic".split(" ");return a.lang("es",{months:"enero febrero marzo abril mayo junio julio agosto septiembre octubre noviembre diciembre".split(" "),monthsShort:function(a,d){return/-MMM-/.test(d)?c[a.month()]:
b[a.month()]},weekdays:"domingo lunes martes miércoles jueves viernes sábado".split(" "),weekdaysShort:"dom. lun. mar. mié. jue. vie. sáb.".split(" "),weekdaysMin:"Do Lu Ma Mi Ju Vi Sá".split(" "),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+
(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:"%dº",week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/fr.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("fr",{months:"janvier février mars avril mai juin juillet août septembre octobre novembre décembre".split(" "),monthsShort:"janv. févr. mars avr. mai juin juil. août sept. oct. nov. déc.".split(" "),weekdays:"dimanche lundi mardi mercredi jeudi vendredi samedi".split(" "),weekdaysShort:"dim. lun. mar. mer. jeu. ven. sam.".split(" "),
weekdaysMin:"Di Lu Ma Me Je Ve Sa".split(" "),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},
ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/ja.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("ja",{months:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),monthsShort:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),weekdays:"日曜日 月曜日 火曜日 水曜日 木曜日 金曜日 土曜日".split(" "),weekdaysShort:"日月火水木金土".split(""),weekdaysMin:"日月火水木金土".split(""),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日LT",
LLLL:"YYYY年M月D日LT dddd"},meridiem:function(a,b,c){return 12>a?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/en-gb.js' */
(function(a){"function"===typeof define&&define.amd?define(["moment"],a):"object"===typeof exports?module.exports=a(require("../moment")):a(window.moment)})(function(a){return a.lang("en-gb",{months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},
ordinal:function(a){var b=a%10;return a+(1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")},week:{dow:1,doy:4}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete-help-dialog.js' */
AJS.toInit(function(){Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat&&Confluence.KeyboardShortcuts.Autoformat.push({action:"//",context:"autoformat.autocomplete",description:"Date"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/autocomplete-manager.js' */
(function(h){var b=window.Confluence||{};b.Editor=b.Editor||{};b.Editor.AutoComplete=b.Editor.AutoComplete||{};var c=b.InlineTasks.Util.KEY,l=b.InlineTasks.DateUtil,e=b.Editor.AutoComplete;e.SETTING_DEFAULT={leadingChar:"",isDataValid:function(a){return!1},backWords:0,onBeforeDie:function(){},onAfterStart:function(){},onScroll:function(){}};e.Manager=function(a){this.ed=AJS.Rte.getEditor();this.settings=h.extend({},e.SETTING_DEFAULT,a);this.log=AJS.debug;this.control=null};e.Manager.prototype={start:function(a){AJS.trigger("synchrony.stop",
{id:"confluence.date-autocomplete-manager.plugin"});this.log("startAutoComplete - Started");var c=h.extend({},this.settings,a);this.control=b.Editor.Autocompleter.Control(this.ed,c);if(!this.control)return!1;this.attachEventsToControl();c.onAfterStart&&c.onAfterStart({date:a.date,isTriggerFromOrphan:a.isTriggerFromOrphan?!0:!1});return!0},attachEventsToControl:function(){var a=this,b=a.control,e=a.log,m=a.settings;if("function"===typeof this.settings.onBeforeDie){var g=this.control.die,k=!1;this.control.die=
function(){k||(k=!0,a.settings.onBeforeDie.apply(a.control,arguments),a.dateInserted()?(g.apply(a.control,[!0]),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.killed"})):g.apply(a.control,arguments))}}var n=_.bind(_.throttle(a.settings.onScroll,40),this);h.extend(b,{onBeforeKey:function(d,b){d.keyCode!==c.ESCAPE&&d.keyCode!==c.ENTER&&a.control&&a.control.getContainer().addClass("isDirty");return d.keyCode===c.DOWN||d.keyCode===c.UP||d.keyCode===c.ENTER?(tinymce.dom.Event.cancel(d),
!1):d.keyCode===c.ESCAPE||d.keyCode===c.TAB||d.keyCode===c.BACKSPACE&&!b?(e("autoCompleteControl.onBeforeKey - killing autoCompleteControl"),this.die(d.keyCode===c.BACKSPACE),!1):!0},onKeyPress:function(a,f){f=AJS.$.browser.msie?a.keyCode:a.which;if(a.keyCode===c.ENTER)return tinymce.dom.Event.cancel(a),!1;a=String.fromCharCode(f);this.settings.endChars.includes(a)&&(e("autoCompleteControl.onKeyPress - caught autocomplete-closing char - character"),b.die());return!0},onAfterKey:function(d,f){var g=
h("#autocomplete-trigger",a.control.getContainer()),k=g.text();return 0<g.length&&k!==a.settings.leadingChar?(e("after","dying because of: trigger text is modified"),a.reset(),!1):d.keyCode===c.ENTER?(m.isDataValid(f)?b.update(f):(e("autoCompleteControl.onAfterKey - closing autocomplete due to invalid data - "+f),b.die(!1)),!1):a.dateInserted()&&10<f.length&&!l.parse(f,[l.PATTERN_INSERTING,l.PATTERN_INSERTING_ALTERNATE])||d.keyCode===c.SPACE?(a.reset(),!1):!0},onDeath:function(){a.reset()},onScroll:function(){a.isAlive()&&
n()}})},isAlive:function(){return this.control&&!this.control.dying},reset:function(){this.control&&(this.control.die(),this.control=null,AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete-manager.plugin"}))},dateInserted:function(a){return!0===a?this.control.getContainer().addClass("hasDateInserted"):!1===a?this.control.getContainer().removeClass("hasDateInserted"):this.control.getContainer().hasClass("hasDateInserted")},dirty:function(a){return!0===a?this.control.getContainer().addClass("isDirty"):
this.control.getContainer().hasClass("isDirty")},reattach:function(){var a=b.Editor.Autocompleter.Control.removeOrphanedControl();return a&&a.leadingChar===this.settings.leadingChar?(this.reset(),this.start({backWords:1,isTriggerFromOrphan:!0})):!1}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete.js' */
(function(e,k){var n=Confluence.InlineTasks.Util,m=n.NODE_TYPE,h=n.KEY,g=Confluence.InlineTasks.DateUtil,l=null,d=null,p=!1,q=k.dom.TreeWalker,f={initDateAutoCompleteObject:function(a){Confluence.Editor.Autocompleter||(Confluence.Editor.Autocompleter=k.confluence.Autocompleter);Confluence.Editor.Autocompleter.Settings["//"]={ch:"//",endChars:[],update:function(b,c){d.picker.die();(b=c==g.PATTERN_INSERTING.toLowerCase()?moment():g.guessPartialDate(c,g.PATTERN_INSERTING))&&g.insertDateIntoCurrentCursor(b,
"\x3ctime\x3e","",g.PATTERN_LOZENGE,"\x26nbsp;");d.dateInserted()&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.used"});d.reset();a.undoManager.add();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})}};d=new Confluence.Editor.AutoComplete.Manager({leadingChar:"//",isDataValid:function(b){return!d.dirty()||null!=g.guessPartialDate(b,g.PATTERN_INSERTING)},onBeforeDie:function(){d.picker&&d.picker.die();if(d.control){var b=e(d.control.getContainer());
d.dirty()||b.find("#autocomplete-search-text").remove()}},onAfterStart:function(b){b&&b.date?(f.fillPlaceholderDateAutoComplete(a,b.date,!0),d.dirty(!0),d.dateInserted(!0)):b&&!b.isTriggerFromOrphan&&(f.fillPlaceholderDateAutoComplete(a,g.PATTERN_INSERTING.toLowerCase(),!1),d.dateInserted(!1));b=d.control.text();b=g.guessPartialDate(b,g.PATTERN_INSERTING)||moment();f.bindDatePickerToAutoComplete(b)},onScroll:function(){d.picker&&d.picker.placeDatePicker()}})},activateDateAutocomplete:function(a,b,
c){a=Object.assign({},c,b);a.hasOwnProperty("insertedFromMenu")||(a.insertedFromMenu=!1);if(!d.isAlive()&&!d.start(a)&&!a.insertedFromMenu)return l.execCommand("mceInsertContent",!1,"//",{skip_undo:!0}),!1},bindDatePickerToAutoComplete:function(a){var b=d.control&&d.control.getContainer();if(b.length){b.addClass("date-autocomplete");b.find("#autocomplete-search-text span").addClass("inserting");var c=f.isInsideTaskAndFirstTimeNode(b);d.picker=g.datepicker.create({$attachTo:b,$positionTo:b,startDate:a,
onSelect:function(b){d.control.update(b.format(g.PATTERN_INSERTING))},isSetDueDate:c})}},fillPlaceholderDateAutoComplete:function(a,b,c){var f=d.control.getContainer().find("#autocomplete-search-text span");f.text(AJS.Rte.HIDDEN_CHAR+b);var e=a.dom.createRng();e.setStart(f[0].firstChild,1);e.setEnd(f[0].firstChild,b.length+1);c&&e.collapse(!1);a.selection.setRng(e)},autocompleteDoubleSlash:function(a,b){a=b.handlerManager;var c=b.ed;b=b.createHandler;b=b(/(?:\s|\xA0|^|\ufeff|\u200b)(\/)$/,function(){c.execCommand("mceConfInsertDateAutocomplete",
!1,{},{skip_undo:!0})},!0,"#autocomplete");a.registerHandler(47,b)},registerTriggerDoubleSlash:function(a){a.addCommand("mceConfInsertDateAutocomplete",f.activateDateAutocomplete);a.addCommand("confMenuInsertDate",function(){AJS.trigger("analytics",{name:"editor.insert-data-from-menu"});l.execCommand("mceConfInsertDateAutocomplete",!1,{insertedFromMenu:!0},{skip_undo:!0})}.bind(this));AJS.bind("confluence.editor.registerHandlers",this.autocompleteDoubleSlash)},isTimeNode:function(a){return a&&a.nodeType===
m.ELEMENT_NODE&&"time"===a.tagName.toLowerCase()},getTimeNodeAtCursor:function(a){a||(a=l);var b=a.selection.getNode();if(f.isTimeNode(b))return b;b=a.selection.getStart();if(f.isTimeNode(b))return b;b=a.selection.getEnd();if(f.isTimeNode(b))return b},makeTimeNodesUnEditable:function(a){a.each(function(){var b=e(this);""===e.trim(b.text())&&b.remove();k.isWebKit&&b.remove("br.Apple-interchange-newline");n.addContentEditableIfApplicable(this)})},wrapTimeNodesWithHiddenChar:function(a){a.each(function(){var b=
e(this);this.previousSibling&&this.previousSibling.nodeType===m.TEXT_NODE&&""!==this.previousSibling.nodeValue||b.before(AJS.Rte.HIDDEN_CHAR);this.nextSibling&&this.nextSibling.nodeType===m.TEXT_NODE&&""!==this.previousSibling.nodeValue||b.after(AJS.Rte.HIDDEN_CHAR)})},putCursorAtEdge:function(a,b,c){(c=!!c)?b.nextSibling&&b.nextSibling.nodeType===m.TEXT_NODE||e(b).after(a.dom.doc.createTextNode("")):b.previousSibling&&b.previousSibling.nodeType===m.TEXT_NODE||e(b).before(a.dom.doc.createTextNode(""));
var d=a.selection.dom.createRng();d.selectNode(c?b.nextSibling:b.previousSibling);d.collapse(c);a.selection.setRng(d)},findFirstTimeNodeInClosestBlock:function(a,b,c){var d=new q(b,a.getBody()),e=b,g=0;do{if(1==g&&f.isTimeNode(b))return b;var h=c?b.previousSibling:b.nextSibling;b!==e&&h&&(a.dom.isBlock(b)||a.dom.isBlock(h))&&g++}while((b=c?d.next():d.prev())&&2>g)},findFirstTimeNodeNearby:function(a,b,c){var d=b,e=new q(b,a.getBody());do{if(f.isTimeNode(b))return b;if(a.dom.isBlock(b)||b!==d&&b.nodeType===
m.TEXT_NODE&&""!==b.nodeValue)break}while(b=c?e.next():e.prev())},convertInvalidTimeNodeToPlainText:function(a){a.each(function(){var b=e(this),a=b.attr("datetime");g.parse(a)||(b.before(b.text()),b.remove())})},isInsideTaskAndFirstTimeNode:function(a){a=e(a);var b=a.closest("ul.inline-task-list \x3e li[data-inline-task-id]");return b.length?b.find("time, span.date-autocomplete")[0]===a[0]:!1}},w=function(a){a=a.keyCode;if(a===h.BACKSPACE||a===h.DELETE){a=a===h.DELETE;var b=l.selection.getRng(!0),
c=b.startContainer,d=c;if(c.nodeType!=m.TEXT_NODE||(a?b.startOffset==c.nodeValue.length:0==b.startOffset))c.nodeType===m.ELEMENT_NODE&&(d=a?c.childNodes.length===b.startOffset?c:c.childNodes.item(b.startOffset):0===b.startOffset?c:c.childNodes.item(b.startOffset-1)),(a=f.findFirstTimeNodeNearby(l,d,a))&&l.dom.remove(a)}},x=function(a){var b=e(a.target);if(b.is("time")){AJS.trigger("synchrony.stop",{id:"confluence.date-autocomplete.plugin"});var c=b.closest("li[data-inline-task-id]").length?"task":
"page";AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:{mode:"editor",context:c}});var d=b.closest("body"),h=function(){AJS.Rte.unbindScroll("date-lozenge-date-picker");k.die();AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})};d.one("keydown click",h);a=g.parse(b.attr("datetime"));var l=f.isInsideTaskAndFirstTimeNode(b),k=g.datepicker.create({$attachTo:b,$positionTo:b,startDate:a,onSelect:function(a){var e=a.format(g.PATTERN_INSIDE_TIME_ELE);a=a.format(g.PATTERN_LOZENGE);
e!==b.attr("datetime")&&AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.changed",data:{context:c}});b.attr("datetime",e);b.text(a);d.unbind("keydown click",h);AJS.trigger("synchrony.start",{id:"confluence.date-autocomplete.plugin"})},isSetDueDate:l});a=_.bind(_.throttle(function(){k&&AJS.Rte.isAnyPartShown(b)?k.placeDatePicker():h()},40),this);AJS.Rte.bindScroll("date-lozenge-date-picker",a)}},y=function(a){var b=a.keyCode;b===h.UP||b===h.DOWN||b===h.LEFT||b===h.RIGHT||b===h.HOME||b===
h.END||b===h.PAGEDOWN||b===h.PAGEUP||a.metaKey||a.ctrlKey||a.altKey||!d.control||!d.picker||(a=d.control.text(),d.picker.setDate(a))},z=function(){var a=e(l.dom.doc).find("time");f.makeTimeNodesUnEditable(a);f.wrapTimeNodesWithHiddenChar(a)},r=function(a,b,c){f.convertInvalidTimeNodeToPlainText(e(c.node).find("time"))},t=function(a,b,c){a=e(c.node).find("time");f.makeTimeNodesUnEditable(a)},u=function(a,b,c){if(f.getTimeNodeAtCursor(l))return c.content="",!1},A=function(a){var b=a.keyCode;if(b===
h.UP||b===h.DOWN){a=l.selection.getRng(!0);var c=a.startContainer,d=c;b=b===h.DOWN;c.nodeType===m.ELEMENT_NODE&&(d=b?c.childNodes.length===a.startOffset?c:c.childNodes.item(a.startOffset):0===a.startOffset?c:c.childNodes.item(a.startOffset-1));(a=f.findFirstTimeNodeInClosestBlock(l,d,b))&&f.wrapTimeNodesWithHiddenChar(e(a))}},B=function(a){a=a.element.nodeType===m.TEXT_NODE?a.element.parentNode:a.element;f.isTimeNode(a)&&(p||1<l.selection.getRng().startOffset?f.putCursorAtEdge(l,a,!0):f.putCursorAtEdge(l,
a,!1))},v=function(){d&&d.reattach()},C={init:function(a){f.initDateAutoCompleteObject(a);f.registerTriggerDoubleSlash(a);l=a;a.on("contextmenu",function(){d.reset()});a.on("SetContent",z);a.on("click",x);a.on("keyup",y);k.isWebKit&&(a.on("keydown",A),a.on("init",function(){e(document).bind("postPaste",t)}),a.on("remove",function(){e(document).unbind("postPaste",t)}));a.on("keyup",function(b){p=b.keyCode===h.RIGHT;var c=a.selection.getRng(!0),d=c.commonAncestorContainer,e=!!d&&d.data;e&&!AJS.$(d).closest("pre,.text-placeholder").length&&
(String.prototype.slice.apply(e,[-11]),48<=b.keyCode&&57>=b.keyCode||96<=b.keyCode&&105>=b.keyCode)&&(b=String.prototype.slice.apply(e,[-10]),/(^| )\d{2}[\/\-]\d{2}[\/\-]\d{4}$/.test(e)&&g.parse(b,[g.PATTERN_INSERTING,g.PATTERN_INSERTING_ALTERNATE])&&(c.setStart(c.commonAncestorContainer,c.endOffset-b.length),a.undoManager.add(),a.undoManager.beforeChange(),a.selection.setRng(c),a.execCommand("mceConfInsertDateAutocomplete",!1,{date:b},{skip_undo:!0}),AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.triggered"})))});
k.isGecko&&(a.on("keydown",w),a.on("init",function(){e(document).bind("prePaste",u)}),a.on("remove",function(){e(document).unbind("prePaste",u)}));if(k.isWebKit||k.isGecko)a.on("NodeChange",B);a.on("Undo",v);a.on("Redo",v);a.on("init",function(){e(document).bind("postPaste",r)});a.on("remove",function(){e(document).unbind("postPaste",r);AJS.unbind("confluence.editor.registerHandlers",f.autocompleteDoubleSlash)});AJS.bind("editor.remote.change",function(){f.makeTimeNodesUnEditable(e(a.dom.doc).find("time"))})},
getInfo:function(){return{longname:"Insert Date Autocomplete",author:"Atlassian",authorurl:"http://www.atlassian.com",version:k.majorVersion+"."+k.minorVersion}}};(function(){k.create("tinymce.plugins.DateAutocomplete",C);k.PluginManager.add("dateautocomplete",k.plugins.DateAutocomplete);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(a){a.plugins+=",dateautocomplete"})})()})(AJS.$,tinymce);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reconcile-unknown-attachments:property-panel-unknown-image-placeholder', location = 'js/unknown-image-placeholder-property-panel.js' */
define("confluence-editor/unknown-attachment/property-panel",["wrm/context-path","ajs"],function(d,a){a&&a.Rte&&a.Rte.BootstrapManager?a.Rte.BootstrapManager.addOnInitCallback(function(){const c=a.Rte.getEditor();c?c.onClick.add(function(a,b){b=b.target;"IMG"===b.nodeName&&b.hasAttribute("src")&&0<=b.getAttribute("src").indexOf(d()+"/plugins/servlet/confluence/placeholder/unknown-attachment")&&a.execCommand("mceConfimage")}):a.log("Could not get Editor from adapter")}):a.log("Could not initialize property panel onclick handler on Confluence.Editor")});
require("confluence-editor/unknown-attachment/property-panel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'lib/rivets.js' */
'use strict';(function(){var q=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){return function(){return a.apply(b,arguments)}},y=[].slice,A={}.hasOwnProperty,z=function(a,b){function c(){this.constructor=a}for(var d in b)A.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};var f={binders:{},components:{},formatters:{},adapters:{},config:{prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",
preloadData:!0,handler:function(a,b,c){return this.call(a,b,c.view.models)}}};if("jQuery"in window){var t="on"in jQuery.prototype?["on","off"]:["bind","unbind"];var B=t[0];var C=t[1];f.Util={bindEvent:function(a,b,c){return jQuery(a)[B](b,c)},unbindEvent:function(a,b,c){return jQuery(a)[C](b,c)},getInputValue:function(a){a=jQuery(a);return"checkbox"===a.attr("type")?a.is(":checked"):a.val()}}}else f.Util={bindEvent:function(){return"addEventListener"in window?function(a,b,c){return a.addEventListener(b,
c,!1)}:function(a,b,c){return a.attachEvent("on"+b,c)}}(),unbindEvent:function(){return"removeEventListener"in window?function(a,b,c){return a.removeEventListener(b,c,!1)}:function(a,b,c){return a.detachEvent("on"+b,c)}}(),getInputValue:function(a){var b;if("checkbox"===a.type)return a.checked;if("select-multiple"===a.type){var c=[];var d=0;for(b=a.length;d<b;d++){var e=a[d];e.selected&&c.push(e.value)}return c}return a.value}};f.KeypathParser=function(){function a(){}a.parse=function(b,a,d){var c,
g;var m=[];d={"interface":d,path:""};var f=c=0;for(g=b.length;c<g;f=c+=1)f=b.charAt(f),0<=q.call(a,f)?(m.push(d),d={"interface":f,path:""}):d.path+=f;m.push(d);return m};return a}();f.TextTemplateParser=function(){function a(){}a.types={text:0,binding:1};a.parse=function(b,a){var c;var e=[];var g=b.length;for(c=0;c<g;){var m=b.indexOf(a[0],c);if(0>m){e.push({type:this.types.text,value:b.slice(c)});break}else{0<m&&c<m&&e.push({type:this.types.text,value:b.slice(c,m)});c=m+a[0].length;m=b.indexOf(a[1],
c);if(0>m){a=b.slice(c-a[1].length);b=e[e.length-1];(null!=b?b.type:void 0)===this.types.text?b.value+=a:e.push({type:this.types.text,value:a});break}c=b.slice(c,m).trim();e.push({type:this.types.binding,value:c});c=m+a[1].length}}return e};return a}();f.Observer=function(){function a(b,a,d,e){this.view=b;this.model=a;this.keypath=d;this.callback=e;this.unobserve=h(this.unobserve,this);this.realize=h(this.realize,this);this.value=h(this.value,this);this.publish=h(this.publish,this);this.read=h(this.read,
this);this.set=h(this.set,this);this.adapter=h(this.adapter,this);this.update=h(this.update,this);this.initialize=h(this.initialize,this);this.parse=h(this.parse,this);this.parse();this.initialize()}a.prototype.parse=function(){var b,a;var d=this.view.adapters;var e=[];for(g in d)(b=d[g])&&e.push(g);if(a=this.keypath[0],0<=q.call(e,a)){b=this.keypath[0];var g=this.keypath.substr(1)}else b=this.view.config.rootInterface,g=this.keypath;this.tokens=f.KeypathParser.parse(g,e,b);return this.key=this.tokens.pop()};
a.prototype.initialize=function(){this.objectPath=[];this.target=this.realize();if(null!=this.target)return this.set(!0,this.key,this.target,this.callback)};a.prototype.update=function(){var b;if((b=this.realize())!==this.target){null!=this.target&&this.set(!1,this.key,this.target,this.callback);null!=b&&this.set(!0,this.key,b,this.callback);var a=this.value();this.target=b;if(this.value()!==a)return this.callback()}};a.prototype.adapter=function(b){return this.view.adapters[b["interface"]]};a.prototype.set=
function(b,a,d,e){b=b?"subscribe":"unsubscribe";return this.adapter(a)[b](d,a.path,e)};a.prototype.read=function(b,a){return this.adapter(b).read(a,b.path)};a.prototype.publish=function(b){if(null!=this.target)return this.adapter(this.key).publish(this.target,this.key.path,b)};a.prototype.value=function(){if(null!=this.target)return this.read(this.key,this.target)};a.prototype.realize=function(){var b,a,d;var e=this.model;var g=null;var m=this.tokens;var f=a=0;for(d=m.length;a<d;f=++a){var k=m[f];
null!=e?(null!=this.objectPath[f]?e!==(b=this.objectPath[f])&&(this.set(!1,k,b,this.update),this.set(!0,k,e,this.update),this.objectPath[f]=e):(this.set(!0,k,e,this.update),this.objectPath[f]=e),e=this.read(k,e)):(null==g&&(g=f),(b=this.objectPath[f])&&this.set(!1,k,b,this.update))}null!=g&&this.objectPath.splice(g);return e};a.prototype.unobserve=function(){var b,a,d;var e=this.tokens;var g=a=0;for(d=e.length;a<d;g=++a){var m=e[g];(b=this.objectPath[g])&&this.set(!1,m,b,this.update)}if(null!=this.target)return this.set(!1,
this.key,this.target,this.callback)};return a}();f.View=function(){function a(b,a,d){var c,g,m;this.els=b;this.models=a;this.options=null!=d?d:{};this.update=h(this.update,this);this.publish=h(this.publish,this);this.sync=h(this.sync,this);this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.select=h(this.select,this);this.build=h(this.build,this);this.componentRegExp=h(this.componentRegExp,this);this.bindingRegExp=h(this.bindingRegExp,this);this.els.jquery||this.els instanceof Array||
(this.els=[this.els]);var l=["config","binders","formatters","adapters"];d=0;for(m=l.length;d<m;d++){b=l[d];this[b]={};if(this.options[b]){var k=this.options[b];for(c in k)a=k[c],this[b][c]=a}k=f[b];for(c in k)a=k[c],null==(g=this[b])[c]&&(g[c]=a)}this.build()}a.prototype.bindingRegExp=function(){return new RegExp("^"+this.config.prefix+"-")};a.prototype.componentRegExp=function(){return new RegExp("^"+this.config.prefix.toUpperCase()+"-")};a.prototype.build=function(){var b;this.bindings=[];var a=
[];var d=this.bindingRegExp();var e=this.componentRegExp();var g=function(b){return function(a,c,d,e){var g,m;var l={};var k=function(){var b;var a=e.split("|");var c=[];var d=0;for(b=a.length;d<b;d++)m=a[d],c.push(m.trim());return c}();var h=function(){var b;var a=k.shift().split("\x3c");var c=[];var d=0;for(b=a.length;d<b;d++)g=a[d],c.push(g.trim());return c}();var p=h.shift();l.formatters=k;if(h=h.shift())l.dependencies=h.split(/\s+/);return b.bindings.push(new f[a](b,c,d,p,l))}}(this);var m=function(b){return function(c){var l,
h,k,p;if(0>q.call(a,c)){if(3===c.nodeType){var n=f.TextTemplateParser;if((k=b.config.templateDelimiters)&&(l=n.parse(c.data,k)).length&&(1!==l.length||l[0].type!==n.types.text)){var r=0;for(p=l.length;r<p;r++)k=l[r],n=document.createTextNode(k.value),c.parentNode.insertBefore(n,c),1===k.type&&g("TextBinding",n,null,k.value);c.parentNode.removeChild(c)}}else if(e.test(c.tagName)){var u=c.tagName.replace(e,"").toLowerCase();b.bindings.push(new f.ComponentBinding(b,c,u))}else if(null!=c.attributes){p=
c.attributes;k=0;for(r=p.length;k<r;k++)if(l=p[k],d.test(l.name)){u=l.name.replace(d,"");if(!(h=b.binders[u])){var v=b.binders;for(n in v){var t=v[n];if("*"!==n&&-1!==n.indexOf("*")){var x=new RegExp("^"+n.replace("*",".+")+"$");x.test(u)&&(h=t)}}}h||(h=b.binders["*"]);if(h.block){x=c.childNodes;var w=0;for(h=x.length;w<h;w++)u=x[w],a.push(u);w=[l]}}r=w||c.attributes;n=0;for(k=r.length;n<k;n++)l=r[n],d.test(l.name)&&(u=l.name.replace(d,""),g("Binding",c,u,l.value))}k=c.childNodes;c=[];n=0;for(l=k.length;n<
l;n++)u=k[n],c.push(u);r=[];k=0;for(n=c.length;k<n;k++)l=c[k],r.push(m(l));return r}}}(this);var l=this.els;var k=0;for(b=l.length;k<b;k++){var h=l[k];m(h)}};a.prototype.select=function(b){var a;var d=this.bindings;var e=[];var g=0;for(a=d.length;g<a;g++){var m=d[g];b(m)&&e.push(m)}return e};a.prototype.bind=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.bind())}return d};a.prototype.unbind=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=
a.length;e<b;e++){var g=a[e];d.push(g.unbind())}return d};a.prototype.sync=function(){var b;var a=this.bindings;var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.sync())}return d};a.prototype.publish=function(){var b;var a=this.select(function(b){return b.binder.publishes});var d=[];var e=0;for(b=a.length;e<b;e++){var g=a[e];d.push(g.publish())}return d};a.prototype.update=function(b){var a;null==b&&(b={});for(m in b){var d=b[m];this.models[m]=d}var e=this.bindings;var g=[];d=0;for(a=e.length;d<
a;d++){var m=e[d];g.push(m.update(b))}return g};return a}();f.Binding=function(){function a(b,a,d,e,g){this.view=b;this.el=a;this.type=d;this.keypath=e;this.options=null!=g?g:{};this.update=h(this.update,this);this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.publish=h(this.publish,this);this.sync=h(this.sync,this);this.set=h(this.set,this);this.eventHandler=h(this.eventHandler,this);this.formattedValue=h(this.formattedValue,this);this.setBinder=h(this.setBinder,this);this.formatters=
this.options.formatters||[];this.dependencies=[];this.model=void 0;this.setBinder()}a.prototype.setBinder=function(){var b;if(!(this.binder=this.view.binders[this.type])){var a=this.view.binders;for(b in a){var d=a[b];if("*"!==b&&-1!==b.indexOf("*")){var e=new RegExp("^"+b.replace("*",".+")+"$");e.test(this.type)&&(this.binder=d,this.args=(new RegExp("^"+b.replace("*","(.+)")+"$")).exec(this.type),this.args.shift())}}}this.binder||(this.binder=this.view.binders["*"]);if(this.binder instanceof Function)return this.binder=
{routine:this.binder}};a.prototype.formattedValue=function(b){var a;var d=this.formatters;var e=0;for(a=d.length;e<a;e++){var g=d[e];var m=g.split(/\s+/);g=m.shift();g=this.view.formatters[g];(null!=g?g.read:void 0)instanceof Function?b=g.read.apply(g,[b].concat(y.call(m))):g instanceof Function&&(b=g.apply(null,[b].concat(y.call(m))))}return b};a.prototype.eventHandler=function(b){var a;var d=(a=this).view.config.handler;return function(c){return d.call(b,this,c,a)}};a.prototype.set=function(b){var a;
b=b instanceof Function&&!this.binder["function"]?this.formattedValue(b.call(this.model)):this.formattedValue(b);return null!=(a=this.binder.routine)?a.call(this,this.el,b):void 0};a.prototype.sync=function(){var a,c;if(this.model!==this.observer.target){var d=this.dependencies;var e=0;for(a=d.length;e<a;e++){var g=d[e];g.unobserve()}this.dependencies=[];if(null!=(this.model=this.observer.target)&&null!=(c=this.options.dependencies)&&c.length)for(d=this.options.dependencies,e=0,a=d.length;e<a;e++)g=
d[e],g=new f.Observer(this.view,this.model,g,this.sync),this.dependencies.push(g)}return this.set(this.observer.value())};a.prototype.publish=function(){var a,c,d;var e=f.Util.getInputValue(this.el);var g=this.formatters.slice(0).reverse();var m=0;for(a=g.length;m<a;m++){var l=g[m];l=l.split(/\s+/);var k=l.shift();null!=(c=this.view.formatters[k])&&c.publish&&(e=(d=this.view.formatters[k]).publish.apply(d,[e].concat(y.call(l))))}return this.observer.publish(e)};a.prototype.bind=function(){var a,c;
null!=(a=this.binder.bind)&&a.call(this,this.el);this.observer=new f.Observer(this.view,this.view.models,this.keypath,this.sync);this.model=this.observer.target;if(null!=this.model&&null!=(c=this.options.dependencies)&&c.length){var d=this.options.dependencies;a=0;for(c=d.length;a<c;a++){var e=d[a];e=new f.Observer(this.view,this.model,e,this.sync);this.dependencies.push(e)}}if(this.view.config.preloadData)return this.sync()};a.prototype.unbind=function(){var a,c;null!=(a=this.binder.unbind)&&a.call(this,
this.el);this.observer.unobserve();var d=this.dependencies;var e=0;for(c=d.length;e<c;e++)a=d[e],a.unobserve();return this.dependencies=[]};a.prototype.update=function(a){var b;null==a&&(a={});this.model=this.observer.target;this.unbind();null!=(b=this.binder.update)&&b.call(this,a);return this.bind()};return a}();f.ComponentBinding=function(a){function b(a,b,e){var c;this.view=a;this.el=b;this.type=e;this.unbind=h(this.unbind,this);this.bind=h(this.bind,this);this.update=h(this.update,this);this.locals=
h(this.locals,this);this.component=f.components[this.type];this.attributes={};this.inflections={};var d=this.el.attributes||[];b=0;for(e=d.length;b<e;b++)a=d[b],(c=a.name,0<=q.call(this.component.attributes,c))?this.attributes[a.name]=a.value:this.inflections[a.name]=a.value}z(b,a);b.prototype.sync=function(){};b.prototype.locals=function(a){var b,c;null==a&&(a=this.view.models);var g={};var f=this.inflections;for(b in f){var l=f[b];var k=l.split(".");var h=0;for(c=k.length;h<c;h++)l=k[h],g[b]=(g[b]||
a)[l]}for(b in a)f=a[b],null==g[b]&&(g[b]=f);return g};b.prototype.update=function(a){var b;return null!=(b=this.componentView)?b.update(this.locals(a)):void 0};b.prototype.bind=function(){var a;if(null!=this.componentView)return null!=(a=this.componentView)?a.bind():void 0;a=this.component.build.call(this.attributes);(this.componentView=new f.View(a,this.locals(),this.view.options)).bind();return this.el.parentNode.replaceChild(a,this.el)};b.prototype.unbind=function(){var a;return null!=(a=this.componentView)?
a.unbind():void 0};return b}(f.Binding);f.TextBinding=function(a){function b(a,b,e,g,f){this.view=a;this.el=b;this.type=e;this.keypath=g;this.options=null!=f?f:{};this.sync=h(this.sync,this);this.formatters=this.options.formatters||[];this.dependencies=[]}z(b,a);b.prototype.binder={routine:function(a,b){return a.data=null!=b?b:""}};b.prototype.sync=function(){return b.__super__.sync.apply(this,arguments)};return b}(f.Binding);f.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(a){if(!a.hasOwnProperty(this.id)){var b=
this.counter++;this.weakmap[b]={callbacks:{}};Object.defineProperty(a,this.id,{value:b})}return this.weakmap[a[this.id]]},stubFunction:function(a,b){var c=a[b];var d=this.weakReference(a);var e=this.weakmap;return a[b]=function(){var b,f,l,k;var h=c.apply(a,arguments);var v=d.pointers;for(b in v){var p=v[b];var q=null!=(l=null!=(k=e[b])?k.callbacks[p]:void 0)?l:[];var t=0;for(f=q.length;t<f;t++)p=q[t],p()}return h}},observeMutations:function(a,b,c){var d,e;if(Array.isArray(a)){var g=this.weakReference(a);
if(null==g.pointers){g.pointers={};var f="push pop shift unshift sort reverse splice".split(" ");var l=0;for(e=f.length;l<e;l++){var k=f[l];this.stubFunction(a,k)}}null==(d=g.pointers)[b]&&(d[b]=[]);if(0>q.call(g.pointers[b],c))return g.pointers[b].push(c)}},unobserveMutations:function(a,b,c){var d,e;if(Array.isArray(a&&null!=a[this.id])&&(d=null!=(e=this.weakReference(a).pointers)?e[b]:void 0)&&(a=d.indexOf(c),0<=a))return d.splice(a,1)},subscribe:function(a,b,c){var d=this.weakReference(a).callbacks;
if(null==d[b]){d[b]=[];var e=a[b];Object.defineProperty(a,b,{enumerable:!0,get:function(){return e},set:function(g){return function(f){var m;if(f!==e){e=f;var k=d[b].slice();var h=0;for(m=k.length;h<m;h++)c=k[h],0<=q.call(d[b],c)&&c();return g.observeMutations(f,a[g.id],b)}}}(this)})}0>q.call(d[b],c)&&d[b].push(c);return this.observeMutations(a[b],a[this.id],b)},unsubscribe:function(a,b,c){var d=this.weakmap[a[this.id]].callbacks[b];c=d.indexOf(c);0<=c&&d.splice(c,1);return this.unobserveMutations(a[b],
a[this.id],b)},read:function(a,b){return a[b]},publish:function(a,b,c){return a[b]=c}};f.binders.text=function(a,b){return null!=a.textContent?a.textContent=null!=b?b:"":a.innerText=null!=b?b:""};f.binders.html=function(a,b){return a.innerHTML=null!=b?b:""};f.binders.show=function(a,b){return a.style.display=b?"":"none"};f.binders.hide=function(a,b){return a.style.display=b?"none":""};f.binders.enabled=function(a,b){return a.disabled=!b};f.binders.disabled=function(a,b){return a.disabled=!!b};f.binders.checked=
{publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)===(null!=b?b.toString():void 0):a.checked=!!b}};f.binders.unchecked={publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c;
return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)!==(null!=b?b.toString():void 0):a.checked=!b}};f.binders.value={publishes:!0,bind:function(a){return f.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return f.Util.unbindEvent(a,"change",this.publish)},routine:function(a,b){var c,d,e;if(null!=window.jQuery){if(a=jQuery(a),(null!=b?b.toString():void 0)!==(null!=(c=a.val())?c.toString():void 0))return a.val(null!=b?b:"")}else if("select-multiple"===a.type){if(null!=
b){var g=[];var f=0;for(d=a.length;f<d;f++)c=a[f],g.push(c.selected=(e=c.value,0<=q.call(b,e)));return g}}else if((null!=b?b.toString():void 0)!==(null!=(f=a.value)?f.toString():void 0))return a.value=null!=b?b:""}};f.binders["if"]={block:!0,bind:function(a){if(null==this.marker){var b=[this.view.config.prefix,this.type].join("-").replace("--","-");var c=a.getAttribute(b);this.marker=document.createComment(" rivets: "+this.type+" "+c+" ");a.removeAttribute(b);a.parentNode.insertBefore(this.marker,
a);return a.parentNode.removeChild(a)}},unbind:function(){var a;return null!=(a=this.nested)?a.unbind():void 0},routine:function(a,b){if(!!b===(null==this.nested)){if(b){b={};var c=this.view.models;for(e in c){var d=c[e];b[e]=d}var e={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:this.view.options.config};(this.nested=new f.View(a,b,e)).bind();return this.marker.parentNode.insertBefore(a,this.marker.nextSibling)}a.parentNode.removeChild(a);
this.nested.unbind();return delete this.nested}},update:function(a){var b;return null!=(b=this.nested)?b.update(a):void 0}};f.binders.unless={block:!0,bind:function(a){return f.binders["if"].bind.call(this,a)},unbind:function(){return f.binders["if"].unbind.call(this)},routine:function(a,b){return f.binders["if"].routine.call(this,a,!b)},update:function(a){return f.binders["if"].update.call(this,a)}};f.binders["on-*"]={"function":!0,unbind:function(a){if(this.handler)return f.Util.unbindEvent(a,this.args[0],
this.handler)},routine:function(a,b){this.handler&&f.Util.unbindEvent(a,this.args[0],this.handler);return f.Util.bindEvent(a,this.args[0],this.handler=this.eventHandler(b))}};f.binders["each-*"]={block:!0,bind:function(a){var b;if(null==this.marker){var c=[this.view.config.prefix,this.type].join("-").replace("--","-");this.marker=document.createComment(" rivets: "+this.type+" ");this.iterated=[];a.removeAttribute(c);a.parentNode.insertBefore(this.marker,a);a.parentNode.removeChild(a)}else{var d=this.iterated;
c=0;for(b=d.length;c<b;c++)a=d[c],a.bind()}},unbind:function(a){var b;if(null!=this.iterated){var c=this.iterated;var d=[];var e=0;for(b=c.length;e<b;e++)a=c[e],d.push(a.unbind());return d}},routine:function(a,b){var c;var d=this.args[0];b=b||[];if(this.iterated.length>b.length){var e=Array(this.iterated.length-b.length);var g=0;for(e=e.length;g<e;g++){var h=this.iterated.pop();h.unbind();this.marker.parentNode.removeChild(h.els[0])}}var l=g=0;for(e=b.length;g<e;l=++g){var k=b[l];h={index:l};h[d]=
k;if(null==this.iterated[l]){l=this.view.models;for(p in l)k=l[p],null==h[p]&&(h[p]=k);k=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker;l={binders:this.view.options.binders,formatters:this.view.options.formatters,adapters:this.view.options.adapters,config:{}};var r=this.view.options.config;for(c in r){var q=r[c];l.config[c]=q}l.config.preloadData=!0;q=a.cloneNode(!0);h=new f.View(q,h,l);h.bind();this.iterated.push(h);this.marker.parentNode.insertBefore(q,k.nextSibling)}else this.iterated[l].models[d]!==
k&&this.iterated[l].update(h)}if("OPTION"===a.nodeName){var p=this.view.bindings;d=[];b=0;for(c=p.length;b<c;b++)a=p[b],a.el===this.marker.parentNode&&"value"===a.type?d.push(a.sync()):d.push(void 0);return d}},update:function(a){var b={};for(f in a){var c=a[f];f!==this.args[0]&&(b[f]=c)}var d=this.iterated;var e=[];var f=0;for(c=d.length;f<c;f++)a=d[f],e.push(a.update(b));return e}};f.binders["class-*"]=function(a,b){var c=" "+a.className+" ";if(!b===(-1!==c.indexOf(" "+this.args[0]+" ")))return a.className=
b?""+a.className+" "+this.args[0]:c.replace(" "+this.args[0]+" "," ").trim()};f.binders["*"]=function(a,b){return null!=b?a.setAttribute(this.type,b):a.removeAttribute(this.type)};f.factory=function(a){a._=f;a.binders=f.binders;a.components=f.components;a.formatters=f.formatters;a.adapters=f.adapters;a.config=f.config;a.configure=function(a){var b;null==a&&(a={});for(b in a){var d=a[b];f.config[b]=d}};return a.bind=function(a,c,d){null==c&&(c={});null==d&&(d={});a=new f.View(a,c,d);a.bind();return a}};
t={};f.factory(t);define("rivets",t)}).call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'data/DataManager.js' */
'use strict';define("confluence-hipchat-emoticons/data/DataManager",["ajs","jquery"],function(h,d){var e,b=[],c={},f=function(a){a&&(c={},a.forEach(function(a){c[a.shortcut]=a}))},g=function(){return d.ajax({url:h.contextPath()+"/rest/emoticons/1.0/",type:"get",dataType:"json",cache:!1}).then(function(a){localStorage.setItem("hipchat.emoticons.data",JSON.stringify(a));b=a.hipchat;f(b);return d.Deferred().resolve(a)})};return{initializeData:function(){var a=JSON.parse(localStorage.getItem("hipchat.emoticons.data"));
a&&(b=a.hipchat,f(b));e=g()},loadRemoteData:g,getAuthoritativeEmoticons:function(){return e},getHipChatEmoticon:function(a){return c[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'insertion/EmoticonInserter.js' */
'use strict';define("confluence-hipchat-emoticons/insertion/EmoticonInserter",["ajs"],function(e){return{insertEmoticon:function(a,f){var b=e.Rte.getEditor();if(f){var c=$(b.getContainer()),d=null;if(c.parents("#comments-section").length)d="comment";else if(c.parents(".ic-comment-container").length)d="inlinecomment";else if(c.parents("#editpageform").length||c.parents("#createpageform").length)d=c.parents(".blogpost").length?"blog":"page";d&&e.trigger("analyticsEvent",{name:"confluence.hipchat.emoticons.insert."+
f,data:{shortcut:a.shortcut,source:d}})}a=b.dom.createHTML("img",a.name?{src:a.url,alt:a.name+" "+a.shortcut,title:a.name+" "+a.shortcut,border:0,"class":"emoticon emoticon-"+a.name,"data-emoticon-name":a.name}:{src:a.url,alt:"("+a.shortcut+")",title:"("+a.shortcut+")",border:0,"class":"emoticon emoticon-"+a.shortcut,"data-hipchat-emoticon":a.shortcut});b.execCommand("mceInsertContent",!1,a,{skip_undo:!0});b.undoManager.beforeChange();b.undoManager.add()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'completion/CompletionManager.js' */
'use strict';define("confluence-hipchat-emoticons/completion/CompletionManager","ajs jquery underscore confluence-hipchat-emoticons/completion/Utilities confluence-hipchat-emoticons/data/DataManager confluence-hipchat-emoticons/insertion/EmoticonInserter".split(" "),function(f,h,q,g,k,l){function m(c,a,b){if(!a)throw Error("text node is null");3!=a.nodeType&&(a=a.childNodes[b-1],b=a.length);for(;a&&3==a.nodeType;a=a.previousSibling){-1==b&&(b=a.nodeValue.length);if(b>c)return{container:a,offset:b-
c};if(b==c){b=0;for(c=a.parentNode;a.previousSibling;)a=a.previousSibling,b++;return{container:c,offset:b}}c-=b;b=-1}return null}var n=/\(([A-Za-z0-9]+)$/,p=function(c){if(41===g.getCharCode(c)){var a=f.Rte.getEditor(),b=g.getTextFromPreviousSiblingTextNodes(a.selection.getRng(!0));if(b=n.exec(b))if(b=b[1],b=k.getHipChatEmoticon(b)){a.execCommand("mceInsertContent",!1,")");a.undoManager.beforeChange();a.undoManager.add();var d=a.selection.getRng(!0);g.getTextFromPreviousSiblingTextNodes(d);var e=
m(b.shortcut.length+1+1,d.commonAncestorContainer,d.startOffset);d.setStart(e.container,e.offset);e=h(d.commonAncestorContainer);a.selection.setRng(d);e.closest(".wysiwyg-macro-body").length&&d.toString()==e.text()?(e[0].innerHTML="\x3cbr\x3e",a.selection.select(e[0].childNodes[0]),a.selection.collapse(!0)):a.execCommand("delete",!1,{},{skip_undo:!0});l.insertEmoticon(b,"autoformat");tinymce.dom.Event.cancel(c);c=!1}else c=!0;else c=!0;return c}};return{start:function(){f.Rte.BootstrapManager.addOnInitCallback(function(){f.Rte.getEditor().on("keypress",
p,!0)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'completion/Utilities.js' */
'use strict';define("confluence-hipchat-emoticons/completion/Utilities",["jquery"],function(d){return{getTextFromPreviousSiblingTextNodes:function(b){if(!b||!b.collapsed)throw Error("range is null or not collapsed");var a=b.startContainer;var c=b.startOffset;if(1==a.nodeType&&0<c)if(a=a.childNodes[b.startOffset-1],3==a.nodeType)c=a.nodeValue.length;else return"";else if(3!=a.nodeType)return"";b=a.nodeValue.substring(0,c);for(a=a.previousSibling;a&&3==a.nodeType;a=a.previousSibling)b=a.nodeValue+b;
return b},getCharCode:function(b){return d.browser.msie?b.keyCode:b.which}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/DialogEmoticon.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/DialogEmoticon",["underscore"],function(b){var c=function(a){this.name=a.name;this.shortcut=a.shortcut;this.fullShortcut=a.fullShortcut;this.url=a.url;this.onClick=a.onClick&&b.bind(a.onClick,this,this);this.visible=!0;this._initializeCaption(a)};b.extend(c.prototype,{onKeypress:function(a){13==a.keyCode&&this.click()},_initializeCaption:function(a){a.selectedText?(this.selectedCaptionPortion=a.selectedText,a=this.fullShortcut.indexOf(this.selectedCaptionPortion),
this.leftCaptionPortion=this.fullShortcut.substring(0,a),this.rightCaptionPortion=this.fullShortcut.substring(a+this.selectedCaptionPortion.length)):(this.leftCaptionPortion=this.fullShortcut,this.rightCaptionPortion=this.selectedCaptionPortion="")}});return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/EmoticonDialog.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/EmoticonDialog","ajs jquery rivets underscore confluence-hipchat-emoticons/dialog/DialogEmoticon confluence-hipchat-emoticons/dialog/EmoticonDialogModel confluence-hipchat-emoticons/dialog/Templates".split(" "),function(c,d,e,f,a,g,h){a=function(){var a=new g({dialog:this}),b=d(h.emoticonDialog({auiVersion:parseInt(c.version)}))[0];document.body.appendChild(b);this._dialog=c.dialog2(b);e.bind(b,a);d(b.querySelector(".loading-spinner")).spin("large");
this._dialog.on("show",function(){a.update(a.filterText="")})};f.extend(a.prototype,{show:function(){this._dialog.show()},close:function(){this._dialog.hide()}});return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/EmoticonDialogModel.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/EmoticonDialogModel",["ajs","underscore","confluence-hipchat-emoticons/data/DataManager","confluence-hipchat-emoticons/insertion/EmoticonInserter","confluence-hipchat-emoticons/dialog/DialogEmoticon"],function(d,h,e,f,g){var c=function(b){var a=this;this.close=function(){b.dialog.close()};this.onFilterSubmit=function(a){return a.preventDefault()};this.onFilterUpdate=function(){a.update(this.value)};var c=function(b){f.insertEmoticon(b);a.close()},
k=function(b){f.insertEmoticon(b,"gallery");a.close()};this.isAdmin=d.Meta.getBoolean("is-admin");this.isHipChatIntegrated=!1;this.loadEmoticons=function(){var b=a.isError?e.loadRemoteData():e.getAuthoritativeEmoticons();a.isLoading=!0;a.isError=!1;a.showEmoticons=!1;a.showHipChatEmoticons=!1;b.then(function(b){a.isLoading=!1;a.hipchatEmoticons=b.hipchat.map(function(a){return new g({shortcut:a.shortcut,fullShortcut:"("+a.shortcut+")",url:a.url,onClick:k})});a.confluenceEmoticons=b.confluence.map(function(a){return new g({name:a.name,
shortcut:a.shortcut,fullShortcut:a.shortcut,url:a.url,onClick:c})});a.showEmoticons=!0;a.showHipChatEmoticons=!!d.Meta.get("remote-user");a.allEmoticons=h.union(a.confluenceEmoticons,a.hipchatEmoticons);a.isHipChatIntegrated=b.hipchatIntegrated;setTimeout(function(){document.querySelector("#hipchat-emoticons-filter").focus();document.querySelector("#hipchat-emoticons-filter").select()},100)}).fail(function(){a.isError=!0;a.isLoading=!1})}.bind(this);this.loadEmoticons()};c.prototype.update=function(b){this._previousFilterText!==
b&&(this._previousFilterText=b,(this.allEmoticons||[]).forEach(function(a){a.visible=0<=a.fullShortcut.indexOf(b)}))};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.HipChatEmoticons.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.HipChatEmoticons == 'undefined') { Confluence.Templates.HipChatEmoticons = {}; }
if (typeof Confluence.Templates.HipChatEmoticons.Dialog == 'undefined') { Confluence.Templates.HipChatEmoticons.Dialog = {}; }


Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="insert-hipchat-emoticon-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Insert emoticon') + '</h2><div class="aui-dialog2-header-secondary"><form class="aui" action="#"><input id="hipchat-emoticons-filter" class="text medium-field" type="search" rv-show="showEmoticons" rv-value="filterText" rv-on-keyup="onFilterUpdate" rv-on-submit="onFilterSubmit" placeholder="' + soy.$$escapeHtml('Search') + '"></form></div>' + ((opt_data.auiVersion < 9) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Cancel') + '</span></a>' : '<button class="aui-close-button" type="button" aria-label="' + soy.$$escapeHtml('Cancel') + '"></button>') + '</header><div class="aui-dialog2-content"><div class="emoticon-gallery"><div rv-show="isLoading" class="loading-spinner"></div><div rv-show="isError" class="error"><p><span class="aui-icon aui-icon-large aui-iconfont-error"></span></p><p>Oh dear, it seems we had some trouble loading your emoticons. Please click the button below to try loading them again.</p><p><button class="aui-button aui-button-primary" id="hipchat-emoticons-error-rety" rv-on-click="loadEmoticons">Retry</button></p></div><div rv-show="showEmoticons" class="emoticons-panel confluence-emoticons-panel"><h4 class="emoticons-panel-header">' + soy.$$escapeHtml('Confluence') + '</h4><hr>' + Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons(null) + '</div><div rv-show="showHipChatEmoticons" class="emoticons-panel hipchat-emoticons-panel"><h4 class="emoticons-panel-header">' + soy.$$escapeHtml('Hipchat') + '</h4><hr>' + Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons(null) + '<div rv-hide="isHipChatIntegrated" class="aui-message info"><span rv-show="isAdmin">' + soy.$$filterNoAutoescape(AJS.format('Hipchat emoticons are not available as Confluence is not integrated with Hipchat. {0}Click here{1} to integrate.','<a target="_blank" href="' + "" + '/plugins/servlet/hipchat/configure">','</a>')) + '</span><span rv-hide="isAdmin">' + soy.$$filterNoAutoescape('Hipchat emoticons are not available as Confluence is not integrated with Hipchat. Please contact your administrator for integration.') + '</span></div></div></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-link close-button" rv-on-click="close">' + soy.$$escapeHtml('Cancel') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.emoticonDialog';
}


Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons = function(opt_data, opt_ignored) {
  return '<div class="confluence-emoticons">' + Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater({modelDataAttribute: 'confluenceEmoticons'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.confluenceEmoticons';
}


Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons = function(opt_data, opt_ignored) {
  return '<div class="hipchat-emoticons">' + Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater({modelDataAttribute: 'hipchatEmoticons'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.hipchatEmoticons';
}


Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater = function(opt_data, opt_ignored) {
  return '<div rv-show="emoticon.visible" rv-each-emoticon="' + soy.$$escapeHtml(opt_data.modelDataAttribute) + '" class="gallery-item" rv-data-shortcut="emoticon.shortcut" rv-data-full-shortcut="emoticon.fullShortcut" rv-on-click="emoticon.onClick" rv-on-keydown="emoticon.onKeypress" tabindex="0"><img rv-src="emoticon.url"><br/><span class="caption"><span rv-text="emoticon.leftCaptionPortion"></span><strong rv-text="emoticon.selectedCaptionPortion"></strong><span rv-text="emoticon.rightCaptionPortion"></span></span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater.soyTemplateName = 'Confluence.Templates.HipChatEmoticons.Dialog.genericEmoticonRepeater';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'dialog/Templates.js' */
'use strict';define("confluence-hipchat-emoticons/dialog/Templates",function(){return window.Confluence.Templates.HipChatEmoticons.Dialog});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'menu/MenuItemOverrider.js' */
'use strict';define("confluence-hipchat-emoticons/menu/MenuItemOverrider",["ajs","jquery","confluence-hipchat-emoticons/dialog/EmoticonDialog"],function(d,a,c){return{start:function(){var b=null;a(".content-emoticon").off("click").on("click",function(a){b||(b=new c);b.show();a.preventDefault()})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-emoticons-plugin:hipchat-emoticons-conf-frontend', location = 'hipchat-emoticons.js' */
'use strict';define("confluence-hipchat-emoticons",["jquery","confluence-hipchat-emoticons/completion/CompletionManager","confluence-hipchat-emoticons/data/DataManager","confluence-hipchat-emoticons/menu/MenuItemOverrider"],function(c,d,a,e){c(document).on("postPaste",function(b,d,a){b=c("img",a.node);b.data("hipchatEmoticon")&&b.removeClass("confluence-embedded-image confluence-external-resource")});return{start:function(){a.initializeData();d.start();e.start()}}});AJS.bind("init.rte",function(){require("confluence-hipchat-emoticons").start()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = 'templates/view-file-macro-editor.soy' */
// This file was automatically generated from view-file-macro-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ViewFileMacro.Templates.Editor.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }
if (typeof Confluence.ViewFileMacro.Templates.Editor == 'undefined') { Confluence.ViewFileMacro.Templates.Editor = {}; }


Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader = function(opt_data, opt_ignored) {
  return '<div class="view-file-property-panel-header"><span class="file-name"><span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(opt_data.fileIcon) + '"></span>' + soy.$$escapeHtml(opt_data.fileName) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader.soyTemplateName = 'Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-properties-panel.js' */
define("vfm/components/view-file-macro-properties-panel","jquery underscore ajs confluence/legacy confluence/jsUri tinymce vfm/view-file-macro-utils".split(" "),function(h,m,e,r,x,l,n){function y(a,d){var b=m.find(Object.keys(p),function(z){return p[z]===d});if(b)for(var c=0,f=a.length;c<f;c++){var g=a[c],k=g.className.replace(" active","");-1!==k.indexOf("macro-property-panel-"+b)&&(k+=" active");g.className=k}}function A(a){var d=m.reject(a,function(c){return-1<c.className.indexOf("macro-placeholder-property-panel-edit-button")||
-1<c.className.indexOf("macro-placeholder-property-panel-remove-button")});a.splice(0,a.length);for(var b=0;b<d.length;b++)a.push(d[b])}function t(a,d){a=new x(a);""!==a.getQueryParamValue("height")&&a.replaceQueryParam("height",d);return a.toString()}function u(a){a=a.attr("data-macro-parameters");for(var d=[],b="",c=0;c<a.length;c++){var f=a[c];"\\"===f?(b+=f,c+1!==a.length&&(b+=a[++c])):"|"===f?(d.push(b),b=""):b+=f}d.push(b);return d}function v(a,d){a=u(a);return(a=m.find(a,function(b){return 0<=
b.indexOf(d+"\x3d")}))?a.split("\x3d")[1]:null}function q(a,d){if(-1===h(a).attr("class").indexOf("active")){e.Confluence.PropertyPanel.destroy();var b=Object.keys(p),c=h(a).attr("class");for(a=0;a<b.length;a++)if(-1!==c.indexOf(b[a])){var f=p[b[a]];c=h(d);c.attr("height",f);var g=c.attr("src");null!=g&&0<=g.indexOf("/servlet/view-file-macro/placeholder")&&(c.attr("src",t(c.attr("src"),f)),c.attr("data-mce-src",t(c.attr("data-mce-src"),f)),l.isGecko&&e.Rte.getEditor().execCommand("mceRepaint",!1));
f="height\x3d"+f;g=u(c);var k=v(c,"height");k?(k=m.indexOf(g,"height\x3d"+k),g[k]=f):g.push(f);c.attr("data-macro-parameters",g.join("|"));l.activeEditor.undoManager.add();h(d).click();c=l.activeEditor.getDoc().createRange();c.setStartBefore(d);c.setEndAfter(d);l.activeEditor.getDoc().getSelection().addRange(c);e.trigger("analyticsEvent",{name:"confluence.view-file.resize."+b[a].substring(b[a].lastIndexOf("-")+1,b[a].length)});break}}}function B(){e.bind("created.property-panel",function(a,d){var b=
h(d.anchor);if("view-file"===b.attr("data-macro-name")){a=r.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader;var c=v(b,"name");b=n.getParameterByName(b.attr("src"),"mimeType");b=e.Confluence.FileTypesUtils.getAUIIconFromMime(b);a=h(a({fileName:c,fileIcon:b}));d.panel.find(".aui-property-panel").prepend(a);d.shouldFlip&&d.tip.css({top:d.panel.outerHeight()})}})}var p={"view-file-size-small":"150","view-file-size-medium":"250","view-file-size-large":"400"},w=[{className:"macro-property-panel-view-file-size-small editor-resize resize-small",
text:"",tooltip:"Small thumbnail",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},{className:"macro-property-panel-view-file-size-medium editor-resize resize-medium",text:"",tooltip:"Medium thumbnail",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},{className:"macro-property-panel-view-file-size-large editor-resize resize-large",text:"",tooltip:"Large thumbnail",
iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:q},null,{className:"macro-property-panel-view-file-convert-to-link",text:"Show as link",tooltip:"Show as link",click:function(a,d){e.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-link-trigger"});e.Confluence.PropertyPanel.destroy();(function(b){b=n.getParameterByName(h(b).attr("src"),"attachmentId");
b=e.REST.makeUrl("attachment/"+b+".json");h.ajax({type:"GET",url:b,contentType:"application/json; charset\x3dutf-8",dataType:"json"}).success(function(c){c=r.Link.fromREST(c).insert();l.activeEditor.undoManager.add();l.activeEditor.focus();c.click()})})(d)}}];return{init:function(){e.Confluence.PropertyPanel.Macro.registerInitHandler(function(a,d,b){A(d);a=h(a);b=a.attr("data-mce-src");if(!(b&&-1<b.indexOf("placeholder/unknown-attachment"))){b=0;for(var c=w.length;b<c;b++)d.push(w[b]);(a=a.attr("height"))||
(a="comment"===e.Meta.get("content-type")?n.DEFAULT_HEIGHT_IN_COMMENT:n.DEFAULT_HEIGHT);y(d,a)}},"view-file");B()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-link-properties-panel.js' */
define("vfm/components/view-file-macro-link-properties-panel",["jquery","ajs","tinymce","vfm/view-file-macro-utils"],function(f,b,g,l){function m(c){if(c){var d=f(c);c=d.attr("data-linked-resource-type");d=d.attr("data-linked-resource-content-type");return b.MacroBrowser.getMacroMetadata("view-file")&&"attachment"===c&&!(d&&0===d.indexOf("image"))}return!1}function n(c){var d=b.REST.makeUrl("attachment/"+f(c).attr("data-linked-resource-id")+".json");f.ajax({type:"GET",url:d,contentType:"application/json; charset\x3dutf-8",
dataType:"json"}).success(function(a){var e={name:a.fileName};b.Data.get("content-id")!==a.ownerId&&(e.page=a.parentTitle,e.space=a.space.key,"blogpost"===a.parentContentType&&(a=a.createdDate.date.split("-"),e.date=a[0]+"/"+a[1]+"/"+a[2].substring(0,2)+"/"));e.height="comment"===b.Meta.get("content-type")?l.DEFAULT_HEIGHT_IN_COMMENT:l.DEFAULT_HEIGHT;e={contentId:b.Meta.get("content-id")||"0",macro:{name:"view-file",params:e}};g.confluence.MacroUtils.insertMacro(e,c).done(function(h){f(h).click();
const k=g.activeEditor.getDoc().createRange();k.setStartBefore(h);k.setEndAfter(h);g.activeEditor.getDoc().getSelection().addRange(k)})})}return{init:function(){b.bind("link-property-panel-buttons.created",function(c,d){c=d.buttons;var a=d.link;m(a)&&c.push({className:"link-property-panel-convert-to-thumbnail-button",text:"Show as thumbnail",tooltip:"Show as thumbnail",click:function(){b.Confluence.PropertyPanel.destroy();
n(a);b.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-thumbnail-trigger"})}})})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/vfm-editor-poller.js' */
define("vfm/components/vfm-editor-poller","ajs jquery underscore tinymce vfm/view-file-macro-utils vfm/services/conversion-service".split(" "),function(x,m,r,k,a,t){function v(){if(k.activeEditor&&l){var n=m("img[data-macro-name\x3d'view-file'][src*\x3d'thumbnailStatus\x3d"+a.THUMBNAIL_STATUS_IN_PROGRESS+"'][data-thumbnail-status!\x3d'"+a.THUMBNAIL_STATUS_ERROR+"']",k.activeEditor.dom.doc);if(0<n.length){var u=!1;n.each(function(){var d=m(this).attr("src"),c=a.getParameterByName(d,"attachmentId");
d=a.getParameterByName(d,"version");b[c]&&b[c].version===d||(b[c]={version:d},u=!0)});u&&(f=a.THUMBNAIL_POLLING_PERIOD);t.postThumbnailConversionResults(b).then(function(d){k.activeEditor&&l&&(r.each(d,function(c,e){if(b[e]){var p=m("img[data-macro-name\x3d'view-file'][src*\x3d'attachmentId\x3d"+e+"']",k.activeEditor.dom.doc),h=b[e].version;p.attr("data-thumbnail-status",c);c===a.THUMBNAIL_STATUS_CONVERTED?(c=p.attr("src"),h=t.getThumbnailUrl(e,h),h=a.addParamsToUrl(h,{attachmentId:e,mimeType:a.getParameterByName(c,
"mimeType")}),p.attr("src",h),delete b[e]):c===a.THUMBNAIL_STATUS_ERROR&&delete b[e]}}),f=r.isEmpty(b)?a.THUMBNAIL_POLLING_PERIOD:f*w,q())})}else 0===n.length&&(f=a.THUMBNAIL_POLLING_PERIOD,q())}}function q(){l=!0;g&&clearTimeout(g);g=setTimeout(v,f)}var g,l=!1,b={},f=a.THUMBNAIL_POLLING_PERIOD,w=a.THUMBNAIL_POLLING_BACKOFF_RATIO;return{startPolling:q,stopPolling:function(){g&&(clearTimeout(g),g=void 0);l=!1;b={};f=a.THUMBNAIL_POLLING_PERIOD}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/vfm-editor.js' */
require(["ajs","tinymce","vfm/components/view-file-macro-properties-panel","vfm/components/view-file-macro-link-properties-panel","vfm/components/vfm-editor-poller"],function(a,c,e,f,d){a.toInit(function(){a.MacroBrowser.setMacroJsOverride("view-file",{opener:function(b){}});e.init();f.init()});c.create("tinymce.plugins.ViewFilePoller",{init:function(b){a.bind("rte-ready",function(){d.startPolling()});a.bind("rte-destroyed",function(){d.stopPolling()})}});c.PluginManager.add("viewFilePoller",c.plugins.ViewFilePoller);
a.Rte.BootstrapManager.addTinyMcePluginInit(function(b){b.plugins+=",viewFilePoller"})},void 0,!0);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:widget-connector-autoconvert-web-resources-v4', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-widget-links.js' */
define("confluence-widget-connector/autoconvert",["tinymce"],function(c){var d=[/open.spotify.com/,/facebook.com/,/linkedin.com\/embed/,/twitter.com/,/figma.com/,/prezi.com/,/microsoftstream.com/,/google([.a-z]+)\/(maps|calendar|presentation|document)/,/google([.a-z]+)\/spreadsheets(.*)(pubchart|pubhtml)/];return{WidgetAutoConvertFn:function(e,f,a){var b=decodeURI(e.source);d.find(function(a){return b.match(a)})?c.plugins.Autoconvert.convertMacroToDom({name:"widget",params:{url:b}},a,a):a()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:widget-connector-autoconvert-web-resources-v4', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-widget-links-editor-v4.js' */
define("confluence-widget-connector/autoconvert-plugin-v4",["tinymce","confluence-editor/loader/tinymce-bootstrap","confluence-widget-connector/autoconvert"],function(b,c,d){b.PluginManager.add("widgetconnector",function(a){a.on("init",function(){a.execCommand("addAutoconverter",!1,d.WidgetAutoConvertFn)})});c.addTinyMcePluginInit(function(a){a.plugins+=",widgetconnector"})});
try{require("confluence-widget-connector/autoconvert-plugin-v4")}catch(b){console.warn("Unable to load widget autoconvert",b)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.tabs', location = 'aui.chunk.ca7ef50bea2a00ea2907--bd618782c64d5464a775.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.tabs"],{zCVu:function(t,e,a){"use strict";a.r(e),a.d(e,"TabContainerEl",(function(){return W})),a.d(e,"TabPaneEl",(function(){return S})),a.d(e,"TabItemEl",(function(){return D}));a("FStl"),a("Q0fs"),a("XHZH"),a("gjsO");var i=a("JFi+"),n=a("QFBp"),s=a("+x/D"),r=a("KloK"),u=a("OEua");function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var a=Object(s.default)(t),i=e||!1;a.each((function(){var t=Object(s.default)(this);t.attr("id")||t.attr("id",Object(u.default)(i))}))}Object(r.default)("_addID",o);var c=o;function d(t){return(t=Object(s.default)(t)).prop("scrollWidth")>t.prop("clientWidth")}Object(r.default)("isClipped",d);var l=d,b=a("4dFR"),f=window.skateTemplateHtml;function p(t){let e=Object(s.default)(t),a=String(e.attr("href")||"").trim();return 0===a.indexOf("#")?a.substr(1):null}function h(t){let e=p(t);return e?document.getElementById(e):null}var v={totalTabsWidth:function(t,e){var a=this.totalVisibleTabWidth(t),i=0;return e.find("li").each((function(t,e){i+=parseInt(e.getAttribute("data-aui-tab-width"))})),a+i},totalVisibleTabWidth:function(t){var e=0;return t.each((function(t,a){e+=Object(s.default)(a).outerWidth()})),e},removeResponsiveDropdown:function(t,e){t.remove(),e.remove()},createResponsiveDropdownTrigger:function(t,e){var a='<li class="menu-item aui-tabs-responsive-trigger-item">\n            <a\n                class="aui-dropdown2-trigger aui-tabs-responsive-trigger aui-dropdown2-trigger-arrowless"\n                id="aui-tabs-responsive-trigger-'.concat(e,'"\n                aria-haspopup="true"\n                aria-controls="aui-tabs-responsive-dropdown-').concat(e,'"\n                href="#aui-tabs-responsive-dropdown-').concat(e,'">...</a>\n            </li>');return t.append(a),t.find(".aui-tabs-responsive-trigger-item")},createResponsiveDropdown:function(t,e){var a='<div class="aui-dropdown2 aui-tabs-responsive-dropdown" id="aui-tabs-responsive-dropdown-'+e+'"><ul></ul></div>';return t.append(a),t.find("#aui-tabs-responsive-dropdown-"+e)},findNewVisibleTabs:function(t,e,a){function i(t,e,a){return t+e<=a}for(var n=0,r=0;i(n,a,e)&&r<t.length;r++){n+=Object(s.default)(t[r]).outerWidth(!0)}return t.slice(0,r-1)},moveVisibleTabs:function(t,e,a){for(var i=a.find("a").attr("aria-controls"),n=Object(s.default)("#"+i),r=this.findNewVisibleTabs(t,e.outerWidth(),a.parent().outerWidth(!0)),u=r.length-1,o=t.length-1;o>=u;o--){var c=Object(s.default)(t[o]);this.moveTabToResponsiveDropdown(c,n,a)}return Object(s.default)(r)},moveTabToResponsiveDropdown:function(t,e,a){var i=t.find("a");t.attr("data-aui-tab-width",t.outerWidth(!0)),i.addClass("aui-dropdown2-radio aui-tabs-responsive-item"),t.hasClass("active-tab")&&(i.addClass("aui-dropdown2-checked"),a.addClass("active-tab")),e.find("ul").prepend(t)},moveInvisibleTabs:function(t,e,a){function i(t){return t>0}for(var n=0;i(e)&&n<t.length;n++){var r=Object(s.default)(t[n]),u=parseInt(r.attr("data-aui-tab-width"),10);u<e&&this.moveTabOutOfDropdown(r,a),e-=u}},moveTabOutOfDropdown:function(t,e){t.find("a").hasClass("aui-dropdown2-checked")&&(t.addClass("active-tab"),e.removeClass("active-tab")),t.children("a").removeClass("aui-dropdown2-radio aui-tabs-responsive-item aui-dropdown2-checked"),e.before(t)}};function m(t){var e=Object(s.default)(t);if(!e.hasClass("aui-tabs-responsive-trigger")){var a=h(e);if(a){var n=Object(s.default)(a);n.addClass("active-pane").siblings(".tabs-pane").removeClass("active-pane");var r=e.parents(".aui-tabs").find(".aui-tabs-responsive-trigger-item a").attr("aria-controls"),u=Object(s.default)(document.getElementById(r));if(u.find("li a").attr("aria-checked",!1).removeClass("checked aui-dropdown2-checked"),u.find("li").removeClass("active-tab"),e.parent("li.menu-item").addClass("active-tab").siblings(".menu-item").removeClass("active-tab"),e.hasClass("aui-tabs-responsive-item")){var o=n.parent(".aui-tabs").find("li.menu-item:not(.aui-tabs-responsive-trigger-item)");o.removeClass("active-tab"),o.find("a").removeClass("checked").removeAttr("aria-checked")}e.hasClass("aui-tabs-responsive-item")&&n.parent(".aui-tabs").find("li.menu-item.aui-tabs-responsive-trigger-item").addClass("active-tab"),e.closest(".tabs-menu").find("a").attr("aria-selected","false"),e.attr("aria-selected","true"),e.trigger("tabSelect",{tab:e,pane:n})}else i.error("Cannot switch to tab panel because it does not exist. Check whether the tab link href is correct.",t)}}function g(t){return void 0!==t.attr("data-aui-persist")&&"false"!==t.attr("data-aui-persist")}function w(t){var e=t.attr("id"),a=t.attr("data-aui-persist");return"_internal-aui-tabs-"+(e||"")+(a&&"true"!==a?"-"+a:"")}function k(t){A.change(Object(s.default)(t.target).closest("a")),t&&t.preventDefault()}function O(t){t.forEach((function(t,e){!function(t,e){var a=Object(s.default)(t),i=a.find(".tabs-menu").first(),n=i.find("li:not(.aui-tabs-responsive-trigger-item)"),r=i.find(".aui-tabs-responsive-trigger").parent(),u=r.find("a"),o=u.attr("aria-controls"),c=Object(s.default)(document.getElementById(o)).attr("aria-checked",!1),d=c.length>0,l=v.totalTabsWidth(n,c)>a.outerWidth();if(!d&&l&&(r=v.createResponsiveDropdownTrigger(i,e),c=v.createResponsiveDropdown(a,e)),u.attr("aria-controls","aui-tabs-responsive-dropdown-"+e),u.attr("id","aui-tabs-responsive-trigger-"+e),u.attr("href","#aui-tabs-responsive-trigger-"+e),c.attr("id","aui-tabs-responsive-dropdown-"+e),l){var b=v.moveVisibleTabs(n.toArray(),a,r),f=v.totalVisibleTabWidth(b),p=a.outerWidth()-f-r.outerWidth(!0);if(p>0){var h=c.find("li");v.moveInvisibleTabs(h.toArray(),p,r)}a.hasClass("aui-tabs-disabled")||c.on("click.aui-tabs","a",k),i.is(":visible")&&i.hide().show()}d&&!l&&(c.find("li").each((function(){v.moveTabOutOfDropdown(Object(s.default)(this),r)})),v.removeResponsiveDropdown(c,r))}(t,e)}))}function j(){return Object(s.default)('.aui-tabs.horizontal-tabs[data-aui-responsive]:not([data-aui-responsive="false"]), aui-tabs[responsive]:not([responsive="false"])').toArray()}function C(t){var e=Object(s.default)(t);if(t.setAttribute("role","application"),!e.data("aui-tab-events-bound")){var a=e.children("ul.tabs-menu");a.attr("role","tablist"),a.children("li").attr("role","presentation"),a.find("> .menu-item a").each((function(){var t,e,a;t=this,e=Object(s.default)(t),a=h(e),p(t)||i.error('A tab link must use an anchor link (e.g., <a href="#a-valid-id"></a>) to work correctly.',t),a?(c(e),e.attr("role","tab"),Object(s.default)(a).attr("aria-labelledby",e.attr("id")),e.parent().hasClass("active-tab")?e.attr("aria-selected","true"):e.attr("aria-selected","false")):i.warn("A tab panel could not be found with the tab link's configured href. Check whether the tab link href is correct.",t)})),a.on("click.aui-tabs","a",k),e.data("aui-tab-events-bound",!0),function(t){[].slice.call(t.querySelectorAll(".tabs-pane")).forEach(y)}(t)}}function T(){var t=Object(s.default)(".aui-tabs:not(.aui-tabs-disabled)");t.each((function(){C(this)})),function(t){for(var e=0,a=t.length;e<a;e++){var n=t.eq(e),s=t.get(e);if(g(n)&&window.localStorage)if(n.attr("id")){var r=window.localStorage.getItem(w(n));if(r){var u=s.querySelector('a[href$="'.concat(r,'"]'));u&&m(u)}}else i.warn("A tab group must specify an id attribute if it specifies data-aui-persist.")}}(t)}function y(t){t.setAttribute("role","tabpanel")}var A={setup:function(){!function(){const t=Object(n.debounce)(O,200);t(j()),Object(s.default)(window).on("resize.aui-tabs",(()=>t(j())))}(),T(),Object(s.default)(".aui-tabs.vertical-tabs").find("a").each((function(){var t=Object(s.default)(this);t.attr("title")||l(t)&&t.attr("title",t.text())}))},change:function(t){var e=t instanceof HTMLElement||t instanceof s.default?t:document.querySelector(t),a=Object(s.default)(e).first(),n=a.closest(".aui-tabs");m(a),g(n)&&window.localStorage&&function(t){var e=t.closest(".aui-tabs");if(e.attr("id")){var a=p(t);a&&window.localStorage.setItem(w(e),"#"+a)}else i.warn("A tab group must specify an id attribute if it specifies data-aui-persist.")}(a)}};Object(s.default)(A.setup);const W=Object(b.default)("aui-tabs",{created:function(t){Object(s.default)(t).addClass("aui-tabs horizontal-tabs"),b.default.init(t),C(t)},template:f('<ul class="tabs-menu">','<content select="li[is=aui-tabs-tab]"></content>',"</ul>",'<content select="aui-tabs-pane"></content>'),prototype:{select:function(t){var e,a=Object(s.default)((e=this,e.querySelectorAll("aui-tabs-pane"))).index(t);return a>-1&&A.change(function(t){return t.querySelectorAll("li[is=aui-tabs-tab]")}(this)[a].children[0]),this}}}),D=Object(b.default)("aui-tabs-tab",{extends:"li",created:function(t){Object(s.default)(t).addClass("menu-item")},template:f('<a href="#">',"<strong>","<content></content>","</strong>","</a>")}),S=Object(b.default)("aui-tabs-pane",{attached:function(t){var e=Object(s.default)(function(t){return Object(s.default)(t).closest("aui-tabs").get(0)}(t)),a=Object(s.default)(t),i=e.find("aui-tabs-pane").index(a),n=new D,r=Object(s.default)(n);a.addClass("tabs-pane"),n.firstChild.setAttribute("href","#"+t.id),f.wrap(n).textContent=a.attr("title"),0===i&&a.addClass("active-pane"),a.hasClass("active-pane")&&r.addClass("active-tab"),a.siblings("ul").append(n)},template:f("<content></content>")});Object(r.default)("tabs",A)}},[["zCVu","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9","aui.splitchunk.5f851f97df","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.bff3715233","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.ed86a19e01","aui.splitchunk.084821f40b","aui.splitchunk.2e16019fb9","aui.splitchunk.5b8c290363","aui.splitchunk.baa83dbaf9","aui.splitchunk.e5af17b48e","aui.splitchunk.f154095da3","aui.splitchunk.36cd9d521c","aui.splitchunk.4248e12b20","aui.splitchunk.b548966f06"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:common-resources', location = 'build/common.js' */
!function(){"use strict";var t,e={21519:function(t,e,r){r.r(e);r(75654),r(42295),r(86305),r(15761);var o={stringPrototype:{},regExpPrototype:{},isNative:function(t){return-1!=t.toString().indexOf("native code")},isNeedLoadNativeFunctions:function(){return $("div[data-macro-name=code]").length&&!this.isNative(String.prototype.match)},saveOriginalNativeFunctions:function(){var t=this;!t.stringPrototype.matchOriginal&&t.isNative(String.prototype.match)&&(t.stringPrototype.replaceOriginal=String.prototype.replace,t.stringPrototype.matchOriginal=String.prototype.match,t.stringPrototype.splitOriginal=String.prototype.split,t.regExpPrototype.execOriginal=RegExp.prototype.exec,t.regExpPrototype.testOriginal=RegExp.prototype.test,t.regExpPrototype.applyOriginal=RegExp.prototype.apply,t.regExpPrototype.callOriginal=RegExp.prototype.call)},loadOriginalNativeFunctions:function(){var t=this;t.stringPrototype.matchOriginal&&(t.isNeedLoadNativeFunctions()?(t.stringPrototype.replaceSave=String.prototype.replace,t.stringPrototype.matchSave=String.prototype.match,t.stringPrototype.splitSave=String.prototype.split,t.regExpPrototype.execSave=RegExp.prototype.exec,t.regExpPrototype.testSave=RegExp.prototype.test,t.regExpPrototype.applySave=RegExp.prototype.apply,t.regExpPrototype.callSave=RegExp.prototype.call,String.prototype.replace=t.stringPrototype.replaceOriginal,String.prototype.match=t.stringPrototype.matchOriginal,String.prototype.split=t.stringPrototype.splitOriginal,RegExp.prototype.exec=t.regExpPrototype.execOriginal,RegExp.prototype.test=t.regExpPrototype.testOriginal,RegExp.prototype.apply=t.regExpPrototype.applyOriginal,RegExp.prototype.call=t.regExpPrototype.callOriginal):t.stringPrototype.matchSave=null)},loadSavedCurrentNativeFunctions:function(){var t=this;t.stringPrototype.matchOriginal&&t.stringPrototype.matchSave&&(String.prototype.replace=t.stringPrototype.replaceSave,String.prototype.match=t.stringPrototype.matchSave,String.prototype.split=t.stringPrototype.splitSave,RegExp.prototype.exec=t.regExpPrototype.execSave,RegExp.prototype.test=t.regExpPrototype.testSave,RegExp.prototype.apply=t.regExpPrototype.applySave,RegExp.prototype.call=t.regExpPrototype.callSave)}};window.TFSolutionBug=o,o.saveOriginalNativeFunctions()}},r={};function o(t){var p=r[t];if(void 0!==p)return p.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,o),i.exports}o.m=e,t=[],o.O=function(e,r,p,i){if(!r){var n=1/0;for(c=0;c<t.length;c++){r=t[c][0],p=t[c][1],i=t[c][2];for(var a=!0,g=0;g<r.length;g++)(!1&i||n>=i)&&Object.keys(o.O).every((function(t){return o.O[t](r[g])}))?r.splice(g--,1):(a=!1,i<n&&(n=i));if(a){t.splice(c--,1);var l=p();void 0!==l&&(e=l)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[r,p,i]},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={8592:0,6229:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var p,i,n=r[0],a=r[1],g=r[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(p in a)o.o(a,p)&&(o.m[p]=a[p]);if(g)var c=g(o)}for(e&&e(r);l<n.length;l++)i=n[l],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(c)},r=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var p=o.O(void 0,[8556,2295,3353,6305,5654,5761,6229],(function(){return o(21519)}));p=o.O(p)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:322bbdacb0b4c31f8f3d39d38920acab', location = 'build/5196.js' */
"use strict";(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[5196],{5196:function(t,e,n){var o=n(29638),l=n(63927);o({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return l(URL.prototype.toString,this)}})}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:editor-extensions', location = 'build/editor-extensions.js' */
!function(){"use strict";var t,e={78323:function(t,e,r){r.r(e);r(79150),r(75654),r(42295),r(84745),r(67285),r(86305),r(68268),r(15761);!function(t){t.extend({tablesorterEditor:new function(){this.version="2.3.10";var e=[],r=[];function o(t){"undefined"!=typeof console&&void 0!==console.log||alert(t)}function n(t,e){o(t+" ("+((new Date).getTime()-e.getTime())+"ms)")}function i(e,r,o){if(!r)return"";var n=e.config,i=n.textExtraction,a="";return a="simple"===i?n.supportsTextContent?r.textContent:r.childNodes[0]&&r.childNodes[0].hasChildNodes()?r.childNodes[0].innerHTML:r.innerHTML:"function"==typeof i?i(r,e,o):"object"==typeof i&&i.hasOwnProperty(o)?i[o](r,e,o):n.supportsTextContent?r.textContent:t(r).text(),t.trim(a)}function a(t){var r,o=e.length;for(r=0;r<o;r++)if(e[r].id.toLowerCase()===t.toString().toLowerCase())return e[r];return!1}function s(t,r,n,a){for(var s,l=e.length,c=!1,d="",u=!0;""===d&&u;)r[++n]?(d=i(t,c=r[n].cells[a],a),t.config.debug&&o("Checking if value was empty on row "+n+", column: "+a+": "+d)):u=!1;for(s=1;s<l;s++)if(e[s].is(d,t,c))return e[s];return e[0]}function l(e,r){var n,i,l,c,d,u,f,h=e.config,p=t(e.tBodies).filter(":not(."+h.cssInfoBlock+")"),g=t.tablesorterEditor,m="";if(0!==p.length){if((n=Array.from(e.rows).splice(1))[0])for(i=[],l=n[0].cells.length,c=0;c<l;c++)d=r.filter(':not([colspan])[data-column="'+c+'"]:last,[colspan="1"][data-column="'+c+'"]:last'),u=h.headers[c],f=a(g.getData(d,u,"sorter")),h.empties[c]=g.getData(d,u,"empty")||h.emptyTo||(h.emptyToBottom?"bottom":"top"),h.strings[c]=g.getData(d,u,"string")||h.stringTo||"max",f||(f=s(e,n,n.length>1?0:-1,c)),h.debug&&(m+="column:"+c+"; parser:"+f.id+"; string:"+h.strings[c]+"; empty: "+h.empties[c]+"\n"),i.push(f);return h.debug&&o(m),i}}function c(e){var r,o,a,s,l,c,d,u,f,h=e.tBodies,p=e.config,g=p.parsers;for(p.cache={},p.debug&&(f=new Date),c=0;c<h.length;c++)if(p.cache[c]={row:[],normalized:[]},!t(h[c]).hasClass(p.cssInfoBlock)){for(t(h[c]).addClass("tablesorter-hidden"),r=h[c]&&h[c].rows.length||0,o=h[c].rows[0]&&h[c].rows[0].cells.length||0,s=0;s<r;++s)if(!t(h[c].rows[s]).hasClass("tablesorter-header"))if(u=[],(d=t(h[c].rows[s])).hasClass(p.cssChildRow))p.cache[c].row[p.cache[c].row.length-1]=p.cache[c].row[p.cache[c].row.length-1].add(d);else{for(p.cache[c].row.push(d),l=0;l<o;++l)a=i(e,d[0].cells[l],l),u.push(g[l].format(a,e,d[0].cells[l],l));u.push(p.cache[c].normalized.length),p.cache[c].normalized.push(u)}t(h[c]).removeClass("tablesorter-hidden")}p.debug&&n("Building cache for "+r+" rows",f)}function d(t){var e,o,n=r.length;for(e=0;e<n;e++)if((o=r[e])&&o.hasOwnProperty("id")&&o.id.toLowerCase()===t.toLowerCase())return o}function u(t,e){var o,i,a,s=t.config,l=s.widgets,c=l.length;for(s.debug&&(o=new Date),i=0;i<c;i++)(a=d(l[i]))&&(!0===e&&a.hasOwnProperty("init")?a.init(t,r,a):!e&&a.hasOwnProperty("format")&&a.format(t));s.debug&&n("Completed "+(!0===e?"initializing":"applying")+" widgets",o)}function f(e,r){var o,i,a,s,l,c,d,f,h,p,g,m=e.config,b=e.tBodies,y=[],w=m.cache;for(m.debug&&(g=new Date),f=0;f<b.length;f++)if(!t(b[f]).hasClass(m.cssInfoBlock)){for(t(b[f]).addClass("tablesorter-hidden"),l=document.createDocumentFragment(),o=w[f].row,s=(a=(i=w[f].normalized).length)?i[0].length-1:0,c=0;c<a;c++)if(p=i[c][s],y.push(o[p]),!m.appender||!m.removeRows)for(h=o[p].length,d=0;d<h;d++)l.appendChild(o[p][d]);e.tBodies[f].appendChild(l),t(b[f]).removeClass("tablesorter-hidden")}m.appender&&m.appender(e,y),m.debug&&n("Rebuilt table",g),r||u(e),t(e).trigger("sortEnd",e)}function h(t){return/^d/i.test(t)||1===t}function p(e){var r,i,a,s,l,c=function(e){var r,o,n,i,a,s,l,c,d,u,f,h,p=[],g={},m=t(e).find("tr:has(td,th):first");for(r=0;r<m.length;r++)for(s=m[r].cells,o=0;o<s.length;o++){for(c=(l=(a=s[o]).parentNode.rowIndex)+"-"+a.cellIndex,d=a.rowSpan||1,u=a.colSpan||1,void 0===p[l]&&(p[l]=[]),n=0;n<p[l].length+1;n++)if(void 0===p[l][n]){f=n;break}for(g[c]=f,t(a).attr({"data-column":f}),n=l;n<l+d;n++)for(void 0===p[n]&&(p[n]=[]),h=p[n],i=f;i<f+u;i++)h[i]="x"}return g}(e),d=e.config,u=t.tablesorterEditor;return d.headerList=[],d.debug&&(s=new Date),l=t(e).find(d.selectorHeaders).each((function(e){i=t(this),r=d.headers[e],d.onRenderHeader&&d.onRenderHeader.apply(i,[e]),this.column=c[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=h(u.getData(i,r,"sortInitialOrder")||d.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,"false"===u.getData(i,r,"sorter")&&(this.sortDisabled=!0),this.lockedOrder=!1,void 0!==(a=u.getData(i,r,"lockedOrder")||!1)&&!1!==a&&(this.order=this.lockedOrder=h(a)?[1,1,1]:[0,0,0]),this.sortDisabled||i.addClass(d.cssHeader),d.headerList[e]=this,i.parent().addClass(d.cssHeader)})),e.config.debug&&(n("Built headers:",s),o(l)),l}function g(e,r,o){var n,i,a,s,l=[],c=[e.config.cssDesc,e.config.cssAsc];for(r.removeClass(c.join(" ")).each((function(){this.sortDisabled||(l[this.column]=t(this))})),s=o.length,i=0;i<s;i++)if(2!==o[i][1]&&(l[o[i][0]]&&l[o[i][0]].addClass(c[o[i][1]]),n=r.filter('[data-column="'+o[i][0]+'"]'),s>1&&n.length))for(a=0;a<n.length;a++)n[a].sortDisabled||t(n[a]).addClass(c[o[i][1]])}function m(t,e){return t&&t[e]&&t[e].type||""}function b(t,e){var r,o,i,a,s,l,c,d,u,f,h,p,g,b=0,v=0,T=t.config,S=e.length,L=t.tBodies.length;T.debug&&(i=new Date);var D=function(){for(r="return function(sortNumeric, sortNumericDesc, sortText, sortTextDesc, table,  a, b) {",d=T.cache[l],u=d.normalized.length,a=0;a<S;a++){if(c=e[a][0],p=e[a][1],f=/n/i.test(m(T.parsers,c))?"Numeric":"Text",h="e"+a,/Numeric/.test(f+=0===p?"":"Desc")&&T.strings[c]){for(s=0;s<u;s++)o=Math.abs(parseFloat(d.normalized[s][c])),b=Math.max(b,isNaN(o)?0:o);v="boolean"==typeof T.string[T.strings[c]]?(0===p?1:-1)*(T.string[T.strings[c]]?-1:1):T.strings[c]&&T.string[T.strings[c]]||0}r+="var "+h+" = sort"+f+"(table,a["+c+"],b["+c+"],"+c+","+b+","+v+"); ",r+="if ("+h+") { return "+h+"; } ",r+="else { "}for(g=d.normalized&&d.normalized[0]?d.normalized[0].length-1:0,r+="return a["+g+"]-b["+g+"];",a=0;a<S;a++)r+="}; ";r+="return 0; ",r+="}; ";var n=Function(r)();d.normalized.sort((function(e,r){return n(C,x,y,w,t,e,r)}))};for(l=0;l<L;l++)D();T.debug&&n("Sorting on "+e.toString()+" and dir "+p+" time",i)}function y(e,r,o,n){if(r===o)return 0;var i,a,s,l,c,d,u,f,h=e.config,p=h.string[h.empties[n]||h.emptyTo],g=t.tablesorterEditor.regex;if(""===r&&0!==p)return"boolean"==typeof p?p?-1:1:-p||-1;if(""===o&&0!==p)return"boolean"==typeof p?p?1:-1:p||1;if("function"==typeof h.textSorter)return h.textSorter(r,o,e,n);if(i=r.replace(g[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),s=o.replace(g[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),a=parseInt(r.match(g[2]))||1!==i.length&&r.match(g[1])&&Date.parse(r),l=parseInt(o.match(g[2]))||a&&o.match(g[1])&&Date.parse(o)||null){if(a<l)return-1;if(a>l)return 1}for(f=Math.max(i.length,s.length),u=0;u<f;u++){if(c=!(i[u]||"").match(g[3])&&parseFloat(i[u])||i[u]||0,d=!(s[u]||"").match(g[3])&&parseFloat(s[u])||s[u]||0,isNaN(c)!==isNaN(d))return isNaN(c)?1:-1;if(typeof c!=typeof d&&(c+="",d+=""),c<d)return-1;if(c>d)return 1}return 0}function w(t,e,r,o){if(e===r)return 0;var n=t.config,i=n.string[n.empties[o]||n.emptyTo];return""===e&&0!==i?"boolean"==typeof i?i?-1:1:i||1:""===r&&0!==i?"boolean"==typeof i?i?1:-1:-i||-1:"function"==typeof n.textSorter?n.textSorter(r,e,t,o):y(t,r,e)}function v(t,e,r){if(e){var o,n=t.length,i=e+r;for(o=0;o<n;o++)i+=t.charCodeAt(o);return r*i}return 0}function C(t,e,r,o,n,i){if(e===r)return 0;var a=t.config,s=a.string[a.empties[o]||a.emptyTo];return""===e&&0!==s?"boolean"==typeof s?s?-1:1:-s||-1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:s||1:(isNaN(e)&&(e=v(e,n,i)),isNaN(r)&&(r=v(r,n,i)),e-r)}function x(t,e,r,o,n,i){if(e===r)return 0;var a=t.config,s=a.string[a.empties[o]||a.emptyTo];return""===e&&0!==s?"boolean"==typeof s?s?-1:1:s||1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:-s||-1:(isNaN(e)&&(e=v(e,n,i)),isNaN(r)&&(r=v(r,n,i)),r-e)}function T(t,e,r){var o=t[0];!1!==e?t.trigger("sorton",[o.config.sortList,function(){t.trigger("updateComplete"),"function"==typeof r&&r(o)}]):(t.trigger("updateComplete"),"function"==typeof r&&r(o))}this.defaults={widthFixed:!1,cancelSelection:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",usNumberFormat:!0,delayInit:!1,headers:{},ignoreCase:!1,sortForce:null,sortList:[],sortAppend:null,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"simple",textSorter:(t,e)=>t.localeCompare(e),widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,onRenderHeader:null,tableClass:"tablesorter",cssAsc:"tablesorter-headerSortUp",cssChildRow:"expand-child",cssDesc:"tablesorter-headerSortDown",cssHeader:"tablesorter-header",cssInfoBlock:"tablesorter-infoOnly",selectorHeaders:"tr:has(td,th):first td, tr:has(td,th):first th",selectorRemove:"tr.remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},this.benchmark=n,this.hasInitialized=!1,this.construct=function(e){return this.each((function(){if(0!==this.tBodies.length){var r,o,n,a,s,h,m,y,w,v,C=t.metadata;this.config={},(n=t.extend(!0,this.config,t.tablesorterEditor.defaults,e)).debug&&t.data(this,"startoveralltimer",new Date),o=t(this).addClass(n.tableClass),t.data(this,"tablesorter",n),n.supportsTextContent="x"===t("<span>x</span>")[0].textContent,n.string={max:1,min:-1,"max+":1,"max-":-1,zero:0,none:0,null:0,top:!0,bottom:!1},r=p(this),n.parsers=l(this,r),n.delayInit||c(this),function(e){if(e.config.widthFixed){var r=t("<colgroup>");t("tr:first td",e.tBodies[0]).each((function(){r.append(t("<col>").css("width",t(this).width()))})),t(e).prepend(r)}}(this),r.bind("mousedown.tablesorter mouseup.tablesorter",(function(e,i){if(e.ctrlKey||e.metaKey){if("mousedown"===e.type)return v=(new Date).getTime(),!n.cancelSelection;if(!0!==i&&(new Date).getTime()-v>500)return!1;if(n.delayInit&&!n.cache&&c(o[0]),!this.sortDisabled){if(o.trigger("sortStart",o[0]),t(this),h=!e[n.sortMultiSortKey],this.count=(this.count+1)%(n.sortReset?3:2),n.sortRestart&&(a=this,r.each((function(){this===a||!h&&t(this).is("."+n.cssDesc+",."+n.cssAsc)||(this.count=-1)}))),a=this.column,h){if(n.sortList=[],null!==n.sortForce)for(m=n.sortForce,s=0;s<m.length;s++)m[s][0]!==a&&n.sortList.push(m[s]);if((w=this.order[this.count])<2&&(n.sortList.push([a,w]),this.colSpan>1))for(s=1;s<this.colSpan;s++)n.sortList.push([a+s,w])}else if(function(t,e){var r,o=e.length;for(r=0;r<o;r++)if(e[r][0]===t)return!0;return!1}(a,n.sortList))for(s=0;s<n.sortList.length;s++)y=n.sortList[s],w=n.headerList[y[0]],y[0]===a&&(y[1]=w.order[w.count],2===y[1]&&(n.sortList.splice(s,1),w.count=-1));else if((w=this.order[this.count])<2&&(n.sortList.push([a,w]),this.colSpan>1))for(s=1;s<this.colSpan;s++)n.sortList.push([a+s,w]);if(null!==n.sortAppend)for(m=n.sortAppend,s=0;s<m.length;s++)m[s][0]!==a&&n.sortList.push(m[s]);return o.trigger("sortBegin",o[0]),g(o[0],r,n.sortList),b(o[0],n.sortList),f(o[0]),!1}}})),n.cancelSelection&&r.each((function(){this.onselectstart=function(){return!1}})),o.bind("update",(function(e,i,a){t(n.selectorRemove,this).remove(),n.parsers=l(this,r),c(this),T(o,i,a)})).bind("updateCell",(function(e,r,a,s){var l,c=this,d=t(this).find("tbody"),u=d.index(t(r).closest("tbody"));l=[d.eq(u).find("tr").index(t(r).closest("tr")),r.cellIndex],c.config.cache[u].normalized[l[0]][l[1]]=n.parsers[l[1]].format(i(c,r,l[1]),c,r,l[1]),T(o,a,s)})).bind("addRows",(function(e,r,a,l){var c,d=r.filter("tr").length,u=[],f=r[0].cells.length,h=t(this).find("tbody").index(r.closest("tbody"));for(c=0;c<d;c++){for(s=0;s<f;s++)u[s]=n.parsers[s].format(i(this,r[c].cells[s],s),this,r[c].cells[s],s);u.push(n.cache[h].row.length),n.cache[h].row.push([r[c]]),n.cache[h].normalized.push(u),u=[]}T(o,a,l)})).bind("sorton",(function(e,o,i,a){t(this).trigger("sortStart",this);var s=n.headerList.length;n.sortList=[],t.each(o,(function(t,e){e[0]<s&&n.sortList.push(o[t])})),function(t,e){var r,o,n,i=t.config,a=e.length;for(r=0;r<a;r++)o=e[r],(n=i.headerList[o[0]])&&(n.count=o[1]%(i.sortReset?3:2))}(this,n.sortList),g(this,r,n.sortList),b(this,n.sortList),f(this,a),"function"==typeof i&&i(this)})).bind("appendCache",(function(t,e){f(this,e)})).bind("applyWidgetId",(function(t,e){d(e).format(this)})).bind("applyWidgets",(function(t,e){u(this,e)})).bind("destroy",(function(e,r){t.tablesorterEditor.destroy(this,r)})),o.data()&&void 0!==o.data().sortlist?n.sortList=o.data().sortlist:C&&o.metadata()&&o.metadata().sortlist&&(n.sortList=o.metadata().sortlist),u(this,!0),n.sortList.length>0?o.trigger("sorton",[n.sortList,{},!n.initWidgets]):n.initWidgets&&u(this),this.hasInitialized=!0,n.debug&&t.tablesorterEditor.benchmark("Overall initialization time",t.data(this,"startoveralltimer")),o.trigger("tablesorter-initialized",this),"function"==typeof n.initialized&&n.initialized(this)}}))},this.destroy=function(e,r){var o=t(e),n=e.config;o.find("thead:first .tablesorter-resizer").remove(),o.unbind("update updateCell addRows sorton appendCache applyWidgetId applyWidgets destroy mouseup mouseleave").find(n.selectorHeaders).unbind("click mousedown mousemove mouseup").removeClass(n.cssHeader+" "+n.cssAsc+" "+n.cssDesc),!1!==r&&o.removeClass(n.tableClass)},this.addParser=function(t){var r,o=e.length,n=!0;for(r=0;r<o;r++)e[r].id.toLowerCase()===t.id.toLowerCase()&&(n=!1);n&&e.push(t)},this.addWidget=function(t){r.push(t)},this.formatFloat=function(e,r){if("string"!=typeof e||""===e)return e;e=!1!==r.config.usNumberFormat?e.replace(/,/g,""):e.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(e)&&(e=e.replace(/^\s*\(/,"-").replace(/\)/,""));var o=parseFloat(e);return isNaN(o)?t.trim(e):o},this.isDigit=function(t){return/^[\-+(]?\d+[)]?$/.test(t.replace(/[,.'\s]/g,""))},this.regex=[/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,/^0x[0-9a-f]+$/i,/^0/],this.characterEquivalents={a:"áàâãä",A:"ÁÀÂÃÄ",c:"ç",C:"Ç",e:"éèêë",E:"ÉÈÊË",i:"íìİîï",I:"ÍÌİÎÏ",o:"óòôõö",O:"ÓÒÔÕÖ",S:"ß",u:"úùûü",U:"ÚÙÛÜ"},this.replaceAccents=function(t){var e,r="[",o=this.characterEquivalents;if(!this.characterRegex){for(e in this.characterRegexArray={},o)"string"==typeof e&&(r+=o[e],this.characterRegexArray[e]=new RegExp("["+o[e]+"]","g"));this.characterRegex=new RegExp(r+"]")}if(this.characterRegex.test(t))for(e in o)"string"==typeof e&&(t=t.replace(this.characterRegexArray[e],e));return t},this.getData=function(e,r,o){var n,i,a="",s=t(e);return s.length?(n=!!t.metadata&&s.metadata(),i=" "+(s.attr("class")||""),!s.data()||void 0===s.data(o)&&void 0===s.data(o.toLowerCase())?n&&void 0!==n[o]?a+=n[o]:r&&void 0!==r[o]?a+=r[o]:i&&i.match(" "+o+"-")&&(a=i.match(new RegExp(" "+o+"-(\\w+)"))[1]||""):a+=s.data(o)||s.data(o.toLowerCase()),t.trim(a)):""},this.clearTableBody=function(e){t(e.tBodies).filter(":not(."+e.config.cssInfoBlock+")").empty()}}})();var e,r,o,n,i=t.tablesorterEditor;t.fn.extend({tablesorterEditor:i.construct}),i.addParser({id:"text",is:function(t,e,r){return!0},format:function(e,r,o,n){var a=r.config;return e=t.trim(a.ignoreCase?e.toLocaleLowerCase():e),a.sortLocaleCompare?i.replaceAccents(e):e},type:"text"}),i.addParser({id:"currency",is:function(t){return/^\(?[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+/.test(t)},format:function(t,e){return i.formatFloat(t.replace(/[^\w,. \-()]/g,""),e)},type:"numeric"}),i.addParser({id:"ipAddress",is:function(t){return/^\d{2,3}[\.]\d{2,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(t)},format:function(t,e){var r,o,n=t.split("."),a="",s=n.length;for(r=0;r<s;r++)2===(o=n[r]).length?a+="0"+o:a+=o;return i.formatFloat(a,e)},type:"numeric"}),i.addParser({id:"url",is:function(t){return/^(https?|ftp|file):\/\//.test(t)},format:function(e){return t.trim(e.replace(/(https?|ftp|file):\/\//,""))},type:"text"}),i.addParser({id:"isoDate",is:function(t){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},format:function(t,e){return i.formatFloat(""!==t&&new Date(t.replace(/-/g,"/")).getTime()||"",e)},type:"numeric"}),i.addParser({id:"percent",is:function(t){return/\d%\)?$/.test(t)},format:function(t,e){return i.formatFloat(t.replace(/%/g,""),e)},type:"numeric"}),i.addParser({id:"usLongDate",is:function(t){return t.match(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/)},format:function(t,e){return i.formatFloat(new Date(t).getTime()||"",e)},type:"numeric"}),i.addParser({id:"time",is:function(t){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(t)},format:function(t,e){return i.formatFloat(new Date("2000/01/01 "+t).getTime()||"",e)},type:"numeric"}),i.addParser({id:"digit",is:function(t){e=TableUtils.getLocaleDateFormat("yy-mm-dd"),r=TableUtils.getLocale(),o=TableUtils.mapSeparator(localStorage.getItem("tf-decimalSeparator"))||".",n=TableUtils.getWorklog();var i=TableUtils.getAnyValueType(t,o,n,!0,e,r);return null!==i&&i<3},format:function(t){var i=TableUtils.getAnyValueType(t,o,n,!0,e,r);return TableUtils.parseValueByType(i,t,o,n)},type:"numeric"}),i.addParser({id:"metadata",is:function(t){return!1},format:function(e,r,o){var n=r.config,i=n.parserMetadataName?n.parserMetadataName:"sortValue";return t(o).metadata()[i]},type:"numeric"}),i.addWidget({id:"zebra",format:function(e){var r,o,n,a,s,l,c,d=e.config,u=new RegExp(d.cssChildRow,"i"),f=t(e).children("tbody:not(."+d.cssInfoBlock+")"),h=["even","odd"];for(h=d.widgetZebra&&d.hasOwnProperty("css")?d.widgetZebra.css:d.widgetOptions&&d.widgetOptions.hasOwnProperty("zebra")?d.widgetOptions.zebra:h,d.debug&&(l=new Date),c=0;c<f.length;c++)(r=t(f[c])).children("tr").length>1&&(a=0,o=r.find("tr:visible"),r.addClass("tablesorter-hidden"),o.each((function(){n=t(this),u.test(this.className)||a++,s=a%2==0,n.removeClass(h[s?1:0]).addClass(h[s?0:1])})),r.removeClass("tablesorter-hidden"));d.debug&&i.benchmark("Applying Zebra widget",l)}})}(jQuery);r(5196);var o=r(99497),n=r(33926);!function(t){try{AJS.bind("init.rte",(function(){function e(e,r){Confluence.Editor.tableToolbar?Confluence.Editor.tableToolbar.Buttons.splice(Confluence.Editor.tableToolbar.Buttons.length-r,0,e):t(document).bind("createContextToolbarRow.Toolbar.tf",(function(){var o=t(tinymce.activeEditor.plugins.customtoolbar.getToolbarRow());if(o.length){t(document).unbind("createContextToolbarRow.Toolbar.tf");var n=o.children();n.eq(n.length-r-1).after(e.render())}}))}var r=function(){var e=t(tinymce.activeEditor.selection.getNode());return e.is("table")||(e=e.parents("table").eq(0)),tinymce.activeEditor.selection.select(e[0]),e},i=function(e){if(!t("#rte-toolbar-row-default").is(".disabled")){var o,i=r(),a='<table class="wysiwyg-macro" data-macro-name="table-filter" data-macro-parameters="" data-macro-schema-version="1" data-macro-body-type="RICH_TEXT"><tbody><tr><td class="wysiwyg-macro-body">'+AJS.Rte.getEditor().serializer.serialize(i.clone()[0],{forced_root_block:!1})+"</td></tr></tbody></table>";(0,n.makeAjax)({type:"POST",contentType:"application/json; charset=utf-8",url:Confluence.getContextPath()+"/rest/tinymce/1/macro/definition",async:!1,data:t.toJSON({contentId:AJS.params.contentId||AJS.Meta.get("content-id")||AJS.params.pageId||AJS.Meta.get("page-id"),macroHtml:a}),dataType:"text",success:function(e){o=t.secureEvalJSON(e)}}),tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({presetMacroName:e,selectedMacro:o})}};e(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Filter table data",iconClass:"table-filter-insert",click:function(){i("table-filter")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a pivot table",iconClass:"pivot-table-insert",click:function(){i("pivot-table")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a chart from data series",iconClass:"table-chart-insert",click:function(){i("table-chart")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Join, merge and query tables",iconClass:"table-joiner-insert",click:function(){i("table-joiner")}})]),2);var a=t("#wysiwygTextarea_ifr")[0].contentDocument;e(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Copy table",iconClass:"tf-copy-table",click:function(){if(!t("#rte-toolbar-row-default").is(".disabled")){tinymce.activeEditor.focus();var e=tinymce.activeEditor.selection.getRng(),o=r().addClass("tf-copy-table");a.execCommand("copy"),tinymce.activeEditor.selection.setRng(e),o.removeClass("tf-copy-table")}}})]),2),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("unwrap-tf",(function(e,r){o.default.gaUnwrapMacro(),AJS.Rte.BookmarkManager.storeBookmark();var n=t(r);AJS.trigger("tf-unwrap",n.attr("id")),AJS.Rte.getEditor().selection.select(r),AJS.Rte.getEditor().execCommand("mceInsertContent",!1,n.find(".wysiwyg-macro-body").html()),AJS.Rte.BookmarkManager.restoreBookmark()}))}))}catch(t){}}(jQuery);var i=r(83931);window.TableUtils=i.default,$.tablesorterEditor.addParser({id:"dateMacroSorter",is:function(t){var e=i.default.getLocaleDateFormat("yy-mm-dd"),r=i.default.getLocale();return i.default.getAnyValueType(t,".",i.default.getWorklog(),!0,e,r)===i.default.date},format:function(t){try{var e=i.default.getLocaleDateFormat("yy-mm-dd"),r=i.default.getLocale();return i.default.parseDate(t,e,r,!0).getTime()}catch(t){return 0}},type:"numeric"})}},r={};function o(t){var n=r[t];if(void 0!==n)return n.exports;var i=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=e,o.amdD=function(){throw new Error("define cannot be used indirect")},o.amdO={},t=[],o.O=function(e,r,n,i){if(!r){var a=1/0;for(d=0;d<t.length;d++){r=t[d][0],n=t[d][1],i=t[d][2];for(var s=!0,l=0;l<r.length;l++)(!1&i||a>=i)&&Object.keys(o.O).every((function(t){return o.O[t](r[l])}))?r.splice(l--,1):(s=!1,i<a&&(a=i));if(s){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[r,n,i]},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,{a:e}),e},o.d=function(t,e){for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var t={5101:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var n,i,a=r[0],s=r[1],l=r[2],c=0;if(a.some((function(e){return 0!==t[e]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(l)var d=l(o)}for(e&&e(r);c<a.length;c++)i=a[c],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(d)},r=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var n=o.O(void 0,[8556,2295,3353,7874,6305,5546,9150,5654,8018,5260,5761,9352,5196,3926,4818,3931],(function(){return o(78323)}));n=o.O(n)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:ef3a2712e341a5ca8d9ca356f4145a06', location = 'build/2240.js' */
(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[2240],{11230:function(e){if(void 0===(t=window.TableFilterTemplate=window.TableFilterTemplate||{}))var t={};t.totalRow=function(e,t){for(var a='<tr class="total-row synchrony-exclude">',l=e.length,i=0;i<l;i++)a+=1==e.numbering&&0==i?'<td class="confluenceTd" '+(e.isFireFox?"":'contenteditable="false"')+"></td>":'<th class="confluenceTh '+(e.totals[i]?"number":"")+" "+soy.$$escapeHtml(e.classes[i])+'" '+(e.isFireFox?"":'contenteditable="false"')+">"+(e.totals[i]?e.totals[i].total?soy.$$escapeHtml(e.totals[i].total):"0":i-e.numbering==0?e.title?soy.$$escapeHtml(e.title):soy.$$escapeHtml("Total\u200b"):"")+"</th>";return a+="</tr>"},goog.DEBUG&&(t.totalRow.soyTemplateName="TableFilterTemplate.totalRow"),t.totalCol=function(e,t){return'<th class="total-col synchrony-exclude confluenceTh '+(e.rowNumber>0?"number":"")+'" contenteditable="false"><p></p></th>'},goog.DEBUG&&(t.totalCol.soyTemplateName="TableFilterTemplate.totalCol"),t.labelChanger=function(e,t){return'<input class="tf-label-changer text" type="text" value="'+soy.$$escapeHtml(e.value)+'" style="width: '+soy.$$escapeHtml(e.width)+';" title="'+soy.$$escapeHtml("Press the Enter button to change the filter label")+'">'},goog.DEBUG&&(t.labelChanger.soyTemplateName="TableFilterTemplate.labelChanger"),t.editorCloseButton=function(e,t){return'<div class="aui-buttons close"><button type="button" class="aui-button" data-tooltip="'+soy.$$escapeHtml("Close")+'" original-title=""><span class="icon icon-close aui-icon aui-icon-small aui-iconfont-close-dialog">'+soy.$$escapeHtml("Close")+"</span></button></div>"},goog.DEBUG&&(t.editorCloseButton.soyTemplateName="TableFilterTemplate.editorCloseButton"),t.addFilterDialog=function(e,t){var a='<form class="aui top-label inline-dialog-form tf-add-filter-dialog" style="padding: 10px">';if(e.filters.length>0||e.globalfilter||e.columnhider){for(var l=e.filters,i=l.length,r=0;r<i;r++){var s=l[r];a+='<div class="'+soy.$$escapeHtml(s.type)+' tf-add-filter-column"><label for="'+soy.$$escapeHtml(s.type)+'">'+soy.$$escapeHtml("Filter Column")+'</label><select class="select '+soy.$$escapeHtml(s.type)+'" name="'+soy.$$escapeHtml(s.type)+'">';for(var o=s.columns,n=o.length,c=0;c<n;c++){var d=o[c];a+='<option value="'+soy.$$escapeHtml(d)+'">'+soy.$$escapeHtml(d)+"</option>"}a+="</select></div>"}a+='<div><label for="filter-type">'+soy.$$escapeHtml("Filter Type")+'</label><select class="select filter-type" name="filter-type">';for(var f=e.filters,p=f.length,u=0;u<p;u++){var m=f[u];a+='<option value="'+soy.$$escapeHtml(m.type)+'" title="'+soy.$$escapeHtml(m.desc)+'">'+soy.$$escapeHtml(m.name)+"</option>"}a+=(e.globalfilter?'<option value="globalfilter" title="'+soy.$$escapeHtml("Enter custom text query or regular expression to filter data in the whole table")+'">'+soy.$$escapeHtml("Filter whole table")+"</option>":"")+(e.columnhider?'<option value="columnhider" title="'+soy.$$escapeHtml("Select table columns to hide")+'">'+soy.$$escapeHtml("Hide Columns")+"</option>":"")+'</select></div><div class="date-format-param"><label for="date-format-input">'+soy.$$escapeHtml("Date format")+'</label><input class="date-format-input text" type="text" value="'+soy.$$escapeHtml(e.dateFormat)+'"></div><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Add filter")+'" id="save"/><a class="cancel" id="cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div>"}else a+='<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Filters are not available")+'</p></div><div class="buttons-container"><div class="buttons"><a class="cancel" id="cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div>";return a+="</form>"},goog.DEBUG&&(t.addFilterDialog.soyTemplateName="TableFilterTemplate.addFilterDialog"),t.changeSettingsDialog=function(e,t){return'<form class="aui top-label inline-dialog-form" style="padding: 10px" action="javascript: void(0)"><div class="change-settings-dialog-parameter"><label for="tf-cs-dialog-datepattern">'+soy.$$escapeHtml("Date format")+'</label><input type="text" class="text" id="tf-cs-dialog-datepattern" value="'+soy.$$escapeHtml(e.datepattern)+'"></div><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Update")+'" id="tf-cs-save"/><a class="cancel" id="tf-cs-cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div></form>"},goog.DEBUG&&(t.changeSettingsDialog.soyTemplateName="TableFilterTemplate.changeSettingsDialog"),t.filter=function(e,a){return"selectfilter"==e.type?'<div class="filter-container selectfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="select" name="'+soy.$$escapeHtml(e.column)+'" style="width: 150px;" multiple data-width="150px"></select>'+t.crossIcon(null)+"</div>":"userfilter"==e.type?'<div class="filter-container userfilter-element sortable input"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: 150px;"><input class="user-filter text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 100%; max-width: none;" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="150px"/></div>'+t.crossIcon(null)+"</div>":"numberfilter"==e.type?'<div class="filter-container numberfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range numbers" name="'+soy.$$escapeHtml(e.column)+'">'+soy.$$escapeHtml("from")+'<input class="number from text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 90px;" placeholder="'+soy.$$escapeHtml("Type value")+'"/>'+soy.$$escapeHtml("to")+'<input class="number to text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 90px;" placeholder="'+soy.$$escapeHtml("Type value")+'"/></div>'+t.crossIcon(null)+"</div>":"datefilter"==e.type?'<div class="filter-container datefilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range dates" name="'+soy.$$escapeHtml(e.column)+'">'+soy.$$escapeHtml("from")+'<input class="date from text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 93px;" autocomplete="off" placeholder="'+soy.$$escapeHtml("Pick date")+'"/>'+soy.$$escapeHtml("to")+'<input class="date to text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 93px;" autocomplete="off" placeholder="'+soy.$$escapeHtml("Pick date")+'"/></div>'+t.crossIcon(null)+"</div>":"globalfilter"==e.type?'<div class="filter-container globalfilter-element sortable input"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml("Filter whole table")+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: 150px;"><input class="global-filter text" type="text" style="width: 100%; max-width: none;" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="150px"/></div></div>':"columnhider"==e.type?'<div class="filter-container columnhider-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml("Hide columns")+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="column-select" style="width: 150px;" multiple data-width="150px"></select>'+t.crossIcon(null)+"</div>":"iconfilter"==e.type?'<div class="filter-container iconfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="icon-select" name="'+soy.$$escapeHtml(e.column)+'" style="width: 150px;" multiple data-width="150px" data-html="true"></select>'+t.crossIcon(null)+"</div>":""},goog.DEBUG&&(t.filter.soyTemplateName="TableFilterTemplate.filter"),t.panel=function(e,a){return'<div class="tablefilter-outer-wrapper'+(e.isCloud?" tf-cloud-macro":"")+" "+(e.hideLabels?"hide-labels":"")+" "+("true"==e.hidePane?"hide-pane":"")+(e.hideControls?" hide-controls":"")+'" data-id="'+soy.$$escapeHtml(e.macroId)+'" data-pageid="'+soy.$$escapeHtml(e.pageId)+'" data-sessionid="'+soy.$$escapeHtml(e.sessionId)+'">'+(e.isEmail?"":(e.isCloud?'<div id="tf-preview-tutorial" class="preview-tutorial"><h2>'+soy.$$escapeHtml("Welcome to Table Filter!")+"</h2><h3>"+soy.$$escapeHtml("To start filtering:")+'</h3><ol type="1"><li>'+soy.$$filterNoAutoescape("Click \u003cdiv class=\u0022tutorial-img img-insert-btn\u0022\u003e\u003c/div\u003e to add the macro to the page")+"</li><li>"+soy.$$escapeHtml("Place one or multiple tables (including macros outputting tables) within the macro body")+"</li><li>"+soy.$$escapeHtml("Edit the macro in the page view or edit mode")+'</li></ol><div class="tf-tutorial-img tutorial-img"></div></div>':"")+("Table header"!=e.hidePane||e.isEditor?'<div id="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tableFilterCbStyle"><div class="lockDisabled not-empty"><form class="aui tf-form aui-legacy-forms" name="inlinecommentform" action="javascript: void(0)"><div class="filter-container filter-icon filter-logo default '+(e.fd?"tf-fd":"")+'" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'"></div><div class="filter-buttons-container"><div class="tf-menu-buttons aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="tf-btn-container"><div id="tf-settings-row-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tf-btn-row"><div class="tf-settings-wrapper"><button id=\'filter-settings-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'\' class="filter-settings aui-button aui-button-subtle aui-dropdown2-trigger" aria-owns="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" aria-haspopup="true" data-container="" resolved="" aria-expanded="false"><span class="aui-icon aui-icon-small aui-iconfont-configure"></span><span class="tfac-unsaved">*</span></button>'+t.menu({macroId:e.macroId,pageId:e.pageId,sessionId:e.sessionId,editable:e.editable,disableSave:e.disableSave,isCloud:e.isCloud,inHeader:!1,isMacroViewContext:e.isMacroViewContext,courseBtn:e.courseBtn})+"</div></div></div></div></div></div></div>"+t.filters(e)+'<div class="filter-container show-n-rows-only-message"><label>'+soy.$$escapeHtml(AJS.format("Showing the first {0} rows",e.showNRowsifNotFiltered))+'</label></div><div class="filter-container empty-message"><label>'+soy.$$filterNoAutoescape("Start \u003ca class=\u0022tf-add-start\u0022\u003eadding filters\u003c/a\u003e in the filter tools menu.")+'</label></div></form></div><div class="lockEnabled"><div class="filter-container filter-icon filter-logo default" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'"></div><div class="lockPosition"><div class="filter-container"><label class="hideble">'+soy.$$escapeHtml("The filter is disabled at the moment.")+'</label></div><div class="tf-menu-buttons aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="tf-btn-container"><div class="tf-btn-row settings-row"><div class="tf-settings-wrapper"><button class="filter-settings aui-button aui-button-subtle aui-dropdown2-trigger" aria-owns="filter-menu-view-lock-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'"><span class="aui-icon aui-icon-small aui-iconfont-configure"></span></button><div id="filter-menu-view-lock-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="aui-style-default aui-dropdown2 tfac-menu" style="display: none; z-index: 3001;"><div class="aui-dropdown2-section"><ul class="aui-list-truncate first"><li><a class="enableLock cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-successful-build"></span>'+soy.$$escapeHtml("Enable all filters")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a class="export-file-pdf cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-pdf"></span>'+soy.$$escapeHtml("Export to PDF")+'</a></li><li><a class="export-file-csv cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-table"></span>'+soy.$$escapeHtml("Export to CSV")+'</a></li><li><a class="export-file-doc cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-document"></span>'+soy.$$escapeHtml("Export to Word")+'</a></li><li><a class="export-file-print cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-activity"></span>'+soy.$$escapeHtml("Print")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+filter+macro?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-document-filled"></span>'+soy.$$escapeHtml("Documentation")+"</a></li><li>"+(e.isCloud?soy.$$filterNoAutoescape(e.courseBtn):'<a target="_blank" href="https://docs.stiltsoft.com/display/public/TFAC/Table+Filter+and+Charts+8.0.0?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-new-help"></span>'+soy.$$escapeHtml("What\u0027s new")+"</a>")+'</li><li><a target="_blank" class="tf-menu-star" href="https://calendly.com/nparamonova/table-filter-and-charts-feedback"><span class="aui-icon aui-icon-small aui-iconfont-star"></span>'+soy.$$escapeHtml("Share feedback")+'</a></li></ul></div></div></div></div></div></div></div></div></div></div><div class="filter-container no-table-message"><div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Filter macro.")+'</p></div></div><div class="filter-container waiting-for-table"><div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("The table is being loaded. Please wait for a bit ...")+'<span class="aui-icon aui-icon-wait" style="margin-left: 5px"></span></p></div></div><div class="tf-hider-wrapper" title="'+soy.$$escapeHtml("Hide filtration pane")+'"><div class="tf-hider"><span class="tf-hide-show-icon"></span></div></div></div><div id="tf-shower-'+soy.$$escapeHtml(e.macroId)+'" class="tf-shower-wrapper" title="'+soy.$$escapeHtml("Show filtration pane")+'"><div class="tf-shower"><span class="tf-hide-show-icon"></span></div></div>':'<div class="tf-floating-btn-container"><button id=\'filter-settings-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+"' class=\"aui-button aui-button-compact aui-button-subtle filter-container filter-icon filter-logo default floating aui-dropdown2-trigger "+(e.fd?"tf-fd":"")+'" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'" aria-owns="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" aria-haspopup="true" aria-expanded="false"><span class="aui-icon aui-icon-small"></span><span class="tfac-unsaved">*</span><span class="filter-count"></span></button></div>'+t.menu({macroId:e.macroId,pageId:e.pageId,sessionId:e.sessionId,editable:e.editable,disableSave:e.disableSave,isCloud:e.isCloud,inHeader:!0,isMacroViewContext:e.isMacroViewContext,courseBtn:e.courseBtn})+'<aui-inline-dialog id="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" alignment="bottom center" class="tf-inline-filters wiki-content"><div class="tableFilterCbStyle"><form class="aui tf-form aui-legacy-forms" name="inlinecommentform" action="javascript: void(0)">'+t.filters(e)+'</form></div></aui-inline-dialog><span data-aui-trigger aria-controls="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tf-inline-filter trigger '+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" title="'+soy.$$escapeHtml("Filter column")+'"></span><span class="tf-inline-filter btn '+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" title="'+soy.$$escapeHtml("Filter column")+'"></span>'))+(e.isEditor?"":'<div id="tf-table-'+soy.$$escapeHtml(e.macroId)+'" class="tablefilter-table-wrapper '+(e.isCloud?"tf-cloud-table":"")+" "+("Table header"==e.hidePane?"table-header-filter":"")+'">'+soy.$$filterNoAutoescape(e.body)+"</div>")+"</div>"},goog.DEBUG&&(t.panel.soyTemplateName="TableFilterTemplate.panel"),t.filters=function(e,a){for(var l='<div class="sortable-container">',i=e.comboBoxes,r=i.length,s=0;s<r;s++){var o=i[s];l+='<div class="filter-container selectfilter-element sortable '+(o.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(o.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="select '+(o.inverse?"inverse":"")+'" name="'+soy.$$escapeHtml(o.name)+'" style="width: '+soy.$$escapeHtml(o.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(o.columnWidth)+'px">';for(var n=o.options,c=n.length,d=0;d<c;d++){var f=n[d];l+='<option selected="selected"'+("-Empty-"==f?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(f))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}for(var p=e.edits,u=p.length,m=0;m<u;m++){var h=p[m];l+='<div class="filter-container userfilter-element sortable input '+(h.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(h.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: '+soy.$$escapeHtml(h.columnWidth)+'px;"><input class="user-filter text '+(h.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(h.name)+'" style="width: 100%; max-width: none;" value="'+soy.$$escapeHtml(h.defaultValue)+'" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="'+soy.$$escapeHtml(h.columnWidth)+'px"/></div>'+t.crossIcon(null)+"</div>"}for(var b=e.numberFilters,v=b.length,g=0;g<v;g++){var y=b[g];l+='<div class="filter-container numberfilter-element sortable '+(y.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(y.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range numbers" name="'+soy.$$escapeHtml(y.name)+'">'+soy.$$escapeHtml("from")+'<input class="number from text '+(y.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(y.name)+'" style="width: 90px;" value="'+soy.$$escapeHtml(y.defaultFromValue)+'" placeholder="'+soy.$$escapeHtml("Type value")+'"/>'+soy.$$escapeHtml("to")+'<input class="number to text '+(y.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(y.name)+'" style="width: 90px;" value="'+soy.$$escapeHtml(y.defaultToValue)+'" placeholder="'+soy.$$escapeHtml("Type value")+'"/></div>'+t.crossIcon(null)+"</div>"}for(var w=e.dateFilters,$=w.length,x=0;x<$;x++){var T=w[x];l+='<div class="filter-container datefilter-element sortable '+(T.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(T.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range dates" name="'+soy.$$escapeHtml(T.name)+'">'+soy.$$escapeHtml("from")+'<input class="date from text '+(T.inverse?"inverse":"")+'" type="text" autocomplete="off" name="'+soy.$$escapeHtml(T.name)+'" style="width: 93px;" value="'+soy.$$escapeHtml(T.defaultFromValue)+'" placeholder="'+soy.$$escapeHtml("Pick date")+'"/>'+soy.$$escapeHtml("to")+'<input class="date to text '+(T.inverse?"inverse":"")+'" type="text" autocomplete="off" name="'+soy.$$escapeHtml(T.name)+'" style="width: 93px;" value="'+soy.$$escapeHtml(T.defaultToValue)+'" placeholder="'+soy.$$escapeHtml("Pick date")+'"/></div>'+t.crossIcon(null)+"</div>"}for(var C=e.iconFilters,S=C.length,I=0;I<S;I++){var F=C[I];l+='<div class="filter-container iconfilter-element sortable '+(F.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(F.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="icon-select '+(F.inverse?"inverse":"")+'" name="'+soy.$$escapeHtml(F.name)+'" style="width: '+soy.$$escapeHtml(F.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(F.columnWidth)+'px" data-html="true">';for(var k=F.options,H=k.length,A=0;A<H;A++){var D=k[A];l+='<option selected="selected"'+("-Empty-"==D?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(D))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}if(l+=e.globalFilter?'<div class="filter-container globalfilter-element sortable input '+(e.globalFilter.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.globalFilter.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: '+soy.$$escapeHtml(e.globalFilter.columnWidth)+'px;"><input class="global-filter text '+(e.globalFilter.inverse?"inverse":"")+'" type="text" style="width: 100%; max-width: none;" value="'+soy.$$escapeHtml(e.globalFilter.defaultValue)+'" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="'+soy.$$escapeHtml(e.globalFilter.columnWidth)+'px"/></div>'+t.crossIcon(null)+"</div>":"",e.hideColumns){l+='<div class="filter-container columnhider-element sortable '+(e.hideColumns.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.hideColumns.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="column-select '+(e.hideColumns.inverse?"inverse":"")+'" style="width: '+soy.$$escapeHtml(e.hideColumns.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(e.hideColumns.columnWidth)+'px">';for(var B=e.hideColumns.options,J=B.length,E=0;E<J;E++){var R=B[E];l+='<option selected="selected"'+("-Empty-"==R?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(R))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}return l+="</div>"},goog.DEBUG&&(t.filters.soyTemplateName="TableFilterTemplate.filters"),t.menu=function(e,t){return'<div id="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="aui-style-default aui-dropdown2 tfac-menu" style="display: none; z-index: 3001;"><div class="aui-dropdown2-section"><ul class="aui-list-truncate first">'+(e.editable&&!e.disableSave?'<li><a class="filter-save cursor-pointer tf-disabled-link"><span class="aui-icon aui-icon-small aui-iconfont-check"></span>'+soy.$$escapeHtml("Save changes")+'<span class="tfac-unsaved">*</span></a></li>':"")+(e.inHeader?'<li><a class="show-filter cursor-pointer" data-filter-type="globalfilter"><span class="aui-icon aui-icon-small aui-iconfont-search"></span>'+soy.$$escapeHtml("Filter whole table")+'</a></li><li><a class="show-filter cursor-pointer" data-filter-type="columnhider"><span class="aui-icon aui-icon-small aui-iconfont-remove-column"></span>'+soy.$$escapeHtml("Hide columns")+"</a></li>":'<li><a class="filter-add cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-add"></span>'+soy.$$escapeHtml("Add filter")+"</a></li>")+'<li><a class="filter-reset cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-cross"></span>'+soy.$$escapeHtml("Reset all filters")+"</a></li>"+(e.inHeader?"":'<li><a class="disableLock cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-plan-disabled"></span>'+soy.$$escapeHtml("Disable all filters")+'</a></li><li><a class="filter-sort-reset cursor-pointer tf-disabled-link"><span class="aui-icon aui-icon-small aui-iconfont-refresh"></span>'+soy.$$escapeHtml("Reset column sorting")+'</a></li><li><a class="tf-change-settings cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-more"></span>'+soy.$$escapeHtml("Modify Settings")+"</a></li>")+'<li><a class="get-tf-url cursor-pointer" '+(e.isCloud?'style="display: none;"':"")+'><span class="aui-icon aui-icon-small aui-iconfont-copy"></span>'+soy.$$escapeHtml("Copy the filter URL")+"</a></li>"+(e.editable?'<li><a class="tf-remove" '+(e.isMacroViewContext?"":'style="display: none;"')+'><span class="aui-icon aui-icon-small aui-iconfont-trash"></span>'+soy.$$escapeHtml("Remove the macro")+"</a></li>":"")+'</ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a class="export-file-pdf cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-pdf"></span>'+soy.$$escapeHtml("Export to PDF")+'</a></li><li><a class="export-file-csv cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-table"></span>'+soy.$$escapeHtml("Export to CSV")+'</a></li><li><a class="export-file-doc cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-document"></span>'+soy.$$escapeHtml("Export to Word")+'</a></li><li><a class="export-file-print cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-activity"></span>'+soy.$$escapeHtml("Print")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+filter+macro?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-document-filled"></span>'+soy.$$escapeHtml("Documentation")+"</a></li><li>"+(e.isCloud?soy.$$filterNoAutoescape(e.courseBtn):'<a target="_blank" href="https://docs.stiltsoft.com/display/public/TFAC/Table+Filter+and+Charts+8.0.0?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-new-help"></span>'+soy.$$escapeHtml("What\u0027s new")+"</a>")+'</li><li><a target="_blank" class="tf-menu-star" href="https://calendly.com/nparamonova/table-filter-and-charts-feedback"><span class="aui-icon aui-icon-small aui-iconfont-star"></span>'+soy.$$escapeHtml("Share feedback")+"</a></li></ul></div></div>"},goog.DEBUG&&(t.menu.soyTemplateName="TableFilterTemplate.menu"),t.fail=function(e,t){return'<div class="tablefilter-outer-wrapper error"><div class="tableFilterCbStyle"><div class="filter-container"><div class="aui-message warning aui-message-warning"><p>'+("no_table"==e.failureCause?soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Filter macro."):"license"==e.failureCause?soy.$$filterNoAutoescape(AJS.format("Table Filter Plugin license is not active, please \u003ca href=\u0022{0}/plugins/servlet/upm#manage/com.stiltsoft.confluence.plugin.tablefilter.tablefilter\u0022\u003egenerate a trial license or purchase\u003c/a\u003e the product.",e.contextPath)):"bad_request"==e.failureCause?soy.$$escapeHtml("Oops! We are sorry but the Table Filter macro cannot be previewed on Confluence page."):"no_params"==e.failureCause?soy.$$escapeHtml("Oops! It seems that the macro body is not reachable as the macro ID parameter is missing."):soy.$$escapeHtml("Oops! We are sorry but the current complex table cannot be filtered."))+'</p></div></div></div><div class="tablefilter-table-wrapper">'+soy.$$filterNoAutoescape(e.body)+"</div></div>"},goog.DEBUG&&(t.fail.soyTemplateName="TableFilterTemplate.fail"),t.crossIcon=function(e,t){return'<span class="aui-icon aui-icon-small aui-iconfont-cross" title="'+soy.$$escapeHtml("Clear filter")+'"></span>'},goog.DEBUG&&(t.crossIcon.soyTemplateName="TableFilterTemplate.crossIcon"),e.exports=t},12240:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});a(42295),a(68268),a(86305),a(75654),a(79150),a(98457),a(84745),a(48868),a(88170),a(46527),a(32323),a(98871),a(47002),a(39684),a(59977),a(16856),a(61986),a(6345),a(91463),a(43028),a(99941),a(67590),a(69223),a(15610),a(54861),a(67285),a(15761);$.fn.tableHeadFixer=function(e){return this.each((function(){t.call(this)}));function t(){var t=$.extend({},{head:!0,foot:!1,left:0,right:0,"z-index":1},e);function a(){if(t.head>0){var e=t.parent.scrollTop();t.table.dataset.scrollTop=e,t.headCells.forEach((function(t){t.style.top="".concat(e,"px")}))}if(t.left>0){var a=t.parent.scrollLeft();t.leftColumns.forEach((function(e){e.style.left="".concat(a,"px")}))}}function l(e,a){for(var l=t.left,r=0;r<l;r++){var s=e.children[r];if(s){var o=s.colSpan>1;o&&(r+=s.colSpan-1),s&&(!o||$(s).position().left+s.clientWidth<i())&&a(s)}}}function i(){return void 0===t.parentWidth&&(t.parentWidth=t.parent.width()),t.parentWidth}t.table=this,t.parent.bind("scroll.tf scroll-tf",a),t.head>0&&function(){for(var e=[],a=t.table.rows,l=0;l<t.head;l++){var i=a[l];if(i){var r=i.children;if(r.length)for(var s=0;s<r.length;s++){var o=r[s];o&&(o.classList.add("tf-floating"),o.classList.add("tf-float-head"),o.style.top=0,e.push(o))}else t.head++}}t.headCells=e}(),t.left>0&&function(){for(var e=t.table,a=[],i=e.rows,r=0;r<i.length;r++)l(i[r],(function(e){e.classList.add("tf-floating"),e.style.left=0,a.push(e)}));t.leftColumns=a}(),function(){if(t.head>0&&t.left>0)for(var e=t.table.rows,a=0;a<t.head;a++){var l=e[a];if(l)for(var i=l.children,r=0;r<t.left;r++)i[r]&&(i[r].style["z-index"]=3)}}(),t.table.dataset.scrollTop&&t.parent.scrollTop(t.table.dataset.scrollTop),$(window).resize(a)}};var l=a(45546),i=a(22166),r=a.n(i),s=a(83931),o=a(24238),n=a(16951),c=a.n(n),d=a(40479),f=a(43924),p=a(99497),u=a(11230),m=a.n(u),h=a(92457),b=a(34138),v=a(94818),g=a(96570),y=a(19805),w={bindEditorDOMChange:e=>{var t,a=null,l=null,i=!1,r=e.tableWrapper.html(),o=!1,n=t=>t.is("table:not(.wysiwyg-macro)")&&-1===e.tables.index(t),c=function(t,a){if(t.is("td")||t.is("th")||(t=t.parents("td, th").eq(0)),(parseInt(t.attr("rowspan"))>1||parseInt(t.attr("colspan"))>1)&&(e.normalizeTable(),e.showOrHideTables()),t.hasClass("tablesorter-header"))e.comboBoxDiv.find("[name]").filterByAttr("name",l).attr("name",a).each((function(){var e=$(this).parents(".filter-container:eq(0)").find("label .tf-label-name");e.text(e.text().replace(l,a))})),e.updateRawTables(!0);else{if(t.length){var i=t[0].parentNode,r=e.tables.index($(i).parents("table").eq(0));if(r>=0){var s=e.rawTables[r][i.rowIndex];s&&(s[t[0].cellIndex]=t.text())}e.setTextForFakeCells(t)}else e.updateRawTables();e.appendTotalRow(),e.appendTotalCol()||(e.tables.trigger("update",!1),e.updateRawTables()),e.appendSparklines(),e.sparkline&&e.fixedRows>0&&e.updateFixedCells()}l=null,e.setFiltrationPanel()},d=function(l,s){if(!(i||e.pauseUpdate||e.sorting||e.resorting||e.editorSave||l.hasClass("tablefilter-pagination")||l.parents(".tablefilter-pagination").length||l.is("br")||l.hasClass("tablesorter-savemyplace")))if(l.is(".tf-numbering")){var d=(0,y.default)(e.editorMacro[0]);e.numbering=d.numbering?d.numbering.toLocaleLowerCase():""}else{if(l.hasClass("fake")){if(l.attr("colspan")||l.attr("rowspan"))return;l.removeClass("fake synchrony-exclude"),l.removeClass(l.getClassStartsWith(/tf-colspan-\d+/)),l.removeClass(l.getClassStartsWith(/tf-rowspan-\d+/)),l.css("display","")}clearTimeout(a);var f=t&&!t.is("td"),p=function(){if(t=null,"DOMNodeInserted"!==s||l.is("table")||0!==l.parents(".confluenceTable").length){var a=e.tableWrapper.html();if(a!=r){r=a;var d=l.is("tr");if(d||l.is("td")||l.is("th")||n(l)||o)o=!1,i=!0,e.getTable(),e.addNumbering(),e.setFiltrationPanel(),d?(e.addToAllowRowList(l),e.filterTable(),e.allowRowList=null):e.filterTable(),l.find("tr").show(),!f&&l.is("td")||l.parents("tr").show(),e.tables.not(".tablesorter").tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat}),l.is(".tablesorter-header")&&l.parents("table").eq(0).tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat}),e.appendTotalRow(),e.appendTotalCol()||e.tables.trigger("update",!1),e.appendSparklines(),n(l)?e.makeTablesScrollable():(e.sparkline&&e.fixedRows>0||l.is("th")||l.is("td")||d)&&e.updateFixedCells(),h.default.create(e,!0),i=!1;else c(l,l.text())}}};if(n(l))p();else{var u=l.is("tr");if(u||l.hasClass("numberingColumn")){if(o=!0,u&&(e.totalCol||e.sparkline||e.numbering)){var m=l.children(),b=m.length-1;w.fixTotalCellClass(e.numbering,m,"tf-numbering",0),b=w.fixTotalCellClass(e.sparkline,m,"tf-sparkline-container",b),w.fixTotalCellClass(e.totalCol,m,"total-col",b)}}else if(!u&&!l.is("th,td")&&0===l.closest(".total-col").length){var v=l.closest("tr");v.hasClass("total-row")&&(v.removeClass("total-row synchrony-exclude"),v.children().removeClass("number").removeAttr("contenteditable"))}a=setTimeout(p,500)}t=l}};e.observerCallback=function(t){t.forEach((function(t){if(t.addedNodes.length)d($(t.addedNodes),"DOMNodeInserted");else if(t.removedNodes.length)d($(t.removedNodes),"DOMNodeRemoved");else if("characterData"==t.type){var i=$(t.target);!function(t,i,s){e.editorSave||e.sorting||e.resorting||(clearTimeout(a),null==l&&(l=i),a=setTimeout((function(){r=e.tableWrapper.html(),c(t,s)}),500))}(i,t.oldValue,i.text())}}))},e.observer=new MutationObserver(e.observerCallback),e.observerParams={childList:!0,subtree:!0,characterData:!0,characterDataOldValue:!0},e.observer.observe(e.tableWrapper[0],e.observerParams),e.observersTd=[],e.tableWrapper.find("td").each((function(){var t=new MutationObserver((function(e){e.forEach((function(e){var a=$(e.target),l=a.hasClass("tf-hidden-column");!l&&s.default.isRowVisible(a.parent()[0])||(t.disconnect(),a.attr(e.attributeName,e.oldValue),l?a.addClass("tf-hidden-column"):a.removeClass("tf-hidden-column"),t.observe(a[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class","data-highlight-colour"]}))}))}));t.observe(this,{attributes:!0,attributeOldValue:!0,attributeFilter:["class","data-highlight-colour"]}),e.observersTd.push(t)})),h.default.create(e,!1)},bindEditorTableResize:e=>{var t="active-resizable";e.tables.each((function(){var e=[];new MutationObserver((function(a){a.forEach((function(a){var l=-1!==a.oldValue.split(" ").indexOf(t),i=a.target.classList.contains(t);l!==i&&(i?(e=[],$(a.target).find(".fake").filter("[colspan],[rowspan]").not(":visible").each((function(){var t=$(this);e.push({fakeCell:t,prevSibling:this.previousElementSibling,parentNode:this.parentNode}),t.detach()}))):e.forEach((e=>{e.prevSibling?$(e.prevSibling).after(e.fakeCell):$(e.parentNode).prepend(e.fakeCell)})))}))})).observe(this,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]})}))},bindEditorPopup:e=>{e.popup.click((function(){return!1}))},storeEditorMacroParams:(e,t)=>{t.column?e.macroParams.column=t.column:delete e.macroParams.column,t.userfilter?e.macroParams.userfilter=t.userfilter:delete e.macroParams.userfilter,t.numberfilter?e.macroParams.numberfilter=t.numberfilter:delete e.macroParams.numberfilter,t.datefilter?e.macroParams.datefilter=t.datefilter:delete e.macroParams.datefilter,t.globalfilter?e.macroParams.globalFilter=t.globalfilter:delete e.macroParams.globalFilter,t.columnhider?e.macroParams.hideColumns=t.columnhider:delete e.macroParams.hideColumns,t.iconfilter?e.macroParams.iconfilter=t.iconfilter:delete e.macroParams.iconfilter,t.width?e.macroParams["cell-width"]=t.width:delete e.macroParams["cell-width"],t.defaults?e.macroParams.default=t.defaults:delete e.macroParams.default,t.inverse?e.macroParams.inverse=t.inverse:delete e.macroParams.inverse,t.datepattern?e.macroParams.datepattern=t.datepattern:delete e.macroParams.datepattern,t.labels?e.macroParams.labels=t.labels:delete e.macroParams.labels,t.ddSeparator?e.macroParams.ddSeparator=t.ddSeparator:delete e.macroParams.ddSeparator,t.ddOperator?e.macroParams.ddOperator=t.ddOperator:delete e.macroParams.ddOperator,e.editorMacro.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(e.macroParams))},fixEditorResizeSensor:e=>{e.tableWrapper.find(".resize-sensor, .resize-sensor-shrink, .resize-sensor-expand").remove()},wrapEditorTable:e=>{e.wrap('<div class="table-wrap editor"></div>')},afterEditorFiltration:e=>{e.editorMacro.data("tf-self",!0),"true"!==e.params.enabledInEditor&&"none"!==e.outerWrapper.css("display")&&e.editorMacro.attr("type",JSON.stringify(e.getFilters())),e.params.enabledInEditor=""},fixEditorCellHighlight:e=>{e.filter("[rowspan]:not(:visible)").attr("rowspan",-1),e.filter("[colspan]:not(:visible)").attr("colspan",-1)},fixTotalCellClass:(e,t,a,l)=>{if(e){var i=t.eq(l--);i.hasClass(a)||i.addClass(a)}return l}},x=w,T=function(e){var t=this;if(d.default.adaptOldParamsTF(e),t.params=e,t.editorMacro=e.editorMacro,t.macroParams=e.macroParams,t.pageId=e.pageId,t.macroId=e.id,t.sessionId=e.sessionId||1,t.params.showNRows=e.showNRowsifNotFiltered,t.numbering=!!e.numbering&&e.numbering.toLocaleLowerCase(),t.dateFormat=(e.datepattern||"yy-mm-dd").replace("yyyy","yy"),t.localeDateFormat=s.default.getLocaleDateFormat(t.dateFormat),t.separator=e.separator,t.fixedRows="true"==e.limitHeight?1:e.limitHeight,t.fixedCols=e.fixedCols,t.heightValue=!!e.heightValue&&parseInt(e.heightValue),t.sorts=e.sorts,t.totalRow=e.totalrow?e.totalrow.split(","):[],t.totalCol=e.totalcol,t.cbState=null,t.allowRowList=null,t.tdNumbers=null,t.tables=null,t.rows=null,t.outerWrapper=$('.tablefilter-outer-wrapper[data-id="'+t.macroId+'"][data-pageid="'+t.pageId+'"][data-sessionid="'+t.sessionId+'"]'),t.tableWrapper=t.editorMacro?t.editorMacro.find(".tablefilter-table-wrapper"):t.outerWrapper.find("div#tf-table-"+t.macroId),t.tableWrapper=s.default.addExcerpt(t.tableWrapper,"tablefilter-table-wrapper").attr("id","tf-table-"+t.macroId).trigger("tf-added","tf-table-"+t.macroId),t.tableWrapper=s.default.addIframe(t.tableWrapper,"tablefilter-table-wrapper",(function(e){t.tableWrapper=e,t.getTable(),t.addNumbering(),t.setFiltrationPanel(),t.tableUpdated=!0,t.filterTable()})),t.previewTutorial=t.outerWrapper.find(".preview-tutorial"),t.comboBoxDiv=t.outerWrapper.find("#comboBoxDiv-".concat(t.macroId,"-").concat(t.sessionId)),t.filterIcon=t.outerWrapper.find(".filter-logo").eq(0),t.lockDisabled=t.comboBoxDiv.find("div.lockDisabled"),t.lockEnabled=t.comboBoxDiv.find("div.lockEnabled"),t.showBtn=t.outerWrapper.children(".tf-shower-wrapper").find(".tf-shower"),t.rawTables=null,t.columns=null,t.locale=s.default.getLocale(),t.hideParamName=t.pageId+"_"+t.macroId+"_hidden",t.menu=t.outerWrapper.find("#filter-menu-view-".concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId,", #filter-menu-view-lock-").concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId)),t.saveBtn=t.menu.find(".filter-save").not("body.content-preview .filter-save"),t.removeBtn=t.menu.find(".tf-remove"),t.resetSortBtn=t.menu.find(".filter-sort-reset"),t.isLockEnabled=e.isLockEnabled,t.tabs=e.tabs,t.worklog=s.default.getWorklog(e.worklog),t.sparkline=e.sparkline,t.sparkName="$sparkName"==e.sparkName?"":e.sparkName,t.isAND="OR"!=e.isOR,t.ddSeparator=e.ddSeparator.split("‚"),t.defaultDDSeparator=1!==t.ddSeparator.length||e.ddSeparators?"":t.ddSeparator[0],t.ddOperator=e.ddOperator.split(","),t.totalRows=[],t.tableUpdated=!0,t.outerWrapper.data("tf",t),t.shouldUpdateSelectOptions=e.updateSelectOptions,t.totalColName=e.totalColName,t.totalRowName=e.totalRowName,t.formatDecimal=r()({mark:t.separator,thousand:e.thousandSeparator!==t.separator?e.thousandSeparator:" "}),t.spakLinesFinished=!0,t.isCloud=t.outerWrapper.hasClass("tf-cloud-macro"),t.isEditor=e.isEditor,t.isPreview=o.default.isPreview(),0==t.tableWrapper.length)return null;t.fixURIHash(),t.orderFilters(e.order),t.getTable(),t.addNumbering(),t.sortTable(),t.appendTotalCol(),t.createSelects(t.comboBoxDiv),t.createDatePickers(t.comboBoxDiv),t.bindInputs(),t.bindReset(),t.bindDisable(),t.bindDOMChange(),t.bindInnerFiltration(),t.bindHideBtn(),t.bindAddFilter(),t.bindChangeSettings(),t.bindSave(),t.bindRemove(),t.bindExport(),t.bindSortReset(),t.bindCopyUrl(),t.bindGetUrlValues(),t.bindMakeInverse(),t.bindChangeLabel(),t.setSelects(),t.setFiltrationPanel(),t.makeSortable(),t.makeResizable(t.comboBoxDiv),t.filterTable(),t.makeTablesScrollable(),t.comboBoxDiv.find("form").bind("keydown",(e=>13!=e.keyCode)),!t.editorMacro&&window.KarmaUser&&t.tables.find("a[data-username]").length&&setTimeout((function(){t.setFiltrationPanel(),t.filterTable()}),1e3)};function C(e){void 0!==this.total?this.total=s.default.multFloats(e,this.total):this.total=e}function S(e){this.total?this.total=s.default.addFloats(e,this.total):this.total=e}function I(e){null!=this.sum?(this.sum=s.default.addFloats(e,this.sum),this.count++):(this.sum=e,this.count=1),this.total=this.sum/this.count}function F(e){null!=this.total?this.total=Math.min(e,this.total):this.total=e}function k(e){null!=this.total?this.total=Math.max(e,this.total):this.total=e}function H(){null!=this.total?this.total++:this.total=1}function A(e){var t=2,a=Math.abs(e);a<1&&a>0&&(t=Math.ceil(Math.log(a)/Math.LN10*-1)+2);var l=Math.pow(10,t);return Math.round(e*l)/l}function D(e){return e.hasClass("selectfilter-element")?"Dropdown Filter":e.hasClass("userfilter-element")?"Free Text Filter":e.hasClass("numberfilter-element")?"Number Filter":e.hasClass("datefilter-element")?"Date Filter":e.hasClass("iconfilter-element")?"Icon Filter":e.hasClass("globalfilter-element")?"Global Filter":e.hasClass("columnhider-element")?"Hide Columns":void 0}function B(e,t){"undefined"!=typeof AP&&AP.resize(e,t)}function J(e){return e.filter(".tf-hidden-column").removeClass("tf-hidden-column"),e.each((function(){if(this.hasAttribute("colspan")){var e=$.data(this,"colspan");e&&(this.colSpan=e)}})),e.filter(".fake").hide()}T.prototype.orderFilters=function(e){if(e){var t=this.comboBoxDiv.find(".sortable-container");t.append(t.find(".iconfilter-element"));for(var a=t.find(".filter-container"),l=e.split(","),i=0;i<l.length;i++)t.append(a.eq($.inArray(i.toString(),l)))}},T.prototype.sortTable=function(){var e=this;function t(){e.sortOneTable($(this))}e.tables.bind("tablesorter-initialized.tf",(function(){var t=$(this),a=s.default.getTablesorterDateFormat(e.dateFormat);a&&t.find("thead th").addClass("dateFormat-"+a),t.append(t.children("div.resize-sensor"));var l=t.data("tablesorter");l&&(l.textSorter=(e,t)=>e.localeCompare(t),l.ignoreCase=!1)})),e.sorts.length&&(e.tables.filter(".pivot-table-result").one("pivot-sorted",t),e.tables.not(".pivot-table-result").one("tablesorter-initialized.tf",t),e.tables.filter(".tablesorter").each(t))},T.prototype.sortTables=function(){var e=this;e.tables.each((function(){e.sortOneTable($(this))}))},T.prototype.sortOneTable=function(e){var t=this;if(t.sorts.length){var a=[];if($.each(t.sorts,(function(l,i){var r=-1===(i=i.replace(" (‍Asc)"," ⇧").replace(" (‍Desc)"," ⇩")).indexOf("⇧")?1:0,o=i.replace("⇧","").replace("⇩","").trim();s.default.getCellPositions(t.rawTables[t.tables.index(e)],o).forEach((function(e){a.push([e,r])}))})),0===a.length)return void t.prepareExport(!0);t.sortWait=!0,t.resorting=!0,t.setMutationObserver(),e.hasClass("pivot-table-result")||t.updateSorter(e),t.restoreNumbering=!0,e.trigger("sorton",[a]),t.resorting=!1,t.resetSortBtn.addClass("tf-disabled-link"),t.setMutationObserver()}},T.prototype.normalizeTable=function(){var e=this;e.pauseUpdate=!0,e.setMutationObserver(!0),s.default.normalizeTable(e.tables,"data-tf-ready"),e.pauseUpdate=!1,e.setMutationObserver(!0),s.default.processMergedCells(e.tables.not(".pivot-table-result"))},T.prototype.addNumbering=function(){var e=this;s.default.hasLoadingContent(e.tableWrapper)||(e.numbering?(e.pauseUpdate=!0,e.setMutationObserver(),e.tables.each((function(t){var a=$(this),l=a.find("tr.pivot-header");if(0===l.find(".tf-numbering").length)for(var i=l.length,r=0;r<i;r++)l.eq(r).prepend('<th class="confluenceTh tf-numbering '.concat(r&&"fake",'" rowspan="').concat(i-r,'"/>'));var o,n=e.rows[t];0==a.find("colgroup col.tfn").length&&(o=a.hasClass("relative-table")?"0.1%":29+8*((""+n.length).length-1)+"px",a.find("colgroup").prepend('<col class="tfn synchrony-exclude" style="width: '+o+'"> '));n.each((function(a){for(var l=$(this),i=this.children,r=null,o=null,c=0;c<i.length;c++)if(!i[c].classList.contains("fake")){r=$(i[c]);break}i[0].classList.contains("tf-numbering")&&(o=$(i[0]));var d=r.attr("class");if(0===a)o?o.attr("contenteditable",!1):("th"===r.prop("tagName").toLowerCase()?l.prepend('<th class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"/>'):l.prepend('<td class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"/>'),e.rawTables[t][a].unshift(""),e.columns=s.default.getColumns(e.rawTables),e.rawIconTables&&e.rawIconTables[t][a].unshift(""));else{var f=-1!==e.numbering.indexOf("desc")?n.length-a:a;o?(o.attr("contenteditable",!1).html("<span>"+f+"</span>"),e.rawTables[t][a][0]=""+f):(l.prepend('<td class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"><span>'+f+"</span></td>"),e.rawTables[t][a].unshift(""+f),e.rawIconTables&&e.rawIconTables[t][a].unshift(""))}})),e.updateSorter(a,!0),a.hasClass("metadata-summary-macro")&&e.tableWrapper.find("ol.aui-nav").eq(t).find("li a[href]").one("mouseup",(function(){e.pauseUpdate=!0,a.find(".tf-numbering").remove(),a[0].config&&a[0].config.headerContent&&a[0].config.headerContent.splice(0,1),a.trigger("updateAll",!1),e.pauseUpdate=!1}))})),e.pauseUpdate=!1,e.setMutationObserver()):(e.tables.each((function(t){var a=$(this).find(".tf-numbering");a.length&&(e.rawTables[t].forEach((e=>e.shift())),a.remove())})),e.tables.find("colgroup col.tfn").remove()))},T.triggerTablesorterUpdateHelper=(e,t)=>{var a=$.tablesorter||$.tablesorterEditor,l=a.restoreHeaders;a.restoreHeaders=function(){};try{t()}catch(e){a.restoreHeaders=l,AJS.log("Error while updating sorting: ",e)}e.one("updateComplete",(function(){a.restoreHeaders=l})),setTimeout((function(){a.restoreHeaders=l}),2e3)},T.prototype.updateSorter=function(e,t){var a=this,l=$.tablesorter||$.tablesorterEditor;if(e.hasClass("pivot-cumulative")&&e.find("thead > tr > th:first-child").addClass("sorter-false"),e.hasClass("pivot-cumulative-recount")){e.trigger("update",!1);var i=e.data("sortBehavior");T.triggerTablesorterUpdateHelper(e,(()=>{e.addClass("pivot-cumulative-refresh"),e.trigger("updateAll",[i,()=>{e.removeClass("pivot-cumulative-refresh"),l.getWidgetById("staticRow").format(e)}])}))}else if(e.hasClass("appfire-table-plus-parms")){if(t&&!a.appFireUpdated&&org_swift_TableSorter&&getTableParms){a.appFireUpdated=!0;var r=new org_swift_TableSorter,s=getTableParms(e);r.customizeMacroTable(e,s.tableParms,s.columnAttributes)}}else if(e.trigger("update",!1),!a.resorting&&!e.hasClass("merged-header")){T.triggerTablesorterUpdateHelper(e,(()=>e.trigger("updateAll",!1)))}},T.prototype.createSelects=function(e){var t=this;e.find("select").change((function(e,a){var l=$(this);a.selected?l.find("option").filter((function(){return this.textContent===a.selected})).prop("selected",!0):a.deselected&&l.find("option").filter((function(){return this.textContent===a.deselected})).prop("selected",!1),t.comboBoxDiv.find(".search-choice").filter((function(){return s.default.clearString(this.textContent)==="-Empty-"})).addClass("tf-empty-option"),t.enableSaveBtn(),t.filterTable(l),t.gaFilterUpdated(this)})).each((function(){var e=$(this);e.data("html")&&e.find("option").each((function(){this.textContent=c().sanitize(this.textContent)})),e.chosenTF({no_results_text:e.data("html")?"No matches found":"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:e.is(".icon-select")?"Select items...":"Click and start typing...",display_selected_options:!1,width:e.data("width"),addUserOption:!e.data("html"),search_contains:!e.data("html"),isHtml:e.data("html")})}))},T.prototype.createDatePickers=function(e){var t=this;AJS.DatePicker.prototype.localisations||(AJS.DatePicker.prototype.localisations=[]),t.datePickerOptions={overrideBrowserDefault:!0,languageCode:t.locale},e.find("input.date").each((function(){var e=$(this),{dateFormat:a,locale:l}=t.getDateFormat(e);s.default.initDatePickerLocalisations(l),t.initDatePicker(e,a,l);var i=e.val();e.val(s.default.convertToDate(i,a,l))}))},T.prototype.bindInputs=function(){var e=this,t=[],a=[];e.comboBoxDiv.delegate("input.user-filter, input.global-filter, input.date, input.number","input keyup",(function(){var l=$(this);clearTimeout(t[l]),clearTimeout(a[l]),t[l]=setTimeout((function(){e.enableSaveBtn(),e.filterTable(l)}),330),a[l]=setTimeout((function(){e.gaFilterUpdated(l)}),2e3)})),e.comboBoxDiv.delegate("input.date","change",(function(){e.enableSaveBtn(),e.filterTable($(this)),e.gaFilterUpdated(this)}))},T.prototype.gaFilterUpdated=function(e){var t=$(e).closest(".filter-container"),a=D(t),l=t.hasClass("inverse")?"inverse":"normal";a&&p.default.filterUpdated(a,l,"Table header"!==this.params.hidePane)},T.prototype.bindReset=function(){var e=this;e.menu.find(".filter-reset").click((function(t){$("body").trigger("filter-options-disable-and-reset",{type:"Reset Filters",pageMode:e.isPreview?"Macro Preview":"Page View"}),p.default.gaTFResetFilters(e.isPreview?"preview":"view"),e.clearFilters(e.comboBoxDiv),e.filterTable(),t.preventDefault()})),e.comboBoxDiv.on("click",".aui-iconfont-cross",(function(){var t=$(this).parent();e.hasFilterValues(t.find("select, input.text"))&&(e.clearFilters(t),e.filterTable())}))},T.prototype.clearFilters=function(e){e.find("input.user-filter, input.global-filter, input.date, input.number").val("");var t=e.find("select");t.find("option:selected").removeAttr("selected"),t.trigger("chosen:updated"),this.enableSaveBtn()},T.prototype.bindDisable=function(){var e=this,t=e.lockEnabled.show().width()+2;e.lockEnabled.hide(),e.comboBoxDiv.find("div.lockDisabled.not-empty").css("min-width",t>270?t:"270px"),e.menu.find(".disableLock").click((function(t){$("body").trigger("filter-options-disable-and-reset",{type:"Disable All Filters",pageMode:e.isPreview?"Macro Preview":"Page View"}),p.default.gaTFDisableFilters(e.isPreview?"preview":"view",!0),e.editorMacro||e.lockEnabled.width(e.lockDisabled.width()),e.lockEnabled.height(e.lockDisabled.height()),e.lockDisabled.hide(),e.lockEnabled.show(),e.isLockEnabled=!0,e.showTableWithoutFilters(),t.preventDefault()})),e.menu.find(".enableLock").click((function(t){p.default.gaTFDisableFilters(e.isPreview?"preview":"view",!1),e.editorMacro||e.lockEnabled.width(""),e.lockDisabled.show(),e.lockEnabled.hide(),e.isLockEnabled=!1,e.filterTable(),t.preventDefault()}))},T.prototype.bindDOMChange=function(){var e=this;if(e.editorMacro)x.bindEditorDOMChange(e);else{var t=null,a=function(a,l){if(e.sorting||e.resorting||e.pauseUpdate)return!0;if(!a.hasClass("tablefilter-pagination")&&!a.parents(".tablefilter-pagination").length&&!s.default.isIgnoreUpdateNode(a)){if((null==l?void 0:l.id)==="tf-table-"+e.macroId||s.default.hasTableForUpdate(a)){function l(){e.getTable(),e.addNumbering()}function i(){e.sortTables(),e.setFiltrationPanel(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.makeTablesScrollable()}if(clearTimeout(t),a.hasClass("tfac-tj")){if(a.closest('.tj-source:not(.table-excerpt)[data-tj-not-ready="false"]').length)return!0;l(),i()}else t=setTimeout((function(){l(),setTimeout(i,1e3)}),50);return!0}return s.default.hasRowForUpdate(a)?(clearTimeout(t),t=setTimeout((function(){e.getTable(),e.addNumbering(),e.setFiltrationPanel(),e.sortTables(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.updateFixedCells()}),10),!0):s.default.hasCharsForUpdate(a,l)||s.default.hasCellUpdate(a)?(clearTimeout(t),t=setTimeout((function(){e.updateRawTables(),e.setFiltrationPanel(),e.filterTable()}),10),!0):void 0}};e.observerCallback=function(e){s.default.mutationObserverFilter(e,a)},e.observer=new MutationObserver(e.observerCallback),e.observerParams={childList:!0,subtree:!0},e.tableWrapper.each((function(){e.observer.observe(this,e.observerParams)})),e.tableWrapper.bind("DOMCharacterDataModified changed.chk",(function(a){s.default.isIgnoreCharacterModified(a)||(clearTimeout(t),t=setTimeout((function(){e.updateRawTables(!0),e.setFiltrationPanel()}),50))})),s.default.bindTaskList(e.tableWrapper,(()=>{e.updateRawTables(),e.setFiltrationPanel(),e.appendTotalRow()})),e.tabs&&s.default.onTabChange(e.tableWrapper,(function(){e.getTable(),e.addNumbering(),e.setFiltrationPanel(),e.sortTables(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.updateFixedCells()})),e.tableWrapper.bind("tf-save",(function(){return e.outerWrapper.trigger("tf-save"),!1}))}},T.prototype.setMutationObserver=function(e){var t=this;if(t.observer)if(t.sorting||t.resorting||t.pauseUpdate)e||(t.prevRowsLength=0,t.rows.forEach((function(e){t.prevRowsLength+=e.length}))),t.observerCallback(t.observer.takeRecords()),t.observer.disconnect();else{if(!e){if(t.observerRestoring)return;t.observerRestoring=!0,t.getTable(!0);var a=0;t.rows.forEach((function(e){a+=e.length})),null!=t.prevRowsLength&&a!=t.prevRowsLength&&(t.prevRowsLength=a,t.tableUpdated=!0,t.setFiltrationPanel(),t.filterTable()),t.observerRestoring=!1}t.tableWrapper.each((function(){t.observer.observe(this,t.observerParams)}))}},T.prototype.processInnerFiltration=function(e,t){var a=this,l=!1;if(e&&e.tf){e.tf.blockEvent=!0,e.tf.filterTable(),e.tf.pauseUpdate=!0,e.tf.setMutationObserver(!0);var i=0;a.numbering&&!e.tf.numbering?i=1:!a.numbering&&e.tf.numbering&&(i=-1),e.tf.tables.each((function(t){var a=e.tf.tables.eq(t);if(e.tf.rows[t].each((function(a){var r=$(this);if(a>e.tf.headerSize[t]&&(e.tf.cbState[t][a-1]||(r.remove(),l=!0)),e.tf.tdNumbers[t].length){var s=$(r[0].children);$.each(e.tf.tdNumbers[t],(function(e,t){s.eq(t+i).remove(),l=!0}))}})),e.tf.tdNumbers[t].length){var r=a.hasClass("relative-table"),s=0,o=$(this).children("colgroup").find("col");$.each(e.tf.tdNumbers[t],(function(e,t){(t+=i)<o.length&&(o.eq(t).remove(),r&&"none"!==o[t].style.display&&(s+=parseFloat(o[t].style.width)))})),s>0&&(a.css("width",parseFloat(a[0].style.width)*(1-s/100)+"%"),o.each((function(a){a-=i,-1===e.tf.tdNumbers[t].indexOf(a)&&(this.style.width=parseFloat(this.style.width)/(1-s/100)+"%")})))}}))}return l&&(e.tf.tables.find(".fake").each((function(){var e=$(this);"none"!==e.css("display")&&e.removeClass("fake")})),s.default.processMergedCells(e.tf.tables,!0)),t&&e&&e.tf&&a.filterTable(),e&&e.tf&&(e.tf.pauseUpdate=!1,e.tf.setMutationObserver(!0),e.tf.blockEvent=!1),l},T.prototype.bindInnerFiltration=function(){var e=this,t=[];e.tableWrapper.find(".pivot-content, .tablefilter-table-wrapper").each((function(){var a=$(this);a.parents("table, .tablefilter-table-wrapper, .pivot-content, .table-joiner").eq(0).is(e.tableWrapper)&&t.push(a.attr("id"))})),t.length&&(e.tableWrapper.bind("tf-filtered pt-calculated",(function(a,l){if(-1!==t.indexOf(l.id)){"tf-filtered"!==a.type&&(e.tableUpdated=!0);var i=e.processInnerFiltration(l,!0);return e.getTable(!0),i&&e.setFiltrationPanel(),l.tf||(e.addNumbering(),(e.fixedRows||e.fixedCols)&&e.makeTablesScrollable(),e.setFiltrationPanel()),e.filterTable(),!1}})),e.tableWrapper.bind("pivot-collapse-change",(function(a,l){if(-1!==t.indexOf(l.id))return e.showOrHideTables(),!1})),e.tableWrapper.bind("pivot-collapse-change pivot-collapsed",(function(){e.addNumbering(),e.appendTotalRow(),e.appendTotalCol()}))),e.tableWrapper.bind("tf-export-ready",(function(t,a){return e.macroId===a.macroId})),e.processInnerFiltration(e.tableWrapper.data("inner-filter"),!1)&&e.getTable(!0)},T.prototype.bindHideBtn=function(){var e=this,t=parseInt(e.outerWrapper.css("margin-top"));e.comboBoxDiv.find(".tf-hider").click((function(){var a=e.tables.eq(0),l=e.comboBoxDiv.outerHeight(!0);e.comboBoxDiv.css({position:"absolute",top:e.comboBoxDiv.position().top-l});var i=a.outerWidth()-2,r={"margin-top":2*t+l+"px"};e.outerWrapper.css(r),e.comboBoxDiv.animate({top:a.position().top,opacity:0,width:i,height:14},{complete:function(){e.comboBoxDiv.hide().css({width:"",height:"",position:""}),r={"margin-top":t+"px"},e.outerWrapper.animate(r,{complete:function(){e.outerWrapper.css("width","")}}),e.showBtn.show().width(i)},duration:300}),o.default.setCookie(e.hideParamName,!0)})),e.showBtn.click((function(){var a=e.tables.eq(0);e.showBtn.hide(),e.comboBoxDiv.show();var l=e.comboBoxDiv.width(),i=e.comboBoxDiv.height(),r=e.comboBoxDiv.outerHeight(!0);e.comboBoxDiv.css({position:"absolute",opacity:0}),e.comboBoxDiv.css({width:a.width()-2,height:14});var s={"margin-top":2*t+r+"px"};e.outerWrapper.animate(s,{complete:function(){e.comboBoxDiv.css({top:0}).animate({top:-r,opacity:1,width:l,height:i},{complete:function(){e.comboBoxDiv.css({position:"",width:"",height:""}),e.outerWrapper.css({"margin-top":t+"px",width:""})},duration:300})}}),o.default.setCookie(e.hideParamName,!1)}))},T.prototype.bindTableEvents=function(){var e=this;if(e.editorMacro)x.bindEditorTableResize(e);else if("Table header"===e.params.hidePane)e.initInlineFilterButton();else{var t=e.tables.eq(0),a=t.data("iframe"),l=e.fixedRows>0?t.parent():t.eq(0);l.unbind("mouseover.tf"+e.macroId).bind("mouseover.tf"+e.macroId,(function(){var t=l.offset(),i=(null==a?void 0:a.offset())||{top:0,left:0};e.showBtn.parent().offset({top:t.top+i.top-14,left:t.left+i.left+l.parent().scrollLeft()}),e.showBtn.css("visibility","visible"),e.showBtn.width(l.outerWidth()-2),e.showBtn.css("max-width",e.outerWrapper.width()-2+"px")})).unbind("mouseout.tf"+e.macroId).bind("mouseout.tf"+e.macroId,(function(){e.showBtn.css("visibility","")}))}e.tables.unbind("sortStart.tfs"+e.macroId).bind("sortStart.tfs"+e.macroId,(function(){e.sorting=!0,e.setMutationObserver()})).unbind("sortEnd.tfs"+e.macroId).bind("sortEnd.tfs"+e.macroId,(function(){if(e.sorting=!1,e.getTable(!0),e.resetSortBtn.removeClass("tf-disabled-link"),e.restoreNumbering?(e.restoreNumbering=!1,e.addNumbering(),e.filterTable()):e.filtered?e.filterContainer(e.getFilterContainers()):e.params.showNRows>0&&!e.isLockEnabled&&e.showOrHideTables(),e.totalRows){var t=e.totalRows[e.tables.index(this)];t&&$(this).append(t)}e.fixedRows>1&&e.updateFixedCells(),e.setMutationObserver(),h.default.create(e)}))},T.prototype.bindAddFilter=function(){var e=this,t=AJS.InlineDialog(e.comboBoxDiv.find(".lockDisabled .filter-settings"),"tf-add-filter-"+e.macroId,(function(t,a,l){t.css({"min-height":"166px"});var i=[],r=e.getFilters(),s=[{type:"selectfilter",name:"Dropdown Filter",desc:"Select from the list of column unique values",columns:[],existing:r.selectfilters},{type:"userfilter",name:"Free Text Filter",desc:"Enter custom text query or regular expression to filter data in the selected column",columns:[],existing:r.userfilters},{type:"numberfilter",name:"Number Filter",desc:"Specify the number range to filter data in the selected column",columns:[],existing:r.numberfilters},{type:"datefilter",name:"Date Filter",desc:"Select the time period to filter dates in the selected column",columns:[],existing:r.datefilters},{type:"iconfilter",name:"Visual Filter",desc:"Select icons, emoticons, images or state of checkboxes from the list of unique column values",columns:[],existing:r.iconfilters}];$.each(s,(function(t,a){$.each(e.columns,(function(e,t){-1==$.inArray(t.replace(/\,/g,"‚"),a.existing)&&a.columns.push(t)})),a.columns.length&&i.push(a)})),t.html(m().addFilterDialog({filters:i,globalfilter:!r.globalfilter,columnhider:!r.columnhider,dateFormat:e.dateFormat})),l()}),{offsetX:-20,width:270,noBind:!0,gravity:"n",initCallback:function(){var t=this,a=t.popup.find(".filter-type"),l=t.popup.find(".date-format-param"),i=l.find(".date-format-input"),r=t.popup.find(".tf-add-filter-column select");r.filter(":not(:first)").parent().hide(),a.change((function(){var e=a.val(),i=r.filter((function(){return"none"!==this.parentNode.style.display})).val();t.popup.find("div.tf-add-filter-column").hide(),t.popup.find("div."+e).show().find("option").filter((function(){return this.textContent==i})).attr("selected","selected"),"datefilter"===e?l.fadeIn():l.fadeOut(),a.attr("title",a.find("option:selected").attr("title"))})),a.trigger("change");var o=new Set;e.comboBoxDiv.find("span.tf-label-name").each((function(){o.add(this.innerText)})),r.change((function(){if(!o.has(this.value)){var t=e.dateFormat,l=e.detectFilterType(this.value);if(l){"datefilter"===l&&(i.val(e.dateFormat),e.dateFormat=t);var r=a.find("option[value=".concat(l,"]"));r.length&&(r.attr("selected","selected"),a.change())}}})),r.first().find("option").each((function(){if(!o.has(this.value))return $(this).attr("selected","selected").parent().trigger("change"),!1})),t.popup.find("#cancel").click((function(){return t.hide(),B(),!1})),t.popup.find("#save").click((function(){$(this).prop("disabled",!0);var l=a.val();return"datefilter"===l&&e.changeSettings(i.val().trim()),e.addFilter(l,t.popup.find("select."+l).val()),t.hide(),$("body").trigger("filter-added-deleted",{action:"Filter Added from Panel",type:l,pageMode:e.isPreview?"Macro Preview":e.editorMacro?"Editor":"Page View"}),p.default.panelFilterAdded(l,"normal"),B(),!1})),s.default.dateFormatAutocomplete(i,t.popup),e.editorMacro&&x.bindEditorPopup(t)},hideCallback:function(){B()}}),a=("Table header"!==e.params.hidePane?e.comboBoxDiv:e.outerWrapper).find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId));a.bind("click",(()=>p.default.menuTFClicked())),e.menu.find(".filter-add").bind("click",(function(l){return"undefined"!=typeof AP&&l.clientY+190>$("body").height()-10&&l.clientY-240<0&&AP.resize("100%",l.clientY+190),t.show(),"false"!=e.menu.attr("aria-hidden")&&void 0===e.menu.attr("open")||a.trigger("aui-button-invoke"),!1})),e.comboBoxDiv.find(".tf-add-start").click((function(t){return e.isCloud?(a.trigger("mousedown",[t]),a.trigger("click")):a.trigger("aui-button-invoke"),e.menu.find(".filter-add").blinkFromClass("active aui-dropdown2-active"),!1}))},T.prototype.addFilter=function(e,t){var a=this,l=$(m().filter({type:e,column:t}));return a.comboBoxDiv.find(".sortable-container").append(l),"selectfilter"===e||"columnhider"===e||"iconfilter"===e?("iconfilter"!==e||a.rawIconTables||a.updateRawIconTables(),a.createSelects(l)):"datefilter"===e&&a.createDatePickers(l),"selectfilter"===e&&l.find("select").data("ddSeparator",a.defaultDDSeparator),a.setFiltrationPanel(),a.makeResizable(l),a.enableSaveBtn(),l},T.prototype.bindChangeSettings=function(){var e=this,t=AJS.InlineDialog(e.outerWrapper.find(".lockDisabled .filter-settings, .filter-logo.floating"),"tf-change-settings-"+e.macroId,(function(t,a,l){t.css({"min-height":"120px"}),t.html(m().changeSettingsDialog({datepattern:e.dateFormat})),l()}),{offsetX:-20,width:270,noBind:!0,gravity:"n",arrowOffsetX:"Table header"!==e.params.hidePane?0:-12,initCallback:function(){var t=this,a=t.popup.find("#tf-cs-dialog-datepattern");s.default.dateFormatAutocomplete(a,t.popup),t.popup.find("#tf-cs-cancel").click((function(){return t.hide(),B(),!1})),t.popup.find("#tf-cs-save").click((function(){return e.changeSettings(a.val()),t.hide(),B(),!1})),e.editorMacro&&x.bindEditorPopup(t)},hideCallback:function(){B()}});e.menu.find(".tf-change-settings").bind("click",(function(a){return t.show(),"false"!=e.menu.attr("aria-hidden")&&void 0===e.menu.attr("open")||e.outerWrapper.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("aui-button-invoke"),!1}))},T.prototype.changeSettings=function(e){var t=this;t.dateFormat!=e&&(t.enableSaveBtn(),t.dateFormat=e,t.updateDateFilters(),t.filterTable())},T.prototype.updateDateFilters=function(){var e=this;e.comboBoxDiv.find("input.date").each((function(){var t=$(this),{dateFormat:a,locale:l}=e.getDateFormat(t),i=t.attr("dateformat");if(a!=i){var r=t.val(),o=null;try{o=s.default.parseDate(r,i,l)}catch(e){}var n=$(t[0].outerHTML);t.replaceWith(n),n.attr("value",null!=o?s.default.formatDate(o,a,l):r),$(".aui-datepicker-dialog").remove(),e.initDatePicker(n,a,l)}}))},T.prototype.initDatePicker=function(e,t,a){var l=this;if(e.attr("dateformat",t),e.attr("locale",a),e.attr("placeholder",t),!t.match(/[iw]/)){l.datePickerOptions.dateFormat=s.default.getDateFormatWithoutTime(t),l.datePickerOptions.languageCode=a;var i=e.datePicker(l.datePickerOptions)}t.toLowerCase().indexOf("hh:mm")>=0?(e.width(120),e.bind("focus click keyup input paste",(function(){setTimeout((function(){i.setDate(s.default.getDateTimeObject(e.val(),t).dateString)}),1)}))):e.width(93)},T.prototype.getDateFormat=function(e){var t=this,a=e.attr("name"),l=t.dateFormat,i=t.locale;return t.getDateMacroFormatIfPresent(a)||{dateFormat:l,locale:i}},T.prototype.getDateMacroFormatIfPresent=function(e){for(var t=this,a=0;a<t.rows.length;a++){var l=s.default.getCellPosition(t.rawTables[a],e);if(null!=l){var i=t.rows[a];if(0===i.parents("#issuetable, .spreadsheets-sheet").length)for(var r=1;r<i.length;r++){var o=i[r].children;if(o.length>l){var n=o[l].getElementsByTagName("time");if(n.length){var c=$(n);if(c.is('[data-macro-name="page-info"]'))break;var d=[t.localeDateFormat,t.dateFormat];return t.isCloud&&"es_ES"===t.locale?function(){-1==d.indexOf("dd M yy")&&d.push("dd M yy");var e=[];d.forEach((t=>-1!==t.indexOf("M")&&e.push(t.replace("M","M.")))),d=d.concat(e)}():-1==d.indexOf("dd.mm.yy")&&d.unshift("dd.mm.yy"),s.default.getDateMacroDateFormat(c,t.locale,d)}}}}}},T.prototype.bindSave=function(){var e=this;e.saveBtn.click((function(t){var a=e.saveBtn;if(!a.hasClass("tf-disabled-link")){p.default.gaTFSaveChanges(),$("body").trigger("filter-options-save"),e.params.liveMode&&(p.default.gaTFInsert("TF Saved in Live Mode",e.tables.length),e.params.liveMode=!1);var l=e.getFilters(),i={pageId:e.pageId,id:e.macroId,defaults:l.defaults.join(","),width:l.width.join(","),inverse:l.inverse.join(","),order:l.order.join(","),labels:e.getFilterLabels(),ddSeparator:e.defaultDDSeparator?e.defaultDDSeparator:l.ddSeparator.join("‚"),ddOperator:l.ddOperator.join(","),datepattern:e.dateFormat,hidePane:e.params.hidePane};i.ddSeparator=i.ddSeparator.replace(/ /g,"\\u0020");var r=function(e){for(var t=[],a=0;a<e.length;a++)""==e[a]?t.push("‌"):t.push(e[a]);return t.join(",")};l.selectfilters.length&&(i.column=r(l.selectfilters)),l.userfilters.length&&(i.userfilter=r(l.userfilters)),l.numberfilters.length&&(i.numberfilter=r(l.numberfilters)),l.datefilters.length&&(i.datefilter=r(l.datefilters)),l.iconfilters.length&&(i.iconfilter=r(l.iconfilters)),l.globalfilter&&(i.globalfilter="true"),l.columnhider&&(i.columnhider="true");var s=function(){a.addClass("tf-disabled-link"),e.outerWrapper.add(a).find(".tfac-unsaved").hide(),e.filterIcon.removeClass("unsaved"),e.removeBtn.css("display","")};e.editorMacro?(x.storeEditorMacroParams(e,i),s()):(o.default.saveMacroParams(i,e.outerWrapper),s(),e.tableWrapper.trigger("tf-save")),t.preventDefault()}}))},T.prototype.bindRemove=function(){var e=this;e.removeBtn.click((function(t){t.preventDefault(),s.default.createDialogRemoveMacro(e,"Table Filter","Table Filter")}))},T.prototype.bindExport=function(){var e=this;void 0===l.saveAs?(e.menu.find(".export-file-pdf").hide(),e.menu.find(".export-file-doc").hide(),e.menu.find(".export-file-csv").hide(),e.menu.find(".export-file-print").hide()):(e.menu.find(".export-file-pdf").bind("click",(function(t){o.default.loadScriptsBeforeExport((function(){s.default.exportToPdf(e.tableWrapper)})),t.preventDefault()})),e.menu.find(".export-file-doc").bind("click",(function(t){s.default.exportToDoc(e.tableWrapper),t.preventDefault()})),e.menu.find(".export-file-print").bind("click",(function(t){s.default.browserPrint(e.tableWrapper),t.preventDefault()})),e.menu.find(".export-file-csv").click((function(t){s.default.createDialog(e.tables,e.rows[0],e.macroId),t.preventDefault()})))},T.prototype.bindSortReset=function(){var e=this;e.resetSortBtn.bind("click",(function(t){p.default.qaResetColumnSorting(),t.preventDefault(),e.resetSortBtn.hasClass("tf-disabled-link")||(e.sorts.length?e.sortTables():e.tables.trigger("sorton",[[]]),e.resetSortBtn.addClass("tf-disabled-link"))}))},T.prototype.bindCopyUrl=function(){var e=this;e.menu.find(".get-tf-url").bind("click",(function(t){var a=e.getFilters();a.sorts=[],e.tables.each((function(t){this.config&&this.config.sortList&&this.config.sortList.forEach((function(l){var i=0===l[1]?"⇧":"⇩";a.sorts.push(e.rawTables[t][0][l[0]]+" "+i)}))}));var l=window.location.hash,i=window.location.href.replace(l,""),r=$.getUrlHashVar("tf-filters");if(r){var s="tf-filters="+encodeURIComponent(r);l=(l=l.replace("&"+s,"")).replace("#"+s,"")}i=i+l+(l?"&":"#");var o=$("<span></span>");$("body").append(o),o.text(i+"tf-filters="+encodeURIComponent(JSON.stringify(a)));var n=document.createRange();n.selectNode(o[0]);var c=window.getSelection();c.removeAllRanges(),c.addRange(n),document.execCommand("copy"),o.remove(),t.preventDefault(),p.default.gaTFCopyFilterURL()}))},T.prototype.bindGetUrlValues=function(){var e=this,t=function(){var t=$.getUrlHashVar("tf-filters");if(t){var a=JSON.parse(t);e.setFilters(a),p.default.gaTFApplyFilterURL()}};$(window).bind("hashchange",t),$(".tablefilter-table-wrapper").one("tf-filtered",t)},T.prototype.setFilters=function(e){var t=this,a=function(e,t){e?(t.addClass("inverse"),t.parents(".filter-container:eq(0)").addClass("inverse")):(t.removeClass("inverse"),t.parents(".filter-container:eq(0)").removeClass("inverse"))},l=function(e,t){return e.filterByAttr("name",t)};s.default.i18nFilterValues(e.defaults);var i=0;(t.clearFilters(t.comboBoxDiv),e.selectfilters.forEach((function(r){r=r.replace(/\‚/g,",");var o=l(t.comboBoxDiv.find("select.select"),r);0==o.length&&(o=t.addFilter("selectfilter",r).find("select")),a(e.inverse[i],o);var n=e.defaults[i++].replace(/\‚/g,","),c=s.default.clearStringLowerCase(n).split("&&");n=n.split("&&");var d=[];o.find("option:selected").prop("selected",!1),o.find("option").each((function(){var e=$(this),t=$.inArray(s.default.clearStringLowerCase(e[0].textContent),c);-1!=t&&(e.prop("selected",!0),d.push(t))})),n.forEach((function(e,t){e&&-1==$.inArray(t,d)&&o.append($('<option selected="selected"></option>').text(e))})),o.trigger("chosen:updated")})),e.userfilters.forEach((function(r){r=r.replace(/\‚/g,",");var s=l(t.comboBoxDiv.find("input.user-filter"),r);0==s.length&&(s=t.addFilter("userfilter",r).find("input")),a(e.inverse[i],s),s.val(e.defaults[i++].replace(/\‚/g,","))})),e.numberfilters.forEach((function(r){r=r.replace(/\‚/g,",");var s=l(t.comboBoxDiv.find("input.number.from"),r);0==s.length&&(s=t.addFilter("numberfilter",r).find("input.from"));var o=l(t.comboBoxDiv.find("input.number.to"),r);a(e.inverse[i],s),a(e.inverse[i],o);var n=e.defaults[i++].replace(/\‚/g,",").split("->");s.val(n[0]),o.val(n[1])})),e.datefilters.forEach((function(r){r=r.replace(/\‚/g,",");var o=l(t.comboBoxDiv.find("input.date.from"),r);0==o.length&&(o=t.addFilter("datefilter",r).find("input.from"));var n=l(t.comboBoxDiv.find("input.date.to"),r);a(e.inverse[i],o),a(e.inverse[i],n);var c=e.defaults[i++].replace(/\‚/g,",").split("->");o.val(s.default.convertToDate(c[0],o.attr("dateformat"),o.attr("locale"))),n.val(s.default.convertToDate(c[1],n.attr("dateformat"),o.attr("locale")))})),e.globalfilter)&&(0==(r=t.comboBoxDiv.find("input.global-filter")).length&&(r=t.addFilter("globalfilter","").find("input")),a(e.inverse[i],r),r.val(e.defaults[i++].replace(/\‚/g,",")));if(e.columnhider){var r;0==(r=t.comboBoxDiv.find("select.column-select")).length&&(r=t.addFilter("columnhider","").find("select")),a(e.inverse[i],r);var o=e.defaults[i++].replace(/\‚/g,","),n=s.default.clearStringLowerCase(o).split("&&");o=o.split("&&");var c=[];r.find("option:selected").prop("selected",!1),r.find("option").each((function(){var e=$(this),t=$.inArray(s.default.clearStringLowerCase(e.text()),n);-1!=t&&(e.prop("selected",!0),c.push(t))})),o.forEach((function(e,t){e&&-1==$.inArray(t,c)&&r.append($('<option selected="selected"></option>').text(e))})),r.trigger("chosen:updated")}e.iconfilters.forEach((function(r){r=r.replace(/\‚/g,",");var o=l(t.comboBoxDiv.find("select.icon-select"),r);0==o.length&&(o=t.addFilter("iconfilter",r).find("select")),a(e.inverse[i],o);var n=s.default.clearStringLowerCase(e.defaults[i++].replace(/\‚/g,",")).split("&&");o.find("option:selected").prop("selected",!1),o.find("option").each((function(){var e=$(this);-1!=$.inArray(s.default.clearStringLowerCase(e[0].textContent),n)&&e.prop("selected",!0)})),o.trigger("chosen:updated")})),e.sorts&&(t.sorts=e.sorts,t.sortTables()),t.filterTable()},T.prototype.fixURIHash=function(){var e=$.getUrlHashVar("tf-filters");if(e){var t=location.hash,a=location.hash.replace("&tf-filters="+encodeURIComponent(e),"");t!=a&&(location.hash=a,location.hash=t)}},T.prototype.bindMakeInverse=function(){var e=this;e.comboBoxDiv.delegate(".eq","click",(function(){var t=$(this).parents(".filter-container:eq(0)");t.addClass("inverse");var a=t.find("input, select").addClass("inverse");e.gaFilterUpdated(a),$("body").trigger("filter-inverse-direct",{type:D(t),pageMode:e.isPreview?"Macro Preview":"Page View",filterMode:"Inverse"}),e.enableSaveBtn(),e.filterTable(a)})),e.comboBoxDiv.delegate(".not-eq","click",(function(){var t=$(this).parents(".filter-container:eq(0)");t.removeClass("inverse");var a=t.find("input, select").removeClass("inverse");e.gaFilterUpdated(a),$("body").trigger("filter-inverse-direct",{type:D(t),pageMode:$("body").find("div#macro-browser-preview").length?"Macro Preview":"Page View",filterMode:"Normal"}),e.enableSaveBtn(),e.filterTable(a)}))},T.prototype.setFiltrationPanel=function(){var e=this,t=e.columns.map((function(e){return e.toLocaleLowerCase()})),a=e.comboBoxDiv.find("select.select, input.user-filter, div.range, select.icon-select"),l=[];a.each((function(){var a=$(this),i=a.closest(".filter-container"),r=a.attr("name"),o=[r];s.default.updateI18nSettings([e.columns],[o],e.locale,e.tableWrapper);var n=a.attr("class")+o[0];if(-1===$.inArray(s.default.clearStringLowerCase(o[0]),t)||-1!==l.indexOf(n))i[0].style.display="none";else if(l.push(n),i[0].style.display="block",r!==o[0]){a.attr("name",o[0]),a.find("input").attr("name",o[0]);var c=a.parents(".filter-container").find(".tf-label-name");c.text().trim()===r&&c.text(o[0])}})),e.setSelectOptions();var i=e.comboBoxDiv.find("select.column-select");i.find("option:not(:selected)").remove();var r=[];i.find("option").each((function(){var t;if($(this).hasClass("tf-empty-option"))t="";else{var a=[t=s.default.clearString(this.textContent)];s.default.updateI18nSettings([e.columns],[a],e.locale,e.tableWrapper),a[0]!==t&&(t=a[0],this.textContent=t)}r.push(t)})),$.each(e.columns,(function(e,t){if(-1==$.inArray(t,r)){var a="",l=t;""==t&&(a=' class="tf-empty-option"',l="-Empty-"),i.append($("<option"+a+"></option>").text(l))}})),i.trigger("chosen:updated"),e.comboBoxDiv.find(".search-choice").filter((function(){return s.default.clearString(this.textContent)=="-Empty-"})).addClass("tf-empty-option"),e.updateDateFilters();var n=a.filter((function(){return"none"!=$(this).parent().css("display")})).length>0||i.length>0||e.comboBoxDiv.find(".global-filter").length>0,c=e.params.showNRows>=0;if(0==e.rawTables.length)e.isEditor&&e.isCloud&&!e.tableWrapper.data("hasFrame")?(e.previewTutorial.show(),e.comboBoxDiv.hide()):(e.previewTutorial.hide(),e.comboBoxDiv.show(),e.tableWrapper.data("hasFrame")||s.default.hasLoadingContent(e.tableWrapper)?(e.comboBoxDiv.find(".waiting-for-table").show(),e.comboBoxDiv.find(".no-table-message").hide()):(e.comboBoxDiv.find(".no-table-message").show(),e.comboBoxDiv.find(".waiting-for-table").hide()),e.comboBoxDiv.find(".empty-message").hide(),e.lockDisabled.hide(),e.lockEnabled.hide(),e.outerWrapper.addClass("no-table"),e.comboBoxDiv.find(".tf-hider-wrapper").hide());else if(e.previewTutorial.hide(),e.comboBoxDiv.find(".tf-hider-wrapper").show(),e.outerWrapper.removeClass("no-table"),e.comboBoxDiv.find(".no-table-message").hide(),e.comboBoxDiv.find(".waiting-for-table").hide(),e.isLockEnabled=e.isLockEnabled&&(n||c),e.isLockEnabled?(e.lockDisabled.hide(),e.lockEnabled.show()):(e.lockDisabled.show(),e.lockEnabled.hide()),n||c||!(e.numbering||e.fixedRows||e.sorts.length||e.sparkline||e.fixedCols||e.totalRow.join("")||e.totalCol)?e.editorMacro||"true"!=o.default.getCookie(e.hideParamName)?(e.comboBoxDiv.show(),e.showBtn.hide()):(e.comboBoxDiv.hide(),e.showBtn.show()):e.editorMacro||(e.comboBoxDiv.hide(),e.showBtn.show()),!n&&c?(e.menu.find(".disableLock").show(),e.comboBoxDiv.find(".show-n-rows-only-message").show()):e.comboBoxDiv.find(".show-n-rows-only-message").hide(),n||c){e.comboBoxDiv.find(".filter-buttons-container").show(),e.comboBoxDiv.find(".empty-message").hide(),e.lockDisabled.addClass("not-empty").removeClass("empty");var d=e.outerWrapper.css("display");e.outerWrapper.show();var f=e.comboBoxDiv.css("display");if(e.comboBoxDiv.show(),!e.editorMacro){e.lockEnabled.css("width","").css("display","inline-flex");var p=Math.max(302,Math.ceil(e.lockEnabled.show().width())+1);e.lockDisabled.css("min-width",p+"px")}e.lockDisabled.show(),e.editorMacro||e.lockEnabled.width(Math.max(302,Math.ceil(e.lockDisabled.width()))),e.lockEnabled.height(Math.max(40,e.lockDisabled.height())),e.comboBoxDiv.css("display",f),e.outerWrapper.css("display",d),e.lockEnabled.css("display","block"),e.isLockEnabled?e.lockDisabled.hide():e.lockEnabled.hide()}else e.lockDisabled.addClass("empty").removeClass("not-empty").css("min-width",""),e.comboBoxDiv.find(".filter-buttons-container").show(),e.comboBoxDiv.find(".empty-message").show();e.outerWrapper.css("visibility","visible")},T.prototype.setSelects=function(){var e=this;e.comboBoxDiv.find("select.select, select.icon-select").each((function(t){var a=e.ddOperator.length>t?e.ddOperator[t]:"OR";$(this).data("ddOperator",a)})),e.comboBoxDiv.find("select.select").each((function(t){var a=e.ddSeparator.length>t?e.ddSeparator[t]:e.defaultDDSeparator;$(this).data("ddSeparator",a)}))},T.prototype.setSelectOptions=function(){var e=this,t=e.comboBoxDiv.find("select.select, select.icon-select").filter((function(){return"none"!=$(this).parent().css("display")}));if(t.find("option:not(:selected)").remove(),e.shouldUpdateSelectOptions)var a=e.getFilterContainers().not(".columnhider-element");t.each((function(){var t=$(this),l=t.attr("name").toLocaleLowerCase(),i=t.data("html"),r=!0,o=[],n=[];t.find("option").each((function(){if(i){var e=this.textContent;if(e!="-Empty-"){var t=$(e);t.is("img")&&(e=t[0].src,e=s.default.clearIconSrc(e))}else n.push("");n.push(e.toLocaleLowerCase())}else n.push($(this).hasClass("tf-empty-option")?"":s.default.clearStringLowerCase(this.textContent))}));var d=i?"":t.data("ddSeparator");$.each(e.rawTables,(function(f,p){var u=s.default.getCellPositions(p,l);if(e.shouldUpdateSelectOptions&&p.length){for(var m=new Array(p.length-1),h=0;h<m.length;h++)m[h]=!0;a.not(t.parent()).each((function(){var t=$(this).data("state");if(t&&t[f])for(var a=0;a<t[f].length;a++)e.isAND?m[a]=m[a]&&t[f][a]:m[a]=m[a]&&!t[f][a]}))}u.forEach((function(t){if($.each(i?e.rawIconTables[f]:p,(function(e,a){if(0!=e&&(!m||m[e-1])){var l=a[t];if(null==l)return;if(i&&l){var f=$(l);f.filter("img").each((function(){l=s.default.clearStringLowerCase(this.src),l=s.default.clearIconSrc(l),-1==$.inArray(l,n)&&(n.push(l),o.push(c().sanitize(this.outerHTML)))})),f.filter("ul").length&&r&&(r=!1,-1==$.inArray('<ul class="inline-task-list"><li></li></ul>',n)&&(o.push('<ul class="inline-task-list"><li></li></ul>'),n.push('<ul class="inline-task-list"><li></li></ul>')),-1==$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',n)&&(o.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),n.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else d&&""!=l?l.split(d).forEach((function(e){(e=e.trim())&&(l=s.default.clearStringLowerCase(e),-1==$.inArray(l,n)&&(n.push(l),o.push(e)))})):(l=s.default.clearStringLowerCase(l),-1==$.inArray(l,n)&&(n.push(l),o.push(a[t])))}})),!i&&-1==$.inArray("@currentuser",n)){var a=e.tables.eq(f),l=!1;if(e.rows[f].length>1&&a.hasClass("tasks-report")&&s.default.getNthTdElem(e.rows[f][1],t).hasClass("tasks-report-assignee"))l=!0;else if(t++,a.find(".confluence-userlink").length){var u=a.find("tr td:nth-child("+t+"), tr th:nth-child("+t+")").find(".confluence-userlink").eq(0);u.length&&u.parents("td").eq(0).text().trim()==u.text().trim()&&(l=!0)}l&&(n.push("@currentuser"),o.push("@currentUser"))}}))})),o.sort(((e,t)=>e.localeCompare(t)));var f="";$.each(o,(function(e,t){var a="",l=t;""==t&&(a=' class="tf-empty-option"',l="-Empty-"),f+=$("<option"+a+"></option>").text(l)[0].outerHTML})),t.append(f),t.trigger("chosen:updated")}))},T.prototype.makeSortable=function(){var e=this;-1===["Table header","true"].indexOf(e.params.hidePane)&&e.comboBoxDiv.find(".sortable-container").sortable({cancel:"input,textarea,button,select,option,.chosen-drop",scroll:!1,items:".sortable",start:function(e,t){t.item.width(Math.ceil(t.item.width())+1)},sort:function(t,a){e.highlightRemoveFilter(a.offset,a.helper)},beforeStop:function(t,a){e.enableSaveBtn(),e.removeFilter(a.offset,a.item)},update:function(t,a){$("body").trigger("filter-reordered",{type:D(a.item),pageMode:e.isPreview?"Macro Preview":"Page View"})}})},T.prototype.makeResizable=function(e){var t=this;if(0==$("body.content-preview").length){var a=e.find(".chosen-container, div.tf-resizeable");a.length>0&&a.resizable({handles:"e",resize:function(e,a){a.element.hasClass("chosen-container")?a.element.parent().find("select").attr("data-width",a.size.width):a.element.find("input").attr("data-width",a.size.width),t.enableSaveBtn()}})}},T.prototype.makeTablesScrollable=function(){var e=this;s.default.hasLoadingContent(e.tableWrapper)||(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.find(".tf-fixed-column-border").remove(),e.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.fh scroll-tf"),e.tables.find("td.tf-floating,th.tf-floating").removeClass("tf-floating").removeClass("tf-float-head").css({top:"",left:""}),e.tableWrapper.find(e.editorMacro?".table-wrap.tf-fixed-rows":".table-wrap.editor, .table-wrap-aui").each((function(){var e=$(this);e.before(e.children("table, .table-wrap")),e.remove()})),e.tableWrapper.removeClass("fixed"),e.editorMacro&&x.fixEditorResizeSensor(e),e.fixColumns(),e.pauseUpdate=!1,e.setMutationObserver(!0))},T.prototype.fixColumns=function(){var e=this;if(e.fixedCols>0&&!e.editorMacro||e.fixedRows>0){var t=window.navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)||/Edge/.test(navigator.userAgent);e.tables.each((function(a){var l=$(this);e.editorMacro?x.wrapEditorTable(l):e.fixedRows>0&&l.hasClass("aui")?l.wrap('<div class="table-wrap-aui"></div>'):0==l.parents(".table-wrap").length&&l.wrap('<div class="table-wrap"></div>');var i=l.parents(".table-wrap, .table-wrap-aui").eq(0);if(i.addClass("tf-fixed"),t&&i.addClass("ie"),l.find(".tableFloatingHeader").remove(),e.fixedRows>0){var r=e.rows[a].length>e.fixedRows?2*(e.rows[a].eq(e.fixedRows).offset().top-l.offset().top):l.height(),s=e.heightValue?e.heightValue:Math.floor(.7*window.innerHeight)||600;i.css("max-height",Math.max(r,s)+"px"),i.addClass("tf-fixed-rows")}l.tableHeadFixer({left:e.editorMacro?0:e.fixedCols,head:parseInt(e.fixedRows)+l.find("tr.tf-header-hidden").length,parent:i})})),e.tableWrapper.addClass("fixed")}},T.prototype.updateFixedCells=function(){var e=this;(e.fixedCols>0&&!e.editorMacro||e.fixedRows>0)&&(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.tf scroll-tf"),e.tables.find("td.tf-floating,th.tf-floating").removeClass("tf-floating").css({top:"",left:""}),e.tables.each((function(){var t=$(this),a=t.parents(".table-wrap, .table-wrap-aui").eq(0);t.tableHeadFixer({left:e.editorMacro?0:e.fixedCols,head:parseInt(e.fixedRows)+t.find("tr.tf-header-hidden").length,parent:a})})),e.pauseUpdate=!1,e.setMutationObserver(!0))},T.prototype.enableSaveBtn=function(){this.saveBtn.removeClass("tf-disabled-link"),this.outerWrapper.add(this.saveBtn).find(".tfac-unsaved").show(),this.filterIcon.addClass("unsaved")},T.prototype.shouldRemoveFilter=function(e){var t=this,a=t.comboBoxDiv.offset(),l=a.left+t.comboBoxDiv.width()+10,i=a.left-10,r=a.top+t.comboBoxDiv.height()-10,s=a.top-20;return e.top<s||e.top>r||e.left>l||e.left<i},T.prototype.removeFilter=function(e,t){var a=this;if(a.outerWrapper.click(),a.shouldRemoveFilter(e)){t.remove();var l=D(t);p.default.panelFilterDeleted(l),$("body").trigger("filter-added-deleted",{action:"Filter Deleted",type:l,pageMode:a.isPreview?"Macro Preview":"Page View"}),setTimeout((function(){a.filterTable(),a.setFiltrationPanel()}),500)}else t.removeClass("filter-removing")},T.prototype.highlightRemoveFilter=function(e,t){this.shouldRemoveFilter(e)?t.addClass("filter-removing"):t.removeClass("filter-removing")},T.prototype.getFilters=function(){var e=this,t={selectfilters:[],userfilters:[],numberfilters:[],datefilters:[],globalfilter:e.comboBoxDiv.find("input.global-filter"),columnhider:e.comboBoxDiv.find("select.column-select"),iconfilters:[],defaults:[],width:[],inverse:[],order:[],ddSeparator:[],ddOperator:[]},a=e.comboBoxDiv.find(".sortable-container .filter-container");if(e.comboBoxDiv.find("select.select").each((function(){var e=[],l=$(this);t.selectfilters.push(l.attr("name").replace(/\,/g,"‚")),t.width.push(l.attr("data-width").replace("px","")),l.find("option:selected").each((function(){e.push(this.textContent.replace(/\,/g,"‚"))})),t.defaults.push(e.join("&&")),t.inverse.push(l.hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container"))),t.ddSeparator.push(l.data("ddSeparator")),t.ddOperator.push(l.data("ddOperator"))})),e.comboBoxDiv.find("input.user-filter").each((function(){var e=$(this);t.userfilters.push(e.attr("name").replace(/\,/g,"‚")),t.width.push(e.attr("data-width").replace("px","")),t.defaults.push(e.val().replace(/\,/g,"‚")),t.inverse.push(e.hasClass("inverse")),t.order.push(a.index(e.parents(".filter-container")))})),e.comboBoxDiv.find(".range.numbers").each((function(){var e=[],l=$(this);t.numberfilters.push(l.attr("name").replace(/\,/g,"‚")),l.find("input.number").each((function(){e.push($(this).val().replace(/\,/g,"‚"))})),t.defaults.push(e.join("->")),t.inverse.push(l.parent().hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),e.comboBoxDiv.find(".range.dates").each((function(){var e=[],l=$(this);t.datefilters.push(l.attr("name").replace(/\,/g,"‚")),l.find("input.date").each((function(){var t=$(this),a=t.val();e.push(s.default.dateToUTCTimestamp(a,t.attr("dateformat"),t.attr("locale")))})),t.defaults.push(e.join("->")),t.inverse.push(l.parent().hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),t.globalfilter.length?(t.defaults.push(t.globalfilter.val().replace(/\,/g,"‚")),t.width.push(t.globalfilter.attr("data-width").replace("px","")),t.inverse.push(t.globalfilter.hasClass("inverse")),t.order.push(a.index(t.globalfilter.parents(".filter-container"))),t.globalfilter=!0):t.globalfilter=!1,t.columnhider.length){var l=[];t.columnhider.find("option:selected").each((function(){l.push(this.textContent.replace(/\,/g,"‚"))})),t.defaults.push(l.join("&&")),t.width.push(t.columnhider.attr("data-width").replace("px","")),t.inverse.push(t.columnhider.hasClass("inverse")),t.order.push(a.index(t.columnhider.parents(".filter-container"))),t.columnhider=!0}else t.columnhider=!1;return e.comboBoxDiv.find("select.icon-select").each((function(){var e=[],l=$(this);t.iconfilters.push(l.attr("name").replace(/\,/g,"‚")),t.width.push(l.attr("data-width").replace("px","")),l.find("option:selected").each((function(){e.push(this.textContent.replace(/\,/g,"‚"))})),t.defaults.push(e.join("&&")),t.inverse.push(l.hasClass("inverse")),t.ddOperator.push(l.data("ddOperator")),t.order.push(a.index(l.parents(".filter-container")))})),s.default.unI18nFilterValues(t.defaults),t},T.prototype.getTable=function(e){var t=this,a=t.tabs&&s.default.hasTabs(t.tableWrapper);t.tables=s.default.getTableNodes(t.tableWrapper,t.editorMacro?"table.confluenceTable":"table").filter((function(){var e=$(this);if(a&&s.default.hasInactiveTab(e))return!1;var l=e.parents("table:not(.wysiwyg-macro), .tablefilter-table-wrapper");return l.eq(0).is(t.tableWrapper)||l.eq(0).is(".tablefilter-table-wrapper")&&l.eq(1).is(t.tableWrapper)})),e||t.normalizeTable(),t.rows=[],t.headerSize=[],t.tables.each((function(){var e=s.default.getRows(this);t.rows.push(e),t.headerSize.push(s.default.getMaxRowspan($(e[0])))})),t.updateRawTables(),s.default.setPaginationMsg(t.tableWrapper),e||t.bindTableEvents()},T.prototype.updateRawTables=function(e){var t=this;t.rawTables=s.default.getTablesRowsValues(t.rows,t.editorMacro?s.default.editorType:s.default.textType),e||(t.rawIconTables=null,(t.comboBoxDiv.find("select.icon-select").length||-1!==t.totalRow.indexOf("Count not empty"))&&t.updateRawIconTables()),t.columns=s.default.getColumns(t.rawTables)},T.prototype.updateRawIconTables=function(){this.rawIconTables=s.default.getTablesRowsValues(this.rows,s.default.visualType)},T.prototype.filterTable=function(e){var t=this;if(!s.default.hasLoadingContent(t.tableWrapper)){if(t.isLockEnabled)return t.appendTotalRow(),t.appendTotalCol(),t.appendSparklines(),t.setTablesReady(),void t.prepareExport();var a=t.getFilterContainers();e?t.filterContainer(e.parents(".filter-container.sortable")):t.filterContainer(a),t.showTable(t.isAND),t.filtered=!1,a.not(".columnhider-element").each((function(){var e=$(this);t.filtered=t.filtered||e.data("filtered");var a=e.data("state");if(a)for(var l=0;l<a.length;l++)for(var i=0;i<a[l].length;i++)t.isAND?t.cbState[l][i]=t.cbState[l][i]&&a[l][i]:t.cbState[l][i]=t.cbState[l][i]||a[l][i];t.correctionWithAllowRowList()})),t.filtered||t.isAND||t.showTable(!0);var l=a.filter(".columnhider-element").data("state");l&&l.length&&(t.tdNumbers=l),t.setTablesReady(),t.showOrHideTables(),t.appendTotalRow(),(t.updateSparkline||t.tableUpdated)&&(t.rows[0]&&!t.rows[0].eq(0).find(".total-col.tf-hidden-column").length&&t.appendTotalCol(),t.appendSparklines(),t.updateSparkline=!1,t.tableUpdated=!1,t.sparkline&&t.fixedRows>0&&t.updateFixedCells()),t.blockEvent||t.tableWrapper.trigger("tf-filtered-total",t.getEventData()),t.shouldUpdateSelectOptions&&t.setSelectOptions(),t.filtered||l&&l.length?(t.menu.find(".filter-reset").removeClass("tf-disabled-link"),t.menu.find(".disableLock").removeClass("tf-disabled-link")):(t.menu.find(".filter-reset").addClass("tf-disabled-link"),t.params.showNRows>=0||t.menu.find(".disableLock").addClass("tf-disabled-link")),t.prepareExport(),t.editorMacro&&x.afterEditorFiltration(t),h.default.create(t,t.editorMacro)}},T.prototype.prepareExport=function(e){var t=this;t.sortWait=t.sortWait||!t.sorts.length||e,t.blockEvent||s.default.hasLoadingContent(t.tableWrapper)||!t.sortWait||(clearTimeout(t.exportTimer),t.exportTimer=setTimeout((function(){t.tableWrapper.trigger("tf-export-ready",{macroId:t.macroId})}),300))},T.prototype.setTablesReady=function(){this.tables.attr("data-tf-ready","true")},T.prototype.getFilterContainers=function(){return this.comboBoxDiv.find(".filter-container.sortable").filter((function(){return"none"!==this.style.display}))},T.prototype.filterContainer=function(e){var t=this;e.find("select, input").each((function(){var e=$(this);if(e.is(".select"))t.treatSelectFilter(e);else if(e.is(".user-filter"))t.treatUserFilter(e);else if(e.is(".number"))t.treatNumberFilter(e);else if(e.is(".date"))t.treatDateFilter(e);else if(e.is(".global-filter"))t.treatGlobalFilter(e);else if(e.is(".column-select"))t.treatColumnFilter(e);else{if(!e.is(".icon-select"))return;t.treatIconFilter(e)}t.highlightFilteredColumn(e)}))},T.prototype.showTable=function(e){var t=this,a=t.tables.length;t.cbState=new Array(a),t.tdNumbers=new Array(a);for(var l=0;l<a;l++){t.tdNumbers[l]=[],t.cbState[l]=new Array(t.rows[l].length>0?t.rows[l].length-1:0);for(var i=0;i<t.cbState[l].length;i++)t.cbState[l][i]=e}},T.prototype.treatSelectFilter=function(e){var t=this,a=[];e.find("option:selected").each((function(){var e=$.trim(this.textContent);e==="-Empty-"?e="":"@currentUser"===e?(e=o.default.getCurrentUserFullName(),a.push(o.default.getCurrentUserName())):"@pageTitle"===e&&(e=o.default.getPageTitle()),a.push(s.default.clearStringLowerCase(e))}));var l=e.parent();if(0===a.length)return l.data("state",[]),void l.data("filtered",!1);var i,r=e.attr("name"),n=e.hasClass("inverse"),c=e.data("ddSeparator"),d="AND"===e.data("ddOperator");i=c?function(e,t){var a=!d,l=e.split(c).map((e=>e.trim()));return l.length>1&&(l=l.filter((e=>e))),d?t.some((function(e){return a=a||-1===l.indexOf(e)})):l.some((function(e){return!(a=-1===t.indexOf(e))})),a}:function(e,t){return-1===$.inArray(e,t)};var f=[];t.rawTables.forEach((function(e,l){var o=s.default.getCellPositions(e,r);f[l]=[],o.length&&e.forEach((function(e,r){if(r>0){var c=!0;o.forEach((function(t){var l=s.default.clearStringLowerCase(e[t]);c=c&&i(l,a)})),c=t.isAND?c:!c,f[l][r-1]=n!=c?!t.isAND:t.isAND}}))})),l.data("state",f),l.data("filtered",!0)},T.prototype.treatIconFilter=function(e){var t=this,a=[],l=[],i=!1;e.find("option:selected").each((function(){var e=$.trim(this.textContent);if(e=="-Empty-")i=!0;else{var t=$(e);t.length&&(t.is("ul")?l.push("ul.inline-task-list > li"+(t.children("li").hasClass("checked")?".checked":":not(.checked)")):((e=t[0].src)&&(e=s.default.clearStringLowerCase(e),e=s.default.clearIconSrc(e)),a.push(e)))}}));var r=e.parent();if(0==a.length&&0==l.length&&!i)return r.data("state",[]),void r.data("filtered",!1);var o=e.attr("name"),n=e.hasClass("inverse"),c="AND"===e.data("ddOperator");c||(l=l.join(","));var d=[];t.tables.each((function(e){var r=t.rows[e],f=s.default.getCellPositions(t.rawTables[e],o);d[e]=[],f.length&&r.each((function(r){if(r>0){var o=!0,p=this;f.forEach((function(e){var t,r,n,d=s.default.getNthTdElem(p,e);if(a.length){var f=s.default.getTdIconsSrc(d).map((e=>e?s.default.clearIconSrc(s.default.clearStringLowerCase(e)):e));c?(t=!1,a.some((function(e){return t=t||-1===f.indexOf(e)}))):f.some((function(e){return!(t=-1===a.indexOf(e))}))}l.length&&(c?(r=!1,l.some((e=>r=r||0===d.find(e).length))):r=0===d.find(l).length),i&&(n=d.find("ul.inline-task-list li, img[src]").length>0),o=o&&(!1!==t&&!1!==n&&!0===r||!0===t&&!1!==n&&!1!==r||!1!==t&&!0===n&&!1!==r)})),o=t.isAND?o:!o,d[e][r-1]=n!=o?!t.isAND:t.isAND}}))})),r.data("state",d),r.data("filtered",!0)},T.prototype.treatInputFilter=function(e,t){var a,l=this,i=e.val(),r=s.default.clearStringLowerCase(i);if("@currentUser"==i?i=o.default.getCurrentUserFullName()+"|"+o.default.getCurrentUserName():"@pageTitle"===i&&(r=s.default.clearStringLowerCase(o.default.getPageTitle())),r.indexOf("&")>0){var n="";$.each(i.split("&"),(function(e,t){n+="(?=.*"+t.trim()+")"})),i=n}try{var c=new RegExp(i,"i")}catch(e){}t&&(a=e.attr("name"));var d=e.parents(".filter-container.sortable");if(""==r)return d.data("state",[]),void d.data("filtered",!1);var f=e.hasClass("inverse"),p=[];l.rawTables.forEach((function(e,i){var o=s.default.getCellPositions(e,a);p[i]=[],t&&!o.length||e.forEach((function(e,a){if(a>0){var n="";t?(o.forEach((function(t){e[t]&&(n=n+" "+e[t])})),n=n.trim()):n=e.join(" ");var d=-1==s.default.clearStringLowerCase(n).indexOf(r)&&(!c||null==n.match(c));d=l.isAND?d:!d,p[i][a-1]=f!=d?!l.isAND:l.isAND}}))})),d.data("state",p),d.data("filtered",!0)},T.prototype.treatGlobalFilter=function(e){this.treatInputFilter(e,!1)},T.prototype.treatUserFilter=function(e){this.treatInputFilter(e,!0)},T.prototype.treatDateFilter=function(e){var t=this,a=$.trim(e.val()),l=e.attr("name"),i=e.attr("dateformat"),r=e.attr("locale"),o=e.hasClass("from"),n=e.hasClass("inverse"),c=function(){return g.default.parseFilterDate(a,i,r)};if(o)t.rangeFilterValues={from:c()};else{var d=e.parent().parent();if(t.rangeFilterValues.to=c(),t.rangeFilterValues.from||t.rangeFilterValues.to){var f=[];t.rawTables.forEach((function(e,a){var o=s.default.getCellPositions(e,l);f[a]=[],o.length&&e.forEach((function(e,l){if(l>0){var s=!0;o.forEach((function(a){var l=e[a]||"";try{var o=g.default.parseDate(l,i,r);o?n?t.rangeFilterValues.from?s=t.rangeFilterValues.to?s&&t.rangeFilterValues.from<=o&&t.rangeFilterValues.to>=o:s&&t.rangeFilterValues.from<=o:t.rangeFilterValues.to&&(s=s&&t.rangeFilterValues.to>=o):t.rangeFilterValues.from?s=t.rangeFilterValues.to?s&&(t.rangeFilterValues.from>o||t.rangeFilterValues.to<o):s&&t.rangeFilterValues.from>o:t.rangeFilterValues.to&&(s=s&&t.rangeFilterValues.to<o):s=s&&!n}catch(e){s=!1,AJS.log("Error while filtering date '"+l+"': "+e)}})),s=t.isAND?s:!s,f[a][l-1]=s?!t.isAND:t.isAND}}))})),d.data("state",f),d.data("filtered",!0)}else d.data("state",[]),d.data("filtered",!1)}},T.prototype.treatNumberFilter=function(e){var t=this,a=$.trim(e.val()).toLocaleLowerCase(),l=e.attr("name"),i=e.hasClass("inverse"),r=e.hasClass("from"),o=g.default.getValueType(a,t.separator,t.worklog),n=g.default.parseValueByType(o,a,t.separator,t.worklog);if(n=!isNaN(n)&&n,r)t.rangeFilterValues={from:n,type:o};else{t.rangeFilterValues.type&&(o=t.rangeFilterValues.type),t.rangeFilterValues.to=n;var c=e.parent().parent();if(!1!==t.rangeFilterValues.from||!1!==t.rangeFilterValues.to){var d=[];t.rawTables.forEach((function(e,a){var r=s.default.getCellPositions(e,l);d[a]=[],r.length&&e.forEach((function(e,l){if(l>0){var s=!0;r.forEach((function(a){var l=e[a]||"";try{var r=g.default.parseValueByType(o,l,t.separator,t.worklog);isNaN(r)?s=s&&!i:i?!1!==t.rangeFilterValues.from?s=!1!==t.rangeFilterValues.to?s&&t.rangeFilterValues.from<=r&&t.rangeFilterValues.to>=r:s&&t.rangeFilterValues.from<=r:!1!==t.rangeFilterValues.to&&(s=s&&t.rangeFilterValues.to>=r):!1!==t.rangeFilterValues.from?s=!1!==t.rangeFilterValues.to?s&&(t.rangeFilterValues.from>r||t.rangeFilterValues.to<r):s&&t.rangeFilterValues.from>r:!1!==t.rangeFilterValues.to&&(s=s&&t.rangeFilterValues.to<r)}catch(e){s=!1,AJS.log("Error while filtering number '"+l+"': "+e)}})),s=t.isAND?s:!s,d[a][l-1]=s?!t.isAND:t.isAND}}))})),c.data("state",d),c.data("filtered",!0)}else c.data("state",[]),c.data("filtered",!1)}},T.prototype.treatColumnFilter=function(e){var t=this;t.updateSparkline=!0;var a=[];e.find("option:selected").each((function(){var e=$.trim(this.textContent);e=="-Empty-"&&(e=""),a.push(e.toLocaleLowerCase())}));var l=e.hasClass("inverse"),i=e.parent();if(0!=a.length){var r=[];t.rawTables.forEach((function(e,i){r[i]=[];var o=e[0]||[];o.forEach((function(e,n){l!=$.inArray(s.default.clearStringLowerCase(e),a)>=0&&(r[i].push(n),n==o.length-1&&(t.updateSparkline=!1))}))})),i.data("state",r)}else i.data("state",[])},T.prototype.showOrHide=function(e,t,a,l,i){var r=this,s=0;if(t>r.headerSize[e])if(!r.cbState[e][t-1]&&i<t)$(a.children).filter("[rowspan]").trigger("hideCell"),a.style.display="none";else if(r.numbering&&(-1!=r.numbering.indexOf("dynamic")||"true"==r.numbering)){var o=a.children[0];o.classList.contains("tf-numbering")&&(o.children[0].textContent=l,r.rawTables[e][t][0]=""+l),s=1}if(r.tdNumbers&&r.tdNumbers[e].length){var n=a.children;$.each(r.tdNumbers[e],(function(e,t){$(n[t]).trigger("hideCol").addClass("tf-hidden-column")}))}return s},T.prototype.showTableWithoutFilters=function(){var e=this;e.showTable(!0),e.showOrHideTables(),e.appendTotalRow(),e.appendTotalCol(),e.appendSparklines(),e.blockEvent||e.tableWrapper.trigger("tf-filtered-total",e.getEventData()),e.sparkline&&e.fixedRows>0&&e.updateFixedCells(),h.default.create(e)},T.prototype.showOrHideTables=function(){var e=this,t=0,a=0,l=e.params.showNRows;e.isLockEnabled&&(e.params.showNRows="all"),e.tables.each((function(l){var i=$(this),r=e.rows[l],o=i.hasClass("relative-table"),n=(0,v.getChildren)(r),c=J(n),d=i.children("colgroup").children("col");if(o){var f=0,p=[];d.each((function(){"none"===this.style.display?f+=parseFloat(this.style.width):p.push(this)})),f>0&&(i.css("width",parseFloat(i[0].style.width)/(1-f/100)+"%"),p.forEach((function(e){e.style.width=parseFloat(e.style.width)*(1-f/100)+"%"})))}d.show();var u=i.find("tr.pivot-header, thead.tableFloatingHeader tr"),m=J((0,v.getChildren)(u));if(u.each((function(){e.showOrHide(l,-1,this)})),e.tdNumbers&&e.tdNumbers[l].length){f=0;$.each(e.tdNumbers[l],(function(e,t){t<d.length&&(d.eq(t).hide(),o&&(f+=parseFloat(d[t].style.width)))})),f>0&&(i.css("width",parseFloat(i[0].style.width)*(1-f/100)+"%"),d.each((function(t){-1===e.tdNumbers[l].indexOf(t)&&(this.style.width=parseFloat(this.style.width)/(1-f/100)+"%")})))}i.is(".attachments")&&i.find(".attachment-summary").each((function(t){e.cbState[l][t]||($(this).addClass("hidden"),r.eq(t+1).find(".icon-section-opened").removeClass("icon-section-opened").addClass("icon-section-closed"))})),n.each((function(){this.hasAttribute("rowspan")&&(this.rowSpan=$.data(this,"rowspan")||1)})),r.each((function(){this.style.display=""})),t+=r.length-1;var h=e.params.ignoreFirstNrows,b=$.grep(e.cbState[l],(function(e,t){return e||h>t})).length,g=1,y=1;if(e.numbering&&-1!=e.numbering.indexOf("desc")&&(g=b,y=-1),r.each((function(t){g+=e.showOrHide(l,t,this,g,h)*y})),"all"!=e.params.showNRows&&e.params.showNRows>=0&&!e.filtered){var w=e.params.showNRows;r.filter((function(){return s.default.isRowVisible(this)})).filter(":gt("+w+")").hide(),b=Math.min(b,w)}e.editorMacro&&(x.fixEditorCellHighlight(c),x.fixEditorCellHighlight(m)),a+=b})),t===a?e.filterIcon.removeClass("filtered").addClass("default").attr("title",AJS.format("Nothing filtered. Showing {0} rows",t)):e.filterIcon.removeClass("default").addClass("filtered").attr("title",AJS.format("Showing {0} of {1} rows",a,t)),e.filterIcon.children(".filter-count").text("".concat(a,"/").concat(t)),e.resize&&e.resize(),e.params.showNRows=l;var i=e.getEventData();e.blockEvent||e.tableWrapper.trigger("tf-filtered",i),e.tables.trigger("tf-filtered-charts").trigger("scroll-tf"),e.comboBoxDiv.parents(".tablefilter-table-wrapper, .pivot-content, table").eq(0).data("inner-filter",i)},T.prototype.getEventData=function(){return{id:"tf-table-"+this.macroId,tf:this,macroId:this.macroId}},T.prototype.appendSparklines=function(){var e=this;if(e.pauseUpdate=!0,e.setMutationObserver(!0),e.spakLinesFinished=!0,e.sparkline)e.rows.forEach((function(t,a){!function(t,a){var l=null,i=0;function r(e){return(e.find(":first-child").attr("class")||"").replace("tf-numbering","").replace("tf-hidden-column","")}function o(e,t){var a=100,l=25,i=$('<svg xmlns="http://www.w3.org/2000/svg"/>').attr("width",a).attr("height",l);function r(e){if(e.length>1){var t=a/(e.length-1),i=Math.min(...e),r=Math.max(...e)-i,s=0===r?l/2:l/r,o=e.map(((e,a)=>[t*a,0===r?s:l-s*(e-i)]));return"M".concat(o.join("L"))}return""}var s=$(document.createElementNS("http://www.w3.org/2000/svg","path")).attr("d",r(t)).attr("style","stroke: rgb(100, 100, 255); stroke-width: 1; fill: none;");i.append(s),e.append(i)}t.each((function(n,c){var d=$(c);d.find(".tf-sparkline-header, .tf-sparkline-container").remove();var f=r(d);if(0===n){if(d.append($('<th class="'.concat(f,' tf-sparkline-header synchrony-exclude" contenteditable="false" data-sorter="false"></th>')).text(e.sparkName)),c.classList.contains("tf-header-hidden")){var p=$(a).find("tr.pivot-header"),u=p.eq(0);u.find(".tf-sparkline-header").remove(),u.append($('<th class="'.concat(r(u),' tf-sparkline-header synchrony-exclude" contenteditable="false" data-sorter="false" rowspan="').concat(p.length,'">\n                              </th>')).text(e.sparkName))}}else{var m=[];$(c.children).not(".tf-numbering, .total-col, .numberingColumn").each((function(t){if($(this).hasClass("tf-hidden-column"))return!0;var a=s.default.clearString(this.textContent);null==l&&a&&(l=g.default.getValueType(a,e.separator,e.worklog,!0));var i=g.default.parseValueByType(l,a,e.separator,e.worklog,!0);isNaN(i)||m.push(i)}));var h=$('<td class="'.concat(f,' tf-sparkline-container synchrony-exclude" contenteditable="false"></td>'));if(o(h,m),d.append(h),!e.editorMacro){var b=d.find("svg").attr("version",1.1).prop("outerHTML");if("undefined"!=typeof btoa&&b){h.append("<canvas></canvas>");var v="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(b))),y=d.find("canvas").attr("width",100).attr("height",25)[0],w=y.getContext("2d"),x=new Image;x.src=v,x.onload=function(){w.drawImage(x,0,0);var e=y.toDataURL("image/png"),l='<img src="'.concat(e,'">');h.html(l),++i===t.length-1&&$(a).trigger("sparklines-converted")}}}}}))}((0,v.spliceSelectors)(t,e.totalRows[a]),e.tables[a])})),e.updateSorterAndRawTables(!0),e.pauseUpdate=!1,e.setMutationObserver(!0);else{var t=e.tableWrapper.find(".tf-sparkline-header, .tf-sparkline-container"),a=t.length;t.remove(),e.updateSorterAndRawTables(a>0),e.pauseUpdate=!1,e.setMutationObserver(!0)}},T.prototype.appendTotalRow=function(){var e=this;if(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.find("tr.total-row").remove(),e.totalRows=[],e.totalRow.length){var t=0;e.tableUpdated=!0,e.rawTables.forEach((function(a,l){for(var i={},r=e.numbering?1:0,o=e.rows[l].eq(0).children().not(".tf-sparkline-header, .total-col").length-r,n={},c=t;c<o+t;c++){var d=c-t+r;if(e.totalRow[c]){var f=I,p=!1,u=!1,h=!1;"Sum"==e.totalRow[c]?f=S:"Min"==e.totalRow[c]?f=F:"Max"==e.totalRow[c]?f=k:"Multiplication"==e.totalRow[c]?f=C:"Count"==e.totalRow[c]?(f=H,u=!0):"Count not empty"==e.totalRow[c]?(f=H,h=!0):p=!0,i[d]={calc:f,isAvg:p,isCount:u,isCountA:h}}n[d]=e.getTotalCellClasses(l,d)}t+=o;var b=null;if(Object.keys(i).length){var v={},y={};a.forEach((function(t,a){a>0&&s.default.isRowVisible(e.rows[l][a])&&$.each(i,(function(i,r){if(r.isCount)r.calc();else if(r.isCountA)if(t[i])r.calc();else{var o=e.rawIconTables[l][a][i];if(o){var n=!0;-1!==o.indexOf('<ul class="inline-task-list"')&&(n=/<li .*?class="[^"]*?checked[^"]*?".*?>/.test(o)),n&&r.calc()}}else{null==v[i]&&t[i]&&(v[i]=g.default.getValueType(t[i],e.separator,e.worklog));var c=g.default.parseValueByType(v[i],t[i],e.separator,e.worklog);s.default.isNumber(c)&&(r.calc(c),v[i]!==s.default.number||y[i]||(y[i]=s.default.getNumberFormatter(t[i],e.separator)))}}))}));var w=!1,x=!0;if($.each(i,(function(t,a){a.total=s.default.formatValueByType(a.total,v[t],(function(l){if(void 0!==l){w=!0,a.isAvg&&(l=A(l));var i=e.formatDecimal.to(l);return y[t]?y[t](i):i}return""}),e.worklog,e.separator),""!==a.total&&(w=!0)})),w){if(b=$(m().totalRow({title:e.totalRowName,length:o+r,totals:i,numbering:r,isFireFox:s.default.isFireFox(),classes:n})),e.tdNumbers&&e.tdNumbers[l].length){x=!1;var T=b.children("td,th");$.each(e.tdNumbers[l],(function(e,t){T.eq(t).addClass("tf-hidden-column")})),$.each(T,(function(e,t){if(t.textContent&&!$(t).hasClass("tf-hidden-column"))return x=!0,!1}))}x&&e.tables.eq(l).append(b)}}e.totalRows.push(b),e.updateSorterAndRawTables(!1,!0)}))}e.pauseUpdate=!1,e.setMutationObserver(!0)},T.prototype.getTotalCellClasses=function(e,t){var a="";return a+=this.rows[e][0].cells[t].classList.contains("pivot-hidden-column")?"pivot-hidden-column":""},T.prototype.appendTotalCol=function(){var e=this;if(!s.default.hasLoadingContent(e.tableWrapper)){e.pauseUpdate=!0,e.setMutationObserver(!0);var t=!1;if(e.totalCol){var a=I,l=!1,i=e.totalCol;"Sum"==e.totalCol?a=S:"Min"==e.totalCol?a=F:"Max"==e.totalCol?a=k:"Multiplication"==e.totalCol?(a=C,i="Product"):l=!0,i=e.totalColName?e.totalColName:i,e.tables.each((function(t){var r=$(this),o=null,n=null;if(e.rows[t].length&&e.rows[t][0].classList.contains("tf-header-hidden")){var c=r.find("tr.pivot-header"),d=c.eq(0);if(0===d.children("th.total-col").length){var f=$('<th class="total-col confluenceTh" rowspan="'.concat(c.length,'"></th>')).text(i);d.append(f)}}(0,v.spliceSelectors)(e.rows[t],e.totalRows[t]).each((function(t){for(var r={calc:a},c=this.children,d=null,f=c.length-1;f>=0;f--)if(c[f].classList.contains("total-col")){d=$(c[f]);break}if(d||(d=$(m().totalCol({rowNumber:t})),$(this).append(d)),0===t)d.find("p").text(i);else{for(f=0;f<c.length;f++){var p=c[f];if(!(p.classList.contains("tf-numbering")||p.classList.contains("total-col")||p.classList.contains("numberingColumn")||p.classList.contains("pivot-hidden-column"))){if(!p.classList.contains("tf-hidden-column")){var u=s.default.clearString(p.textContent);null==o&&u&&(o=g.default.getValueType(u,e.separator,e.worklog,!0));var h=g.default.parseValueByType(o,u,e.separator,e.worklog,!0);s.default.isNumber(h)&&(r.calc(h),o!==s.default.number||n||(n=s.default.getNumberFormatter(u,e.separator)))}0}}var b=s.default.formatValueByType(r.total,o,(function(t){if(void 0===t)return"";l&&(t=A(t));var a=e.formatDecimal.to(t);return n?n(a):a}),e.worklog,e.separator),v=d.children("p");v.length||(v=$("<p></p>"),d.prepend(v)),v.text(b)}})),e.isCloud&&r.attr("data-layout")&&0===r.find("colgroup col.tftc").length&&r.find("colgroup").append('<col class="tftc" style="width: fit-content"> ')})),t=!0}else{var r=e.tables.find("th.total-col");r.length&&(t=!0,r.remove(),e.tables.find("colgroup col.tftc").remove())}return t&&e.updateSorterAndRawTables(!0,!0),e.pauseUpdate=!1,e.setMutationObserver(!0),t}},T.prototype.updateSorterAndRawTables=function(e,t){var a=this;a.shouldUpdateSorter=a.shouldUpdateSorter||t,a.shouldUpdateRawTables=a.shouldUpdateRawTables||e,a.spakLinesFinished&&(a.shouldUpdateSorter&&(a.tables.not(".pivot-table-result,.merged-header").trigger("updateAll",!1),a.tables.not(".pivot-table-result").trigger("update",!1)),a.shouldUpdateRawTables&&a.updateRawTables(),a.shouldUpdateSorter=!1,a.shouldUpdateRawTables=!1,a.spakLinesFinished=!1)},T.prototype.bindChangeLabel=function(){var e=this;e.comboBoxDiv.delegate(".filter-container label.hideble","dblclick",(function(){var t=$(this).find(".tf-label-name"),a=!0,l=$(this).parent(),i=t.css("width");t.hide(),l.prepend(m().labelChanger({value:t.text(),width:parseInt(i,10)+6+"px"}));var r=!1,s=l.find(".tf-label-changer");s.focus(),s[0].select(),s.bind("keydown",(function(l){13==l.keyCode&&(t.text(s.val()),s.remove(),t.show(),a=!1,e.enableSaveBtn()),32==l.keyCode&&(r=!0)})),s.bind("input",(function(){var e=s.textWidth(s.html())+6;r&&(e+=4,r=!1),s.css("width",(e<10?10:e)+"px")})),$(document).one("click",(function(e){!$(e.target).closest(".tf-label-changer").length&&a&&(s.remove(),t.show(),a=!1)}))})),$.fn.textWidth=function(e,t){return $.fn.textWidth.fakeEl||($.fn.textWidth.fakeEl=$("<span>").hide().appendTo(document.body)),$.fn.textWidth.fakeEl.text(e||this.val()||this.text()).css("font",t||this.css("font")),$.fn.textWidth.fakeEl.width()}},T.prototype.getFilterLabels=function(){var e=this,t=[];return a(".selectfilter-element"),a(".userfilter-element"),a(".numberfilter-element"),a(".datefilter-element"),a(".globalfilter-element"),a(".columnhider-element"),a(".iconfilter-element"),t.join("‚");function a(a){e.comboBoxDiv.find(a+" .tf-label-name").each((function(){t.push($(this).text())}))}},T.prototype.initInlineFilterButton=function(){var e=this,t=e.tables.eq(0),a=e.filterIcon.parent();e.inlineFilterBtns=e.outerWrapper.find(".tf-inline-filter.".concat(e.macroId,"-").concat(e.sessionId)),e.inlineFilterBtn=e.inlineFilterBtns.filter(".btn"),e.inlineFilterTrigger=e.inlineFilterBtns.filter(".trigger");var l,i,r,o,n,c,d,f=!1;e.inlineFilterBtn.unbind("click").click((t=>{r=l,y(o=i,e.inlineFilterTrigger),this.comboBoxDiv.removeAttr("open"),this.comboBoxDiv.attr("open",!0),t.stopPropagation()}));var u,m,h,b="Filter Added from "+(e.params.liveMode?"Live":"Header");function v(){h&&(h.unwrap(),h.css(h.orig_sizes),h.elclone.before(h),h.elclone.remove(),h=null)}function g(){i&&y(i,e.inlineFilterBtn),o&&(y(o,e.inlineFilterTrigger),f&&(e.comboBoxDiv.find("select").trigger("chosen:close"),e.comboBoxDiv.removeAttr("open"),f=!0,e.comboBoxDiv.attr("open",!0)))}function y(t,a){var l=t.offset();a.offset({top:m?void 0:l.top-3,left:Math.min(l.left+t.outerWidth(),e.tableWrapper.offset().left+e.tableWrapper.width())-16}).addClass("visible")}function w(){var l=e.tables.eq(0).offset(),i=e.tableWrapper.eq(0).offset();a.offset({top:Math.max(l.top,i.top)+5,left:Math.max(l.left,i.left)+Math.min(t.width(),e.tableWrapper.width())-(e.isCloud?4:2)})}this.comboBoxDiv.unbind("aui-hide aui-show").bind("aui-hide",(()=>{f=!1,e.inlineFilterTrigger.removeClass("active mimic"),e.filterIcon.removeClass("open"),v(),B()})).bind("aui-show",(()=>{var t;f||(r=l,o=i),e.inlineFilterTrigger.addClass("active"),e.inlineFilterTrigger.removeClass("visible");var a="";r?(a=s.default.getCellText(r[0]),t='[name="'.concat(a,'"]')):t="."+("globalfilter"===n?"global-filter":"column-select");var u=this.comboBoxDiv.find(".filter-container").addClass("hidden").find("input,select").filter(t).parents(".filter-container").removeClass("hidden");if(!u.length){var m=r?this.detectFilterType(a):n;u=this.addFilter(m,a),$("body").trigger("filter-added-deleted",{action:b,type:m,pageMode:e.isPreview?"Macro Preview":"Page View"}),p.default.headerFilterAdded(m,"normal")}if(!f||d){clearTimeout(c);var h=f?d:u.find("input").eq(0);c=setTimeout((()=>h.focus()),10)}f=!0})),this.menu.find(".show-filter").unbind("click").click((function(){l=null,i=null,r=null,o=null;var a=e.tables.eq(0).offset();e.inlineFilterTrigger.addClass("mimic").offset({top:a.top+5,left:Math.max(a.left,e.tableWrapper.offset().left)+Math.min(t.width(),e.tableWrapper.width())+11}),e.filterIcon.addClass("open"),n=$(this).attr("data-filter-type"),e.comboBoxDiv[0].open=!0})),this.visibleHeaderCells=[],this.rows.forEach(((t,a)=>{var s=$(t[0]),n=s.children();s.hasClass("tf-header-hidden")&&(s=e.tables.eq(a).find(".pivot-header").last());var c=s.children();this.visibleHeaderCells.push(c);var d=e.numbering&&!n[0].classList.contains("tf-numbering")?1:0;e.tables.eq(a).off("mouseleave.tf mouseenter.tf","td,th").on("mouseleave.tf","td,th",(()=>{!f&&e.inlineFilterTrigger.removeClass("visible"),e.inlineFilterBtn.removeClass("visible")})).on("mouseenter.tf","td,th",(function(){if(l=n.eq(this.cellIndex-d),i=e.getVisibleHeaderCell(a,this.cellIndex-d),l.length&&i.length){var t=e.isFilteredByCell(l);e.inlineFilterBtn.toggleClass("filtered",t),y(i,e.inlineFilterBtn),f||(r=l,o=i,e.inlineFilterTrigger.toggleClass("filtered",t),y(i,e.inlineFilterTrigger))}else l=null,i=null}))})),this.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.live").bind("scroll.live",(()=>{m=!0,g(),clearTimeout(u),u=setTimeout((()=>m=!1),50)})),this.tableWrapper.unbind("tf-filtered.live").bind("tf-filtered.live",(()=>{l&&e.inlineFilterBtn.toggleClass("filtered",e.isFilteredByCell(l)),f&&(d=e.comboBoxDiv.find("input:focus")),setTimeout((()=>{g(),w()}),20)})),t.unbind("mouseleave.tft mouseover.tf").bind("mouseover.tf",(function(){w(),e.filterIcon.addClass("visible")})).bind("mouseleave.tft",(()=>e.filterIcon.removeClass("visible"))),this.comboBoxDiv.undelegate("chosen:showing_dropdown.live").delegate("select","chosen:showing_dropdown.live",(function(t,a){if(v(),"true"!==e.comboBoxDiv.attr("aria-hidden")){var l=(h=a.chosen.container)[0],i=l.style,r=l.getBoundingClientRect();h.orig_sizes={width:h.width(),height:h.height(),position:i.position,top:i.top,left:i.left,zIndex:i.zIndex};var s=$.extend({},h.orig_sizes);s.position="absolute",s.top=r.top+window.pageYOffset,s.left=r.left+window.pageXOffset,s.zIndex=999999;var o=h.elclone=h.clone();o.find(".chosen-drop").remove(),h.before(o),h.css(s),$("body").append($('<div class="wiki-content"></div>').append(h)),h.click((e=>e.stopPropagation()))}})).undelegate("chosen:hiding_dropdown.live tf-close.live").delegate("select","chosen:hiding_dropdown.live tf-close.live",v)},T.prototype.highlightFilteredColumn=function(e){if("Table header"===this.params.hidePane&&!this.editorMacro){var t=this.hasFilterValues(e),a=e.attr("name");this.rawTables.forEach(((e,l)=>{s.default.getCellPositions(e,a).forEach((e=>{this.getVisibleHeaderCell(l,e).toggleClass("filtered-header",t),this.inlineFilterTrigger.toggleClass("filtered",t)}))}))}},T.prototype.getVisibleHeaderCell=function(e,t){for(var a=this.visibleHeaderCells[e].eq(t);a.length&&("none"===a[0].style.display||a.hasClass("tf-hidden-column"));){var l=a.data("parentCell");a=l||a.prev()}return a},T.prototype.hasFilterValues=function(e){var t=Boolean(e.val());return(e.hasClass("date")||e.hasClass("number"))&&(t=t||Boolean(e.parents(".range").find("input").not(e).val())),t},T.prototype.getFilterByCell=function(e){var t=s.default.getCellText(e[0]);return this.comboBoxDiv.find("input,select").filter('[name="'.concat(t,'"]'))},T.prototype.isFilteredByCell=function(e){var t=this,a=!1;return t.getFilterByCell(e).each((function(){t.hasFilterValues($(this))&&(a=!0)})),a},T.prototype.detectFilterType=function(e){if(this.getDateMacroFormatIfPresent(e))return"datefilter";var t="userfilter";return this.rawTables.some(((a,l)=>{var i=s.default.getCellPosition(a,e);if(null!=i){var r=(new f.default).getColumnData(a,i,this.dateFormat,this.locale,this.separator,this.worklog);if(r)return r.type===b.DATA_TYPES.date?(this.dateFormat=r.dateFormat,t="datefilter"):r.type===b.DATA_TYPES.number?t="numberfilter":r.type===b.DATA_TYPES.label&&(t="selectfilter"),!0;if(this.rawIconTables||this.updateRawIconTables(),(new f.default).getColumnValues(this.rawIconTables[l],i).length)return t="iconfilter",!0}})),t},T.prototype.addToAllowRowList=function(e){var t=this,a=e.closest("table");if(a.length){var l=t.tables.index(a),i=t.rows[l].index(e);t.allowRowList||(t.allowRowList=new Array(t.tables.length)),t.allowRowList[l]||(t.allowRowList[l]=[]),t.allowRowList[l].push(i)}},T.prototype.correctionWithAllowRowList=function(){var e=this;e.allowRowList&&e.allowRowList.forEach((function(t,a){t&&t.forEach((function(t){e.cbState[a][t-1]=!0}))}))},T.prototype.setTextForFakeCells=function(e){for(var t=e.html(),a=e;a.data("childCell");)(a=a.data("childCell")).html(t);for(var l=e;l.data("parentCell");)(l=l.data("parentCell")).html(t)};var E=T}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:d90b283bb8da670f28039c35532ae8e7', location = 'build/479.js' */
"use strict";(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[479],{92457:function(t,e,a){a.r(e);a(68268);var i=a(83931),n=a(94818);function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class r{constructor(t,e,a,r,l,o){s(this,"removePaginationAttribute",(()=>{this.removeRowsPaginationAttribute((0,n.spliceSelectors)($(this.rows,this.rowHeader))),$(this.table).removeAttr("pagination")})),s(this,"removeRowsPaginationAttribute",(t=>{var e=t.filter("[visibleForPagination]");e.removeAttr("visibleForPagination visibleForPaginationAnim"),e.children("td[visibleForPagination]").each(((t,e)=>{var a=$(e);a.removeAttr("visibleForPagination");var i=a.data("savedRowSpan");i&&a.attr("rowspan",i);var n=a.data("savedColSpan");n&&a.attr("colspan",n)}))})),s(this,"getParrentTableElement",(t=>{var e=$(t).closest(".tablefilter-table-wrapper .table-wrap");return e.length?e[0]:this.tablefilter.isCloud?t.parentNode:this.findParrentTableElement(t)})),s(this,"findParrentTableElement",(t=>{var e=$(t).parent();return e.length?e.hasClass("tablefilter-table-wrapper")?t:this.findParrentTableElement(e[0]):null})),s(this,"getPaginationPages",(t=>{this.removeRowsPaginationAttribute($(this.rows));var e=[],a=0,n=0;e[a]=[];var s=this.rows.length,r=!1;this.tablefilter.filtered||(r=!0,this.tablefilter.params.showNRows>0&&(s=Math.min(s,parseInt(this.tablefilter.params.showNRows))));for(var l=0;l<s;l++){var o=this.rows[l];(r||i.default.isRowVisible(o))&&(n>=t&&(n=0,e[++a]=[]),e[a][n]=o,n++)}return e})),s(this,"addPaginationPanel",(t=>{var e=$(this.render());$(t).after(e),this.panel=e,this.paginationItems=e.find("li:not(.aui-nav-pages)"),this.itemPrev=$(this.paginationItems[0]),this.itemFirst=$(this.paginationItems[1]),this.itemTruncationLeft=$(this.paginationItems[2]),this.itemTruncationRight=$(this.paginationItems[this.paginationItems.length-3]),this.itemLast=$(this.paginationItems[this.paginationItems.length-2]),this.itemNext=$(this.paginationItems[this.paginationItems.length-1]),this.items=this.paginationItems.slice(3,this.paginationItems.length-3);var a=this;return this.paginationItems.off("click").click((function(){return a.showPaginationsPage($(this).data("index-page"),a.pages),!1})),e})),s(this,"showPaginationsPage",((t,e)=>{t=t||0,t=Math.min(Math.max(t,0),this.pages.length-1);var a=$(e[this.indexCurrentPage]);this.removeRowsPaginationAttribute(a),this.indexCurrentPage=t;var i=$(e[t]);i.attr("visibleForPagination","true"),setTimeout((()=>{i.attr("visibleForPaginationAnim","true")}),0),this.showMergeCells(i),this.selectedPagination(),this.table.classList.contains("attachments")&&(this.$table.find(".attachment-summary").addClass("hidden"),this.rows.find(".icon-section-opened").removeClass("icon-section-opened").addClass("icon-section-closed"))})),s(this,"showMergeCells",(t=>{t.children("td.fake").each(((t,e)=>{for(var a=$(e),n=a;n.data("parentCell");){var s=n.data("parentCell"),r=s.parent();if(r.attr("visibleForPagination"))break;if("none"!==s[0].style.display&&i.default.isRowVisible(r[0])){a.attr("visibleForPagination","true");var l=a.attr("rowspan");if("-1"==l){var o=this.findRowSpan(a);a.data("savedRowSpan",l),a.attr("rowspan",o)}var h=a.attr("colspan"),g=s.attr("colspan");"-1"==h&&g>0&&(a.data("savedColSpan",h),a.attr("colspan",g));break}n=s}}))})),s(this,"findRowSpan",(t=>{for(var e=1,a=t;a.data("childCell");){var i=(a=a.data("childCell")).parent();i.length&&i.attr("visibleForPagination")&&e++}return e})),s(this,"selectedPagination",(()=>{var t=0,e=this.pages.length-1;this.pages.length>9&&(t=this.indexCurrentPage-3,e=this.indexCurrentPage+3,t<0?(e+=-t,t=0):e>=this.pages.length&&(t-=e-(this.pages.length-1),e=this.pages.length-1)),0==t?this.itemTruncationLeft.addClass("hidePaginationBtn"):this.itemTruncationLeft.removeClass("hidePaginationBtn"),e==this.pages.length-1?this.itemTruncationRight.addClass("hidePaginationBtn"):this.itemTruncationRight.removeClass("hidePaginationBtn"),0==this.indexCurrentPage?(this.itemPrev.addClass("passivePaginationBtn"),this.itemFirst.addClass("aui-nav-selected")):(this.itemPrev.removeClass("passivePaginationBtn"),this.itemFirst.removeClass("aui-nav-selected")),this.indexCurrentPage==this.pages.length-1?(this.itemNext.addClass("passivePaginationBtn"),this.itemLast.addClass("aui-nav-selected")):(this.itemNext.removeClass("passivePaginationBtn"),this.itemLast.removeClass("aui-nav-selected")),this.items.addClass("hidePaginationBtn"),this.items.filter("li.aui-nav-selected").removeClass("aui-nav-selected"),$(this.items[this.indexCurrentPage-1]).addClass("aui-nav-selected"),this.items.slice(t,e-1).removeClass("hidePaginationBtn"),this.itemTruncationLeft.data("index-page",t),this.itemTruncationRight.data("index-page",e),this.itemPrev.data("index-page",this.indexCurrentPage-1),this.itemNext.data("index-page",this.indexCurrentPage+1)})),s(this,"render",(()=>{for(var t="",e=1;e<this.pages.length-1;e++){t+='<li data-index-page="'.concat(e,'"><a>').concat(e+1,"</a></li>")}return'\n     <div contenteditable = "false" class="tablefilter-pagination synchrony-exclude">\n       <ol class="aui-nav aui-nav-pagination" style = "display: inline-block; padding: 0;">\n         <li class="aui-nav-previous"><a>'.concat("Prev",'</a></li>\n         <li class="aui-nav-first" data-index-page="0"><a>1</a></li>\n         <li class="aui-nav-truncation"><a>&hellip;</a></li>\n         <li class="aui-nav-pages">\n           <ol class="aui-nav aui-nav-pagination" style="padding: 0;">').concat(t,'</ol>\n         </li>\n         <li class="aui-nav-truncation"><a>&hellip;</a></li>\n         <li class="aui-nav-last" data-index-page="').concat(this.pages.length-1,'"><a>').concat(this.pages.length,'</a></li>\n         <li class="aui-nav-next"><a>').concat("Next","</a></li>\n       </ol>\n     </div>")})),this.tablefilter=t,this.table=e,this.$table=$(e),this.wrapper=r,this.rows=a.slice(1);var h=$(a[0]);h.hasClass("tf-header-hidden")?this.rowHeader=this.$table.find("tr.pivot-header"):this.rowHeader=h,this.indexCurrentPage=o,this.parentTableElement=this.getParrentTableElement(e),this.parentTableElement&&(this.pages=this.getPaginationPages(l),this.pages.length>1?(this.addPaginationPanel(this.parentTableElement),this.showPaginationsPage(this.indexCurrentPage,this.pages),this.$table.attr("pagination","true"),this.rowHeader.attr("visibleForPagination","true").attr("visibleForPaginationAnim","true")):this.removePaginationAttribute())}}s(r,"create",((t,e)=>{if(t.params.rowsPerPage>0&&t.tables.length){var a=[];t.tableWrapper.find(".tablefilter-pagination").remove();var i=e?r.getIndexesCurrentPage(t):null;t.tables.each(((e,s)=>{var l=0;i&&(l=i[e]),a.push(new r(t,s,(0,n.spliceSelectors)(t.rows[e],t.totalRows[e]),t.tableWrapper,t.params.rowsPerPage,l))})),t.paginations=a}else r.remove(t.tableWrapper),t.paginations=null})),s(r,"remove",(t=>{t.find(".tablefilter-pagination").remove(),t.find("table[pagination]").removeAttr("pagination").find("tr[visibleForPagination]").removeAttr("visibleForPagination visibleForPaginationAnim").children("[visibleForPagination]").removeAttr("visibleForPagination")})),s(r,"getIndexesCurrentPage",(t=>{var e=null;if(t.paginations){e=[];for(var a=0;a<t.paginations.length;a++)e.push(t.paginations[a].indexCurrentPage)}return e})),e.default=r},40479:function(t,e,a){a.r(e);var i,n,s;a(68268),a(42295),a(92381),a(92457);class r{}s=t=>{var e=parseInt(t.showNRowsifNotFiltered),a=parseInt(t.ignoreFirstNrows),i=parseInt(t.rowsPerPage);e>=0||(t.showNRowsifNotFiltered="all"),a>0||(t.ignoreFirstNrows=""),i>0||(t.rowsPerPage=""),0==parseInt(t.showNRows)&&(t.showNRows="0+"),t.showNRows&&(-1!=t.showNRows.indexOf("*")?t.ignoreFirstNrows=t.showNRows.replace("*",""):-1!=t.showNRows.indexOf("+")?t.showNRowsifNotFiltered=t.showNRows.replace("+",""):t.showNRows>0&&(t.rowsPerPage=t.showNRows.replace("+","")),t.showNRows="")},(n="adaptOldParamsTF")in(i=r)?Object.defineProperty(i,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[n]=s,e.default=r}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:tf-editor-resources', location = 'build/tf-editor.js' */
!function(){"use strict";var e,t={14071:function(e,t,a){a.r(t);a(98457),a(63045),a(42295),a(86305),a(67285),a(79150),a(15761),a(75654);var r=a(12240),i=a(83931),n=a(11230),l=a.n(n),o=a(92457),s=a(11706),d=a(33926),c=a(19805),f={contents:null,tfs:{},panels:[],init:function(){var e=this;(0,d.makeAjax)({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"GET",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/license",dataType:"json",success:function(t){t&&(e.initFilters(),e.bindEvents(),AJS.Rte.Content.editorResetContentChanged())}})},initFilters:function(){var e=this;e.contents=$("#wysiwygTextarea_ifr").contents(),e.toolbar=$("#rte-toolbar"),e.contents.find('[data-macro-name="table-filter"]').each((function(){e.createFilter($(this))}))},bindEvents:function(){var e=this;new MutationObserver((function(t){t.forEach((function(t){Array.prototype.forEach.call(t.addedNodes,(function(t){var a;(a=t).attributes&&a.attributes["data-macro-name"]&&"table-filter"===a.attributes["data-macro-name"].value?e.createFilter($(a)):a.querySelectorAll&&$(a.querySelectorAll('[data-macro-name="table-filter"]')).each((function(){e.createFilter($(this))}))}))}))})).observe(e.contents[0],{childList:!0,subtree:!0}),AJS.bind("created.property-panel",(function(t,a){if("macro"==a.type){var r=$(a.anchor);if("table-filter"==r.attr("data-macro-name")){var i=r.attr("id"),n=e.tfs[i];if(n&&n.tables.length)e.toolbar.find(".tablefilter-outer-wrapper").data("id")==i?a.panel.find(".macro-property-panel-show-tf").addClass("hide-tf").addClass("visible").find(".panel-button-text").text("Hide filter"):a.panel.find(".macro-property-panel-show-tf").removeClass("hide-tf").addClass("visible").find(".panel-button-text").text("Show filter");else a.panel.find(".macro-property-panel-show-tf").hide()}}})),$(document).bind("enableContextToolbarRow.Toolbar",(function(){$(f.toolbar.find(".tablefilter-outer-wrapper")).appendTo(f.toolbar)})),e.bindSave(),tinymce.activeEditor.onUndo.listeners?(tinymce.activeEditor.onUndo.listeners.push({cb:function(){e.updateFilters()}}),tinymce.activeEditor.onRedo.listeners.push({cb:function(){e.updateFilters()}})):(tinymce.activeEditor.onUndo.add((function(){e.updateFilters()})),tinymce.activeEditor.onRedo.add((function(){e.updateFilters()})));var t,a=function(e,t){var a=$("<div/>").append(t.content),n=a.find('table[data-macro-name="table-filter"], table[data-macro-name="pivot-table"], table[data-macro-name="table-chart"], table[data-macro-name="table-joiner"]').each((function(e){var t=$(this),a=(0,c.default)(this);a.id=(new Date).getTime()+e+"_"+(0,s.hashCode)(this.outerHTML),t.attr("id",a.id),t.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(a))}));if(r.default.prototype.tableWrapper=a.find(".tablefilter-table-wrapper"),r.default.prototype.tables=r.default.prototype.tableWrapper.find("table"),r.default.prototype.editorMacro=!0,r.default.prototype.makeTablesScrollable(),0===n.length){var l=a.find("table.tf-copy-table");l.length&&(l.removeClass("tf-copy-table"),l.find("tr").filter((function(){return!i.default.isRowVisible(this)})).remove(),l.find(".fake").removeClass("fake").filter((function(){return"none"===this.style.display})).remove(),l.find(".tf-hidden-column, .tf-header-hidden").remove(),l.find('[class*="tf-rowspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-rowspan-\d+/))})),l.find('[class*="tf-colspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-colspan-\d+/))})))}t.content=a.html()},n=function(){clearTimeout(t),t=setTimeout((function(){$.each(e.tfs,(function(t,a){if(0==a.tableWrapper.closest("body").length){var r=e.contents.find('[id="'+t+'"]');r.length&&(r.attr("id",""),e.panels[t]&&(e.panels[t].remove(),e.panels[t]=null),e.createFilter(r))}}))}),100)},l=tinymce.activeEditor.plugins.confluencepaste||tinymce.activeEditor.plugins.aePaste;l.onPreProcess?(l.onPreProcess.listeners.push({cb:a}),l.onPostProcess.listeners.push({cb:n})):(tinymce.activeEditor.on("PastePreProcess",(function(e){a(tinymce.activeEditor,e)})),tinymce.activeEditor.on("PastePostProcess",n));var o={},d=function(e,t){if("mceTableInsertRowAfter"===e||"mceTableInsertRowBefore"===e||"mceTableDeleteRow"===e){var a=$(tinymce.activeEditor.selection.getNode()),r=a.closest("td.tablefilter-table-wrapper table");if(r.length){if(r.find("td[rowspan]:not(.fake)").each(((e,a)=>{var r=$(a);t?r.attr("rowspan",r.data("rowspan")):r.data("rowspan",r.attr("rowspan"))})),t){var i=a.closest("td.fake");if(i.length){var n=i.siblings("td:not(.fake)");n.length&&tinymce.activeEditor.selection.setCursorLocation(n[0])}r.find(".fake[rowspan]").remove()}if("mceTableInsertRowAfter"===e||"mceTableInsertRowBefore"===e)if(t){var l=a.closest("tr").children(),s=l.filter(".synchrony-exclude");o.count=s.length,o.total=l.length,o.data=s.map(((e,t)=>({index:t.cellIndex,classes:t.getAttribute("class")}))).toArray()}else if(o.count){var d=a.closest("tr").children();d.length>o.total-o.count&&o.data.forEach((e=>d.eq(e.index).attr("class",e.classes)))}}}};tinymce.activeEditor.onBeforeExecCommand.add((function(e,t){d(t,!0)})),tinymce.activeEditor.onExecCommand.add((function(e,t){d(t,!1)})),$("#content-title").bind("focus click",(function(){e.toolbar.find(".tablefilter-outer-wrapper .disabled").removeClass("disabled").removeAttr("disabled"),e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.contents.click((function(){e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.toolbar.delegate(".tablefilter-outer-wrapper .aui-buttons.close","click",(function(){var e=f.toolbar.find(".tablefilter-outer-wrapper"),t=e.data("id");e.hide(),$("body").append(e),$("#inline-dialog-tf-add-filter-"+t).hide(),"false"==$("#filter-menu-view-"+t+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+t).trigger("aui-button-invoke")})),tinymce.activeEditor.onBeforeExecCommand.add((function(e,t){if("mceTableDeleteRow"===t){var a=$(tinymce.activeEditor.selection.getNode());a.is("td,th")&&(a=a.parent()),a.children(".fake").remove(),a.children('[rowspan="-1"]').attr("rowspan","1")}})),AJS.bind("tf-unwrap",((t,a)=>{var r=e.tfs[a];r&&(e.destroyFilterWithObservers(a,r),delete e.tfs[a])}))},bindSave:function(){var e=this;setTimeout((function(){!Confluence.Editor.UI.isButtonEnabled||Confluence.Editor.UI.isButtonEnabled(Confluence.Editor.UI.saveButton)?(AJS.Editor.addSaveHandler((function(){e.destroyFilters()})),AJS.bind("rte-changeMode",(function(t,a){a==Confluence.Editor.MODE_PREVIEW?e.destroyFilters():a==Confluence.Editor.MODE_RICHTEXT&&($(".tablefilter-outer-wrapper").remove(),e.initFilters())}))):e.bindSave()}),200)},createFilter:function(e){var t=f,a=(0,c.default)(e[0]);if(a.id)if(e.data("tf-init")||0!==e.find('[data-macro-name="pivot-table"],[data-macro-name="table-joiner"],[data-macro-name="table-filter"]').length)t.tfs[a.id]&&(t.tfs[a.id].tables.trigger("destroy"),t.makeTablesSortable(t.tfs[a.id]));else{if(t.contents.find('[id="'+a.id+'"]').length>1)return;if(e.data("tf-init",!0),e.attr("id",a.id),e.find(".wysiwyg-macro-body:eq(0)").addClass("tablefilter-table-wrapper"),t.panels[a.id])return t.tfs[a.id].tableWrapper=e.find(".tablefilter-table-wrapper"),t.tfs[a.id].getTable(),t.tfs[a.id].normalizeTable(),t.tfs[a.id].addNumbering(),t.tfs[a.id].appendSparklines(),t.tfs[a.id].bindDOMChange(),t.tfs[a.id].makeTablesScrollable(),t.tfs[a.id].filterTable(),t.tfs[a.id].tables.trigger("destroy"),t.tfs[a.id].editorMacro=e,t.makeTablesSortable(t.tfs[a.id]),void t.bindSynchronyFiltration(e,t.tfs[a.id]);var i=a["cell-width"]?a["cell-width"].split(","):[],n=a.default?a.default.split(","):[],o=a.inverse?a.inverse.split(","):[],s=a.labels?a.labels.split("‚"):[],d=0,u=0,b=0,p=null!=a.column?a.column.split(","):[],h=t.getFilterObjects(p,s,n,i,o,d,u,b);d+=p.length,u+=p.length,b+=p.length,p=null!=a.userfilter?a.userfilter.split(","):[];var m=t.getFilterObjects(p,s,n,i,o,d,u,b);d+=p.length,u+=p.length,b+=p.length,p=null!=a.numberfilter?a.numberfilter.split(","):[];var v=t.getFilterObjects(p,s,n,i,o,d,-1,b);d+=p.length,b+=p.length,p=null!=a.datefilter?a.datefilter.split(","):[];var g=t.getFilterObjects(p,s,n,i,o,d,-1,b);d+=p.length,b+=p.length;var y=(p="true"==a.globalFilter?["Filter whole table"]:[]).length?t.getFilterObjects(p,s,n,i,o,d,u,b)[0]:null;d+=p.length,u+=p.length,b+=p.length;var w=(p="true"==a.hideColumns?["Hide columns"]:[]).length?t.getFilterObjects(p,s,n,i,o,d,u,b)[0]:null;d+=p.length,u+=p.length,b+=p.length,p=null!=a.iconfilter?a.iconfilter.split(","):[];var E=t.getFilterObjects(p,s,n,i,o,d,u,b),F=$(l().panel({macroId:a.id,pageId:AJS.params.pageId,comboBoxes:h,edits:m,numberFilters:v,dateFilters:g,globalFilter:y,hideColumns:w,iconFilters:E,showNRowsifNotFiltered:a.showNRowsifNotFiltered,hideLabels:a.hidelabels,disableSave:a.disableSave,hideControls:a.hideControls,hidePane:!1,fd:!1,editable:!0,isEditor:!0,sessionId:1,isMacroViewContext:!1}));F.addClass("toolbar-contextual"),F.append(l().editorCloseButton()),t.panels[a.id]=F,$("body").append(F);var S=$.extend(!0,{},a);S.macroParams=a,S.ddSeparator=(S.ddSeparator||"").replace(/\\u0020/g," "),S.ddOperator=S.ddOperator||"",S.showNRows=S.showNRows||"all",S.heightValue=S.heightValue||"",S.numbering=S.numbering||"",S.sorts=a.sort?$.map(a.sort.split(","),(function(e){return e.replace(/‚/g,",")})):[],S.separator=S.separator?S.separator.replace("Point (.)",".").replace("Comma (,)",","):".",S.pageId=AJS.params.pageId,S.sparkline="true"===S.sparkline,S.sparkName=S.sparkName||"",S.isLockEnabled="true"!==S.enabledInEditor||e.attr("type"),S.thousandSeparator=(a.thousandSeparator||"").replace("\\u0020"," "),S.tabs=!1,S.editorMacro=e,t.tfs[a.id]=new r.default(S),S.isLockEnabled&&t.tfs[a.id].showTable(!0),t.makeTablesSortable(t.tfs[a.id]),F.hide();var C=f.toolbar.find(".tablefilter-outer-wrapper");C.length>0&&0===t.tfs[C.data("id")].tableWrapper.parents("body").length&&(C.remove(),F.show(),F.find(".enableLock:visible").click(),f.toolbar.append(F)),t.bindSynchronyFiltration(e,t.tfs[a.id])}},bindSynchronyFiltration:function(e,t){var a=this;e.attr("type")?(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type")))):t.cbState.length&&t.showOrHideTables(),t.observerMacro||(t.observerMacro=new MutationObserver((function(r){r.forEach((function(r){"type"===r.attributeName?e.data("tf-self")?e.data("tf-self",!1):(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type")))):("id"===r.attributeName&&e.data("tf-init")&&r.oldValue&&e.attr("id")&&r.oldValue!==e.attr("id")||"class"===r.attributeName&&r.oldValue&&-1!==r.oldValue.indexOf("tablefilter-table-wrapper")&&r.target.className&&-1===r.target.className.indexOf("tablefilter-table-wrapper")||"data-macro-parameters"===r.attributeName&&!e.attr("type"))&&(a.destroyFilterWithObservers(t.macroId,t),delete a.panels[t.macroId],delete a.tfs[t.macroId],e.data("tf-init",""),a.createFilter(e))}))})),t.observerMacro.observe(e[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["type","id","class","data-macro-parameters"]}),t.observerMacro.observe(t.tableWrapper[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}))},makeTablesSortable:function(e){e.sorting=!0,e.setMutationObserver(!0),e.tables.tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat,textExtraction:function(e){return i.default.getEditorCellText(e)}}),e.sorting=!1,e.setMutationObserver(!0)},destroyFilters:function(){var e=this;$.each(e.tfs,(function(t,a){e.destroyFilterWithObservers(t,a)})),e.tfs={}},destroyFilterWithObservers:function(e,t){var a=this;t.observer&&t.observer.disconnect(),t.observerMacro&&t.observerMacro.disconnect(),t.observersTd&&t.observersTd.length&&t.observersTd.forEach((function(e){e.disconnect()})),a.destroyFilter(t),a.cleanMacro(e),a.removePanel(e)},cleanMacro:function(e){return this.contents.find('[id="'+e+'"]').data("tf-init",!1).attr("id","")},removePanel:function(e){var t=this;t.panels[e]&&(t.panels[e].remove(),t.panels[e]=null)},destroyFilter:function(e){e.numbering="",e.fixedRows=0,e.editorSave=!0,e.showTableWithoutFilters(),e.addNumbering(),e.makeTablesScrollable(),e.tables.data("tf-merged-done",!1),e.tables.find(".fake").remove(),e.tables.trigger("destroy"),e.tables.find(".tablesorter-header").removeClass("tablesorter-header"),e.tables.find(".pivot-header").removeClass("pivot-header"),e.tables.find('[data-mce-style="display: none;"]').removeAttr("data-mce-style"),e.tables.find(".tf-sparkline-header, .tf-sparkline-container, .total-row, .total-col, .tf-header-hidden").remove(),e.tables.each((function(){$(this).data("fixed-header",!1)})),o.default.remove(e.tableWrapper)},updateFilters:function(){var e=this;$.each(e.tfs,(function(t,a){if(a.editorMacro.parent().length)a.tables.trigger("destroy"),e.makeTablesSortable(a),a.bindDOMChange();else{var r=e.cleanMacro(t);e.removePanel(t),e.createFilter(r)}}))},getFilterObjects:function(e,t,a,r,i,n,l,o){var s=[];return $.each(e,(function(e,d){var c=n+e,f=a.length>c?a[c].replace(/‚/g,",").trim():"",u=f?f.replace(new RegExp("-Empty-","g"),"").split("&&"):[],b=f.split("->");s.push({label:t.length>o+e&&t[o+e]||d,name:d,defaultValue:f,columnWidth:l>-1&&r.length>l+e&&r[l+e]||"150",options:u,defaultFromValue:b[0],defaultToValue:b.length>1?b[1]:"",inverse:i.length>c&&"true"==i[c]})})),s}},u=f,b=a(99497);try{AJS.bind("init.rte",(function(){u.init(),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("show-tf",(function(e,t){var a=$(t),r=u.toolbar.find(".tablefilter-outer-wrapper"),i=r.data("id");r.hide(),$("body").append(r),$("#inline-dialog-tf-add-filter-"+i).hide(),"false"==$("#filter-menu-view-"+i+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+i).trigger("aui-button-invoke");var n=$(".macro-property-panel-show-tf").hasClass("hide-tf");if(b.default.gaShowFilter(n),!n){var l=u.panels[a.attr("id")];l.show(),l.find(".enableLock").click(),u.toolbar.append(l)}})),$("body").delegate("button:has(.aui-iconfont-table-split, .aui-iconfont-table-col-left, .aui-iconfont-table-col-right, .aui-iconfont-table-row-remove, .aui-iconfont-table-col-remove, .table-split-cells, .table-insert-column-before,.table-insert-column-after, .table-delete-row, .table-delete-column)","mouseup",(function(){if(!$(this).is(".disabled")){var e=$(tinymce.activeEditor.selection.getNode());e.is("table")||(e=e.parents("table").eq(0)),e.find(".fake").remove()}}))}))}catch(e){}}},a={};function r(e){var i=a[e];if(void 0!==i)return i.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.loaded=!0,n.exports}r.m=t,r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},e=[],r.O=function(t,a,i,n){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],i=e[c][1],n=e[c][2];for(var o=!0,s=0;s<a.length;s++)(!1&n||l>=n)&&Object.keys(r.O).every((function(e){return r.O[e](a[s])}))?a.splice(s--,1):(o=!1,n<l&&(l=n));if(o){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,i,n]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={6709:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,n,l=a[0],o=a[1],s=a[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(i in o)r.o(o,i)&&(r.m[i]=o[i]);if(s)var c=s(r)}for(t&&t(a);d<l.length;d++)n=l[d],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},a=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var i=r.O(void 0,[8556,2295,3353,7874,6305,5546,9150,5654,8018,5260,5761,9352,2166,3926,4818,3931,1706,479,3924,2240],(function(){return r(14071)}));i=r.O(i)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/vendor/jquery.stickytableheaders.js' */
/*
 Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
 MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
(function(b,k,p){function l(e,g){var a=this;a.$el=b(e);a.el=e;a.id=m++;a.$el.bind("destroyed",b.proxy(a.teardown,a));a.$clonedHeader=null;a.$originalHeader=null;a.cachedHeaderHeight=null;a.isSticky=!1;a.hasBeenSticky=!1;a.leftOffset=null;a.topOffset=null;a.init=function(){a.setOptions(g);a.$el.each(function(){var d=b(this);d.css("padding",0);a.$originalHeader=b("thead:first",this);a.$clonedHeader=a.$originalHeader.clone();d.trigger("clonedHeader.stickyTableHeaders",[a.$clonedHeader]);a.$clonedHeader.addClass("tableFloatingHeader");
a.$clonedHeader.css("display","none");a.$originalHeader.addClass("tableFloatingHeaderOriginal");a.$originalHeader.after(a.$clonedHeader);a.$printStyle=b('\x3cstyle type\x3d"text/css" media\x3d"print"\x3e.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}\x3c/style\x3e');a.$head.append(a.$printStyle)});a.updateWidth();a.toggleHeaders();a.bind()};a.destroy=function(){a.$el.unbind("destroyed",a.teardown);a.teardown()};a.teardown=function(){a.isSticky&&
a.$originalHeader.css("position","static");b.removeData(a.el,"plugin_stickyTableHeaders");a.unbind();a.$clonedHeader.remove();a.$originalHeader.removeClass("tableFloatingHeaderOriginal");a.$originalHeader.css("visibility","visible");a.$printStyle.remove();a.el=null;a.$el=null};a.bind=function(){a.$scrollableArea.on("scroll.stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.on("scroll.stickyTableHeaders"+a.id,a.setPositionValues),a.$window.on("resize.stickyTableHeaders"+a.id,a.toggleHeaders));
a.$scrollableArea.on("resize.stickyTableHeaders",a.toggleHeaders);a.$scrollableArea.on("resize.stickyTableHeaders",a.updateWidth)};a.unbind=function(){a.$scrollableArea.off(".stickyTableHeaders",a.toggleHeaders);a.isWindowScrolling||(a.$window.off(".stickyTableHeaders"+a.id,a.setPositionValues),a.$window.off(".stickyTableHeaders"+a.id,a.toggleHeaders));a.$scrollableArea.off(".stickyTableHeaders",a.updateWidth)};a.debounce=function(a,b){var d=null;return function(){var c=this,h=arguments;clearTimeout(d);
d=setTimeout(function(){a.apply(c,h)},b)}};a.toggleHeaders=a.debounce(function(){a.$el&&a.$el.each(function(){var d=b(this),h=a.isWindowScrolling?isNaN(a.options.fixedOffset)?a.options.fixedOffset.outerHeight():a.options.fixedOffset:a.$scrollableArea.offset().top+(isNaN(a.options.fixedOffset)?0:a.options.fixedOffset);var f=d.offset();var c=a.$scrollableArea.scrollTop()+h,e=a.$scrollableArea.scrollLeft(),g=a.options.cacheHeaderHeight?a.cachedHeaderHeight:a.$clonedHeader.height(),k=a.isWindowScrolling?
c>f.top:h>f.top;c=(a.isWindowScrolling?c:0)<f.top+d.height()-g-(a.isWindowScrolling?0:h);k&&c?(f=f.left-e+a.options.leftOffset,a.$originalHeader.css({position:"fixed","margin-top":a.options.marginTop,left:f,"z-index":3}),a.leftOffset=f,a.topOffset=h,a.$clonedHeader.css("display",""),a.isSticky||(a.isSticky=!0,a.updateWidth(),d.trigger("enabledStickiness.stickyTableHeaders")),a.setPositionValues()):a.isSticky&&(a.$originalHeader.css("position","static"),a.$clonedHeader.css("display","none"),a.isSticky=
!1,a.resetWidth(b("td,th",a.$clonedHeader),b("td,th",a.$originalHeader)),d.trigger("disabledStickiness.stickyTableHeaders"))})},0);a.setPositionValues=a.debounce(function(){var d=a.$window.scrollTop(),b=a.$window.scrollLeft();!a.isSticky||0>d||d+a.$window.height()>a.$document.height()||0>b||b+a.$window.width()>a.$document.width()||a.$originalHeader.css({top:a.topOffset-(a.isWindowScrolling?0:d),left:a.leftOffset-(a.isWindowScrolling?0:b)})},0);a.updateWidth=a.debounce(function(){if(a.isSticky){a.$originalHeaderCells||
(a.$originalHeaderCells=b("th,td",a.$originalHeader));a.$clonedHeaderCells||(a.$clonedHeaderCells=b("th,td",a.$clonedHeader));var d=a.getWidth(a.$clonedHeaderCells);a.setWidth(d,a.$clonedHeaderCells,a.$originalHeaderCells);a.$originalHeader.css("width",a.$clonedHeader.width());a.options.cacheHeaderHeight&&(a.cachedHeaderHeight=a.$clonedHeader.height())}},0);a.getWidth=function(d){var h=[];d.each(function(d){var c=b(this);if("border-box"===c.css("box-sizing"))c=c[0].getBoundingClientRect(),c=c.width?
c.width:c.right-c.left;else if("collapse"===b("th",a.$originalHeader).css("border-collapse"))if(k.getComputedStyle)c=parseFloat(k.getComputedStyle(this,null).width);else{var f=parseFloat(c.css("padding-left")),e=parseFloat(c.css("padding-right")),g=parseFloat(c.css("border-width"));c=c.outerWidth()-f-e-g}else c=c.width();h[d]=c});return h};a.setWidth=function(a,b,f){b.each(function(b){var c=a[b];f.eq(b).css({"min-width":c,"max-width":c})})};a.resetWidth=function(a,e){a.each(function(a){var c=b(this);
e.eq(a).css({"min-width":c.css("min-width"),"max-width":c.css("max-width")})})};a.setOptions=function(d){a.options=b.extend({},n,d);a.$window=b(a.options.objWindow);a.$head=b(a.options.objHead);a.$document=b(a.options.objDocument);a.$scrollableArea=b(a.options.scrollableArea);a.isWindowScrolling=a.$scrollableArea[0]===a.$window[0]};a.updateOptions=function(b){a.setOptions(b);a.unbind();a.bind();a.updateWidth();a.toggleHeaders()};a.init()}var m=0,n={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,
objHead:"head",objWindow:k,scrollableArea:k,cacheHeaderHeight:!1};b.fn.stickyTableHeaders=function(e){return this.each(function(){var g=b.data(this,"plugin_stickyTableHeaders");g?"string"===typeof e?g[e].apply(g):g.updateOptions(e):"destroy"!==e&&b.data(this,"plugin_stickyTableHeaders",new l(this,e))})}})(jQuery,window);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/utils.js' */
define("sticky-table-headers/utils",["jquery"],function(c){var e=function(){return!c("body").hasClass("theme-documentation")};return{isAValidTable:function(a){a=c(a);var d;if(d=e()&&!a.hasClass("stickyTableHeaders")&&0< !a.closest(".columnLayout").length&&0< !a.parents("table").length&&a.find("\x3e thead:first").is(":visible")&&1===a.find("thead").children().length&&1===a.find(".confluenceTh").parent().length)d=0===a.find(".confluenceTh").siblings().length||0===a.find(".confluenceTh").siblings().not(".confluenceTh").length;
return d},bindHorizontalScrolling:function(a,d){var b=d||c(window);a.closest(".table-wrap").scroll(function(){b.trigger("scroll.stickyTableHeaders")})},moveHeaderRowsToTHead:function(a){c(a).each(function(){var a=c(this);if(!(0<a.find("\x3e thead").length)){var b=a.find("\x3e tbody \x3e :first-child \x3e :first-child.confluenceTh");!(0>=b.length||0<b.parent().find("\x3e .confluenceTh[rowspan]").length)&&0< !a.parents("table").length&&0< !a.closest(".columnLayout").length&&(b=c("\x3cthead /\x3e").append(b.parent()),
a.prepend(b))}})},isNotDocumentationTheme:e}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/viewpage.js' */
define("sticky-table-headers/viewpage",["jquery","ajs","sticky-table-headers/utils"],function(c,h,d){var f,b,g,k=function(a,e){a=c(a).filter(function(){return d.isAValidTable(this)});a.stickyTableHeaders(e).addClass("stickyTableHeaders");g?g.add(a):g=a;e=function(a,e){g.stickyTableHeaders(e)};b&&h.unbind("sticky-table-headers.change.options",b);h.bind("sticky-table-headers.change.options",e);b=e;d.bindHorizontalScrolling(a)};return{initialize:function(){var a=c(".confluenceTable:not(.stickyTableHeaders)"),
e=c(window);if(d.isNotDocumentationTheme()){d.moveHeaderRowsToTHead(a);if(window.MutationObserver){a=document.querySelector("#page")||document.querySelector("#confluence-ui");var g=/sticky|tableFloating|confluenceTh/,b=new MutationObserver(c.debounce(function(a){for(var b=!1,c,d=0,f=a.length;d<f;d++)if(c=a[d].target.className,!g.test(c)){b=!0;break}b&&e.trigger("resize.stickyTableHeaders")},0));f&&f.unobserve&&f.unobserve();b.observe(a,{subtree:!0,attributes:!0,childList:!0});f=b}k(c(".confluenceTable"),
{cacheHeaderHeight:!0})}},setupTable:k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/editor.js' */
define("sticky-table-headers/editor",["ajs","jquery","sticky-table-headers/utils"],function(f,c,e){var h=function(a){var b={};b.objWindow=c(a.getWin());b.scrollableArea=b.objWindow;b.objDocument=c(a.getDoc());b.objHead=b.objDocument.find("head");return b},g=function(a,b){var d=f.Rte.getEditor();d&&(d=h(d),b=c.extend({},d,b),a=c(a).filter(function(){return e.isAValidTable(this)}),a.stickyTableHeaders(b).addClass("stickyTableHeaders"),e.bindHorizontalScrolling(a,b.objWindow))};return{initialize:function(){var a=
f.Rte.getEditor();a&&(a=c(a.getBody()).find(".confluenceTable"),e.moveHeaderRowsToTHead(a),g(a))},setupTable:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/stickytableheaders.js' */
define("sticky-table-headers",["ajs","sticky-table-headers/viewpage","sticky-table-headers/editor","skate"],function(a,d,b,c){var e=a.debounce(d.initialize,0);return{initialize:function(){a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers.disabled")||c("confluenceTable",{type:c.types.CLASS,attached:function(a){e()}});a.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers-editor")&&(a.bind("rte-ready",b.initialize),a.bind("rte-quick-edit-push-state",b.initialize),
a.bind("rte-quick-edit-push-hash",b.initialize))}}});require("sticky-table-headers").initialize();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.scandio.confluence.plugins.infineon.infineon-toolbox:macro-menu-customization-web-resources', location = 'inftoolbox/modules/macro-menu/macro-menu-customization.js' */
(function(){function c(b){return function(a,c){aIndex=b.indexOf(a.classList[1]);bIndex=b.indexOf(c.classList[1]);return aIndex<bIndex?-1:aIndex>bIndex?1:0}}function d(b,a){AJS.$(a).find("a \x3e span.icon").addClass(e[a.classList[1]])}const f=["content-wikimarkup","content-hr","content-date","content-emoticon","content-symbol"],g="macro-insertmention-button macro-toc macro-details macro-expand macro-info macro-status macro-jiralink macro-code macro-gliffy macro-panel macro-children macro-viewxls macro-viewppt macro-viewdoc macro-viewpdf content-macro".split(" "),
e={"macro-details":"aui-icon aui-icon-small aui-iconfont-room-menu","macro-code":"aui-icon aui-icon-small aui-iconfont-code","macro-panel":"aui-icon aui-icon-small aui-iconfont-queues","macro-children":"aui-icon aui-icon-small aui-iconfont-table-of-contents","macro-viewxls":"infineon-viewxls-icon","macro-viewppt":"infineon-viewppt-icon","macro-viewdoc":"infineon-viewdoc-icon","macro-viewpdf":"infineon-viewpdf-icon"};AJS.toInit(function(){var b=AJS.$("div#insert-menu-options ul#content-insert-list"),
a=b.find("li");a.sort(c(f));a.each(d);b.append(a);b=AJS.$("div#insert-menu-options ul#macro-insert-list");a=b.find("li");a.sort(c(g));a.each(d);b.append(a)})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:nh-editor-events', location = 'js/nh-editor-events.js' */
/*
 * Copyright (c) 2022 Appfire Technologies, LLC.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Appfire EULA"
 * (https://appfire.com/eula/) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */

(function () {
  const AJS = require('ajs')
  const tinymce = require('tinymce')

  AJS.toInit(function ($) {
    function onEdit () {
      sendEvent('edit')
    }

    function onSave () {
      sendEvent('save')
    }

    function onCancel () {
      sendEvent('cancel')
    }

    AJS.bind('show.dialog', function (e, d) {
      if (d.dialog.id === 'macro-browser-dialog') {
        onEdit()
        $('#macro-details-page button.ok').on('click', onSave)
        $('#macro-details-page a.button-panel-cancel-link').on('click', onCancel)
      }
    })

    AJS.bind('hide.dialog', function (e, d) {
      if (d.dialog.id === 'macro-browser-dialog') {
        $('#macro-details-page button.ok').off('click', onSave)
        $('#macro-details-page a.button-panel-cancel-link').off('click', onCancel)
      }
    })
  })

  function sendEvent (action) {
    const macro = AJS.MacroBrowser.selectedMacroDefinition
    if (macro && macro.name === 'numberedheadings') {
      const macroId = AJS.$(tinymce.confluence.macrobrowser.getCurrentNode()).attr('data-macro-id')

      let url = AJS.contextPath() + '/rest/numberedheadings/1.0/event/macro-edit/' + AJS.params.pageId + '/' + macro.name + '/' + action + '?'
      url += 'isNew=' + !macroId
      if (macroId) { url += '&macroId=' + macroId }
      AJS.$.ajax({
        url: url,
        type: 'POST',
        data: JSON.stringify(macro.params),
        contentType: 'application/json; charset=utf-8',
        traditional: true,
        error: function (jqXHR) {
          AJS.log(jqXHR.responseText)
        }
      })
    }
  }
})()

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_vendors~nh-tinymce-plugin', location = 'vendors~nh-tinymce-plugin.273f3052385033bc5931.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[13],[,,,function(e,t,o){var r=o(33),n="object"==typeof self&&self&&self.Object===Object&&self,a=r||n||Function("return this")();e.exports=a},,,function(e,t,o){var r=o(73),n=o(79);e.exports=function(e,t){var o=n(e,t);return r(o)?o:void 0}},function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},,function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}var n=o(63),a=o(64),p=o(65),s=o(66),c=o(67);r.prototype.clear=n,r.prototype["delete"]=a,r.prototype.get=p,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,o){var r=o(19);e.exports=function(e,t){for(var o=e.length;o--;)if(r(e[o][0],t))return o;return-1}},function(e,t,o){function r(e){return null==e?void 0===e?c:s:l&&l in Object(e)?a(e):p(e)}var n=o(13),a=o(75),p=o(76),s="[object Null]",c="[object Undefined]",l=n?n.toStringTag:void 0;e.exports=r},function(e,t,o){var r=o(3),n=r.Symbol;e.exports=n},function(e,t,o){var r=o(6),n=r(Object,"create");e.exports=n},function(e,t,o){var r=o(88);e.exports=function(e,t){var o=e.__data__;return r(t)?o["string"==typeof t?"string":"hash"]:o.map}},function(e){var t=Array.isArray;e.exports=t},function(e,t,o){var r=o(110),n=o(20),a=o(111),p=o(112),s=o(113),c=o(12),l=o(34),i="[object Map]",y="[object Promise]",d="[object Set]",x="[object WeakMap]",b="[object DataView]",h=l(r),u=l(n),g=l(a),_=l(p),f=l(s),j=c;(r&&j(new r(new ArrayBuffer(1)))!=b||n&&j(new n)!=i||a&&j(a.resolve())!=y||p&&j(new p)!=d||s&&j(new s)!=x)&&(j=function(e){var t=c(e),o=t=="[object Object]"?e.constructor:void 0,r=o?l(o):"";if(r)switch(r){case h:return b;case u:return i;case g:return y;case _:return d;case f:return x;}return t}),e.exports=j},function(e,t,o){var r=o(47),n=o(48);e.exports=function(e,t,o,a){var p=!o;o||(o={});for(var s=-1,c=t.length;++s<c;){var l=t[s],i=a?a(o[l],e[l],l,o,e):void 0;i===void 0&&(i=e[l]),p?n(o,l,i):r(o,l,i)}return o}},function(e){e.exports=function(e,t){return e===t||e!==e&&t!==t}},function(e,t,o){var r=o(6),n=o(3),a=r(n,"Map");e.exports=a},function(e,t,o){var r=o(101),n=o(41),a=Object.prototype,p=a.propertyIsEnumerable,s=Object.getOwnPropertySymbols,c=s?function(e){return null==e?[]:(e=Object(e),r(s(e),function(t){return p.call(e,t)}))}:n;e.exports=c},function(e,t,o){var r=o(42),n=o(108),a=o(46);e.exports=function(e){return a(e)?r(e):n(e)}},function(e,t,o){(function(e){var r=o(3),n=o(105),a=t&&!t.nodeType&&t,p=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=p&&p.exports===a,c=s?r.Buffer:void 0,l=c?c.isBuffer:void 0;e.exports=l||n}).call(this,o(24)(e))},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e){e.exports=function(e){return function(t){return e(t)}}},function(e,t,o){(function(e){var r=o(33),n=t&&!t.nodeType&&t,a=n&&"object"==typeof e&&e&&!e.nodeType&&e,p=a&&a.exports===n,s=p&&r.process,c=function(){try{var e=a&&a.require&&a.require("util").types;return e?e:s&&s.binding&&s.binding("util")}catch(t){}}();e.exports=c}).call(this,o(24)(e))},function(e){var t=Object.prototype;e.exports=function(e){var o=e&&e.constructor,r="function"==typeof o&&o.prototype||t;return e===r}},function(e,t,o){var r=o(42),n=o(119),a=o(46);e.exports=function(e){return a(e)?r(e,!0):n(e)}},function(e,t,o){var r=o(37);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,o){e.exports=o(60)},function(e,t,o){function r(e){var t=this.__data__=new n(e);this.size=t.size}var n=o(10),a=o(68),p=o(69),s=o(70),c=o(71),l=o(72);r.prototype.clear=a,r.prototype["delete"]=p,r.prototype.get=s,r.prototype.has=c,r.prototype.set=l,e.exports=r},function(e,t,o){var r=o(12),n=o(9);e.exports=function(e){if(!n(e))return!1;var t=r(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"}},function(e,t,o){(function(t){var o="object"==typeof t&&t&&t.Object===Object&&t;e.exports=o}).call(this,o(74))},function(e){var t=Function.prototype,o=t.toString;e.exports=function(e){if(null!=e){try{return o.call(e)}catch(t){}try{return e+""}catch(t){}}return""}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}var n=o(80),a=o(87),p=o(89),s=o(90),c=o(91);r.prototype.clear=n,r.prototype["delete"]=a,r.prototype.get=p,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,o){var r=o(92),n=o(95),a=o(96);e.exports=function(e,t,o,p,s,c){var l=o&1,i=e.length,y=t.length;if(i!=y&&!(l&&y>i))return!1;var d=c.get(e),x=c.get(t);if(d&&x)return d==t&&x==e;var b=-1,h=!0,u=o&2?new r:void 0;for(c.set(e,t),c.set(t,e);++b<i;){var g=e[b],_=t[b];if(p)var f=l?p(_,g,b,t,e,c):p(g,_,b,e,t,c);if(void 0!==f){if(f)continue;h=!1;break}if(u){if(!n(t,function(e,t){if(!a(u,t)&&(g===e||s(g,e,o,p,c)))return u.push(t)})){h=!1;break}}else if(!(g===_||s(g,_,o,p,c))){h=!1;break}}return c["delete"](e),c["delete"](t),h}},function(e,t,o){var r=o(3),n=r.Uint8Array;e.exports=n},function(e,t,o){var r=o(39),n=o(21),a=o(22);e.exports=function(e){return r(e,a,n)}},function(e,t,o){var r=o(40),n=o(16);e.exports=function(e,t,o){var a=t(e);return n(e)?a:r(a,o(e))}},function(e){e.exports=function(e,t){for(var o=-1,r=t.length,n=e.length;++o<r;)e[n+o]=t[o];return e}},function(e){e.exports=function(){return[]}},function(e,t,o){var r=o(102),n=o(103),a=o(16),p=o(23),s=o(106),c=o(43),l=Object.prototype,i=l.hasOwnProperty;e.exports=function(e,t){var o=a(e),l=!o&&n(e),y=!o&&!l&&p(e),d=!o&&!l&&!y&&c(e),x=o||l||y||d,b=x?r(e.length,String):[],h=b.length;for(var u in e)(t||i.call(e,u))&&!(x&&("length"==u||y&&("offset"==u||"parent"==u)||d&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||s(u,h)))&&b.push(u);return b}},function(e,t,o){var r=o(107),n=o(25),a=o(26),p=a&&a.isTypedArray,s=p?n(p):r;e.exports=s},function(e){e.exports=function(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=9007199254740991}},function(e){e.exports=function(e,t){return function(o){return e(t(o))}}},function(e,t,o){var r=o(32),n=o(44);e.exports=function(e){return null!=e&&n(e.length)&&!r(e)}},function(e,t,o){function r(e,t,o){var r=e[t];s.call(e,t)&&a(r,o)&&(o!==void 0||t in e)||n(e,t,o)}var n=o(48),a=o(19),p=Object.prototype,s=p.hasOwnProperty;e.exports=r},function(e,t,o){var r=o(116);e.exports=function(e,t,o){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}},function(e,t,o){var r=o(40),n=o(50),a=o(21),p=o(41),s=Object.getOwnPropertySymbols,c=s?function(e){for(var t=[];e;)r(t,a(e)),e=n(e);return t}:p;e.exports=c},function(e,t,o){var r=o(45),n=r(Object.getPrototypeOf,Object);e.exports=n},,function(e){function t(e,t,o,r,n,a,p){try{var s=e[a](p),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}e.exports=function(e){return function(){var o=this,r=arguments;return new Promise(function(n,a){function p(e){t(c,n,a,p,s,"next",e)}function s(e){t(c,n,a,p,s,"throw",e)}var c=e.apply(o,r);p(void 0)})}}},function(e,t,o){var r=o(61);e.exports=function(e,t){return r(e,t)}},function(e,t,o){var r=o(114);e.exports=function(e){return r(e,1|4)}},function(e){"use strict";function t(e){return"function"==typeof e?e():e}function o(){var e={};return e.promise=new Promise(function(t,o){e.resolve=t,e.reject=o}),e}e.exports=function(e){function r(){var t=s;clearTimeout(c),Promise.resolve(a.accumulate?e.call(this,l):e.apply(this,l[l.length-1])).then(t.resolve,t.reject),l=[],s=null}var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},p=void 0,s=void 0,c=void 0,l=[];return function(){var i=t(n),y=new Date().getTime(),d=!p||y-p>i;p=y;for(var x=arguments.length,b=Array(x),h=0;h<x;h++)b[h]=arguments[h];if(d&&a.leading)return a.accumulate?Promise.resolve(e.call(this,[b])).then(function(e){return e[0]}):Promise.resolve(e.call.apply(e,[this].concat(b)));if(s?clearTimeout(c):s=o(),l.push(b),c=setTimeout(r.bind(this),i),a.accumulate){var u=l.length-1;return s.promise.then(function(e){return e[u]})}return s.promise}}},,,,,function(e){var t=function(e){"use strict";function t(e,t,o,n){var a=t&&t.prototype instanceof r?t:r,p=Object.create(a.prototype),s=new d(n||[]);return p._invoke=c(e,o,s),p}function o(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}function r(){}function n(){}function a(){}function p(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(r,n,a,p){var s=o(e[r],e,n);if("throw"===s.type)p(s.arg);else{var c=s.arg,l=c.value;return l&&"object"==typeof l&&u.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,a,p)},function(e){t("throw",e,a,p)}):Promise.resolve(l).then(function(e){c.value=e,a(c)},function(e){return t("throw",e,a,p)})}}function r(e,o){function r(){return new Promise(function(r,n){t(e,o,r,n)})}return n=n?n.then(r,r):r()}var n;this._invoke=r}function c(e,t,r){var n=m;return function(a,p){if(n===A)throw new Error("Generator is already running");if(n===S){if("throw"===a)throw p;return b()}for(r.method=a,r.arg=p;;){var s=r.delegate;if(s){var c=l(s,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===m)throw n=S,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=A;var i=o(e,t,r);if("normal"===i.type){if(n=r.done?S:w,i.arg===v)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(n=S,r.method="throw",r.arg=i.arg)}}}function l(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,l(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=o(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var a=n.arg;if(!a)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v;if(a.done)t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0);else return a;return t.delegate=null,v}function i(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(i,this),this.reset(!0)}function x(e){if(e){var t=e[_];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function t(){for(;++o<e.length;)if(u.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:b}}function b(){return{value:void 0,done:!0}}var h=Object.prototype,u=h.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},_=g.iterator||"@@iterator",f=g.asyncIterator||"@@asyncIterator",j=g.toStringTag||"@@toStringTag";e.wrap=t;var m="suspendedStart",w="suspendedYield",A="executing",S="completed",v={},k={};k[_]=function(){return this};var L=Object.getPrototypeOf,O=L&&L(L(x([])));O&&O!==h&&u.call(O,_)&&(k=O);var E=a.prototype=r.prototype=Object.create(k);return n.prototype=E.constructor=a,a.constructor=n,a[j]=n.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,!(j in e)&&(e[j]="GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},p(s.prototype),s.prototype[f]=function(){return this},e.AsyncIterator=s,e.async=function(o,r,n,a){var p=new s(t(o,r,n,a));return e.isGeneratorFunction(r)?p:p.next().then(function(e){return e.done?e.value:p.next()})},p(E),E[j]="Generator",E[_]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var r=t.pop();if(r in e)return o.value=r,o.done=!1,o}return o.done=!0,o}},e.values=x,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(y),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return a.type="throw",a.arg=e,o.next=t,r&&(o.method="next",o.arg=void 0),!!r}if(this.done)throw e;for(var o=this,r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r],a=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var p=u.call(n,"catchLoc"),s=u.call(n,"finallyLoc");if(p&&s){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(p){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);}else if(!s)throw new Error("try statement without catch or finally");else if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}},abrupt:function(e,t){for(var o,r=this.tryEntries.length-1;0<=r;--r)if(o=this.tryEntries[r],o.tryLoc<=this.prev&&u.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),y(t),v},catch:function(e){for(var t,o=this.tryEntries.length-1;0<=o;--o)if(t=this.tryEntries[o],t.tryLoc===e){var r=t.completion;if("throw"===r.type){var n=r.arg;y(t)}return n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:x(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},function(e,t,o){function r(e,t,o,p,s){return!(e!==t)||(null!=e&&null!=t&&(a(e)||a(t))?n(e,t,o,p,r,s):e!==e&&t!==t)}var n=o(62),a=o(7);e.exports=r},function(e,t,o){var r=o(31),n=o(36),a=o(97),p=o(100),s=o(17),c=o(16),l=o(23),i=o(43),y="[object Arguments]",d="[object Array]",x="[object Object]",b=Object.prototype,h=b.hasOwnProperty;e.exports=function(e,t,o,b,u,g){var _=c(e),f=c(t),j=_?d:s(e),m=f?d:s(t);j=j==y?x:j,m=m==y?x:m;var w=j==x,A=m==x,S=j==m;if(S&&l(e)){if(!l(t))return!1;_=!0,w=!1}if(S&&!w)return g||(g=new r),_||i(e)?n(e,t,o,b,u,g):a(e,t,j,o,b,u,g);if(!(o&1)){var v=w&&h.call(e,"__wrapped__"),k=A&&h.call(t,"__wrapped__");if(v||k){var L=v?e.value():e,O=k?t.value():t;return g||(g=new r),u(L,O,o,b,g)}}return!!S&&(g||(g=new r),p(e,t,o,b,u,g))}},function(e){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,o){var r=o(11),n=Array.prototype,a=n.splice;e.exports=function(e){var t=this.__data__,o=r(t,e);if(0>o)return!1;var n=t.length-1;return o==n?t.pop():a.call(t,o,1),--this.size,!0}},function(e,t,o){var r=o(11);e.exports=function(e){var t=this.__data__,o=r(t,e);return 0>o?void 0:t[o][1]}},function(e,t,o){var r=o(11);e.exports=function(e){return-1<r(this.__data__,e)}},function(e,t,o){var r=o(11);e.exports=function(e,t){var o=this.__data__,n=r(o,e);return 0>n?(++this.size,o.push([e,t])):o[n][1]=t,this}},function(e,t,o){var r=o(10);e.exports=function(){this.__data__=new r,this.size=0}},function(e){e.exports=function(e){var t=this.__data__,o=t["delete"](e);return this.size=t.size,o}},function(e){e.exports=function(e){return this.__data__.get(e)}},function(e){e.exports=function(e){return this.__data__.has(e)}},function(e,t,o){var r=o(10),n=o(20),a=o(35);e.exports=function(e,t){var o=this.__data__;if(o instanceof r){var p=o.__data__;if(!n||p.length<200-1)return p.push([e,t]),this.size=++o.size,this;o=this.__data__=new a(p)}return o.set(e,t),this.size=o.size,this}},function(e,t,o){var r=o(32),n=o(77),a=o(9),p=o(34),s=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,l=Function.prototype,i=Object.prototype,y=l.toString,d=i.hasOwnProperty,x=RegExp("^"+y.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){if(!a(e)||n(e))return!1;var t=r(e)?x:c;return t.test(p(e))}},function(e){var t=function(){return this}();try{t=t||new Function("return this")()}catch(o){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,o){var r=o(13),n=Object.prototype,a=n.hasOwnProperty,p=n.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),o=e[s];try{e[s]=void 0}catch(t){}var r=p.call(e);return t?e[s]=o:delete e[s],r}},function(e){var t=Object.prototype,o=t.toString;e.exports=function(e){return o.call(e)}},function(e,t,o){function r(e){return!!a&&a in e}var n=o(78),a=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=r},function(e,t,o){var r=o(3),n=r["__core-js_shared__"];e.exports=n},function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,o){var r=o(81),n=o(10),a=o(20);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||n),string:new r}}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}var n=o(82),a=o(83),p=o(84),s=o(85),c=o(86);r.prototype.clear=n,r.prototype["delete"]=a,r.prototype.get=p,r.prototype.has=s,r.prototype.set=c,e.exports=r},function(e,t,o){var r=o(14);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,o){var r=o(14),n=Object.prototype,a=n.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var o=t[e];return o==="__lodash_hash_undefined__"?void 0:o}return a.call(t,e)?t[e]:void 0}},function(e,t,o){var r=o(14),n=Object.prototype,a=n.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?t[e]!==void 0:a.call(t,e)}},function(e,t,o){var r=o(14);e.exports=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,o){var r=o(15);e.exports=function(e){var t=r(this,e)["delete"](e);return this.size-=t?1:0,t}},function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,o){var r=o(15);e.exports=function(e){return r(this,e).get(e)}},function(e,t,o){var r=o(15);e.exports=function(e){return r(this,e).has(e)}},function(e,t,o){var r=o(15);e.exports=function(e,t){var o=r(this,e),n=o.size;return o.set(e,t),this.size+=o.size==n?0:1,this}},function(e,t,o){function r(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new n;++t<o;)this.add(e[t])}var n=o(35),a=o(93),p=o(94);r.prototype.add=r.prototype.push=a,r.prototype.has=p,e.exports=r},function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e){e.exports=function(e){return this.__data__.has(e)}},function(e){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r;)if(t(e[o],o,e))return!0;return!1}},function(e){e.exports=function(e,t){return e.has(t)}},function(e,t,o){var r=o(13),n=o(37),a=o(19),p=o(36),s=o(98),c=o(99),l=r?r.prototype:void 0,i=l?l.valueOf:void 0;e.exports=function(e,t,o,r,l,y,d){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!!(e.byteLength==t.byteLength&&y(new n(e),new n(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var x=s;case"[object Set]":var b=r&1;if(x||(x=c),e.size!=t.size&&!b)return!1;var h=d.get(e);if(h)return h==t;r|=2,d.set(e,t);var u=p(x(e),x(t),r,l,y,d);return d["delete"](e),u;case"[object Symbol]":if(i)return i.call(e)==i.call(t);}return!1}},function(e){e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e,r){o[++t]=[r,e]}),o}},function(e){e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=e}),o}},function(e,t,o){function r(e,t,o,r,p,c){var l=o&a,i=n(e),y=i.length,d=n(t),x=d.length;if(y!=x&&!l)return!1;for(var b,h=y;h--;)if(b=i[h],l?!(b in t):!s.call(t,b))return!1;var u=c.get(e),g=c.get(t);if(u&&g)return u==t&&g==e;var _=!0;c.set(e,t),c.set(t,e);for(var f=l;++h<y;){b=i[h];var j=e[b],m=t[b];if(r)var w=l?r(m,j,b,t,e,c):r(j,m,b,e,t,c);if(void 0===w?!(j===m||p(j,m,o,r,c)):!w){_=!1;break}f||(f="constructor"==b)}if(_&&!f){var A=e.constructor,S=t.constructor;A!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof A&&A instanceof A&&"function"==typeof S&&S instanceof S)&&(_=!1)}return c["delete"](e),c["delete"](t),_}var n=o(38),a=1,p=Object.prototype,s=p.hasOwnProperty;e.exports=r},function(e){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length,n=0,a=[];++o<r;){var p=e[o];t(p,o,e)&&(a[n++]=p)}return a}},function(e){e.exports=function(e,t){for(var o=-1,r=Array(e);++o<e;)r[o]=t(o);return r}},function(e,t,o){var r=o(104),n=o(7),a=Object.prototype,p=a.hasOwnProperty,s=a.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return n(e)&&p.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},function(e,t,o){var r=o(12),n=o(7);e.exports=function(e){return n(e)&&r(e)=="[object Arguments]"}},function(e){e.exports=function(){return!1}},function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,o){var r=typeof e;return o=null==o?9007199254740991:o,!!o&&("number"==r||"symbol"!=r&&t.test(e))&&-1<e&&0==e%1&&e<o}},function(e,t,o){var r=o(12),n=o(44),a=o(7),p={};p["[object Float32Array]"]=p["[object Float64Array]"]=p["[object Int8Array]"]=p["[object Int16Array]"]=p["[object Int32Array]"]=p["[object Uint8Array]"]=p["[object Uint8ClampedArray]"]=p["[object Uint16Array]"]=p["[object Uint32Array]"]=!0,p["[object Arguments]"]=p["[object Array]"]=p["[object ArrayBuffer]"]=p["[object Boolean]"]=p["[object DataView]"]=p["[object Date]"]=p["[object Error]"]=p["[object Function]"]=p["[object Map]"]=p["[object Number]"]=p["[object Object]"]=p["[object RegExp]"]=p["[object Set]"]=p["[object String]"]=p["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&n(e.length)&&!!p[r(e)]}},function(e,t,o){var r=o(27),n=o(109),a=Object.prototype,p=a.hasOwnProperty;e.exports=function(e){if(!r(e))return n(e);var t=[];for(var o in Object(e))p.call(e,o)&&"constructor"!=o&&t.push(o);return t}},function(e,t,o){var r=o(45),n=r(Object.keys,Object);e.exports=n},function(e,t,o){var r=o(6),n=o(3),a=r(n,"DataView");e.exports=a},function(e,t,o){var r=o(6),n=o(3),a=r(n,"Promise");e.exports=a},function(e,t,o){var r=o(6),n=o(3),a=r(n,"Set");e.exports=a},function(e,t,o){var r=o(6),n=o(3),a=r(n,"WeakMap");e.exports=a},function(e,t,o){function r(e,t,o,F,U,M){var B,D=t&k,G=t&L;if(o&&(B=U?o(e,F,U,M):o(e)),void 0!==B)return B;if(!w(e))return e;var N=f(e);if(!N){var R=h(e),V=R==P||R==T;if(j(e))return l(e,D);if(R!=z&&R!=E&&(!V||U)){if(!I[R])return U?e:{};B=g(e,R,D)}else if(B=G||V?{}:_(e),!D)return G?d(e,c(B,e)):y(e,s(B,e))}else if(B=u(e),!D)return i(e,B);M||(M=new n);var W=M.get(e);if(W)return W;M.set(e,B),A(e)?e.forEach(function(n){B.add(r(n,t,o,n,e,M))}):m(e)&&e.forEach(function(n,a){B.set(a,r(n,t,o,a,e,M))});var C=t&O?G?b:x:G?v:S,$=N?void 0:C(e);return a($||e,function(n,a){$&&(a=n,n=e[a]),p(B,a,r(n,t,o,a,e,M))}),B}var n=o(31),a=o(115),p=o(47),s=o(117),c=o(118),l=o(121),i=o(122),y=o(123),d=o(124),x=o(38),b=o(125),h=o(17),u=o(126),g=o(127),_=o(132),f=o(16),j=o(23),m=o(134),w=o(9),A=o(136),S=o(22),v=o(28),k=1,L=2,O=4,E="[object Arguments]",P="[object Function]",T="[object GeneratorFunction]",z="[object Object]",I={};I[E]=I["[object Array]"]=I["[object ArrayBuffer]"]=I["[object DataView]"]=I["[object Boolean]"]=I["[object Date]"]=I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Map]"]=I["[object Number]"]=I[z]=I["[object RegExp]"]=I["[object Set]"]=I["[object String]"]=I["[object Symbol]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I["[object Error]"]=I[P]=I["[object WeakMap]"]=!1,e.exports=r},function(e){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r&&!(!1===t(e[o],o,e)););return e}},function(e,t,o){var r=o(6),n=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=n},function(e,t,o){var r=o(18),n=o(22);e.exports=function(e,t){return e&&r(t,n(t),e)}},function(e,t,o){var r=o(18),n=o(28);e.exports=function(e,t){return e&&r(t,n(t),e)}},function(e,t,o){var r=o(9),n=o(27),a=o(120),p=Object.prototype,s=p.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=n(e),o=[];for(var p in e)("constructor"!=p||!t&&s.call(e,p))&&o.push(p);return o}},function(e){e.exports=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}},function(e,t,o){(function(e){var r=o(3),n=t&&!t.nodeType&&t,a=n&&"object"==typeof e&&e&&!e.nodeType&&e,p=a&&a.exports===n,s=p?r.Buffer:void 0,c=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var o=e.length,r=c?c(o):new e.constructor(o);return e.copy(r),r}}).call(this,o(24)(e))},function(e){e.exports=function(e,t){var o=-1,r=e.length;for(t||(t=Array(r));++o<r;)t[o]=e[o];return t}},function(e,t,o){var r=o(18),n=o(21);e.exports=function(e,t){return r(e,n(e),t)}},function(e,t,o){var r=o(18),n=o(49);e.exports=function(e,t){return r(e,n(e),t)}},function(e,t,o){var r=o(39),n=o(49),a=o(28);e.exports=function(e){return r(e,a,n)}},function(e){var t=Object.prototype,o=t.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,o){var r=o(29),n=o(128),a=o(129),p=o(130),s=o(131);e.exports=function(e,t,o){var c=e.constructor;return t==="[object ArrayBuffer]"?r(e):t==="[object Boolean]"||t==="[object Date]"?new c(+e):t==="[object DataView]"?n(e,o):t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object Int8Array]"||t==="[object Int16Array]"||t==="[object Int32Array]"||t==="[object Uint8Array]"||t==="[object Uint8ClampedArray]"||t==="[object Uint16Array]"||t==="[object Uint32Array]"?s(e,o):t==="[object Map]"?new c:t==="[object Number]"||t==="[object String]"?new c(e):t==="[object RegExp]"?a(e):t==="[object Set]"?new c:t==="[object Symbol]"?p(e):void 0}},function(e,t,o){var r=o(29);e.exports=function(e,t){var o=t?r(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}},function(e){var t=/\w*$/;e.exports=function(e){var o=new e.constructor(e.source,t.exec(e));return o.lastIndex=e.lastIndex,o}},function(e,t,o){var r=o(13),n=r?r.prototype:void 0,a=n?n.valueOf:void 0;e.exports=function(e){return a?Object(a.call(e)):{}}},function(e,t,o){var r=o(29);e.exports=function(e,t){var o=t?r(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}},function(e,t,o){var r=o(133),n=o(50),a=o(27);e.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:r(n(e))}},function(e,t,o){var r=o(9),n=Object.create,a=function(){function e(){}return function(t){if(!r(t))return{};if(n)return n(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();e.exports=a},function(e,t,o){var r=o(135),n=o(25),a=o(26),p=a&&a.isMap,s=p?n(p):r;e.exports=s},function(e,t,o){var r=o(17),n=o(7);e.exports=function(e){return n(e)&&r(e)=="[object Map]"}},function(e,t,o){var r=o(137),n=o(25),a=o(26),p=a&&a.isSet,s=p?n(p):r;e.exports=s},function(e,t,o){var r=o(17),n=o(7);e.exports=function(e){return n(e)&&r(e)=="[object Set]"}}]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-config~nh-editor-events~nh-macro-browser-plugin~nh-space-tools~nh-tinymce-plugin', location = 'nh-config~nh-editor-events~nh-macro-browser-plugin~nh-space-tools~nh-tinymce-plugin.b4484b36a96394141796.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[0],{2:function(a){a.exports=require("ajs")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-space-tools~nh-tinymce-plugin', location = 'nh-space-tools~nh-tinymce-plugin.f69fd458b86e7ded4b07.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[2],[function(a){a.exports=require("jquery")},function(a){a.exports=WRM.format},,,,function(a){a.exports=require("aui/flag")},,,function(a){a.exports=WRM.contextPath}]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-editor-events~nh-tinymce-plugin', location = 'nh-editor-events~nh-tinymce-plugin.b46caada78ed20c135c9.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[1],{4:function(a){a.exports=require("tinymce")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-tinymce-plugin', location = 'nh-tinymce-plugin.526f2c199f430168ffb1.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[7],{144:function(a,b,c){"use strict";function d(a){return a.toString().replace(/\//g,"")}function e(a,b){return"value=\"".concat(b,"\" ").concat(a===b?"selected":"")}function f(a){var b=a.numberFormatField,c=a.startingHeadingField,f=a.startingNumberField,g=a.skipHeadingField;return"<form class=\"aui\" id=\"nh-format-options-form\">\n    <div class=\"field-group\">\n        <label for=\"nh-numberFormatField\">".concat("Number format","</label>\n        <select class=\"select\" id=\"nh-numberFormatField\" name=\"numberFormatField\">\n            <option ").concat(e(b,"decimal"),">").concat("decimal","</option>\n            <option ").concat(e(b,"iso-2145"),">").concat("iso-2145","</option>\n            <option ").concat(e(b,"full-decimal"),">").concat("full-decimal","</option>\n            <option ").concat(e(b,"lower-latin"),">").concat("lower-latin","</option>\n            <option ").concat(e(b,"lower-roman"),">").concat("lower-roman","</option>\n            <option ").concat(e(b,"lower-greek"),">").concat("lower-greek","</option>\n            <option ").concat(e(b,"upper-latin"),">").concat("upper-latin","</option>\n            <option ").concat(e(b,"upper-roman"),">").concat("upper-roman","</option>\n            <option ").concat(e(b,"upper-greek"),">").concat("upper-greek","</option>\n            <option ").concat(e(b,"custom"),">").concat("custom","</option>\n        </select>\n    </div>\n    <div class=\"field-group\">\n        <label for=\"nh-startingNumberField\">").concat("Starting number","</label>\n        <input class=\"text full-width-field\" type=\"text\"\n               id=\"nh-startingNumberField\" name=\"startingNumberField\" value=\"").concat(f,"\"\n               data-aui-validation-when=\"aui-stop-typing\" pattern=\"").concat(d(P),"\"\n               data-aui-validation-pattern-msg=\"").concat("Starting number","\">\n    </div>\n    <div class=\"field-group\">\n        <label for=\"nh-startingHeadingField\">").concat("Starting heading","</label>\n        <select class=\"select\" id=\"nh-startingHeadingField\" name=\"startingHeadingField\">\n            <option ").concat(e(c,"H1"),">H1</option>\n            <option ").concat(e(c,"H2"),">H2</option>\n            <option ").concat(e(c,"H3"),">H3</option>\n            <option ").concat(e(c,"H4"),">H4</option>\n            <option ").concat(e(c,"H5"),">H5</option>\n            <option ").concat(e(c,"H6"),">H6</option>\n        </select>\n    </div>\n    <div class=\"field-group\">\n        <label for=\"nh-skipHeadingField\">").concat("Skip headings","</label>\n        <input class=\"text full-width-field\" type=\"text\"\n               id=\"nh-skipHeadingField\" name=\"skipHeadingField\" value=\"").concat(g,"\"\n               data-aui-validation-when=\"aui-stop-typing\" pattern=\"").concat(d(Q),"\"\n               data-aui-validation-pattern-msg=\"").concat("Should be comma separated: H3, H5","\">\n        <div class=\"description\">").concat("Comma separated: H3, H5","</div>\n    </div>\n    <div class=\"toolbar-trigger-dialog-hidden\" style=\"display:none;\">\n        <br>\n        <h4>").concat("Custom number format","</h4>\n        <p>").concat("Define custom formatting per heading. Note: empty options will not render anything.","&nbsp;\n            <a data-aui-trigger aria-controls=\"nh-trigger-formatting-options\" href=\"#nh-trigger-formatting-options\">").concat("Formatting options","</a>.\n        </p>\n        <aui-inline-dialog id=\"nh-trigger-formatting-options\" alignment=\"right middle\">\n            <div class=\"format-options-styling\">\n                <h2>").concat("Formatting options","</h2>\n                <ul>\n                    <li>decimal</li>\n                    <li>iso-2145</li>\n                    <li>full-decimal</li>\n                    <li>lower-latin</li>\n                    <li>lower-roman</li>\n                    <li>lower-greek</li>\n                    <li>upper-latin</li>\n                    <li>upper-roman</li>\n                    <li>upper-greek</li>\n                    <li>custom</li>\n                </ul>\n                <h2>").concat("Examples","</h2>\n                <h3>").concat("Heading 1","</h3>\n                <span class=\"toolbar-trigger-formatting-options-code\">\n                                <code>").concat("Chapter [h1.decimal]","</code>\n                            </span>\n                <p>").concat("Results in Chapter 1, Chapter 2, etc.","</p>\n                <h3>").concat("Heading 2","</h3>\n                <span class=\"toolbar-trigger-formatting-options-code\">\n                                <code>").concat("[h1.decimal].[h2.upper-latin]","</code>\n                            </span>\n                <p>").concat("Results in 1.A, 1.B, 2.A, 2.B, etc.","</p>\n            </div>\n        </aui-inline-dialog>\n\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH1\">").concat("H1 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH1\" name=\"customFormatFieldH1\" value=\"").concat(a.customFormatFieldH1,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH2\">").concat("H2 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH2\" name=\"customFormatFieldH2\" value=\"").concat(a.customFormatFieldH2,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH3\">").concat("H3 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH3\" name=\"customFormatFieldH3\" value=\"").concat(a.customFormatFieldH3,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH4\">").concat("H4 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH4\" name=\"customFormatFieldH4\" value=\"").concat(a.customFormatFieldH4,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH5\">").concat("H5 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH5\" name=\"customFormatFieldH5\" value=\"").concat(a.customFormatFieldH5,"\">\n        </div>\n        <div class=\"field-group\">\n            <label for=\"nh-customFormatFieldH6\">").concat("H6 format","</label>\n            <input class=\"text full-width-field\" type=\"text\"\n                   id=\"nh-customFormatFieldH6\" name=\"customFormatFieldH6\" value=\"").concat(a.customFormatFieldH6,"\">\n        </div>\n    </div>\n</form>")}function g(a,b){var c={lastLevel:0,startAt:0,counts:[0,0,0,0,0,0]},d=b.startingHeadingField;c.startAt=void 0===d?0:d[1]-1;var e=b.startingNumberField;if(e!==void 0)for(var f,g=e.split(","),j=0;j<g.length;j++)f=parseInt(g[j],10),isNaN(f)||(c.counts[c.startAt+j]=f-1);G()(a).find("h1, h2, h3, h4, h5, h6").filter(function(b,c){var d=G()(c).parents("table[data-macro-name=numberedheadings]");return 0===d.size()||d.is(a)}).each(function(a,d){h(d.nodeName[1],b)?i(c,d,b):k(d)})}function h(a,b){var c=b.skipHeadingField;if(!c)return!0;a=parseInt(a,10);for(var d,e=c.split(","),f=0;f<e.length;f++)if(d=parseInt(G.a.trim(e[f])[1],10),d===a)return!1;return!0}function j(a,b){for(var c=b;6>c;c++)a.counts[c]=0}function i(a,b,c){var d=a.lastLevel,e=a.startAt,f=a.counts,g=c.numberFormatField||"decimal",k=Y[g],l=b.nodeName[1],m="";if(l>=e+1){d>l&&j(a,l),a.counts[l-1]++;for(var n=e;n<l;n++)h(n+1,c)&&n+1>d&&n+1<l&&(a.counts[n]=f[n]+1);if("custom"===g){for(var i=[],o=1;7>o;o++)i[o-1]=c["customFormatFieldH"+o]||"";m+=k.format(a,l,i)}else for(var p=e;p<l;p++)h(p+1,c)&&(m+=k.format(a,f[p]),(!k.shouldRenderSeparator||k.shouldRenderSeparator(p+1>=l))&&(m+="."));0<m.length&&(m+=" "),a.lastLevel=l}G()(b).attr("data-nh-numbering",m)}function k(a){G()(a).removeAttr("data-nh-numbering")}function l(a){G()(a).find("h1, h2, h3, h4, h5, h6").each(function(a,b){k(b)})}function m(a){var b=G()(a).attr("data-macro-parameters"),c={"number-format":"decimal"};if(b!==void 0)for(var d,e=n(b),f=0;f<e.length;f++)d=e[f].split("="),c[Z[d[0]]]=d[1];return c}function n(a){for(var b=o(a).split(/\|(?!\\)/),c=0;c<b.length;c++){b[c]=o(b[c]);var d=b[c].indexOf("\\|");d!==void 0&&(b[c]=b[c].substring(0,d)+b[c].substring(d+1,b[c].length))}return b}function o(a){return a.split("").reverse().join("")}function p(a){return new Promise(function(b){setTimeout(function(){return b()},a)})}function q(a){var b=G.a.get(_()()+"/rest/numberedheadings/1.0/page-configuration/"+a);return Promise.resolve(b).then(function(a){return qa=a,a})}function r(){G()("#wysiwygTextarea_ifr").contents().find("table[data-macro-name=numberedheadings]").each(function(a,b){g(b,m(b))})}function s(){if(qa.spaceNumbering.isEnabled&&!qa.pageNumbering.overrideSpaceNumbering){var a=qa,b=a.spaceNumbering;return b}var c=qa,d=c.pageNumbering;return d}function t(){G()("#wysiwygTextarea_ifr").contents().each(function(a,b){(qa.pageNumbering.isEnabled||qa.spaceNumbering.isEnabled)&&(qa.pageNumbering.isEnabled||!qa.pageNumbering.overrideSpaceNumbering)&&K?(g(b,s()),(ra.isButtonEnabled||qa.pageNumbering.isEnabled||qa.spaceNumbering.isEnabled&&!qa.pageNumbering.isEnabled)&&(G()("#rte-numbered-headings-button").addClass("active"),G()("#rte-numbering-button-control").addClass("active")),ra.isTriggerEnabled?G()("#rte-numbered-headings-button-trigger").addClass("active"):!ra.isTriggerEnabled&&G()("#rte-numbered-headings-button-trigger").removeClass("active")):(l(b),G()("#rte-numbered-headings-button").removeClass("active"),G()("#rte-numbering-button-control").removeClass("active"),G()("#rte-numbered-headings-button-trigger").removeClass("active")),r()})}function u(a){if(1===a.nodeType){var b=a.tagName.toLowerCase();if(/^h[1-6]$/.test(b))return!0;if(-1<G.a.inArray(b,["span","strong","em","u","s","sub","sup","code"]))return u(a.parentElement)}return!1}function v(){ra.isTriggerEnabled=!1}function w(){var a=G()("#nh-format-options-form");a.replaceWith(f(qa.pageNumbering))}function x(){var a=G()("#nh-numberFormatField");"custom"===qa.pageNumbering.numberFormatField&&G()(".toolbar-trigger-dialog-hidden").show(),a.on("change",function(){"custom"===G()(this).val()?G()(".toolbar-trigger-dialog-hidden").show():G()(".toolbar-trigger-dialog-hidden").hide()})}function y(){function a(){var a=b.serializeArray(),c=a.reduce(function(a,b){return a[b.name]=b.value,a},{});c.isEnabled=!0,ra.isButtonEnabled=!0,ra.isTriggerEnabled=!0,c.startingNumberField!==void 0&&P.test(c.startingNumberField)||(c.startingNumberField="1"),c.skipHeadingField!==void 0&&Q.test(c.skipHeadingField)||(c.skipHeadingField=""),qa.pageNumbering.overrideSpaceNumbering&&(c.overrideSpaceNumbering=!0),la()(qa.pageNumbering,c)||(qa.pageNumbering=c,t(),sa(!0))}var b=G()("#nh-format-options-form"),c=G()("#nh-startingNumberField"),d=G()("#nh-skipHeadingField");b.on("change",a),c.on("keyup",a),d.on("keyup",a)}function z(){return G()("#rte-numbered-headings-button")}function A(){return G()("#rte-numbered-headings-button-trigger")}function B(a){return"page"===a||"blogpost"===a}function C(){if(r(),0!==G()(".rte-toolbar-group-formatting").length){var a=G()(".rte-toolbar-group-formatting").first();if(G()("#rte-numbering-button-control").remove(),!K)return void a.append(W);if(!0===S.a.params.newPage&&!1===S.a.params.collaborativeContent)return void a.append(V);a.append(X),G()(".anti-flicker").css("display",""),document.getElementById("nh-page-numbering-configuration-dialog").addEventListener("aui-hide",v);var b=z(),c=A();if(t(),w(),y(),x(),b.click(function(a){a.preventDefault(),qa.spaceNumbering.isEnabled&&(qa.pageNumbering.isEnabled||qa.pageNumbering.overrideSpaceNumbering?(qa.pageNumbering.isEnabled=!qa.pageNumbering.isEnabled,ra.isButtonEnabled=!ra.isButtonEnabled):(qa.pageNumbering.overrideSpaceNumbering=!0,qa.pageNumbering.isEnabled=!1)),qa.spaceNumbering.isEnabled||(ra.isButtonEnabled||ra.isTriggerEnabled||""!==qa.pageNumbering.numberFormatField?(qa.pageNumbering.isEnabled=!qa.pageNumbering.isEnabled,ra.isButtonEnabled=!ra.isButtonEnabled):(qa.pageNumbering.isEnabled=!qa.pageNumbering.isEnabled,ra.isButtonEnabled=!ra.isButtonEnabled,qa.pageNumbering.numberFormatField="decimal",qa.pageNumbering.startingHeadingField="H1")),t(),sa(!1)}),c.click(function(a){qa.spaceNumbering.isEnabled&&(qa.pageNumbering.overrideSpaceNumbering=!0),G()("#nh-format-options-form input[data-aui-validation-novalidate]").attr("data-aui-validation-field",""),G()("#nh-format-options-form input[data-aui-validation-novalidate]").removeAttr("data-aui-validation-novalidate");var b=document.getElementById("nh-page-numbering-configuration-dialog");b.open=!b.open,ra.isTriggerEnabled=!!b.open,b.open&&(qa.pageNumbering.isEnabled=!0,ra.isButtonEnabled=!0),a.preventDefault(),t(),sa(!0)}),7>=L&&!M&&ra.isTriggerEnabled&&K){var d="Your Numbered Headings evaluation is about to end. There ";1===L||0===L?d+="is 1 day left to start your subscription.":d=d+"are "+L+" days left to start your subscription.",ba()({type:"warning",body:d,close:"manual"})}}}function D(a){return new Promise(function(b){if("3"===ja.a.majorVersion)var c=a.onInit.add(function(d){b(d),a.onEvent.remove(c)});else a.once("init",function(a){b(a)})})}function E(){return S.a.params.synchronyAppId&&0<S.a.params.synchronyAppId.length}c.r(b);var F=c(0),G=c.n(F),H=c(51),I=c.n(H);window.nhLicenseStatus||(window.nhLicenseStatus=I.a.claim("nl.avisi.confluence.plugins.numberedheadings:nh-license-data.license-status"));var J=window.nhLicenseStatus,K=J.active||!1,L=J.expiresInDays||0,M=J.subscription||!1,N=c(57),O=c(58),P=/(^[0-9]+(, ?[0-9]+)*$)/,Q=/(^H[1-6]+(, ?H[1-6])*$)/,R=c(2),S=c.n(R),T=c(1),U="7.6.0">S.a.version?"pre-ajs-7-6-0":"post-ajs-7-6-0",V=" <li class=\"nh-hotreload-element toolbar-item aui-button aui-button-subtle rte-numbered-headings-button ".concat(U,"\"\n    id=\"rte-numbering-button-control\"\n    data-tooltip=\"Cannot enable Numbered Headings on new pages when collaborative editing is disabled. After saving this page you can enable Numbered Headings.\" data-aui-trigger>\n    <a class=\"toolbar-trigger ").concat(U,"\" id=\"rte-numbered-headings\"><span class=\"nh-button-icon\"></a>\n</li>\n"),W="<li class=\"nh-hotreload-element toolbar-item aui-button aui-button-subtle rte-numbered-headings-button ".concat(U,"\"\n    id=\"rte-numbering-button-control\"\n    data-tooltip=\"Number headings\" aria-controls=\"buy-nh\" href=\"#buy-nh\" data-aui-trigger>\n    <a class=\"toolbar-trigger ").concat(U,"\" id=\"rte-numbered-headings\"><span class=\"nh-button-icon\"></a>\n\n    <!-- Wrap the dialogs in a display none so they don't flicker for half a second while initializing-->\n    <div class=\"anti-flicker\" style=\"display: none\">\n      <aui-inline-dialog class=\"nh-hotreload-element\" alignment=\"bottom left\" id=\"buy-nh\" class=\"aui-help\">\n          <h2>Number your headings</h2>\n          <p>Number all headings on this page with the click of a button.<br/>This button is part of Numbered\n              Headings Pro.</p>\n          <p>Try Numbered Headings Pro free for 30 days.<br/>Ask your admin to start your Numbered Headings trial.\n          </p>\n      </aui-inline-dialog>\n    </div>\n</li>\n"),X="<li class=\"nh-hotreload-element toolbar-item toolbar-splitbutton ".concat(U,"\" id=\"rte-numbering-button-control\">\n    <a class=\"toolbar-trigger aui-button rte-numbered-headings-button ").concat(U,"\"\n       aria-haspopup=\"true\" aria-controls=\"nh-space-wide-numbering\"\n       id=\"rte-numbered-headings-button\"\n       data-tooltip=\"Number headings\"><span class=\"nh-button-icon\"></span></a>\n        \n    <div class=\"aui-dd-parent dd-allocated\">\n        <a class=\"toolbar-trigger aui-dd-trigger aui-button rte-numbered-headings-button-trigger ").concat(U,"\"\n           aria-haspopup=\"true\" aria-controls=\"nh-page-numbering-configuration-dialog\"\n           id=\"rte-numbered-headings-button-trigger\"\n           data-tooltip=\"").concat("More formatting options","\">\n            <span class=\"icon aui-icon aui-icon-small aui-iconfont-dropdown\"></span>\n        </a>\n    </div>\n    \n    <!-- Wrap the dialogs in a display none so they don't flicker for half a second while initializing-->\n    <div class=\"anti-flicker\" style=\"display: none\">\n      <aui-inline-dialog alignment=\"bottom left\" id=\"nh-page-numbering-configuration-dialog\" class=\"nh-hotreload-element aui-info trigger-dialog-style\">\n          <h3>").concat("Numbered Headings options","</h3>\n          <div id=\"nh-format-options-form\">\n              <p>").concat("Numbered Headings options","</p>\n          </div>\n      </aui-inline-dialog>\n    </div>\n</li>"),Y={decimal:{format:function(a,b){return b}},"iso-2145":{format:function(a,b){return Y.decimal.format(a,b)},shouldRenderSeparator:function(a){return!a}},"full-decimal":{lowNumbers:["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],highNumbers:["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],format:function(a,b){if(b>this.lowNumbers.length-1){b=b.toString();var c=b[0],d=b[1],e=this.highNumbers[c];return 0<d&&(e+="-",e+=this.lowNumbers[d]),e}return this.lowNumbers[b]}},"lower-latin":{range:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],format:function(a,b){return this.range[b-1]}},"upper-latin":{format:function(a,b){var c=Y["lower-latin"].format(a,b);return c.toUpperCase()}},"lower-greek":{range:["\u03B1","\u03B2","\u03B3","\u03B4","\u03B5","\u03B6","\u03B7","\u03B8","\u03B9","\u03BA","\u03BB","\u03BC","\u03BD","\u03BE","\u03BF","\u03C0","\u03C1","\u03C3","\u03C4","\u03C5","\u03C6","\u03C7","\u03C8","\u03C9"],format:function(a,b){return this.range[b-1]}},"upper-greek":{range:["\u0391","\u0392","\u0393","\u0394","\u0395","\u0396","\u0397","\u0398","\u0399","\u039A","\u039B","\u039C","\u039D","\u039E","\u039F","\u03A0","\u03A1","\u03A3","\u03A4","\u03A5","\u03A6","\u03A7","\u03A8","\u03A9"],format:function(a,b){return this.range[b-1]}},"lower-roman":{format:function(a,b){var c=Y["upper-roman"].format(a,b);return c.toLowerCase()}},"upper-roman":{units:["","I","II","III","IV","V","VI","VII","VIII","IX"],tens:["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],hundreds:["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],format:function(a,b){return(this.hundreds[b/100]||"")+(this.tens[b/10]||"")+(this.units[b]||"")}},custom:{customFormatterRegex:/(\[h[1-6].[a-zA-Z0-9-]+\])/,parseCustomFormat:function(a,b){return b[a-1].split(this.customFormatterRegex)},format:function(a,b,c){for(var d,e=a.startAt,f=a.counts,g=this.parseCustomFormat(b,c),h="",j=0;j<g.length;j++)if(d=g[j],this.customFormatterRegex.test(d)){var i=d[2];if(i>=e+1&&i<=b){var k=d.substring(4,d.length-1);if("custom"!==k){var l=Y[k]||Y.decimal,m=f[i-1];h+=l.format(a,m)}}}else h+=d;return h}}},Z={"number-format":"numberFormatField","start-numbering-with":"startingNumberField","start-numbering-at":"startingHeadingField","skip-headings":"skipHeadingField",h1:"customFormatFieldH1",h2:"customFormatFieldH2",h3:"customFormatFieldH3",h4:"customFormatFieldH4",h5:"customFormatFieldH5",h6:"customFormatFieldH6"},$=c(8),_=c.n($),aa=c(5),ba=c.n(aa),ca=c(59),da=c(30),ea=c.n(da),fa=c(52),ga=c.n(fa),ha=function(){var a=ga()(ea.a.mark(function a(b,c,d,e){var f,g,h;return ea.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:f=0,g=!1,h=function(){return!0===b()||f>=e};case 3:return++f,h()&&(g=!0,c()),a.next=7,p(d);case 7:if(!g){a.next=3;break}case 8:case"end":return a.stop();}},a)}));return function(){return a.apply(this,arguments)}}(),ia=c(4),ja=c.n(ia),ka=c(53),la=c.n(ka),ma=c(54),na=c.n(ma),oa=c(55),pa=c.n(oa),qa={spaceNumbering:{isEnabled:!1,numberFormatField:"",startingNumberField:"",startingHeadingField:"",skipHeadingField:"",customFormatFieldH1:"",customFormatFieldH2:"",customFormatFieldH3:"",customFormatFieldH4:"",customFormatFieldH5:"",customFormatFieldH6:""},pageNumbering:{isEnabled:!1,overrideSpaceNumbering:!1,numberFormatField:"",startingNumberField:"",startingHeadingField:"",skipHeadingField:"",customFormatFieldH1:"",customFormatFieldH2:"",customFormatFieldH3:"",customFormatFieldH4:"",customFormatFieldH5:"",customFormatFieldH6:""}},ra={isButtonEnabled:!1,isTriggerEnabled:!1},sa=pa()(function(a){return new Promise(function(b,c){var d=na()(qa.pageNumbering);G.a.ajax({type:"PUT",contentType:"application/json",url:_()()+"/rest/numberedheadings/1.0/page-configuration/"+S.a.params.contentId,data:JSON.stringify(d),success:function(){b(),!1===a&&(qa.pageNumbering.isEnabled?ba()({type:"success",body:"Numbered Headings is enabled",close:"auto"}):ba()({type:"success",body:"Numbered Headings is disabled",close:"auto"}))},error:function(a){console.error("Failed saving page configuration",a),c(a),ba()({type:"error",title:"Unexpected error",body:"nl.avisi.confluence.plugins.numberedheadings.there.was.issue.enabling.numbered.headings",close:"auto"})},dataType:"json"})})},300,{leading:!0}),ta=c(56),ua=c.n(ta);ja.a.create("tinymce.plugins.NumberedHeadingsPlugin",{init:function(a){if(B(S.a.params.contentType)){var b=q(S.a.params.contentId);b.then(function(){E()&&(console.info("nl.avisi.nh: Synchrony is enabled, use polling async await"),ha(function(){return 1===G()("#wysiwygTextarea_ifr").contents().first().find(".synchrony-container").length},function(){console.log("nl.avisi.nh: Synchrony is initialized, initialize numbered headings"),t()},100,300))}),a.onNodeChange.add(function(a,b,c){if(u(c)){var d=G()(c).parents("table[data-macro-name=numberedheadings]"),e=1===d.size();if(e)g(d,m(d));else{var f=document.getElementById("nh-page-numbering-configuration-dialog");f&&f.open&&(f.open=!f.open),t()}}});var c=[b,D(a)];Promise.all(c).then(function(){try{C()}catch(a){console.error("Numbered headings threw an error",a)}});var d=!1;a.onEvent&&a.onEvent.add(function(){d||(r(),d=!0)})}},hotReload:function(){G()(".nh-hotreload-element").remove(),C()},getInfo:function(){return{longname:"Numbered Headings TinyMCE Plugin",author:"Avisi B.V.",authorurl:"http://avisi.nl",version:ja.a.majorVersion+"."+ja.a.minorVersion}}}),ja.a.PluginManager.add("numberedheadings",ja.a.plugins.NumberedHeadingsPlugin),ua.a.addTinyMcePluginInit(function(a){a.plugins+=",numberedheadings"}),!1},51:function(a){a.exports=WRM.data},56:function(a){a.exports=require("confluence-editor/loader/tinymce-bootstrap")},57:function(a){a.exports=void 0},58:function(a){a.exports=require("aui/inline-dialog2")},59:function(){}},[[144,12,13,0,2,1]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:entrypoint-nh-tinymce-plugin', location = 'bundled.runtime~nh-tinymce-plugin.5ac3d64c39bb0dadde61.js' */
(function(a){function b(b){for(var d,e,h=b[0],j=b[1],k=b[2],l=0,m=[];l<h.length;l++)e=h[l],f[e]&&m.push(f[e][0]),f[e]=0;for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(a[d]=j[d]);for(i&&i(b);m.length;)m.shift()();return g.push.apply(g,k||[]),c()}function c(){for(var a,b=0;b<g.length;b++){for(var c,e=g[b],h=!0,i=1;i<e.length;i++)c=e[i],0!==f[c]&&(h=!1);h&&(g.splice(b--,1),a=d(d.s=e[0]))}return a}function d(b){if(e[b])return e[b].exports;var c=e[b]={i:b,l:!1,exports:{}};return a[b].call(c.exports,c,c.exports,d),c.l=!0,c.exports}var e={},f={12:0},g=[];d.m=a,d.c=e,d.d=function(a,b,c){d.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},d.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},d.t=function(a,b){if(1&b&&(a=d(a)),8&b)return a;if(4&b&&'object'==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(d.r(c),Object.defineProperty(c,'default',{enumerable:!0,value:a}),2&b&&'string'!=typeof a)for(var e in a)d.d(c,e,function(b){return a[b]}.bind(null,e));return c},d.n=function(a){var b=a&&a.__esModule?function(){return a['default']}:function(){return a};return d.d(b,'a',b),b},d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d.p='','undefined'!=typeof AJS&&(d.p=AJS.contextPath()+'/s/2585692b-d6e2-436b-ba22-c8f4b00be189/_/download/resources/nl.avisi.confluence.plugins.numberedheadings:assets-2585692b-d6e2-436b-ba22-c8f4b00be189/');var h=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[],j=h.push.bind(h);h.push=b,h=h.slice();for(var k=0;k<h.length;k++)b(h[k]);var i=j;c()})([]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-editor-events', location = 'nh-editor-events.bf7b4fb1da159eb7e62f.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[4],{138:function(a,b,c){(function(){function a(a){var c=b.MacroBrowser.selectedMacroDefinition;if(c&&"numberedheadings"===c.name){var e=b.$(d.confluence.macrobrowser.getCurrentNode()).attr("data-macro-id"),f=b.contextPath()+"/rest/numberedheadings/1.0/event/macro-edit/"+b.params.pageId+"/"+c.name+"/"+a+"?";f+="isNew="+!e,e&&(f+="&macroId="+e),b.$.ajax({url:f,type:"POST",data:JSON.stringify(c.params),contentType:"application/json; charset=utf-8",traditional:!0,error:function(a){b.log(a.responseText)}})}}var b=c(2),d=c(4);b.toInit(function(c){function f(){a("edit")}function g(){a("save")}function h(){a("cancel")}b.bind("show.dialog",function(a,b){"macro-browser-dialog"===b.dialog.id&&(f(),c("#macro-details-page button.ok").on("click",g),c("#macro-details-page a.button-panel-cancel-link").on("click",h))}),b.bind("hide.dialog",function(a,b){"macro-browser-dialog"===b.dialog.id&&(c("#macro-details-page button.ok").off("click",g),c("#macro-details-page a.button-panel-cancel-link").off("click",h))})})})()}},[[138,9,0,1]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:entrypoint-nh-editor-events', location = 'bundled.runtime~nh-editor-events.59a169e83ec230596041.js' */
(function(a){function b(b){for(var d,e,h=b[0],j=b[1],k=b[2],l=0,m=[];l<h.length;l++)e=h[l],f[e]&&m.push(f[e][0]),f[e]=0;for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(a[d]=j[d]);for(i&&i(b);m.length;)m.shift()();return g.push.apply(g,k||[]),c()}function c(){for(var a,b=0;b<g.length;b++){for(var c,e=g[b],h=!0,i=1;i<e.length;i++)c=e[i],0!==f[c]&&(h=!1);h&&(g.splice(b--,1),a=d(d.s=e[0]))}return a}function d(b){if(e[b])return e[b].exports;var c=e[b]={i:b,l:!1,exports:{}};return a[b].call(c.exports,c,c.exports,d),c.l=!0,c.exports}var e={},f={9:0},g=[];d.m=a,d.c=e,d.d=function(a,b,c){d.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},d.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},d.t=function(a,b){if(1&b&&(a=d(a)),8&b)return a;if(4&b&&'object'==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(d.r(c),Object.defineProperty(c,'default',{enumerable:!0,value:a}),2&b&&'string'!=typeof a)for(var e in a)d.d(c,e,function(b){return a[b]}.bind(null,e));return c},d.n=function(a){var b=a&&a.__esModule?function(){return a['default']}:function(){return a};return d.d(b,'a',b),b},d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d.p='','undefined'!=typeof AJS&&(d.p=AJS.contextPath()+'/s/2585692b-d6e2-436b-ba22-c8f4b00be189/_/download/resources/nl.avisi.confluence.plugins.numberedheadings:assets-2585692b-d6e2-436b-ba22-c8f4b00be189/');var h=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[],j=h.push.bind(h);h.push=b,h=h.slice();for(var k=0;k<h.length;k++)b(h[k]);var i=j;c()})([]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:latexmath-js-helpers', location = '/js/latexmath-helpers.js' */
(function($) {
    window.latexmathHelpers = {
        createCookie: createCookie,
        readCookie: readCookie,
        eraseCookie: eraseCookie,
        doVerticalAlign: doVerticalAlign,
        encodeLatex: encodeLatex,
        decodeLatex: decodeLatex,
        escapeHtml: escapeHtml
    };

    function createCookie(name,value,days) {
        var expires;
        if (days) {
            var date = new Date();
            date.setTime(date.getTime()+(days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        else expires = "";
        document.cookie = name+"="+value+expires+"; path=/";
    }

    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }

    //noinspection JSUnusedLocalSymbols
    function eraseCookie(name) {
        createCookie(name,"",-1);
    }

    var re = new RegExp("vertAlign=(-?\\d+(?:\\.\\d+)?)([pe]x)");

    function doVerticalAlign() {
        var vals = re.exec($(this).attr("src"));
        if (vals && vals.length > 0) {
            var distance = parseInt(vals[1]);

            if (distance && vals[2] == 'px' && distance < this.naturalHeight) {
                $(this).css('vertical-align', ""+(parseInt(vals[1])-1)+vals[2]);
            }
        }
    }

    var encodingKey = '--uriencoded--';
    function encodeLatex(latex) {
      var encoded = latex.replace(/%/g, '%25').replace(/\^/g, '%5e').replace(/{/g, '%7B').replace(/}/g, '%7D').replace(/\|/g, '%7C');
      return encoded !== latex ? encodingKey+encoded : latex;
    }

    function decodeLatex(latex) {
      if (latex && latex.slice(0, encodingKey.length) === encodingKey) {
        return decodeURIComponent(latex.slice(encodingKey.length));
      } else {
        return latex;
      }
    }

    var entities = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '\'': '&#39;',
        '"': '&quot;'
    };

    function escapeHtml(str) {
        if (str == null) {
            return str;
        }
        if (str.isHtml) {
            return '' + str;
        }
        return ('' + str).replace(/[&<>'"]/g, function(c) { return entities[c] || c; });
    }
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.4331a05956', location = 'aui.chunk.fb9e4cfe5e93e16ac212--ce86d6464bfef27305b4.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.4331a05956"],{LTUc:function(n,i,u){"use strict";u.r(i),u.d(i,"INPUT_SUFFIX",(function(){return t}));const t="-input"}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.toggle', location = 'aui.chunk.275e02295fc51983c0df--f855e4e8115e84846c98.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.toggle"],{KKmC:function(e,t,i){"use strict";i.r(t),i.d(t,"ToggleEl",(function(){return L}));i("6fSn"),i("eSvk"),i("oSOL"),i("XphB");var n=i("+x/D"),u=i("kdZR"),a=i("cWqH"),c=i("fVKi"),s=i("+ay7"),l=i("gjsO"),o=i.n(l),r=i("4dFR"),d=i("LTUc"),f=i("P3rJ"),h=i("tYoR"),b=i("HH5i");function p(e){return e._input||(e._input=e.querySelector("input"))}function k(e){return e._spinner||(e._spinner=new h.default)}function v(e,t){p(t).removeAttribute(e)}function g(e,t,i){p(t).setAttribute(e,i.newValue)}function m(e){return{removed:v.bind(this,e),fallback:g.bind(this,e)}}const A={removed:function(e){v.call(this,"form",e),e._formId=null},fallback:function(e,t){g.call(this,"form",e,t),e._formId=t.newValue}};var y={removed:v.bind(void 0,"id"),fallback:function(e,t){const i="".concat(t.newValue).concat(d.INPUT_SUFFIX);p(e).setAttribute("id",i)}},w={removed:function(e){v.call(this,"value",e),p(e).value="on"},fallback:function(e,t){g.call(this,"value",e,t)}},_={removed:function(e){p(e).checked=!1},fallback:function(e){p(e).checked=!0}},E={removed:function(e){p(e).removeAttribute("aria-label")},fallback:function(e,t){p(e).setAttribute("aria-label",t.newValue)}};var L=Object(r.default)("aui-toggle",{template:o()('<input type="checkbox" class="aui-toggle-input assistive">','<span class="aui-toggle-view">','<span class="aui-toggle-tick aui-icon aui-icon-small aui-iconfont-success"></span>','<span class="aui-toggle-cross aui-icon aui-icon-small aui-iconfont-close-dialog"></span>',"</span>"),created:function(e){p(e),k(e).setAttribute("size",h.SIZE.SMALL.name),Object(n.default)(p(e)).tooltip({title:function(){return this.checked?this.getAttribute("tooltip-on"):this.getAttribute("tooltip-off")},gravity:"s",hoverable:!1}),function(e){p(e).addEventListener("keydown",(function(t){e.busy&&t.keyCode===s.default.SPACE&&t.preventDefault()})),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&p(e).addEventListener("click",(function(t){e.busy&&t.preventDefault()})),Object(a.supportsFocusWithin)()||(e._input.addEventListener("focus",(()=>e.classList.add("active"))),e._input.addEventListener("blur",(()=>e.classList.remove("active"))))}(e),e.hasAttribute("checked")&&p(e).setAttribute("checked",""),e._canFireEventsNow=!0},attached:function(e){Object(c.default)(e).attributeExists("label")},events:{click:function(e,t){var i=p(e);e.disabled||e.busy||t.target===i||(i.checked=!i.checked,function(e){e._canFireEventsNow&&e.dispatchEvent(new f.default("change",{bubbles:!0}))}(e)),Object(u.setBooleanAttribute)(e,"checked",i.checked)}},attributes:{id:y,checked:_,disabled:m("disabled"),form:A,name:m("name"),value:w,"tooltip-on":{value:"On",fallback:function(e,t){p(e).setAttribute("tooltip-on",t.newValue||"On")}},"tooltip-off":{value:"Off",fallback:function(e,t){p(e).setAttribute("tooltip-off",t.newValue||"Off")}},label:E},prototype:{focus:function(){return p(this).focus(),this},get checked(){return p(this).checked},set checked(e){p(this).checked!==e&&(p(this).checked=e,Object(u.setBooleanAttribute)(this,"checked",e))},get disabled(){return p(this).disabled},set disabled(e){return Object(u.setBooleanAttribute)(this,"disabled",e)},get form(){return document.getElementById(this._formId)},set form(e){return A.fallback.call(this,this,{newValue:e||null}),this.form},get name(){return p(this).name},set name(e){return this.setAttribute("name",e),e},get value(){return p(this).value},set value(e){let t=null===e?"":e;return this.setAttribute("value",t),t},get busy(){return"true"===p(this).getAttribute("aria-busy")},set busy(e){const t=p(this),i=k(this);var a,c;return Object(u.setBooleanAttribute)(this,"busy",e),e?(t.setAttribute("aria-busy","true"),t.indeterminate=!0,this.checked?(t.classList.add("indeterminate-checked"),Object(n.default)(this.querySelector(".aui-toggle-tick")).append(i)):Object(n.default)(this.querySelector(".aui-toggle-cross")).append(i)):(t.classList.remove("indeterminate-checked"),t.indeterminate=!1,t.removeAttribute("aria-busy"),i.parentNode&&i.parentNode.removeChild(this._spinner)),c=!!e,(a=this).id&&Array.prototype.forEach.call(document.querySelectorAll('aui-label[for="'.concat(a.id,'"]')),(function(e){e.disabled=c})),e}}})}},[["KKmC","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.vendors--be1eb78c1a","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.afa5039e04","aui.splitchunk.26116b3cbd","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.e5af17b48e","aui.splitchunk.be1eb78c1a","aui.splitchunk.5b7fdbd666","aui.splitchunk.8a641c03a4","aui.splitchunk.86ad04cc86","aui.splitchunk.57d1ac075f","aui.splitchunk.4331a05956"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-vertical-align.js' */
/*********************************************************
 * Vertically align placeholders
 */
(function($) {
    function doVerticalAlignAll() {
        var editorIframe = $("#wysiwygTextarea_ifr");
        editorIframe.contents().find("img[data-macro-name=mathinline]").each(latexmathHelpers.doVerticalAlign);
        editorIframe.contents().find("img[data-macro-name=unit]").each(latexmathHelpers.doVerticalAlign);
    }

    AJS.bind("init.rte", function() {
        setTimeout(doVerticalAlignAll, 500);
        setInterval(doVerticalAlignAll, 5000);
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-dedup-anchors.js' */
/*********************************************************
 * Generate new anchors when pasting math blocks
 */
var latexmath_getExistingAnchors;
(function($) {
    var macroName = "mathblock";
    var anchorField = "anchor";
    var needsUpdate = "data-latexmath-needs-update";

    function makeAnchor()
    {
        var text = "";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

        for( var i=0; i < 5; i++ )
            text += possible.charAt(Math.floor(Math.random() * possible.length));

        return text;
    }

    function getExistingAnchors() {
        var anchors = [];
        $("#wysiwygTextarea_ifr").contents().find("#tinymce").find("[data-macro-name="+macroName+"]").each(function() {
            if (typeof $(this).attr(needsUpdate) !== 'string') {
                var anchor = Confluence.MacroParameterSerializer.deserialize($(this).attr("data-macro-parameters"))[anchorField];
                if (anchor) {
                    anchors.push(anchor)
                }
            }
        });
        return anchors;
    }
    latexmath_getExistingAnchors = getExistingAnchors;

    var updateAnchor = function(macroNode, existingAnchors) {
        var $macroNode = $(macroNode);

        var macroParameters = Confluence.MacroParameterSerializer.deserialize($macroNode.attr("data-macro-parameters"));
        var body = $macroNode.find(".wysiwyg-macro-body > pre").html();

        macroParameters[anchorField] = macroParameters[anchorField] || makeAnchor();
        if (macroParameters[anchorField] && existingAnchors.indexOf(macroParameters[anchorField]) >= 0) {
            macroParameters[anchorField] = makeAnchor();

            AJS.Rte.getEditor().selection.select($macroNode[0]);
            AJS.Rte.BookmarkManager.storeBookmark();

            var macroRenderRequest = {
                contentId : Confluence.Editor.getContentId(),
                macro : {
                    name : macroName,
                    params : macroParameters,
                    defaultParameterValue : null,
                    body : body
                }
            };

            tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest, macroNode);
        }
    };

    var updateAnchors = function() {
        var existingAnchors = getExistingAnchors();
        $("#wysiwygTextarea_ifr").contents().find("#tinymce").children("["+needsUpdate+"]").each(function() {
            updateAnchor(this, existingAnchors);
            $(this).attr(needsUpdate, null);
        });
    };

    AJS.bind("init.rte", function() {
        // Set random anchor when copy-pasting macro (to avoid duplicates)
        $(document).bind('postPaste', function (e, pl, o) {
            // Find out what is being pasted
            //noinspection JSValidateTypes
            $(o.node).children("[data-macro-name="+macroName+"]").each(function() {
                $(this).attr(needsUpdate, "");
            });
            setTimeout(function () {
                updateAnchors();
            }, 0);
        });
    });
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-hide-latex-macro.js' */
(function($) {
    AJS.bind("init.rte", function() {
        $( document ).ready(function() {
            $.ajax({
                url: AJS.params.baseUrl+"/rest/latexmath/latest/showlatexmacro",
                dataType: "json"
            }).done(function (data) {
                $("body").toggleClass("showLatexFalse", !data.enabled);
            });          
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-macro-math.js' */
(function($) {
    var srcUrl = document.currentScript.src;
    var mmltex;
    $.ajax({ type: "GET",
        url: srcUrl.substr(0, srcUrl.lastIndexOf('/')+1) + "mmltex.xsl",
        async: false,
        success : function(text)
        {
            mmltex = text;
        }
    });

    window.LatexMathTryConvert = function(math) {
        try {
            if (math.charAt(0) === '`' && math.charAt(math.length - 1) === '`') {
                return AMTparseAMtoTeX(math.substr(1, math.length - 2));
            } else if (math.charAt(0) === '<' && math.charAt(math.length - 1) === '>') {
                return xslt(math.replace(/&\w+;/g, convertEntity), mmltex)
                    .replace(/&gt;/g, ">")
                    .replace(/&lt;/g, "<")
                    .replace(/&amp;/g, "&")
                    .replace(/^\$([^$]*)\$$/g, "$1")
            }
        } catch(e) {
            alert(e.message);
        }
        return null;
    };

    function convertEntity(input) {
        var doc = new DOMParser().parseFromString(input, "text/html");
        return '&#'+doc.documentElement.textContent.codePointAt(0)+';';
    }

    var editorIframe = $("#wysiwygTextarea_ifr");
    $(editorIframe.contents()).on("paste", '[data-macro-name="mathblock"] .wysiwyg-macro-body', window.LatexMathHandleBodyPaste);
})(AJS.$);

/*********************************************************
 * Custom math macro editors
 */
(function($) {
    AJS.bind("init.rte", function() {

        var macroName = '';

        var fancyNames = {
            mathblock: "LaTeX Math Block",
            mathinline: "LaTeX Math Inline",
            latex: "LaTeX",
            unit: "LaTeX Unit"
        };

        var inlineList = ["mathinline", "unit"];

        var MathJax, MathJaxWarnings;

        var dialog = new AJS.Dialog({width: 800, height: 650, id: "latexmath-editor"});

        dialog.addPanel("Panel",
            '<form id="input" action="#" class="aui">'+
            '  <div class="macro-desc" id="math-macro-desc"></div>'+
            '  <div class="macro-param-div required" id="math-body-div">'+
            '    <textarea class="textarea long-field macro-param-input" id="math-body" rows=5 placeholder="'+AJS.escapeHtml("Type LaTeX Math here (e.g. E=mc^2) or paste AsciiMath or MathML for automatic conversion to LaTeX")+'"></textarea>'+
            '  </div>'+
            '  <div class="macro-param-div field-group" id="math-alignment-div">'+
            '    <label for="math-alignment">'+"Alignment"+': </label>'+
            '    <select class="select macro-param-input" id="math-alignment">'+
            '      <option value=""></option>'+
            '      <option value="left">'+"Left"+'</option>'+
            '      <option value="center">'+"Center"+'</option>'+
            '      <option value="right">'+"Right"+'</option>'+
            '    </select>'+
            '  </div>'+
            '  <div class="macro-param-div field-group" id="math-anchor-div">'+
            '    <label for="math-anchor">'+"Anchor name"+': </label>'+
            '    <input type="text" class="text macro-param-input" id="math-anchor">'+
            '    <div class="description">'+"The anchor used for linking to the math block."+'</div>'+
            '  </div>'+
            '  <div class="macro-param-div group checkbox" id="math-rawMarkup-div">'+
            '    <input type="checkbox" class="checkbox macro-param-input" id="math-rawMarkup">'+
            '    <label for="math-rawMarkup">'+"Raw LaTeX markup"+': </label>'+
            '    <div class="description">'+"Use this to ignore the LaTeX header and footer given in settings."+'</div>'+
            '  </div>'+
            '</form>'+
            '<div id="latexmath-editor-output">'+
            '  <h4 id="math-preview-heading">'+"Preview"+':</h4>'+
            '  <div class="math-preview" id="math-preview"></div>'+
            '  <div id="tex-warning"><h4>Parse warnings:</h4><p id="tex-warning-text"></p></div>'+
            '</div>'
            , "panel-body");

        function isInline() {
            return inlineList.indexOf(macroName)>-1;
        }

        function getBodyElement() {
            return $('textarea#math-body');
        }

        function getAnchorElement() {
            return $('input#math-anchor');
        }

        function getAlignmentElement() {
            return $('select#math-alignment');
        }

        function getRawMarkupElement() {
            return $('input#math-rawMarkup');
        }

        getBodyElement().bind("paste", function(e) {
            var pastedData = e.originalEvent.clipboardData.getData('text').trim();

            var latex = window.LatexMathTryConvert(pastedData);
            if (latex !== null) {
                document.execCommand("insertText", false, latex);
                e.preventDefault();
            }
        });

        function getParams() {
            var params = {};

            function setParam(key, element) {
                if (element.attr('type') == 'checkbox') {
                    params[key] = element.prop('checked');
                } else {
                    var val = element.val();
                    if (val != "") params[key] = val;
                }
            }

            setParam("alignment", getAlignmentElement());
            setParam("anchor", getAnchorElement());
            setParam("rawMarkup", getRawMarkupElement());

            if (!params["rawMarkup"]) delete params["rawMarkup"];

            if (isInline()) {
                setParam("body", getBodyElement());
                if (params["body"]) params["body"] = latexmathHelpers.encodeLatex(params["body"]);
            }

            return params;
        }

        function getBody() {
            if (!isInline()) {
                return getBodyElement().val();
            }
            return "";
        }

        function onSave() {
            var macro = {name: macroName, bodyHtml: getBody(), params: getParams(), defaultParameterValue: null};
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserComplete(macro);
        }

        dialog.addSubmit("Save", onSave);

        dialog.addLink("Cancel", function() {
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserCancel();
        });

        function openDialog(macro) {
            macroName = macro.name;
            var params = macro.params || {};

            if (macroName=="mathblock") {
                getAlignmentElement().parent().show();
                getAnchorElement().parent().show();
            } else {
                getAlignmentElement().parent().hide();
                getAnchorElement().parent().hide();
            }

            if (macroName=="latex") {
                getRawMarkupElement().parent().show();
            } else {
                getRawMarkupElement().parent().hide();
            }

            if (macro.params) {
                dialog.addHeader(AJS.format("Edit \u2018{0}\u2019 Macro", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("Save");
            } else {
                dialog.addHeader(AJS.format("Insert \u2018{0}\u2019 Macro", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("Insert");
            }

            var macroDesc = $("#math-macro-desc")[0];
            var featDiscId = "math-macro-desc-featdisc";
            macroDesc.innerHTML = "<span id=\""+featDiscId+"\"></span>";
            switch (macroName) {
                case 'mathinline':
                    macroDesc.innerHTML += "Inserts LaTeX formatted math. Math delimiters (ie. $$ .. $$) are not necessary.";
                    break;
                case 'mathblock':
                    macroDesc.innerHTML += "Inserts LaTeX formatted math. Math delimiters (ie. $$ .. $$) are not necessary.";
                    break;
                case 'unit':
                    macroDesc.innerHTML += "Inserts LaTeX formatted units (e.g. m/s).";
                    break;
                case 'latex':
                    macroDesc.innerHTML += "Inserts LaTeX. For math mode, use of Math Block and Math Inline is recommended instead.";
                    break;
            }
            macroDesc.innerHTML += ' <a target="_blank" href="https://bolosoftware.atlassian.net/wiki/display/DOC/LaTeX+Math"><span class="aui-icon icon-help"><span>Help</span></span></a>';

            if (!latexmathHelpers.readCookie(featDiscId)) {
                $.ajax({
                    url: AJS.params.baseUrl + "/rest/feature-discovery/latest/com.tensixtwo.conf.latexmath/addinlineShortcut",
                    dataType: "json"
                }).done(function (data) {
                    $.ajax({
                        url: AJS.params.baseUrl+"/rest/latexmath/latest/featdisc",
                        data: {userKey: AJS.params.remoteUserKey},
                        dataType: "json"
                    }).then(function(featdisc) {
                        if (featdisc.enabled) {
                            if (data.isNew) {
                                AJS.messages.generic("#" + featDiscId, {
                                    id: featDiscId+"Div",
                                    body: "Hint: Press Ctrl-Enter to save the macro and close this window."
                                });
                            }
                        }
                    });
                });
                $(document).on('messageClose', function (e) {
                    if (e.target.id == featDiscId+"Div") {
                        latexmathHelpers.createCookie(featDiscId, "read", 30)
                    }
                });
            }

            dialog.id = "macro-"+macroName;

            var latex = "";
            if (isInline()) {
                latex = params["body"];
            }
            if (latex == null || latex == "") {
                latex = macro.body;
            }

            getBodyElement().val(latexmathHelpers.decodeLatex(latex));
            getAlignmentElement().val(params["alignment"]);
            getAnchorElement().val(params["anchor"]);
            getRawMarkupElement().prop('checked', params["rawMarkup"]);

            dialog.show();
            previewMacro();

            function onKeyDown(event) {
                if ((event.keyCode == 10 || event.keyCode == 13) && event.ctrlKey) {
                    getBodyElement().parent().off('keydown', onKeyDown);
                    onSave()
                }
            }

            getBodyElement().parent().on('keydown', onKeyDown);
        }

        for (var key in fancyNames) {
            if (fancyNames.hasOwnProperty(key)) {
                AJS.MacroBrowser.setMacroJsOverride(key, {opener: openDialog});
            }
        }

        var oldBodyVal = null;
        getBodyElement().on("change keyup paste", function() {
            var currentVal = $(this).val();
            if(currentVal == oldBodyVal) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldBodyVal = currentVal;

            previewMacro(currentVal);
        });

        var oldHasAnchor = null;
        getAnchorElement().on("change keyup paste", function() {
            var currentVal = $(this).val().length>0;
            if(currentVal == oldHasAnchor) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldHasAnchor = currentVal;

            previewMacro();
        });

        var oldAlignmentVal = null;
        getAlignmentElement().on("change", function() {
            var currentVal = $(this).val();
            if(currentVal == oldAlignmentVal) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldAlignmentVal = currentVal;

            previewMacro();
        });

        var oldRawMarkupVal = null;
        getRawMarkupElement().on("change", function() {
            var currentVal = $(this).prop('checked');
            if(currentVal == oldRawMarkupVal) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldRawMarkupVal = currentVal;

            previewMacro();
        });

        var getEditorWarningElement = function () {
            return $('#editor-warning');
        }

        var getWarningElement = function () {
            return $("#tex-warning");
        }

        var getWarningTextElement = function () {
            return $("#tex-warning-text");
        };

        function getPreviewContainerDiv() {
            return $("div#math-preview");
        }

        function createPreviewContainer() {
            // Set the iframe source to an empty JS statement to avoid
            // secure/nonsecure warnings on https, without needing a back-end call.
            var src = AJS.params.staticResourceUrlPrefix + "/blank.html";
            getPreviewContainerDiv().html('<iframe src="' + src + '" frameborder="0" name="macro-browser-preview-frame math-preview" id="macro-preview-iframe"></iframe><div id="loading-fog"></div>');
        }

        function removePreviewContainer() {
            // removes the iFrame.
            getPreviewContainerDiv().html("");
        }

        function onPreviewComplete() {
            if (MathJax) {
                MathJax.Hub.Queue(function () {
                    if (MathJaxWarnings && MathJaxWarnings.length) {
                        getWarningTextElement().html(MathJaxWarnings.join('<br />'));
                        getWarningElement().show();
                        MathJaxWarnings.length = 0;
                    }
                    loadingInProgress(false);
                });
            } else {
                loadingInProgress(false);
            }
        }

        function loadIframe(html) {
            var iframe = $("#macro-preview-iframe");
            var doc = $(iframe).contents()[0];
            doc.write(html);
            doc.close(); // for firefox

            iframe.load(function() {
                $(doc).find('body').addClass('latexmath-preview').attr('data-macro-name', macroName);

                var iframeWindow = iframe[0].contentWindow;
                MathJax = iframeWindow.MathJax;
                MathJaxWarnings = iframeWindow.MathJaxWarnings;

                onPreviewComplete();
            });
        }

        var _loadingInProgress = false;

        function loadingInProgress(loading) {
            if (arguments.length==0) return _loadingInProgress;
            if (loading === _loadingInProgress) return;

            _loadingInProgress = loading;

            if (_loadingInProgress) {
                $('#loading-fog').show();
                getWarningElement().hide();
                getPreviewContainerDiv().spin('large');
            } else {
                $('#loading-fog').hide();
                getPreviewContainerDiv().spinStop();
            }
        }

        var delay = (function(){
            var timer = 0;
            return function(callback, ms){
                clearTimeout (timer);
                timer = setTimeout(callback, ms);
            };
        })();

        function previewMacro (newMath) {
            loadingInProgress(true);

            var mathElements = MathJax && MathJax.Hub.getAllJax('content');
            if (newMath !== undefined && mathElements && mathElements.length) {
                delay(function() {
                    $.ajax({
                        url: AJS.params.baseUrl + "/rest/latexmath/latest/preprocessmarkup",
                        data: {markup: newMath, macro: macroName.toUpperCase()},
                        dataType: "json"
                    }).then(function (data) {
                        MathJax.Hub.Queue(["Text", mathElements[0], data.markup]);
                        onPreviewComplete();
                    });
                }, 250);
                return;
            }

            removePreviewContainer();

            delay(function(){
                if (!getBodyElement().val() || (getBodyElement().val().trim().length==0)) {
                    loadingInProgress(false);
                    return;
                }

                //noinspection JSUnusedGlobalSymbols
                var options = {
                    contentId: Confluence.getContentId(),
                    macroName: macroName,
                    params: getParams(),
                    body: getBody(),
                    defaultParameterValue: null,

                    successCallback : function(html) {
                        loadIframe(html);
                    },

                    errorCallback : function(e) {
                        AJS.logError(e);
                        loadingInProgress(false);
                    }
                };

                createPreviewContainer();
                loadingInProgress(true);


                AJS.MacroBrowser.Rest.fetchMacroPreviewData(options);
            }, 1000 );
        }

        getPreviewContainerDiv().on('hide.dialog',function() {
            removePreviewContainer();
        })
    });
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-macro-ref.js' */
/*********************************************************
 * Custom math block reference editor
 */
(function($) {

    $(document).ready(function(){

        var macroName = '';

        var fancyNames = {
            'mathblock-ref': "LaTeX Math Block Reference"
        };

        var dialog = new AJS.Dialog({width: 800, height: 650});

        dialog.addPanel("Panel",
            '  <form action="#" class="aui">'+
            '    <div class="macro-desc" id="mathblock-ref-macro-desc">'+"Inserts reference with link to the Math Block with the given anchor."+'</div>'+
            '    <div class="macro-param-div field-group" id="mathblock-ref-page-div">'+
            '      <label for="mathblock-ref-page-helper">'+"Confluence page"+'</label>'+
            '      <input type="text" class="text autocomplete-page macro-param-input" id="mathblock-ref-page-helper" placeholder="This page" autocomplete="off" data-none-message="'+"Not found"+'">'+
            '      <input type="text" class="hidden" id="mathblock-ref-page">'+
            '      <div class="description">'+"The page containing the math block (leave blank for this page)."+'</div>'+
            '    </div>'+
            '    <div class="macro-param-div field-group required" id="mathblock-ref-anchor-div">'+
            '      <label for="mathblock-ref-anchor">'+"Anchor name"+'<span class="aui-icon icon-required">required</span></label>'+
            '      <input type="text" class="text macro-param-input" id="mathblock-ref-anchor" list="mathblock-ref-anchor-list" autocomplete="off"><datalist id="mathblock-ref-anchor-list"></datalist>'+
            '      <div class="description">'+"The anchor used for linking to the math block."+'</div>'+
            '    </div>'+
            '    <div class="macro-param-div field-group" id="mathblock-ref-displaytext-div">'+
            '      <label for="mathblock-ref-displaytext">'+"Link text"+'</label>'+
            '      <input type="text" class="text macro-param-input" id="mathblock-ref-displaytext" autocomplete="off">'+
            '      <div class="description">'+"Leave blank to use the number from the math block."+'</div>'+
            '    </div>'+
            '  </form>'+
            '<h4 id="mathblock-ref-preview-heading">'+"Preview"+':</h4>'+
            '<div class="mathblock-ref-preview" id="mathblock-ref-preview">'+
            '</div>'
            , "panel-body");

        AJS.toInit(function () {
            Confluence.Binder.autocompletePage(AJS.$("#mathblock-ref-page-div"));
        });

        function updateDatalist(page) {
            var datalist = $("#mathblock-ref-anchor-list");
            datalist.html('');
            function doUpdate(anchors) {
                $(anchors).each(function() {
                    datalist.append($('<option value="'+latexmathHelpers.escapeHtml(this)+'"></option>'));
                })
            }

            var anchors;
            if (!page || page == '') {
                doUpdate(latexmath_getExistingAnchors());
            } else {
                var pageRef = getPageRef(page);

                $.ajax({
                    url: AJS.params.baseUrl+"/rest/api/content",
                    data: {spaceKey: pageRef.space, title: pageRef.title},
                    dataType: "json"
                }).done(function(response) {
                    if (response.results.length == 1) {
                        $.ajax({
                            url: AJS.params.baseUrl + "/rest/api/content/" + response.results[0].id,
                            data: {expand: 'body.view'},
                            dataType: "json"
                        }).done(function (response) {
                            if (response.body) {
                                var re = new RegExp("\\d+_(.*)");
                                anchors = [];

                                $(response.body.view.value).find("span.latexmath-number").each(function () {
                                    var res = re.exec($(this).attr("data-latexmath-anchor"));
                                    anchors.push(res[1]);
                                });
                                doUpdate(anchors);
                            }
                        });
                    }
                });
            }
        }

        function getPageElement() {
            return $('input#mathblock-ref-page');
        }

        function getPageHelperElement() {
            return $('input#mathblock-ref-page-helper');
        }

        function getAnchorElement() {
            return $('input#mathblock-ref-anchor');
        }

        function getDisplayTextElement() {
            return $('input#mathblock-ref-displaytext');
        }

        function getParams() {
            var params = {};

            function setParam(key, element) {
                var val = element.val();
                if (val!="") params[key] = val;
            }

            setParam("page", getPageElement());
            setParam("anchor", getAnchorElement());
            setParam("displaytext", getDisplayTextElement());

            return params;
        }

        var getPageRef = (function(){
            var re = new RegExp("(?:(\\w+):)?(.*)");
            return function(page){
                var match = re.exec(page || '');
                return {
                    space: match[1] || '',
                    title: match[2]
                };
            };
        })();

        var makeDelay = function() {
            return (function(){
                var timer = 0;
                return function(callback, ms){
                    clearTimeout (timer);
                    timer = setTimeout(callback, ms);
                };
            })();
        };

        function onSave() {
            var macro = {name: macroName, bodyHtml: null, params: getParams(), defaultParameterValue: null};
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserComplete(macro);
        }

        dialog.addSubmit("Save", onSave);

        dialog.addLink("Cancel", function() {
            dialog.hide();
            tinymce.confluence.macrobrowser.macroBrowserCancel();
        });

        function openDialog(macro) {
            oldAnchor = null;
            oldPage = null;
            oldDisplayText = null;

            macroName = macro.name;
            var params = macro.params || {};

            if (macro.params) {
                dialog.addHeader(AJS.format("Edit \u2018{0}\u2019 Macro", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("Save");
            } else {
                dialog.addHeader(AJS.format("Insert \u2018{0}\u2019 Macro", [fancyNames[macroName]]));
                dialog.page[0].button[0].html("Insert");
            }

            dialog.id = "macro-"+macroName;

            getPageElement().val(params["page"]);
            getPageHelperElement().val(getPageRef(params["page"]).title);
            getAnchorElement().val(params["anchor"]);
            getDisplayTextElement().val(params["displaytext"]);
            updateDatalist(params["page"]);

            dialog.show();
            previewMacro();
        }

        for (var key in fancyNames) {
            if (fancyNames.hasOwnProperty(key)) {
                AJS.MacroBrowser.setMacroJsOverride(key, {opener: openDialog});
            }
        }

        var oldAnchor = null;
        getAnchorElement().on("change keyup paste input blur", function() {
            var currentVal = $(this).val();
            if(currentVal == oldAnchor) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldAnchor = currentVal;

            previewMacro();
        });

        var oldPage = null;
        var updateDatalistDelay = makeDelay();
        getPageHelperElement().on("change keyup paste input selected.autocomplete-content", function(event, data) {
            var el = $(this);
            var pageEl = getPageElement();

            if (data && data.content) {
                pageEl.val(AJS.template('{space.key}:{title}').fillHtml(data.content));
            } else if (el.val()) {
                pageEl.val(AJS.params.spaceKey+':'+el.val());
            } else {
                pageEl.val('');
            }

            var currentVal = pageEl.val();
            if(currentVal == oldPage) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldPage = currentVal;

            getAnchorElement().val('');
            updateDatalistDelay(function() {
                updateDatalist(pageEl.val())
            }, 50);
            previewMacro();
        });

        var oldDisplayText = null;
        getDisplayTextElement().on("change keyup paste", function() {
            var currentVal = $(this).val();
            if(currentVal == oldDisplayText) {
                return; //check to prevent multiple simultaneous triggers
            }

            oldDisplayText = currentVal;

            previewMacro();
        });

        function getPreviewContainerDiv() {
            return $("div#mathblock-ref-preview");
        }

        function createPreviewContainer() {
            // Set the iframe source to an empty JS statement to avoid
            // secure/nonsecure warnings on https, without needing a back-end call.
            var src = AJS.params.staticResourceUrlPrefix + "/blank.html";
            getPreviewContainerDiv().html('<iframe src="' + src + '" frameborder="0" name="macro-browser-preview-frame mathblock-ref-preview" id="macro-preview-iframe" style="width: 100%;"></iframe>');
        }

        function removePreviewContainer() {
            // removes the iFrame.
            getPreviewContainerDiv().html("");
        }

        function renderPreview(html) {
            var iframe = getPreviewContainerDiv().find("iframe")[0];
            var doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.write(html);
            doc.close(); // for firefox

            $(iframe).load(function() {
                loadingInProgress(false);
            });
        }

        var _loadingInProgress = false;

        function loadingInProgress(loading) {
            if (arguments.length==0) return _loadingInProgress;

            _loadingInProgress = loading;

            if (_loadingInProgress) {
                getPreviewContainerDiv().spin('large');
            } else {
                getPreviewContainerDiv().spinStop();
            }
        }

        var previewDelay = makeDelay();

        function previewMacro () {
            removePreviewContainer();
            loadingInProgress(true);

            previewDelay(function(){
                if (!getAnchorElement().val() || (getAnchorElement().val().trim().length==0)) {
                    loadingInProgress(false);
                    return;
                }

                var options = {
                    contentId: Confluence.getContentId(),
                    macroName: macroName,
                    params: getParams(),
                    body: null,
                    defaultParameterValue: null,

                    successCallback : function(html) {
                        renderPreview(html);
                    },

                    errorCallback : function(e) {
                        // todo: better err handling?
                        AJS.logError(e);
                        loadingInProgress(false);
                    }
                };

                createPreviewContainer();
                loadingInProgress(true);


                AJS.MacroBrowser.Rest.fetchMacroPreviewData(options);
            }, 1000 );
        }

        getPreviewContainerDiv().on('hide.dialog',function() {
            removePreviewContainer();
        })
    });
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-math-panel.js' */
/*********************************************************
 * Math inline and unit editing from panel
 */

(function($) {

    // property-panel button ids from the plugin descriptor, assumes that the parameter names equal the button ids
    var titleParameterName = "body";

    var updateMacro = function(macroName, macroNode, macroParameterCallback) {
        var $macroNode = $(macroNode);

        AJS.Rte.getEditor().selection.select($macroNode[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var macroParameters = Confluence.MacroParameterSerializer.deserialize($macroNode.attr("data-macro-parameters"));
        var body = decodeURIComponent($macroNode.attr("data-macro-body"));
        macroParameterCallback(macroParameters);

        var macroRenderRequest = {
            contentId : Confluence.Editor.getContentId(),
            macro : {
                name : macroName,
                params : macroParameters,
                defaultParameterValue : null,
                body : body
            }
        };

        tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest, macroNode);
    };

    var getCurrentTitle = function(macroNode) {
        var $macroNode = $(macroNode);
        var macroParameters = Confluence.MacroParameterSerializer.deserialize($macroNode.attr("data-macro-parameters"));
        var title = macroParameters[titleParameterName] || "";
        if(!title && ($macroNode.attr("data-macro-body-type")=="PLAIN_TEXT")) {
            title = decodeURIComponent($macroNode.attr("data-macro-body"));
        }
        return latexmathHelpers.decodeLatex(title);
    };

    AJS.bind("init.rte", function() {
        AJS.Confluence.PropertyPanel.Macro.registerInitHandler(function (macroNode, buttons) {
            var title = getCurrentTitle(macroNode);
            buttons.splice(1, 0, createTitleElement(macroNode, title, "unit")); // insert after the first element = 'Edit'
        }, "unit");

        AJS.Confluence.PropertyPanel.Macro.registerInitHandler(function (macroNode, buttons) {
            var title = getCurrentTitle(macroNode);
            buttons.splice(1, 0, createTitleElement(macroNode, title, "mathinline")); // insert after the first element = 'Edit'
        }, "mathinline");
    });

    var createTitleElement = function(macroNode, currentTitle, macroName) {
        var cssClassNames = macroName+"-macro-body first last editable";
        var $linkTitleElement;
        var $inputTitleElement = $("<input/>");
        $inputTitleElement.attr("class", cssClassNames);

        var swapTitleElement = function($currentTitleElement) {
            var currentTagName = $currentTitleElement.prop("tagName").toLowerCase();
            if(currentTagName == "a") {
                if(!$linkTitleElement) {
                    $linkTitleElement = $currentTitleElement;
                }
                $inputTitleElement.val($linkTitleElement.find("span.panel-button-text").text());
                $currentTitleElement.replaceWith($inputTitleElement);
                $inputTitleElement.focus(function() {
                    this.select();
                });
                $inputTitleElement.focus();
                var changeTitle = function() {
                    $inputTitleElement = $(this);
                    updateMacro(macroName, macroNode, function(macroParameters) {
                        var body = $inputTitleElement.val();
                        if (body.trim()) {
                            macroParameters.body = latexmathHelpers.encodeLatex(body);
                        } else if (macroParameters.body) {
                            delete macroParameters["body"];
                        }
                    });
                    AJS.Confluence.PropertyPanel.destroy();
                    swapTitleElement($inputTitleElement);
                };
                $inputTitleElement.change(function() {
                    changeTitle.call(this);
                });
                // register one for the IEs ...
                $inputTitleElement.keyup(function(e) {
                    // enter key
                    if(e.keyCode == 13) {
                        changeTitle.call(this);
                    }
                });
            }
        };

        return {
            className: cssClassNames,
            text: AJS.escapeHtml(currentTitle),
            click: swapTitleElement
        }
    }

})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/editor-handlers.js' */
(function($) {
    var autoformatHandlers = [
        {macro: 'mathinline', regex: /(?:[\s\xA0\u200b\uFEFF]+|^)(\$(?=[^\s$])([^$]*?[^\s]))$/, endChar: '$'},
        {macro: 'mathinline', regex: /(\\$)/, endChar: '('},
        {macro: 'mathblock', regex: /(\$\$(?=[^$])([^$]*?)\$)$/, endChar: '$'},
        {macro: 'mathblock', regex: /(\\$)/, endChar: '['}
    ];

    var pasteHandlers = [
        {macro: 'mathinline', regex: /^\$([^$]+)\$$/},
        {macro: 'mathinline', regex: /^\\\(([^$]+)\\\)$/},
        {macro: 'mathblock', regex: /^\$\$(?=[^$])(.+)\$\$$/},
        {macro: 'mathblock', regex: /^\\\[(.+)\\]$/}
    ];

    function makeMacro(macroName, body) {
        body = body && body.trim() || '';
        var params = {};
        if (macroName.indexOf('block') === -1) {
            if (body) {
                params['body'] = body;
            }
            body = null;
        }

        return {
            contentId: AJS.Meta.get('content-id') || "0",
            macro : {
                name : macroName,
                params : params,
                defaultParameterValue : null,
                body : body
            }
        };
    }

    function isInPlainTextMacro(element) {
        return $(element).closest("[data-macro-body-type='PLAIN_TEXT']").length;
    }

    function insertMacro(macro, body) {
        AJS.Rte.BookmarkManager.storeBookmark();
        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, body))
            .done(function (node) {
                if (!body && node.tagName.toLowerCase() === 'img') {
                    // If we are creating an empty inline macro, then select it so it is ready for user input
                    $(node).click();
                    $('#property-panel').each(function () {
                        $(this).find('a.mathinline-macro-body').click();
                        $(this).find('input.mathinline-macro-body').focus();
                    });
                }
            });
    }

    AJS.bind("confluence.editor.registerHandlers", function(e, data) {
        var handlerManager = data.handlerManager;
        var createHandler = data.createHandler;
        var editor = data.ed;

        autoformatHandlers.forEach(function(h) {
            handlerManager.registerHandler(h.endChar.charCodeAt(0), createHandler(h.regex, function (matchGroups) {
                insertMacro(h.macro, matchGroups[2]);
            }, true, 'span#autocomplete')); // Don't do this in autocomplete mode
        });

        $(document).bind('prePaste', function () {
            if (editor.removed) return;
            editor.undoManager.add();
        });

        $(document).bind('postPaste', function (e, pl, o) {
            if (editor.removed) return;

            if (!editor.selection || !isInPlainTextMacro(editor.selection.getStart())) {
                var text = o.node.textContent.trim();
                var match, macro;
                pasteHandlers.forEach(function (h) {
                    if (!match) {
                        match = h.regex.exec(text);
                        macro = h.macro;
                    }
                });

                if (match && match.length && match[1]) {
                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();
                        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, match[1])).done(function () {
                            editor.undoManager.add();
                        });
                    }, 1);
                }
            }
        });

        editor.onPaste.add(function (editor, e) {
            if (isInPlainTextMacro(editor.selection.getStart()) && isInPlainTextMacro(editor.selection.getEnd())) {
                var content = ((e.originalEvent || e).clipboardData || window.clipboardData).getData('Text');
                var latex = window.LatexMathTryConvert(content);
                if (latex !== null) {
                    e.preventDefault();

                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();

                        editor.selection.setContent(latex);
                        // editor.execCommand('mceInsertContent', false, latex);
                        e.preventDefault();

                        editor.undoManager.add();
                    }, 1);
                }
            }
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'js/ASCIIMathTeXImg.js' */
/*
ASCIIMathTeXImg.js
Based on ASCIIMathML, Version 1.4.7 Aug 30, 2005, (c) Peter Jipsen http://www.chapman.edu/~jipsen
Modified with TeX conversion for IMG rendering Sept 6, 2006 (c) David Lippman http://www.pierce.ctc.edu/dlippman
  Updated to match ver 2.2 Mar 3, 2014
  Latest at https://github.com/mathjax/asciimathml
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

(function() {
var config = {
  translateOnLoad: true,		  //true to autotranslate
  mathcolor: "",       	      // defaults to back, or specify any other color
  displaystyle: true,         // puts limits above and below large operators
  showasciiformulaonhover: true, // helps students learn ASCIIMath
  decimalsign: ".",           // change to "," if you like, beware of `(1,2)`!
  AMdelimiter1: "`", AMescape1: "\\\\`", // can use other characters
  AMusedelimiter2: false, 	  //whether to use second delimiter below
  AMdelimiter2: "$", AMescape2: "\\\\\\$", AMdelimiter2regexp: "\\$",
  AMdocumentId: "wikitext",   // PmWiki element containing math (default=body)
  doubleblankmathdelimiter: false // if true,  x+1  is equal to `x+1`
};                                // for IE this works only in <!--   -->

var CONST = 0, UNARY = 1, BINARY = 2, INFIX = 3, LEFTBRACKET = 4,
    RIGHTBRACKET = 5, SPACE = 6, UNDEROVER = 7, DEFINITION = 8,
    LEFTRIGHT = 9, TEXT = 10; // token types

var AMsqrt = {input:"sqrt", tag:"msqrt", output:"sqrt", tex:null, ttype:UNARY},
  AMroot  = {input:"root", tag:"mroot", output:"root", tex:null, ttype:BINARY},
  AMfrac  = {input:"frac", tag:"mfrac", output:"/",    tex:null, ttype:BINARY},
  AMdiv   = {input:"/",    tag:"mfrac", output:"/",    tex:null, ttype:INFIX},
  AMover  = {input:"stackrel", tag:"mover", output:"stackrel", tex:null, ttype:BINARY},
  AMsub   = {input:"_",    tag:"msub",  output:"_",    tex:null, ttype:INFIX},
  AMsup   = {input:"^",    tag:"msup",  output:"^",    tex:null, ttype:INFIX},
  AMtext  = {input:"text", tag:"mtext", output:"text", tex:null, ttype:TEXT},
  AMmbox  = {input:"mbox", tag:"mtext", output:"mbox", tex:null, ttype:TEXT},
  AMquote = {input:"\"",   tag:"mtext", output:"mbox", tex:null, ttype:TEXT};

var AMsymbols = [
//some greek symbols
{input:"alpha",  tag:"mi", output:"\u03B1", tex:null, ttype:CONST},
{input:"beta",   tag:"mi", output:"\u03B2", tex:null, ttype:CONST},
{input:"chi",    tag:"mi", output:"\u03C7", tex:null, ttype:CONST},
{input:"delta",  tag:"mi", output:"\u03B4", tex:null, ttype:CONST},
{input:"Delta",  tag:"mo", output:"\u0394", tex:null, ttype:CONST},
{input:"epsi",   tag:"mi", output:"\u03B5", tex:"epsilon", ttype:CONST},
{input:"varepsilon", tag:"mi", output:"\u025B", tex:null, ttype:CONST},
{input:"eta",    tag:"mi", output:"\u03B7", tex:null, ttype:CONST},
{input:"gamma",  tag:"mi", output:"\u03B3", tex:null, ttype:CONST},
{input:"Gamma",  tag:"mo", output:"\u0393", tex:null, ttype:CONST},
{input:"iota",   tag:"mi", output:"\u03B9", tex:null, ttype:CONST},
{input:"kappa",  tag:"mi", output:"\u03BA", tex:null, ttype:CONST},
{input:"lambda", tag:"mi", output:"\u03BB", tex:null, ttype:CONST},
{input:"Lambda", tag:"mo", output:"\u039B", tex:null, ttype:CONST},
{input:"lamda",   tag:"mi", output:"lambda", tex:null, ttype:DEFINITION},
{input:"Lamda",   tag:"mi", output:"Lambda", tex:null, ttype:DEFINITION},
{input:"mu",     tag:"mi", output:"\u03BC", tex:null, ttype:CONST},
{input:"nu",     tag:"mi", output:"\u03BD", tex:null, ttype:CONST},
{input:"omega",  tag:"mi", output:"\u03C9", tex:null, ttype:CONST},
{input:"Omega",  tag:"mo", output:"\u03A9", tex:null, ttype:CONST},
{input:"phi",    tag:"mi", output:"\u03C6", tex:null, ttype:CONST},
{input:"varphi", tag:"mi", output:"\u03D5", tex:null, ttype:CONST},
{input:"Phi",    tag:"mo", output:"\u03A6", tex:null, ttype:CONST},
{input:"pi",     tag:"mi", output:"\u03C0", tex:null, ttype:CONST},
{input:"Pi",     tag:"mo", output:"\u03A0", tex:null, ttype:CONST},
{input:"psi",    tag:"mi", output:"\u03C8", tex:null, ttype:CONST},
{input:"Psi",    tag:"mi", output:"\u03A8", tex:null, ttype:CONST},
{input:"rho",    tag:"mi", output:"\u03C1", tex:null, ttype:CONST},
{input:"sigma",  tag:"mi", output:"\u03C3", tex:null, ttype:CONST},
{input:"Sigma",  tag:"mo", output:"\u03A3", tex:null, ttype:CONST},
{input:"tau",    tag:"mi", output:"\u03C4", tex:null, ttype:CONST},
{input:"theta",  tag:"mi", output:"\u03B8", tex:null, ttype:CONST},
{input:"vartheta", tag:"mi", output:"\u03D1", tex:null, ttype:CONST},
{input:"Theta",  tag:"mo", output:"\u0398", tex:null, ttype:CONST},
{input:"upsilon", tag:"mi", output:"\u03C5", tex:null, ttype:CONST},
{input:"xi",     tag:"mi", output:"\u03BE", tex:null, ttype:CONST},
{input:"Xi",     tag:"mo", output:"\u039E", tex:null, ttype:CONST},
{input:"zeta",   tag:"mi", output:"\u03B6", tex:null, ttype:CONST},

//binary operation symbols
{input:"*",  tag:"mo", output:"\u22C5", tex:"cdot", ttype:CONST},
{input:"**", tag:"mo", output:"\u2217", tex:"ast", ttype:CONST},
{input:"***", tag:"mo", output:"\u22C6", tex:"star", ttype:CONST},
{input:"//", tag:"mo", output:"/",      tex:"/", ttype:CONST, val:true, notexcopy:true},
{input:"\\\\", tag:"mo", output:"\\",   tex:"backslash", ttype:CONST},
{input:"setminus", tag:"mo", output:"\\", tex:null, ttype:CONST},
{input:"xx", tag:"mo", output:"\u00D7", tex:"times", ttype:CONST},
{input:"|><", tag:"mo", output:"\u22C9", tex:"ltimes", ttype:CONST},
{input:"><|", tag:"mo", output:"\u22CA", tex:"rtimes", ttype:CONST},
{input:"|><|", tag:"mo", output:"\u22C8", tex:"bowtie", ttype:CONST},
{input:"-:", tag:"mo", output:"\u00F7", tex:"div", ttype:CONST},
{input:"divide",   tag:"mo", output:"-:", tex:null, ttype:DEFINITION},
{input:"@",  tag:"mo", output:"\u2218", tex:"circ", ttype:CONST},
{input:"o+", tag:"mo", output:"\u2295", tex:"oplus", ttype:CONST},
{input:"ox", tag:"mo", output:"\u2297", tex:"otimes", ttype:CONST},
{input:"o.", tag:"mo", output:"\u2299", tex:"odot", ttype:CONST},
{input:"sum", tag:"mo", output:"\u2211", tex:null, ttype:UNDEROVER},
{input:"prod", tag:"mo", output:"\u220F", tex:null, ttype:UNDEROVER},
{input:"^^",  tag:"mo", output:"\u2227", tex:"wedge", ttype:CONST},
{input:"^^^", tag:"mo", output:"\u22C0", tex:"bigwedge", ttype:UNDEROVER},
{input:"vv",  tag:"mo", output:"\u2228", tex:"vee", ttype:CONST},
{input:"vvv", tag:"mo", output:"\u22C1", tex:"bigvee", ttype:UNDEROVER},
{input:"nn",  tag:"mo", output:"\u2229", tex:"cap", ttype:CONST},
{input:"nnn", tag:"mo", output:"\u22C2", tex:"bigcap", ttype:UNDEROVER},
{input:"uu",  tag:"mo", output:"\u222A", tex:"cup", ttype:CONST},
{input:"uuu", tag:"mo", output:"\u22C3", tex:"bigcup", ttype:UNDEROVER},
{input:"overset", tag:"mover", output:"stackrel", tex:null, ttype:BINARY},
{input:"underset", tag:"munder", output:"stackrel", tex:null, ttype:BINARY},

//binary relation symbols
{input:"!=",  tag:"mo", output:"\u2260", tex:"ne", ttype:CONST},
{input:":=",  tag:"mo", output:":=",     tex:null, ttype:CONST},
{input:"lt",  tag:"mo", output:"<",      tex:null, ttype:CONST},
{input:"gt",  tag:"mo", output:">",      tex:null, ttype:CONST},
{input:"<=",  tag:"mo", output:"\u2264", tex:"le", ttype:CONST},
{input:"lt=", tag:"mo", output:"\u2264", tex:"leq", ttype:CONST},
{input:"gt=",  tag:"mo", output:"\u2265", tex:"geq", ttype:CONST},
{input:">=",  tag:"mo", output:"\u2265", tex:"ge", ttype:CONST},
{input:"-<",  tag:"mo", output:"\u227A", tex:"prec", ttype:CONST},
{input:"-lt", tag:"mo", output:"\u227A", tex:null, ttype:CONST},
{input:">-",  tag:"mo", output:"\u227B", tex:"succ", ttype:CONST},
{input:"-<=", tag:"mo", output:"\u2AAF", tex:"preceq", ttype:CONST},
{input:">-=", tag:"mo", output:"\u2AB0", tex:"succeq", ttype:CONST},
{input:"in",  tag:"mo", output:"\u2208", tex:null, ttype:CONST},
{input:"!in", tag:"mo", output:"\u2209", tex:"notin", ttype:CONST},
{input:"sub", tag:"mo", output:"\u2282", tex:"subset", ttype:CONST},
{input:"sup", tag:"mo", output:"\u2283", tex:"supset", ttype:CONST},
{input:"sube", tag:"mo", output:"\u2286", tex:"subseteq", ttype:CONST},
{input:"supe", tag:"mo", output:"\u2287", tex:"supseteq", ttype:CONST},
{input:"-=",  tag:"mo", output:"\u2261", tex:"equiv", ttype:CONST},
{input:"~=",  tag:"mo", output:"\u2245", tex:"stackrel{\\sim}{=}", notexcopy: true, ttype:CONST}, //back hack b/c mimetex doesn't support /cong
{input:"cong",   tag:"mo", output:"~=", tex:null, ttype:DEFINITION},
{input:"~~",  tag:"mo", output:"\u2248", tex:"approx", ttype:CONST},
{input:"prop", tag:"mo", output:"\u221D", tex:"propto", ttype:CONST},

//logical symbols
{input:"and", tag:"mtext", output:"and", tex:null, ttype:SPACE},
{input:"or",  tag:"mtext", output:"or",  tex:null, ttype:SPACE},
{input:"not", tag:"mo", output:"\u00AC", tex:"neg", ttype:CONST},
{input:"=>",  tag:"mo", output:"\u21D2", tex:"Rightarrow", ttype:CONST},
{input:"implies",   tag:"mo", output:"=>", tex:null, ttype:DEFINITION},
{input:"if",  tag:"mo", output:"if",     tex:null, ttype:SPACE},
{input:"<=>", tag:"mo", output:"\u21D4", tex:"Leftrightarrow", ttype:CONST},
{input:"iff",   tag:"mo", output:"<=>", tex:null, ttype:DEFINITION},
{input:"AA",  tag:"mo", output:"\u2200", tex:"forall", ttype:CONST},
{input:"EE",  tag:"mo", output:"\u2203", tex:"exists", ttype:CONST},
{input:"_|_", tag:"mo", output:"\u22A5", tex:"bot", ttype:CONST},
{input:"TT",  tag:"mo", output:"\u22A4", tex:"top", ttype:CONST},
{input:"|--",  tag:"mo", output:"\u22A2", tex:"vdash", ttype:CONST},
{input:"|==",  tag:"mo", output:"\u22A8", tex:"models", ttype:CONST}, //mimetex doesn't support

//grouping brackets
{input:"(", tag:"mo", output:"(", tex:null, ttype:LEFTBRACKET, val:true},
{input:")", tag:"mo", output:")", tex:null, ttype:RIGHTBRACKET, val:true},
{input:"[", tag:"mo", output:"[", tex:null, ttype:LEFTBRACKET, val:true},
{input:"]", tag:"mo", output:"]", tex:null, ttype:RIGHTBRACKET, val:true},
{input:"left(", tag:"mo", output:"(", tex:"(", notexcopy: true, ttype:LEFTBRACKET, val:true},
{input:"right)", tag:"mo", output:")", tex:")", notexcopy: true, ttype:RIGHTBRACKET, val:true},
{input:"left[", tag:"mo", output:"[", tex:"[", notexcopy: true, ttype:LEFTBRACKET, val:true},
{input:"right]", tag:"mo", output:"]", tex:"]", notexcopy: true, ttype:RIGHTBRACKET, val:true},
{input:"{", tag:"mo", output:"{", tex:"lbrace", ttype:LEFTBRACKET},
{input:"}", tag:"mo", output:"}", tex:"rbrace", ttype:RIGHTBRACKET},
{input:"|", tag:"mo", output:"|", tex:null, ttype:LEFTRIGHT, val:true},
{input:"|:", tag:"mo", output:"|", tex:"|", ttype:LEFTBRACKET, notexcopy:true, val:true},
{input:":|", tag:"mo", output:"|", tex:"|", ttype:RIGHTBRACKET, notexcopy:true, val:true},
{input:":|:", tag:"mo", output:"|", tex:"|", ttype:CONST, notexcopy:true, val:true},
//{input:"||", tag:"mo", output:"||", tex:null, ttype:LEFTRIGHT},
{input:"(:", tag:"mo", output:"\u2329", tex:"langle", ttype:LEFTBRACKET},
{input:":)", tag:"mo", output:"\u232A", tex:"rangle", ttype:RIGHTBRACKET},
{input:"<<", tag:"mo", output:"\u2329", tex:"langle", ttype:LEFTBRACKET},
{input:">>", tag:"mo", output:"\u232A", tex:"rangle", ttype:RIGHTBRACKET},
{input:"{:", tag:"mo", output:"{:", tex:null, ttype:LEFTBRACKET, invisible:true},
{input:":}", tag:"mo", output:":}", tex:null, ttype:RIGHTBRACKET, invisible:true},

//miscellaneous symbols
{input:"int",  tag:"mo", output:"\u222B", tex:null, ttype:CONST},
{input:"dx",   tag:"mi", output:"{:d x:}", tex:null, ttype:DEFINITION},
{input:"dy",   tag:"mi", output:"{:d y:}", tex:null, ttype:DEFINITION},
{input:"dz",   tag:"mi", output:"{:d z:}", tex:null, ttype:DEFINITION},
{input:"dt",   tag:"mi", output:"{:d t:}", tex:null, ttype:DEFINITION},
{input:"oint", tag:"mo", output:"\u222E", tex:null, ttype:CONST},
{input:"del",  tag:"mo", output:"\u2202", tex:"partial", ttype:CONST},
{input:"grad", tag:"mo", output:"\u2207", tex:"nabla", ttype:CONST},
{input:"+-",   tag:"mo", output:"\u00B1", tex:"pm", ttype:CONST},
{input:"O/",   tag:"mo", output:"\u2205", tex:"emptyset", ttype:CONST},
{input:"oo",   tag:"mo", output:"\u221E", tex:"infty", ttype:CONST},
{input:"aleph", tag:"mo", output:"\u2135", tex:null, ttype:CONST},
{input:"...",  tag:"mo", output:"...",    tex:"ldots", ttype:CONST},
{input:":.",  tag:"mo", output:"\u2234",  tex:"therefore", ttype:CONST},
{input:":'",  tag:"mo", output:"\u2235",  tex:"because", ttype:CONST},
{input:"/_",  tag:"mo", output:"\u2220",  tex:"angle", ttype:CONST},
{input:"/_\\",  tag:"mo", output:"\u25B3",  tex:"triangle", ttype:CONST},
{input:"\\ ",  tag:"mo", output:"\u00A0", tex:null, ttype:CONST, val:true},
{input:"frown",  tag:"mo", output:"\u2322", tex:null, ttype:CONST},
{input:"%",  tag:"mo", output:"%", tex:"%", ttype:CONST, notexcopy:true},
{input:"quad", tag:"mo", output:"\u00A0\u00A0", tex:null, ttype:CONST},
{input:"qquad", tag:"mo", output:"\u00A0\u00A0\u00A0\u00A0", tex:null, ttype:CONST},
{input:"cdots", tag:"mo", output:"\u22EF", tex:null, ttype:CONST},
{input:"vdots", tag:"mo", output:"\u22EE", tex:null, ttype:CONST},
{input:"ddots", tag:"mo", output:"\u22F1", tex:null, ttype:CONST},
{input:"diamond", tag:"mo", output:"\u22C4", tex:null, ttype:CONST},
{input:"square", tag:"mo", output:"\u25A1", tex:"boxempty", ttype:CONST},
{input:"|__", tag:"mo", output:"\u230A",  tex:"lfloor", ttype:CONST},
{input:"__|", tag:"mo", output:"\u230B",  tex:"rfloor", ttype:CONST},
{input:"|~", tag:"mo", output:"\u2308",  tex:"lceil", ttype:CONST},
{input:"lceiling",   tag:"mo", output:"|~", tex:null, ttype:DEFINITION},
{input:"~|", tag:"mo", output:"\u2309",  tex:"rceil", ttype:CONST},
{input:"rceiling",   tag:"mo", output:"~|", tex:null, ttype:DEFINITION},
{input:"CC",  tag:"mo", output:"\u2102", tex:"mathbb{C}", ttype:CONST, notexcopy:true},
{input:"NN",  tag:"mo", output:"\u2115", tex:"mathbb{N}", ttype:CONST, notexcopy:true},
{input:"QQ",  tag:"mo", output:"\u211A", tex:"mathbb{Q}", ttype:CONST, notexcopy:true},
{input:"RR",  tag:"mo", output:"\u211D", tex:"mathbb{R}", ttype:CONST, notexcopy:true},
{input:"ZZ",  tag:"mo", output:"\u2124", tex:"mathbb{Z}", ttype:CONST, notexcopy:true},
{input:"f",   tag:"mi", output:"f",      tex:null, ttype:UNARY, func:true, val:true},
{input:"g",   tag:"mi", output:"g",      tex:null, ttype:UNARY, func:true, val:true},
{input:"''", tag:"mo", output:"''", tex:null, val:true},
{input:"'''", tag:"mo", output:"'''", tex:null, val:true},
{input:"''''", tag:"mo", output:"''''", tex:null, val:true},


//standard functions
{input:"lim",  tag:"mo", output:"lim", tex:null, ttype:UNDEROVER},
{input:"Lim",  tag:"mo", output:"Lim", tex:null, ttype:UNDEROVER},
{input:"sin",  tag:"mo", output:"sin", tex:null, ttype:UNARY, func:true},
{input:"cos",  tag:"mo", output:"cos", tex:null, ttype:UNARY, func:true},
{input:"tan",  tag:"mo", output:"tan", tex:null, ttype:UNARY, func:true},
{input:"arcsin",  tag:"mo", output:"arcsin", tex:null, ttype:UNARY, func:true},
{input:"arccos",  tag:"mo", output:"arccos", tex:null, ttype:UNARY, func:true},
{input:"arctan",  tag:"mo", output:"arctan", tex:null, ttype:UNARY, func:true},
{input:"sinh", tag:"mo", output:"sinh", tex:null, ttype:UNARY, func:true},
{input:"cosh", tag:"mo", output:"cosh", tex:null, ttype:UNARY, func:true},
{input:"tanh", tag:"mo", output:"tanh", tex:null, ttype:UNARY, func:true},
{input:"cot",  tag:"mo", output:"cot", tex:null, ttype:UNARY, func:true},
{input:"coth",  tag:"mo", output:"coth", tex:null, ttype:UNARY, func:true},
{input:"sech",  tag:"mo", output:"sech", tex:null, ttype:UNARY, func:true},
{input:"csch",  tag:"mo", output:"csch", tex:null, ttype:UNARY, func:true},
{input:"sec",  tag:"mo", output:"sec", tex:null, ttype:UNARY, func:true},
{input:"csc",  tag:"mo", output:"csc", tex:null, ttype:UNARY, func:true},
{input:"log",  tag:"mo", output:"log", tex:null, ttype:UNARY, func:true},
{input:"ln",   tag:"mo", output:"ln",  tex:null, ttype:UNARY, func:true},
{input:"abs",   tag:"mo", output:"abs",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["|","|"]},
{input:"norm",   tag:"mo", output:"norm",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["\\|","\\|"]},
{input:"floor",   tag:"mo", output:"floor",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["\\lfloor","\\rfloor"]},
{input:"ceil",   tag:"mo", output:"ceil",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["\\lceil","\\rceil"]},
{input:"Sin",  tag:"mo", output:"Sin", tex:null, ttype:UNARY, func:true},
{input:"Cos",  tag:"mo", output:"Cos", tex:null, ttype:UNARY, func:true},
{input:"Tan",  tag:"mo", output:"Tan", tex:null, ttype:UNARY, func:true},
{input:"Arcsin",  tag:"mo", output:"Arcsin", tex:null, ttype:UNARY, func:true},
{input:"Arccos",  tag:"mo", output:"Arccos", tex:null, ttype:UNARY, func:true},
{input:"Arctan",  tag:"mo", output:"Arctan", tex:null, ttype:UNARY, func:true},
{input:"Sinh", tag:"mo", output:"Sinh", tex:null, ttype:UNARY, func:true},
{input:"Cosh", tag:"mo", output:"Cosh", tex:null, ttype:UNARY, func:true},
{input:"Tanh", tag:"mo", output:"Tanh", tex:null, ttype:UNARY, func:true},
{input:"Cot",  tag:"mo", output:"Cot", tex:null, ttype:UNARY, func:true},
{input:"Sec",  tag:"mo", output:"Sec", tex:null, ttype:UNARY, func:true},
{input:"Csc",  tag:"mo", output:"Csc", tex:null, ttype:UNARY, func:true},
{input:"Log",  tag:"mo", output:"Log", tex:null, ttype:UNARY, func:true},
{input:"Ln",   tag:"mo", output:"Ln",  tex:null, ttype:UNARY, func:true},
{input:"Abs",   tag:"mo", output:"abs",  tex:null, ttype:UNARY, notexcopy:true, rewriteleftright:["|","|"]},

{input:"det",  tag:"mo", output:"det", tex:null, ttype:UNARY, func:true},
{input:"exp",  tag:"mo", output:"exp", tex:null, ttype:UNARY, func:true},
{input:"dim",  tag:"mo", output:"dim", tex:null, ttype:CONST},
{input:"mod",  tag:"mo", output:"mod", tex:"text{mod}", ttype:CONST, notexcopy:true},
{input:"gcd",  tag:"mo", output:"gcd", tex:null, ttype:UNARY, func:true},
{input:"lcm",  tag:"mo", output:"lcm", tex:"text{lcm}", ttype:UNARY, func:true, notexcopy:true},
{input:"lub",  tag:"mo", output:"lub", tex:null, ttype:CONST},
{input:"glb",  tag:"mo", output:"glb", tex:null, ttype:CONST},
{input:"min",  tag:"mo", output:"min", tex:null, ttype:UNDEROVER},
{input:"max",  tag:"mo", output:"max", tex:null, ttype:UNDEROVER},

//arrows
{input:"uarr", tag:"mo", output:"\u2191", tex:"uparrow", ttype:CONST},
{input:"darr", tag:"mo", output:"\u2193", tex:"downarrow", ttype:CONST},
{input:"rarr", tag:"mo", output:"\u2192", tex:"rightarrow", ttype:CONST},
{input:"->",   tag:"mo", output:"\u2192", tex:"to", ttype:CONST},
{input:">->",   tag:"mo", output:"\u21A3", tex:"rightarrowtail", ttype:CONST},
{input:"->>",   tag:"mo", output:"\u21A0", tex:"twoheadrightarrow", ttype:CONST},
{input:">->>",   tag:"mo", output:"\u2916", tex:"twoheadrightarrowtail", ttype:CONST},
{input:"|->",  tag:"mo", output:"\u21A6", tex:"mapsto", ttype:CONST},
{input:"larr", tag:"mo", output:"\u2190", tex:"leftarrow", ttype:CONST},
{input:"harr", tag:"mo", output:"\u2194", tex:"leftrightarrow", ttype:CONST},
{input:"rArr", tag:"mo", output:"\u21D2", tex:"Rightarrow", ttype:CONST},
{input:"lArr", tag:"mo", output:"\u21D0", tex:"Leftarrow", ttype:CONST},
{input:"hArr", tag:"mo", output:"\u21D4", tex:"Leftrightarrow", ttype:CONST},

//commands with argument
AMsqrt, AMroot, AMfrac, AMdiv, AMover, AMsub, AMsup,
{input:"cancel", tag:"menclose", output:"cancel", tex:null, ttype:UNARY},
{input:"Sqrt", tag:"msqrt", output:"sqrt", tex:null, ttype:UNARY},
{input:"hat", tag:"mover", output:"\u005E", tex:null, ttype:UNARY, acc:true},
{input:"bar", tag:"mover", output:"\u00AF", tex:"overline", ttype:UNARY, acc:true},
{input:"vec", tag:"mover", output:"\u2192", tex:null, ttype:UNARY, acc:true},
{input:"tilde", tag:"mover", output:"~", tex:null, ttype:UNARY, acc:true},
{input:"dot", tag:"mover", output:".",      tex:null, ttype:UNARY, acc:true},
{input:"ddot", tag:"mover", output:"..",    tex:null, ttype:UNARY, acc:true},
{input:"overarc", tag:"mover", output:"\u23DC", tex:"stackrel{\\frown}", notexcopy: true, ttype:UNARY, acc:true},
{input:"overparen", tag:"mover", output:"\u23DC", tex:"stackrel{\\frown}", notexcopy: true, ttype:UNARY, acc:true},
{input:"ul", tag:"munder", output:"\u0332", tex:"underline", ttype:UNARY, acc:true},
{input:"ubrace", tag:"munder", output:"\u23DF", tex:"underbrace", ttype:UNARY, acc:true},
{input:"obrace", tag:"mover", output:"\u23DE", tex:"overbrace", ttype:UNARY, acc:true},
AMtext, AMmbox, AMquote,
//{input:"var", tag:"mstyle", atname:"fontstyle", atval:"italic", output:"var", tex:null, ttype:UNARY},
{input:"color", tag:"mstyle", ttype:BINARY},
{input:"bb", tag:"mstyle", atname:"mathvariant", atval:"bold", output:"bb", tex:"mathbf", ttype:UNARY, notexcopy:true},
{input:"mathbf", tag:"mstyle", atname:"mathvariant", atval:"bold", output:"mathbf", tex:null, ttype:UNARY},
{input:"sf", tag:"mstyle", atname:"mathvariant", atval:"sans-serif", output:"sf", tex:"mathsf", ttype:UNARY, notexcopy:true},
{input:"mathsf", tag:"mstyle", atname:"mathvariant", atval:"sans-serif", output:"mathsf", tex:null, ttype:UNARY},
{input:"bbb", tag:"mstyle", atname:"mathvariant", atval:"double-struck", output:"bbb", tex:"mathbb", ttype:UNARY, notexcopy:true},
{input:"mathbb", tag:"mstyle", atname:"mathvariant", atval:"double-struck", output:"mathbb", tex:null, ttype:UNARY},
{input:"cc",  tag:"mstyle", atname:"mathvariant", atval:"script", output:"cc", tex:"mathcal", ttype:UNARY, notexcopy:true},
{input:"mathcal", tag:"mstyle", atname:"mathvariant", atval:"script", output:"mathcal", tex:null, ttype:UNARY},
{input:"tt",  tag:"mstyle", atname:"mathvariant", atval:"monospace", output:"tt", tex:"mathtt", ttype:UNARY, notexcopy:true},
{input:"mathtt", tag:"mstyle", atname:"mathvariant", atval:"monospace", output:"mathtt", tex:null, ttype:UNARY},
{input:"fr",  tag:"mstyle", atname:"mathvariant", atval:"fraktur", output:"fr", tex:"mathfrak", ttype:UNARY, notexcopy:true},
{input:"mathfrak",  tag:"mstyle", atname:"mathvariant", atval:"fraktur", output:"mathfrak", tex:null, ttype:UNARY}
];

function compareNames(s1,s2) {
  if (s1.input > s2.input) return 1
  else return -1;
}

var AMnames = []; //list of input symbols

function AMinitSymbols() {
  var i;
  var symlen = AMsymbols.length;
  for (i=0; i<symlen; i++) {
    if (AMsymbols[i].tex && !(typeof AMsymbols[i].notexcopy == "boolean" && AMsymbols[i].notexcopy)) {
       AMsymbols.push({input:AMsymbols[i].tex,
        tag:AMsymbols[i].tag, output:AMsymbols[i].output, ttype:AMsymbols[i].ttype,
        acc:(AMsymbols[i].acc||false)});
    }
  }
  refreshSymbols();
}

function refreshSymbols(){
  var i;
  AMsymbols.sort(compareNames);
  for (i=0; i<AMsymbols.length; i++) AMnames[i] = AMsymbols[i].input;
}

function newcommand(oldstr,newstr) {
  AMsymbols.push({input:oldstr, tag:"mo", output:newstr, tex:null, ttype:DEFINITION});
  refreshSymbols();
}

function newsymbol(symbolobj) {
  AMsymbols.push(symbolobj);
  refreshSymbols();
}

function AMremoveCharsAndBlanks(str,n) {
//remove n characters and any following blanks
  var st;
  if (str.charAt(n)=="\\" && str.charAt(n+1)!="\\" && str.charAt(n+1)!=" ")
    st = str.slice(n+1);
  else st = str.slice(n);
  for (var i=0; i<st.length && st.charCodeAt(i)<=32; i=i+1);
  return st.slice(i);
}

function AMposition(arr, str, n) {
// return position >=n where str appears or would be inserted
// assumes arr is sorted
  if (n==0) {
    var h,m;
    n = -1;
    h = arr.length;
    while (n+1<h) {
      m = (n+h) >> 1;
      if (arr[m]<str) n = m; else h = m;
    }
    return h;
  } else
    for (var i=n; i<arr.length && arr[i]<str; i++);
  return i; // i=arr.length || arr[i]>=str
}

function AMgetSymbol(str) {
//return maximal initial substring of str that appears in names
//return null if there is none
  var k = 0; //new pos
  var j = 0; //old pos
  var mk; //match pos
  var st;
  var tagst;
  var match = "";
  var more = true;
  for (var i=1; i<=str.length && more; i++) {
    st = str.slice(0,i); //initial substring of length i
    j = k;
    k = AMposition(AMnames, st, j);
    if (k<AMnames.length && str.slice(0,AMnames[k].length)==AMnames[k]){
      match = AMnames[k];
      mk = k;
      i = match.length;
    }
    more = k<AMnames.length && str.slice(0,AMnames[k].length)>=AMnames[k];
  }
  AMpreviousSymbol=AMcurrentSymbol;
  if (match!=""){
    AMcurrentSymbol=AMsymbols[mk].ttype;
    return AMsymbols[mk];
  }
// if str[0] is a digit or - return maxsubstring of digits.digits
  AMcurrentSymbol=CONST;
  k = 1;
  st = str.slice(0,1);
  var integ = true;

  while ("0"<=st && st<="9" && k<=str.length) {
    st = str.slice(k,k+1);
    k++;
  }
  if (st == config.decimalsign) {
    st = str.slice(k,k+1);
    if ("0"<=st && st<="9") {
      integ = false;
      k++;
      while ("0"<=st && st<="9" && k<=str.length) {
        st = str.slice(k,k+1);
        k++;
      }
    }
  }
  if ((integ && k>1) || k>2) {
    st = str.slice(0,k-1);
    tagst = "mn";
  } else {
    k = 2;
    st = str.slice(0,1); //take 1 character
    tagst = (("A">st || st>"Z") && ("a">st || st>"z")?"mo":"mi");
  }
  if (st=="-" && AMpreviousSymbol==INFIX) {
    AMcurrentSymbol = INFIX;
    return {input:st, tag:tagst, output:st, ttype:UNARY, func:true, val:true};
  }
  return {input:st, tag:tagst, output:st, ttype:CONST, val:true}; //added val bit
}

function AMTremoveBrackets(node) {

  var st;
  if (node.charAt(0)=='{' && node.charAt(node.length-1)=='}') {
    var leftchop = 0;

    st = node.substr(1,5);
    if (st=='\\left') {
    	    st = node.charAt(6);
    	    if (st=="(" || st=="[" || st=="{") {
    	    	    leftchop = 7;
    	    } else {
    	    	    st = node.substr(6,7);
    	    	    if (st=='\\lbrace') {
    	    	    	    leftchop = 13;
    	    	    }
    	    }
    } else {
    	    st = node.charAt(1);
    	    if (st=="(" || st=="[") {
    	    	    leftchop = 2;
    	    }
    }
    if (leftchop>0) {
    	    //st = node.charAt(node.length-7);
    	    st = node.substr(node.length-8);
    	    if (st=="\\right)}" || st=="\\right]}" || st=='\\right.}') {
    	    	    node = '{'+node.substr(leftchop);
    	    	    node = node.substr(0,node.length-8)+'}';
    	    } else if (st=='\\rbrace}') {
    	    	    node = '{'+node.substr(leftchop);
    	    	    node = node.substr(0,node.length-14)+'}';
    	    }
    }
  }
  return node;
}

/*Parsing ASCII math expressions with the following grammar
v ::= [A-Za-z] | greek letters | numbers | other constant symbols
u ::= sqrt | text | bb | other unary symbols for font commands
b ::= frac | root | stackrel         binary symbols
l ::= ( | [ | { | (: | {:            left brackets
r ::= ) | ] | } | :) | :}            right brackets
S ::= v | lEr | uS | bSS             Simple expression
I ::= S_S | S^S | S_S^S | S          Intermediate expression
E ::= IE | I/I                       Expression
Each terminal symbol is translated into a corresponding mathml node.*/

var AMnestingDepth,AMpreviousSymbol,AMcurrentSymbol;

function AMTgetTeXsymbol(symb) {
	if (typeof symb.val == "boolean" && symb.val) {
		pre = '';
	} else {
		pre = '\\';
	}
	if (symb.tex==null) {
		//can't remember why this was here.  Breaks /delta /Delta to removed
		//return (pre+(pre==''?symb.input:symb.input.toLowerCase()));
		return (pre+symb.input);
	} else {
		return (pre+symb.tex);
	}
}

function AMTparseSexpr(str) { //parses str and returns [node,tailstr]
  var symbol, node, result, i, st,// rightvert = false,
    newFrag = '';
  str = AMremoveCharsAndBlanks(str,0);
  symbol = AMgetSymbol(str);             //either a token or a bracket or empty
  if (symbol == null || symbol.ttype == RIGHTBRACKET && AMnestingDepth > 0) {
    return [null,str];
  }
  if (symbol.ttype == DEFINITION) {
    str = symbol.output+AMremoveCharsAndBlanks(str,symbol.input.length);
    symbol = AMgetSymbol(str);
  }
  switch (symbol.ttype) {
  case UNDEROVER:
  case CONST:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
     var texsymbol = AMTgetTeXsymbol(symbol);
     if (texsymbol.charAt(0)=="\\" || symbol.tag=="mo") return [texsymbol,str];
     else return ['{'+texsymbol+'}',str];

  case LEFTBRACKET:   //read (expr+)
    AMnestingDepth++;
    str = AMremoveCharsAndBlanks(str,symbol.input.length);

    result = AMTparseExpr(str,true);
    AMnestingDepth--;
    var leftchop = 0;
    if (result[0].substr(0,6)=="\\right") {
    	    st = result[0].charAt(6);
    	    if (st==")" || st=="]" || st=="}") {
    	    	    leftchop = 6;
    	    } else if (st==".") {
    	    	    leftchop = 7;
    	    } else {
    	    	    st = result[0].substr(6,7);
    	    	    if (st=='\\rbrace') {
    	    	    	    leftchop = 13;
    	    	    }
    	    }
    }
    if (leftchop>0) {
	    result[0] = result[0].substr(leftchop);
	    if (typeof symbol.invisible == "boolean" && symbol.invisible)
		    node = '{'+result[0]+'}';
	    else {
		    node = '{'+AMTgetTeXsymbol(symbol) + result[0]+'}';
	    }
    } else {
	    if (typeof symbol.invisible == "boolean" && symbol.invisible)
		    node = '{\\left.'+result[0]+'}';
	    else {
		    node = '{\\left'+AMTgetTeXsymbol(symbol) + result[0]+'}';
	    }
    }
    return [node,result[1]];
  case TEXT:
      if (symbol!=AMquote) str = AMremoveCharsAndBlanks(str,symbol.input.length);
      if (str.charAt(0)=="{") i=str.indexOf("}");
      else if (str.charAt(0)=="(") i=str.indexOf(")");
      else if (str.charAt(0)=="[") i=str.indexOf("]");
      else if (symbol==AMquote) i=str.slice(1).indexOf("\"")+1;
      else i = 0;
      if (i==-1) i = str.length;
      st = str.slice(1,i);
      if (st.charAt(0) == " ") {
	      newFrag = '\\ ';
      }
     newFrag += '\\text{'+st+'}';
      if (st.charAt(st.length-1) == " ") {
	      newFrag += '\\ ';
      }
      str = AMremoveCharsAndBlanks(str,i+1);
      return [newFrag,str];
  case UNARY:
      str = AMremoveCharsAndBlanks(str,symbol.input.length);
      result = AMTparseSexpr(str);
      if (result[0]==null) return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
      if (typeof symbol.func == "boolean" && symbol.func) { // functions hack
        st = str.charAt(0);
        if (st=="^" || st=="_" || st=="/" || st=="|" || st=="," || (symbol.input.length==1 && symbol.input.match(/\w/) && st!="(")) {
          return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
        } else {
		node = '{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}}';
		return [node,result[1]];
        }
      }
      result[0] = AMTremoveBrackets(result[0]);
      if (symbol.input == "sqrt") {           // sqrt
	      return ['\\sqrt{'+result[0]+'}',result[1]];
      } else if (symbol.input == "cancel") {           // cancel
	      return ['\\cancel{'+result[0]+'}',result[1]];
      } else if (typeof symbol.rewriteleftright != "undefined") {  // abs, floor, ceil
	      return ['{\\left'+symbol.rewriteleftright[0]+result[0]+'\\right'+symbol.rewriteleftright[1]+'}',result[1]];
      } else if (typeof symbol.acc == "boolean" && symbol.acc) {   // accent
	      //return ['{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}}',result[1]];
	      return [AMTgetTeXsymbol(symbol)+'{'+result[0]+'}',result[1]];
      } else {                        // font change command
	    return ['{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}}',result[1]];
      }
  case BINARY:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    result = AMTparseSexpr(str);
    if (result[0]==null) return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
    result[0] = AMTremoveBrackets(result[0]);
    var result2 = AMTparseSexpr(result[1]);
    if (result2[0]==null) return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
    result2[0] = AMTremoveBrackets(result2[0]);
    if (symbol.input=="color") {
    	newFrag = '{\\color{'+result[0].replace(/[\{\}]/g,'')+'}'+result2[0]+'}';
    } else  if (symbol.input=="root") {
	    newFrag = '{\\sqrt['+result[0]+']{'+result2[0]+'}}';
    } else {
	    newFrag = '{'+AMTgetTeXsymbol(symbol)+'{'+result[0]+'}{'+result2[0]+'}}';
    }
    return [newFrag,result2[1]];
  case INFIX:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return [symbol.output,str];
  case SPACE:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return ['{\\quad\\text{'+symbol.input+'}\\quad}',str];
  case LEFTRIGHT:
//    if (rightvert) return [null,str]; else rightvert = true;
    AMnestingDepth++;
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    result = AMTparseExpr(str,false);
    AMnestingDepth--;
    var st = "";
    st = result[0].charAt(result[0].length -1);
//alert(result[0].lastChild+"***"+st);
    if (st == "|" && str.charAt(0)!==",") { // its an absolute value subterm
	    node = '{\\left|'+result[0]+'}';
      return [node,result[1]];
    } else { // the "|" is a \mid
      node = '{\\mid}';
      return [node,str];
    }

  default:
//alert("default");
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return ['{'+AMTgetTeXsymbol(symbol)+'}',str];
  }
}

function AMTparseIexpr(str) {
  var symbol, sym1, sym2, node, result;
  str = AMremoveCharsAndBlanks(str,0);
  sym1 = AMgetSymbol(str);
  result = AMTparseSexpr(str);
  node = result[0];
  str = result[1];
  symbol = AMgetSymbol(str);
  if (symbol.ttype == INFIX && symbol.input != "/") {
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
   // if (symbol.input == "/") result = AMTparseIexpr(str); else
    result = AMTparseSexpr(str);
    if (result[0] == null) // show box in place of missing argument
	    result[0] = '{}';
    else result[0] = AMTremoveBrackets(result[0]);
    str = result[1];
//    if (symbol.input == "/") AMTremoveBrackets(node);
    if (symbol.input == "_") {
      sym2 = AMgetSymbol(str);
      if (sym2.input == "^") {
        str = AMremoveCharsAndBlanks(str,sym2.input.length);
        var res2 = AMTparseSexpr(str);
        res2[0] = AMTremoveBrackets(res2[0]);
        str = res2[1];
        node = '{' + node;
       	node += '_{'+result[0]+'}';
	node += '^{'+res2[0]+'}';
        node += '}';
      } else {
        node += '_{'+result[0]+'}';
      }
    } else { //must be ^
      //node = '{'+node+'}^{'+result[0]+'}';
      node = node+'^{'+result[0]+'}';
    }
    if (typeof sym1.func != 'undefined' && sym1.func) {
    	sym2 = AMgetSymbol(str);
    	if (sym2.ttype != INFIX && sym2.ttype != RIGHTBRACKET &&
    	    (sym1.input.length>1 || sym2.ttype == LEFTBRACKET)) {
    		result = AMTparseIexpr(str);
    		node = '{'+node+result[0]+'}';
    		str = result[1];
    	}
    }
  }

  return [node,str];
}

function AMTparseExpr(str,rightbracket) {
  var symbol, node, result, i, nodeList = [],
  newFrag = '';
  var addedright = false;
  do {
    str = AMremoveCharsAndBlanks(str,0);
    result = AMTparseIexpr(str);
    node = result[0];
    str = result[1];
    symbol = AMgetSymbol(str);
    if (symbol.ttype == INFIX && symbol.input == "/") {
      str = AMremoveCharsAndBlanks(str,symbol.input.length);
      result = AMTparseIexpr(str);

      if (result[0] == null) // show box in place of missing argument
	      result[0] = '{}';
      else result[0] = AMTremoveBrackets(result[0]);
      str = result[1];
      node = AMTremoveBrackets(node);
      node = '\\frac' + '{'+ node + '}';
      node += '{'+result[0]+'}';
      newFrag += node;
      symbol = AMgetSymbol(str);
    }  else if (node!=undefined) newFrag += node;
  } while ((symbol.ttype != RIGHTBRACKET &&
           (symbol.ttype != LEFTRIGHT || rightbracket)
           || AMnestingDepth == 0) && symbol!=null && symbol.output!="");
  if (symbol.ttype == RIGHTBRACKET || symbol.ttype == LEFTRIGHT) {
//    if (AMnestingDepth > 0) AMnestingDepth--;
	var len = newFrag.length;
	if (len>2 && newFrag.charAt(0)=='{' && newFrag.indexOf(',')>0) { //could be matrix (total rewrite from .js)
		var right = newFrag.charAt(len - 2);
		if (right==')' || right==']') {
			var left = newFrag.charAt(6);
			if ((left=='(' && right==')' && symbol.output != '}') || (left=='[' && right==']')) {
				var mxout = '';
				var pos = new Array(); //position of commas
				pos.push(0);
				var matrix = true;
				var mxnestingd = 0;
				var subpos = [];
				subpos[0] = [0];
				var lastsubposstart = 0;
				var mxanynestingd = 0;
				var columnaligns = '';
				for (i=1; i<len-1; i++) {
					if (newFrag.charAt(i)==left) mxnestingd++;
					if (newFrag.charAt(i)==right) {
						mxnestingd--;
						if (mxnestingd==0 && newFrag.charAt(i+2)==',' && newFrag.charAt(i+3)=='{') {
							pos.push(i+2);
							lastsubposstart = i+2;
							subpos[lastsubposstart] = [i+2];
						}
					}
					if (newFrag.charAt(i)=='[' || newFrag.charAt(i)=='(' || newFrag.charAt(i)=='{') { mxanynestingd++;}
					if (newFrag.charAt(i)==']' || newFrag.charAt(i)==')' || newFrag.charAt(i)=='}') { mxanynestingd--;}
					if (newFrag.charAt(i)==',' && mxanynestingd==1) {
						subpos[lastsubposstart].push(i);
					}
					if (mxanynestingd<0) {  //happens at the end of the row
						if (lastsubposstart == i+1) { //if at end of row, skip to next row
							i++;
						} else { //misformed something - abandon treating as a matrix
							matrix = false;
						}
					}
				}

				pos.push(len);
				var lastmxsubcnt = -1;
				if (mxnestingd==0 && pos.length>0 && matrix) {
					for (i=0;i<pos.length-1;i++) {
						if (i>0) mxout += '\\\\';
						if (i==0) {
							//var subarr = newFrag.substr(pos[i]+7,pos[i+1]-pos[i]-15).split(',');
							if (subpos[pos[i]].length==1) {
								var subarr = [newFrag.substr(pos[i]+7,pos[i+1]-pos[i]-15)];
							} else {
								var subarr = [newFrag.substring(pos[i]+7,subpos[pos[i]][1])];
								for (var j=2;j<subpos[pos[i]].length;j++) {
									subarr.push(newFrag.substring(subpos[pos[i]][j-1]+1,subpos[pos[i]][j]));
								}
								subarr.push(newFrag.substring(subpos[pos[i]][subpos[pos[i]].length-1]+1,pos[i+1]-8));
							}
						} else {
							//var subarr = newFrag.substr(pos[i]+8,pos[i+1]-pos[i]-16).split(',');
							if (subpos[pos[i]].length==1) {
								var subarr = [newFrag.substr(pos[i]+8,pos[i+1]-pos[i]-16)];
							} else {
								var subarr = [newFrag.substring(pos[i]+8,subpos[pos[i]][1])];
								for (var j=2;j<subpos[pos[i]].length;j++) {
									subarr.push(newFrag.substring(subpos[pos[i]][j-1]+1,subpos[pos[i]][j]));
								}
								subarr.push(newFrag.substring(subpos[pos[i]][subpos[pos[i]].length-1]+1,pos[i+1]-8));
							}
						}
						for (j=subarr.length-1;j>=0;j--) {
							if (subarr[j]=="{\\mid}") {
								if (i==0) {
									columnaligns = "|"+columnaligns;
								}
								subarr.splice(j,1);
							} else if (i==0) {
								columnaligns = "c"+columnaligns;
							}
						}
						if (lastmxsubcnt>0 && subarr.length!=lastmxsubcnt) {
							matrix = false;
						} else if (lastmxsubcnt==-1) {
							lastmxsubcnt=subarr.length;
						}
						mxout += subarr.join('&');
					}
				}
				mxout = "\\begin{array}{"+columnaligns+"} "+mxout+"\\end{array}";

				if (matrix) { newFrag = mxout;}
			}
		}
	}

    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    if (typeof symbol.invisible != "boolean" || !symbol.invisible) {
      node = '\\right'+AMTgetTeXsymbol(symbol); //AMcreateMmlNode("mo",document.createTextNode(symbol.output));
      newFrag += node;
      addedright = true;
    } else {
	    newFrag += '\\right.';
	    addedright = true;
    }

  }
  if(AMnestingDepth>0 && !addedright) {
	  newFrag += '\\right.'; //adjust for non-matching left brackets
	  //todo: adjust for non-matching right brackets
  }

  return [newFrag,str];
}

function AMTparseAMtoTeX(str) {
 AMnestingDepth = 0;
  str = str.replace(/(&nbsp;|\u00a0|&#160;)/g,"");
  str = str.replace(/&gt;/g,">");
  str = str.replace(/&lt;/g,"<");
  if (str.match(/\S/)==null) {
	  return "";
  }
  return AMTparseExpr(str.replace(/^\s+/g,""),false)[0];
}

function AMparseMath(str) {
 //DLMOD to remove &nbsp;, which editor adds on multiple spaces
  str = str.replace(/(&nbsp;|\u00a0|&#160;)/g,"");
  str = str.replace(/&gt;/g,">");
  str = str.replace(/&lt;/g,"<");
  if (str.match(/\S/)==null) {
	  return document.createTextNode(" ");
  }
  var texstring = AMTparseAMtoTeX(str);

  if (typeof mathbg != "undefined" && mathbg=='dark') {
	  texstring = "\\reverse " + texstring;
  }
  if (config.mathcolor!="") {
	  texstring = "\\"+config.mathcolor + texstring;
  }
  if (config.displaystyle) {
	  texstring = "\\displaystyle" + texstring;
  } else {
	  texstring = "\\textstyle" + texstring;
  }
  texstring = texstring.replace(/\$/g,'\\$');

  var node = document.createElement("img");
  if (typeof encodeURIComponent == "function") {
	  texstring = encodeURIComponent(texstring);
  } else {
	  texstring = escape(texstring);
  }
  node.src = AMTcgiloc + '?' + texstring;
  node.style.verticalAlign = "middle";
  if (config.showasciiformulaonhover)                      //fixed by djhsu so newline
    node.setAttribute("title",str.replace(/\s+/g," "));//does not show in Gecko

  var snode = document.createElement("span");
  snode.appendChild(node); //chg
  return snode;
}
//alias to align with wFallback function
function AMTparseMath(str) {
	return AMparseMath(str);
}

function AMstrarr2docFrag(arr, linebreaks) {
  var newFrag=document.createDocumentFragment();
  var expr = false;
  for (var i=0; i<arr.length; i++) {
    if (expr) newFrag.appendChild(AMparseMath(arr[i]));
    else {
      var arri = (linebreaks ? arr[i].split("\n\n") : [arr[i]]);
      newFrag.appendChild(document.createElement("span").
      appendChild(document.createTextNode(arri[0])));
      for (var j=1; j<arri.length; j++) {
        newFrag.appendChild(document.createElement("p"));
        newFrag.appendChild(document.createElement("span").
        appendChild(document.createTextNode(arri[j])));
      }
    }
    expr = !expr;
  }
  return newFrag;
}

function AMprocessNodeR(n, linebreaks) {
  var mtch, str, arr, frg, i;
  if (n.childNodes.length == 0) {
   if ((n.nodeType!=8 || linebreaks) &&
    n.parentNode.nodeName!="form" && n.parentNode.nodeName!="FORM" &&
    n.parentNode.nodeName!="textarea" && n.parentNode.nodeName!="TEXTAREA" &&
    n.parentNode.nodeName!="pre" && n.parentNode.nodeName!="PRE") {
    str = n.nodeValue;
    if (!(str == null)) {
      str = str.replace(/\r\n\r\n/g,"\n\n");
      if (config.doubleblankmathdelimiter) {
        str = str.replace(/\x20\x20\./g," "+config.AMdelimiter1+".");
        str = str.replace(/\x20\x20,/g," "+config.AMdelimiter1+",");
        str = str.replace(/\x20\x20/g," "+config.AMdelimiter1+" ");
      }
      str = str.replace(/\x20+/g," ");
      str = str.replace(/\s*\r\n/g," ");
       mtch = false;
      if (config.AMusedelimiter2) {
      str = str.replace(new RegExp(config.AMescape2, "g"),
              function(st){mtch=true;return "AMescape2"});
      }
      str = str.replace(new RegExp(config.AMescape1, "g"),
              function(st){mtch=true;return "AMescape1"});
     if (config.AMusedelimiter2)  str = str.replace(new RegExp(config.AMdelimiter2regexp, "g"),config.AMdelimiter1);
      arr = str.split(config.AMdelimiter1);
      for (i=0; i<arr.length; i++)
      	if (config.AMusedelimiter2) {
		arr[i]=arr[i].replace(/AMescape2/g,config.AMdelimiter2).replace(/AMescape1/g,config.AMdelimiter1);
	} else {
		arr[i]=arr[i].replace(/AMescape1/g,config.AMdelimiter1);
	}
      if (arr.length>1 || mtch) {

      frg = AMstrarr2docFrag(arr,n.nodeType==8);
      var len = frg.childNodes.length;
      n.parentNode.replaceChild(frg,n);
      return len-1;

      }
    }
   } else return 0;
  } else if (n.nodeName!="math") { //should this change to img?
    for (i=0; i<n.childNodes.length; i++)
      i += AMprocessNodeR(n.childNodes[i], linebreaks);
  }
  return 0;
}

function AMprocessNode(n, linebreaks, spanclassAM) {
  var frag,st;
  if (spanclassAM!=null) {
    frag = document.getElementsByTagName("span");
    for (var i=0;i<frag.length;i++)
      if (frag[i].className == "AM")
        AMprocessNodeR(frag[i],linebreaks);
  } else {
    try {
      st = n.innerHTML;
    } catch(err) {}
    if (st==null ||
        st.indexOf(config.AMdelimiter1)!=-1)// || st.indexOf(config.AMdelimiter2)!=-1)
      AMprocessNodeR(n,linebreaks);
  }
}

function translate(spanclassAM) {
  if (!AMtranslated) { // run this only once
    AMtranslated = true;
    var body = document.getElementsByTagName("body")[0];
    var processN = document.getElementById(config.AMdocumentId);
    AMprocessNode((processN!=null?processN:body), false, spanclassAM);
  }
}

var AMbody;
var AMtranslated = false;
var AMnoMathML = true;

AMinitSymbols();

window.AMTparseAMtoTeX = AMTparseAMtoTeX;

function generic(){
  if (config.translateOnLoad) {
      translate();
  }
}

//setup onload function
if(typeof window.addEventListener != 'undefined'){
  //.. gecko, safari, konqueror and standard
  window.addEventListener('load', generic, false);
}
else if(typeof document.addEventListener != 'undefined'){
  //.. opera 7
  document.addEventListener('load', generic, false);
}
else if(typeof window.attachEvent != 'undefined'){
  //.. win/ie
  window.attachEvent('onload', generic);
}else{
  //.. mac/ie5 and anything else that gets this far
  //if there's an existing onload function
  if(typeof window.onload == 'function'){
    //store it
    var existing = onload;
    //add new onload handler
    window.onload = function(){
      //call existing onload function
      existing();
      //call generic onload function
      generic();
    };
  }else{
    window.onload = generic;
  }
}
})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor_latexmath', location = 'xslt/xslt.js' */
/*! xslt v0.9.1+master.0.67dff610fd9b | (c) 2017 Justin Murray | built on 2017-08-09 */

(function(){var e=[].slice,n=[].indexOf||function(e){for(var n=0,r=this.length;n<r;n++)if(n in this&&this[n]===e)return n;return-1};!function(e,n){"function"==typeof define&&null!=define.amd?define([],function(){return n(e)}):"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=n(e):null!=e&&(e.xslt=n(e))}(this,function(r){var t,l,o,u,i,a,c,s,m,d,f,p,v,x,g,M,D,h,y,N,E,O,X,L,S,T,w,z,b,F,H,P,A;return S={xmlNode:function(){return/<([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*(\/?)>/i},xmlLike:function(){return/^\s*</},xmlHeader:function(){return/^\s*<\?xml\b[^<]+/i},namespaces:function(){return/\bxmlns(?::([a-z0-9:\-]+))?\s*=\s*"([^"]*)"/gi}},y=function(e){return S.xmlLike().test(e)},h=function(e){return S.xmlHeader().test(e)},O=function(e){return y(e)&&!h(e)},A=function(e,n){var r;return r='<?xml version="1.0" ',null!=e&&(r+='encoding="'+e+'" '),null!=n&&(r+='standalone="'+n+'" '),r+="?>"},L=function(e,n,r){return A(n,r)+e},b=function(e){return null!=e?e.replace(S.xmlHeader(),""):void 0},g=function(e){var n,r;return(null!=(n=null!=e?e.match(S.xmlHeader()):void 0)?n.length:void 0)&&(null!=(r=n[0])&&"function"==typeof r.trim?r.trim():void 0)||null},v=function(e,n){var r;return(null!=(r=new RegExp("\\b"+n+'\\s*=\\s*"([^"]*)"',"g").exec(e))?r.length:void 0)>1&&r[1]||null},M=function(e){return v(g(e),"encoding")},D=function(e){return v(g(e),"standalone")},l="undefined"!=typeof ActiveXObject&&null!==ActiveXObject||"ActiveXObject"in r,P=function(){var n,r,t,o;if(o=1<=arguments.length?e.call(arguments,0):[],!l)return null;for(n=0,t=o.length;n<t;n++){r=o[n];try{return new ActiveXObject(r)}catch(e){}}return null},c=function(){var e;if(null!=(e=P.apply(null,["Msxml2.FreeThreadedDOMDocument.6.0","Msxml2.FreeThreadedDOMDocument.3.0","Msxml2.FreeThreadedDOMDocument","Microsoft.XMLDOM","Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument"])))for(e.async=!1;4!==e.readyState;);return e},s=function(){return P.apply(null,["Msxml2.XSLTemplate.6.0","Msxml2.XSLTemplate"])},E=function(){var e,n;return n=document.createElement("xml"),n.src=A(),document.body.appendChild(n),e=n.XMLDocument,document.body.removeChild(n),e},X=function(){var e,n;return null==(e=null)&&(e=c()),"undefined"!=typeof DOMParser&&null!==DOMParser?e:(null==e&&(e=E()),null==e&&(e=null!=(n=document.implementation)&&"function"==typeof n.createDocument?n.createDocument("","test",null):void 0),e)},T=function(e){var n,r,t,l,o;if("string"!=typeof e||!y(e))return null;if(O(e)&&(e=L(e)),null!=(n=X())&&"loadXML"in n){if(n.loadXML(e),null==n.documentElement||0!==(null!=(r=n.parseError)?r.errorCode:void 0))throw new Error("loadXML error: "+n.parseError)}else if(null!=n&&"load"in n)n.load(e);else if("undefined"!=typeof DOMParser&&null!==DOMParser&&((null!=(n=null!=(t=new DOMParser)&&"function"==typeof t.parseFromString?t.parseFromString(e,"text/xml"):void 0)&&"function"==typeof n.getElementsByTagName&&null!=(l=n.getElementsByTagName("parsererror"))?l.length:void 0)>0||"parsererror"===(null!=n&&null!=(o=n.documentElement)?o.nodeName:void 0)))throw new Error("Failed to load document from string:\r\n"+n.documentElement.textContent);return n},d=function(e){var n,r;return null==e?null:((null!=(r="string"==typeof e?e:null!=(null!=e?e.xml:void 0)?e.xml:"undefined"!=typeof XMLSerializer&&null!==XMLSerializer?null!=(n=new XMLSerializer)&&"function"==typeof n.serializeToString?n.serializeToString(e):void 0:null)&&"function"==typeof r.indexOf?r.indexOf("<transformiix::result"):void 0)>=0&&(r=r.substring(r.indexOf(">")+1,r.lastIndexOf("<"))),r)},x=function(e,n){var r,t,l,o,u,i,a,c;for(r=/\s([a-z0-9:\-]+)\s*=\s*("([^"]*)"|'([^']*)')/gi,t={};a=r.exec(e);)a[0],u=a[1],i=a[2],l=a[3],o=a[4],c={outer:i,inner:l||o},("function"==typeof n?n(u,c):void 0)||(t[u]=c);return t},o=function(e,n,r){var t,l;null==n&&(n={}),null==r&&(r=""),t="<"+e;for(l in n)t+=" "+l+"="+n[l].outer;return t+=r+">"},u=function(e,r,t,l){var u,i,a,c,s,m,d;i=x(e,function(e,r){var t;return/^xmlns/.test(e)&&(t=r.inner,n.call(l.excludedNamespaceUris,t)>=0)}),s=l.includeNamespaces;for(c in s)m=s[c],n.call(function(){var e;e=[];for(a in i)d=i[a],e.push(d.inner);return e}(),m)<0&&(u="xmlns",c.length&&(u+=":"+c),i[u]={outer:'"'+m+'"',inner:m});return o(r,i,t)},z=function(e,r,t,l){var u;return null==l&&(l=[]),u=x(e,function(e,r){var t;return t=r.inner,n.call(l,t)>=0}),o(r,u,t)},H=function(e){return e.replace(/xmlns\s*=\s*""/gi,"")},w=function(e){return e.replace(S.namespaces(),"")},F=function(e){var n,r,t,l;for(l=[],e=e.replace(/xmlns:NS([0-9]+)=""/gi,function(e,n){return l.push(n),""}),n=0,r=l.length;n<r;n++)t=l[n],e=e.replace(new RegExp("NS"+t+":xmlns:","g"),"xmlns:");return e},p=function(e,r){var t;return null==r&&(r=[]),t={},e=null!=e?e.replace(S.namespaces(),function(e,l,o){return null==l&&(l=""),null!=t[l]&&t[l]!==o?e:n.call(r,o)>=0?"":(t[l]=o,"")}):void 0,{xml:e,ns:t}},i=function(e,n){var r,t;return t=[],r=!0,null!=e?e.replace(new RegExp(S.xmlNode().source,"gi"),function(e,l,o){var i,a,c,s,m,d,f;if(n.removeNamespacedNamespace&&(e=F(e)),n.removeNullNamespace&&(e=H(e)),n.removeAllNamespaces&&(e=w(e)),r)for(r=!1,e=u(e,l,o,n),m=x(e,function(e){return!/^xmlns/.test(e)}),t=function(){var e;e=[];for(c in m)f=m[c],e.push(f.inner);return e}(),i=0,a=(s=n.excludedNamespaceUris).length;i<a;i++)d=s[i],t.push(d);else(n.removeDupAttrs||n.removeDupNamespace)&&(e=z(e,l,o,t));return e}):void 0},a=function(e){return null!=e?e.replace(/<(([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*)><\/\2>/gi,function(e,n){return"<"+n+"/>"}):void 0},f=function(e){return null!=e?e.replace(/<(([a-z_][a-z_0-9:\.\-]*\b)\s*(?:\/(?!>)|[^>\/])*)\/>/gi,function(e,n,r){return"<"+n+"></"+r+">"}):void 0},m={fullDocument:!1,cleanup:!0,xmlHeaderInOutput:!0,normalizeHeader:!0,encoding:"UTF-8",preserveEncoding:!1,collapseEmptyElements:!0,expandCollapsedElements:!1,removeDupNamespace:!0,removeDupAttrs:!0,removeNullNamespace:!0,removeAllNamespaces:!1,removeNamespacedNamespace:!0,includeNamespaces:{},excludedNamespaceUris:[],moveNamespacesToRoot:!1},N=function(e){var n,r;n={};for(r in m)n[r]=m[r];if(null!=e)for(r in e)n[r]=e[r];return n},t=function(e,n,r){var o,u,i,a,c,m,f,p,v;if(o=N(r),null==(m=T(e)))throw new Error("Failed to load the XML document");if(null==(v=T(n)))throw new Error("Failed to load the XSLT document");return"undefined"!=typeof XSLTProcessor&&null!==XSLTProcessor&&null!=("undefined"!=typeof document&&null!==document&&null!=(a=document.implementation)?a.createDocument:void 0)?((i=new XSLTProcessor).importStylesheet(v),c=o.fullDocument?i.transformToDocument(m):i.transformToFragment(m,document)):"transformNode"in m?c=m.transformNode(v):l&&((p=s()).stylesheet=v,(f=p.createProcessor()).input=m,f.transform(),c=f.output),u=d(c),o.preserveEncoding&&(o.encoding=M(u)||M(e)||o.encoding),o.cleanup&&(u=t.cleanup(u,o)),u},t.cleanup=function(e,n){var r,t,l,o,u,c,s;if((l=N(n)).cleanup){if(l.preserveEncoding&&(l.encoding=M(e)||l.encoding),c=D(e),!l.normalizeHeader&&l.xmlHeaderInOutput||(e=b(e)),l.xmlHeaderInOutput&&O(e)&&(e=L(e,l.encoding,c)),l.moveNamespacesToRoot){t=(o=p(e,l.excludedNamespaceUris)).ns,e=o.xml,u=l.includeNamespaces;for(r in u)s=u[r],t[r]=s;l.includeNamespaces=t}return e=i(e,l),l.collapseEmptyElements&&!l.expandCollapsedElements&&(e=a(e)),l.expandCollapsedElements&&!l.collapseEmptyElements&&(e=f(e)),e}},t})}).call(this);
//# sourceMappingURL=xslt.min.js.map
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor-feat-disc', location = 'js/editor-feat-disc.js' */
/*********************************************************
 * Feature discovery for editor shortcuts
 */
(function($) {
    AJS.bind("init.rte", function() {
        var featDiscId = 'latexmath-neweditorcommands';
        if (!latexmathHelpers.readCookie(featDiscId)) {
            $.ajax({
                url: AJS.params.baseUrl + "/rest/feature-discovery/latest/com.tensixtwo.conf.latexmath/editor-commands",
                dataType: "json"
            }).done(function (data) {
                if (data.isNew && $('#' + featDiscId).size() === 0) {
                    $.ajax({
                        url: AJS.params.baseUrl+"/rest/latexmath/latest/featdisc",
                        data: {userKey: AJS.params.remoteUserKey},
                        dataType: "json"
                    }).then(function(featdisc) {
                       if (featdisc.enabled) {
                           var disableText = '';
                           if (featdisc.userCanDisable) {
                               var adminLink = AJS.params.baseUrl + '/admin/plugins/latexmath/viewconfig.action'+'#featDisc';
                               disableText = ' '+AJS.format("\u003ca href=\u0022{0}\u0022\u003eHide this message for all users\u003c/a\u003e", adminLink);
                           }

                           AJS.messages.generic("#editor-precursor", {
                               id: featDiscId,
                               body: "Inserting LaTeX Math macros is now even easier. Try adding macros by using the following commands: $x$, $$ x $$, \u005C( x \u005C), \u005C[ x \u005C]." + disableText
                           });
                        }
                    });
                }
            });
            $(document).on('messageClose', function (e) {
                if (e.target.id === featDiscId) {
                    latexmathHelpers.createCookie(featDiscId, "read", 30)
                }
            });
        }
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:editor-commands', location = 'js/editor-handlers.js' */
(function($) {
    var autoformatHandlers = [
        {macro: 'mathinline', regex: /(?:[\s\xA0\u200b\uFEFF]+|^)(\$(?=[^\s$])([^$]*?[^\s]))$/, endChar: '$'},
        {macro: 'mathinline', regex: /(\\$)/, endChar: '('},
        {macro: 'mathblock', regex: /(\$\$(?=[^$])([^$]*?)\$)$/, endChar: '$'},
        {macro: 'mathblock', regex: /(\\$)/, endChar: '['}
    ];

    var pasteHandlers = [
        {macro: 'mathinline', regex: /^\$([^$]+)\$$/},
        {macro: 'mathinline', regex: /^\\\(([^$]+)\\\)$/},
        {macro: 'mathblock', regex: /^\$\$(?=[^$])(.+)\$\$$/},
        {macro: 'mathblock', regex: /^\\\[(.+)\\]$/}
    ];

    function makeMacro(macroName, body) {
        body = body && body.trim() || '';
        var params = {};
        if (macroName.indexOf('block') === -1) {
            if (body) {
                params['body'] = body;
            }
            body = null;
        }

        return {
            contentId: AJS.Meta.get('content-id') || "0",
            macro : {
                name : macroName,
                params : params,
                defaultParameterValue : null,
                body : body
            }
        };
    }

    function isInPlainTextMacro(element) {
        return $(element).closest("[data-macro-body-type='PLAIN_TEXT']").length;
    }

    function insertMacro(macro, body) {
        AJS.Rte.BookmarkManager.storeBookmark();
        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, body))
            .done(function (node) {
                if (!body && node.tagName.toLowerCase() === 'img') {
                    // If we are creating an empty inline macro, then select it so it is ready for user input
                    $(node).click();
                    $('#property-panel').each(function () {
                        $(this).find('a.mathinline-macro-body').click();
                        $(this).find('input.mathinline-macro-body').focus();
                    });
                }
            });
    }

    AJS.bind("confluence.editor.registerHandlers", function(e, data) {
        var handlerManager = data.handlerManager;
        var createHandler = data.createHandler;
        var editor = data.ed;

        autoformatHandlers.forEach(function(h) {
            handlerManager.registerHandler(h.endChar.charCodeAt(0), createHandler(h.regex, function (matchGroups) {
                insertMacro(h.macro, matchGroups[2]);
            }, true, 'span#autocomplete')); // Don't do this in autocomplete mode
        });

        $(document).bind('prePaste', function () {
            if (editor.removed) return;
            editor.undoManager.add();
        });

        $(document).bind('postPaste', function (e, pl, o) {
            if (editor.removed) return;

            if (!editor.selection || !isInPlainTextMacro(editor.selection.getStart())) {
                var text = o.node.textContent.trim();
                var match, macro;
                pasteHandlers.forEach(function (h) {
                    if (!match) {
                        match = h.regex.exec(text);
                        macro = h.macro;
                    }
                });

                if (match && match.length && match[1]) {
                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();
                        tinymce.confluence.MacroUtils.insertMacro(makeMacro(macro, match[1])).done(function () {
                            editor.undoManager.add();
                        });
                    }, 1);
                }
            }
        });

        editor.onPaste.add(function (editor, e) {
            if (isInPlainTextMacro(editor.selection.getStart()) && isInPlainTextMacro(editor.selection.getEnd())) {
                var content = ((e.originalEvent || e).clipboardData || window.clipboardData).getData('Text');
                var latex = window.LatexMathTryConvert(content);
                if (latex !== null) {
                    e.preventDefault();

                    setTimeout(function () {
                        editor.undoManager.undo();
                        AJS.Rte.BookmarkManager.storeBookmark();

                        editor.selection.setContent(latex);
                        // editor.execCommand('mceInsertContent', false, latex);
                        e.preventDefault();

                        editor.undoManager.add();
                    }, 1);
                }
            }
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tensixtwo.conf.latexmath:latex-visibility-resourse', location = 'js/editor-hide-latex-macro.js' */
(function($) {
    AJS.bind("init.rte", function() {
        $( document ).ready(function() {
            $.ajax({
                url: AJS.params.baseUrl+"/rest/latexmath/latest/showlatexmacro",
                dataType: "json"
            }).done(function (data) {
                $("body").toggleClass("showLatexFalse", !data.enabled);
            });          
        });
    });
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'biz.artemissoftware.confluence.multiexcerpt.MultiExcerptMacro:editor_multi-includemacro', location = 'js/multi-include-macro.js' */
(function (AJS) {

    function parseAuiVersion() { // parseAuiVersion().major should return 9 if AJS.version returns "9.2.0"
        var defaultMajor = {major: 9};

        if (AJS.version == null || typeof AJS.version === undefined) {
            console.error("Problem with AJS.version. Defaulting to AJS major version 9.");
            return defaultMajor;
        }

        var parsed = AJS.version.match(/^(\d+)[.](\d+)[.](\d+)/);

        if (parsed == null || typeof parsed === undefined) {
            console.error("Problem parsing AJS.version. Defaulting to AJS major version 9.");
            return defaultMajor;
        }
        //we're double checking parsed length in case of unexpected AJS.version value
        var major, minor, bugfix;
        if (parsed.length > 1) {
            major = parsed[1]*1;
        }
        if (parsed.length > 2) {
            minor = parsed[2]*1;
        }
        if (parsed.length > 3) {
            bugfix = parsed[3]*1;
        }
        return {
            major: major,
            minor: minor,
            bugfix: bugfix
        };
    }

    AJS.bind("init.rte", function () {
        var baseUrl = AJS.Meta.get("context-path"),
            contentId = AJS.Meta.get("content-id"),
            endpoint = "plugins/servlet/confluence/include-page-macro/goto",
            mep_openIncludedPage = function (macroNode, targetPage) {
                var $macroNode = AJS.$(macroNode),
                    location = encodeURIComponent(targetPage),
    //                location = $macroNode.attr("data-macro-default-parameter"),
                    url = baseUrl + "/" + endpoint + "?location=" + location + "&contentId=" + contentId,
                    windowName = (AJS.$.browser && AJS.$.browser.msie) ? "_blank" : "confluence-goto-link-include-macro-" + macroNode.id,
                    win = window.open(url, windowName);

                if (win) win.focus();
            };

        // Go to Included Page button (on a ME-Include)
        AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("mep-goto-page", function (e, macroNode) {
            // These are all the macro parameters.
            var targetPageME = 'meh';
            var rawParams = AJS.$(macroNode).attr("data-macro-parameters").split("|");
            AJS.$.each(rawParams, function (index, param) {
                var splitIndex = param.indexOf("=");
                if (splitIndex > 0) {
                    var key = param.substring(0, splitIndex);
                    var value = param.substring(splitIndex + 1);
                    if (key.indexOf("PageWithExcerpt") !== -1) {
                        targetPageME = value;
                    }
                    console.log(key + " = " + value);
                }
            });

            // Here's the macro body:
            var body = AJS.$("td.wysiwyg-macro-body", macroNode);
            console.log("body: " + body.html());
            mep_openIncludedPage(macroNode, targetPageME);
        });

      // "Find Includes" button (on a ME)
      AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("mep-find-includes", function (e, macroNode) {
        processFindIncludesAndRenderResults(e, macroNode);
      });
      var thisSpaceKey = AJS.Meta.get("space-key");
      AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("mep-find-includes-this-space", function (e, macroNode) {
        processFindIncludesAndRenderResults(e, macroNode,
          [thisSpaceKey]);  // array of space keys to search.  Search only "this" space.
      });

      AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("mep-find-includes-selected-space", function (e, macroNode) {
        renderFindIncludesSpaceSelector(thisSpaceKey, macroNode)
      });

      function renderFindIncludesSpaceSelector(thisSpaceKey, macroNode) {
        AJS.$('#includes-space-input-dialog').remove();

        AJS.$('body').append(Multiexcerpt.Templates.Dialogs.includesSpaceSelectorDialog({  // see soy template
          dialogContentId: 'includes-space-input-dialog-content',
          auiVersion: parseAuiVersion().major
        }));

        // We must bind Confluence's autocomplete event handler to the autocomplete space input because we
        // are adding the input to the page after the page has been rendered.
        // See https://community.atlassian.com/t5/Confluence-questions/Confluence-Javascript-Autocomplete-input-field-not-working/qaq-p/1631462
        AJS.Confluence.Binder.autocompleteSpace();

        AJS.$('#includes-space-input-form').on('submit', function (event) {
          var spaceKeyToSearch = AJS.$('#includes-space-input').val();
          AJS.dialog2('#includes-space-input-dialog').hide();
          if (spaceKeyToSearch) {
            processFindIncludesAndRenderResults(event, macroNode, [spaceKeyToSearch]);
          } else {
            console.error('missing value for space key, cannot find includes');
          }

          // we don't want the form to make an HTTP request.
          return false;
        });

        AJS.dialog2('#includes-space-input-dialog').show();
      }

      function processFindIncludesAndRenderResults(e, macroNode, spaceKeysToSearch) {
        AJS.$('#includes-dialog').remove();
        var rawParams = AJS.$(macroNode).attr("data-macro-parameters").split("|");
        var excerptName = '';
        AJS.$.each(rawParams, function (index, param) {
          var splitIndex = param.indexOf("=");
          if (splitIndex > 0) {
            var key = param.substring(0, splitIndex);
            var value = param.substring(splitIndex + 1);
            if (key.indexOf("MultiExcerptName") !== -1 || key.indexOf("name") !== -1) {
              excerptName = value;
            }
          }
        });

        var dialogContentId = "pages-content-id";
        AJS.$('body').append(Multiexcerpt.Templates.Dialogs.includesDialog({
          pages: {},
          dialogContentId: dialogContentId,
          auiVersion: parseAuiVersion().major
        }));
        var dialogContent = AJS.$('#' + dialogContentId);

        dialogContent.append(
            '<aui-spinner id="find-includes-spinner" size="large" filled></aui-spinner>');

        AJS.dialog2('#includes-dialog').show();
        var xhr = AJS.$.ajax({
          url: AJS.contextPath() + "/rest/multiexcerpt/1.0/findincludes",
          data: {
            excerptName: excerptName,
            contentId: AJS.Confluence.getContentId(),
            spaceKeysToSearch: spaceKeysToSearch  // array of space keys for spaces that will be searched
          },
          success: function (data) {
            $('#find-includes-spinner').remove();
            xhr = null;

            if (spaceKeysToSearch) {
              for (const spaceKeyToSearch of spaceKeysToSearch) {
                dialogContent.append('<div>Searched space with key: ' + spaceKeyToSearch + '</div>');
              }
            }

            if (data.length) {
              var pages = Multiexcerpt.Templates.Dialogs.pages({
                pages: data
              });
              dialogContent.append(pages);
            } else {
              dialogContent.append('<div id="no-pages-message"><br/>'
                  + "There are no pages with this MultiExcerpt"
                  + '</div>');
            }
          },
          error: function (err) {

            // This .remove() call for the spinner was added long after the first implementation.
            // Prior to this, any error in the REST call for 'Find Includes' resulted in the dialog
            // sitting forever with a spinner spinning.
            $('#find-includes-spinner').remove();
            xhr = null;
            console.error("Failure in 'Find Includes': " + JSON.stringify(err));
            if (err && err.status === 503) {  // HTTP 503 SERVICE UNAVAILABLE (we do this when it is too busy)
              dialogContent.append('<div>The "Find Includes" service is busy.  Try again later.</div>');
            } else if (err && err.status) {
              dialogContent.append('<div>The "Find Includes" service failed with HTTP error code ' + err.status + '</div>');
            } else {
              dialogContent.append('<div>The "Find Includes" service failed.</div>')
            }
          }
        });
        // stop pending xhr request
        AJS.dialog2('#includes-dialog').on("hide", function() {
          if (xhr) {
            xhr.abort();
          }
        });
      }  // end function processFindIncludesAndRenderResults

    });
}) (AJS);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'biz.artemissoftware.confluence.multiexcerpt.MultiExcerptMacro:editor_multi-includemacro', location = '/soy/templates-multiexcerpt.soy' */
// This file was automatically generated from templates-multiexcerpt.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Multiexcerpt.Templates.Dialogs.
 */

if (typeof Multiexcerpt == 'undefined') { var Multiexcerpt = {}; }
if (typeof Multiexcerpt.Templates == 'undefined') { Multiexcerpt.Templates = {}; }
if (typeof Multiexcerpt.Templates.Dialogs == 'undefined') { Multiexcerpt.Templates.Dialogs = {}; }


Multiexcerpt.Templates.Dialogs.includesSpaceSelectorDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="includes-space-input-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" hidden persistent><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Select Space Key to Search') + '</h2>' + ((opt_data.auiVersion < 9) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>' : '<button type="button" class="aui-close-button" aria-label="' + soy.$$escapeHtml('Close') + '"></button>') + '</header><div class="aui-dialog2-content" ' + ((opt_data.dialogContentId != null) ? 'id=' + soy.$$escapeHtml(opt_data.dialogContentId) : '') + '><form name="includesSpaceForm" id="includes-space-input-form"><input id="includes-space-input" class="autocomplete-space" data-max="10" data-none-message="No results" data-template="{key}"/><label for="includes-space-input">' + soy.$$escapeHtml('Enter space NAME to search spaces.  When a space is selected the space KEY is set as the value.') + '</label><br/><div class="multiexcerpt-dialog-submit-button"><input name="Submit" id="includes-space-submit-button" type="submit" value="' + soy.$$escapeHtml('Submit') + '"/></div></form></div></section>';
};
if (goog.DEBUG) {
  Multiexcerpt.Templates.Dialogs.includesSpaceSelectorDialog.soyTemplateName = 'Multiexcerpt.Templates.Dialogs.includesSpaceSelectorDialog';
}


Multiexcerpt.Templates.Dialogs.includesDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="includes-dialog" class="aui-layer aui-dialog2 aui-dialog2-medium" hidden persistent><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Pages with Includes') + '</h2>' + ((opt_data.auiVersion < 9) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>' : '<button type="button" class="aui-close-button" aria-label="' + soy.$$escapeHtml('Close') + '"></button>') + '</header><div class="aui-dialog2-content" ' + ((opt_data.dialogContentId != null) ? 'id=' + soy.$$escapeHtml(opt_data.dialogContentId) : '') + '>' + Multiexcerpt.Templates.Dialogs.pages(opt_data) + '</div></section>';
};
if (goog.DEBUG) {
  Multiexcerpt.Templates.Dialogs.includesDialog.soyTemplateName = 'Multiexcerpt.Templates.Dialogs.includesDialog';
}


Multiexcerpt.Templates.Dialogs.pages = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.pages.length > 0) {
    output += '<ul>';
    var pageList51 = opt_data.pages;
    var pageListLen51 = pageList51.length;
    for (var pageIndex51 = 0; pageIndex51 < pageListLen51; pageIndex51++) {
      var pageData51 = pageList51[pageIndex51];
      output += '<li style="list-style: none;">' + ((pageData51.errMsg) ? soy.$$escapeHtml(pageData51.errMsg) : '<a href="' + soy.$$escapeHtml("" + '/pages/viewpage.action?pageId=' + pageData51.contentId) + '">' + soy.$$escapeHtml(pageData51.spaceKey) + ': ' + soy.$$escapeHtml(pageData51.pageTitle) + '</a>') + '</li>';
    }
    output += '</ul>';
  }
  return output;
};
if (goog.DEBUG) {
  Multiexcerpt.Templates.Dialogs.pages.soyTemplateName = 'Multiexcerpt.Templates.Dialogs.pages';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:translations-ignore-inline-webresources', location = '/com/k15t/scroll/platform/ui/translationsignore/translationsignore.soy' */
// This file was automatically generated from translationsignore.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Scroll.Versions.Templates.TranslationsIgnore.
 */

if (typeof Scroll == 'undefined') { var Scroll = {}; }
if (typeof Scroll.Versions == 'undefined') { Scroll.Versions = {}; }
if (typeof Scroll.Versions.Templates == 'undefined') { Scroll.Versions.Templates = {}; }
if (typeof Scroll.Versions.Templates.TranslationsIgnore == 'undefined') { Scroll.Versions.Templates.TranslationsIgnore = {}; }


Scroll.Versions.Templates.TranslationsIgnore.contentParameterWidget = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div" id="macro-param-div-content"><textarea class="textarea" rows="5" id="macro-param-content" style="resize: vertical;" placeholder="' + soy.$$escapeHtml('Content to be ignored') + '"></textarea></div>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.TranslationsIgnore.contentParameterWidget.soyTemplateName = 'Scroll.Versions.Templates.TranslationsIgnore.contentParameterWidget';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:translations-ignore-inline-webresources', location = '/com/k15t/scroll/platform/ui/translationsignore/translationsignore.js' */
require(["ajs","jquery"],function(a,c){var b=function(){var d={fields:{string:function(h,e){if(h&&h.name!="content"){return a.MacroBrowser.ParameterFields.string(h,e)}var f=c(Scroll.Versions.Templates.TranslationsIgnore.contentParameterWidget());var g=f.find("textarea");if(h.required){g.keyup(a.MacroBrowser.processRequiredParameters)}return a.MacroBrowser.Field(f,g,e)}}};a.MacroBrowser.setMacroJsOverride("translations-ignore-inline",d)};Scroll.Versions.Utils.toInitInEditor(b)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:editorext-webresources', location = '/com/k15t/scroll/platform/ui/editorext/editorext.soy' */
// This file was automatically generated from editorext.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Scroll.Versions.Templates.EditorExt.
 */

if (typeof Scroll == 'undefined') { var Scroll = {}; }
if (typeof Scroll.Versions == 'undefined') { Scroll.Versions = {}; }
if (typeof Scroll.Versions.Templates == 'undefined') { Scroll.Versions.Templates = {}; }
if (typeof Scroll.Versions.Templates.EditorExt == 'undefined') { Scroll.Versions.Templates.EditorExt = {}; }


Scroll.Versions.Templates.EditorExt.renderEditorExtDiv = function(opt_data, opt_ignored) {
  return '<div id="sv-editorext" data-new-scroll-page-title="' + soy.$$escapeHtml(opt_data.editorContext.newPageTitle) + '">' + ((opt_data.isPermaLinkFeatureEnabled) ? '<div id="sv-permalink-container" class=""><div style="padding-bottom: 1em;"><label for="sv-permalink" id="sv-permalink-label" style=""> ' + soy.$$escapeHtml('Permalink') + ':</label><span class="sv-permalink-view">' + soy.$$escapeHtml(opt_data.pageBaseUrl) + '<span class="sv-permalink-display">#* value from text field will be inserted via javascript *#</span></span><span class="sv-permalink-edit">' + soy.$$escapeHtml(opt_data.pageBaseUrl) + '<input type="text" name="sv-permalink" id="sv-permalink" value="' + soy.$$escapeHtml(opt_data.editorContext.suggestedUniqueConfluencePageTitle) + '" tabindex="1" class="text sv-permalink" autocomplete="off"/><span class="sv-save"></span><span class="sv-cancel"></span></span><span class="sv-permalink-warning" style="display: none;">' + soy.$$escapeHtml('The permalink cannot be displayed.') + '</span></div></div>' : '') + '</div>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.EditorExt.renderEditorExtDiv.soyTemplateName = 'Scroll.Versions.Templates.EditorExt.renderEditorExtDiv';
}


Scroll.Versions.Templates.EditorExt.renderEditorComplete = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="sv-editor-command" value="' + soy.$$escapeHtml(Scroll.Versions.Context.editor.editorCommand) + '" /><input type="hidden" name="sv-language-key" value="' + soy.$$escapeHtml(Scroll.Versions.Context.editor.languageKey) + '" />';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.EditorExt.renderEditorComplete.soyTemplateName = 'Scroll.Versions.Templates.EditorExt.renderEditorComplete';
}


Scroll.Versions.Templates.EditorExt.renderOutdateTranslations = function(opt_data, opt_ignored) {
  return '<span class="minor-edit toolbar-item"><input name="sv-outdate-translations-present" value="true" type="hidden"><input id="sv-outdate-translations" name="sv-outdate-translations" value="true" type="checkbox" checked><label for="sv-outdate-translations"><span>' + soy.$$escapeHtml('Outdate translations') + '</span></label></span>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.EditorExt.renderOutdateTranslations.soyTemplateName = 'Scroll.Versions.Templates.EditorExt.renderOutdateTranslations';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:editorext-webresources', location = '/com/k15t/scroll/platform/ui/editorext/editorext.js' */
require(["ajs","jquery"],function(j,f){if(!Scroll.Versions.Utils.isAnyModuleEnabled(Scroll.Versions.Utils.moduleKeys.enableVersionManagement,Scroll.Versions.Utils.moduleKeys.enableTranslation,Scroll.Versions.Utils.moduleKeys.enablePermalinks)||Scroll.Versions.AJS.isBlogPost()){return}var b=null;var o=function(){return Scroll.Versions.Context.space.config.enablePermalinks&&Scroll.Versions.Context.user.permissions.Contribute&&Scroll.Versions.Context.user.currentLanguage.isOriginal};var p=function(){return Scroll.Versions.Context&&Scroll.Versions.Context.modules&&Scroll.Versions.Context.modules.TranslationManagement.isEnabledInSpace&&Scroll.Versions.Context.modules.TranslationManagement.isActive};var a=function(){return Scroll.Versions.Context&&Scroll.Versions.Context.modules&&Scroll.Versions.Context.modules.VersionManagement.isEnabledInSpace&&Scroll.Versions.Context.modules.VersionManagement.isActive};var l=function(s){if(s===""){b.find(".sv-permalink-warning").hide();return}Scroll.Versions.REST.page.isTitleSafe(s).done(function(t){if(t){b.find(".sv-permalink-warning").hide()}else{b.find(".sv-permalink-warning").show()}})};var e=function(s){s=f.trim(s);b.find(".sv-permalink").val(s);b.find(".sv-permalink-display").text(window.Scroll.Versions.urlEncode(s));l(s)};var d=function(){var u=Scroll.Versions.AJS.getBaseUrl();if(Scroll.Versions.Context.page&&Scroll.Versions.Context.editor){f("#content-title-div").after(Scroll.Versions.Templates.EditorExt.renderEditorExtDiv({editorContext:Scroll.Versions.Context.editor,isPermaLinkFeatureEnabled:o(),pageBaseUrl:u+(u!==""&&u.substr(u.length-1)==="/"?"":"/")+"display/"+j.Meta.get("space-key")+"/"}))}b=f("#sv-permalink-container");if(b.length){var t=Scroll.Versions.AJS.isNewPage()&&!Scroll.Versions.Context.editor.useDraft;var s=function(){t=false;var v=b.find(".sv-permalink").val();if(b.not("edit")){b.addClass("edit")}b.find(".sv-cancel").unbind("click").bind("click",function(){if(b.find(".sv-permalink").val()===""){b.find(".sv-permalink").val(f("#content-title").val());t=true}b.removeClass("edit");e(v);return false});b.find(".sv-save").unbind("click").bind("click",function(){if(b.find(".sv-permalink").val()===""){b.find(".sv-permalink").val(f("#content-title").val());t=true}b.removeClass("edit");e(b.find(".sv-permalink").val());return false});b.find("input.sv-permalink").unbind("keypress.permalink").bind("keypress.permalink",function(w){if(w.which==13){w.preventDefault();b.find(".sv-save").trigger("click");return false}});b.find("input.sv-permalink").unbind("keyup.permalink").bind("keyup.permalink",function(w){l(f(this).val())});b.parent().find(".sv-permalink").focus().select().one("blur",function(){f(this).focus()});return false};e(f("#sv-permalink").attr("value")||f("#content-title").val());if(((document.location.href.indexOf("docreatepage.action")!=-1)||(document.location.href.indexOf("doeditpage.action")!=-1))&&f("#content-title").val()!==f("#sv-permalink-container .sv-permalink").val()){f("#sv-permalink-container .sv-permalink-display").addClass("highlight")}f("#content-title").off("keyup.sv").on("keyup.sv",function(v){if(t){e(f(this).val())}});f("#sv-permalink-container").on("click",".sv-permalink-view",s);j.log("[Scroll Versions] Permalink Handling initialized.")}};var k=function(){if(o()&&Scroll.Versions.AJS.getEditorType()==Scroll.Versions.AJS.constants.editorTypeCreate&&Scroll.Versions.AJS.getEditMode()==="collaborative"&&Scroll.Versions.Context.editor.useDraft==false){j.bind("editor.remote.change",function s(){var u=window.Scroll.Versions.urlEncode(f.trim(f("#content-title").val()));var v=f("#wysiwygTextarea_ifr").contents().find("#tinymce").attr("data-title");var t=f("#sv-permalink-container .sv-permalink-display").text();if(Scroll.Versions.AJS.getEditorType()==Scroll.Versions.AJS.constants.editorTypeCreate){if(u===t){e(v)}}})}};var r=function(){var s=function(){if(a()){return Scroll.Versions.Context.editor.editorCommand.indexOf("CreatePageCommand")===-1}else{return Scroll.Versions.AJS.getEditorType()===Scroll.Versions.AJS.constants.editorTypeEdit||Scroll.Versions.Context.editor.editorCommand.indexOf("CopyPageCommand")>-1}};if(p()&&s()&&Scroll.Versions.Context.user.currentLanguage.isOriginal){var t=f("#rte-savebar-tinymce-plugin-point, #toolbar-group-minor-edit");if(t.length==0){f("#rte-savebar .toolbar-split-right").prepend('<div class="aui-buttons" id="toolbar-group-outdate-translations"></div>');f("#toolbar-group-outdate-translations").append(Scroll.Versions.Templates.EditorExt.renderOutdateTranslations())}else{t.append(Scroll.Versions.Templates.EditorExt.renderOutdateTranslations())}}};var h=function(u,s){var t=f("#content-title");if(t.val()!==u){j.log("[Scroll] Replacing Confluence page title with Scroll page title - replacing '"+t.val()+"' with '"+u+"'");t.val(u);document.title=s?s:u}};var m=function(){if(j.params.pageTitle&&Scroll.Versions.Context.page.scrollPageTitle){var s=f("#sv-editorext").attr("data-new-scroll-page-title")?f("#sv-editorext").attr("data-new-scroll-page-title"):Scroll.Versions.Context.page.scrollPageTitle;s=Scroll.Versions.Context.editor.draftEditorTitle||s;h(s)}else{if((Scroll.Versions.Context.editor.useDraft||document.location.href.indexOf("draft-createpage.action")!=-1)&&document.location.href.indexOf("draftId=")!=-1&&!Scroll.Versions.Context.editor.draftEditorTitle){var s=Scroll.Versions.Context.editor.newPageTitle;if(s){h(s,document.title.replace("Add Page","Edit"+" - "+s))}}else{if(Scroll.Versions.Context.editor.editorCommand.indexOf("CopyPageCommand")!=-1){var s=j.params.originalContentTitle;if(j.params.originalContentTitle.match(/Copy of \.(.*)( v.*)$/)){s=j.params.originalContentTitle.replace(/Copy of \.(.*)( v.*)$/,"Copy of $1")}else{if(j.params.originalContentTitle.match(/Kopie von \.(.*)( v.*)$/)){s=j.params.originalContentTitle.replace(/Kopie von \.(.*)( v.*)$/,"Kopie von $1")}}h(s,document.title)}else{if(Scroll.Versions.Context.editor.draftEditorTitle){h(Scroll.Versions.Context.editor.draftEditorTitle,"Edit"+" - "+Scroll.Versions.Context.editor.draftEditorTitle)}}}}if(f("#sv-editorext").length){f("#content-title-div").after(f("#sv-editorext").detach())}};var n=function(){m();d();r();i().prepend("<input name='sv-editor-ok' value='true' type='hidden' />");f("body").addClass("sv-editor-initialization-complete")};var i=function(){var s=Scroll.Versions.AJS.getEditorPageForm();return s?f(s):f()};Scroll.Versions.Utils.define("Scroll.Versions.Editor.Collaborative");if(Scroll.Versions.AJS.getEditMode()==="collaborative"&&!Scroll.Versions.Editor.Collaborative.init){var c=function(){var z=function(B){j.log("[Scroll] Reloading page context with ",B);return Scroll.Versions.REST.page.context.get(B).done(function(C){Scroll.Versions.Context.page=C.context;if(Scroll.Versions.Context.space.config.enableVersionManagement){if(Scroll.Versions.Context.page.isChange){Scroll.Versions.Editor.Info.setVersioned()}else{Scroll.Versions.Editor.Info.setUnversioned()}}if(Scroll.Versions.Editor.Collaborative.Translations.checkReloadedContext){Scroll.Versions.Editor.Collaborative.Translations.checkReloadedContext(C)}h(Scroll.Versions.Context.page.scrollPageTitle||Scroll.Versions.Context.editor.draftEditorTitle);f("#content-title").css("visibility","visible");Scroll.Versions.PageIntegration.breadcrumbsOverwrite();i().removeClass("editor-loading editor-loading-spinner");if(Scroll.Versions.Context.space.config.enableTranslation){Scroll.Versions.Context.editor.editorCommand=JSON.stringify({instance:"SaveTranslationMetadataOnlyCommand",workingVersionId:Scroll.Versions.Context.page.targetVersion.id,languageKey:Scroll.Versions.Context.editor.languageKey})}else{Scroll.Versions.Context.editor.editorCommand=JSON.stringify({instance:"SaveMetadataOnlyCommand",workingVersionId:Scroll.Versions.Context.page.targetVersion.id})}if((o())){e(Scroll.Versions.Context.page.permalink);f("#content-title").off("keyup.sv")}}).fail(function(C,E,D){j.error("[Scroll] Received error for loading page context",E,D)})};var y=function(C){i().addClass("editor-loading editor-loading-spinner");f("#content-title").css("visibility","hidden");var B=(j.params.pageId&&parseInt(j.params.pageId))?j.params.pageId:j.params.draftId;j.log("[Scroll] Page has been published - fetching new Scroll page context "+B);z(B)};var w=function(C){i().addClass("editor-loading editor-loading-spinner");f("#content-title").css("visibility","hidden");var B=(j.params.pageId&&parseInt(j.params.pageId))?j.params.pageId:j.params.draftId;j.log("[Scroll] Page has been reverted - fetching new Scroll page context "+B);z(B)};var v=function(){var B=f("#content-title").val();if(!B||!B.trim()){return}j.log("[Scroll] Saving draft because of changed page title ",B);Confluence.Editor.Drafts.save({forceSave:true,onSuccessHandler:function(){j.log("[Scroll] Draft saved",B);f("#content-title").attr("k15t-sv-draft-title",B)}})};var A=function(){j.bind("editor-shared-drafts-published",y);j.bind("editor-shared-drafts-discarded",w);j.debug("[Scroll] Installed listener for draft publish & discard event")};var t=function(){f("#content-title").addClass("k15t-sv-content-title-change-listener-installed").on("change",v);j.debug("[Scroll] Installed page title change listener")};var u=function(){var D=[];var C="is editing this page.";var B="has made changes that haven\u0027t been published.";f(".collaborative-avatars-list .avatar-item.active span").each(function(F,H){var G=f(H);var E=G.attr("original-title")||G.attr("title");if(E){E=E.replace(C,"").replace(B,"").trim()}var I=G.attr("data-username");if(I===Scroll.Versions.AJS.getCurrentUserUsername()){}else{if(f(D).filter(function(J,K){return K.displayName===E}).length==0){D.push({displayName:E})}}});return D};var s=function(){return u().length};var x=function(){j.unbind("editor-shared-drafts-published",y);j.unbind("editor-shared-drafts-discarded",w);j.debug("[Scroll] Removed listener for draft publish & discard event");f("#content-title").off("change",v);j.debug("[Scroll] Removed page title change listener")};Scroll.Versions.Editor.Collaborative.init=A;Scroll.Versions.Editor.Collaborative.getActiveCollaborators=u;Scroll.Versions.Editor.Collaborative.getNumberOfActiveCollaborators=s;Scroll.Versions.Editor.Collaborative.installTitleChangeListener=t;Scroll.Versions.Editor.Collaborative.removeHandlers=x};c()}Scroll.Versions.Editor.Collaborative.Translations=Scroll.Versions.Editor.Collaborative.Translations||{};if(p()&&Scroll.Versions.AJS.getEditMode()==="collaborative"&&!Scroll.Versions.Editor.Collaborative.Translations.init){var g=function(){var v=null;var t=function(x){if((x.translationDraftEditorInformation.draftEditorLanguage&&Scroll.Versions.Context.editor.languageKey!==x.translationDraftEditorInformation.draftEditorLanguage.key)||!x.translationDraftEditorInformation.draftEditorLanguage){j.Confluence.Editor.UI.setButtonsState(false);j.flag({type:"error",body:'<span class="k15t-sv-trsl-languagechanged">The language of this editor has been changed. Save your work in a file and reopen the editor</span>'})}};var u=function(x,y){if(y.contributors){Scroll.Versions.REST.shareddraft.draftFor.post(Scroll.Versions.AJS.getContentId(),Scroll.Versions.Context.editor.languageKey).done(function(A,B,z){v=A;if(A.status==="OK"){if(!Scroll.Versions.AJS.isNewPage()){Scroll.Versions.REST.synchrony.revert(Scroll.Versions.AJS.getContentId())}}else{if(A.status==="Not Modified"){}else{if(A.status==="Conflict"){s(Scroll.Versions.Context.user.currentLanguage,A.draftEditorLanguage,A.contributors)}}}});j.unbind(x,u)}};var s=function(A,y,z){var x={targetLanguage:A,languageOfActiveSession:y,contributors:z};Scroll.Versions.Editor.Collaborative.Translations.joinEditingInLanguageDialog(x,function(){window.location.reload(true)},function(){Confluence.Editor.UI.cancelButton.click()})};var w=function(){j.bind("editor-heartbeat",u);j.debug("[Scroll] Translations installed listener for editor-heartbeat checkDraftEditorLanguage")};Scroll.Versions.Editor.Collaborative.Translations.init=w;Scroll.Versions.Editor.Collaborative.Translations.checkReloadedContext=t};g()}j.toInit(function(){var u=i();if(!u.length){return}if(Scroll.Versions.Context.editor.useDraft){f("#rte-button-location").remove()}k();if(Scroll.Versions.AJS.getEditMode()==="collaborative"){Scroll.Versions.Editor.Collaborative.init();if(p()){Scroll.Versions.Editor.Collaborative.Translations.init()}}if(u.hasClass("editor-loading")){var t=setInterval(function(){if(!u.hasClass("editor-loading")){clearInterval(t);setTimeout(n,10)}},250)}else{n()}j.bind("editor.remote.change",function s(v){m();j.bind("synchrony.connected",function(){setTimeout(m,50);j.unbind("editor.remote.change",s)})})});j.bind("rte-ready",function(){if(Scroll.Versions.AJS.getEditMode()==="collaborative"){Scroll.Versions.Editor.Collaborative.installTitleChangeListener()}});var q=function(){j.Confluence.Editor.addSubmitHandler(function(){if(Scroll.Versions.Context.editor!==undefined){i().prepend(Scroll.Versions.Templates.EditorExt.renderEditorComplete({command:Scroll.Versions.Context.editor.editorCommand}))}});f("#qed-publish-button, #qed-discard-button, #qed-save-exit-button, #qed-close-button").on("click",function(A){if(Scroll.Versions.Editor.Collaborative.removeHandlers){Scroll.Versions.Editor.Collaborative.removeHandlers()}});function w(B){if(!B||!B.url){return false}var C=B.url.toLowerCase();var A=/api\/content(((\/[0-9]*)|\/)?(\?.*)?)$/g;var E=/api\/content\/blueprint\/instance(((\/[0-9]*)|\/)?(\?.*)?)$/g;var F=C.match(A);var D=C.match(E);return(F!=null&&F.length>0)||(D!=null&&D.length>0)}function y(A,B){if(!B||!A||!A.contentType){return false}return A.contentType.indexOf(B)!==-1}function u(B){if(!B||!B.url){return false}var C=B.url.toLowerCase();var A=/rest\/synchrony\/1.0\/content\/([0-9]*)\/changes\/unpublished$/g;var D=C.match(A);return(D!=null&&D.length>0)}function x(B){if(!B||!B.url){return false}var C=B.url.toLowerCase();var D=/tinymce\/1\/(drafts|content\/[0-9]*)/g;var A=C.match(D);return(A!=null&&A.length>0)}function t(A){if(!A||!A.type){return false}var B=A.type.toLowerCase();return(B=="post"||B=="put")}function v(A){if(!A||!A.type){return false}var B=A.type.toLowerCase();return(B=="delete")}f.ajaxPrefilter(function(O,G,C){var B=f("input[name='sv-editor-ok']").val();var D={};if(B&&t(O)&&w(O)&&y(O,"application/json")){var I=Scroll.Versions.Context.editor;var E=Scroll.Versions.Context.user;var L=Scroll.Versions.Context.page;var H=f("#sv-permalink-container").find(".sv-permalink");var N=H.length?H.val():"";D["sv-editor-ok"]=B;D["sv-space-key"]=encodeURIComponent(Scroll.Versions.AJS.getEffectiveSpaceKey());D["sv-permalink"]=N?encodeURIComponent(N):"";D["sv-editor-command"]=s(I);D["sv-language-key"]=z();D["sv-targetVersionId"]=E&&E.workingVersion?E.workingVersion.id:null;if(L&&L.scrollPageId){D["sv-scrollPageId"]=L.scrollPageId}if(f('input[name="sv-outdate-translations-present"]').length){D["sv-outdate-translations-present"]="true";D["sv-outdate-translations"]=""+f('input[name="sv-outdate-translations"]').first().prop("checked")}if(Scroll.Versions.AJS.isSharedDraftsEnabled()){D["sv-active-collaborators"]=Scroll.Versions.Editor.Collaborative.getNumberOfActiveCollaborators()}var A=f('input[name="sv-translation-complete"]');if(A.length){D["sv-translation-complete"]=A.val()}}else{if(B&&x(O)&&y(O,"application/json")){D["sv-language-key"]=z();var M=f("#content-title").val();D["sv-draft-editor-title"]=M?encodeURIComponent(M):"";if(Scroll.Versions.AJS.getDraftId()){D["sv-draft-id"]=Scroll.Versions.AJS.getDraftId()}D["sv-space-key"]=encodeURIComponent(Scroll.Versions.AJS.getEffectiveSpaceKey())}}if(Object.keys(D).length){try{var F=JSON.parse(O.data)}catch(K){function J(P){return P.split("&").reduce(function(S,R){var Q=R.split("=").map(function(T){return decodeURIComponent(T.replace("+"," "))});S[Q[0]]=Q[1];return S},{})}F=J(O.data)}F.scrollparams=F.scrollparams||{};f.extend(F.scrollparams,D);O.data=JSON.stringify(F)}});function s(B){var A="";if(B&&B.editorCommand){A=B.editorCommand}return encodeURIComponent(A)}function z(){var A=f('input[name="sv-language-key"]');if(Scroll.Versions.Context.editor&&Scroll.Versions.Context.editor.languageKey){return Scroll.Versions.Context.editor.languageKey}else{if(A.length&&A.val()){return A.val()}else{return""}}}f(document).ajaxError(function(A,D,J,H){var I=D.getResponseHeader("Content-Type");var E=I&&I.toLowerCase().indexOf("application/json")>-1;if(D&&D.status&&E&&t(J)&&w(J)){var F=JSON.parse(D.responseText);var C=F["sv-suggestedPermalink"];var G=F.message&&F.message.indexOf("A page with this title already exists")>-1;if(o()&&!!C&&G){var B=f("#sv-permalink-container .sv-permalink").val();e(C);if(j.flag){j.flag({type:"error",body:j.format("Scroll Versions: The Permalink \u0022{0}\u0022 is already used. Please use another one.",B)})}}}return D});j.log("[Scroll] Set up REST prefilter & error handler")};Scroll.Versions.Utils.toInitInEditor(q)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:link-browser-resources', location = '/com/k15t/scroll/platform/ui/linkbrowserext/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LinkBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.pagetreePanel = function(opt_data, opt_ignored) {
  return '<div class="sv-pagetree" data-scroll-to-expanded-page="true"><ul class="children"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.pagetreePanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.pagetreePanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:link-browser-resources', location = '/com/k15t/scroll/platform/ui/linkbrowserext/link-browser-tab-pagetree.js' */
require(["ajs","jquery"],function(a,b){a.bind("dialog-created.link-browser",function(j,g){var h="pagetree";var f;var d;function c(e){b(".sv-pagetree li.node").removeClass("highlight");e.parent().addClass("highlight");var k=e.parent().attr("data-master-page-id");if(k){e.attr({"data-base-url":Confluence.getBaseUrl(),"data-linked-resource-id":k,"data-linked-resource-type":"page","data-linked-resource-default-alias":e.parent().attr("data-scroll-page-title"),"data-scroll-page-id":e.parent().attr("data-scroll-page-id")});e.addClass("confluence-link");var l=Confluence.Link.fromNode(e[0],e.text());g.setLink(l,false);g.focusLinkText()}else{a.log("link-browser-tab-pagetree.js: Unable to extract page id from pagetree node")}}function i(e){if(a.params.spaceKey){d=new Scroll.Versions.Pagetree(".sv-pagetree",{highlightActivePage:true,expandByMasterPageId:true,spaceKey:a.params.spaceKey,expandedPageId:e,versionId:Scroll.Versions.Context?Scroll.Versions.Context.user.workingVersion.versionId:"current",languageKey:Scroll.Versions.Context?Scroll.Versions.Context.user.currentLanguage.key:"all",sortBy:"position",isShowToplevelPages:"true"})}else{a.log("link-browser-tab-pagetree.js: spacekey is undefined")}}g.tabs[h]={hasBreadcrumbs:false,createPanel:function(k){a.log("link-browser-tab-pagetree.js: createPanel");f=b("div.sv-pagetree",k.baseElement);f.attr("data-root-page-id","");b(f).on("click","a",function(l){l.preventDefault();c(b(this));d.setExpandedScrollPageId(b(this).parent().attr("data-scroll-page-id"))}).off("dblclick.link-pagetree").on("dblclick.link-pagetree","a",function(l){l.preventDefault();d.setExpandedScrollPageId(b(this).parent().attr("data-scroll-page-id"));b("#link-browser-insert").click()});var e=Confluence.PageLocation.get();a.log(e)},onSelect:function(){a.debug("link-browser-tab-pagetree.js: onSelect");var k=this.openedLink||g.getLink();var e;if(k&&k.getResourceType()==="page"){e=k.getResourceId();g.setLink(k,false)}else{pageId=""}i(e)},handlesLink:function(e){return e.getResourceType()==="page"}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:tinymce-scm-info', location = '/com/k15t/scroll/platform/ui/tinymce/plugin/scm-info/scm-info.js' */
require(["ajs","jquery"],function(i,f){if(!Scroll.Versions.Utils.isAnyModuleEnabled(Scroll.Versions.Utils.moduleKeys.enableVersionManagement,Scroll.Versions.Utils.moduleKeys.enableTranslation)){return}if((!Scroll.Versions.AJS.isPage())||Scroll.Versions.AJS.getPageContext()==="page"){return}var w=null;function c(){return Scroll.Versions.Context.page.isKeepUnversioned}function d(){return Scroll.Versions.Context.page!==undefined&&Scroll.Versions.Context.page.isUnversionedPage}function b(y){var z=JSON.parse(y);return z.instance=="ConvertToUnversionedCommand"}function n(){if((Scroll.Versions.Context.editor.hasEditPermissionForVersion===null||Scroll.Versions.Context.editor.hasEditPermissionForVersion===undefined)){return Scroll.Versions.Context.user.hasEditRestrictionForVersion}else{if(Scroll.Versions.Context.editor.hasEditPermissionForVersion==="false"||Scroll.Versions.Context.editor.hasEditPermissionForVersion===false){return false}else{return true}}}function u(){if(Scroll.Versions.Context.page===undefined||Scroll.Versions.Context.page.isFallbackChange||Scroll.Versions.Context.page.isUnresolvedChange||(Scroll.Versions.Context.page.isUnversionedPage&&!Scroll.Versions.Context.page.isKeepUnversioned&&!Scroll.Versions.Context.user.workingVersion.versionId==="current")){return true}else{return false}}function t(){return Scroll.Versions.Context&&Scroll.Versions.Context.modules&&Scroll.Versions.Context.modules.TranslationManagement.isEnabledInSpace&&Scroll.Versions.Context.modules.TranslationManagement.isActive}function a(){return Scroll.Versions.Context&&Scroll.Versions.Context.modules&&Scroll.Versions.Context.modules.VersionManagement.isEnabledInSpace&&Scroll.Versions.Context.modules.VersionManagement.isActive}function j(){if(!c()||!n()){Scroll.Versions.Context.editor.editorCommand=Scroll.Versions.Context.editor.alternativeEditorCommand}else{Scroll.Versions.Context.editor.editorCommand=w}}function e(){if(!c()&&Scroll.Versions.AJS.isNewPage()&&b(Scroll.Versions.Context.editor.editorCommand)&&b(w)){Scroll.Versions.Context.editor.alternativeEditorCommand=Scroll.Versions.Context.editor.editorCommand;Scroll.Versions.Context.editor.editorCommand=JSON.stringify({instance:"CreatePageCommand",workingVersionId:Scroll.Versions.Context.user.workingVersion.id})}else{Scroll.Versions.Context.editor.editorCommand=w}}function p(){return"#rte-version-button"}function r(){var y=Scroll.Versions.Context.editor.draftTargetVersion?Scroll.Versions.Context.editor.draftTargetVersion.name:Scroll.Versions.Context.user.workingVersion.name;return Scroll.Versions.Utils.trimToLength(y,20)}function k(){var y=f(p());y.removeClass("sv-rte-version-versioned");y.addClass("sv-rte-version-unversioned");y.text("unversioned")}function o(){var y=f(p());y.removeClass("sv-rte-version-unversioned");y.addClass("sv-rte-version-versioned");y.text(r())}function v(){if(!q()){var y=f(p());y.addClass("sv-rte-versions-versioned-unversioned-is-decided")}}function q(){var y=f(p());return y.hasClass("sv-rte-versions-versioned-unversioned-is-decided")}function s(){return g(Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction({title:"Editing versioned page",description:i.format("To convert an already versioned page to an unversioned page, please close the editor, select the \u003cem\u003eScroll Versions dropdown\u003c/em\u003e and use the \u003cem\u003eConvert to unversioned page\u003c/em\u003e feature.",r())}),p(),{openOnClick:false,hideCallback:function(){f(p()).removeClass("sv-dialog-open")},dialogIdSuffix:"scm-versioned-info"})}function x(){return g(Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction({title:"Unversioned page",description:i.format("Changes on this page will be visible in all versions. To convert an unversioned page to a versioned page, please close the editor, select the \u003cem\u003eScroll Versions dropdown\u003c/em\u003e and use the \u003cem\u003eConvert to versioned page\u003c/em\u003e feature.",r())}),p(),{openOnClick:false,hideCallback:function(){f(p()).removeClass("sv-dialog-open")},dialogIdSuffix:"scm-unversioned-info"})}function l(){if(a()){var B=f(document);f(".aui-toolbar2-secondary").prepend(Scroll.Versions.Templates.Editor.Info.toolbarButtonVersionInfo({workingVersion:r()}));var K=p();var L=f(K);var C="sv-rte-version-versioned";var G="sv-dialog-open";if(Scroll.Versions.Context.editor.isEnabledToChangePageType==="false"||(!Scroll.Versions.AJS.isNewPage())){if(Scroll.Versions.Context.user.workingVersion.versionId!=="current"&&!Scroll.Versions.Context.page.isKeepUnversioned){o()}else{k()}v();var D;if(u()){D=g(Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction({title:"New versioned page",description:i.format("You are creating a new version of this page for version \u0022{0}\u0022",r())}),K,{openOnClick:false,hideCallback:function(){L.removeClass(G)},dialogIdSuffix:"scm-infoNewVersionCreated"})}else{if(Scroll.Versions.Context.user.workingVersion.versionId==="current"||(Scroll.Versions.Context.page.isUnversionedPage&&Scroll.Versions.Context.page.isKeepUnversioned)){D=g(Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction({title:"Unversioned page",description:i.format("Changes on this page will be visible in all versions. To convert an unversioned page to a versioned page, please close the editor, select the \u003cem\u003eScroll Versions dropdown\u003c/em\u003e and use the \u003cem\u003eConvert to versioned page\u003c/em\u003e feature.",r())}),K,{openOnClick:false,hideCallback:function(){L.removeClass(G)},dialogIdSuffix:"scm-unversioned-info"})}else{D=s()}}B.on("click",K,function(M){if(L.hasClass(G)){D.hide();L.removeClass(G)}else{D.show();L.addClass(G)}})}else{var J=f("#rte-version-button-convert-to-versioned");var I=f("#rte-version-button-convert-to-unversioned");if(n()){var z="rte-version-button-convert-to-unversioned";var E="rte-version-button-convert-to-versioned";var F=g(Scroll.Versions.Templates.Editor.Info.scmInlineDialogVersionChoiceAction({title:i.format("Page for \u0022{0}\u0022",r()),description:i.format("You are editing this page for version \u0022{0}\u0022. You can also create it as unversioned page.",r()),buttonId:z,buttonClass:"sv-rte-version-button-convert",buttonTooltipText:"",buttonDisplayText:"Convert to Unversioned Page"}),K,{openOnClick:false,hideCallback:function(){L.removeClass(G)},dialogIdSuffix:"scm-convert-to-unversioned"});var y=g(Scroll.Versions.Templates.Editor.Info.scmInlineDialogVersionChoiceAction({title:"Unversioned Page",description:i.format("You are editing an unversioned page. You can also create it for version \u0022{0}\u0022.",r()),buttonId:E,buttonClass:"sv-rte-version-button-convert",buttonTooltipText:"",buttonDisplayText:i.format("Convert to Page for \u0022{0}\u0022",r())}),K,{openOnClick:false,hideCallback:function(){L.removeClass(G)},dialogIdSuffix:"scm-convert-to-versioned"});B.on("click",K,function(){if(L.hasClass(C)){if(L.hasClass(G)){F.hide();L.removeClass(G)}else{F.show();L.addClass(G)}}else{if(L.hasClass(G)){y.hide();L.removeClass(G)}else{y.show();L.addClass(G)}}});B.on("click","#"+z,function(){k();F.hide();j()});I.tooltip();B.on("click","#"+E,function(){o();y.hide();e()});J.tooltip();var H="infoDecideUnversionedNotShow";if(!i.Cookie.read(H)&&!c()){var A=g(Scroll.Versions.Templates.Editor.Info.scmGotItInlineDialog({version:r()}),K,{openOnClick:false,isHelp:true,dialogIdSuffix:"scm-info-decide-unversioned-gotit"});A.show();f("#sv-info-decide-unversioned-gotit").on("click",function(){i.Cookie.save(H,"true");A.hide()})}}else{v();var D=g(Scroll.Versions.Templates.Editor.Info.scmInlineDialog({title:"Unversioned page",description:i.format("You do not have permission to create a new page version for the current version \u0022{0}\u0022.",r())}),K,{openOnClick:false,hideCallback:function(){L.removeClass(G)},dialogIdSuffix:"scm-notAllowedToCreateChange"});B.on("click",K,function(){if(L.hasClass(G)){D.hide();L.removeClass(G)}else{D.show();L.addClass(G)}})}if(c()||!n()||b(Scroll.Versions.Context.editor.editorCommand)){k();if(!n()){j()}}else{o()}}}}function m(){if(t()){f(".aui-toolbar2-secondary").prepend(Scroll.Versions.Templates.Editor.Info.toolbarButtonLanguageInfo({lang:decodeURIComponent(Scroll.Versions.Context.user.currentLanguage.encodedKey.toUpperCase())}));g(Scroll.Versions.Templates.Editor.Info.scmInlineDialog({title:"Page Language",description:i.format("You are editing the \u0022{0}\u0022 translation of this page.",Scroll.Versions.Context.user.currentLanguage.displayName)}),"#rte-lang-info",{openOnClick:true,dialogIdSuffix:"scm-infoTranslation"})}}function g(B,y,G){G=G||{};var E=G.openOnClick!==undefined?G.openOnClick:true;var D=f(y);var z="scm-info-dialog-"+(G.dialogIdSuffix||"scm-info");D.attr("aria-controls",z);if(E){D.attr("data-aui-trigger","true")}var C=Scroll.Versions.Templates.Editor.Info.infoInlineDialogWrapper({id:z,content:B,isHelp:G.isHelp});var F=f(C);F.appendTo("body");F.on("aui-hide",function(H){if(G.hideCallback){G.hideCallback()}});var A={hide:function(){f("#"+z).attr("open",null)},show:function(){f(y).attr("aria-controls",z);f("#"+z).attr("open","open")}};F.find(".scm-dialog-close").on("click",A.hide);return A}Scroll.Versions.Editor=Scroll.Versions.Editor||{};Scroll.Versions.Editor.Info={setVersioned:function(){f(".scm-info-dialog").remove();var y=s();var z=p();f(document).off("click",z);f(z).off().on("click",function(A){var B=f(A.target);if(B.hasClass("sv-dialog-open")){y.hide();B.removeClass("sv-dialog-open")}else{y.show();B.addClass("sv-dialog-open")}});o();v()},setUnversioned:function(){f(".scm-info-dialog").remove();var y=x();var z=p();f(document).off("click",z);f(z).off().on("click",function(A){var B=f(A.target);if(B.hasClass("sv-dialog-open")){y.hide();B.removeClass("sv-dialog-open")}else{y.show();B.addClass("sv-dialog-open")}});k();v()},setDecided:v};var h=function(){w=Scroll.Versions.Context.editor.editorCommand;m();l();f(".contenteditor #rte-toolbar").css("padding-right",f(".aui-toolbar2-secondary").width());i.Confluence.Editor.addCancelHandler(function(){Scroll.Versions.Context.editor.editorCommand=w});tinymce.create("tinymce.plugins.scm.SCMInfo",{getInfo:function(){return{longname:"Current Version Information Panel for Scroll Content Management",version:"1.0.0",author:"K15t",authorurl:"http://www.K15t.com"}}});tinymce.PluginManager.add("scm-info",tinymce.plugins.scm.SCMInfo)};Scroll.Versions.Utils.toInitInEditor(h)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-platform:tinymce-scm-info', location = '/com/k15t/scroll/platform/ui/tinymce/plugin/scm-info/scm-info-template.soy' */
// This file was automatically generated from scm-info-template.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Scroll.Versions.Templates.Editor.Info.
 */

if (typeof Scroll == 'undefined') { var Scroll = {}; }
if (typeof Scroll.Versions == 'undefined') { Scroll.Versions = {}; }
if (typeof Scroll.Versions.Templates == 'undefined') { Scroll.Versions.Templates = {}; }
if (typeof Scroll.Versions.Templates.Editor == 'undefined') { Scroll.Versions.Templates.Editor = {}; }
if (typeof Scroll.Versions.Templates.Editor.Info == 'undefined') { Scroll.Versions.Templates.Editor.Info = {}; }


Scroll.Versions.Templates.Editor.Info.toolbarButtonVersionInfo = function(opt_data, opt_ignored) {
  return '<ul class="aui-buttons sv-rte-secondary-nav sv-rte-secondary-nav--versions sv-rte-separator-info"><li id="rte-version-button" class="aui-button aui-button-subtle toolbar-item sv-rte-secondary-nav-item">' + soy.$$escapeHtml(opt_data.workingVersion) + '</li></ul>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.toolbarButtonVersionInfo.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.toolbarButtonVersionInfo';
}


Scroll.Versions.Templates.Editor.Info.toolbarButtonLanguageInfo = function(opt_data, opt_ignored) {
  return '<ul class="aui-buttons sv-rte-secondary-nav sv-rte-secondary-nav--language sv-rte-separator-info"><li id="rte-lang-info" class="aui-button aui-button-subtle toolbar-item sv-rte-secondary-nav-item">' + soy.$$escapeHtml(opt_data.lang) + '</li></ul>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.toolbarButtonLanguageInfo.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.toolbarButtonLanguageInfo';
}


Scroll.Versions.Templates.Editor.Info.scmInlineDialog = function(opt_data, opt_ignored) {
  return '<h3>' + soy.$$escapeHtml(opt_data.title) + '<span class="scm-dialog-close">\u2715</span></h3><p>' + soy.$$filterNoAutoescape(opt_data.description) + '</p>' + ((opt_data.button != null) ? soy.$$filterNoAutoescape(opt_data.button) : '<div style="height:20px;"></div>') + Scroll.Versions.Templates.Dialog.logo(null);
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.scmInlineDialog.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.scmInlineDialog';
}


Scroll.Versions.Templates.Editor.Info.scmInlineDialogVersionChoiceAction = function(opt_data, opt_ignored) {
  return '' + Scroll.Versions.Templates.Editor.Info.scmInlineDialog({title: opt_data.title, description: opt_data.description, button: '<button id="' + opt_data.buttonId + '" class="aui-button ' + opt_data.buttonClass + '" title="' + opt_data.buttonTooltipText + '">' + opt_data.buttonDisplayText + '</button>'});
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.scmInlineDialogVersionChoiceAction.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.scmInlineDialogVersionChoiceAction';
}


Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction = function(opt_data, opt_ignored) {
  return '' + Scroll.Versions.Templates.Editor.Info.scmInlineDialog({title: opt_data.title, description: opt_data.description, button: null});
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.scmInlineDialogNoVersionChoiceAction';
}


Scroll.Versions.Templates.Editor.Info.scmGotItInlineDialog = function(opt_data, opt_ignored) {
  return '<h3>' + soy.$$escapeHtml('Working Version') + '<span class="scm-dialog-close">\u2715</span></h3><p style="margin-top: 10px">' + soy.$$escapeHtml(AJS.format('This is the version you are currently editing in.',opt_data.version)) + '</p><div style="padding-top: 15px"><a href="#" id="sv-info-decide-unversioned-gotit">' + soy.$$escapeHtml('Do not show again') + '</a></div>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.scmGotItInlineDialog.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.scmGotItInlineDialog';
}


Scroll.Versions.Templates.Editor.Info.infoInlineDialogWrapper = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog id="' + soy.$$escapeHtml(opt_data.id) + '" class="scm-info-dialog ' + ((opt_data.isHelp) ? 'aui-help' : '') + '" alignment="bottom"><div style="width: 320px;">' + soy.$$filterNoAutoescape(opt_data.content) + '</div></aui-inline-dialog>';
};
if (goog.DEBUG) {
  Scroll.Versions.Templates.Editor.Info.infoInlineDialogWrapper.soyTemplateName = 'Scroll.Versions.Templates.Editor.Info.infoInlineDialogWrapper';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/tableplus-editor.js' */
// Todo - COPYRIGHT 
/*jshint esversion: 6 */
'use strict';

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=table-plus"); 
    
    (function ($) {
    //table-plus specific macro params
    //Total param count=26
    const tableplusParms = {
        autoNumberSort: false, 
        footing: 0,  
        heading: 1,
        hideHeader: false,
        border: "",
        width: "",
        multiple: true
    };
    
    var tableplusAllParms = $.extend({}, tablebasecme.commonTableParams, tableplusParms );
    appcme.setMacroJsOverride('table-plus', tableplusAllParms, function(macroDetails) {

        // merge specific ones with tableplusAllParms.
        var parms = appcme.parametersToObj(tableplusAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name}); 
        
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Tables Editor - Table Plus",
            showPreview: true,
            dataAttributes: {commontableeditor: "true"}, // required for all apps built around the common table editors for common events
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms),
                        /* Table Plus has the Column settings tab be the first tab when editor is opened.  */
                        activePanel: true 
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "Table Plus guide",
                        url: "https://bobswift.atlassian.net/wiki/x/GoD7MQ"
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "Table Plus Documentation",
                        url: "https://bobswift.atlassian.net/wiki/x/jIADLQ" 
                    }
                ]
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */
            validator: function (dialog, form, errors) {
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    
    /**
     * On click of insert menu "table-plus" link, 1st native browser dialog shows up for a second until our opener code calls up. 
     * Workaround is to hide the native macro browser then.
     * "table-plus" -> its the linkid given in the atlassian-plugin.xml for the web-item key => "table-plus-macro-menu-link"
     */
    $(document).on("click", "#table-plus", function() {
        $("#macro-browser-dialog:visible").hide();
    });
    
    
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/csv-editor.js' */
// Todo - COPYRIGHT 
/*jshint esversion: 6 */
'use strict';

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=csv"); 
    
    (function ($) {
    //Total param count=43
    //csv Specific params here
    const csvParms = {
            output: "html",
            columns: "",
            script: "",
            profile:"",
            url: "",
            user: "",
            password: "",
            timeout: "",
            quote: "single",
            delimiter: ",",
            encoding: "",
            ignoreTrailingBlankRows: true,
            showWiki: false,
            escape: false,
            macros: false,
            augments: "",
            headingAugments: "",
            footingAugments: "",
            autoNumberSort: false,
            border: "",
            width: "",
            footing: 0,
            heading: 1,
            hideHeader: false,
            disableAntiXss: false
            
    }
    
    var csvAllParms = $.extend({}, tablebasecme.commonTableParams, csvParms );
    appcme.setMacroJsOverride('csv', csvAllParms, function(macroDetails) {

        // merge specific ones with csvAllParms.
        var parms = appcme.parametersToObj(csvAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name, macroBody: (macroDetails.body ? macroDetails.body.trim() : ''), dataTypeToLocate: 'CSV' }); 
        parms = tablebasecme.splitScriptParam(parms);
        //if dataSource chosen is profile, then profileUrl shall be filled for soy to display
        if(parms.profile != ""){
            $.extend(parms, {profileUrl: parms.url, url : ''});
        }
        
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Tables Editor - CSV Table",
            showPreview: true,
            dataAttributes: {commontableeditor: "true", datalocationfields: "true"}, // required for all apps built around the common table editors for common event
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.table/editor-img/icon-nav-csv-48-wht-on-clr.png"),
                        name: "CSV settings",
                        panel: org.swift.confluence.table.csv.editor.csvSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "CSV guide",
                        url: "https://bobswift.atlassian.net/wiki/x/eYB7M" 
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "CSV documentation",
                        url: "https://bobswift.atlassian.net/wiki/x/jIADLQ" 
                    }
                ],
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */
            validator: function (dialog, form, errors) {
                tablebasecme.validateDataLocationFields(dialog, errors);
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/jsontable-editor.js' */
// Todo - COPYRIGHT 
/*jshint esversion: 6 */
'use strict';

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=json-table");
    
    (function ($) {
    //json-table Specific params here
    //total param count=46
    const jsontableParms = {
            paths: "",
            fieldPaths: "",
            fieldOrderRegexPatterns: "",
            sortPaths: "",
            stripQualifiers: false,
            capitalize: true,
            output: "html",
            columns: "",
            script: "",
            profile: "",
            url: "",
            user: "",
            password: "",
            timeout: "",
            encoding: "",
            showWiki: false,
            escape: false,
            macros: false,
            augments: "",
            headingAugments: "",
            footingAugments: "",
            autoNumberSort: false,
            footing: 0, 
            heading: 1,
            hideHeader: false,
            border: "",
            width: "",
            disableAntiXss: false,
            table: true
    }
    
    var jsontableAllParms = $.extend({}, tablebasecme.commonTableParams, jsontableParms );
    appcme.setMacroJsOverride('json-table', jsontableAllParms, function(macroDetails) {

        // merge specific ones with jsontableAllParms.
        var parms = appcme.parametersToObj(jsontableAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name, macroBody: (macroDetails.body ? macroDetails.body.trim() : ''), dataTypeToLocate: 'JSON'}); //NTBL-79:macroBody needed to indicate if data source is macroBody, if it contains data
        parms = tablebasecme.splitScriptParam(parms);
        //if dataSource chosen is profile, then profileUrl shall be filled for soy to display
        if(parms.profile != ""){
            $.extend(parms, {profileUrl: parms.url, url : ''});
        }
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Table Editor - JSON Table",
            showPreview: true,
            dataAttributes: {commontableeditor: "true", datalocationfields: "true"}, // required for all apps built around the common table editors for common event
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.table/editor-img/icon-nav-json-48-wht-on-clr.png"),
                        name: "JSON settings",
                        panel: org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "JSON Table guide",
                        url: "https://bobswift.atlassian.net/wiki/x/o4B8M" 
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "JSON Table Documentation",
                        url: "https://bobswift.atlassian.net/wiki/x/jIADLQ" 
                    }
                ]
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */
            validator: function (dialog, form, errors) {
                tablebasecme.validateDataLocationFields(dialog, errors);
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'scripts/table-editor/attachmenttable-editor.js' */
/*
 * Copyright (c) 2019 Appfire Technologies, Inc.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Bob Swift Atlassian Add-ons EULA"
 * (https://bobswift.atlassian.net/wiki/x/WoDXBQ) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */
/*jshint esversion: 6 */
'use strict';

$(document).on('appfireEditorBeforeSerialize appfireEditorBeforePreviewSerialize', "[data-appfire-macro-name='attachment-table']", 
        function(evt, dialog, form, defaultParms, errors) {
        //set data-atalocationfields false, so that the common handlers wont be called for attachment-table macro. 
        $(this).attr("data-datalocationfields", "false");
});


$(document).on('appfireEditorBeforeSave appfireEditorBeforePreview', "[data-appfire-macro-name='attachment-table']", function(evt, macroParms, dialog, form, defaultParms, macroName) {
    
    //console.log("appfire: event=" + evt.type + "; macro name=" + $(evt.target).closest("[data-appfire-macro-name]").data("appfireMacroName"));
    //construct attachmentPage param back from splitted params and remove the non macro params
    var attachmentSource = dialog.find("#attachmentSource").val();
    if (attachmentSource === "attachment"){
        var space = macroParms["attSpace"];
        var page = macroParms["attPage"];
        if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase())) {
            if ("@self" == page.toLowerCase()) {
                delete macroParms["attachmentPage"];
            } else {
                macroParms["attachmentPage"] = page;
            }
        }
        else{
            if(space !== tablebasecme.CURRENT_SPACE){
                macroParms["attachmentPage"] = space + ":" + page
            }
            else{//if current space
                //if current page, then need not save space or page to be backward compatible    
                if(page === tablebasecme.CURRENT_PAGE){
                    delete macroParms["attachmentPage"];
                }
                else{
                   //if current space but different page, then just save 'page' to be backward compatible   
                    macroParms["attachmentPage"] = page; 
                }
            }
        }

        //singlepage selected, hence remove spaceregex and pageregex. Checked behavior in marketplace version
        delete macroParms["spaceRegex"];
        delete macroParms["pageRegex"];
    }
    //To handle XSS injection for textForNone parameter.
    var textForNone = dialog.find("#textForNone").val();
    macroParms["textForNone"] = safeHtml(textForNone);
    
    delete macroParms["attSpace"];
    delete macroParms["attPage"];
    delete macroParms["attachmentSource"];
});

AJS.bind("init.rte", function(evt) {

    //console.log("appfire: event=" + evt.type + "; macro name=attachment-table"); 
    
    (function ($) {
    //attachment-table Specific params here
    //Total param count=33
    const attachmenttableParms = {
            attachmentPage: "",
            spaceRegex: "",
            includePersonalSpaces: false,
            fromAllChildPages: false,
            pageRegex: "",
            pageLabelRegex: "",
            attachmentRegex: "",
            commentRegex: "",
            labelRegex: "",
            labelMatchOption: "any",
            textForNone: "",
            dateFormat: AJS.Meta.get('date.format'),
            limit: 1000,
            columns: "",
    }
    
    var attachmenttableAllParms = $.extend({}, tablebasecme.commonTableParams, attachmenttableParms );
    appcme.setMacroJsOverride('attachment-table', attachmenttableAllParms, function(macroDetails) {

        // merge specific ones with attachmenttableAllParms.
        var parms = appcme.parametersToObj(attachmenttableAllParms, macroDetails.params, tablebasecme.DELIMITER, tablebasecme.QUOTE);
        $.extend(parms, {macroName: macroDetails.name}); 
        var page = parms.attachmentPage;
        var spaceKey;
        var pageTitle;
        if(page){
            //page is any of @self, @page or @parent, then default to current space
            if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase().trim())){
                 //Do not set current space by default
                pageTitle = page;
            }
            else{
              //if page param contains space:page name, then choose space default space
                if(page.indexOf(":") > 0){
                    spaceKey = page.substring(0, page.indexOf(":"));
                    pageTitle = page.substring(page.indexOf(":")+1, page.length);
                }
                else{
                    //if page param contains just page name, then choose space default space
                    spaceKey = tablebasecme.CURRENT_SPACE;
                    pageTitle = page;
                }
            }
        }
        else{
            spaceKey = tablebasecme.CURRENT_SPACE;
            pageTitle = tablebasecme.CURRENT_PAGE;
        }
        
        $.extend(parms, {attSpace: spaceKey, attPage: pageTitle});
        
        return {
            icon: "/download/resources/org.swift.confluence.table/img/table-32x32.png",
            title: "Advanced Tables Editor - Attachment Table",
            showPreview: true,
            dataAttributes: {commontableeditor: "true", datalocationfields: "true"}, // required for all apps built around the common table editors for common event
            navigation: {
                primary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.table/editor-img/icon-nav-attachment-48-wht-on-clr.png"),
                        name: "Attachment settings",
                        panel: org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-table-48-wht-on-clr.png"),
                        name: "Table settings",
                        panel: org.swift.confluence.table.editor.tableSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-columns-48-wht-on-clr.png"),
                        name: "Column settings",
                        panel: org.swift.confluence.table.editor.columnSettingsPanel(parms)
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/table-editor/img/icon-nav-rows-48-wht-on-clr.png"),
                        name: "Row formatting",
                        panel: org.swift.confluence.table.editor.rowSettingsPanel(parms)
                    }
                ],
                secondary: [
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-guide-48-wht-on-clr.png"),
                        name: "Attachment Table guide",
                        url: "https://bobswift.atlassian.net/wiki/x/AoCAM" 
                    },
                    {
                        icon: appcme.absolutePath("/download/resources/org.swift.confluence.tablesorter/editor/img/icon-nav-docs-48-wht-on-clr.png"),
                        name: "Attachment Table Documentation",
                        url: "https://bobswift.atlassian.net/wiki/x/jIADLQ" 
                    }
                ]
            },
            /**
             * Validate form fields. 
             * Input Parameters:
             *      dialog - The jQuery editor dialog 
             *      form - The jQuery form from the dialog 
             * Return Parameters:
             *      errors - This is a property array.  Each array element contains the message and an optinal jQuery element for the error.  
             * Return: 
             *      True if the form validates correctly and can be saved. False if there are any errors. The form will not be allowed to close in that case. 
             */ 
            validator: function (dialog, form, errors) {
                tablebasecme.validateDataLocationFields(dialog, errors);
                return tablebasecme.validateCommonTableParams(dialog, errors);
            }
        };
    });
    }(AJS.$));
});
var safeHtml = function(unsafeHtml) {
    if (unsafeHtml) {
        return unsafeHtml
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;') 
            .replace(/\//g, '&#x2F;')
            .replace(/\(/g, '&lpar;')
            .replace(/\)/g, '&rpar;');
    }
    return '';
};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'soy/table-editor/csv-settings-panel.soy' */
// This file was automatically generated from csv-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.csv.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.csv == 'undefined') { org.swift.confluence.table.csv = {}; }
if (typeof org.swift.confluence.table.csv.editor == 'undefined') { org.swift.confluence.table.csv.editor = {}; }


org.swift.confluence.table.csv.editor.csvSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#data-source">Data source</a></li><li class="menu-item"><a href="#data-format">Data format</a></li><li class="menu-item"><a href="#data-settings">Data settings</a></li></ul><div class="tabs-pane active-pane" id="data-source"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.dataLocationFields(opt_data) + org.swift.confluence.table.editor.textElement({name: 'encoding', value: opt_data.encoding, label: 'File encoding', topLabel: 'true', helpContent: 'Specify encoding if different than Confluence default. For example, Windows-1252 or UTF-8. See \x3ca href\x3d\x22https://en.wikipedia.org/wiki/Character_encoding\x22 target\x3d\x22_blank\x22\x3eCharacter encoding\x3c/a\x3e for more information. '}) + org.swift.confluence.table.editor.macroBodyFilledMessage(opt_data) + '</fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="data-format"><div class="scrollable-tab-content"><fieldset><h3>Parsing</h3>' + org.swift.confluence.table.editor.textElement({name: 'delimiter', value: opt_data.delimiter, label: 'Column delimiter', topLabel: 'true', helpContent: 'The character that delimits the columns in your data. Typically this is a comma. '}) + org.swift.confluence.table.editor.customToggleElement({name: 'quote', value1: 'single', value2: 'double', value: opt_data.quote, label: 'Quote character', helpContent: 'Character used to represent quoted data. Quoted data may contain delimiters or new lines.'}) + '</fieldset><fieldset><h3>Augmentation</h3>' + org.swift.confluence.table.editor.textElement({name: 'augments', value: opt_data.augments, label: 'Augments to data row values', topLabel: 'true', helpContent: 'Comma separated list of augments to the data row values, one for each column. Double quote values containing a comma. See the \x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/VQB8M\x22 target\x3d\x22_blank\x22\x3edocumentation\x3c/a\x3e for additional information.'}) + org.swift.confluence.table.editor.textElement({name: 'headingAugments', value: opt_data.headingAugments, label: 'Augments to heading row values', topLabel: 'true', helpContent: 'Comma separated list of augments to heading row values, one for each column.'}) + org.swift.confluence.table.editor.textElement({name: 'footingAugments', value: opt_data.footingAugments, label: 'Augments to footer row values', topLabel: 'true', helpContent: 'Comma separated list of augments to footing row values, one for each column.'}) + '</fieldset></div></div><!-- tabs-pane data-format close--><div class="tabs-pane" id="data-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'columns', value: opt_data.columns, label: 'Columns to display', topLabel: 'true', helpContent: 'Comma separated list of column names or numbers in any order. Default is to show all columns.'}) + org.swift.confluence.table.editor.customToggleElement({name: 'output', value1: 'html', value2: 'wiki', value: opt_data.output, label: 'Output format'}) + org.swift.confluence.table.editor.toggleElement({name: 'ignoreTrailingBlankRows', value: opt_data.ignoreTrailingBlankRows, label: 'Ignore trailing blank rows'}) + org.swift.confluence.table.editor.toggleElement({name: 'showWiki', value: opt_data.showWiki, label: 'Show non-formatted version of generated wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'escape', value: opt_data.escape, label: 'Escape special characters in wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'macros', value: opt_data.macros, label: 'Render wiki markup macros in body'}) + org.swift.confluence.table.editor.toggleElement({name: 'disableAntiXss', value: opt_data.disableAntiXss, label: 'Stop encoding of html characters in table content', helpContent: 'Requires Administrator to authorize use. Not available for Cloud.'}) + '</fieldset></div></div><!-- tabs-pane data-settings close--></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.csv.editor.csvSettingsPanel.soyTemplateName = 'org.swift.confluence.table.csv.editor.csvSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'soy/table-editor/jsontable-settings-panel.soy' */
// This file was automatically generated from jsontable-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.jsontable.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.jsontable == 'undefined') { org.swift.confluence.table.jsontable = {}; }
if (typeof org.swift.confluence.table.jsontable.editor == 'undefined') { org.swift.confluence.table.jsontable.editor = {}; }


org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#data-source">Data source</a></li><li class="menu-item"><a href="#data-format">Data format</a></li><li class="menu-item"><a href="#data-settings">Data settings</a></li></ul><div class="tabs-pane active-pane" id="data-source"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.dataLocationFields(opt_data) + org.swift.confluence.table.editor.textElement({name: 'encoding', value: opt_data.encoding, label: 'File encoding', topLabel: 'true', helpContent: 'Specify encoding if different than Confluence default. For example, Windows-1252 or UTF-8. See \x3ca href\x3d\x22https://en.wikipedia.org/wiki/Character_encoding\x22 target\x3d\x22_blank\x22\x3eCharacter encoding\x3c/a\x3e for more information. '}) + org.swift.confluence.table.editor.macroBodyFilledMessage(opt_data) + '</fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="data-format"><div class="scrollable-tab-content"><fieldset><h3>Parsing</h3>' + org.swift.confluence.table.editor.textElement({name: 'paths', value: opt_data.paths, label: 'Paths to fields', topLabel: 'true', helpContent: 'Normally, specify a single path to generate a single table. Simple form is a dot separated list of field names to reach the specific field within the JSON string. See the \x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/tIAXB\x22 target\x3d\x22_blank\x22\x3edocumentation\x3c/a\x3e for more advanced support.'}) + org.swift.confluence.table.editor.textElement({name: 'fieldPaths', value: opt_data.fieldPaths, label: 'Paths to fields to be included', topLabel: 'true', helpContent: 'Comma separated list of paths to fields to be included in the output. Paths are relative to the JSON field specified in the paths parameter.  Defaults to all fields. '}) + org.swift.confluence.table.editor.textElement({name: 'fieldOrderRegexPatterns', value: opt_data.fieldOrderRegexPatterns, label: 'Regex patterns for ordering fields', topLabel: 'true', helpContent: 'Only used when defaulting to all fields and field order is important. Comma separated list of regular expression patterns. A field found by an earlier pattern is ordered before fields not found or found by a later pattern.'}) + org.swift.confluence.table.editor.textElement({name: 'sortPaths', value: opt_data.sortPaths, label: 'Paths used to determine sort order', topLabel: 'true', helpContent: 'Comma separated list of paths. Paths are relative to the JSON field specified in the paths parameter. If specified, JSON array elements will be sorted based on the comparison of field values represented by the paths.'}) + '</fieldset><fieldset><h3>Augmentation</h3>' + org.swift.confluence.table.editor.textElement({name: 'augments', value: opt_data.augments, label: 'Augments to data row values', topLabel: 'true', helpContent: 'Comma separated list of augments to the data row values, one for each column. Double quote values containing a comma. See the \x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/ooCSAg\x22 target\x3d\x22_blank\x22\x3edocumentation\x3c/a\x3e.'}) + org.swift.confluence.table.editor.textElement({name: 'headingAugments', value: opt_data.headingAugments, label: 'Augments to heading row values', topLabel: 'true', helpContent: 'Comma separated list of augments to heading row values, one for each column.'}) + org.swift.confluence.table.editor.textElement({name: 'footingAugments', value: opt_data.footingAugments, label: 'Augments to footer row values', topLabel: 'true', helpContent: 'Comma separated list of augments to footing row values, one for each column.'}) + '</fieldset></div></div><!-- tabs-pane data-format close--><div class="tabs-pane" id="data-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'columns', value: opt_data.columns, label: 'Columns to display', topLabel: 'true', helpContent: 'Comma separated list of column names or numbers in any order. Default is to show all columns.'}) + org.swift.confluence.table.editor.customToggleElement({name: 'output', value1: 'html', value2: 'wiki', value: opt_data.output, label: 'Output format'}) + org.swift.confluence.table.editor.toggleElement({name: 'stripQualifiers', value: opt_data.stripQualifiers, label: 'Strip leading qualifiers from generated headings'}) + org.swift.confluence.table.editor.toggleElement({name: 'table', value: opt_data.table, label: 'Show result as table'}) + org.swift.confluence.table.editor.toggleElement({name: 'capitalize', value: opt_data.capitalize, label: 'Capitalize first character of generated headings'}) + org.swift.confluence.table.editor.toggleElement({name: 'showWiki', value: opt_data.showWiki, label: 'Show non-formatted version of generated wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'escape', value: opt_data.escape, label: 'Escape special characters in wiki'}) + org.swift.confluence.table.editor.toggleElement({name: 'macros', value: opt_data.macros, label: 'Render wiki markup macros in body'}) + org.swift.confluence.table.editor.toggleElement({name: 'disableAntiXss', value: opt_data.disableAntiXss, label: 'Stop encoding of html characters in table content', helpContent: 'Enable this parameter for tables that use html output and have html content, such as links. HTML content will only display correctly if this parameter is enabled.'}) + '</fieldset></div></div><!-- tabs-pane data-settings close--></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel.soyTemplateName = 'org.swift.confluence.table.jsontable.editor.jsontableSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.table:advanced-tables-editor-resources', location = 'soy/table-editor/attachmenttable-settings-panel.soy' */
// This file was automatically generated from attachmenttable-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.attachmenttable.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.attachmenttable == 'undefined') { org.swift.confluence.table.attachmenttable = {}; }
if (typeof org.swift.confluence.table.attachmenttable.editor == 'undefined') { org.swift.confluence.table.attachmenttable.editor = {}; }


org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#page-filtering">Page filtering</a></li><li class="menu-item"><a href="#attachment-filtering">Attachment filtering</a></li><li class="menu-item"><a href="#data-settings">Data settings</a></li></ul><div class="tabs-pane active-pane" id="page-filtering"><div class="scrollable-tab-content"><fieldset><div class="aui-group"><div class="field-group"><label for="attachmentSource">Source</label><select class="select appfire-table-datalocation appfire-editor-select" id="attachmentSource"  name="attachmentSource" data-macroname="' + soy.$$escapeHtml(opt_data.macroName) + '"><option value="attachment" ' + ((opt_data.attPage && opt_data.attSpace) ? ' selected ' : '') + '>Single page</option><option value="regex" ' + ((opt_data.spaceRegex || opt_data.pageRegex) ? ' selected ' : '') + '>Regular expression</option></select></div></div><div class="aui-group attachment-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'attSpace', inputClass: 'datalocation-space long-field', value: opt_data.attSpace, label: 'Space', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'attPage', inputClass: 'datalocation-page long-field', value: opt_data.attPage, label: 'Page', topLabel: 'true', helpContent: 'The page to list attachments. Use the special values of @self, @home, or @parent if you plan to move or copy the page. Preview does not work for @parent page value if page is in draft state.'}) + '</div><!--regex fields --><div class="aui-group regex-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'spaceRegex', value: opt_data.spaceRegex, label: 'Filter by space key or space name', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/EYB7M\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match space keys or names. Use @self for current space and @all for all spaces.'}) + org.swift.confluence.table.editor.toggleElement({name: 'includePersonalSpaces', value: opt_data.includePersonalSpaces, label: 'Include personal spaces'}) + org.swift.confluence.table.editor.textElement({name: 'pageRegex', value: opt_data.pageRegex, label: 'Filter by page name', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/EYB7M\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match page names. Used in combination with the other regex parameters.'}) + org.swift.confluence.table.editor.textElement({name: 'pageLabelRegex', value: opt_data.pageLabelRegex, label: 'Filter by page label', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/EYB7M\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match page labels. Used in combination with the other regex parameters.'}) + '</div><!-- regex fields --></fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="attachment-filtering"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'attachmentRegex', value: opt_data.attachmentRegex, label: 'Attachment name regex', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/EYB7M\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match attachment names. Used in combination with the other regex parameters.'}) + org.swift.confluence.table.editor.textElement({name: 'commentRegex', value: opt_data.commentRegex, label: 'Attachment comment regex', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/EYB7M\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match attachment comments. Used in combination with the other regex parameters.'}) + org.swift.confluence.table.editor.customToggleElement({name: 'labelMatchOption', value1: 'any', value2: 'all', value: opt_data.labelMatchOption, label: 'Label match option'}) + org.swift.confluence.table.editor.textElement({name: 'labelRegex', value: opt_data.labelRegex, label: 'Attachment label regex', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/EYB7M\x22 target\x3d\x22_blank\x22\x3eRegular expression\x3c/a\x3e to match attachment labels. Used in combination with the other regex parameters.'}) + '</fieldset></div></div><!-- tabs-pane data-source close--><div class="tabs-pane" id="data-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'columns', value: opt_data.columns, label: 'Columns to display', topLabel: 'true', helpContent: 'Comma separated list of column names or numbers in any order. When blank, a default set of columns is shown. @all will show all available columns. Refer to \x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/AoCAM#AttachmentTablemacro-8.x-ColumnsToShowColumnsavailablefordisplay\x22 target\x3d\x22_blank\x22\x3ethis article\x3c/a\x3e for more information.'}) + org.swift.confluence.table.editor.textElement({name: 'textForNone', value: opt_data.textForNone, label: 'Text to display when no attachments match', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'dateFormat', value: opt_data.dateFormat, label: 'Date format', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'limit', type: 'number', value: opt_data.limit, label: 'Limit number of attachments to retrieve', topLabel: 'true'}) + org.swift.confluence.table.editor.toggleElement({name: 'fromAllChildPages', value: opt_data.fromAllChildPages, label: 'Retrieve attachments from child pages'}) + '</fieldset></div></div><!-- tabs-pane data-settings close--></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel.soyTemplateName = 'org.swift.confluence.table.attachmenttable.editor.attachmentTableSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'net.customware.confluence.plugin.scaffolding:editor-scaff-live-template', location = 'dist/js/liveTemplateEditButton.js' */
!function(){var e={8598:function(e,t,a){e.exports=a}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}"undefined"!=typeof AJS&&(a.p=AJS.contextPath()+"/s/d35a8556-7a9b-4025-bed3-15c5e313bf96/_/download/resources/net.customware.confluence.plugin.scaffolding:assets-d35a8556-7a9b-4025-bed3-15c5e313bf96/"),function(){"use strict";var e;a(8598),e=function(e){return AJS.$(e).attr("data-macro-parameters").split("|").reduce((function(e,t){var a,n,r,o=t.split("=");return Object.assign({},e,(a={},n=o[0].trim(),r=o[1].trim(),n in a?Object.defineProperty(a,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[n]=r,a))}),{})},AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("editLiveTemplate",(function(t,a){!function(t){var a=AJS.Meta.get("context-path"),n=AJS.Meta.get("space-key"),r=e(t),o=r.template?r.template:r.page,c="".concat(a,"/").concat("pages/editScaffoldLiveTemplate.action","?type=").concat(r.type,"&template=").concat(o,"&spaceKey=").concat(n),i=AJS.$.browser&&AJS.$.browser.msie?"_blank":"SR-link-to-editLiveTemplate";window.open(c,i)}(a)}))}()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'net.customware.confluence.plugin.scaffolding:scaffolding-on-boarding-javascript', location = 'dist/js/scaffOnBoarding.js' */
!function(){var t={7757:function(t,e,r){t.exports=r(5666)},1211:function(t,e,r){var n;window,t.exports=(n=r(8864),function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13)}([function(t,e){t.exports=n},function(t,e,r){"use strict";e.__esModule=!0,e.extend=u,e.indexOf=function(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return a.test(t)?t.replace(o,i):t},e.isEmpty=function(t){return!t&&0!==t||!(!c(t)||0!==t.length)},e.createFrame=function(t){var e=u({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},o=/[&<>"'`=]/g,a=/[&<>"'`=]/;function i(t){return n[t]}function u(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var s=Object.prototype.toString;e.toString=s;var l=function(t){return"function"==typeof t};l(/x/)&&(e.isFunction=l=function(t){return"function"==typeof t&&"[object Function]"===s.call(t)}),e.isFunction=l;var c=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===s.call(t)};e.isArray=c},function(t,e,r){"use strict";e.__esModule=!0;var n=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function o(t,e){var r=e&&e.loc,a=void 0,i=void 0,u=void 0,s=void 0;r&&(a=r.start.line,i=r.end.line,u=r.start.column,s=r.end.column,t+=" - "+a+":"+u);for(var l=Error.prototype.constructor.call(this,t),c=0;c<n.length;c++)this[n[c]]=l[n[c]];Error.captureStackTrace&&Error.captureStackTrace(this,o);try{r&&(this.lineNumber=a,this.endLineNumber=i,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=u,this.endColumn=s))}catch(t){}}o.prototype=new Error,e.default=o,t.exports=e.default},function(t,e,r){t.exports=r(14)},function(t,e){function r(t,e,r,n,o,a,i){try{var u=t[a](i),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function u(t){r(i,o,a,u,s,"next",t)}function s(t){r(i,o,a,u,s,"throw",t)}u(void 0)}))}}},function(t,e,r){t.exports=r(15).default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=c;var o=r(1),a=n(r(2)),i=r(7),u=r(23),s=n(r(9)),l=r(10);function c(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},i.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}e.VERSION="4.7.6",e.COMPILER_REVISION=8,e.LAST_COMPATIBLE_COMPILER_REVISION=7,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"},c.prototype={constructor:c,logger:s.default,log:s.default.log,registerHelper:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if("[object Object]"===o.toString.call(t))o.extend(this.partials,t);else{if(void 0===e)throw new a.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var f=s.default.log;e.log=f,e.createFrame=o.createFrame,e.logger=s.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),a.default(t),i.default(t),u.default(t),s.default(t),l.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])};var o=n(r(16)),a=n(r(17)),i=n(r(18)),u=n(r(19)),s=n(r(20)),l=n(r(21)),c=n(r(22))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";e.__esModule=!0;var n=r(1),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];console[e].apply(console,n)}}};e.default=o,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.createProtoAccessControl=function(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=Object.create(null);return r.__proto__=!1,{properties:{whitelist:n.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:n.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,r){return function(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==a[t]&&(a[t]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}("function"==typeof t?e.methods:e.properties,r)},e.resetLoggedProperties=function(){Object.keys(a).forEach((function(t){delete a[t]}))};var n=r(25),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(9)),a=Object.create(null)},function(t,e,r){var n=r(5);t.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(t,e,r,n,o){var a,i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<ul class="aui-buttons">\n    <li id="rte-common-on-boarding-button" class="toolbar-item aui-button">\n        <a id="rte-common-on-boarding" href="#">\n            <span class="trigger-text">\n                <img style="margin-top: 4px;" src="'+t.escapeExpression("function"==typeof(a=null!=(a=i(r,"iconUrl")||(null!=e?i(e,"iconUrl"):e))?a:t.hooks.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"iconUrl",hash:{},data:o,loc:{start:{line:5,column:51},end:{line:5,column:62}}}):a)+'">\n            </span>\n        </a>\n    </li>\n</ul>\n'},useData:!0})},function(t,e,r){var n=r(5);t.exports=(n.default||n).template({1:function(t,e,r,n,o){var a;return"        "+(null!=(a=t.lambda(e,e))?a:"")+"\n"},compiler:[8,">= 4.3.0"],main:function(t,e,r,n,o){var a,i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div id="sr-appcues-onboarding">\n\t<div>\n'+(null!=(a=i(r,"each").call(null!=e?e:t.nullContext||{},null!=e?i(e,"elems"):e,{name:"each",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:3,column:4},end:{line:5,column:13}}}))?a:"")+'\t</div>\n\t<div style="float: right;margin-top: 5px">\n\t    <button id="sr-appcues-skip-btn" class="aui-button aui-button-link">Maybe later</button>\n\t</div>\n</div>\n\n\n'},useData:!0})},function(t,e,r){"use strict";r.r(e),r.d(e,"APPCUES_TUTORIAL_SLIDEOUT",(function(){return d})),r.d(e,"APPCUES_INLINE_DIALOG_POPUP",(function(){return h})),r.d(e,"initializeRocket",(function(){return v})),r.d(e,"insertNewContainer",(function(){return m})),r.d(e,"insertRestPathOfPluginConsumer",(function(){return g})),r.d(e,"insertNewHandler",(function(){return y})),r.d(e,"hideDialog",(function(){return _})),r.d(e,"hasUserSeen",(function(){return x})),r.d(e,"getHasUserSeen",(function(){return P})),r.d(e,"markUserSeen",(function(){return O})),r.d(e,"sendReportingAnalytics",(function(){return k})),r.d(e,"initAppcues",(function(){return E})),r.d(e,"fetchAppcuesScript",(function(){return L}));var n=r(3),o=r.n(n),a=r(4),i=r.n(a),u=r(11),s=r.n(u),l=r(12),c=r.n(l),f=r(0),p=r.n(f),d="APPCUES_TUTORIAL_SLIDEOUT",h="APPCUES_INLINE_DIALOG_POPUP";function v(t,e){(document.querySelector(".blogpost.edit")||document.querySelector(".page.edit"))&&(function(t){var e,r,n,o;!0!==window.srConfHasAppcuesInit&&(window.srConfHasAppcuesInit=!0,window.srConfTempElements=[],window.srConfTempHandlers=[],window.srConfPluginConsumers=[],window.srConfAppcuesDialogHasShown=!1,$("#rte-button-help").parent("ul").before(s()({iconUrl:t})),window.srAppcuesInlineDialog=p.a.InlineDialog(p.a.$("#rte-common-on-boarding-button"),"common-appcues-tooltip",(function(t,e,r){t.html(c()({elems:window.srConfTempElements})),r()}),{persistent:!0,initCallback:w,width:"300px"}),e=$("#rte-toolbar").find(".aui-toolbar2-primary"),r="margin-right",45,(o=/(\d*)(px)?/.exec(e.css(r))).length>1&&(n=+o[1],n+=45,e.css(r,n+"px")))}(e),function(t){b.apply(this,arguments)}(t))}function m(t){window.srConfTempElements.push(t)}function g(t){window.srConfPluginConsumers.push(t)}function y(t){-1===window.srConfTempHandlers.indexOf(t)&&window.srConfTempHandlers.push(t)}function w(){window.srConfTempHandlers.forEach((function(t){t()})),$("#sr-appcues-skip-btn").click((function(t){t.preventDefault(),_(),window.srConfPluginConsumers.forEach((function(t){var e="".concat(p.a.params.baseUrl,"/rest/").concat(t,"/on-boarding/analytics"),r="".concat(p.a.params.baseUrl,"/rest/").concat(t,"/on-boarding/seen");k(e,"SKIP_ON_BOARDING"),O(r,p.a.Meta.get("remote-user-key"),d)}))}))}function _(){window.srAppcuesInlineDialog.hide()}function b(){return(b=i()(o.a.mark((function t(e){var r,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(e,p.a.Meta.get("remote-user-key"),d);case 2:r=t.sent,n=r.hasUserSeen,!1===r.shouldPopUp||n||window.srConfAppcuesDialogHasShown||(window.srConfAppcuesDialogHasShown=!0,setTimeout((function(){return window.srAppcuesInlineDialog.show()}),2e3));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t,e,r){return P(t,e,r)}function P(t,e,r){return p.a.$.ajax({url:t,type:"GET",contentType:"application/json",data:{userKey:e,type:r}})}function O(t,e,r){return p.a.$.ajax({url:t,type:"POST",contentType:"application/json",data:JSON.stringify({userKey:e,onBoardingType:r})})}function k(t,e){p.a.$.ajax({url:t,type:"POST",beforeSend:function(t){t.setRequestHeader("X-Atlassian-Token","no-check")},contentType:"application/json",data:JSON.stringify({event:e})})}function E(t){return M.apply(this,arguments)}function M(){return(M=i()(o.a.mark((function t(e){var r,n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!p.a.params.remoteUserKey){t.next=10;break}return t.next=4,p.a.$.ajax({url:e,type:"GET",contentType:"application/json"});case 4:r=t.sent,n=r.userKey,a=r.serverSEN,window.Appcues.identify(n,{serverSEN:a}),t.next=11;break;case 10:window.Appcues.anonymous();case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function L(t){return S.apply(this,arguments)}function S(){return(S=i()(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.$.ajax({url:e,dataType:"script",cache:!0});case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,r){var n=function(t){"use strict";var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(t,e,r,n){var o=e&&e.prototype instanceof c?e:c,a=Object.create(o.prototype),i=new x(n||[]);return a._invoke=function(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=w(i,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(t,r,i),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function c(){}function f(){}function p(){}var d={};d[o]=function(){return this};var h=Object.getPrototypeOf,v=h&&h(h(P([])));v&&v!==e&&r.call(v,o)&&(d=v);var m=p.prototype=c.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t,e){var n;this._invoke=function(o,a){function i(){return new e((function(n,i){!function n(o,a,i,u){var l=s(t[o],t,a);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(f).then((function(t){c.value=t,i(c)}),(function(t){return n("throw",t,i,u)}))}u(l.arg)}(o,a,n,i)}))}return n=n?n.then(i,i):i()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=s(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=m.constructor=p,p.constructor=f,p[i]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,i in t||(t[i]="GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(y.prototype),y.prototype[a]=function(){return this},t.AsyncIterator=y,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new y(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},g(m),m[i]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),b(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;b(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}e.__esModule=!0;var a=o(r(6)),i=n(r(26)),u=n(r(2)),s=o(r(1)),l=o(r(27)),c=n(r(29));function f(){var t=new a.HandlebarsEnvironment;return s.extend(t,a),t.SafeString=i.default,t.Exception=u.default,t.Utils=s,t.escapeExpression=s.escapeExpression,t.VM=l,t.template=function(e){return l.template(e,t)},t}var p=f();p.create=f,c.default(p),p.default=p,e.default=p,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n=r(1);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,r){var o=r.inverse,a=r.fn;if(!0===e)return a(this);if(!1===e||null==e)return o(this);if(n.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):o(this);if(r.data&&r.ids){var i=n.createFrame(r.data);i.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:i}}return a(e,r)}))},t.exports=e.default},function(t,e,r){"use strict";(function(n){e.__esModule=!0;var o,a=r(1),i=(o=r(2))&&o.__esModule?o:{default:o};e.default=function(t){t.registerHelper("each",(function(t,e){if(!e)throw new i.default("Must pass iterator to #each");var r,o=e.fn,u=e.inverse,s=0,l="",c=void 0,f=void 0;function p(e,r,n){c&&(c.key=e,c.index=r,c.first=0===r,c.last=!!n,f&&(c.contextPath=f+e)),l+=o(t[e],{data:c,blockParams:a.blockParams([t[e],e],[f+e,null])})}if(e.data&&e.ids&&(f=a.appendContextPath(e.data.contextPath,e.ids[0])+"."),a.isFunction(t)&&(t=t.call(this)),e.data&&(c=a.createFrame(e.data)),t&&"object"==typeof t)if(a.isArray(t))for(var d=t.length;s<d;s++)s in t&&p(s,s,s===t.length-1);else if(n.Symbol&&t[n.Symbol.iterator]){for(var h=[],v=t[n.Symbol.iterator](),m=v.next();!m.done;m=v.next())h.push(m.value);for(d=(t=h).length;s<d;s++)p(s,s,s===t.length-1)}else r=void 0,Object.keys(t).forEach((function(t){void 0!==r&&p(r,s-1),r=t,s++})),void 0!==r&&p(r,s-1,!0);return 0===s&&(l=u(this)),l}))},t.exports=e.default}).call(this,r(8))},function(t,e,r){"use strict";e.__esModule=!0;var n,o=(n=r(2))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(1),a=(n=r(2))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return o.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,r){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),e[0]=o,t.log.apply(t,e)}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e,r){return t?r.lookupProperty(t,e):t}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(1),a=(n=r(2))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");o.isFunction(t)&&(t=t.call(this));var r=e.fn;if(o.isEmpty(t))return e.inverse(this);var n=e.data;return e.data&&e.ids&&((n=o.createFrame(e.data)).contextPath=o.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:n,blockParams:o.blockParams([t],[n&&n.contextPath])})}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){o.default(t)};var n,o=(n=r(24))&&n.__esModule?n:{default:n}},function(t,e,r){"use strict";e.__esModule=!0;var n=r(1);e.default=function(t){t.registerDecorator("inline",(function(t,e,r,o){var a=t;return e.partials||(e.partials={},a=function(o,a){var i=r.partials;r.partials=n.extend({},i,e.partials);var u=t(o,a);return r.partials=i,u}),e.partials[o.args[0]]=o.fn,a}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.extend.apply(void 0,[Object.create(null)].concat(e))};var n=r(1)},function(t,e,r){"use strict";function n(t){this.string=t}e.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},e.default=n,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=i.COMPILER_REVISION;if(!(e>=i.LAST_COMPATIBLE_COMPILER_REVISION&&e<=i.COMPILER_REVISION)){if(e<i.LAST_COMPATIBLE_COMPILER_REVISION){var n=i.REVISION_CHANGES[r],o=i.REVISION_CHANGES[e];throw new a.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new a.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new a.default("No environment passed to template");if(!t||!t.main)throw new a.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r=t.compiler&&7===t.compiler[0],n={strict:function(t,e,r){if(!t||!(e in t))throw new a.default('"'+e+'" not defined in '+t,{loc:r});return t[e]},lookupProperty:function(t,e){var r=t[e];return null==r||Object.prototype.hasOwnProperty.call(t,e)||l.resultIsAllowed(r,n.protoAccessControl,e)?r:void 0},lookup:function(t,e){for(var r=t.length,o=0;o<r;o++)if(null!=(t[o]&&n.lookupProperty(t[o],e)))return t[o][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:o.escapeExpression,invokePartial:function(r,n,i){i.hash&&(n=o.extend({},n,i.hash),i.ids&&(i.ids[0]=!0)),r=e.VM.resolvePartial.call(this,r,n,i);var u=o.extend({},i,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=e.VM.invokePartial.call(this,r,n,u);if(null==s&&e.compile&&(i.partials[i.name]=e.compile(r,t.compilerOptions,e),s=i.partials[i.name](n,u)),null!=s){if(i.indent){for(var l=s.split("\n"),c=0,f=l.length;c<f&&(l[c]||c+1!==f);c++)l[c]=i.indent+l[c];s=l.join("\n")}return s}throw new a.default("The partial "+i.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var r=t[e];return r.decorator=t[e+"_d"],r},programs:[],program:function(t,e,r,n,o){var a=this.programs[t],i=this.fn(t);return e||o||n||r?a=c(this,t,i,e,r,n,o):a||(a=this.programs[t]=c(this,t,i)),a},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var r=t||e;return t&&e&&t!==e&&(r=o.extend({},e,t)),r},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function i(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.data;i._setup(r),!r.partial&&t.useData&&(o=p(e,o));var a=void 0,u=t.useBlockParams?[]:void 0;function s(e){return""+t.main(n,e,n.helpers,n.partials,o,u,a)}return t.useDepths&&(a=r.depths?e!=r.depths[0]?[e].concat(r.depths):r.depths:[e]),(s=d(t.main,s,n,r.depths||[],o,u))(e,r)}return i.isTop=!0,i._setup=function(a){if(a.partial)n.protoAccessControl=a.protoAccessControl,n.helpers=a.helpers,n.partials=a.partials,n.decorators=a.decorators,n.hooks=a.hooks;else{var i=o.extend({},e.helpers,a.helpers);!function(t,e){Object.keys(t).forEach((function(r){var n=t[r];t[r]=function(t,e){var r=e.lookupProperty;return s.wrapHelper(t,(function(t){return o.extend({lookupProperty:r},t)}))}(n,e)}))}(i,n),n.helpers=i,t.usePartial&&(n.partials=n.mergeIfNeeded(a.partials,e.partials)),(t.usePartial||t.useDecorators)&&(n.decorators=o.extend({},e.decorators,a.decorators)),n.hooks={},n.protoAccessControl=l.createProtoAccessControl(a);var c=a.allowCallsToHelperMissing||r;u.moveHelperToHooks(n,"helperMissing",c),u.moveHelperToHooks(n,"blockHelperMissing",c)}},i._child=function(e,r,o,i){if(t.useBlockParams&&!o)throw new a.default("must pass block params");if(t.useDepths&&!i)throw new a.default("must pass parent depths");return c(n,e,t[e],r,0,o,i)},i},e.wrapProgram=c,e.resolvePartial=function(t,e,r){return t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name],t},e.invokePartial=function(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var u=void 0;if(r.fn&&r.fn!==f&&function(){r.data=i.createFrame(r.data);var t=r.fn;u=r.data["partial-block"]=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=i.createFrame(r.data),r.data["partial-block"]=n,t(e,r)},t.partials&&(r.partials=o.extend({},r.partials,t.partials))}(),void 0===t&&u&&(t=u),void 0===t)throw new a.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)},e.noop=f;var n,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(1)),a=(n=r(2))&&n.__esModule?n:{default:n},i=r(6),u=r(7),s=r(28),l=r(10);function c(t,e,r,n,o,a,i){function u(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=i;return!i||e==i[0]||e===t.nullContext&&null===i[0]||(u=[e].concat(i)),r(t,e,t.helpers,t.partials,o.data||n,a&&[o.blockParams].concat(a),u)}return(u=d(r,u,t,i,n,a)).program=e,u.depth=i?i.length:0,u.blockParams=o||0,u}function f(){return""}function p(t,e){return e&&"root"in e||((e=e?i.createFrame(e):{}).root=t),e}function d(t,e,r,n,a,i){if(t.decorator){var u={};e=t.decorator(e,u,r,n&&n[0],a,i,n),o.extend(e,u)}return e}},function(t,e,r){"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){return"function"!=typeof t?t:function(){return arguments[arguments.length-1]=e(arguments[arguments.length-1]),t.apply(this,arguments)}}},function(t,e,r){"use strict";(function(r){e.__esModule=!0,e.default=function(t){var e=void 0!==r?r:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default}).call(this,r(8))}]))},2975:function(t,e,r){var n=r(202);t.exports=(n.default||n).template({1:function(t,e,r,n,o){return" background-color: #fefedd; "},compiler:[8,">= 4.3.0"],main:function(t,e,r,n,o){var a,i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="sr-appcues-container" style="border-radius: 10px; padding: 10px;  '+(null!=(a=i(r,"if").call(null!=e?e:t.nullContext||{},null!=e?i(e,"status"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:1,column:78},end:{line:1,column:127}}}))?a:"")+'">\n        <h5 style="color:black">Did you know you can create live template forms in Confluence?</h5>\n\n    <div style="margin-top: 4px">\n        <button class="aui-button aui-button-compact aui-button-primary scaffolding-ok-btn"><span class="aui-icon aui-icon-small aui-iconfont-devtools-arrow-right"></span></button>\n        <button class="aui-button aui-button-link scaffolding-ok-btn">Learn how to build a simple form</button>\n\n    </div>\n</div>\n'},useData:!0})},6834:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}e.__esModule=!0;var a=o(r(2067)),i=n(r(5558)),u=n(r(8728)),s=o(r(2392)),l=o(r(1628)),c=n(r(3982));function f(){var t=new a.HandlebarsEnvironment;return s.extend(t,a),t.SafeString=i.default,t.Exception=u.default,t.Utils=s,t.escapeExpression=s.escapeExpression,t.VM=l,t.template=function(e){return l.template(e,t)},t}var p=f();p.create=f,c.default(p),p.default=p,e.default=p,t.exports=e.default},2067:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=f;var o=r(2392),a=n(r(8728)),i=r(2638),u=r(881),s=n(r(8037)),l=r(6293);e.VERSION="4.7.7",e.COMPILER_REVISION=8,e.LAST_COMPATIBLE_COMPILER_REVISION=7,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var c="[object Object]";function f(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},i.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}f.prototype={constructor:f,logger:s.default,log:s.default.log,registerHelper:function(t,e){if(o.toString.call(t)===c){if(e)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===c)o.extend(this.partials,t);else{if(void 0===e)throw new a.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===c){if(e)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var p=s.default.log;e.log=p,e.createFrame=o.createFrame,e.logger=s.default},881:function(t,e,r){"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){o.default(t)};var n,o=(n=r(5670))&&n.__esModule?n:{default:n}},5670:function(t,e,r){"use strict";e.__esModule=!0;var n=r(2392);e.default=function(t){t.registerDecorator("inline",(function(t,e,r,o){var a=t;return e.partials||(e.partials={},a=function(o,a){var i=r.partials;r.partials=n.extend({},i,e.partials);var u=t(o,a);return r.partials=i,u}),e.partials[o.args[0]]=o.fn,a}))},t.exports=e.default},8728:function(t,e){"use strict";e.__esModule=!0;var r=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function n(t,e){var o=e&&e.loc,a=void 0,i=void 0,u=void 0,s=void 0;o&&(a=o.start.line,i=o.end.line,u=o.start.column,s=o.end.column,t+=" - "+a+":"+u);for(var l=Error.prototype.constructor.call(this,t),c=0;c<r.length;c++)this[r[c]]=l[r[c]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{o&&(this.lineNumber=a,this.endLineNumber=i,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=u,this.endColumn=s))}catch(t){}}n.prototype=new Error,e.default=n,t.exports=e.default},2638:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),a.default(t),i.default(t),u.default(t),s.default(t),l.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])};var o=n(r(7342)),a=n(r(6822)),i=n(r(4905)),u=n(r(7405)),s=n(r(5702)),l=n(r(7593)),c=n(r(3978))},7342:function(t,e,r){"use strict";e.__esModule=!0;var n=r(2392);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,r){var o=r.inverse,a=r.fn;if(!0===e)return a(this);if(!1===e||null==e)return o(this);if(n.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):o(this);if(r.data&&r.ids){var i=n.createFrame(r.data);i.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:i}}return a(e,r)}))},t.exports=e.default},6822:function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(2392),a=(n=r(8728))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("each",(function(t,e){if(!e)throw new a.default("Must pass iterator to #each");var n,i=e.fn,u=e.inverse,s=0,l="",c=void 0,f=void 0;function p(e,r,n){c&&(c.key=e,c.index=r,c.first=0===r,c.last=!!n,f&&(c.contextPath=f+e)),l+=i(t[e],{data:c,blockParams:o.blockParams([t[e],e],[f+e,null])})}if(e.data&&e.ids&&(f=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(c=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var d=t.length;s<d;s++)s in t&&p(s,s,s===t.length-1);else if(r.g.Symbol&&t[r.g.Symbol.iterator]){for(var h=[],v=t[r.g.Symbol.iterator](),m=v.next();!m.done;m=v.next())h.push(m.value);for(d=(t=h).length;s<d;s++)p(s,s,s===t.length-1)}else n=void 0,Object.keys(t).forEach((function(t){void 0!==n&&p(n,s-1),n=t,s++})),void 0!==n&&p(n,s-1,!0);return 0===s&&(l=u(this)),l}))},t.exports=e.default},4905:function(t,e,r){"use strict";e.__esModule=!0;var n,o=(n=r(8728))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},7405:function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(2392),a=(n=r(8728))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return o.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,r){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})}))},t.exports=e.default},5702:function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),e[0]=o,t.log.apply(t,e)}))},t.exports=e.default},7593:function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e,r){return t?r.lookupProperty(t,e):t}))},t.exports=e.default},3978:function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(2392),a=(n=r(8728))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");o.isFunction(t)&&(t=t.call(this));var r=e.fn;if(o.isEmpty(t))return e.inverse(this);var n=e.data;return e.data&&e.ids&&((n=o.createFrame(e.data)).contextPath=o.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:n,blockParams:o.blockParams([t],[n&&n.contextPath])})}))},t.exports=e.default},8572:function(t,e,r){"use strict";e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.extend.apply(void 0,[Object.create(null)].concat(e))};var n=r(2392)},6293:function(t,e,r){"use strict";e.__esModule=!0,e.createProtoAccessControl=function(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=Object.create(null);return r.__proto__=!1,{properties:{whitelist:n.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:n.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,r){return function(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==a[t]&&(a[t]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}("function"==typeof t?e.methods:e.properties,r)},e.resetLoggedProperties=function(){Object.keys(a).forEach((function(t){delete a[t]}))};var n=r(8572),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(8037)),a=Object.create(null)},5005:function(t,e){"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){return"function"!=typeof t?t:function(){var r=arguments[arguments.length-1];return arguments[arguments.length-1]=e(r),t.apply(this,arguments)}}},8037:function(t,e,r){"use strict";e.__esModule=!0;var n=r(2392),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];console[e].apply(console,n)}}};e.default=o,t.exports=e.default},3982:function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==r.g?r.g:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default},1628:function(t,e,r){"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=i.COMPILER_REVISION;if(!(e>=i.LAST_COMPATIBLE_COMPILER_REVISION&&e<=i.COMPILER_REVISION)){if(e<i.LAST_COMPATIBLE_COMPILER_REVISION){var n=i.REVISION_CHANGES[r],o=i.REVISION_CHANGES[e];throw new a.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new a.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new a.default("No environment passed to template");if(!t||!t.main)throw new a.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r=t.compiler&&7===t.compiler[0],n={strict:function(t,e,r){if(!t||!(e in t))throw new a.default('"'+e+'" not defined in '+t,{loc:r});return n.lookupProperty(t,e)},lookupProperty:function(t,e){var r=t[e];return null==r||Object.prototype.hasOwnProperty.call(t,e)||l.resultIsAllowed(r,n.protoAccessControl,e)?r:void 0},lookup:function(t,e){for(var r=t.length,o=0;o<r;o++)if(null!=(t[o]&&n.lookupProperty(t[o],e)))return t[o][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:o.escapeExpression,invokePartial:function(r,n,i){i.hash&&(n=o.extend({},n,i.hash),i.ids&&(i.ids[0]=!0)),r=e.VM.resolvePartial.call(this,r,n,i);var u=o.extend({},i,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=e.VM.invokePartial.call(this,r,n,u);if(null==s&&e.compile&&(i.partials[i.name]=e.compile(r,t.compilerOptions,e),s=i.partials[i.name](n,u)),null!=s){if(i.indent){for(var l=s.split("\n"),c=0,f=l.length;c<f&&(l[c]||c+1!==f);c++)l[c]=i.indent+l[c];s=l.join("\n")}return s}throw new a.default("The partial "+i.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var r=t[e];return r.decorator=t[e+"_d"],r},programs:[],program:function(t,e,r,n,o){var a=this.programs[t],i=this.fn(t);return e||o||n||r?a=c(this,t,i,e,r,n,o):a||(a=this.programs[t]=c(this,t,i)),a},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var r=t||e;return t&&e&&t!==e&&(r=o.extend({},e,t)),r},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function i(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.data;i._setup(r),!r.partial&&t.useData&&(o=p(e,o));var a=void 0,u=t.useBlockParams?[]:void 0;function s(e){return""+t.main(n,e,n.helpers,n.partials,o,u,a)}return t.useDepths&&(a=r.depths?e!=r.depths[0]?[e].concat(r.depths):r.depths:[e]),(s=d(t.main,s,n,r.depths||[],o,u))(e,r)}return i.isTop=!0,i._setup=function(a){if(a.partial)n.protoAccessControl=a.protoAccessControl,n.helpers=a.helpers,n.partials=a.partials,n.decorators=a.decorators,n.hooks=a.hooks;else{var i=o.extend({},e.helpers,a.helpers);!function(t,e){Object.keys(t).forEach((function(r){var n=t[r];t[r]=function(t,e){var r=e.lookupProperty;return s.wrapHelper(t,(function(t){return o.extend({lookupProperty:r},t)}))}(n,e)}))}(i,n),n.helpers=i,t.usePartial&&(n.partials=n.mergeIfNeeded(a.partials,e.partials)),(t.usePartial||t.useDecorators)&&(n.decorators=o.extend({},e.decorators,a.decorators)),n.hooks={},n.protoAccessControl=l.createProtoAccessControl(a);var c=a.allowCallsToHelperMissing||r;u.moveHelperToHooks(n,"helperMissing",c),u.moveHelperToHooks(n,"blockHelperMissing",c)}},i._child=function(e,r,o,i){if(t.useBlockParams&&!o)throw new a.default("must pass block params");if(t.useDepths&&!i)throw new a.default("must pass parent depths");return c(n,e,t[e],r,0,o,i)},i},e.wrapProgram=c,e.resolvePartial=function(t,e,r){return t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name],t},e.invokePartial=function(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var u=void 0;if(r.fn&&r.fn!==f&&function(){r.data=i.createFrame(r.data);var t=r.fn;u=r.data["partial-block"]=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=i.createFrame(r.data),r.data["partial-block"]=n,t(e,r)},t.partials&&(r.partials=o.extend({},r.partials,t.partials))}(),void 0===t&&u&&(t=u),void 0===t)throw new a.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)},e.noop=f;var n,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(2392)),a=(n=r(8728))&&n.__esModule?n:{default:n},i=r(2067),u=r(2638),s=r(5005),l=r(6293);function c(t,e,r,n,o,a,i){function u(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=i;return!i||e==i[0]||e===t.nullContext&&null===i[0]||(u=[e].concat(i)),r(t,e,t.helpers,t.partials,o.data||n,a&&[o.blockParams].concat(a),u)}return(u=d(r,u,t,i,n,a)).program=e,u.depth=i?i.length:0,u.blockParams=o||0,u}function f(){return""}function p(t,e){return e&&"root"in e||((e=e?i.createFrame(e):{}).root=t),e}function d(t,e,r,n,a,i){if(t.decorator){var u={};e=t.decorator(e,u,r,n&&n[0],a,i,n),o.extend(e,u)}return e}},5558:function(t,e){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},2392:function(t,e){"use strict";e.__esModule=!0,e.extend=i,e.indexOf=function(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return o.test(t)?t.replace(n,a):t},e.isEmpty=function(t){return!t&&0!==t||!(!l(t)||0!==t.length)},e.createFrame=function(t){var e=i({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},n=/[&<>"'`=]/g,o=/[&<>"'`=]/;function a(t){return r[t]}function i(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var u=Object.prototype.toString;e.toString=u;var s=function(t){return"function"==typeof t};s(/x/)&&(e.isFunction=s=function(t){return"function"==typeof t&&"[object Function]"===u.call(t)}),e.isFunction=s;var l=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===u.call(t)};e.isArray=l},202:function(t,e,r){t.exports=r(6834).default},5666:function(t){var e=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),i=new L(n||[]);return a._invoke=function(t,e,r){var n=f;return function(o,a){if(n===d)throw new Error("Generator is already running");if(n===h){if("throw"===o)throw a;return j()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=k(i,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var s=c(t,e,r);if("normal"===s.type){if(n=r.done?h:p,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=h,r.method="throw",r.arg=s.arg)}}}(t,r,i),a}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",h="completed",v={};function m(){}function g(){}function y(){}var w={};w[a]=function(){return this};var _=Object.getPrototypeOf,b=_&&_(_(S([])));b&&b!==r&&n.call(b,a)&&(w=b);var x=y.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,a,i,u){var s=c(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,u)}),(function(t){r("throw",t,i,u)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,u)}))}u(s.arg)}var o;this._invoke=function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}}function k(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=c(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function S(t){if(t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}return{next:j}}function j(){return{value:e,done:!0}}return g.prototype=x.constructor=y,y.constructor=g,g.displayName=s(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},P(O.prototype),O.prototype[i]=function(){return this},t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(x),s(x,u,"Generator"),x[a]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),M(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;M(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:S(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},6602:function(t,e,r){t.exports=r},7619:function(t,e,r){t.exports=r},8864:function(t){"use strict";t.exports=AJS}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},"undefined"!=typeof AJS&&(r.p=AJS.contextPath()+"/s/d35a8556-7a9b-4025-bed3-15c5e313bf96/_/download/resources/net.customware.confluence.plugin.scaffolding:assets-d35a8556-7a9b-4025-bed3-15c5e313bf96/"),function(){"use strict";function t(t,e,r,n,o,a,i){try{var u=t[a](i),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function e(e){return function(){var r=this,n=arguments;return new Promise((function(o,a){var i=e.apply(r,n);function u(e){t(i,o,a,u,s,"next",e)}function s(e){t(i,o,a,u,s,"throw",e)}u(void 0)}))}}var n,o,a=r(7757),i=r.n(a),u=(r(6602),r(7619),r(2975)),s=r.n(u),l=r(8864),c=r.n(l),f=r(1211),p="scaffolding/1.0";function d(){return(d=e(i().mark((function t(){var e,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,f.initializeRocket)(n,o),t.next=3,(0,f.getHasUserSeen)(n,c().Meta.get("remote-user-key"),f.APPCUES_INLINE_DIALOG_POPUP);case 3:e=t.sent,r=e.hasUserSeen,(0,f.insertNewContainer)(s()({status:!r})),(0,f.insertNewHandler)(h),(0,f.insertRestPathOfPluginConsumer)(p);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function h(){var t=c().Meta.get("base-url"),r="".concat(t,"/rest/").concat(p,"/on-boarding/analytics"),o="".concat(t,"/rest/").concat(p,"/on-boarding/appcues/identity");$(".scaffolding-ok-btn").click(function(){var t=e(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),(0,f.hideDialog)(),t.next=4,(0,f.fetchAppcuesScript)("//fast.appcues.com/23212.js");case 4:(0,f.initAppcues)(o),window.Appcues.show("-KveMbgeVC5rAiEGAHqG"),(0,f.sendReportingAnalytics)(r,"OK_ON_BOARDING"),(0,f.markUserSeen)(n,c().Meta.get("remote-user-key"),f.APPCUES_INLINE_DIALOG_POPUP),(0,f.markUserSeen)(n,c().Meta.get("remote-user-key"),f.APPCUES_TUTORIAL_SLIDEOUT);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}c().bind("rte-ready",(function(){n="".concat(c().Meta.get("base-url"),"/rest/scaffolding/1.0/on-boarding/seen"),o="".concat(c().Meta.get("base-url"),"/rest/plugins/1.0/net.customware.confluence.plugin.scaffolding-key/media/plugin-icon"),function(){d.apply(this,arguments)}()}))}()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.k15t.scroll.scroll-exporter-extensions:macro-ui-resource', location = 'com/k15t/scroll/exporter/macro/ui/ext-macro-bootstrap.js' */
require(['ajs'], function(AJS) {
    function initExportersMacro() {
        'use strict';

        // register custom dialog for macro editor

        AJS.MacroBrowser.setMacroJsOverride('scroll-tablelayout', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-tablelayout-macro-editor-dialog', null,
                    'k15t-ext-tablelayout-macro-editor')
            }
        });

        AJS.MacroBrowser.setMacroJsOverride('scroll-ignore', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-content-visibility-macro-editor-dialog', 'scroll-ignore',
                    'k15t-ext-content-visibility-macro-editor')
            }
        });

        AJS.MacroBrowser.setMacroJsOverride('scroll-ignore-inline', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-content-visibility-macro-editor-dialog', 'scroll-ignore-inline',
                    'k15t-ext-content-visibility-macro-editor')
            }
        });

        AJS.MacroBrowser.setMacroJsOverride('scroll-only', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-content-visibility-macro-editor-dialog', 'scroll-only',
                    'k15t-ext-content-visibility-macro-editor')
            }
        });

        AJS.MacroBrowser.setMacroJsOverride('scroll-only-inline', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-content-visibility-macro-editor-dialog', 'scroll-only-inline',
                    'k15t-ext-content-visibility-macro-editor')
            }
        });

        AJS.MacroBrowser.setMacroJsOverride('scroll-exportbutton', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-export-button-macro-editor-dialog', 'scroll-exportbutton',
                    'k15t-ext-exportbutton-macro-editor')
            }
        });

        AJS.MacroBrowser.setMacroJsOverride('scroll-export-button', {
            opener: function(macro) {
                openMacroEditor(macro, 'ext-export-button-macro-editor-dialog', 'scroll-export-button',
                    'k15t-ext-exportbutton-macro-editor')
            }
        });

    }

    function openMacroEditor(macro, appName, macroName, dialogId) {
        window['com.k15t.scroll.scroll-exporter-extensions:app-loaders']['k15t-cxp-macro-editor-dialog'](macro, appName, macroName,
            dialogId);
    }

    AJS.toInit(function() {

        'use strict';

        if (!AJS.Editor.currentEditMode) {
            AJS.bind('init.rte', initExportersMacro);
        } else {
            initExportersMacro();
        }
    });
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'eps.focuspro.EasyDropdownMenu:dropdown-capabilities-js', location = 'js/edm-DropdownInEditorHandler.js' */
AJS.bind("init.rte",function(){$("body").is(".contenteditor")&&AJS.$(window).on("created.property-panel",function(){var e=Confluence.PropertyPanel.current,t=e.anchor,n=t.dataset.macroName;n.startsWith("easy-dropdown-menu")&&"easy-dropdown-menu-edit-mode"!==n&&createDropdownInPropertyPanel(e,t,n)})});var createDropdownInPropertyPanel=function(e,t,n){var r=getSpecificMacroObject(n),o=Confluence.MacroParameterSerializer.deserialize(t.dataset.macroParameters),a=addSpanToPropertyPanel(e,getSpanClassName(o,r.placeholderCssClass));r.createSelect2Function(t,r,a,o)},getSpecificMacroObject=function(e){switch(e){case"easy-dropdown-menu":return{createSelect2Function:createSelect2ForPropertyPanelNonPredefined,placeholderCssClass:"edm-dropdown-menu-non-predefined",adjustParametersFunction:adjustParametersNonPredefined,createDropdownFunction:createDropdownMenuNonPredefined};case"easy-dropdown-menu-predefined":return{createSelect2Function:createSelect2ForPropertyPanelPredefined,placeholderCssClass:"edm-dropdown-menu",adjustParametersFunction:adjustParametersPredefined,createDropdownFunction:createDropdownMenu};case"easy-dropdown-menu-status":return{createSelect2Function:createSelect2ForPropertyPanelStatus,placeholderCssClass:"",adjustParametersFunction:adjustParametersStatus,createDropdownFunction:createStatusDropdown}}},addSpanToPropertyPanel=function(e,t){var n=document.createElement("span");return $(n).addClass(t),e.panel.children("div.aui-property-panel").children("div.panel-buttons").append(n),n},getSpanClassName=function(e,t){"true"===e["multi-dropdown"]&&(t=t.concat("-multiple"));var n="edmSelect2Editor "+t;return e["css-style-class"]&&(n=n.concat(" "+e["css-style-class"])),n},createSelect2ForPropertyPanelNonPredefined=function(e,t,n,r){createSelect2(e,t,n,r)},createSelect2ForPropertyPanelPredefined=function(e,t,n,r){Edm.Rest.getTextSet(r["set-id"]).done(function(o){createSelect2(e,t,n,r,o)})},createSelect2ForPropertyPanelStatus=function(e,t,n,r){Edm.Rest.getStatusSet(r["set-id"]).done(function(o){createSelect2(e,t,n,r,o)})},createSelect2=function(e,t,n,r,o){var a=getAdjustedParametersForSelect2(r,t.adjustParametersFunction,o);t.createDropdownFunction(n,a.options,a.currentOptions,a.isMultiSelect),addClickHandlerForSingleSelect(n,a.isMultiSelect),addChangeListenerToDropdown(e,n,r)},getAdjustedParametersForSelect2=function(e,t,n){var r={};return r.isMultiSelect="true"===e["multi-dropdown"],r.isIncludeBlank="false"!==e["include-blank"]&&!e["multi-dropdown"],t(r,e,n),r},adjustParametersNonPredefined=function(e,t){t["current-option"]?e.currentOptions=t["current-option"]:e.currentOptions="",t.options?e.options=t.options.split(","):e.options=["Yes","No"],e.isIncludeBlank&&(e.options=[" "].concat(e.options))},adjustParametersPredefined=function(e,t,n){t["option-id"]?e.currentOptions=getCurrentOptionsArray(t["option-id"],n):e.currentOptions=[],e.options=n.optionsList,e.isIncludeBlank&&(e.options=[{id:"",name:""}].concat(e.options))},adjustParametersStatus=function(e,t,n){e.options=n.optionsList,t["option-id"]?e.currentOptions=t["option-id"]:e.currentOptions=e.options[0].id},getCurrentOptionsArray=function(e,t){return e.split(",").map(function(e){return t.optionsList.find(function(t){return t.id===e})||{id:e,name:"OptionNotFound"}})},addClickHandlerForSingleSelect=function(e,t){t||($(e).select2("disable"),$(e).select2("container").on("click",function(){$(e).select2("enable"),$(e).select2("open")}),$(e).on("select2-close",function(){$(e).select2("disable")}))},addChangeListenerToDropdown=function(e,t,n){$(t).on("change",function(){updateParameters(e.dataset.macroName,t,n),updateMacro(e,n)})},updateParameters=function(e,t,n){var r=$(t).select2("data");if("true"!==n["multi-dropdown"]&&(r=[r]),"easy-dropdown-menu-status"===e)n["current-option-value"]=r[0].text.slice(r[0].text.indexOf(">")+1,-7),n["option-id"]=r[0].id;else{var o=r.map(function(e){return e.text}).join(", "),a=r.map(function(e){return e.id}).join(",");"easy-dropdown-menu"===e?updateParameter(n,"current-option",a):"easy-dropdown-menu-predefined"===e&&(updateParameter(n,"current-option-value",o),updateParameter(n,"option-id",a))}},updateParameter=function(e,t,n){""===n?delete e[t]:e[t]=n},updateMacro=function(e,t){Confluence.PropertyPanel.destroy();var n={contentId:Confluence.Editor.getContentId(),macro:{name:e.dataset.macroName,params:t,body:""}};tinymce.confluence.MacroUtils.insertMacro(n,e).then(function(e){var t={originalHeight:!1,anchorIframe:AJS.Rte.getEditorFrame()};Confluence.PropertyPanel.createFromButtonModel("macro",e,getDefaultButtonsArray(e),t)})},getDefaultButtonsArray=function(e){var t=[];return t.push({className:"macro-placeholder-property-panel-edit-button",text:"Edit",click:function(){AJS.Confluence.PropertyPanel.destroy(),tinymce.confluence.macrobrowser.editMacro(e)}}),t.push({className:"macro-placeholder-property-panel-remove-button",text:"Remove",click:function(){AJS.Confluence.PropertyPanel.destroy(),AJS.Rte.getEditor().execCommand("mceConfRemoveMacro",e)}}),t};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.489a76bc13', location = 'aui.chunk.c54fc404e557006fc7e9--1288594a11832eebcb23.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.489a76bc13"],{Jqxc:function(t,e,i){"use strict";i.r(e);var s=i("QFBp"),r=i("qT0E"),u=i.n(r),a=i("KloK"),h=u.a.Collection.extend({initialize:function(t,e){e||(e={}),e.matcher&&(this.matcher=e.matcher),e.model&&(this.model=e.model),this._idAttribute=(new this.model).idAttribute,this._maxResults=e.maxResults||5,this._queryData=e.queryData||{},this._queryParamKey=e.queryParamKey||"q",this._queryEndpoint=e.queryEndpoint||"",this.value=null,this.queryCache={},this.activeQueryCount=0,Object(s.bindAll)(this,"query","respond")},url:function(){return this._queryEndpoint},query:function(t){var e,i;this.value=t,i=this.getFilteredResults(t),this.respond(t,i),t&&this._queryEndpoint&&!this.hasQueryCache(t)&&this.shouldGetMoreResults(i)&&(e=this.fetch(t),this.activeQueryCount++,this.trigger("activity",{activity:!0}),e.always((()=>{this.activeQueryCount--,this.trigger("activity",{activity:!!this.activeQueryCount})})),e.done(((e,i,s)=>{this.addQueryCache(t,e,s)})),e.done((()=>{t=this.value,i=this.getFilteredResults(t),this.respond(t,i)})))},getQueryData:function(t){var e=Object(s.isFunction)(this._queryData)?this._queryData(t):this._queryData,i=Object(s.extend)({},e);return i[this._queryParamKey]=t,i},fetch:function(t){var e={add:!0,update:!0,remove:!1,data:this.getQueryData(t)};return u.a.Collection.prototype.fetch.call(this,e)},respond:function(t,e){return this.trigger("respond",{query:t,results:e}),e},matcher:function(t,e){},getFilteredResults:function(t){var e=[];return t?(e=this.filter((function(e){return!!this.matcher(e,t)}),this),this._maxResults&&(e=Object(s.first)(e,this._maxResults)),e):e},addQueryCache:function(t,e,i){var r=this.queryCache,u=this.parse(e,i);r[t]=Object(s.pluck)(u,this._idAttribute)},hasQueryCache:function(t){return this.queryCache.hasOwnProperty(t)},findQueryCache:function(t){return this.queryCache[t]},shouldGetMoreResults:function(t){return t.length<this._maxResults},setMaxResults:function(t){this._maxResults=t,this.value&&this.respond(this.value,this.getFilteredResults(this.value))}});Object(a.default)("ProgressiveDataSet",h),e.default=h}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.single-select', location = 'aui.chunk.4497f9d1ebeae9bd7303--e9164fa8dc9b5c097985.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.single-select"],{lotK:function(e,t,i){"use strict";i.r(t),i.d(t,"SelectEl",(function(){return z}));i("6fSn");var n=i("+x/D"),u=(i("aGv7"),i("HH5i")),s=(i("oSOL"),i("4dFR")),a=i("l3AF"),l=Object(s.default)("aui-option",{created:function(e){Object.defineProperty(e,"value",{get:function(){return e.getAttribute("value")||Object(a.default)(this.textContent)},set:function(t){e.setAttribute("value",t)}})},prototype:{serialize:function(){var e={};return this.hasAttribute("img-src")&&(e["img-src"]=encodeURI(this.getAttribute("img-src"))),e.value=this.value,e.label=Object(a.default)(this.textContent),e}}}),o=i("TmQU"),c=i("P3rJ"),r=i("KloK"),d=i("+ay7"),h=i("Jqxc"),g=i("TK3y"),f=i("qT0E"),p=i.n(f).a.Model.extend({idAttribute:"label",getLabel:function(){return this.get("label")||this.get("value")}});function b(){this._suggestions=[],this._activeIndex=-1}b.prototype={onChange:function(){},onHighlightChange:function(){},get:function(e){return this._suggestions[e]},set:function(e){var t=this._suggestions;return this._suggestions=e||[],this.onChange(t),this},getNumberOfResults:function(){return this._suggestions.length},setHighlighted:function(e){if(e)for(var t=0;t<this._suggestions.length;t++)this._suggestions[t].id===e.id&&this.highlight(t);return this},highlight:function(e){return this._activeIndex=e,this.onHighlightChange(),this},highlightPrevious:function(){var e=this._activeIndex,t=0===e?e:e-1;return this.highlight(t),this},highlightNext:function(){var e=this._activeIndex,t=e===this._suggestions.length-1?e:e+1;return this.highlight(t),this},highlighted:function(){return this.get(this._activeIndex)},highlightedIndex:function(){return this._activeIndex}};var v=b,_=i("vbuG"),m=i("jEnx");function y(e,t){return e+"-"+t}function k(e,t){this.el=e,this.anchor=t}function w(e){Object(n.default)(e).find(".aui-select-active").removeClass("aui-select-active")}k.prototype={render:function(e,t,i){this.currListId=i;var n="";if(e.length){var s=t;e.forEach((function(e){var t=e.getLabel(),a=e.get("img-src"),l=a?'<img src="'.concat(encodeURI(a),'"/>'):"",o=e.get("new-value")?" (<em>".concat("new value","</em>)"):"";n+='<li role="option" class="aui-select-suggestion" id="'.concat(y(i,s),'">').concat(l).concat(t).concat(o,"</li>"),s++})),t?this.el.querySelector("ul").innerHTML+=n:this.el.querySelector("ul").innerHTML=n}else t||(this.el.querySelector("ul").innerHTML='<li role="option" class="aui-select-no-suggestions">'.concat("No suggestions","</li>"));return this},setActive:function(e){w(this.el),Object(n.default)(this.el).find("#"+y(this.currListId,e)).addClass("aui-select-active")},getActive:function(){return this.el.querySelector(".aui-select-active")},show:function(){var e;e=this,Object(n.default)(e.el).css("min-width",Object(n.default)(e.anchor).outerWidth()),Object(m.default)(this.el).show(),function(e){e.anchor&&!e._auiAlignment&&(e._auiAlignment=new _.default(e.el,e.anchor,{flipContainer:"scrollParent",positionFixed:!0,preventOverflow:!1,flip:!1})),e._auiAlignment&&(e._auiAlignment.enable(),e._auiAlignment.scheduleUpdate())}(this)},hide:function(){var e;w(this.el),Object(m.default)(this.el).hide(),(e=this)._auiAlignment&&e._auiAlignment.disable()},destroy:function(){var e;this.hide(),(e=this)._auiAlignment&&(e._auiAlignment.destroy(),delete e._auiAlignment),delete this.currListId},isVisible:function(){return Object(n.default)(this.el).is(":visible")}};var O=k,A=i("gjsO"),x=i.n(A)()('\n    <input type="text" class="text" autocomplete="off" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false">\n    <select></select>\n    <datalist>\n        <content select="aui-option"></content>\n    </datalist>\n    <button class="aui-button" role="button" tabindex="-1" type="button"></button>\n    <div class="aui-popover" role="listbox" data-aui-alignment="bottom left" hidden>\n        <ul class="aui-optionlist" role="presentation"></ul>\n    </div>\n    <div class="aui-select-status assistive" aria-live="polite" role="status"></div>\n'),j=i("OEua"),S=i("LTUc"),C=i("I7um");function I(e){e._select.selectedIndex=-1,function(e){e._input.removeAttribute("style"),Object(n.default)(e._input).removeClass("aui-select-has-inline-image")}(e)}function M(e){return e._suggestionModel.getNumberOfResults()}function q(e,t){return 0===e.get("label").toLowerCase().indexOf(t.toLowerCase())}function E(e){e._suggestionsView.hide(),e._input.setAttribute("aria-expanded","false")}function T(e){var t=M(e)?0:-1;e._suggestionModel.highlight(t),E(e)}function V(e,t,i){e._autoHighlight=t,void 0===i&&(i=e._input.value),e._progressiveDataSet.query(i)}function D(e){var t=e._suggestionModel.highlighted()&&e._suggestionModel.highlighted().get("img-src");t&&function(e,t){Object(n.default)(e._input).addClass("aui-select-has-inline-image"),e._input.setAttribute("style","background-image: url("+encodeURI(t)+")")}(e,t)}function L(e,t){if(t){var i,n=document.createElement("option"),u=e._select,s=t.get("value")||t.get("label"),a=(i=t.getLabel(),(new DOMParser).parseFromString(i,"text/html").documentElement.textContent);n.setAttribute("selected",""),n.setAttribute("value",s),n.textContent=a,e._input.value=a,u.innerHTML="",u.options.add(n),u.dispatchEvent(new c.default("change",{bubbles:!0}))}}function H(e){L(e,e._suggestionModel.highlighted()),D(e),T(e)}function P(e){return new p(e.serialize())}function N(e){for(var t=[],i=0;i<e._datalist.children.length;i++){var n=e._datalist.children[i];t.push(P(n))}return t}function R(e){var t=e._dropdown.querySelector(".aui-select-active");return t&&t.id}function U(e,t){return n.default.map(t,(function(e){return e.id})).indexOf(e)}function F(e){e._progressiveDataSet=new h.default(N(e),{model:p,matcher:q,queryEndpoint:e._queryEndpoint,maxResults:20}),e._isSync=!e._queryEndpoint,e._progressiveDataSet.on("activity",(function(){e._progressiveDataSet.activeQueryCount&&!e._isSync?(!function(e){e._button.isBusy()||(e._button.busy(),e._input.setAttribute("aria-busy","true"),e._dropdown.setAttribute("aria-busy","true"))}(e),Object(g.default)(e).set("should-flag-new-suggestions",!1)):(!function(e){e._button.idle(),e._input.setAttribute("aria-busy","false"),e._dropdown.setAttribute("aria-busy","false")}(e),Object(g.default)(e).set("should-flag-new-suggestions",!0))})),e._progressiveDataSet.on("respond",(function(t){if(t.query&&!e._input.value)return;if(Object(g.default)(e).get("should-cancel-response"))return void(e._progressiveDataSet.activeQueryCount||Object(g.default)(e).set("should-cancel-response",!1));t.query||(t.results=N(e));var i=-1!==U(e._input.value,t.results),n=!e._input.value;if(!e.hasAttribute("can-create-values")||i||n||t.results.push(function(e){var t=new l;t.setAttribute("value",e._input.value);var i=P(t);return i.set("new-value",!0),i}(e)),!Object(g.default)(e).get("should-include-selected")){var s=U(e.value,t.results);s>=0&&t.results.splice(s,1)}const a=function(e,t){const i=e._suggestionModel.getNumberOfResults();return e._suggestionModel.set(),e._suggestionModel.set(t.results),i!==e._suggestionModel.getNumberOfResults()}(e,t),o=e._suggestionModel.highlighted()||t.results[0];e._autoHighlight&&(e._suggestionModel.setHighlighted(o),setTimeout((function(){e._input.setAttribute("aria-activedescendant",R(e))}),50)),e._input.setAttribute("aria-expanded","true"),!e._isSync&&a&&e._suggestionsView.getActive()&&Object(g.default)(e).get("should-flag-new-suggestions")&&(e.querySelector(".aui-select-status").innerHTML="New suggestions added. Please use the up and down arrows to select."),e._suggestionsView.show()}))}function K(e){var t=e.value?"":e._input.value,i=""===e._input.value;Object(g.default)(e).set("should-include-selected",i),V(e,!0,t)}function W(e){(function(e){return e._progressiveDataSet.activeQueryCount>0})(e)&&Object(g.default)(e).set("should-cancel-response",!0)}function J(e){if(e._select.selectedIndex>=0)return e._select.options[e._select.selectedIndex].textContent}function Q(e){W(e),function(e){var t=!e.hasAttribute("no-empty-values"),i=!e._input.value,n=e._input.value!==J(e);if(i||n)if(t)I(e);else{var u=J(e);void 0===u?I(e):e._input.value=u}}(e),function(e){e._suggestionModel.highlight(-1)}(e),E(e)}const G=Object(s.default)("aui-select",{template:x,created:function(e){e._listId=Object(j.default)(),e._input=e.querySelector("input"),e._select=e.querySelector("select"),e._dropdown=e.querySelector(".aui-popover"),e._datalist=e.querySelector("datalist"),e._button=e.querySelector("button"),e._suggestionsView=new O(e._dropdown,e._input),e._suggestionModel=new v,e._suggestionModel.onChange=function(t){var i=[];e._suggestionModel._suggestions.forEach((function(e){t.some((function(t){return e.id===t.id}))||i.push(e)})),e._suggestionsView.render(i,t.length,e._listId)},e._suggestionModel.onHighlightChange=function(){var t=e._suggestionModel.highlightedIndex();e._suggestionsView.setActive(t),e._input.setAttribute("aria-activedescendant",R(e))}},attached:function(e){s.default.init(e),F(e),function(e){e._dropdown.id=e._listId,e.querySelector("button").setAttribute("aria-controls",e._listId)}(e),e._input.setAttribute("aria-controls",e._listId),e.setAttribute("tabindex","-1"),function(e){Object(n.default)(e._dropdown).on("mouseover","li",(function(t){M(e)&&e._suggestionModel.highlight(Object(n.default)(t.target).index())}))}(e),function(e){let t=!1;Object(n.default)(document).on("aui-close-layers-on-outer-click.single-select",(e=>{t&&(e.preventDefault(),t=!1)})),Object(n.default)(e._dropdown).on("mousedown","li",(function(i){if(!M(e))return!1;e._suggestionModel.highlight(Object(n.default)(i.target).index()),H(e),e._suggestionsView.hide(),Object(n.default)(e).closest(".aui-layer").length>0&&(t=!0),e._input.removeAttribute("aria-activedescendant")}))}(e),function(e){var t=e._datalist.querySelector("aui-option[selected]");t&&L(e,P(t))}(e),T(e),D(e)},detached:function(e){Object(n.default)(document).off("aui-close-layers-on-outer-click"),Object(C.ifGone)(e).then((()=>{E(e),e._suggestionsView.destroy()}))},attributes:{id(e,t){e.id&&(e.querySelector("input").id=t.newValue+S.INPUT_SUFFIX)},name(e,t){e.querySelector("select").setAttribute("name",t.newValue)},placeholder(e,t){e.querySelector("input").setAttribute("placeholder",t.newValue)},src(e,t){e._queryEndpoint=t.newValue}},events:{"blur input":function(e){Q(e)},"mousedown button":function(e){document.activeElement!==e._input||e._dropdown.hasAttribute("hidden")||Object(g.default)(e).set("prevent-open-on-button-click",!0)},"click input":function(e){K(e)},"click button":function(e){var t=Object(g.default)(e);t.get("prevent-open-on-button-click")?t.set("prevent-open-on-button-click",!1):(Object(g.default)(e).set("button-clicked-prevent-dropdown-hide",!0),e.focus())},input:function(e){e._input.value?(Object(g.default)(e).set("should-include-selected",!0),V(e,!0)):Object(g.default)(e).get("button-clicked-prevent-dropdown-hide")?Object(g.default)(e).set("button-clicked-prevent-dropdown-hide",!1):E(e)},"keydown input":function(e,t){var i=e._input.value,n=!1;if(t.keyCode===d.default.ESCAPE)return W(e),void E(e);e._suggestionsView.isVisible()&&M(e)?t.keyCode===d.default.ENTER?(W(e),H(e),t.preventDefault()):t.keyCode===d.default.TAB?(!function(e){e._suggestionsView.isVisible()&&H(e)}(e),n=!0):t.keyCode===d.default.UP?(e._suggestionModel.highlightPrevious(),t.preventDefault()):t.keyCode===d.default.DOWN&&(e._suggestionModel.highlightNext(),t.preventDefault()):t.keyCode!==d.default.UP&&t.keyCode!==d.default.DOWN||(K(e),t.preventDefault()),n=n||t.defaultPrevented,setTimeout((function(){e._input.value===i||n||e.dispatchEvent(new c.default("input",{bubbles:!0}))}),0)}},prototype:{get value(){var e=this._select.options[this._select.selectedIndex];return e?e.value:""},set value(e){if(""===e)(n=this)._input.value="",n._select.innerHTML="";else if(e){var t=this._progressiveDataSet,i=t.findWhere({value:e})||t.findWhere({label:e});!i&&this.hasAttribute("can-create-values")&&(i=new p({value:e,label:e})),L(this,i)}var n;return this},get displayValue(){return this._input.value},blur:function(){return this._input.blur(),Q(this),this},focus:function(){return this._input.focus(),K(this),this}}});Object(o.default)("aui/select",G),Object(r.default)("select",G);var z=G}},[["lotK","runtime","aui.splitchunk.vendors--894c8113d9","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.vendors--20e849aab3","aui.splitchunk.0d131bcbf1","aui.splitchunk.fbbef27525","aui.splitchunk.444efc83be","aui.splitchunk.739b9ec8cc","aui.splitchunk.056561461c","aui.splitchunk.949297951c","aui.splitchunk.dd803a46b4","aui.splitchunk.994e478d48","aui.splitchunk.d7c46c2734","aui.splitchunk.e54c7c7304","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f1e06f97a4","aui.splitchunk.479fe6ee76","aui.splitchunk.f673ef53ac","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.5f851f97df","aui.splitchunk.462ee5f9ef","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.bff3715233","aui.splitchunk.26116b3cbd","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.084821f40b","aui.splitchunk.2e16019fb9","aui.splitchunk.baa83dbaf9","aui.splitchunk.f154095da3","aui.splitchunk.20e849aab3","aui.splitchunk.86ad04cc86","aui.splitchunk.4331a05956","aui.splitchunk.489a76bc13","aui.splitchunk.af1935061c"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/editor/soy/editor-main.soy' */
// This file was automatically generated from editor-main.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.editor == 'undefined') { org.swift.confluence.editor = {}; }


org.swift.confluence.editor.editorMain = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<section role="dialog" class="appfire aui-dialog2 aui-dialog2-xlarge aui-layer" data-aui-modal="true" aria-hidden="true"><form class="aui top-label"><!-- Dialog header -->' + org.swift.confluence.editor.editorHeader(opt_data) + '<div class="aui-dialog2-content"><div class="aui-group"><div class="aui-item appfire-navigation">' + org.swift.confluence.editor.editorNavigation(opt_data) + '</div><div class="aui-item appfire-content-panes">' + org.swift.confluence.editor.editorPanes(opt_data) + '</div>' + ((opt_data.showPreview) ? '<div class="aui-item appfire-preview-actions" style="position:relative">' + org.swift.confluence.editor.editorPreview(opt_data) + '</div><div class="aui-item appfire-preview-container" style="display:none"><div class="appfire-preview-header macro-preview-header"><span class="appfire-preview-title">Preview</span><button class="appfire-preview-refresh aui-button"><span class="aui-icon aui-icon-small aui-iconfont-refresh aui-iconfont-refresh-small"></span>&nbsp;&nbsp;Refresh</button></div><div class="appfire-preview-data"></div><div class="appfire-preview-loading" style="display:none"><span class="aui-icon aui-icon-large aui-icon-wait">Preview loading</span> Please wait while preview loads...</div></div>' : '') + '</div></div><!-- Dialog footer -->' + org.swift.confluence.editor.editorFooter({appVendor: 'Appfire'}) + '</form></section>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorMain.soyTemplateName = 'org.swift.confluence.editor.editorMain';
}


org.swift.confluence.editor.editorHeader = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml(opt_data.title) + '</h2></header>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorHeader.soyTemplateName = 'org.swift.confluence.editor.editorHeader';
}


org.swift.confluence.editor.editorNavigation = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<nav class="primary">';
  var itemList25 = opt_data.navigation.primary;
  var itemListLen25 = itemList25.length;
  for (var itemIndex25 = 0; itemIndex25 < itemListLen25; itemIndex25++) {
    var itemData25 = itemList25[itemIndex25];
    output += '<div class="nav-item" data-index="' + soy.$$escapeHtml(itemIndex25) + '" ' + ((itemData25.activePanel) ? 'data-active-panel' : '') + ' title="' + soy.$$escapeHtml(itemData25.name) + '"><img src="' + soy.$$escapeHtml(itemData25.icon) + '"/></div>';
  }
  output += '</nav><nav class="secondary">';
  var itemList39 = opt_data.navigation.secondary;
  var itemListLen39 = itemList39.length;
  for (var itemIndex39 = 0; itemIndex39 < itemListLen39; itemIndex39++) {
    var itemData39 = itemList39[itemIndex39];
    output += '<div class="nav-item" title="' + soy.$$escapeHtml(itemData39.name) + '" data-url="' + soy.$$escapeHtml(itemData39.url) + '"><img src="' + soy.$$escapeHtml(itemData39.icon) + '"/></div>';
  }
  output += '</nav>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorNavigation.soyTemplateName = 'org.swift.confluence.editor.editorNavigation';
}


org.swift.confluence.editor.editorPreview = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<nav class="primary"><a href="#" title="Show preview" class="appfire-preview-show"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-preview-48.png")></a><a href="#" title="Hide preview" class="appfire-preview-hide"  style="display:none"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-preview-48.png")></a></nav><nav class="secondary"><a href="#" title="Show Preview" class="appfire-preview-show"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-expandLeft-48.png")></a><a href="#" title="Hide Preview" class="appfire-preview-hide" style="display:none"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/org.swift.confluence.tablesorter/editor/img/icon-expandRight-48.png")></a></nav>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorPreview.soyTemplateName = 'org.swift.confluence.editor.editorPreview';
}


org.swift.confluence.editor.editorPanes = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var itemList60 = opt_data.navigation.primary;
  var itemListLen60 = itemList60.length;
  for (var itemIndex60 = 0; itemIndex60 < itemListLen60; itemIndex60++) {
    var itemData60 = itemList60[itemIndex60];
    output += '<div class="content-panel"><h1>' + soy.$$escapeHtml(itemData60.name) + '</h1>' + soy.$$filterNoAutoescape(itemData60.panel) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorPanes.soyTemplateName = 'org.swift.confluence.editor.editorPanes';
}


org.swift.confluence.editor.editorFooter = function(opt_data, opt_ignored) {
  return '<footer class="aui-dialog2-footer"><!-- Actions to render on the right of the footer --><aui-inline-dialog id="editor-error-msg" class="aui-help" alignment="bottom center"><div id="default-error-content"><p class="title"><strong>' + soy.$$escapeHtml('Configuration error!') + '</strong></p><p class="body">And this is just content in a Default message.</p></div></aui-inline-dialog><div class="aui-dialog2-footer-actions"><span id="show-editor-error" aria-controls="editor-error-msg" data-aui-trigger class="aui-icon aui-icon-large ' + soy.$$escapeHtml('aui-iconfont-error') + '" style="display:none"></span><button id="editor-save-button" class="aui-button aui-button-primary">Save settings</button><button id="editor-close-button" class="editor-dialog-close aui-button aui-button-link">Cancel</button></div><!-- Hint text is rendered on the left of the footer --><div class="aui-dialog2-footer-hint">' + soy.$$escapeHtml(opt_data.appVendor) + '</div></footer>';
};
if (goog.DEBUG) {
  org.swift.confluence.editor.editorFooter.soyTemplateName = 'org.swift.confluence.editor.editorFooter';
}


org.swift.confluence.editor.commonGridRowActions = function(opt_data, opt_ignored) {
  var output = '';
  var menuItemName__soy77 = opt_data.itemName ? opt_data.itemName : 'formatting';
  output += '<div class="col-1 row-actions">   \t                <!-- row actions --><button aria-controls="' + soy.$$escapeHtml(opt_data.controlId) + '" class="aui-button aui-dropdown2-trigger aui-dropdown2-trigger-arrowless aui-button-subtle aui-button-compact"><span class="aui-icon aui-icon-small aui-iconfont-more">More</span></button><aui-dropdown-menu class="row-action" id="' + soy.$$escapeHtml(opt_data.controlId) + '"><aui-item-link class="add-grid-row-above">Add ' + soy.$$escapeHtml(menuItemName__soy77) + ' above</aui-item-link><aui-item-link class="add-grid-row-below">Add ' + soy.$$escapeHtml(menuItemName__soy77) + ' below</aui-item-link><aui-item-link class="copy-grid-row">Copy ' + soy.$$escapeHtml(menuItemName__soy77) + '</aui-item-link><aui-item-link class="paste-grid-row">Paste ' + soy.$$escapeHtml(menuItemName__soy77) + '</aui-item-link>' + ((opt_data.showMoveUpDown) ? '<aui-item-link class="move-grid-row-up">Move up</aui-item-link><aui-item-link class="move-grid-row-down">Move down</aui-item-link>' : '') + '<aui-item-link class="clear-grid-row">Clear</aui-item-link><aui-item-link class="delete-grid-row">Delete</aui-item-link></aui-dropdown-menu></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.editor.commonGridRowActions.soyTemplateName = 'org.swift.confluence.editor.commonGridRowActions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/editor/soy/fields-template.soy' */
// This file was automatically generated from fields-template.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.textElement = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var id__soy3 = opt_data.id ? opt_data.id : opt_data.name;
  var inputClass__soy4 = opt_data.inputClass ? opt_data.inputClass : 'long-field';
  output += (opt_data.topLabel) ? '<div class="field-group"><label for="' + soy.$$escapeHtml(opt_data.name) + '"><span class="appfire-editor-label-span">' + soy.$$escapeHtml(opt_data.label) + '</span>' + ((opt_data.required) ? '<span class="aui-icon icon-required appfire-icon-required">required</span>' : '') + ' ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy3, helpContent: opt_data.helpContent}) + '</label><input class="text ' + soy.$$escapeHtml(inputClass__soy4) + ' ' + ((opt_data.required) ? ' appfire-editor-input-required' : '') + '" ' + ((opt_data.type) ? ' type="' + soy.$$escapeHtml(opt_data.type) + '" else type="text" ' : '') + '  id="' + soy.$$escapeHtml(id__soy3) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" ' + ((opt_data.value || opt_data.value == 0 || opt_data.value == false) ? '  value=\'' + soy.$$escapeHtml(opt_data.value) + '\' ' : '') + '  ' + ((opt_data.type == 'number') ? ' min="0" ' : '') + ' autocomplete="new-password" />  ' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div>' : '<div class="field-group"><div class="aui-group"><div class="aui-item toggle-label"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.label) + ((opt_data.required) ? '<span class="aui-icon icon-required appfire-icon-required">required</span>' : '') + ' ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy3, helpContent: opt_data.helpContent}) + '</label></div><div class="aui-item"><input class="text ' + soy.$$escapeHtml(inputClass__soy4) + ((opt_data.required) ? ' appfire-editor-input-required ' : '') + '" ' + ((opt_data.type) ? ' type="' + soy.$$escapeHtml(opt_data.type) + '" else type="text" ' : '') + ' name="' + soy.$$escapeHtml(opt_data.name) + '" id="' + soy.$$escapeHtml(id__soy3) + '" ' + ((opt_data.value || opt_data.value == 0 || opt_data.value == false) ? '  value=\'' + soy.$$escapeHtml(opt_data.value) + '\' ' : '') + ' ' + ((opt_data.type == 'number') ? ' min="0" ' : '') + '/>  </div>' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.textElement.soyTemplateName = 'org.swift.confluence.table.editor.textElement';
}


org.swift.confluence.table.editor.toggleElement = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var id__soy97 = opt_data.id ? opt_data.id : opt_data.name;
  output += '<div class="field-group"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.label) + '  ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy97, helpContent: opt_data.helpContent}) + '</label><aui-toggle class="appfire-toggle" id="' + soy.$$escapeHtml(id__soy97) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"  label="' + soy.$$escapeHtml(opt_data.label) + '"  ' + ((opt_data.value) ? ' checked ' : '') + '></aui-toggle>   ' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.toggleElement.soyTemplateName = 'org.swift.confluence.table.editor.toggleElement';
}


org.swift.confluence.table.editor.customToggleElement = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var id__soy124 = opt_data.id ? opt_data.id : opt_data.name;
  output += '<div class="field-group"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.label) + '  ' + org.swift.confluence.table.editor.addHelpContent({id: id__soy124, helpContent: opt_data.helpContent}) + '</label><div id="' + soy.$$escapeHtml(opt_data.name) + '" class="aui-buttons  appfire-custom-toggle"><input class="appfire-toggle-aui-button aui-button" aria-pressed=' + ((opt_data.value == opt_data.value1) ? ' "true" ' : ' "false" ') + ' value=\'' + soy.$$escapeHtml(opt_data.value1) + '\' readonly="readonly"/><input class="appfire-toggle-aui-button aui-button" aria-pressed=' + ((opt_data.value == opt_data.value2) ? ' "true" ' : ' "false" ') + ' value=\'' + soy.$$escapeHtml(opt_data.value2) + '\' readonly="readonly"/>   <input type="hidden" id="' + soy.$$escapeHtml(id__soy124) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" value=\'' + soy.$$escapeHtml(opt_data.value) + '\'></div>' + ((opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '') + '</div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.customToggleElement.soyTemplateName = 'org.swift.confluence.table.editor.customToggleElement';
}


org.swift.confluence.table.editor.addHelpContent = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + ((opt_data.helpContent) ? org.swift.confluence.table.editor.helpDialog({id: opt_data.id, content: opt_data.helpContent}) : '');
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.addHelpContent.soyTemplateName = 'org.swift.confluence.table.editor.addHelpContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/editor/soy/help-dialog.soy' */
// This file was automatically generated from help-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.helpDialog = function(opt_data, opt_ignored) {
  return '<a id="' + opt_data.id + 'HelpDialogLink" data-aui-trigger aria-controls="' + opt_data.id + 'HelpDialog" href="#"><span class="aui-icon aui-icon-small aui-iconfont-info">help</span></a><aui-inline-dialog id="' + opt_data.id + 'HelpDialog" class="aui-help appfire-help-dialogs" responds-to="hover"><p>' + opt_data.content + '</p></aui-inline-dialog>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.helpDialog.soyTemplateName = 'org.swift.confluence.table.editor.helpDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/table-settings-panel.soy' */
// This file was automatically generated from table-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.tableSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#tabs-table-formatting">Formatting</a></li><li class="menu-item"><a href="#tabs-table-advanced-settings">Advanced settings</a></li></ul><div class="tabs-pane active-pane" id="tabs-table-formatting"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.textElement({name: 'id', value: opt_data.id, label: 'Table id', topLabel: 'true', helpContent: 'Specify a table id for use in chart macros, Javascript, and custom styles. '}) + org.swift.confluence.table.editor.textElement({id: 'tableClass', name: 'class', value: opt_data['class'], label: 'Table class', topLabel: 'true', helpContent: 'Create custom tables with a table class along with using, for example, Space Stylesheets. '}) + org.swift.confluence.table.editor.textElement({name: 'style', value: opt_data.style, label: 'Table style', topLabel: 'true', helpContent: 'Apply styles to the table using \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCascading Style Sheets (CSS)\x3c/a\x3e. CSS is a simple mechanism for adding formatting to tables.'}) + ((opt_data.width != null) ? org.swift.confluence.table.editor.textElement({name: 'width', value: opt_data.width, label: 'Table width', topLabel: 'true'}) : '') + ((opt_data.border != null) ? org.swift.confluence.table.editor.textElement({name: 'border', value: opt_data.border, label: 'Border width', topLabel: 'true'}) : '') + '</fieldset></div></div><div class="tabs-pane" id="tabs-table-advanced-settings"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.toggleElement({name: 'allowExport', value: opt_data.allowExport, label: 'Enable download and export as attachment'}) + '<!--TODO: Remove this condition when this feature is supported for AT App too-->';
  var otherDelim__soy43 = opt_data.exportFileDelimiter == 'Comma' || opt_data.exportFileDelimiter == 'Tab' || opt_data.exportFileDelimiter == 'Semicolon' || opt_data.exportFileDelimiter == 'Space' ? false : true;
  output += '<div class="field-group"><label for="exportFileDelimiter">' + soy.$$escapeHtml('File delimiter to use when download and export is enabled. Default value is comma.') + ' </label><select class="select  appfire-export-select" name="exportFileDelimiter" id="exportFileDelimiter"><option value="Comma" ' + ((opt_data.exportFileDelimiter == 'Comma') ? 'selected' : '') + '>Comma</option><option value="Tab" ' + ((opt_data.exportFileDelimiter == 'Tab') ? 'selected' : '') + '>Tab</option><option value="Semicolon" ' + ((opt_data.exportFileDelimiter == 'Semicolon') ? 'selected' : '') + '>Semicolon</option><option value="Space" ' + ((opt_data.exportFileDelimiter == 'Space') ? 'selected' : '') + '>Space</option><option value="Other" ' + ((otherDelim__soy43) ? ' selected ' : '') + '>Other</option></select>  <input class="text appfire-export-textbox" type="text" name="exportFileDelimiterOther" id="exportFileDelimiterOther"  maxlength="1" size="1" ' + ((! otherDelim__soy43) ? ' style="display:none;" ' : '') + ' ' + ((otherDelim__soy43) ? ' value="' + soy.$$escapeHtml(opt_data.exportFileDelimiter) + '" ' : '') + '/></div>' + ((opt_data.macroName == 'table-plus') ? org.swift.confluence.table.editor.toggleElement({name: 'multiple', value: opt_data.multiple, label: 'Apply settings to nested tables'}) : '') + org.swift.confluence.table.editor.toggleElement({name: 'displayDataFilter', value: opt_data.displayDataFilter, label: 'Display data filter', helpContent: 'Enable this to see filter panel above the table to filter the data.'}) + '</fieldset></div></div></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.tableSettingsPanel.soyTemplateName = 'org.swift.confluence.table.editor.tableSettingsPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/column-settings-panel.soy' */
// This file was automatically generated from column-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.columnSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#column-formatting">Formatting</a></li><li class="menu-item"><a href="#column-totaling">Numbering & totaling</a></li><li class="menu-item"><a href="#column-sorting">Sorting</a></li></ul><div class="tabs-pane active-pane" id="column-formatting"><fieldset class="appfire-grid-set">';
  var dataColumnStylesLength__soy4 = opt_data.autoNumber ? opt_data.columnStyles.length - 1 : opt_data.columnStyles.length;
  var rowCount__soy5 = Math.max(0, Math.max(Math.max(opt_data.columnTypes.length, opt_data.columnCalculations.length), Math.max(dataColumnStylesLength__soy4, opt_data.columnAttributes.length)));
  output += '<div class="grid-bar"  ' + ((rowCount__soy5 == 0) ? ' style="display: none;" ' : '') + '><h3>Columns  ' + org.swift.confluence.table.editor.addHelpContent({name: 'columnFormatting', id: 'columnFormatting', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/KQCLMw\x22 target\x3d\x22Advanced Tables Help\x22 \x3eColumn styles\x3c/a\x3e accepts one or more \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCSS\x3c/a\x3e properties to control formatting. e.g. background:lightyellow \x3cbr/\x3e\x3cbr/\x3e\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/JICGMw\x22 target\x3d\x22Advanced Tables Help\x22 \x3eColumn type\x3c/a\x3e is used with \x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/JICGMw\x22  target\x3d\x22Advanced Tables Help\x22 \x3eTotal type\x3c/a\x3e to summarize and format the data. e.g. C\x22\x26#36;0.00\x22. Total type works only when \x3ci\x3eAuto total numeric columns\x3c/i\x3e is enabled under Numbering \x26 totaling.'}) + '</h3><div class="grid-bar-actions"><button class="aui-button add-grid-row" data-grid="#column-positions"><span class="aui-icon aui-icon-small aui-iconfont-add"></span> Add formatting</button><button class="aui-button aui-dropdown2-trigger aui-dropdown2-trigger-arrowless" aria-controls="column-settings-dropdown"><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure display</span></button><aui-dropdown-menu id="column-settings-dropdown"><aui-item-checkbox id="show-hide-col-attrs" ' + ((opt_data.columnAttributes.length > 0) ? 'checked' : '') + '>Show column attributes</aui-item-checkbox><aui-item-checkbox id ="show-hide-empty-pos-rows" checked>Show empty columns</aui-item-checkbox></aui-dropdown-menu></div></div><div id="column-positions" class="scrollable-area appfire-grid"><div class="grid-empty-msg" ' + ((rowCount__soy5 > 0) ? ' style="display: none;" ' : '') + '>' + org.swift.confluence.table.editor.columnSettingsEmpty(null) + '</div>';
  var positionLimit26 = rowCount__soy5;
  for (var position26 = 0; position26 < positionLimit26; position26++) {
    output += org.swift.confluence.table.editor.columnPositionRow({position: position26, columnAttributes: opt_data.columnAttributes, columnCalculations: opt_data.columnCalculations, columnStyles: opt_data.columnStyles, columnTypes: opt_data.columnTypes, autoNumber: opt_data.autoNumber});
  }
  output += '</div><fieldset></div><!-- tabs-pane column-formatting close--><div class="tabs-pane" id="column-totaling"><div class="scrollable-tab-content"><fieldset><h3>Numbering</h3>' + org.swift.confluence.table.editor.toggleElement({name: 'autoNumber', value: opt_data.autoNumber, label: 'Insert auto number column', helpContent: 'Column numbering adds a column to your table that includes row numbers and can affect column formatting on your data columns if you specified your formatting using column numbers. '}) + org.swift.confluence.table.editor.textElement({name: 'autoNumberColStyles', type: 'text', value: opt_data.autoNumber && opt_data.columnStyles[0] != '' ? opt_data.columnStyles[0] : opt_data.autoNumberColStyles, label: 'Auto number column styles', topLabel: 'true', helpContent: 'Apply styles to the auto number column using \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCascading Style Sheets (CSS)\x3c/a\x3e when auto number is enabled.'}) + ((opt_data.macroName != 'attachment-table') ? org.swift.confluence.table.editor.toggleElement({name: 'autoNumberSort', value: opt_data.autoNumberSort, label: 'Enable sorting on auto number column'}) : '') + '<!-- TODO: where will this fit?? -->' + org.swift.confluence.table.editor.toggleElement({name: 'enableHeadingAttributes', value: opt_data.enableHeadingAttributes, label: 'Apply column attributes to header rows'}) + org.swift.confluence.table.editor.toggleElement({name: 'applyColStyleToCell', value: opt_data.applyColStyleToCell, label: 'Apply Column styles to column cells', helpContent: 'Enable this option to override the default styles and apply your style settings to the cells directly in each column. '}) + '</fieldset><fieldset><h3>Totaling</h3>' + org.swift.confluence.table.editor.toggleElement({name: 'autoTotal', value: opt_data.autoTotal, label: 'Auto total numeric columns'}) + '</fieldset></div></div><!-- tabs-pane column-totaling close--><div class="tabs-pane" id="column-sorting"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.toggleElement({name: 'enableSorting', value: opt_data.enableSorting, label: 'Enable column sorting'}) + org.swift.confluence.table.editor.textElement({name: 'sortColumn', value: opt_data.sortColumn, label: 'Automatically sort by this column', topLabel: 'true', helpContent: 'Column name or number for automatic sorting on first display.'}) + org.swift.confluence.table.editor.toggleElement({name: 'sortDescending', value: opt_data.sortDescending, label: 'Automatically sort in descending order'}) + org.swift.confluence.table.editor.toggleElement({name: 'sortIcon', value: opt_data.sortIcon, label: 'Display sort icon'}) + org.swift.confluence.table.editor.textElement({name: 'sortTip', value: opt_data.sortTip, label: 'Sort tip text', topLabel: 'true'}) + '</fieldset></div></div><!-- tabs-pane column-sorting close--></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.columnSettingsPanel.soyTemplateName = 'org.swift.confluence.table.editor.columnSettingsPanel';
}


org.swift.confluence.table.editor.columnSettingsEmpty = function(opt_data, opt_ignored) {
  return '<div class="appfire-empty"><div class="appfire-empty-image"><svg id="Col_ATEmptyState" class="play" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 258.25 153.8"><path id="Col_Shadow" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M34.62 152.3h191"/><linearGradient id="Col_Background_1_" gradientUnits="userSpaceOnUse" x1="-6117.154" y1="-753.957" x2="-6117.154" y2="-879.877" gradientTransform="translate(6246.278 880.56)"><stop offset="0" stop-color="#FFF"/><stop offset="1" stop-color="#F0FAFA"/></linearGradient><path id="Col_Background" fill="url(#Col_Background_1_)" d="M242.85 78.08c7.07 17.84 27.54 32.36-3.62 45.7-9.64 4.13-43.39-11.37-59.51-7.56-15.94 3.76-28.46 8.47-45.22 9.91-25.3 2.18-33.96-3.53-55.41-8.23-13.6-2.98-26.78 2.31-38.83.43-32.54-5.06-55.01-45.29-28.7-70.77 8.61-8.34 23.02-7.13 33.42-15.45C61.9 18.56 52.73 2.14 83.04 2.98c30.15.85 47.19 16.44 80.72 9.89 22.14-4.33 78.27-28.17 92.7 5.69 9.57 22.45-22.73 34.76-13.61 59.52z"/><g id="Col_Socket"><linearGradient id="Col_SVGID_1_" gradientUnits="userSpaceOnUse" x1="41.204" y1="856.587" x2="52.996" y2="877.013" gradientTransform="translate(0 -738)"><stop offset="0" stop-color="#FFF"/><stop offset=".5" stop-color="#F9F9F9"/><stop offset="1" stop-color="#F0F0F0"/></linearGradient><path fill="url(#Col_SVGID_1_)" d="M51.1 139.8h-8c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M45.1 121.8v2M49.1 121.8v2"/><circle fill="#333" cx="47.1" cy="126.8" r="1"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M45.1 131v2M49.1 131v2"/><circle fill="#333" cx="47.1" cy="136" r="1"/></g><g id="Col_Plug"><circle id="Col_PlugEnd" fill="#333" cx="47.1" cy="133.8" r="4"/><path id="Col_PlugCord" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M73.12 101.8h-4c-2.8 0-5 2.2-5 5l-.02 38c0 2.8-2.2 5-5 5h-7c-2.8 0-5-2.2-5-5v-10"/><path id="Col_PlugStart" fill="#333" d="M74.12 97.8c-2.2 0-4 1.8-4 4s1.8 4 4 4v-8z"/></g><g id="Col_Table"><g id="Col_TableHanger" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"><path d="M90.12 22.8v-21M186.12 22.8v-21"/></g><g id="Col_TableBG"><linearGradient id="Col_SVGID_2_" gradientUnits="userSpaceOnUse" x1="156.612" y1="146.621" x2="131.637" y2="4.981"><stop offset="0" stop-color="#FFB672"/><stop offset="1" stop-color="#FCD9BE"/></linearGradient><path fill="url(#Col_SVGID_2_)" d="M210.12 14.8h-134a2 2 0 0 0-2 2v118a2 2 0 0 0 2 2h136a2 2 0 0 0 2-2v-118a2 2 0 0 0-2-2h-2z"/><path opacity=".1" fill="#FFF" d="M78.12 20.8a2 2 0 0 1 2-2h134v-2a2 2 0 0 0-2-2h-136a2 2 0 0 0-2 2v118c0 1.1.9 2 2 2h2v-116z"/></g><g id="Col_LightOff4"><path fill="#F2F2F2" d="M180.13 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26c-1.11 0-2-.89-2-2z"/><path opacity=".25" fill="#CCC" d="M195.63 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM194.63 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M185.13 127.8V39.79M195.13 39.79v88.01M205.14 39.79v88.01"/></g><g id="Col_LightOff3"><path fill="#F2F2F2" d="M146.13 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26c-1.11 0-2-.89-2-2z"/><path opacity=".25" fill="#CCC" d="M161.63 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM160.63 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M151.13 127.8V39.79M161.13 39.79v88.01M171.14 39.79v88.01"/></g><g id="Col_LightOff2"><path fill="#F2F2F2" d="M112.12 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26a2 2 0 0 1-2-2z"/><path opacity=".25" fill="#CCC" d="M127.62 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM126.62 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M117.13 127.8V39.79M127.13 39.79v88.01M137.14 39.79v88.01"/></g><g id="Col_LightOff1"><path fill="#F2F2F2" d="M78.12 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26a2 2 0 0 1-2-2z"/><path opacity=".25" fill="#CCC" d="M93.62 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM92.62 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M83.13 127.8V39.79M93.13 39.79v88.01M103.14 39.79v88.01"/></g><g id="Col_LightOn1"><linearGradient id="Col_SVGID_3_" gradientUnits="userSpaceOnUse" x1="-574.875" y1="874.802" x2="-574.875" y2="844.802" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#89D8E5"/><stop offset=".024" stop-color="#8CDCEB"/><stop offset=".099" stop-color="#94E5F6"/><stop offset=".205" stop-color="#98EBFD"/><stop offset=".5" stop-color="#99ECFF"/><stop offset=".795" stop-color="#98EBFD"/><stop offset=".901" stop-color="#94E5F6"/><stop offset=".976" stop-color="#8CDCEB"/><stop offset="1" stop-color="#89D8E5"/></linearGradient><path fill="url(#Col_SVGID_3_)" d="M78.12 130.8v-94a2 2 0 0 1 2-2h26a2 2 0 0 1 2 2v94a2 2 0 0 1-2 2h-26a2 2 0 0 1-2-2z"/><g opacity=".5"><linearGradient id="Col_SVGID_4_" gradientUnits="userSpaceOnUse" x1="-574.884" y1="863.829" x2="-574.884" y2="855.801" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Col_SVGID_4_)" d="M89.1 39.79h8.03v88.02H89.1z"/></g><g opacity=".5"><linearGradient id="Col_SVGID_5_" gradientUnits="userSpaceOnUse" x1="-574.884" y1="873.815" x2="-574.884" y2="865.787" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Col_SVGID_5_)" d="M79.11 39.79h8.03v88.02h-8.03z"/></g><path opacity=".1" fill="#3DB2CB" d="M93.62 132.8v-4.5h9.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-20c-.28 0-.5.22-.5.5s.22.5.5.5h9.5v4.5h1zM92.62 34.8v4.5h-9.5c-.28 0-.5.22-.5.5s.22.5.5.5h20c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-9.5v-4.5h-1z"/><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M83.12 127.8V39.79M93.12 39.79v88.01"/><g opacity=".5"><linearGradient id="Col_SVGID_6_" gradientUnits="userSpaceOnUse" x1="-574.884" y1="853.815" x2="-574.884" y2="845.787" gradientTransform="rotate(90 147.124 805.802)"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Col_SVGID_6_)" d="M99.11 39.79h8.03v88.02h-8.03z"/></g><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M103.14 39.79v88.01"/></g></g><path fill="#FFF" d="M11.56 47.55c8.61-8.34 23.02-7.13 33.42-15.45C61.9 18.56 52.73 2.14 83.04 2.98c30.15.85 47.19 16.44 80.72 9.89 22.14-4.33 78.27-28.17 92.7 5.69.92 2.15 1.45 4.23 1.67 6.25V0H.13v70.86c.66-8.19 4.2-16.3 11.43-23.31z" id="Col_Mask"/></svg></div><div class="appfire-empty-content"><h3>Power up your columns</h3><p>Give your columns some character by applying a few simple settings.</p><p>Start with column number <input class="rows-to-add" type="number" min="0" max="30" value="1"></input></p><p class="error" style="color:#de350b; display: none;"">Enter a number between 0 and 30.</p><button class="start-formatting aui-button aui-button-primary">Start formatting</button></div></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.columnSettingsEmpty.soyTemplateName = 'org.swift.confluence.table.editor.columnSettingsEmpty';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/column-position-row.soy' */
// This file was automatically generated from column-position-row.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.columnPositionRow = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="grid appfire-row"> <!-- row --><div class="col-1 row-header row-header-narrow">  \t\t<!-- row thumb cell --><h4 class="row-number">' + soy.$$escapeHtml(opt_data.position + 1) + '</h4></div>                        \t\t                <!-- row thumb cell --><div class="col-auto row-data">                       <!-- row data --><div class="grid show-hide-empty"><div class="col-md-auto" data-collapsible="col-md-auto"><div class="field-group"><label for="text-input">Column styles</label>' + ((opt_data.autoNumber) ? '<input class="text full-width-field row-data-element" type="text" name="columnStyles" title="Text input" ' + ((opt_data.columnStyles[opt_data.position + 1]) ? ' value="' + soy.$$escapeHtml(opt_data.columnStyles[opt_data.position + 1]) + '" ' : '') + '/>' : '<input class="text full-width-field row-data-element" type="text" name="columnStyles" title="Text input" ' + ((opt_data.columnStyles[opt_data.position]) ? ' value="' + soy.$$escapeHtml(opt_data.columnStyles[opt_data.position]) + '" ' : '') + '/>') + '</div></div>';
  var colType__soy24 = opt_data.columnTypes[opt_data.position] ? opt_data.columnTypes[opt_data.position] : '';
  output += '<div class="col-md-auto" data-collapsible="col-md-auto"><div class="field-group"><label for="columnTypes">Column type</label><input type="hidden" name="columnTypes" ' + ((colType__soy24) ? ' value="' + soy.$$escapeHtml(colType__soy24) + '" ' : '') + '/><aui-select class="column-types-select" can-create-values="true" id="column-types-select-' + soy.$$escapeHtml(opt_data.position) + '" ><aui-option ' + ((colType__soy24 == 'I' || colType__soy24 == 'i') ? ' selected ' : '') + ' value="I">Integer (I)</aui-option><aui-option ' + ((colType__soy24 == 'S' || colType__soy24 == 's') ? ' selected ' : '') + ' value="S">String (S)</aui-option><aui-option ' + ((colType__soy24 == 'F' || colType__soy24 == 'f') ? ' selected ' : '') + ' value="F">Numeric and float values (F)</aui-option><aui-option ' + ((colType__soy24 == 'FF' || colType__soy24 == 'ff') ? ' selected ' : '') + ' value="FF">Numeric with data formatting (FF)</aui-option><aui-option ' + ((colType__soy24 == 'FC' || colType__soy24 == 'fc') ? ' selected ' : '') + ' value="FC">Float with comma as decimal point (FC)</aui-option><aui-option ' + ((colType__soy24 == 'C' || colType__soy24 == 'c') ? ' selected ' : '') + ' value="C">Currency (C)</aui-option><aui-option ' + ((colType__soy24 == 'CC' || colType__soy24 == 'cc') ? ' selected ' : '') + ' value="CC">Currency with comma as decimal points (CC)</aui-option><aui-option ' + ((colType__soy24 == 'M' || colType__soy24 == 'm') ? ' selected ' : '') + ' value="M">Date (M)</aui-option><aui-option ' + ((colType__soy24 == 'D' || colType__soy24 == 'd') ? ' selected ' : '') + ' value="D">Date in the browser date format (D)</aui-option><aui-option ' + ((colType__soy24 == 'E' || colType__soy24 == 'e') ? ' selected ' : '') + ' value="E">Complex HTML elements like emotions or similar (E)</aui-option><aui-option ' + ((colType__soy24 == 'X' || colType__soy24 == 'x') ? ' selected ' : '') + ' value="X">Exclude this column from user selectable sorting (X)</aui-option><aui-option ' + ((colType__soy24 == 'H' || colType__soy24 == 'h') ? ' selected ' : '') + ' value="H">Hide the column (H)</aui-option>' + ((colType__soy24 && ! (('|I|S|F|FF|FC|C|CC|M|D|E|X|H|').indexOf('' + ('|' + colType__soy24 + '|')) != -1) && ! (('|i|s|f|ff|fc|c|cc|m|d|e|x|h|').indexOf('' + ('|' + colType__soy24 + '|')) != -1)) ? '<aui-option value="' + soy.$$escapeHtml(colType__soy24) + '" selected>' + soy.$$escapeHtml(colType__soy24) + '</aui-option>' : '') + '</aui-select></div></div><div class="col-sm-auto" data-collapsible="col-sm-auto"><div class="field-group">';
  var val__soy90 = opt_data.columnCalculations && opt_data.columnCalculations.length > 0 && opt_data.position < opt_data.columnCalculations.length ? opt_data.columnCalculations[opt_data.position] : '';
  output += '<label for="columnCalculations">Total type</label><input type="hidden" name="columnCalculations" ' + ((val__soy90) ? ' value="' + soy.$$escapeHtml(val__soy90) + '" ' : '') + ' /><aui-select class="column-calculations-select" can-create-values="true"><aui-option value="sum" ' + ((val__soy90 == 'sum') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Sum') + '</aui-option><aui-option value="avg" ' + ((val__soy90 == 'avg') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Average') + '</aui-option><aui-option value="max" ' + ((val__soy90 == 'max') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Max') + '</aui-option><aui-option value="min" ' + ((val__soy90 == 'min') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Min') + '</aui-option><aui-option value="avgignorezero" ' + ((val__soy90 == 'avgignorezero') ? ' selected ' : '') + '>' + soy.$$escapeHtml('Average (ignore zeros and blanks)') + '</aui-option>' + ((val__soy90 && ! (('|sum|avg|avgignorezero|').indexOf('' + ('|' + val__soy90 + '|')) != -1)) ? '<aui-option value="' + soy.$$escapeHtml(val__soy90) + '" selected>' + soy.$$escapeHtml(val__soy90) + '</aui-option>' : '') + '</aui-select></div></div><div class="col-sm-auto column-attributes" data-collapsible="col-sm-auto"  ' + ((opt_data.columnAttributes.length == 0) ? ' style="display:none;" ' : '') + '><div class="field-group"><label for="text-input">Column attributes</label><input class="text full-width-field row-data-element" type="text" name="columnAttributes" title="Text input"  ' + ((opt_data.columnAttributes[opt_data.position]) ? ' value="' + soy.$$escapeHtml(opt_data.columnAttributes[opt_data.position]) + '" ' : '') + '/></div></div></div></div>                                              <!-- row data -->' + org.swift.confluence.editor.commonGridRowActions({controlId: 'col-position-action-' + opt_data.position}) + '</div>                                                              <!-- row -->';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.columnPositionRow.soyTemplateName = 'org.swift.confluence.table.editor.columnPositionRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/row-position-row.soy' */
// This file was automatically generated from row-position-row.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.rowPositionRow = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="grid appfire-row"> <!-- row --><div class="col-1 row-header row-header-narrow">  \t\t<!-- row thumb cell --><h4 class="row-number">' + soy.$$escapeHtml(opt_data.position) + '</h4></div>                        \t\t<!-- row thumb cell --><div class="col-auto row-data"> <!-- row content --><div class="grid"><div class="col-md-auto" data-collapsible="col-md-auto"><div class="field-group"><label for="text-input">Row styles</label><input class="text full-width-field row-data-element" type="text" name="rowStyles" title="Text input" ' + ((opt_data.rowStyles[opt_data.position]) ? ' value="' + soy.$$escapeHtml(opt_data.rowStyles[opt_data.position]) + '" ' : '') + '></div></div></div></div>                  <!-- row content -->' + org.swift.confluence.editor.commonGridRowActions({controlId: 'row-position-action-' + opt_data.position}) + '</div>                            \t<!-- row -->';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.rowPositionRow.soyTemplateName = 'org.swift.confluence.table.editor.rowPositionRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/row-settings-panel.soy' */
// This file was automatically generated from row-settings-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.rowSettingsPanel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu"><li class="menu-item active-tab"><a href="#data-row-formatting">' + soy.$$escapeHtml('Data rows') + '</a></li><li class="menu-item"><a href="#hdr-row-formatting">' + ((opt_data.footing >= 0) ? 'Header & Footer rows' : 'Header rows') + '</a></li><li class="menu-item"><a href="#row-advanced">Advanced settings</a></li></ul><div class="tabs-pane active-pane" id="data-row-formatting"><fieldset class="appfire-grid-set">';
  var rowCount__soy12 = Math.max(0, opt_data.rowStyles.length);
  output += '<div class="grid-bar" ' + ((rowCount__soy12 < 2) ? ' style="display: none;" ' : '') + '><h3>Repeating row formatting ' + org.swift.confluence.table.editor.addHelpContent({name: 'rowFormatting', id: 'rowFormatting', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/KQCLMw\x22 target\x3d\x22Advanced Tables Help\x22 \x3eRow styles\x3c/a\x3e accepts one or more \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCSS\x3c/a\x3e properties to control formatting. Row styles define a repeating style for your data rows when you specify two or more row styles.'}) + '</h3><div class="grid-bar-actions"><button class="aui-button add-grid-row" data-grid="#row-positions" resolved=""><span class="aui-icon aui-icon-small aui-iconfont-add"></span> Add formatting</button></div></div><div id="row-positions" class="scrollable-area appfire-grid"><div class="grid-empty-msg" ' + ((rowCount__soy12 > 1) ? ' style="display: none;" ' : '') + '>' + org.swift.confluence.table.editor.rowSettingsEmpty(null) + '</div>';
  var positionLimit29 = rowCount__soy12;
  for (var position29 = 1; position29 < positionLimit29; position29++) {
    output += org.swift.confluence.table.editor.rowPositionRow({position: position29, rowStyles: opt_data.rowStyles});
  }
  output += '</div></fieldset></div><div class="tabs-pane" id="hdr-row-formatting"><div class="scrollable-tab-content"><fieldset><h3>Header rows</h3>' + ((opt_data.macroName != 'attachment-table') ? '<!-- TODO: for number elements, add style to make it inline with design -->' + org.swift.confluence.table.editor.textElement({name: 'heading', type: 'number', value: opt_data.heading, label: 'Number of header rows', topLabel: 'true'}) : '') + org.swift.confluence.table.editor.textElement({name: 'headerRowStyles', type: 'text', value: opt_data.rowStyles[0], label: 'Header row styles', topLabel: 'true', helpContent: '\x3ca href\x3d\x22https://bobswift.atlassian.net/wiki/x/KQCLMw\x22 target\x3d\x22Advanced Tables Help\x22 \x3eHeader row styles\x3c/a\x3e accepts one or more \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCSS\x3c/a\x3e properties to control formatting.  Formatting is applied to all header rows in your table.'}) + ((opt_data.macroName == 'json-table' || opt_data.macroName == 'table-plus' || opt_data.macroName == 'csv') ? org.swift.confluence.table.editor.toggleElement({name: 'hideHeader', value: opt_data.hideHeader, label: 'Hide header row(s)'}) : '') + ((opt_data.footing >= 0) ? '<h3>Footer rows</h3>' + org.swift.confluence.table.editor.textElement({name: 'footing', type: 'number', value: opt_data.footing, label: 'Number of footer rows', topLabel: 'true'}) : '') + ((opt_data.macroName == 'attachment-table' || opt_data.macroName == 'json-table' || opt_data.macroName == 'table-plus' || opt_data.macroName == 'csv') ? org.swift.confluence.table.editor.textElement({name: 'autoTotalRowStyle', type: 'text', value: opt_data.autoTotalRowStyle, label: 'Auto total row styles', topLabel: 'true', helpContent: 'Apply styles to auto total row using \x3ca href\x3d\x22https://www.w3schools.com/css/default.asp\x22 target\x3d\x22_blank\x22\x3eCascading Style Sheets (CSS)\x3c/a\x3e when auto total is enabled.'}) : '') + '</fieldset></div></div><div class="tabs-pane" id="row-advanced"><div class="scrollable-tab-content"><fieldset>' + org.swift.confluence.table.editor.toggleElement({name: 'retainRowStyleOrder', value: opt_data.retainRowStyleOrder, label: 'Retain row style order after re-sorting'}) + org.swift.confluence.table.editor.toggleElement({name: 'applyRowStyleToCell', value: opt_data.applyRowStyleToCell, label: 'Apply Row styles to row cells', helpContent: 'Enable this option to override the default styles and apply your style settings to the cells directly in each row. '}) + org.swift.confluence.table.editor.toggleElement({name: 'enableHighlighting', value: opt_data.enableHighlighting, label: 'Enable row highlighting on mouse over'}) + org.swift.confluence.table.editor.textElement({name: 'highlightColor', type: 'text', value: opt_data.highlightColor, label: 'Highlight color', topLabel: 'true', helpContent: 'Highlight color shown when mouse is over a row. Use either color name or HEX value. \x3cbr\x3e \x3cb\x3eExample:\x3c/b\x3e lightgoldenrodyellow or #FAFAD2'}) + '</fieldset></div></div></div>';
  return output;
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.rowSettingsPanel.soyTemplateName = 'org.swift.confluence.table.editor.rowSettingsPanel';
}


org.swift.confluence.table.editor.rowSettingsEmpty = function(opt_data, opt_ignored) {
  return '<div class="appfire-empty"><div class="appfire-empty-image"><svg id="Row_ATEmptyState" class="play" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 258.2 159.8"><path id="Row_Shadow" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M24.6 158.3h195"/><linearGradient id="Row_Background_1_" gradientUnits="userSpaceOnUse" x1="-6117.154" y1="-753.957" x2="-6117.154" y2="-880.561" gradientTransform="translate(6246.278 880.56)"><stop offset="0" stop-color="#FFF"/><stop offset="1" stop-color="#F0FAFA"/></linearGradient><path id="Row_Background" fill="url(#Row_Background_1_)" d="M242.8 78.1c7.1 17.8 27.5 32.4-3.6 45.7-9.6 4.1-43.4-11.4-59.5-7.6-15.9 3.8-28.5 8.5-45.2 9.9-25.3 2.2-34-3.5-55.4-8.2-13.6-3-26.8 2.3-38.8.4-32.5-5.1-55-45.3-28.7-70.8 8.6-8.3 23-7.1 33.4-15.5C61.9 18.6 52.7 2.1 83 3c30.1.8 47.2 18.4 80.7 11.9 22.1-4.3 78.3-32.2 92.7 1.7 9.6 22.4-22.7 36.7-13.6 61.5z"/><g id="Row_Socket"><linearGradient id="Row_SVGID_1_" gradientUnits="userSpaceOnUse" x1="35.227" y1="124.587" x2="47.022" y2="145.016"><stop offset="0" stop-color="#FFF"/><stop offset=".5" stop-color="#F9F9F9"/><stop offset="1" stop-color="#F0F0F0"/></linearGradient><path fill="url(#Row_SVGID_1_)" d="M45.1 145.8h-8c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h8c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M39.1 127.8v2M43.1 127.8v2"/><circle fill="#333" cx="41.1" cy="132.8" r="1"/><path fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M39.1 137v2M43.1 137v2"/><circle fill="#333" cx="41.1" cy="142" r="1"/></g><g id="Row_Plug"><circle id="Row_PlugEnd" fill="#333" cx="41.1" cy="139.8" r="4"/><path id="Row_PlugCord" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M67.1 111.8h-4c-2.8 0-5 2.2-5 5v34c0 2.8-2.2 5-5 5h-7c-2.8 0-5-2.2-5-5v-10"/><path id="Row_PlugStart" fill="#333" d="M68.1 107.8c-2.2 0-4 1.8-4 4s1.8 4 4 4v-8z"/></g><g id="Row_Table"><g id="Row_TableHanger" fill="none" stroke="#F0F0F0" stroke-width="3" stroke-linejoin="round" stroke-miterlimit="10"><path d="M90.1 22.8v-23M186.1 22.8v-23"/></g><g id="Row_TableBG"><linearGradient id="Row_SVGID_2_" gradientUnits="userSpaceOnUse" x1="150.587" y1="12.381" x2="125.613" y2="154.019" gradientTransform="matrix(1 0 0 -1 0 162)"><stop offset="0" stop-color="#FFB672"/><stop offset="1" stop-color="#FCD9BE"/></linearGradient><path fill="url(#Row_SVGID_2_)" d="M204.1 17.8h-134c-1.1 0-2 .9-2 2v118c0 1.1.9 2 2 2h136c1.1 0 2-.9 2-2v-118c0-1.1-.9-2-2-2h-2z"/><path opacity=".1" fill="#FFF" d="M72.1 23.8c0-1.1.9-2 2-2h134v-2c0-1.1-.9-2-2-2h-136c-1.1 0-2 .9-2 2v118c0 1.1.9 2 2 2h2v-116z"/></g><g id="Row_Light4Off"><path fill="#F2F2F2" d="M202.1 135.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 124.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 125.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 129.8h-122M77.1 119.8h122"/></g><g id="Row_Light3Off"><path fill="#F2F2F2" d="M202.1 109.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 98.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 99.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 103.8h-122M77.1 93.8h122"/></g><g id="Row_Light2Off"><path fill="#F2F2F2" d="M202.1 83.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 72.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 73.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 77.8h-122M77.1 67.8h122"/></g><g id="Row_Light1Off"><path fill="#F2F2F2" d="M202.1 57.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><path opacity=".25" fill="#CCC" d="M204.1 46.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 47.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path fill="none" stroke="#EEE" stroke-width="2" stroke-miterlimit="10" d="M199.1 51.8h-122M77.1 41.8h122"/></g><g id="Row_LightOn3"><linearGradient id="Row_SVGID_3_" gradientUnits="userSpaceOnUse" x1="138.1" y1="109.8" x2="138.1" y2="87.8"><stop offset="0" stop-color="#89D8E5"/><stop offset=".024" stop-color="#8CDCEB"/><stop offset=".099" stop-color="#94E5F6"/><stop offset=".205" stop-color="#98EBFD"/><stop offset=".5" stop-color="#99ECFF"/><stop offset=".795" stop-color="#98EBFD"/><stop offset=".901" stop-color="#94E5F6"/><stop offset=".976" stop-color="#8CDCEB"/><stop offset="1" stop-color="#89D8E5"/></linearGradient><path fill="url(#Row_SVGID_3_)" d="M202.1 109.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><g opacity=".5"><linearGradient id="Row_SVGID_4_" gradientUnits="userSpaceOnUse" x1="138.092" y1="97.828" x2="138.092" y2="89.8"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_4_)" d="M77.1 89.8h122v8h-122z"/></g><g opacity=".5"><linearGradient id="Row_SVGID_5_" gradientUnits="userSpaceOnUse" x1="138.092" y1="107.814" x2="138.092" y2="99.786"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_5_)" d="M77.1 99.8h122v8h-122z"/></g><path opacity=".1" fill="#3DB2CB" d="M204.1 98.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 99.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M199.1 103.8h-122M77.1 93.8h122"/></g><g id="Row_LightOn1"><linearGradient id="Row_SVGID_6_" gradientUnits="userSpaceOnUse" x1="138.1" y1="57.8" x2="138.1" y2="35.8"><stop offset="0" stop-color="#89D8E5"/><stop offset=".024" stop-color="#8CDCEB"/><stop offset=".099" stop-color="#94E5F6"/><stop offset=".205" stop-color="#98EBFD"/><stop offset=".5" stop-color="#99ECFF"/><stop offset=".795" stop-color="#98EBFD"/><stop offset=".901" stop-color="#94E5F6"/><stop offset=".976" stop-color="#8CDCEB"/><stop offset="1" stop-color="#89D8E5"/></linearGradient><path fill="url(#Row_SVGID_6_)" d="M202.1 57.8h-128c-1.1 0-2-.9-2-2v-18c0-1.1.9-2 2-2h128c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2z"/><g opacity=".5"><linearGradient id="Row_SVGID_7_" gradientUnits="userSpaceOnUse" x1="138.092" y1="45.828" x2="138.092" y2="37.8"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_7_)" d="M77.1 37.8h122v8h-122z"/></g><g opacity=".5"><linearGradient id="Row_SVGID_8_" gradientUnits="userSpaceOnUse" x1="138.092" y1="55.814" x2="138.092" y2="47.786"><stop offset="0" stop-color="#99ECFF"/><stop offset=".5" stop-color="#BEFFFF"/><stop offset="1" stop-color="#99ECFF"/></linearGradient><path fill="url(#Row_SVGID_8_)" d="M77.1 47.8h122v8h-122z"/></g><path opacity=".1" fill="#3DB2CB" d="M204.1 46.3h-4.5v-4.5c0-.3-.2-.5-.5-.5s-.5.2-.5.5v10c0 .3.2.5.5.5s.5-.2.5-.5v-4.5h4.5v-1zM72.1 47.3h4.5v4.5c0 .3.2.5.5.5s.5-.2.5-.5v-10c0-.3-.2-.5-.5-.5s-.5.2-.5.5v4.5h-4.5v1z"/><path opacity=".25" fill="none" stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M199.1 51.8h-122M77.1 41.8h122"/></g></g><path id="Row_Mask" fill="#FFF" d="M11.6 47.6c8.6-8.3 23-7.1 33.4-15.5C61.9 18.6 52.7 2.1 83 3c30.1.8 47.2 18.4 80.7 11.9 22.1-4.3 78.3-32.2 92.7 1.7.3.6.5 1.2.7 1.8V-.2H.1v68l.4-.1c1.3-7.1 4.8-14.1 11.1-20.1z"/></svg></div><div class="appfire-empty-content"><h3>Make your rows shine</h3><p>Adding some repeating row styles can brighten up your data and make it easier to read.</p><p>Start with <input class="rows-to-add" type="number" min="0" max="30" value="2"></input> alternating row styles.</p><p class="error" style="color:#de350b; display: none;"">Enter a number between 0 and 30.</p><button class="start-formatting aui-button aui-button-primary">Start styling</button></div></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.rowSettingsEmpty.soyTemplateName = 'org.swift.confluence.table.editor.rowSettingsEmpty';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/soy/data-location-template.soy' */
// This file was automatically generated from data-location-template.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace org.swift.confluence.table.editor.
 */

if (typeof org == 'undefined') { var org = {}; }
if (typeof org.swift == 'undefined') { org.swift = {}; }
if (typeof org.swift.confluence == 'undefined') { org.swift.confluence = {}; }
if (typeof org.swift.confluence.table == 'undefined') { org.swift.confluence.table = {}; }
if (typeof org.swift.confluence.table.editor == 'undefined') { org.swift.confluence.table.editor = {}; }


org.swift.confluence.table.editor.dataLocationFields = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="aui-group"><div class="field-group"><label for="dataLocation">' + soy.$$escapeHtml('Method of locating script') + '</label><select class="select  appfire-table-datalocation  appfire-editor-select" id="dataLocation" name="dataLocation" data-macroname="' + soy.$$escapeHtml(opt_data.macroName) + '"><option value="" ' + ((! opt_data.attachmentPage && ! opt_data.filename && ! opt_data.template && ! opt_data.url) ? ' selected ' : '') + '>None</option>' + ((opt_data.url != null) ? ' <option value="url" ' + ((opt_data.url) ? ' selected ' : '') + '>URL</option> ' : '') + '<!-- If url supported, this option is shown. And if supported and url given i.e dataLocation = url, and if attachment also given, then attachment takes precedence -->' + ((opt_data.macroName == 'csv' || opt_data.macroName == 'json-table') ? '<option value="profile" ' + ((opt_data.profile) ? ' selected ' : '') + '>Profile</option>' : '') + '<option value="attachment" ' + ((opt_data.attachmentPage) ? ' selected ' : '') + '>Attachment</option><option value="filename" ' + ((opt_data.filename) ? ' selected ' : '') + '>Filename</option><option value="template" ' + ((opt_data.template) ? ' selected ' : '') + '>Template</option></select></div></div><!--  Profile related fields start-->' + ((opt_data.macroName == 'csv' || opt_data.macroName == 'json-table') ? '<div class="aui-group profile-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'profile', value: opt_data.profile, label: 'Profiles', topLabel: 'true', required: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'profileUrl', value: opt_data.profileUrl, label: 'URL of  ' + soy.$$escapeHtml(opt_data.dataTypeToLocate) + '  data', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'timeout', type: 'number', value: opt_data.timeout, label: 'Connection timeout (milliseconds)', topLabel: 'true'}) + '</div>' : '') + '<!-- Profile related fields done--><!-- if URL , then show url, username, pwd, connection timeout fields. Note that in some apps locating source data through Url is not supported, in those cases these fields wont be loaded. --><!-- URL related fields start-->' + ((opt_data.url != null) ? '<div class="aui-group url-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'url', value: opt_data.url, label: 'URL of  ' + soy.$$escapeHtml(opt_data.dataTypeToLocate) + '  data', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'user', value: opt_data.user, label: 'Username (if required)', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'password', type: 'password', value: opt_data.password, label: 'Password (if required)', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'timeout', type: 'number', value: opt_data.timeout, label: 'Connection timeout (milliseconds)', topLabel: 'true'}) + '</div>' : '') + '<!-- URL related fields done--><!-- attachment related fields start --><div class="aui-group attachment-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'attSpace', inputClass: 'datalocation-space long-field', value: opt_data.attSpace, label: 'Space', topLabel: 'true'}) + org.swift.confluence.table.editor.textElement({name: 'attPage', inputClass: 'datalocation-page long-field', value: opt_data.attPage, label: 'Page', topLabel: 'true', helpContent: 'The content can be loaded from a page attachment. You can also enter special values of @self, @home, or @parent. You cannot preview results for unsaved pages.'}) + org.swift.confluence.table.editor.textElement({name: 'attachment', inputClass: 'datalocation-attachment long-field', value: opt_data.attachment, label: 'Attachment', topLabel: 'true'}) + '</div><!-- attachment related fields end--><!-- filename related fields start--><div class="aui-group filename-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'filename', value: opt_data.filename, label: 'File name', topLabel: 'true', helpContent: 'The content can be loaded from files from the \x22script\x22 folder in your Confluence home directory. You can also specify the subdirectories.'}) + '</div><!-- filename related fields end --><!-- template related fields start--><div class="aui-group template-group datalocation-fields" >' + org.swift.confluence.table.editor.textElement({name: 'template', value: opt_data.template, label: 'Name of template', topLabel: 'true', helpContent: 'The content is read from either a global page template or from a space template. Enter \x22global_template_name\x22 or \x22space:template_name\x22. You cannot preview results for unsaved templates.'}) + '</div><!-- template related fields end-->';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.dataLocationFields.soyTemplateName = 'org.swift.confluence.table.editor.dataLocationFields';
}


org.swift.confluence.table.editor.macroBodyFilledMessage = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="field-group appfire-macroBody-filled-message" ' + ((opt_data.macroBody == '') ? ' style="display: none;" ' : '') + '><label><span class="aui-icon aui-icon-small  aui-iconfont-info">help</span><span> ' + soy.$$escapeHtml('Note that the data from the above data source will be appended to the data provided in macro body.') + ' </span></label></div>';
};
if (goog.DEBUG) {
  org.swift.confluence.table.editor.macroBodyFilledMessage.soyTemplateName = 'org.swift.confluence.table.editor.macroBodyFilledMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = 'editor/js/appfire-custom-editor.js' */
// TODO - copyright 
// 
(function(appcme, $, undefined) {
    'use strict';


    // ------------------------------------------------------------------------------------------
    //                  Common Editor Grid Handlers 
    // ------------------------------------------------------------------------------------------
    //
    //      The following handlers are available by default for all grid controls in the dialog.  
    //      You just need to be sure and apply the correct styles and you'll get the following 
    //      behaviors in your grid. 
    //      A row in the grid is demarked by a class of ".appfire-row".  It must be contained 
    //      in an ".appfire-grid".  
    //
    // Global Grid Handlers - act upon the full grid
    //      - Add a row: This requires an ".add-grid-row" action that is included 
    //        as part of the ".grid-bar".  The grid to work against must be added as a 
    //        data element(data-grid="#row-positions") to the button. This is the selector 
    //        for the grid.  
    //        The ".appfire-grid" must also have a jQuery data object with a "masterGridRow" 
    //        key on it. Ths is the grid row inserted at the end of the grid.    
    //
    // Grid Row Handlers- actions on each row of the grid
    //      - Add row above: Adds the "masterGridRow" above the current row
    //        and the grid is renumbered. 
    //      - Add row below: Adds the "masterGridRow" below the current row 
    //        and the grid is renumbered.  
    //      - Copy row: Copies the current row and stores it on the grid as a
    //        jQuery data object keyed with "copySourceGridRow" to be used later
    //        to paste a row. 
    //      - Paste row: If a row has been copied then it is pasted below the current
    //        row and the grid is renumbered.
    //      - Move row up: Moves the current row up one position.
    //      - Move row down: Moves the current row down one position. 
    //      - Clear row: Clears all input elements in the current row.  Checkboxes 
    //        are unchecked and select lists are unselected! 
    //      - Delete row: Deletes the current row and renumbers the grid. 
    // 
    // Common Editor Grid Behaviors - things that happen after commons actions on the grid occur. 
    //      - If the grid has ".row-number" elements they will get renumbered automatically.
    //      - If the grid has ".row-actions" they will be updated automatically to hook up 
    //        the aria-controls with the aui-dropdown-menu with a unique id.  Don't use the id 
    //        for anything but row actions.  
    //
    // Common Events - The following events are generated from the common editor.  Typically you 
    //        will want to filter these event using a selector based on the macro name.  The 
    //        macro name is available on the dialog as a data attribute. 
    //        e.g. [data-appfire-macro-name='csv']
    //
    //          appfireEditorAfterPreviewHide
    //          appfireEditorAfterPreviewShow
    //          appfireEditorBeforeSave
    //          appfireEditorBeforePreview
    //          appfireEditorBeforeSerialize
    //          appfireEditorBeforePreviewSerialize
    //          appfireEditorBeforeShow
    //          appfireEditorAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowAfterShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridAddRowBeforeShow
    //          appfireEditorGridDeleteRow
    //          appfireEditorGridMoveRowDown
    //          appfireEditorGridMoveRowUp
    // ------------------------------------------------------------------------------------------

    $(document).on("click", ".add-grid-row", function() {
        var $grid = $($(this).data("grid"));
        if ($grid){
            var $row = $grid.data("masterGridRow"); 
            appcme.addGridRow($grid, $row);
        }
        return false;
    });

    $(document).on("click", ".add-grid-row-above", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");            
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        var $row = $grid.data("masterGridRow"); 

        if ($row) {
            $row = $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $row.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $currentRow.before($row);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $row.trigger('appfireEditorGridAddRowBeforeShow', [$row]);
            $row.show().trigger('appfireEditorGridAddRowAfterShow', [$row]);    
        }
    });

    $(document).on("click", ".add-grid-row-below", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        var $row = $grid.data("masterGridRow"); 

        if ($row) {
            $row = $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $row.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $currentRow.after($row);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $row.trigger('appfireEditorGridAddRowBeforeShow', [$row]);
            $row.show().trigger('appfireEditorGridAddRowAfterShow', [$row]);    
        }
    });

    $(document).on("click", ".paste-grid-row", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        var $row = $grid.data("copySourceGridRow");

        if ($row) {     
            var $clone =  $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $clone.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $currentRow.before($clone);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $clone.trigger('appfireEditorGridAddRowBeforeShow', [$clone]);
            $clone.show().trigger('appfireEditorGridAddRowAfterShow', [$clone]); 
        }
    });

    $(document).on("click", ".copy-grid-row", function() {
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        $grid.data("copySourceGridRow", $currentRow.clone2());
    });

    $(document).on("click", ".clear-grid-row", function() {
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        $currentRow.find(":input").not(':button, :submit, :reset')
            .val('') 
            .prop('checked', false)
            .prop('selected', false);
    });

    $(document).on("click", ".delete-grid-row", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row"); 
        var $grid = $currentRow.closest(".appfire-grid");
        $currentRow.remove();
        if ($grid.find(".appfire-row").length > 0 ) {
            appcme.numberGridRows($grid);
        }
        $grid.trigger('appfireEditorGridDeleteRow', [$currentRow]);
    });
    
    $(document).on("click", ".move-grid-row-up", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row");
        $currentRow.insertBefore($currentRow.prev());
        $currentRow.trigger('appfireEditorGridMoveRowUp', [$currentRow]);
    });
    
    $(document).on("click", ".move-grid-row-down", function() {
        appcme.clearValidationErrors($(this).closest("form"));
        
        var id = $(this).closest("aui-dropdown-menu").attr("id");
        var $currentRow =  $('[aria-controls="' + id + '"]').closest(".appfire-row");
        $currentRow.insertAfter($currentRow.next());
        $currentRow.trigger('appfireEditorGridMoveRowDown', [$currentRow]);
    });

    /**
     * This handler is here for form validation. 
     */
    $(document).on("focus", ".form-error", function() {
        var $this = $(this);
        $this.removeClass("form-error");
        // if no other form errors clear the error icon 
        if ( !$this.closest("form").find(".form-error").length ) {
            $("#show-editor-error").hide();
        }
    });

    $(document).on('click', '.appfire-navigation [data-index]', function(evt) {
        var $this = $(this), panes = $this.closest('.aui-dialog2').find('.content-panel'), pane = $(panes.get($this.data('index')));

        $this.addClass('selected').siblings().removeClass('selected');
        panes.hide();
        pane.fadeIn();

        return false;
    }).on('click', '.appfire-navigation [data-url]', function(evt) {
        window.open($(this).data('url'), '_blank'); // open url in new tab
    });
    
    /**
     * Set the value of custom toggle element based on which option chosen
     */
    $(document).on('click', '.appfire-custom-toggle', function(evt) {
        evt.preventDefault();
        var $b = $(evt.target);
        $(this).find("#"+$b.parent().attr("id")).val($b.val());
        $b.attr("aria-pressed", "true");
        $b.siblings(".aui-button").attr("aria-pressed", "false");
    });

    $(document).on('appfireEditorAfterShow appfireEditorAfterPreviewShow appfireEditorAfterPreviewHide', function() {

        // TODO: revisit this hack work-around in order to get the preview icons in MS Edge to work correctly. 
        // Leaving this code here for now. 

        //$(".appfire .appfire-navigation .secondary").css("position", "absolute");
        //$(".appfire .appfire-preview-actions .secondary").css("position", "absolute");

        // $(".appfire .appfire-navigation .secondary").hide();
        // $(".appfire .appfire-preview-actions .secondary").hide();

        // $(".appfire .appfire-navigation .secondary").show();
        // $(".appfire .appfire-preview-actions .secondary").show();
    });
    
    //
    // I've been trying to enable and disabled the paste action if nothing has been copied 
    // but can't seem to get it working correctly. 
    //
    // $(document).on("hover", ".row-actions > button", function (evt) { 
    //     if ( evt.type == "mouseenter") {
    //         var $button = $(this);
    //         var id = $button.attr("aria-controls"); 
    //         var $pasteAction = $("#"+id).find(".paste-grid-row");
    //         var $grid = $button.closest(".appfire-grid");
    //         if ($pasteAction && $grid) {
    //             if ($grid.data("copySourceGridRow")) {
    //                 $pasteAction.prop("disabled", false);
    //                 $pasteAction.removeAttr("disabled");
    //             } else {
    //                 $pasteAction.prop("disabled", true);
    //                 $pasteAction.attr("disabled", "disabled");
    //             }
    //         } 
    //     }
    // });

    /**
     * This is basically the jQuery clone function but also takes care of cloning 
     * select lists and setting the proper selected values. For some reason jQuery
     * clone doesn't do that. 
     * We could have replaced the jquery clone but thought this was safer. 
     */
    (function($,undefined) {
        $.fn.clone2 = function(withDataAndEvents, deepWithDataAndEvents) {
            var $clone = this.clone(withDataAndEvents, deepWithDataAndEvents);
            var $origSelects = $('select', this);
            var $clonedSelects = $('select', $clone);
            $('select', this).each(function(i) {
                $clonedSelects.eq(i).val($(this).val());
            });
            return $clone;
        }
    })(jQuery);

    /**
     * Adds the $row to the $grid at the end.
     * @param {jQuery Object} $grid : Grid selector 
     * @param {jQuery Object} $row  : Row selector 
     */
    appcme.addGridRow = function($grid, $row) {
        appcme.clearValidationErrors($grid.closest("form"));
        
        if ($row) {
            $row = $row.clone2().hide();

            var uniqueId = appcme.uniqueId();
            var rowActions = $row.find(".row-actions");
            rowActions.find("button[aria-controls]").attr("aria-controls", uniqueId);
            rowActions.find("aui-dropdown-menu").attr("id" , uniqueId);

            $grid.append($row);
            appcme.numberGridRows($grid);
            appcme.scrollAndFocusToNewRow($grid, $row);
            $row.trigger('appfireEditorGridAddRowBeforeShow', [$row]);
            $row.show().trigger('appfireEditorGridAddRowAfterShow', [$row]);
        }
        return $row;
    }
    
    /**
     * Updates row numbers on the grid that is passed. 
     * @param {jQuery Object} $grid : Grid selector 
     */
    appcme.numberGridRows = function($grid) {
        $grid.find(".row-number").each(function(i) {
            $(this).text(i+1);
          });
    }
    
    /**
     * Generates a random unique id that can be used for element ids. 
     */
    appcme.uniqueId = function() {
        // Loop to be sure id is unique before returning 
        var id; 
        do {
            id = (Date.now().toString(36) + Math.random().toString(36).substr(2, 5)).toUpperCase();
        }
        while ($("#"+id).length);
        return id;
    }

    /**
     * Takes a text string in standard URL-encoded notation format and converts it into property list.  
     * If passed it uses the defaultParms to determine the native parameter type and default value
     * for each parm.  If a parm value matches the defaultValue it is removed from the map.
     * This handles all parm types except non-empty arrays for the default values. If you want support 
     * for arrays with something other than an empty array that support will need to be added 
     * at some point. An array type form element is typically a repeating id, such as columnStyles in AT. 
     * You actually get multiple parms by the same id in the serialized form. 
     * 
     * @param  {string}         parms           [Parameter string of form parms in URL-encoded format]
     * @param  {property list}  defaultParms    [Default values for the parms.  ]
     * @return {property list}                  [A cleansed list of formally typed parameters]
     */
    appcme.parseParameters = function(parms, defaultParms) {
        var result = {};
        var defaultMatches = [];
        if (parms) {
            var parmsAry = parms.split('&');
            $.each(parmsAry, function(i, pair) {
                if (pair) {
                    pair = appcme.splitFirst(pair, "="); //Split only by first occurrence of '='. Ex: columnAttributes=style="border:5px solid green;" fails with regular split.
                    var parmName = pair[0];
                    var val =  window.decodeURIComponent(pair[1].replace(/\++/g, '%20'));
     
                    /** 
                     * If the parm has already been processed and is in the results
                     * don't further process the parm.  
                     */
                    if (!result[parmName]) {
    
                        /** 
                         * if there are default parms sent in then check if the values from
                         * the form match the default vals. if there is match then don't add the form
                         * value to the results.  
                         */
    
                        if (defaultParms) {
    
                            /** grab the default value */
                            var defaultVal = defaultParms[parmName];
    
                            /** 
                             * Arrays have special processing. Because there could be multiple form 
                             * elements for an array we need to be sure and pull each one from the form and 
                             * create a comma-separated list for the return value.  
                             *
                             * Example: &a=1&a=2&a=3 results in a parm of "a=1,2,3"  
                             */
                            if ($.isArray(defaultVal)) {
    
                                var parmVals = "";
    
                                /** 
                                 * Loop through the parms again looking for only matching parms to the 
                                 * array parm.  
                                 *  
                                 * This is a bit of a hack since we are looping through the values in the form
                                 * and now we loop through them again looking for array matches.  
                                 */
                                var x = $.each(parmsAry, function(y, pairAry) {
                                    var valAry = appcme.splitFirst(pairAry, "="); //Split only by first occurrence of '='
                                    if (parmName == valAry[0]) {
                                        /**
                                         * Add a temp place holder for all missing parm values the replace 
                                         * it with a "". 
                                         * Example: a=1&a=&a=&a=4 results in a=1,,,4
                                         */
                                        var tempVal = valAry[1].length ? window.decodeURIComponent(valAry[1].replace(/\++/g, '%20')) : "*EMPTY*";
                                        parmVals += (parmVals.length) ? "," + tempVal : tempVal;
                                    }
    
                                });
    
                                parmVals = parmVals.replace(/\*EMPTY\*/g, "");
                                val = parmVals;
    
                            } else if (typeof(defaultVal) === "boolean") {
                                val = val === "on" ? true : false;
                            }
                            if (defaultVal == val) {
                                // Don't return a match to the default value
                                // Double-equal is intended here since we want values like "1" and 1 compared. 
                                defaultMatches.push(parmName);
                            } else {
                                // return the parm value
                                result[parmName] = String(val);
                            }
                        } else {
                            // no default so just return it
                            result[parmName] = val;
                        }
                    }
    
                }
            });
        }
        if (defaultParms) {
            $.each(defaultParms, function(key, val) {
                if (typeof(val) === "boolean" && val && !result[key] && !appcme.includes(defaultMatches, key)) {
                    /**
                     * This is special handling for checkboxes. When unchecked 
                     * its value will not be sent in the form data because it is a false checkbox.
                     * This hanldes any checkbox with a default value of true but has been set to 
                     * unchecked (false).
                     * It's expected that any checked (true/on) checkbox will have a value in the form data. 
                     */
                    result[key] = "false";
                } else if ($.isArray(val) && (typeof result[key] !== "undefined")) {
                    /**
                     * Any form parms that are arrays without values then remove them from the final result.
                     */
                    var stripped = result[key].toString().replace(/,/g, "");
                    if (stripped.length === 0) {
                        delete result[key];
                    }
                }
            });
        }

        return result;
    };

    /**
     * Converts the value to integer
     * 
     * @param {object} value            original value to be converted to int
     * @param {object} defaultValue     default value
     * @return {Number} Respective int value for proper data and default value for improper data 
     */
    appcme.convertToNumber = function(value, defaultValue) {

        // return default value for empty or null
        // ignore boolean value and 0 else false will always return default value
        if (!value && typeof(value) != "boolean" && value !== 0) {
            return defaultValue;
        }

        //if number just convert to number and return the same 
        if (!isNaN(value) || typeof(value) === "boolean") {
            return Number(value);
        }

        //string case
        if (typeof(value) === "string") {
            if (value === 'true' || value === 'false') {
                return value === 'false' ? 0 : 1;
            }
        }

        return defaultValue;
    };

    /**
     * Call this function to handle invalidating a form elements.  
     * Currently handles all form elements the same. We could do something custom for each
     * element if needed.  
     * Although you can call this directly it's also called automatically through the supported 
     * form validator that callers register. 
     * 
     * @param {jQuery object} $$elements The element(s) to be invalidated. 
     */
    appcme.invalidate = function($elements) { 
        if ($.isArray($elements)) {
            for (var index in $elements) {
                $elements[index].addClass("form-error");
            }
        } else {
            $elements.addClass("form-error");
        }
    }

    /**
     * Answers the question of a value is in the array. Shim for missing js function.
     * @param  {array} array1       the array to search
     * @param  {object} search      the value to search for
     * @param  {int} fromIndex      array index to start search from
     * @return {boolean}            true if it's in the array, false if not
     */
    appcme.includes = function(array1, search, fromIndex) {
        return array1.includes ? array1.includes(search, fromIndex) : array1.indexOf(search, fromIndex) >= 0;
    };

    /**
     * @param {string} relativePath the relative path to a resource
     * @return {string}             the absolute path
     */
    appcme.absolutePath = function(relativePath) {
        return AJS.contextPath() + relativePath; 
    };

    /**
     * Strictly types the list of parameters and fills out the list with any defaults that are missing.
     * This allows for the use of improved JS code when dealing with actual objects instead of strings 
     * for form parms.  
     * @param  {map}    defaults    [The default values for any parms]
     * @param  {[map]} parms        [The list of parms. ]
     * @return {[map]}              [Map of parms properly typed with defaults for all missing parms]
     */
    appcme.parametersToObj = function(defaults, parms, delimiter, quote) {
        //below code is to assign default values
        delimiter = delimiter || ",";
        quote = quote || "'";
        
        var opts = $.extend({}, {
            parms: parms,
            allowBlanks: []
        });

        var retVal = {};

        for (var key in opts.parms) {
            var val = opts.parms[key];

            //Handle case sensitive parameter names.
            //Update key if case does not match
            key = appcme.findCaseInsensitiveKeyAndUpdateParams(key, defaults, opts.parms);

            if (typeof defaults[key] !== 'undefined') { // key exists in both, check types and convert if needed:
                if (!val) { // value is empty, use default:
                    val = defaults[key];
                } else if (typeof defaults[key] === 'boolean') {
                    var booleanVal = opts.parms[key];
                    if (booleanVal === 'true' || booleanVal === 'false') {
                        val = eval(booleanVal);
                    } else if (booleanVal === 'on') {
                        val = true;
                    } else {
                        val = defaults[key];
                    }
                } else if ($.isNumeric(defaults[key])) { // number
                    //Any number parameter with true/false value will be mapped to 1/0 respectively. Eg: Heading and footing 
                    if(opts.parms[key] === "false"){
                        val = 0;
                    } else if (opts.parms[key] === "true") {
                        val = 1;
                    } else {
                        val = appcme.convertToNumber(opts.parms[key], defaults[key]);
                    }
                } else if ($.isArray(defaults[key])) { // array
                    val = $.map(appcme.split(opts.parms[key], delimiter, quote), function(ele) {
                        ele = ele.trim();
                        return $.isNumeric(ele) ? Number(ele) : ele;
                    });
                }
            }

            // convert blank value if specified:
            if (val === '@blank' && appcme.includes(opts.allowBlanks, key)) {
                val = '';
            }

            retVal[key] = val;
        }

        // iterate over defaults and add things not already present:
        for (var key in defaults) {
            if (typeof retVal[key] === 'undefined') {
                retVal[key] = defaults[key];
            }
        }

        return retVal;
    };

    appcme.buildMacroRenderRequest = function(macroDetails, macroParams ) {
        var macroRenderRequest = {
                contentId: Confluence.Editor.getContentId(),
                macro: {
                    name: macroDetails.name,
                    params: macroParams,
                    //defaultParameterValue: "", //TODO: I do not see this in native preview rest API call. Is this really needed??
                    body: macroDetails.body ? macroDetails.body : "" //if body is null, then send empty body eg: when macro inserted through insert macro dialog
                }
            };
        return macroRenderRequest;
    }
        
    appcme.refreshPreview = function(previewData, macroRenderRequest){

        $.ajax({
            url: AJS.contextPath()+"/rest/tinymce/1/macro/preview", 
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(macroRenderRequest),
            beforeSend: function() {
                previewData.find(".editor-preview-iframe").remove();
                previewData.find(".appfire-preview-data").hide(); 
                previewData.find(".appfire-preview-loading").show();
            },
            error: function(jqXHR,  textStatus,  errorThrown) {
                previewData.find(".appfire-preview-loading").hide();
                var preview = previewData.find(".appfire-preview-data");
                preview.show();
                preview.appendTo(errorThrown);
            },
            success: function(data, textStatus, jqXHR) {
                previewData.find(".appfire-preview-loading").hide();
                previewData.find(".appfire-preview-data").show();

                var $iframe = $('<iframe frameborder="0" class="appfire editor-preview-iframe"></iframe>');
                $iframe.appendTo(previewData.find(".appfire-preview-data"));

                var w = $iframe[0].contentWindow.document;
                $iframe.on('load', function() {

                    // setting height and width avoids the extra scrollbars on the dialog
                    var $frame = $(this);
                    $frame.width("99%");
                    $frame.height("99%");
                    // reach into the iframe and snug the preview contents a tad to better fill in the preview data area
                    var $main = $frame.contents().find("#main");
                    $main.css("padding-left", "0px");
                    $main.css("padding-top", "0px");

                });

                w.open();
                w.write(data);
                w.close();
            },
            complete: function(jqXHR, textStatus, errorThrown) {
            }
        });
    }

    appcme.showEditorDialog = function($ed, macroDetails) {

        $ed.hide().appendTo("#wysiwyg").trigger('appfireEditorBeforeShow', [$ed, macroDetails]);
        $ed.find('.content-panel').hide(); // hide all content panes before displaying
        AJS.tabs.setup(); // setup any tabs on any pages

        /* Select the first tab as the active tab. If the macro has set a different
        * panel to be active then override it.  If not set the click is ignored. 
        */
        $ed.find('.appfire-navigation [data-index="0"]').click(); 
        $ed.find('.appfire-navigation [data-active-panel]').click();
        
        AJS.dialog2($ed).show();    
        $ed.trigger('appfireEditorAfterShow', [$ed]);

        // TODO manually setting height of our internal content area:
        var content = $ed.find('.aui-dialog2-content');
        content.children(':first').height("520px"); // TODO pull height from data attribute.  content.height());

        return $ed;
    }

    appcme.setMacroJsOverride = function(macroName, defaultParms, editorGenerator) {
        var previewOnloadCache = null; // Setting to null to improve debugging experience to check for multiple calls 
        AJS.MacroBrowser.setMacroJsOverride(macroName, { 
            /**
             * When inserting a new macro,  since no params set, the macroDetails wont contain any of macro params except "atlassian-macro-output-type"
             */
            opener: function(macroDetails) {
                //SQL-908/TBLSORT-122 - grab their current place in page and save before dialog display and then restore bookmark before insert/replace
                AJS.Rte.BookmarkManager.storeBookmark();
                var editorGen = editorGenerator(macroDetails); 
                var validator = editorGen.validator;
                
                //pass contextPath to be used by preview icons
                editorGen["contextPath"]=AJS.contextPath();
                
                var editorDialog = $(org.swift.confluence.editor.editorMain(editorGen));

                // Place macro name on dialog.  This is primarly used in selector for event handling. 
                editorDialog.attr("data-appfire-macro-name", macroDetails.name);
                // For good measure add the macroDetails as a data object to the dialog.
                editorDialog.data("macroDetails", macroDetails);
                // apps can pass in any extra data attributes to be stashed on the dialog. 
                if (editorGen.dataAttributes) {
                    $.each( editorGen.dataAttributes, function( prop, value ) {
                        editorDialog.attr("data-"+prop, value);
                    });    
                }

                //Added macroDetails so that macro body can be checked in csv and json-table "appfireEditorBeforeShow" handlers
                appcme.showEditorDialog(editorDialog, macroDetails);

                editorDialog.find("#editor-save-button").click(function(e) {

                    var errors = []; // array of properties for errors
                    var $form = $(this).closest("form"); 

                    editorDialog.trigger("appfireEditorBeforeSerialize", [editorDialog, $form, defaultParms, errors]);
                    
                    if (!validate(validator, errors, editorDialog, $form)) {
                        return false;
                    }

                    var parms = appcme.parseParameters($form.serialize(), defaultParms);

                    editorDialog.trigger("appfireEditorBeforeSave", [parms, editorDialog, $form, defaultParms, macroName]); //macroName is needed in the trigger handler

                    var macroRenderRequest = appcme.buildMacroRenderRequest(macroDetails, parms);
                    //Update macro body before insertMacro in the editor
                    editorDialog.trigger("appfireEditorBeforeMacroRender", [macroRenderRequest]);
                    
                    //SQL-908/TBLSORT-122 - Restore bookmark before insert/replace
                    AJS.Rte.BookmarkManager.restoreBookmark();
                    tinymce.confluence.MacroUtils.insertMacro(macroRenderRequest);
                    AJS.dialog2(editorDialog).remove();

                    return false;
                });

                editorDialog.find(".editor-dialog-close").click(function(e) {
                    AJS.dialog2(editorDialog).remove();
                    return false;
                });

                AJS.dialog2(editorDialog).on("hide", function(evt) {
                    
                    // This is a hack for https://ecosystem.atlassian.net/servicedesk/customer/portal/14/DEVHELP-1605
                    // For some reason the aui control hide event is propogating to the dialog.  This causes the dialog
                    // to close unexpectedly.  
                    var $target = $(evt.target);
                    if ($target.is(".aui-dropdown2")) {
                        return false;
                    }
                    // Restore to cached original preview function 
                    AJS.MacroBrowser.previewOnload = previewOnloadCache;
                    previewOnloadCache = null; // maybe for sake of easier debugger reset to null value. 
                    
                    $(this).remove();
                    $('aui-inline-dialog').remove(); //On hiding editor dialog, remove the inline dialogs as well.
                }); 

                editorDialog.find(".appfire-preview-show").on('click', function(e) {

                    var previewActions = editorDialog.find(".appfire-preview-actions");            
                    previewActions.find(".appfire-preview-hide").show();
                    previewActions.find(".appfire-preview-show").hide();

                    var $form = $(this).closest("form");
                    $form.find(".appfire-empty-content").css("text-align", "center");
                    /* 
                    ** More bits of code to hande the open/close of preview. 
                    */
                    editorDialog.find('[data-collapsible]').each(function(i, ele) {
                        $(ele).removeClass($(ele).data('collapsible')).addClass('col-');
                    });

                    editorDialog.find(".appfire-grid").each( function () { 
                        var $masterRow = $(this).data("masterGridRow");
                        if ($masterRow){
                            $masterRow.find('[data-collapsible]').each(function(i, ele) {
                                $(ele).removeClass($(ele).data('collapsible')).addClass('col-');
                            });
                        }
                    });

                    editorDialog.find(".appfire-preview-refresh").click();
                    e.preventDefault();
                });

                editorDialog.find(".appfire-preview-refresh").on('click', function(e) {
                    
                    var errors = []; // array of properties for errors
                    var $form = $(this).closest("form"); 

                    editorDialog.trigger("appfireEditorBeforePreviewSerialize", [editorDialog, $form, defaultParms, errors]);

                    validate(validator, errors, editorDialog, $form);                    
                    var parms = appcme.parseParameters($form.serialize(), defaultParms);
                    editorDialog.trigger("appfireEditorBeforePreview", [parms, editorDialog, $form, defaultParms, macroName]);
                                        
                    var previewData = editorDialog.find(".appfire-preview-container");
                    previewData.show();
                    editorDialog.trigger("appfireEditorAfterPreviewShow", [editorDialog]);
                    
                    var macroRequest = appcme.buildMacroRenderRequest(macroDetails, parms);
                    
                    //Update macro body before calling preview
                    editorDialog.trigger("appfireEditorBeforeMacroRender", [macroRequest]); 
                    
                    appcme.refreshPreview(previewData, macroRequest);

                    e.preventDefault();
                });

                editorDialog.find(".appfire-preview-hide").on('click', function(e) {
                    var $form = $(this).closest("form"); 
                   
                    var $previewData = $form.find(".appfire-preview-container");
                    $previewData.hide();
                    editorDialog.trigger("appfireEditorAfterPreviewHide");

                    $previewData.find(".editor-preview-iframe").remove(); 
                    $form.find(".appfire-preview-hide").hide();
                    $form.find(".appfire-preview-show").show();

                    $form.find(".appfire-empty-content").css("text-align", "left");
            
                    /* The following bits of code are here to reformat the grid row contents that have the 
                    ** "data-collapsible" class.  This exists to get the responsiveness of the grid when the 
                    ** preview is opened and closed.  
                    */
                    $form.find('[data-collapsible]').each(function(i, ele) {
                        $(ele).removeClass('col-').addClass($(ele).data('collapsible'));
                    });
                    $form.find(".appfire-grid").each( function () { 
                        var $masterRow = $(this).data("masterGridRow");
                        if ($masterRow){
                            $masterRow.find('[data-collapsible]').each(function(i, ele) {
                                $(ele).removeClass('col-').addClass($(ele).data('collapsible'));
                            });
                        }
                    });
                
                    e.preventDefault();
                });
                
                //NTBL-60: Here is what suggested on https://jira.atlassian.com/browse/CONFSERVER-36767
                // We need to cache the preview inorder to restore it when the dialog goes away so other apps 
                // will continue to work. 
                previewOnloadCache = AJS.MacroBrowser.previewOnload;
                AJS.MacroBrowser.previewOnload = function(b) {
                    return;
                }
                
            }
        });
        
    }

    /**
     * This function validates the input fields with type=number and not allowed to carry -ve value.
     */
    appcme.validatePositiveInteger = function (errors){
        var contentPane = $(".appfire-content-panes");
        var numberFields = contentPane.find("input[type=number]:invalid");
        appcme.addValidationError(numberFields, errors);
    }
    
    /**
     * Find the associated labels of the elements which failed validation and push to errors.
     */
    appcme.addValidationError = function(elements, errors){
        elements.each(function(index, element) {
            var labelText = appcme.getDisplayLabelText($(this));
            var errorText = AJS.format("{0} must be a positive integer.", labelText)
            errors.push({ ele: $(element), msg: errorText }); 
        }); 
    }
    
    /**
     * Get the label text associated with the element
     */
    appcme.getDisplayLabelText = function(element){
        var contentPane = $(".appfire-content-panes");
        var elementName = contentPane.find("label[for='" + element.attr('id') + "']").find(".appfire-editor-label-span").text();
        if(elementName === ""){
            elementName = element.attr('name'); //if no label associated with this element, consider element's name attribute
        }
        return elementName;
    }
    
    /**
     * Customized string split method to ignore delimiter within given quotes.
     * Note: It does not handle nested single quotes. Single quote must be escaped with another single quote ('').
     * 
     * @param {string} $str The string to split. 
     * @param {string} $delimiter The delimiter on which split to be happened. 
     * @param {string} $quote The quote to be considered while spltting. 
     */
    appcme.split = function($str, $delimiter, $quote) {
        if ($str == null) {
            return [];
        }
        var regexPattern = $delimiter + "(?=(?:[^" + $quote + "]*" + $quote + "[^" + $quote + "]*" + $quote + ")*[^" + $quote + "]*$)";
        return $str.split(new RegExp(regexPattern, "gi"));
    };
    
    /**
     * Customized string split method to split on first occurrence of given delimiter.
     * 
     * @param {string} str The string to split. 
     * @param {string} delimiter The delimiter on which split to be happened. 
     */
    appcme.splitFirst = function(str, delimiter) {
        if (str == null || str.length == 0) {
            return [];
        }
        var index = str.indexOf(delimiter);
        if (index == -1) {
            return [str, ""];
        } else {
            return [str.substring(0, index), str.substring(index + 1)];
        }
    };
    
    /**
     * Decodes the given encoded HTML content.
     * @param {string} html The encoded html string. 
     */
    appcme.decodeHtml = function(html) {
        var txt = document.createElement("textarea");
        txt.innerHTML = html;
        return txt.value;
    }
    
    /**
     * This is a private function that is used to support form validation.  
     * 
     * @param {function} validator The caller's validation function. Returns a boolean. 
     * @param {array} errors An array of properties for each error. {ele: jQuery element, msg: message string with html}
     * @param {jQuery} $editorDialog The customer editor dialog. 
     * @param {jQuery} $form The form in the editor.  
     */
    var validate = function(validator, errors, $editorDialog, $form) { 
        appcme.clearValidationErrors($form);
        
        if (validator) {
            validator($editorDialog, $form, errors)
        }

        if  (errors.length) {
            var body = "";
            $(errors).each(function() {
                body += this.msg;
                if ( this.ele) {
                    appcme.invalidate(this.ele);
                }
            });
            var $icon = $("#show-editor-error");
            var $msg = $("#editor-error-msg");
            $msg.find(".body").html(body);
            $icon.show();
            $msg.attr("open", "");
            //focus the first error element's tab
            highlightFirstErrorElementTab(errors[0].ele);
        }

        return errors.length == 0; 
    }
    
    /**
     * Highlight the tab, where the 1st validation error element belongs to
     */
    var highlightFirstErrorElementTab = function($elements) {
        var firstErrorElement = $elements;
        if ($.isArray($elements)) {
            firstErrorElement = $elements[0];
        } 
        if(firstErrorElement){
            var targetContentPanelIndex = firstErrorElement.closest('.content-panel').index(); //get index of the .content-panel where the first error element belongs to
            $('.appfire-navigation [data-index='+targetContentPanelIndex+']').click(); //Go to corresponding nav pane
            var tabId = firstErrorElement.closest(".tabs-pane").attr("id"); //get the tabId where the first error element belongs to
            if(tabId){
                AJS.tabs.change($('a[href="#'+tabId+'"]')); 
            }
        }
    }
    
    /**
     * This function is used to clear form validation errors.  
     * 
     * @param {jQuery} $form The form in the editor.
     */
    appcme.clearValidationErrors = function ($form) {
        var $icon = $("#show-editor-error");
        var $msg = $("#editor-error-msg");
        $msg.find('#custom-error-content').remove(); //Remove custom error content added by any other app.
        $msg.find('#default-error-content').show();
        $icon.removeClass('aui-iconfont-warning');//Remove classes added by any other app.
        $icon.removeClass('custom-icon-align'); //If warning icon added, the default alignment doesnot look good, so to align custom class if added remove that.
        $icon.addClass("aui-iconfont-error");
        $icon.hide();
        $msg.removeAttr("open");
        
        $form.find(".form-error").removeClass("form-error");
    }

    /**
     * This is a private function to find key from default parameters with case insensitive match.
     * 
     * @param {jQuery} key - key to match in default parameters.
     * @param {jQuery} defaults - default parameters.
     * @param {jQuery} parms - actual parameters list to update key.
     */
    appcme.findCaseInsensitiveKeyAndUpdateParams = function (key, defaults, parms) {
        if (key != null && defaults != null && typeof defaults[key] === 'undefined') {
            for(var prop in defaults) {
                if(prop.toLowerCase() == key.toLowerCase()) {
                    if (parms != null && parms.hasOwnProperty(key)) {
                        parms[prop] = parms[key];
                        delete parms[key];
                    }
                    return prop;
                }
            }
        }
        return key;
    }
    
    /**
     * To scroll to bottom of grid and set focus to input field in given row.
     * 
     * @param {jQuery} $grid - Grid selector.
     * @param {jQuery} $row - Current row selector.
     */
    appcme.scrollAndFocusToNewRow = function ($grid, $row) {
        $grid.animate({
            scrollTop: $grid.scrollHeight
        }, 1000);
        $row.find(":input:visible:not([disabled]):first").focus();
    }
    
    /**
     * To scroll to top of the grid and set focus to first input field found in the grid.
     * 
     * @param {jQuery} $grid - Grid selector.
     */
    appcme.scrollAndFocusToFirstRow = function ($grid) {
        $grid.scrollTop(0);
        $grid.find(".appfire-row:first").find(":input:visible:not([disabled]):first").focus();
    }

}(window.appcme = window.appcme || {}, AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/js/common-table-editor.js' */
/*
 * Copyright (c) 2019 Appfire Technologies, Inc.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Bob Swift Atlassian Add-ons EULA"
 * (https://bobswift.atlassian.net/wiki/x/WoDXBQ) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */

//To make these props and functions accessible outside, embedded in namespace
//Note: Whenever we plan to release AT next, we can use these one and remove the duplicated ones from AT
(function(tablebasecme, $, undefined) {
    'use strict';
    
    /**
     * Macro params common to all table macros with default values
     * Param Count=20
     * TODO: AT (common-editor.js) has the duplicate of this, shall be deleted when plan to release next.
     */
    tablebasecme.commonTableParams = {
        allowExport: false,
        exportFileDelimiter: "Comma",
        displayDataFilter: false, //TBL-1147, TBL-1274
        autoNumber: false,
        autoTotal: false,
        class: "@default",
        columnAttributes: [],
        columnCalculations: [],
        columnStyles: [],
        columnTypes: [],
        enableHeadingAttributes: true,
        enableHighlighting: true,
        enableSorting: true,
        highlightColor: "lightgoldenrodyellow",
        id: "", 
        retainRowStyleOrder: true,
        rowStyles: [],
        autoTotalRowStyle: "",
        applyRowStyleToCell: false,
        applyColStyleToCell: false,
        sortColumn: "",
        sortDescending: false,
        sortIcon: false,
        sortTip: "", 
        style: ""
    }
    
    tablebasecme.DELIMITER = ',';
    tablebasecme.QUOTE = '"';
    
    //Any validation for common table params in Table settings, row settings and column settings panels is done in this method. 
    //As this is common set of params for all table related addons, any changes needed can be done locally and no need to pass selectors.
    tablebasecme.validateCommonTableParams = function(dialog, errors) {
        var contentPane = dialog.find(".appfire-content-panes");
      //columns which allow text and number as well, and when  -ve number is not allowed
        var elementsToValidate = "input[name=sortColumn], input[name=border], input[name=width]"; 
        var elements = contentPane.find(elementsToValidate).filter( function() { 
            if($.isNumeric($(this).val()) && !($(this).val() > 0)){
            return true;
            }
        });
        appcme.addValidationError(elements, errors); 
        
        validateExportFileDelimiter(dialog, errors);
        return appcme.validatePositiveInteger(errors);
    }
    
    function validateExportFileDelimiter(dialog, errors){
        if(dialog.find('#exportFileDelimiter').val() == 'Other' && dialog.find('#allowExport').prop('checked')){
            var otherDelim = dialog.find('#exportFileDelimiterOther');
            if(otherDelim.val() == '')
                errors.push({ ele: otherDelim, msg: "<p>" + AJS.format("{0} cannot be empty.",  'File delimiter') + "</p>"});
        }
    }
    
    $(document).on('appfireEditorGridAddRowBeforeShow', "[data-commontableeditor]", function(evt, newRow) {
        
        //If show col attrs menu item is checked when adding new row, display the col attr field.
        if($("#show-hide-col-attrs").attr("checked"))
            newRow.find(".column-attributes").attr("style","");
    });

    $(document).on('appfireEditorBeforeSave appfireEditorBeforePreview', "[data-commontableeditor]", function(evt, macroParms, dialog, form, defaultParms) {
        // Place code here to update the actual macro parms before the saving to the actual macro on the page
        // example: macroParms["newParm"] = "NewValue";
    
        // headerRowStyle shall be prefixed to rowStyles macro param
        if(macroParms.rowStyles || macroParms.headerRowStyles){
            macroParms.rowStyles = (macroParms.headerRowStyles ? macroParms.headerRowStyles : "") + (macroParms.rowStyles ? "," + macroParms.rowStyles : "");
        }
        delete macroParms["headerRowStyles"];
    
        /**
         * If autoNumber enabled, prepend autoNumberColStyles to columnStyles
         */
        var columnStyles = ''; //initalize it else undefined is taken when colStyles  appended in below code
        if(macroParms["autoNumber"]){
            if(macroParms["autoNumberColStyles"] && macroParms["autoNumberColStyles"].trim() !== ""){
                columnStyles = macroParms["autoNumberColStyles"] ;
            }
            
            if(macroParms["columnStyles"] && macroParms["columnStyles"].trim() !== "" ){
                columnStyles = columnStyles + "," + macroParms["columnStyles"];
            }
            macroParms["columnStyles"] = columnStyles;
        }
        //if there is no autoNumberColStyles then delete param
        if(!macroParms["autoNumberColStyles"]){
            delete macroParms["autoNumberColStyles"]; 
        }
        
        //if allowExport enabled, save the exportFileDelimiter
        if(macroParms["allowExport"]){
            if(macroParms["exportFileDelimiter"] == "Other" ){
                macroParms["exportFileDelimiter"] = encodeURIComponent(dialog.find("#exportFileDelimiterOther").val());
            }
        }
        else{
            delete macroParms["exportFileDelimiter"];
           
        }
        delete macroParms["exportFileDelimiterOther"];
    });
    
    function toggleOtherDelimTextbox (exportDelimiter, thisForm){
        var otherDelim = thisForm.find('#exportFileDelimiterOther');
        if(exportDelimiter.val() == 'Other'){
            var otherDelimVal = otherDelim.val();
            if(otherDelimVal && otherDelimVal.length > 1){ //decode only if its encoded
                otherDelim.val(decodeURIComponent(otherDelimVal));
            }
            otherDelim.show();
        }
        else{
            otherDelim.hide();
        }
    }
    $(document).on('change', '#exportFileDelimiter', function(evt) {
        var thisForm = $(this).closest("form");
        toggleOtherDelimTextbox($(this), thisForm);
    });

    /**
     * Event handler for all editors requiring common table macro support.
     */
    $(document).on('appfireEditorBeforeShow', "[data-commontableeditor]", function(evt, editor) {
    
        // Create the template row used for any new grid row adds and hang it off of each grid. 
        // This is the only step necessary to setup the different grids used.  
        //
        // Column positions grid
        var $row = $(org.swift.confluence.table.editor.columnPositionRow({position: 0, columnAttributes: "", columnCalculations: "", columnStyles: "", columnTypes: ""}));
        $("#column-positions").data("masterGridRow", $row); 
        // Row positions grid (data rows, not header rows since there is only at most one of those)
        $row = $(org.swift.confluence.table.editor.rowPositionRow({position: 0, rowStyles: ""}));
        $("#row-positions").data("masterGridRow", $row);  
        
        //If exportFileDelimiter is set to any other char i.e not comma, semicolon, tab or space, then display the other textbox
        var exportFileDelimiter = editor.find('#exportFileDelimiter');
        toggleOtherDelimTextbox(exportFileDelimiter, editor);
    });
 
    $(document).on('change', '.column-calculations-select, .column-types-select', function(event) {
        var $this = $(this);
        var thisVal = $this.val();
        var val = $this.find('aui-option').filter( function(){
            if( $(this).val() === (thisVal)){
                return true;
            }
        });
        if(val){
            val = val.html();
        }
        var displayVal = $this.find("input").val(); 
    
        // special code to handle when user types into the edit box.  
        if (displayVal == val) {
            // value selected from list to assign to parameter through hidden input.
            val = $this.val();
        } else if (appcme.decodeHtml(displayVal) == val) {
            //There is html encoding issue with aui-select
            //code to update the selected input text from option text.
            $this.find("input").val(val);
            $this.find("select").find(`option[value="${thisVal}"]`).text(val);
            
            //use value of selected option.
            val = thisVal;
        } else {
            // value typed into edit box 
            val = displayVal;
        }
        $this.siblings('input:hidden').val(val);
    });
    
    $(document).on("click", "#show-hide-empty-pos-rows", function(evt) {
        if (evt.target.isChecked()) {
            // Show all the empty rows
            $(".show-hide-empty").show();
        } else {
            $(".show-hide-empty").each( function () { 
                var inputs = $(this).find(":input").filter( function() { 
                    return this.value;
                });
                if (!inputs.length) {
                    $(this).hide();
                } 
            });
        }
    });
    
    
    $(document).on("click", "#show-hide-col-attrs", function(evt) {
        if (evt.target.isChecked()) {
            $(".column-attributes").show();
        } else {
            $(".column-attributes").hide();
        }
    });
    
    /**
     * Handles the transition from the empty state by adding rows to 
     * either the column formats or the data row formats. 
     * 
     * This could be common I think with a bit of refactoring.   
     */
    $(document).on("click", ".start-formatting", function(e) {
    
        var $empty = $(this).closest(".appfire-empty-content"); 
        var $error = $empty.find(".error");
        $error.hide(); 
    
        var rows = Number($empty.find(".rows-to-add").val()); 
        if (rows >= 0 && rows <= 30) {
    
            var $grid = $empty.closest(".appfire-grid");
            var $row = $grid.data("masterGridRow"); 
    
            for (var i = 0; i < rows; i++) {
                appcme.addGridRow($grid, $row);        
            }
    
            var $gridSet = $empty.closest(".appfire-grid-set");
            $gridSet.find(".grid-empty-msg").hide();
            $gridSet.find(".grid-bar").show(); 
            $grid.show();
            //To scroll to first row added.
            appcme.scrollAndFocusToFirstRow($grid);
        } else {
            $error.show(); 
        }
    
        e.preventDefault();
    });

}(window.tablebasecme = window.tablebasecme || {}, AJS.$));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'org.swift.confluence.tablesorter:macroeditor-resources', location = '/table-editor/js/common-datalocation-editor.js' */
/*
 * Copyright (c) 2019 Appfire Technologies, Inc.
 * All rights reserved.
 *
 * This software is licensed under the provisions of the "Bob Swift Atlassian Add-ons EULA"
 * (https://bobswift.atlassian.net/wiki/x/WoDXBQ) as well as under the provisions of
 * the "Standard EULA" from the "Atlassian Marketplace Terms of Use" as a "Marketplace Product"
 * (http://www.atlassian.com/licensing/marketplace/termsofuse).
 *
 * See the LICENSE file for more details.
 */

//TODO: have a better namespace??
/**
 * This namespace contains all the event handlers and methods related to data location fields i.e space, page, attachment
 * @param tablebasecme
 * @param $
 * @param undefined
 * @returns
 */
(function(tablebasecme, $, undefined) {
    'use strict';
    
    tablebasecme.CURRENT_SPACE = "Current space";
    tablebasecme.CURRENT_SPACE_WITH_KEY = tablebasecme.CURRENT_SPACE + " (" + AJS.params.spaceKey + ")";
    tablebasecme.CURRENT_PAGE = "Current page" + " (@self)";
    tablebasecme.NO_ATTACHMENT_FOUND = "No attachments found";
    
    tablebasecme.specialPageValues = {
            "@parent" : "Current page parent" + " (@parent)",
            "@home" :  "Current space home page"  + " (@home)",
            "@self" : tablebasecme.CURRENT_PAGE
    }
    
    tablebasecme.specialSpaceValues = {
            "Current space": tablebasecme.CURRENT_SPACE_WITH_KEY
    }
    
    /**
     * This method is useful for macros which supports 'script' macro param (i.e supports attachment, filename, template through script param)
     */
    tablebasecme.splitScriptParam = function(macroParams){
        //For csv and json-table macro, split script param into (attachment,attachmentPage) or filename or template params if script val contains attachment reference
        if(macroParams.script){
            //if attachment
            if(macroParams.script.indexOf("^") >= 0){
                //split attachment page to space and page
                var spaceKey;
                var pageTitle;
                var attachment;
                var page = macroParams.script.substring(0, macroParams.script.indexOf("^"));
                if(page){
                    if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase().trim())){
                        spaceKey = ""; //Do not set current space by default
                        pageTitle = page;
                    }
                    else{
                        if(page.indexOf(":") > 0){
                            spaceKey = page.substring(0, page.indexOf(":"));
                            pageTitle = page.substring(page.indexOf(":") + 1, page.length);
                        }
                        else{
                            //space not given
                            spaceKey = tablebasecme.CURRENT_SPACE;
                            pageTitle = page;
                        }
                    }
                }
                else{ //page is empty
                    spaceKey = tablebasecme.CURRENT_SPACE;
                    pageTitle = tablebasecme.CURRENT_PAGE;
                }
                attachment = macroParams.script.substring(macroParams.script.indexOf("^")+1, macroParams.script.length);
                $.extend(macroParams, {attachmentPage: macroParams.script, attSpace: spaceKey, attPage: pageTitle, attachment: attachment});
            }
            //if filename
            else if(macroParams.script.indexOf("#") >= 0){
                var fileName = macroParams.script.substring(macroParams.script.indexOf("#")+1, macroParams.script.length)
                $.extend(macroParams, {filename: fileName});
            }
            else{ //template
                $.extend(macroParams, {template: macroParams.script});
            }
        }
        return macroParams;
    }

    //private method for validating select2 datalocation field
    var validateSelect2DataLocationField = function(contentPane, field, errors, elementName){
        var element = contentPane.find(field);
        if(element.length && element.val().trim() === ""){
            errors.push({ ele: element, msg: "<p>" + AJS.format("{0} cannot be empty.", elementName) + "</p>"});
        }
    }
    
   // TODO:  If we have more text fields that needs empty validation,  this can be refactored as a generic one, and then may be move to common-table-editor.js??
    var validateDataLocationField = function(contentPane, field, errors){
        var element = contentPane.find(field);
        if(element.length && element.val().trim() === ""){
            var elementName = appcme.getDisplayLabelText(element);
            errors.push({ ele: element, msg: "<p>" + AJS.format("{0} cannot be empty.", elementName) + "</p>"});
        }
    }
    
    tablebasecme.validateDataLocationFields = function(dialog, errors){
        var contentPane = dialog.find(".appfire-content-panes");
        
        var dataLocation = contentPane.find(".appfire-table-datalocation");
        if(dataLocation.val() === 'attachment'){
            validateSelect2DataLocationField(contentPane, "#attSpace", errors, "Space");
            validateSelect2DataLocationField(contentPane, "#attPage", errors, "Page"); //send element name for select2 fields 
            validateSelect2DataLocationField(contentPane, "#attachment", errors, "Attachment");
        }
        else if(dataLocation.val() === 'filename'){
            validateDataLocationField(contentPane, "#filename", errors);
        }
        else if(dataLocation.val() === 'template'){
            validateDataLocationField(contentPane, "#template", errors);
        }
        else if(dataLocation.val() === 'url'){
            validateDataLocationField(contentPane, "#url", errors);
        }
        else if(dataLocation.val() === 'profile'){
            validateSelect2DataLocationField(contentPane, "#profile", errors, "Profile");
        }
    }
    /**
     * On load of data source tab, display right fields based on chosen dataSource
     */
    var displayRightDataLocationFields = function(dataLocationFields, selectedDataSource){
        dataLocationFields.hide(); //hide all datasource fields
        $("." + selectedDataSource.val() + "-group").show(); //show only the required datasource fields 
    }
    /**
     * On datasource change, display right fields based on chosen dataSource
     */
    $(document).on('change', ".appfire-table-datalocation", function() {
        var dataLocationFields = $(this).closest("form").find(".datalocation-fields");
        displayRightDataLocationFields(dataLocationFields , $(this));
        // Set default values of space and page to current space and current page
        //if "attachment" chosen, set default values for space and page
        if($(this).val() === "attachment") {
            var space = dataLocationFields.find("#attSpace"); //TODO: think of better way instead of using id, not able to use class because with class name, more than 1 field found as select2 adds the class to dynamically created elements.
            var page = dataLocationFields.find("#attPage");
            if(space.val() === ""){
                space.auiSelect2("val",tablebasecme.CURRENT_SPACE);
            }
            if(page.val() === ""){
                page.auiSelect2("val",tablebasecme.CURRENT_PAGE);
            }
        }
     });
    
    /**
     * On change of space, empty page element, attachments element.
     */
    $(document).on('change', '.datalocation-space', function() {
        var dataLocationFields = $(this).closest(".datalocation-fields");
        dataLocationFields.find("#attPage").auiSelect2("val","");
        dataLocationFields.find("#attachment").auiSelect2("val","");
    });
    
   //Set space empty for special page values
    var setSpaceForSpecialPageValues = function(dataLocationFields, dataLocationSpace, dataLocationPage){
        var page = dataLocationPage.val();
        if(page && tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase())){ 
            dataLocationSpace.auiSelect2("val", AJS.params.spaceKey);
            dataLocationFields.find("#s2id_attSpace").find(".select2-chosen").text(tablebasecme.CURRENT_SPACE_WITH_KEY); 
        }
    }
    
    
    /**
     * On change of page, empty attachments field.
     * if its special value, then set space empty on UI, but space value is actually current space.
     * If page first selected special val, then chosen some other page, show space current space.
     * 
     */
    $(document).on('change', '.datalocation-page', function() {
        var dataLocationFields = $(this).closest(".datalocation-fields");
        dataLocationFields.find("#attachment").auiSelect2("val","");
        //if page changed to @self, @home or @parent then set space select2 value and text to current space
        setSpaceForSpecialPageValues(dataLocationFields, dataLocationFields.find("#attSpace"), $(this));
    });
    
    $(document).on('appfireEditorAfterShow', "[data-datalocationfields=true]", function(evt, editor) {

        //TODO: Find a better approach. 
        //Issue: When select2 field available on editor load, it does not allow to type in for search until an extra click is done.
        //Tried click other elements available around, but that does not work.
        // Workaround : Simply open and close the Space select2. 
        var dataLocationFields = editor.find(".datalocation-fields");
        var dataLocationSpace = dataLocationFields.find("#attSpace");
        if(dataLocationSpace.is(':visible')){
            dataLocationSpace.select2("open");
            dataLocationSpace.select2("close");
        }
        
        //For specialPageValues, set space blank
        setSpaceForSpecialPageValues(dataLocationFields, dataLocationSpace, dataLocationFields.find("#attPage"));
    });
    
    $(document).on('appfireEditorBeforeShow', "[data-datalocationfields=true]", function(evt, editor, macroDetails) {
        var dataLocationFields = editor.find(".datalocation-fields");
        var methodOfLocatingData = editor.find(".appfire-table-datalocation");
        displayRightDataLocationFields(dataLocationFields, methodOfLocatingData);
        
        //These elements are being referred multiple times hence the variables initialised so that it can be referred.
        var dataLocationFields = editor.find(".datalocation-fields");
        var dataLocationSpace = dataLocationFields.find("#attSpace"); //Using id here, because with class name, more than 1 field found as select2 add the class to dynamically created elements.
        var dataLocationPage = dataLocationFields.find("#attPage");
        var dataLocationAttachment = dataLocationFields.find("#attachment");
        
        //If profile to be supported in method of locating script, then load profiles. As of now its supported fro csv and json-table macros
        if(editor.find(".profile-group").length){
        //If no profiles configured, remove profile option from 'Method of locating script' select list
        //And If there are configured profiles, then load them to profile field
          $.getJSON(AJS.contextPath() + '/rest/bobswift/table/1.0/getprofiles').done(
              function(data){
              if(!(data && data.length)) {
                 //console.log("No profiles found"); 
                  methodOfLocatingData.find("option[value='profile']").remove();
              }else{
                      var profileList = $.map(data, function(item) {
                          return { id: item, text: item }; 
                      });
                      var profile = dataLocationFields.find("#profile");
                      if(profile.length){
                          profile.auiSelect2({
                              placeholder: "Select a profile...",
                              allowClear: true,
                              multiple: false,
                              data: profileList,
                              initSelection: function(element, callback) {
                                  callback({
                                       id: element.val(),
                                       text: element.val() ? element.val() : "Select a profile..."
                                   }); 
                              },
                              formatNoMatches: function (term) {
                                  return "No profiles found.";
                              },
                          });
                      }
                  }
              
              displayRightDataLocationFields(dataLocationFields, editor.find(".appfire-table-datalocation"));
          }); //end of ajax.done
        }
        /**
         * Below are the methods called by select2 
         */
         
        //This method builds the attachment rest url for attachment select2 field
        var getAttachmentSearchUrl = function(){
            var attachmentSearchUrl ;
            var page = dataLocationPage.val();
            var contentId;
            if(page && page.toLowerCase() === "@home"){
                contentId =  getHomePage();
            }
            else if(page && page.toLowerCase() === "@parent"){
                contentId = AJS.params.parentPageId ;
            }
            else if(page && page.toLowerCase() === "@self" || page.toLowerCase() === tablebasecme.CURRENT_PAGE.toLowerCase()){
                contentId = AJS.params.contentId ;
            }
            else{  
                if(page !== "" && dataLocationPage.auiSelect2('data').contentId){
                    contentId = dataLocationPage.auiSelect2('data').contentId;
                }
                else{
                    //When script filled, on load of editor, get pageId for given space and pagetitle
                    contentId = getPageId(dataLocationSpace, dataLocationPage);
                   //if no content id found, it may be a draft page. AJS.params.pageTitle do not provide pagetitle for a draft page, so use content-title element in the dom
                    if(!contentId && AJS.params.newPage && 
                            ($("#content-title.text.pagetitle").val() === dataLocationPage.val()) && (dataLocationSpace.val() === tablebasecme.CURRENT_SPACE || dataLocationSpace.val() === AJS.params.spaceKey)){ 
                        contentId = AJS.params.draftId;
                    }
                }
            }
            //Rest API to get all attachments irrespective of file type or extension
            attachmentSearchUrl = AJS.contextPath() + '/rest/api/content/'+ contentId +'/child/attachment';
            
            return attachmentSearchUrl;
        }
        
        //Get home page of current space
        var getHomePage = function(){
            var url = AJS.contextPath()+'/rest/api/space?spaceKey='+AJS.params.spaceKey+'&expand=homepage';
            var pageId ;
            
            AJS.$.when(AJS.$.ajax({
                url: url,
                type: 'GET',
                cache: true,
                async: false,
                success: function (data) {
                    if(data && data.results.length > 0)
                        pageId = data.results[0].homepage.id;
                },
                error: function (jqXHR, status, error) {
                    AJS.error(error);
                }
            })).done(function(data) {
                return pageId;
            });
            
            return pageId;
        }
        
        //Get the pageId of page being edited given space key and pagetitle. pageId is needed for fetching attachments of the page.
        var getPageId = function(dataLocationSpace, dataLocationPage){
            var space = dataLocationSpace.val();
            //if space not given or is "CurrentSpace", then consider current space key
            if(!space || space === tablebasecme.CURRENT_SPACE){
                space = AJS.params.spaceKey;
            }
            var url = "";
            if(dataLocationPage.val() != "")
                url = AJS.contextPath()+'/rest/api/search?cql=space="' + space + '"and type=page and title~"' + dataLocationPage.val() + '"';
            else
                url = AJS.contextPath()+'/rest/api/search?cql=space="' + space + '"and type=page';
            var pageId ;
            
            AJS.$.when(AJS.$.ajax({
                url: url,
                type: 'GET',
                cache: true,
                async: false,
                success: function (data) {
                    if(data && data.results.length > 0)
                        pageId = data.results[0].content.id;
                },
                error: function (jqXHR, status, error) {
                    AJS.error(error);
                }
            })).done(function(data) {
                return pageId;
            });
            
            return pageId;
        }
        
        //Return list of all spaces. Each entry will be in this form: spaceKey (space name)
        var formatSpaceResults = function(data) {
            var results = [];
            if (data && data.results.length > 0) {
                $.each(data.results, function(index, item){
                  //include all spaces, global and personal spaces
                    results.push({
                        id: item.space.key,
                        text: item.space.key + ' (' + item.space.name + ')'
                    });
                });
            }
            addToBeginOfList(results, tablebasecme.specialSpaceValues);
            return results;
        }
        
        //Return list of all page titles.
        var formatPageResults = function(data) {
            var results = [];
            if (data && data.results.length > 0) {
                $.each(data.results, function(index, item){
                    results.push({
                        id: item.content.title,
                        text: item.content.title,
                        contentId: item.content.id
                    });
                });
            }
            addToBeginOfList(results, tablebasecme.specialPageValues);
            return results;
        }
        
        var formatAttachmentResults = function(data){
            var results = [];
            if(data && data.results.length > 0){
                $.each(data.results, function(index, item){
                    results.push({
                        id: item.title,
                        text: item.title
                    });
                });
            }
            else{
                results.push({
                    id: "",
                    text: tablebasecme.NO_ATTACHMENT_FOUND
                });
            }
            return results;
        }
        
        var errorAttachmentResults = function(){
            var results = [];
            console.log("Error fetching attachments :"+error+ " "+ status);
            results.push({
                id: "",
                text: tablebasecme.NO_ATTACHMENT_FOUND
            });
            return results; 
        }
        
        var errorAttachmentParams = function(response){
            console.log("Error while fetching attachments :"+response.responseText);
            //If the url contains error for some reason, the select2 dropdown stays open and shows searching...
            //TODO: There shall be a better way to handle it. But this is what found for now.
            if(dataLocationAttachment.val() === ""){
                dataLocationAttachment.auiSelect2("val", tablebasecme.NO_ATTACHMENT_FOUND);
            }
            $("#select2-drop:visible").hide();
        }
        
        //add additionalResults to begin of results list
        var addToBeginOfList = function(sourceList, listToBeAdded){
            $.each(listToBeAdded, function(key, val){
                sourceList.unshift({
                    id: key,
                    text: val
                });
            });
            return sourceList;
        } 
        
        //TODO: Have a better name
        var select2AjaxData = function (term, page, defaultQuery, queryWithInput) { // page is the one-based page number tracked by Select2
            if(term !== ""){
                return {
                cql: queryWithInput 
               }
           }
           else{
             return {
                cql: defaultQuery 
               }  
           }
        }
        
        var searchUrl = function(){return AJS.contextPath() + '/rest/api/search';};
        var defaultSpaceQuery = function () {return "type=space";};
        var defaultPageQuery = function () { return 'type=page and space="'+ (dataLocationSpace.val() === "" || dataLocationSpace.val() === tablebasecme.CURRENT_SPACE ? AJS.params.spaceKey : dataLocationSpace.val()) + '"';};
        var pageQueryWithInput = function (term) { return 'type=page and title~"'+term+'*" and space="'+ (dataLocationSpace.val() === "" || dataLocationSpace.val() === tablebasecme.CURRENT_SPACE ? AJS.params.spaceKey : dataLocationSpace.val()) + '"';};
        var spaceQueryWithInput = function (term) { return 'type=space and space.title~"'+term+'*"';};
        var initSelectionSpace = function (element, callback) { 
            callback({
                id: element.val(),
                text: (element.val() === tablebasecme.CURRENT_SPACE  ? tablebasecme.CURRENT_SPACE_WITH_KEY : element.val())
            });
        };
        
        var initSelectionPage = function (element, callback) { 
            callback({
                id: element.val(),
                text: tablebasecme.specialPageValues.hasOwnProperty(element.val().toLowerCase()) ? tablebasecme.specialPageValues[element.val().toLowerCase()] : element.val()
            });
        };
        
        //This method enables given element select2 with dynamic search ability.
        var initSelect2 = function(element, placeHolderText, searchUrl, defaultQuery, queryWithInput, formatResults, errorResults, paramsError, initSelectionFunction ){
            element.auiSelect2({
             placeholder: placeHolderText,
             allowClear: true, //TODO: this is not working with auiselect2, but works with select2.
             ajax: {
                 url: function(){
                     return searchUrl(); //TODO: url need not be a function always, can be just a string. But to handle both string and function, we may need to add logic to check if searchUrl is of type func or not.
                 },
                 dataType: 'json',
                 type: 'GET',
                 delay: 250,
                 cache: true,
                 data: function (term, page) { // page is the one-based page number tracked by Select2 for pagination, we are not using page now.
                     if(defaultQuery != null){
                         return select2AjaxData(term, page, defaultQuery(), queryWithInput(term));
                     }
                 },
                 results: function(data, page) {
                     return {
                         results: formatResults(data)
                     };
                 },
                 error: function (jqXHR, status, error) {
                     if(errorResults != null){
                         return { results: errorResults()};
                     }
                     else {
                         return { results: formatResults(null)};
                    }
                 },
                 params: {
                     //Any error like url itself is not a valid one
                     error: function(response) {
                         console.log("Error while fetching data for "+element+ " : " + response.responseText);
                         if(paramsError != null)
                             paramsError(response);
                     }
                 }
             },
             initSelection: function(element, callback) {
                 if(initSelectionFunction != null){
                     initSelectionFunction(element, callback);
                 }
                 else{ //default initSelection implementation
                     callback({
                         id: element.val(),
                         text: element.val()
                     }); 
                 }
             },
             createSearchChoice:function(term, data) {
                 //This creates search choice with query/search term
                 return {id:term, text:term};
             },
             formatNoMatches: function (term) {
                 return "Keep typing...";
             },
         });
        }//end of function
        //enable space, page and attachment elements select2 dynamic searchable
        initSelect2(dataLocationSpace, "Select a space...", searchUrl, defaultSpaceQuery, spaceQueryWithInput, formatSpaceResults, null, null, initSelectionSpace);
        initSelect2(dataLocationPage, "Select a page...", searchUrl, defaultPageQuery, pageQueryWithInput, formatPageResults, null, null, initSelectionPage);
        initSelect2(dataLocationAttachment, "Select an attachment...", getAttachmentSearchUrl, null, null, formatAttachmentResults, errorAttachmentResults, errorAttachmentParams, null);
         
    });
    
    // Save handler code script macro param supported macrosat. 
    $(document).on('appfireEditorBeforeSave appfireEditorBeforePreview', "[data-datalocationfields=true]", function(evt, macroParms, dialog, form, defaultParms, macroName) {
        //construct script param back from splitted params and remove the non macro params
        var dataSource = dialog.find(".appfire-table-datalocation").val();
        if (dataSource === "attachment"){
            var space = macroParms["attSpace"];
            var page = macroParms["attPage"];
            var attachment = (macroParms["attachment"] !== tablebasecme.NO_ATTACHMENT_FOUND ?  "^"+macroParms["attachment"] : "");
            if(tablebasecme.specialPageValues.hasOwnProperty(page.toLowerCase())) {
                if ("@self" == page.toLowerCase()) {
                    macroParms["script"] = attachment;
                } else {
                    macroParms["script"] = page + attachment;
                }
            }
            else{
                if(space !== tablebasecme.CURRENT_SPACE){
                    macroParms["script"] = space + ":" + page + attachment;
                }
                else{//if current space
                    //if current page, then need not save space or page to be backward compatible    
                    if(page === tablebasecme.CURRENT_PAGE){
                        //delete macroParms["attachmentPage"];
                        macroParms["script"] = attachment;
                    }
                    else{
                       //if current space but different page, then just save 'page' to be backward compatible   
                        macroParms["script"] = page + attachment; 
                    }
                }
            }
        }
        else if (dataSource === "filename" && macroParms["filename"]){
            macroParms["script"] = "#"+macroParms["filename"];
        }
        else if (dataSource === "template" && macroParms["template"]){
            macroParms["script"] = macroParms["template"];
        }
        //if datasource is not url or profile then need not retain url and profile related params
        if (dataSource !== "url" && dataSource !== "profile"){
            delete macroParms["user"];
            delete macroParms["password"];
            delete macroParms["url"];
            delete macroParms["profileUrl"];
         }
        //If dataSource chosen is profile, then profileUrl has to be mapped with url param and unnecessary params user/password associated with dataSource 'URL' shall be cleaned 
        if (dataSource == "profile" ){
            delete macroParms["password"];
            delete macroParms["user"];
            delete macroParms["url"];
            if(macroParms["profileUrl"] !== ""){
                macroParms["url"] = macroParms["profileUrl"];
            }
         }
        //if dataSource chosen is url, then profile need not be considered.
        if (dataSource == "url" ){
            delete macroParms["profile"];
         }
        
        delete macroParms["template"];
        delete macroParms["filename"];
        delete macroParms["attSpace"];
        delete macroParms["attPage"];
        delete macroParms["attachment"];
        delete macroParms["dataLocation"];
        delete macroParms["profileUrl"];
    });
}(window.tablebasecme = window.tablebasecme || {}, AJS.$));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.profile-picture:profile-picture-editor_resources', location = 'js/profile-picture.js' */
AJS.bind("init.rte",function(){AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("viewProfile",function(a,b){a=AJS.$(b);var c={};a.attr("data-macro-parameters")&&AJS.$.each(a.attr("data-macro-parameters").split("|"),function(a,b){a=b.split("\x3d");c[a[0]]=a[1]});window.open(AJS.Confluence.getBaseUrl()+"/display/~"+c.User).opener=null})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:fancy-box', location = '/includes/fancybox/jquery.fancybox-1.3.4.js' */
(function(a){var n,s,t,e,z,l,A,i,w,x,q=0,d={},o=[],p=0,b={},j=[],C=null,m=new Image,F=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,Q=/[^\.]\.(swf)\s*$/i,G,H=1,v=0,u="",r,g,k=!1,y=a.extend(a("<div></div>")[0],{prop:0}),I=a.browser.msie&&7>a.browser.version&&!window.XMLHttpRequest,J=function(){s.hide();m.onerror=m.onload=null;C&&C.abort();n.empty()},K=function(){!1===d.onError(o,q,d)?(s.hide(),k=!1):(d.titleShow=!1,d.width="auto",d.height="auto",n.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),
B())},E=function(){var c=o[q],b,f,e,g,j,i;J();d=a.extend({},a.fn.fancybox.defaults,"undefined"==typeof a(c).data("fancybox")?d:a(c).data("fancybox"));i=d.onStart(o,q,d);if(!1===i)k=!1;else{"object"==typeof i&&(d=a.extend(d,i));e=d.title||(c.nodeName?a(c).attr("title"):c.title)||"";d.orig=a(c).is("img")&&a(c);c.nodeName&&!d.orig&&(d.orig=a(c).children("img:first").length?a(c).children("img:first"):a(c));""===e&&(d.orig&&d.titleFromAlt)&&(e=d.orig.attr("alt"));b=d.href||(c.nodeName?a(c).attr("href"):
c.href)||null;if(/^(?:javascript)/i.test(b)||"#"==b)b=null;d.type?(f=d.type,b||(b=d.content)):d.content?f="html":d.dataAttr?(f="dataAttribute",b=d.orig.attr("data-"+d.dataAttr)):b&&(f=b.match(F)?"image":b.match(Q)?"swf":a(c).hasClass("iframe")?"iframe":0===b.indexOf("#")?"inline":"ajax");if(f)switch("inline"==f&&(c=b.substr(b.indexOf("#")),f=0<a(c).length?"inline":"ajax"),d.type=f,d.href=b,d.title=e,d.autoDimensions&&("html"==d.type||"inline"==d.type||"ajax"==d.type?(d.width="auto",d.height="auto"):
d.autoDimensions=!1),d.modal&&(d.overlayShow=!0,d.hideOnOverlayClick=!1,d.hideOnContentClick=!1,d.enableEscapeButton=!1,d.showCloseButton=!1),d.padding=parseInt(d.padding,10),d.margin=parseInt(d.margin,10),n.css("padding",d.padding+d.margin),a(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){a(this).replaceWith(l.children())}),f){case "html":n.html(d.content);B();break;case "inline":if(!0===a(c).parent().is("#fancybox-content")){k=!1;break}a('<div class="fancybox-inline-tmp"></div>').hide().insertBefore(a(c)).bind("fancybox-cleanup",
function(){a(this).replaceWith(l.children())}).bind("fancybox-cancel",function(){a(this).replaceWith(n.children())});a(c).appendTo(n);B();break;case "image":case "dataAttribute":k=!1;a.fancybox.showActivity();m=new Image;m.onerror=function(){K()};m.onload=function(){k=true;m.onerror=m.onload=null;d.width=m.width;d.height=m.height;a("<img />").attr({id:"fancybox-img",src:m.src,alt:d.title}).appendTo(n);L()};m.src=b;break;case "swf":d.scrolling="no";g='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+
d.width+'" height="'+d.height+'"><param name="movie" value="'+b+'"></param>';j="";a.each(d.swf,function(a,c){g=g+('<param name="'+a+'" value="'+c+'"></param>');j=j+(" "+a+'="'+c+'"')});g+='<embed src="'+b+'" type="application/x-shockwave-flash" width="'+d.width+'" height="'+d.height+'"'+j+"></embed></object>";n.html(g);B();break;case "ajax":k=!1;a.fancybox.showActivity();d.ajax.win=d.ajax.success;C=a.ajax(a.extend({},d.ajax,{url:b,data:d.ajax.data||{},error:function(a){a.status>0&&K()},success:function(a,
c,f){if((typeof f=="object"?f:C).status==200){if(typeof d.ajax.win=="function"){i=d.ajax.win(b,a,c,f);if(i===false){s.hide();return}if(typeof i=="string"||typeof i=="object")a=i}n.html(a);B()}}}));break;case "iframe":L()}else K()}},B=function(){var c=d.width,b=d.height,c=-1<c.toString().indexOf("%")?parseInt((a(window).width()-2*d.margin)*parseFloat(c)/100,10)+"px":"auto"==c?"auto":c+"px",b=-1<b.toString().indexOf("%")?parseInt((a(window).height()-2*d.margin)*parseFloat(b)/100,10)+"px":"auto"==b?
"auto":b+"px";n.wrapInner('<div style="width:'+c+";height:"+b+";overflow: "+("auto"==d.scrolling?"auto":"yes"==d.scrolling?"scroll":"hidden")+';position:relative;"></div>');d.width=n.width();d.height=n.height();L()},L=function(){var c,h;s.hide();if(e.is(":visible")&&!1===b.onCleanup(j,p,b))a.event.trigger("fancybox-cancel"),k=!1;else{k=!0;a(l.add(t)).unbind();a(window).unbind("resize.fb scroll.fb");a(document).unbind("keydown.fb");e.is(":visible")&&"outside"!==b.titlePosition&&e.css("height",e.height());
j=o;p=q;b=d;if(b.overlayShow){if(t.css({"background-color":b.overlayColor,opacity:b.overlayOpacity,cursor:b.hideOnOverlayClick?"pointer":"auto",height:a(document).height()}),!t.is(":visible")){if(I)a("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});t.show()}}else t.hide();c=M();var f={},D=b.autoScale,m=2*b.padding;f.width=-1<b.width.toString().indexOf("%")?parseInt(c[0]*
parseFloat(b.width)/100,10):b.width+m;f.height=-1<b.height.toString().indexOf("%")?parseInt(c[1]*parseFloat(b.height)/100,10):b.height+m;if(D&&(f.width>c[0]||f.height>c[1]))if("image"==d.type||"dataAttribute"==d.type||"swf"==d.type){if(D=b.width/b.height,f.width>c[0]&&(f.width=c[0],f.height=parseInt((f.width-m)/D+m,10)),f.height>c[1])f.height=c[1],f.width=parseInt((f.height-m)*D+m,10)}else f.width=Math.min(f.width,c[0]),f.height=Math.min(f.height,c[1]);f.top=parseInt(Math.max(c[3]-20,c[3]+0.5*(c[1]-
f.height-40)),10);f.left=parseInt(Math.max(c[2]-20,c[2]+0.5*(c[0]-f.width-40)),10);g=f;u=b.title||"";v=0;i.empty().removeAttr("style").removeClass();if(!1!==b.titleShow&&(u=a.isFunction(b.titleFormat)?b.titleFormat(u,j,p,b):u&&u.length?"float"==b.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+u+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+
b.titlePosition+'">'+u+"</div>":!1)&&""!==u)switch(i.addClass("fancybox-title-"+b.titlePosition).html(u).appendTo("body").show(),b.titlePosition){case "inside":i.css({width:g.width-2*b.padding,marginLeft:b.padding,marginRight:b.padding});v=i.outerHeight(!0);i.appendTo(z);g.height+=v;break;case "over":i.css({marginLeft:b.padding,width:g.width-2*b.padding,bottom:b.padding}).appendTo(z);break;case "float":i.css("left",-1*parseInt((i.width()-g.width-40)/2,10)).appendTo(e);break;default:i.css({width:g.width-
2*b.padding,paddingLeft:b.padding,paddingRight:b.padding}).appendTo(e)}i.hide();e.is(":visible")?(a(A.add(w).add(x)).hide(),c=e.position(),r={top:c.top,left:c.left,width:e.width(),height:e.height()},h=r.width==g.width&&r.height==g.height,l.fadeTo(b.changeFade,0.3,function(){var c=function(){l.html(n.contents()).fadeTo(b.changeFade,1,N)};a.event.trigger("fancybox-change");l.empty().removeAttr("filter").css({"border-width":b.padding,width:g.width-2*b.padding,height:d.autoDimensions?"auto":g.height-
v-2*b.padding});h?c():(y.prop=0,a(y).animate({prop:1},{duration:b.changeSpeed,easing:b.easingChange,step:O,complete:c}))})):(e.removeAttr("style"),l.css("border-width",b.padding),"elastic"==b.transitionIn?(r=P(),l.html(n.contents()),e.show(),b.opacity&&(g.opacity=0),y.prop=0,a(y).animate({prop:1},{duration:b.speedIn,easing:b.easingIn,step:O,complete:N})):("inside"==b.titlePosition&&0<v&&i.show(),l.css({width:g.width-2*b.padding,height:d.autoDimensions?"auto":g.height-v-2*b.padding}).html(n.contents()),
e.css(g).fadeIn("none"==b.transitionIn?0:b.speedIn,N)))}},N=function(){a.support.opacity||(l.get(0).style.removeAttribute("filter"),e.get(0).style.removeAttribute("filter"));d.autoDimensions&&l.css("height","auto");e.css("height","auto");u&&u.length&&i.show();b.showCloseButton&&A.show();(b.enableEscapeButton||b.enableKeyboardNav)&&a(document).bind("keydown.fb",function(c){if(c.keyCode==27&&b.enableEscapeButton){c.preventDefault();a.fancybox.close()}else if((c.keyCode==37||c.keyCode==39)&&b.enableKeyboardNav&&
c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&c.target.tagName!=="SELECT"){c.preventDefault();a.fancybox[c.keyCode==37?"prev":"next"]()}});b.showNavArrows?((b.cyclic&&1<j.length||0!==p)&&w.show(),(b.cyclic&&1<j.length||p!=j.length-1)&&x.show()):(w.hide(),x.hide());b.hideOnContentClick&&l.bind("click",a.fancybox.close);b.hideOnOverlayClick&&t.bind("click",a.fancybox.close);a(window).bind("resize.fb",a.fancybox.resize);b.centerOnScroll&&a(window).bind("scroll.fb",a.fancybox.center);"iframe"==
b.type&&a('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(a.browser.msie?'allowtransparency="true""':"")+' scrolling="'+d.scrolling+'" src="'+b.href+'"></iframe>').appendTo(l);e.show();k=!1;a.fancybox.center();b.onComplete(j,p,b);var c,h;j.length-1>p&&(c=j[p+1].href,"undefined"!==typeof c&&c.match(F)&&(h=new Image,h.src=c));0<p&&(c=j[p-1].href,"undefined"!==typeof c&&c.match(F)&&(h=new Image,h.src=c))},O=function(a){var d={width:parseInt(r.width+
(g.width-r.width)*a,10),height:parseInt(r.height+(g.height-r.height)*a,10),top:parseInt(r.top+(g.top-r.top)*a,10),left:parseInt(r.left+(g.left-r.left)*a,10)};"undefined"!==typeof g.opacity&&(d.opacity=0.5>a?0.5:a);e.css(d);l.css({width:d.width-2*b.padding,height:d.height-v*a-2*b.padding})},M=function(){return[a(window).width()-2*b.margin,a(window).height()-2*b.margin,a(document).scrollLeft()+b.margin,a(document).scrollTop()+b.margin]},P=function(){var c=d.orig?a(d.orig):!1,h={};c&&c.length?(h=c.offset(),
h.top+=parseInt(c.css("paddingTop"),10)||0,h.left+=parseInt(c.css("paddingLeft"),10)||0,h.top+=parseInt(c.css("border-top-width"),10)||0,h.left+=parseInt(c.css("border-left-width"),10)||0,h.width=c.width(),h.height=c.height(),h={width:h.width+2*b.padding,height:h.height+2*b.padding,top:h.top-b.padding-20,left:h.left-b.padding-20}):(c=M(),h={width:2*b.padding,height:2*b.padding,top:parseInt(c[3]+0.5*c[1],10),left:parseInt(c[2]+0.5*c[0],10)});return h},R=function(){s.is(":visible")?(a("div",s).css("top",
-40*H+"px"),H=(H+1)%12):clearInterval(G)};a.fn.fancybox=function(c){AJS&&AJS.log("fancybox is deprecated, please use the previewer instead. E.g. $imageLink.previewer({ src: srcOfImage }); ");if(!a(this).length)return this;a(this).data("fancybox",a.extend({},c,a.metadata?a(this).metadata():{})).unbind("click.fb").bind("click.fb",function(c){c.preventDefault();k||(k=!0,a(this).blur(),o=[],q=0,c=a(this).attr("rel")||"",!c||""==c||"nofollow"===c?o.push(this):(o=a("a[rel="+c+"], area[rel="+c+"]"),q=o.index(this)),
E())});return this};a.fancybox=function(c,b){var d;if(!k){k=!0;d="undefined"!==typeof b?b:{};o=[];q=parseInt(d.index,10)||0;if(a.isArray(c)){for(var e=0,g=c.length;e<g;e++)"object"==typeof c[e]?a(c[e]).data("fancybox",a.extend({},d,c[e])):c[e]=a({}).data("fancybox",a.extend({content:c[e]},d));o=jQuery.merge(o,c)}else"object"==typeof c?a(c).data("fancybox",a.extend({},d,c)):c=a({}).data("fancybox",a.extend({content:c},d)),o.push(c);if(q>o.length||0>q)q=0;E()}};a.fancybox.showActivity=function(){clearInterval(G);
s.show();G=setInterval(R,66)};a.fancybox.hideActivity=function(){s.hide()};a.fancybox.next=function(){return a.fancybox.pos(p+1)};a.fancybox.prev=function(){return a.fancybox.pos(p-1)};a.fancybox.pos=function(a){k||(a=parseInt(a,10),o=j,-1<a&&a<j.length?(q=a,E()):b.cyclic&&1<j.length&&(q=a>=j.length?0:j.length-1,E()))};a.fancybox.cancel=function(){k||(k=!0,a.event.trigger("fancybox-cancel"),J(),d.onCancel(o,q,d),k=!1)};a.fancybox.close=function(){function c(){t.fadeOut("fast");i.empty().hide();e.hide();
a.event.trigger("fancybox-cleanup");l.empty();b.onClosed(j,p,b);j=d=[];p=q=0;b=d={};k=!1}if(!k&&!e.is(":hidden"))if(k=!0,b&&!1===b.onCleanup(j,p,b))k=!1;else if(J(),a(A.add(w).add(x)).hide(),a(l.add(t)).unbind(),a(window).unbind("resize.fb scroll.fb"),a(document).unbind("keydown.fb"),l.find("iframe").attr("src",I&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==b.titlePosition&&i.empty(),e.stop(),"elastic"==b.transitionOut){r=P();var h=e.position();g={top:h.top,
left:h.left,width:e.width(),height:e.height()};b.opacity&&(g.opacity=1);i.empty().hide();y.prop=1;a(y).animate({prop:0},{duration:b.speedOut,easing:b.easingOut,step:O,complete:c})}else e.fadeOut("none"==b.transitionOut?0:b.speedOut,c)};a.fancybox.resize=function(){t.is(":visible")&&t.css("height",a(document).height());a.fancybox.center(!0)};a.fancybox.center=function(a){var d,f;if(!k&&(f=!0===a?1:0,d=M(),f||!(e.width()>d[0]||e.height()>d[1])))e.stop().animate({top:""+parseInt(Math.max(d[3]-20,d[3]+
0.5*(d[1]-l.height()-40)-b.padding),10),left:""+parseInt(Math.max(d[2]-20,d[2]+0.5*(d[0]-l.width()-40)-b.padding),10)},"number"==typeof a?a:200)};a.fancybox.init=function(){a("#fancybox-wrap").length||(a("body").append(n=a('<div id="fancybox-tmp"></div>'),s=a('<div id="fancybox-loading"><div></div></div>'),t=a('<div id="fancybox-overlay"></div>'),e=a('<div id="fancybox-wrap"></div>')),z=a('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(e),
z.append(l=a('<div id="fancybox-content"></div>'),A=a('<a id="fancybox-close"></a>'),i=a('<div id="fancybox-title"></div>'),w=a('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),x=a('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),A.click(a.fancybox.close),s.click(a.fancybox.cancel),w.click(function(c){c.preventDefault();a.fancybox.prev()}),x.click(function(c){c.preventDefault();a.fancybox.next()}),
a.fn.mousewheel&&e.bind("mousewheel.fb",function(c,b){if(k)c.preventDefault();else if(0==a(c.target).get(0).clientHeight||a(c.target).get(0).scrollHeight===a(c.target).get(0).clientHeight)c.preventDefault(),a.fancybox[0<b?"prev":"next"]()}),a.support.opacity||e.addClass("fancybox-ie"),I&&(s.addClass("fancybox-ie6"),e.addClass("fancybox-ie6"),a('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(z)))};
a.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:0.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,
showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};a(document).ready(function(){a.fancybox.init()})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-editor-iframe.js' */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        var openDiagram = function (options) {

            var editorCloseCallbackFunctions = [];
            var editorCloseCallback = function(closeEvent) {
                editorCloseCallbackFunctions.forEach(function(currentValue/*, index, array*/) {
                    currentValue(closeEvent);
                });
            };

            // fire event on close
            editorCloseCallbackFunctions.push(function (closeEvent) {
                AJS.trigger("gliffy.confluence.inlineEditorClosed");
            });
            // Diagram JSON .gon data exists
            if(options.gonContent) {
                options.editor.html5Editor.open({
                    jsonObj: options.gonContent,
                    dirty: true
                });

            // Blank diagram template (new, empty diagram)
            } else if (options.template.category == "com.gliffy.templates.blank") {
                options.editor.html5Editor.create(null, options.template.panels);

            // Existing diagram attachment
            } else if (options.template.category == "com.gliffy.diagram") {

                options.editor.html5Editor.open({
                    url:AJS.format("/diagrams/{0}", options.attachmentId)
                });
            // Transform?
            } else if (options.template.category == "com.gliffy.transform.diagram") {
                options.editor.html5Editor.open({
                    url:AJS.format("/templates/transform/{0}", options.template.name),
                    dirty:true
                });

            // Open an html5 template?
            } else {
                options.editor.html5Editor.open({
                    url:AJS.format("/templates/{0}",
                        options.template.name),
                    useShapeStyles:false,
                    dirty:true
                });
            }

            options.editor.show();

            // GCONF-1941: editor focus problem
            GLIFFY.confluence.fixEditorFocus();

            // GCONF-1914: Attach close callback to base editor.
            options.editor.html5Editor.postCloseCallback = editorCloseCallback;
        };

        // Launches the editor when in page edit mode (not page view mode).
        var launchInlineEditor = function (options) {
            options = $.extend({
                diagramName:null,
                template:{category:"com.gliffy.templates.blank", name:"com.gliffy.template.blank"},
                attachmentId:null,
                panels:null
            }, options);

            options.editor.loadedCallback = function(draft) {
                if (draft) {
                    options.gonContent = draft;                    
                }
                openDiagram(options);
            }

            // Always update URL as it is used for pinned version dialog logic
            var url;
            if(options.ownerPageId) {
                url = AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&inline=true&pageId={2}&attachmentVersion={3}&originalAttachmentVersion={4}&isPinned={5}&wootric={6}",
                    AJS.Confluence.getContextPath(), options.ownerPageId,
                    options.referencePageId, options.attachmentVersion,
                    options.originalAttachmentVersion || options.attachmentVersion || 0,
                    options.isPinned, options.wootric);
            } else {
                url = AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&version={2}&pagePin={3}&wootric={4}",
                    AJS.Confluence.getContextPath(),
                    Confluence.Editor.getContentId(),
                    options.isPinned || 0, options.wootric);
            }
            url += options.diagramName ? '&name=' + encodeURIComponent(options.diagramName) : '';
            url += options.displayName ? '&displayName=' + encodeURIComponent(options.displayName) : '';
            url += options.macroId ? '&macroId=' + options.macroId : '';

            if (!options.editor.obj) {
                // setup the html5 editor iframe. the iframe will load the diagram via the GLIFFY._confluence.editor.loaded function
                // Wait blanket + spinner
                $("body").append($('<div class="gliffy-spinner gliffy-spinner-icon"></div><div class="gliffy-spinner gliffy-spinner-bg"></div>'));
                options.editor.obj = $("<iframe />", {src:url, id:"gliffy-editor"})
                    .css({
                        position:"absolute",
                        width:"100%",
                        height:"100%",
                        top:0,
                        left:0,
                        border:0
                    }).appendTo("body");
            } else {
                options.editor.obj.attr("src", url);
                openDiagram(options);
            }
        };

        AJS.bind("gliffy.confluence.launchInlineEditor", function (event, options) {
            launchInlineEditor(options);
        });

        // Launch the Editor with diagram JSON .gon data
        AJS.bind("gliffy.confluence.launchEditorWithGonData", function (event, gonContent) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchEditorWithGonData: " + e);
            }
            launchInlineEditor({
                editor:GLIFFY._confluence.editor,
                gonContent:gonContent
            });
        });

        AJS.bind("gliffy.confluence.launchTemplate", function (event, category, name, panels) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchTemplate: " + e);
            }
            launchInlineEditor({
                editor:GLIFFY._confluence.editor,
                template:{category:category, name:name, panels:panels}
            });
        });

        AJS.bind("gliffy.confluence.addGliffyDiagramToPage", function (event, category, name) {
            try {
                if (GLIFFY._confluence.macroDialog) {
                    GLIFFY._confluence.macroDialog.hide();
                }
            }
            catch (e) {
                console.log("Error hiding Gliffy macro dialog on gliffy.confluence.addGliffyDiagramToPage: " + e);
            }
            var macroRenderRequest = {
                contentId:Confluence.Editor.getContentId(),
                macro:{
                    name:"gliffy",
                    params:{name:name, blueprint:category},
                    defaultParameterValue:"",
                    body:""
                }
            };
            GLIFFY.confluence.insertMacro(macroRenderRequest);
        });
    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/PromiseJS.js' */
//Add generic support for Deferred/Promise since the oldest supported version of Confluence uses JQuery 1.4.2
//https://github.com/hemanshubhojak/PromiseJS
(function (global) {

    var states = {
        Pending: "Pending",
        Resolved: "Resolved",
        Rejected: "Rejected"
    };

    //http://jira.gliffy.com/browse/GCONF-1398 For each polyfill!
    if ( !Array.prototype.forEach ) {
        Array.prototype.forEach = function(fn, scope) {
            for(var i = 0, len = this.length; i < len; ++i) {
                if (i in this) {
                    fn.call(scope, this[i], i, this);
                }
            }
        };
    }

    /**
     * @constructor
     */
    function Deferred() {
        var self = this,
            successCallbacks = [],
            failCallbacks = [],
            progressCallbacks = [],
            state = states.Pending,
            value;

        /**
         * @constructor
         */
        function Promise() {
            var self = this;

            self.success = function (callback) {
                if (state === states.Resolved) {
                    callback.call(self, value);
                }
                else {
                    successCallbacks.push(callback);
                }

                return self;
            };

            self.fail = function (callback) {
                if (state === states.Rejected) {
                    callback.call(self, value);
                }
                else {
                    failCallbacks.push(callback);
                }

                return self;
            };

            self.progress = function (callback) {
                progressCallbacks.push(callback);
                return self;
            };

            self.always = function (callback) {
                return self.success(callback).fail(callback);
            };

            self.then = function (onSuccess, onError) {
                return self.success(onSuccess).fail(onError);
            };

            self.isPending = function () {
                return state === states.Pending;
            };

            self.isResolved = function () {
                return state === states.Resolved;
            };

            self.isRejected = function () {
                return state === states.Rejected;
            };

            self.value = function () {
                return value;
            };
        }

        self.promise = new Promise();

        self.resolve = function (result) {
            if (state === states.Pending) {
                state = states.Resolved;
                value = result;
                successCallbacks.forEach(function (cb) {
                    cb.call(self.promise, value);
                });
            }
        };

        self.reject = function (error) {
            if (state === states.Pending) {
                state = states.Rejected;
                value = error;
                failCallbacks.forEach(function (cb) {
                    cb.call(self.promise, value);
                });
            }
        };

        self.notify = function () {
            if (state === states.Pending) {
                progressCallbacks.forEach(function (cb) {
                    cb.call(self.promise);
                });
            }
        };
    }

    function isArray(value) {
        return Object.prototype.toString.call(value) === "[object Array]";
    }

    function when(array) {
        var promises = isArray(array) ? array : Array.prototype.slice.call(arguments, 0),
            total = promises.length, completed = 0,
            d = new Deferred();

        promises.forEach(function (p) {
            p.always(function () {
                completed += 1;

                if (completed === total) {
                    d.resolve(promises);
                }
            });
        });

        return d.promise;
    }

    function executeChain(funcs, deferred, promises) {
        if (funcs.length === 0) {
            deferred.resolve(promises);
        }
        else {
            var promise = funcs[0].call();

            promise.always(function () {
                executeChain(
                    Array.prototype.slice.call(funcs, 1),
                    deferred,
                    promises.concat([promise])
                );
            });
        }
    }

    function chain(array) {
        var funcs = isArray(array) ? array : Array.prototype.slice.call(arguments, 0),
            d = new Deferred();

        if (funcs.length === 0) {
            d.resolve();
        }
        else {
            executeChain(funcs, d, []);
        }

        return d.promise;
    }

    global.PromiseJS = {
        Deferred: Deferred,
        when: when,
        chain: chain
    };

    //  For CommonJS environments
    if( typeof exports !== "undefined" ){
        exports.PromiseJS = global.PromiseJS;
    }

}((function () { return this; }.call())));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-utils.js' */
(function($) {
    AJS.bind("init.rte", function() {
        AJS.trigger("gliffy.init.rte");
    });
}(AJS.$));

AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        window["GLIFFY"] = window["GLIFFY"] || {};
        GLIFFY._confluence = GLIFFY._confluence || {};
        GLIFFY._confluence.gvars = {
            gliffyApiEndpoint : AJS.format("{0}/rest/gliffy/1.0", AJS.Confluence.getContextPath()),
            isAutoSearchOn : true, //this should be more tightly coupled with actual logic
            spaces : []
        };
        GLIFFY._confluence.utils = {
            // GJIRA-1890: Enhanced to also handle DOM nodes from RTE.
            getMacroParams : function (macro) {
                var macroParams = {};
                // Look for data from jQuery node.
                var macroParamsString = macro.data && macro.data("macro-parameters");
                // If none, look for data from RTE DOM node.
                macroParamsString = macroParamsString || (macro.dataset && macro.dataset.macroParameters);
                // If string found, parse into params object (KEY1=Value1|KEY2=Value2|KEY3=Value|...)
                if (macroParamsString) {
                    $.each(macroParamsString.split("|"), function (idx, item) {
                        var param = item.split("=");
                        macroParams[param[0]] = param[1];
                    });
                }
                return macroParams;
            },
            getUrlVars : function () {
                var vars = [], hash;
                var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                for (var i = 0; i < hashes.length; i++) {
                    hash = hashes[i].split('=');
                    vars.push(hash[0]);
                    vars[hash[0]] = decodeURIComponent(hash[1]);
                }
                return vars;
            },
            parseError : function (xhr) {
                if (xhr.responseText != null) {
                    try {
                        var responseObj = $.parseJSON(xhr.responseText);
                        return (responseObj.message != null) ? responseObj.message : xhr.responseText;
                    }
                    catch (e) {
                        return xhr.responseText;
                    }
                }
                return "";
            },
            analyticsEvent : function(type, options){
                $(window).trigger(type+'.gliffyAnalytics', options);
            },

            getAnalyticsLabel : function(){
                return 'none';
            },

            getAnalyticsProduct : function(){
                return 'Confluence';
            },

            getAnalyticsLicense : function(){
                return $('meta[name=gliffy-license-type]').attr("content");
            },

            getAnalyticsNumUsers : function(){
                return parseInt($('meta[name=gliffy-license-quantity]').attr("content"))
            },

            initAnalytics : function(){

                var analyticsLabel = GLIFFY._confluence.utils.getAnalyticsLabel(), deferred;

                //add support for deferred for old versions of confluence. use jQuery deferred once min version of jQuery is 1.5
                deferred = new PromiseJS.Deferred();
                $.ajax({
                    url : AJS.format("{0}/rest/gliffy/1.0/properties/com.gliffy.integration.confluence.ANALYTICS_OFF",
                        Confluence.getContextPath()),
                    type: "GET",
                    cache : false,
                    success: function(analyticsOff) {
                        if (!analyticsOff) {
                            GLIFFY._confluence.utils.analyticsEvent('init', {accountType:'google', accountID:'UA-248648-13', optPageName:'Gliffy Confluence RTE Init'});
                            // to debug analytics, uncomment the following line
                            //GLIFFY._confluence.utils.analyticsEvent('logEvents', {logEvents:true, logger:console});
                            GLIFFY._confluence.utils.analyticsEvent('setLabel', {label:analyticsLabel});
                            GLIFFY._confluence.utils.analyticsEvent('setCustomVariables', {
                                product : GLIFFY._confluence.utils.getAnalyticsProduct(),
                                license : GLIFFY._confluence.utils.getAnalyticsLicense(),
                                numUsers : (GLIFFY._confluence.utils.getAnalyticsNumUsers() + " Users")
                            });
                        }
                        deferred.resolve(data);
                    },
                    error: function(xhr, status, error) {
                        AJS.log('Error determining if analytics is available', error)
                        deferred.reject(xhr);
                    },
                    dataType : "json"
                });
                return deferred.promise;

            }
        };

        //confluence specific methods
        var CMeth = function () {
            var fixEditorFocus = function () {
                //remove this if chrome+mac gets rid of focus issue.
                if (AJS.Rte.getEditorFrame) {
                    $(AJS.Rte.getEditorFrame()).focus();
                }

                // GCONF-1941: fix editor focus. Perhaps AJS.Rte.getEditorFrame may not be set?
                var gliffyEditorIFrame = $("#gliffy-editor")[0];
                if(gliffyEditorIFrame) {
                    gliffyEditorIFrame.contentWindow.focus();
                }
            };
            var originalReplaceNodeFunction = tinymce.confluence.NodeUtils.replaceNode;
            var replaceNode = function (oldNode, newNode) {
                var that =  tinymce.confluence.NodeUtils,
                    ed = tinymce.activeEditor,
                    doc = that.getDoc(),
                    $newNode = $(newNode, doc),
                    $oldNode = $(oldNode, doc);
                /**
                 * Waiting for an image to be fully loaded into the DOM in the background is an asynchronous operation - hence use a jQuery.Deferred here.
                 */
                return $.Deferred(function () {
                    var deferred = this;
                    if ($newNode.is("img")) {
                        /**
                         * Here we're delaying the replacement of the node until the image's src has been
                         * fully loaded by the browser.
                         */
                        $newNode[0].onload = function() {
                            AJS.log("replaceNode: new node's src has been loaded by the browser.");
                            this.onload = null;
                            deferred.resolve(this);
                        };
// In Opera, the src has to be defined after the onLoad callback or it won't work.
                        if ($.browser.opera) {
                            $newNode[0].src = $newNode.attr('src');
                        }
                        //============ gliffy modification ===========//
                        setTimeout(function() {
                            //insert the macro anyway if the image fails to load
                            deferred.resolve($newNode[0]);
                        }, 3000);
                        //============ gliffy modification ===========//
                        /**
                         * Trigger rendering of the new DOM node, in turn requesting the image's src,
                         * ultimately triggering the onLoad event above.
                         */
                        doc.createDocumentFragment().appendChild($newNode[0]);
                    } else {
                        deferred.resolve($newNode[0]);
                    }
                }).done(function(newNode) {
                    $oldNode.replaceWith(newNode);
                }).promise();
            };
            var insertMacro = function (args, nodeToReplace) {
                var deferred, defaultParams = {
                    contentId : Confluence.Editor.getContentId(),
                    macro : { name : "gliffy", params : "", defaultParameterValue : "", body : ""}
                };

                if($.browser.msie && AJS.$.Deferred) {
                    //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                    tinymce.confluence.NodeUtils.replaceNode = replaceNode;
                }

                AJS.Rte.BookmarkManager.restoreBookmark();
                deferred = tinymce.confluence.MacroUtils.insertMacro($.extend(true, defaultParams, args), nodeToReplace);

                if(deferred && deferred.then) {
                    deferred.then(function() {
                        if($.browser.msie) {
                            //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                            tinymce.confluence.NodeUtils.replaceNode = originalReplaceNodeFunction;
                        }
                    }, function() {
                        if($.browser.msie) {
                            //remove this once https://jira.atlassian.com/browse/CONF-28418 is fixed
                            tinymce.confluence.NodeUtils.replaceNode = originalReplaceNodeFunction;
                        }
                    });
                }
                AJS.log("insert gliffy macro");
                fixEditorFocus();
                return deferred;
            };

            var setMacroParam = function(fieldName, fieldValue, param) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf(fieldName + '=' + fieldValue) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                        }
                        macroData.macro.params = Object.assign(macroData.macro.params, param);
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });
            };

            var setPagePin = function(name, version, displayName) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf('name=' + name) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                            macroData.macro.params.displayName = displayName || name;
                        }
                        macroData.macro.params.pagePin = version;
                        macroData.macro.params.displayName = displayName || name;
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });
            };

            var updatePagePinVersion = function(name, version) {
                var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                    return $(this).data("macro-name") === 'gliffy' && $(this).attr("data-macro-parameters").indexOf('name=' + name) != -1;
                });
                macros.each(function(index){
                    var macroData = {
                        contentId: Confluence.Editor.getContentId(),
                        macro:{
                            name:'gliffy',
                            params: GLIFFY._confluence.utils.getMacroParams(macros[index])
                        }
                    };
                    if (!macroData.macro.params.pageid) {
                        //GCONF-2730: Addresses IE10 issue
                        if (macroData.macro.params.name === undefined) {
                            macroData.macro.params.name = name;
                        }
                        macroData.macro.params.version = version;
                        macroData.macro.params.pagePin = version;
                        tinymce.confluence.MacroUtils.insertMacro(macroData, macros[index]);
                    }
                });

            };

            return {
                setMacroParam: setMacroParam,
                setPagePin: setPagePin,
                updatePagePinVersion: updatePagePinVersion,
                getMacroParams : GLIFFY._confluence.utils.getMacroParams,
                insertMacro : insertMacro,
                fixEditorFocus : fixEditorFocus,
                updateMacros : function (macroname) {
                    //find all matching macros in the editor iframe
                    var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                        return $(this).data("macro-name") === macroname;
                    });
                    macros.each(function (index, element) {
                        var macro = $(this);
                        var macroParams = GLIFFY._confluence.utils.getMacroParams(macro);
                        var dataJson = $.toJSON({contentId : Confluence.Editor.getContentId(), macro : {name : macro.data("macro-name"), params : macroParams, body : "", defaultParameterValue : ""}});

                        $.ajax({
                            type : "POST",
                            contentType : "application/json; charset=utf-8",
                            url : Confluence.getContextPath() + "/rest/tinymce/1/macro/placeholder",
                            data : dataJson,
                            dataType : "text",
                            success : function (macroplaceholder) {
                                macro.after(macroplaceholder);
                                macro.remove();
                            }
                        });
                    });
                }
            }
        };
        GLIFFY.confluence = CMeth();

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-editor-html5.js' */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {
        GLIFFY._confluence.editor = {
            obj:null,
            parentOverflow:null,
            isHtml5:true,
            loadedCallback:null,
            show:function () {
                // GCONF-606 Update Editor position for Editor in inline comment
                $("#gliffy-editor").css("top", $(document).scrollTop());
                this.obj.parent().css("overflow", "hidden");

                if (GLIFFY._confluence.editor.hidden) {
                    if ($.browser.msie) { //GCONF-854 IE9 crashes on hidden iframe operations, see JIRA for details
                        GLIFFY._confluence.editor.obj.css('visibility', 'visible');
                    } else {
                        GLIFFY._confluence.editor.obj.show();
                    }
                    GLIFFY._confluence.editor.hidden = false;
                }

                // GCONF-1941: editor focus problem
                GLIFFY._confluence.editor.html5Editor.focus();

                $("#gliffy-close").show();
                $("#gliffy-load-buttons").hide();
            },

            hide:function () {

                if (!GLIFFY._confluence.editor.hidden) {
                    if ($.browser.msie) { //GCONF-854 IE9 crashes on hidden iframe operations, see JIRA for details
                        GLIFFY._confluence.editor.obj.css('visibility', 'hidden');
                    } else {
                        GLIFFY._confluence.editor.obj.hide();
                    }
                    GLIFFY._confluence.editor.hidden = true;
                }

                $("#gliffy-close").hide();
                $("#gliffy-load-buttons").show();

                // GCONF-606 Update Editor position for Editor in inline comment
                this.obj.parent().css({overflow:this.parentOverflow});
            },
            hidden:false,
            html5Editor:null,
            loaded:function (html5Editor, draft) {
                GLIFFY._confluence.editor.html5Editor = html5Editor;

                // GCONF-606 Update Editor position for Editor in inline comment
                this.parentOverflow = $("#gliffy-editor").parent().css("overflow");
                $(".gliffy-spinner").remove();

                if(this.loadedCallback) {
                    this.loadedCallback(draft);
                }
            },
            hideSpinner : function() {
                $(".gliffy-spinner").remove();
            }
        };

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-macro.js' */
/**
 * Gliffy RTE Macro v2
 * @author Kerry Liu
 */
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {

        //this will attempt to insert thr pagePin property into the macro so that all macros get pinned
        //if the page is saved.
        var pagePinAllUnpinnedMacros = function() {
            var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                return $(this).data("macro-name") === 'gliffy';
            });
            macros.each(function (m) {
                var paramArray = $(this).attr("data-macro-parameters").split('|');
                var params = {};
                _.each(paramArray, function(a) {
                    a = a.split('=');
                    params[a[0]] = a[1];
                });
                if (!params.pagePin && !params.pageid && params.name) {
                    var pageId = Confluence.Editor.getContentId();
                    $.ajax(AJS.contextPath() + '/rest/api/content/' + pageId + '/child/attachment?expand=version&filename=' + encodeURIComponent(params.name)).then(function(resp) {
                        GLIFFY.confluence.setPagePin(params.name, resp.results[0].version.number);
                    }).fail(function(err) {
                        console.log('could not get ' + params.name);
                    });
                }
            });
        };

        var setPagePinVersionForCopyPage = function() {
            var macros = $(AJS.Rte.getEditor().dom.select('.editor-inline-macro')).filter(function (index) {
                return $(this).data("macro-name") === 'gliffy';
            });
            macros.each(function() {
                var paramArray = $(this).attr("data-macro-parameters").split('|');
                var params = {};
                _.each(paramArray, function(a) {
                    a = a.split('=');
                    params[a[0]] = a[1];
                });
                if (params.name) {
                    var pageId = Confluence.Editor.getContentId();
                    $.ajax(AJS.contextPath() + '/rest/api/content/' + pageId + '/child/attachment?expand=version&filename=' + encodeURIComponent(params.name)).then(function(resp) {
                        var attVersion = resp.results[0].version.number;
                        if ( !params.version && params.pagePin > attVersion) {
                            GLIFFY.confluence.setPagePin(params.name, resp.results[0].version.number);
                        } else if (params.version && params.pagePin > attVersion) {
                            GLIFFY.confluence.updatePagePinVersion(params.name, resp.results[0].version.number);
                        }
                    }).fail(function(err) {
                        console.log('could not get ' + params.name);
                    });
                }
            });
        };

        //Ugly hack.  Doesn't seem to be a way to sync the editor content to be ready, so set an interval to
        // check for the page content to become available
        AJS.toInit(function() {

            var contentQuery = setTimeout(function () {
                var html = $(AJS.Rte.getEditor().dom.select('.mceContentBody'));
                if (html.length > 0) {
                    pagePinAllUnpinnedMacros();
                    setPagePinVersionForCopyPage();
                    clearInterval(contentQuery);
                }
            }, 500);
        });



        //note: old versions of confluence uses jQuery < 1.7 avoid using on/off until we no longer support these versions.
        var CreatePanel, Panel, TemplateCategoryPanel, ImportPanel, InsertPanel, BlueprintCategoryPanel,
        //RCB: temporary until we decide whether to launchEditor or drop a diagram directly on the page.
            skipLaunchEditor = false;

        var GliffySpinner = require('GliffySpinner');
        var recentSpinner;
        var importSpinner;
        function analyticsEvent(type, options) {
            $(window).trigger(type + '.gliffyAnalytics', options);
        }

        /******************************************************************/
        /*                         Panels                                 */
        /******************************************************************/
        /*
         Each panel should have the following methods:

         isTemplateCategory() - true if the panel is a template category
         getName() - name of the panel
         getPanelLink() - sidebar li markup
         getTemplate() - returns the html for the panel
         primaryAction(event, baseDialog) - what the panel does, when the primary button is clicked
         getPrimaryButtonText() - i18n text for the primary button ie, "Create" or "Insert Template"
         setup(baseDialog) - bind any necessary handlers/populate your panel (called whenever it is rendered)
         teardown(baseDialog) - unbind any events that were bound to the panel in bindEvents

         Note: Events for elements with class "gliffy-template" are already handled by the macro dialog, and do
         not need to be bound by your panel. Double clicking on a "gliffy-template element, will also trigger
         the primary action.
         */

        Panel = function (name) {
            this.name = name;
        };
        Panel.prototype.isTemplateCategory = function () {
            return false;
        };
        Panel.prototype.getName = function () {
            return this.name;
        };
        Panel.prototype.getPanelLink = function () {
            return gliffySoy.macro.dialog.panelLink({
                key:this.getName(),
                title:this.getPanelText()
            });
        };
        Panel.prototype.getTemplate = function () {
            return "";
        };
        Panel.prototype.getPanelText = function () {
            return "";
        };
        Panel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active");
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            AJS.trigger('createpagetemplate', [template.data("category"), template.data("name")]);
        };
        Panel.prototype.getPrimaryButtonText = function () {
            return "";
        };
        Panel.prototype.setup = function (baseDialog) {
        };
        Panel.prototype.teardown = function (baseDialog) {
        };

        /******************************************************************/
        /*                      Create Panel                              */
        /******************************************************************/

        CreatePanel = function () {
        };
        CreatePanel.prototype = new Panel("create");
        CreatePanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.createPanel();
        };
        CreatePanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                name = template.data("name"),
                panels = template.data("panels"),
                isRecent, blankName;
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            isRecent = name !== "blank";
            blankName = panels ? "blank_" + panels : "blank";
            analyticsEvent('trackEvent', {category:'panelCreate', action:isRecent ? "recent" : blankName});

            if (panels) {
                if (panels === "basic") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "cloud") {
                    panels = [
                        "glib.aws_v2.compute",
                        "glib.aws_v2.database",
                        "glib.aws_v2.application_services",
                        "glib.azure_v1",
                        "glib.gcp_v1.compute",
                        "glib.gcp_v1.storage_and_databases",
                        "glib.gcp_v1.big_data",
                        "com.gliffy.libraries.uml.uml_v2.use_case",
                        "com.gliffy.libraries.erd.erd_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default"
                    ]
                } else if (panels === "flowchart") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "software") {
                    panels = [
                        "com.gliffy.libraries.uml.uml_v2.class",
                        "com.gliffy.libraries.uml.uml_v2.sequence",
                        "com.gliffy.libraries.uml.uml_v2.activity",
                        "com.gliffy.libraries.uml.uml_v2.state_machine",
                        "com.gliffy.libraries.uml.uml_v2.deployment",
                        "com.gliffy.libraries.uml.uml_v2.component",
                        "com.gliffy.libraries.uml.uml_v2.use_case",
                        "com.gliffy.libraries.erd.erd_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "bpmn") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.bpmn.bpmn_v1.events",
                        "com.gliffy.libraries.bpmn.bpmn_v1.activities",
                        "com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts",
                        "com.gliffy.libraries.bpmn.bpmn_v1.gateways",
                        "com.gliffy.libraries.bpmn.bpmn_v1.connectors",
                        "com.gliffy.libraries.swimlanes.swimlanes_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "network") {
                    panels = [
                        "com.gliffy.libraries.network.network_v4.rack",
                        "com.gliffy.libraries.network.network_v4.business",
                        "com.gliffy.libraries.network.network_v4.home",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ];
                } else if (panels === "ui") {
                    panels = [
                        "com.gliffy.libraries.ui.ui_v3.containers_content",
                        "com.gliffy.libraries.ui.ui_v3.navigation",
                        "com.gliffy.libraries.ui.ui_v3.forms_controls",
                        "com.gliffy.libraries.ui.ui_v3.icon_symbols",
                        "com.gliffy.libraries.ui.ui_v2.forms_components",
                        "com.gliffy.libraries.ui.ui_v2.content",
                        "com.gliffy.libraries.ui.ui_v2.miscellaneous",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                } else if (panels === "venn") {
                    panels = [
                        "com.gliffy.libraries.venn.outline.default",
                        "com.gliffy.libraries.venn.flat.default",
                        "com.gliffy.libraries.venn.radial.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                } else if (panels === "org") {
                    panels = [
                        "com.gliffy.libraries.flowchart.flowchart_v1.default",
                        "com.gliffy.libraries.basic.basic_v1.default",
                        "com.gliffy.libraries.images"
                    ]
                }
            }
            AJS.trigger("gliffy.confluence.launchTemplate", [template.data("category"), name, panels]);

        };
        CreatePanel.prototype.getPanelText = function () {
            return "Create a New Diagram";
        };
        CreatePanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };
        CreatePanel.prototype.setup = function (baseDialog) {
            //get most recent diagrams
            var params = { matchAll:true, sort:"modified", order:"descending", index:0, results:50, filterByUser:true},
                done = false;
            //stick in a spinner for recent results

            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/diagrams.json",
                dataType:'json',
                data:params,
                cache:false,
                success:function (data) {
                    done = true;
                    recentSpinner.stop();
                    baseDialog.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({
                        diagrams: data.diagrams,
                        rootApi: GLIFFY._confluence.gvars.gliffyApiEndpoint
                    }));
                },
                error:function (xhr) {
                    done = true;
                    recentSpinner.stop();
                    baseDialog.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({
                        diagrams:[],
                        rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint
                    }));
                }
            });

            recentSpinner = new GliffySpinner(baseDialog.find(".gliffy-content .gliffy-recent-results").get(0), {
                radius:25,
                color:'#666',
                inline:true
            });

            //wait 100ms, then show the spinner if it's not done
            setTimeout(function () {
                if (!done) {
                    recentSpinner.start();
                }
            }, 100);


        };
        CreatePanel.prototype.teardown = function (baseDialog) {
        };

        /******************************************************************/
        /*       Insert/Search/Create from template Diagram Panel         */
        /******************************************************************/
        InsertPanel = function (insertOnly, message, blueprint) {
            var self = this;

            this.insertOnly = insertOnly || false; //if true, the user can only insert items
            this.message = message || null;
            this.blueprint = blueprint || false;

            //DO NOT translate shortName values! they are not displayed to the user.
            this.spaces = [
                {longName:"All Spaces", shortName:""}
            ];
            this.sort = [
                {longName:"Last Modified", shortName:"modified"},
                {longName:"Title", shortName:"title"},
                {longName:"Created", shortName:"created"}
            ];
            this.name = "insert";
            this.view = "grid";
            this.query = "";
            this.maxSpaces = 50;
            this.offset = 0;

            //query for spaces
            $.ajax({
                type:"GET",
                url:AJS.format("{0}/rest/api/space?start=0&limit=" + this.maxSpaces, Confluence.getContextPath()),
                dataType:"json",
                cache:false,
                success:function (data) {
                    self.offset += data.results.length;
                    for (var i = 0; i < data.results.length; i++) {
                        self.spaces.push({shortName: data.results[i].key, longName: data.results[i].name});
                    }
                },
                error:function (xhr, textstatus, errorThrown) {
                    AJS.log("space service unavailable " + textstatus);
                }
            });

        };
        InsertPanel.prototype = new Panel();
        InsertPanel.prototype.constructor = InsertPanel;
        InsertPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.insertPanel({
                query:this.query,
                insertOnly:this.insertOnly,
                message:this.message
            });
        };
        InsertPanel.prototype.getPanelText = function () {
            return "Search for a Diagram";
        };
        InsertPanel.prototype.getPrimaryButtonText = function () {
            if (this.insertOnly) {
                return "Insert Diagram";
            } else {
                return "Use as a Template";
            }
        };
        InsertPanel.prototype.scroll = function(e, baseDialog) {

            var self = this,
                now = (new Date()).getTime();

            if(!self.__tempTime) {
                self.__scrolling = true;
                self.__tempTime = now;
            } else if (now - self.__tempTime > 200 && !self.__scrolling) {
                self.__scrolling = true;
                self.__tempTime = now;
            }

            clearTimeout(self.__scrollTimeout);
            self.__scrollTimeout = setTimeout(function () {
                if (self.__scrolling) {
                    self.__scrolling = false;
                    self.scrollEnd(e, baseDialog);
                }

            }, 200);
        };

        InsertPanel.prototype.scrollEnd = function(e, baseDialog) {
            var placeholder = $("#gliffy-macro-dialog .gliffy-placeholder"),
                data;
            if(placeholder.length>0 && this.isScrolledIntoView(placeholder) ) {
                //do render more results!
                data = placeholder.data();
                placeholder.remove();
                this.search(baseDialog, data.index, data.results);
            }

        };

        InsertPanel.prototype.isScrolledIntoView = function(elem) {
            var container = $("#gliffy-macro-dialog .gliffy-content"),
                docViewTop = 0,
                docViewBottom = docViewTop + container.height(),

                elemTop = $(elem).offset().top - container.offset().top,
                elemBottom = elemTop + $(elem).height();

            return (elemBottom >= docViewTop && elemBottom <= docViewBottom) || (elemTop >= docViewTop && elemTop <=docViewBottom);
        };

        InsertPanel.prototype.search = function (baseDialog, index, results) {
            //perform the search
            var spaceKey = baseDialog.find(".gliffy-space-dropdown").data("value"),
                sort = baseDialog.find(".gliffy-sort-dropdown").data("value"),
                toggleDefaultOrder = baseDialog.find(".gliffy-sort-dropdown").data("order") || false,
                params,
                defaultOrder = {"title":"ascending", "created":"descending", "modified":"descending"},
                toggleOrder = {"title":"descending", "created":"ascending", "modified":"ascending"},
                self = this,
                query = self.query,
                searchResultsContainer;

            if(!results || !index) {
                results = 20;
                index = 0;
            }

            params = {
                query:encodeURIComponent(query),
                index:index,
                results:results,
                spaceKey:spaceKey,
                sort:sort,
                order:(toggleDefaultOrder) ? toggleOrder[sort] : defaultOrder[sort]
            };

            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/diagrams.json",
                dataType:'json',
                data:params,
                cache:false,
                success:function (data) {

                    searchResultsContainer = baseDialog.find(".gliffy-content .gliffy-search-results");

                    if(index === 0) {
                        searchResultsContainer.empty();
                    }

                    if (self.view === "grid") {
                        searchResultsContainer.append(gliffySoy.macro.dialog.searchResults({
                            diagrams:data.diagrams,
                            rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,
                            index: index,
                            results: results
                        }));
                    } else {
                        searchResultsContainer.append(gliffySoy.macro.dialog.listSearchResults({
                            diagrams:data.diagrams,
                            rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,
                            index: index,
                            results: results
                        }));
                    }
                    for(var i=0; i<data.diagrams.length; i++) {
                        $(".gliffy-template[data-name='"+data.diagrams[i].attachmentId+"']").data("diagram", data.diagrams[i]);
                    }
                }
            });

        };
        InsertPanel.prototype.setup = function (baseDialog) {

            var self = this, questionLink;

            //--------------------- add checkbox and help text ------------------//
            baseDialog.find(".button-container-right").append(
                gliffySoy.macro.dialog.insertPanelCheckbox({
                    insertOnly:self.insertOnly,
                    blueprint:self.blueprint
                })
            );

            baseDialog.find(".gliffy-toggle-checkbox").change(function (event) {
                //update button text
                var checked = $(this).is(":checked"), primaryButton = baseDialog.find(".gliffy-button.gliffy-primary");
                if (checked) {
                    primaryButton.text("Insert Diagram");
                } else {
                    primaryButton.text(self.getPrimaryButtonText());
                }
                analyticsEvent('trackEvent', {category:'panelSearchToggleInsert', action:checked});
            });

            questionLink = baseDialog.find(".gliffy-question-link").click(function () {
                return false;
            });
            if (questionLink.tooltip) {
                //This uses atlassian's tipsy tooltip. We do not include this.
                questionLink.tooltip({live:false, gravity:'s', title:"data-tooltip", delayIn:500, delayOut:0, offset:5});
            } else {
                //fallback to updating the link title
                questionLink.attr("title", questionLink.data("tooltip"));
            }

            //--------------------- table delegate events ------------------//

            baseDialog.delegate("table.gliffy-list-search-results tr", "click.gliffy-row-highlight", function (event) {
                var tr = $(this), template = tr.find(".gliffy-template");
                if (template.length > 0) {
                    baseDialog.find("table .gliffy-active").removeClass("gliffy-active");
                    tr.addClass("gliffy-active");
                    template.addClass("gliffy-active");
                }
            });

            baseDialog.delegate("table.gliffy-list-search-results tr", "dblclick.gliffy-row-highlight", function (event) {
                var tr = $(this), template = tr.find(".gliffy-template");
                if (template.length > 0) {
                    //perform main action
                    self.primaryAction(event, baseDialog);
                }
            });

            //--------------------- Setup dropdown state ------------------------//

            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.insertDropdown({
                    items:this.spaces,
                    label:"",
                    name:"gliffy-space-dropdown"
                })
            );
            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.insertDropdown({
                    items:this.sort,
                    label:"Sort by:",
                    name:"gliffy-sort-dropdown"
                })
            );

            //also add the list/grid toggle
            baseDialog.find(".gliffy-insert-search-form").append(
                gliffySoy.macro.dialog.listGridToggle({
                    view:self.view === "grid" ? "gliffy-icon-grid" : "gliffy-icon-list"
                })
            );

            baseDialog.find(".gliffy-list-grid-toggle").click(function () {
                var toggle = $(this);
                if (self.view === "grid") {
                    toggle.removeClass("gliffy-icon-grid").addClass("gliffy-icon-list");
                    self.view = "list";
                } else {
                    toggle.removeClass("gliffy-icon-list").addClass("gliffy-icon-grid");
                    self.view = "grid";
                }
                analyticsEvent('trackEvent', {category:'panelSearchToggleGridList', action:self.view});

                self.search(baseDialog);
            });

            baseDialog.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle").click(function (event) {
                event.preventDefault();
                event.stopPropagation();
                $(this).closest(".gliffy-btn-group").find("ul.gliffy-dropdown-menu").toggle();

            });

            baseDialog.bind("click.gliffy-btn-dropdown", function () {
                baseDialog.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle");
                baseDialog.find("ul.gliffy-dropdown-menu:visible").hide();
            });

            $(baseDialog).delegate("ul.gliffy-dropdown-menu li", 'click', function (event) {
                event.preventDefault();
                event.stopPropagation();
                var $this = $(this), longName = $this.find("a").text(), shortName = $this.find("a").data("value"),
                    buttonGroup = $this.closest(".gliffy-btn-group");
                buttonGroup.find("button.gliffy-dropdown").text(longName);
                if (buttonGroup.data("value") === shortName) {
                    buttonGroup.data("order", !(buttonGroup.data("order") == true));
                } else {
                    buttonGroup.data("value", shortName);
                    buttonGroup.data("order", false);
                }
                buttonGroup.find("ul.gliffy-dropdown-menu").toggle();
                self.search(baseDialog);
            });

            baseDialog.find("ul.gliffy-dropdown-menu").scroll(_.debounce(function() {
                var scroller = this;
                if($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight) {
                    $.ajax({
                        type: "GET",
                        url: AJS.format("{0}/rest/api/space?start={1}&limit={2}",
                            Confluence.getContextPath(),
                            self.offset,
                            self.maxSpaces),
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            self.offset += data.results.length;
                            for (var i = 0; i < data.results.length; i++) {
                                var result = data.results[i];
                                var name = document.createElement('span');
                                name.textContent = result.name;
                                $(scroller).append('<li><a href="#" data-value="' + result.key + '">' + name.innerHTML + '</a></li>');
                            }
                        },
                        error: function (xhr, textstatus, errorThrown) {
                            AJS.log("space service unavailable " + textstatus);
                        }
                    });
                }
            }, 200));

            //--------------------- Search ------------------------//

            //search
            baseDialog.find(".gliffy-insert-search").keyup(function (event) {
                clearTimeout(self.timeout);
                self.query = $.trim(baseDialog.find(".gliffy-insert-search").val());
                self.timeout = setTimeout(function () {
                    self.search(baseDialog);
                }, 500);
            }).keydown(function (event) {
                if (event.which === 13) {
                    //dropdown toggles otherwise...
                    event.preventDefault();
                    self.query = $.trim(baseDialog.find(".gliffy-insert-search").val());
                    self.search(baseDialog);
                }
            });
            baseDialog.find(".gliffy-insert-search-form").submit(function (event) {
                event.stopPropagation();
                event.preventDefault();
            });


            baseDialog.find(".gliffy-content").scroll(function(e) {
                self.scroll(e, baseDialog);
            });

            //populate tab
            self.search(baseDialog);

        };
        InsertPanel.prototype.teardown = function (baseDialog) {

            //------- remove diagram link checkbox and help text ------//
            baseDialog.find(".gliffy-toggle-insert").remove();
            baseDialog.unbind("click.gliffy-row-highlight");
            baseDialog.unbind("dblclick.gliffy-row-highlight");
            baseDialog.unbind("click.gliffy-btn-dropdown");
            baseDialog.find(".gliffy-content").unbind("scroll");
        };
        InsertPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {

            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                checkbox = baseDialog.find(".gliffy-toggle-checkbox"),
                currentParams, diagram, isBlueprint =  macroDialog.isFromBlueprint();

            event.preventDefault();
            event.stopPropagation();

            if (template.length > 0) {

                if (this.insertOnly || checkbox.is(":checked") || isBlueprint) {

                    //insert
                    diagram = template.data("diagram");

                    if (diagram) {

                        currentParams = {};
                        currentParams.name = diagram.name;

                        //mark if is blueprint on page template
                        if(isBlueprint) {
                            //we need the attachment id to transform this later
                            currentParams.attachmentId = diagram.attachmentId;
                        }

                        // Let's not add the diagram version on the macro as we don't want to fix the displayed version unless
                        // the user explicitly chooses to
                        // currentParams.version = selectedDiagramVersion;
                        if (Confluence.Editor.getContentId() != diagram["pageId"]) {
                            currentParams.pageid = diagram["pageId"];
                        }

                        AJS.Rte.BookmarkManager.storeBookmark();
                        var macroRenderRequest = {
                            contentId:Confluence.Editor.getContentId(),
                            macro:{
                                name:"gliffy",
                                params:currentParams,
                                defaultParameterValue:"",
                                body:""
                            }
                        };

                        GLIFFY.confluence.insertMacro(macroRenderRequest);
                        GLIFFY._confluence.macroDialog.hide();

                        analyticsEvent('trackEvent', {category:'panelSearch', action:"insert"});


                    }
                } else {
                    analyticsEvent('trackEvent', {category:'panelSearch', action:"create"});
                    //create
                    AJS.trigger("gliffy.confluence.launchTemplate", [template.data("category"), template.data("name")]);
                }
            }

        };

        /******************************************************************/
        /*                      Import Panel                              */
        /******************************************************************/


        ImportPanel = function () {
            var self = this;

            this.name = "import";

            //supported transformers
            this.transformers = [];

            //check for available transformers
            $.ajax({
                url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/transform/config.json",
                type:"GET",
                cache:false,
                dataType:"json",
                success:function (data) {
                    AJS.log("gliffy-transform service available");
                    for (var i = 0; i < data.transformers.length; i++) {
                        AJS.log("supports " + data.transformers[i].name);
                        self.transformers.push(data.transformers[i]);
                    }
                },
                error:function () {
                    AJS.log("gliffy-transform service unavailable.");
                    self.transformers = [
                        {"name":"Gliffy XML", "ext":'gxml'}
                    ];
                }
            });
        };
        ImportPanel.prototype = new Panel();
        ImportPanel.prototype.constructor = ImportPanel;
        ImportPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.importPanel({
                contextPath:AJS.Confluence.getContextPath()
            });
        };
        ImportPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
        };
        ImportPanel.prototype.getPanelText = function () {
            return "Import a Diagram";
        };
        ImportPanel.prototype.isExtensionSupported = function (extension) {
            return $.grep(this.transformers,function (transformer) {
                if (transformer.ext === "gliffy,gon") {
                    return "gon" === extension || "gliffy" === extension;
                } else if (transformer.ext === "xml,drawio,mxfile") {
                    return "xml" === extension || "drawio" === extension || "mxfile" === extension;
                } else {
                    return transformer.ext === extension;
                }
            }).length > 0;
        };
        ImportPanel.prototype.setupFormSubmit = function (baseDialog) {

            var errorContainer = $('#gliffy-create-import-error'), waitSpinner = $("#gliffy-import-wait"),
                fileImport = $("#gliffy-import-file"), form = $('#gliffy-create-import-form'), self = this,
                extension, token;

            //this uses confluence's ajaxForm jQuery plugin:
            baseDialog.find("#gliffy-create-import-form").ajaxForm({

                type: 'POST',
                timeout: 180000, // 3-minute timeout, for long file uploads
                beforeSubmit:function () {
                    //atlassian added a security token in 5.1.4
                    try {
                        token = AJS.Meta.get("atl-token");
                        if (token) {
                            $("#gliffy-security-token").val(token);
                        }
                    } catch (e) {
                        //let if fall through if older version
                    }

                    //you can't disable the input here, otherwise the form will not submit properly

                    if(fileImport.val().includes('.')) {
                        extension = fileImport.val().split(".").pop();
                    }
                    else {
                        extension = 'json'; // If file have no extension we treat it as json
                    }


                    if (!self.submitting && self.isExtensionSupported(extension)) {

                        //analytics on what type of file the user is attempting to upload
                        analyticsEvent('trackEvent', {category:'import', action:extension});

                        //clear errors, setup spinner
                        errorContainer.empty();
                        importSpinner = new GliffySpinner(waitSpinner.get(0), {
                            radius:10,
                            color:'#666',
                            inline:true
                        });
                        importSpinner.start();
                        self.submitting = true;
                        return true;
                    } else {
                        //notify user that the filetype is unsupported
                        AJS.messages.error("#gliffy-create-import-error", {title:"The file type is not supported for importing:" + " " + extension});
                        return false;
                    }
                },
                success: function (jsonTextResponse) {

                    self.submitting = false;

                    importSpinner.stop();
                    form.each(function () {
                        this.reset();
                    });

                    var parsedJsonResponse = $.parseJSON(jsonTextResponse);
                    var gonContent = parsedJsonResponse.gon;

                    try {
                        AJS.trigger("gliffy.confluence.launchEditorWithGonData", gonContent);
                        GLIFFY._confluence.macroDialog.hide();
                    } catch (e) {
                        errorContainer.empty();
                        AJS.messages.error("#gliffy-create-import-error", {
                            title: "Sorry, we could not import your file."
                        });
                    }
                },
                error:function (error) {
                    console.error(error);
                    self.submitting = false;

                    // reset state
                    importSpinner.stop();
                    form.each(function () {
                        this.reset();
                    });

                    AJS.messages.error("#gliffy-create-import-error", {
                        title:"Sorry, we could not import your file."
                    });
                }
            });

        };
        var importPanelInitialized = false;
        ImportPanel.prototype.setup = function (baseDialog) {
            var self = this;

            // Hide primary button
            baseDialog.find(".gliffy-button.gliffy-primary").hide();

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-gxml").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importGliffyHelpPanel({
                    contextPath:AJS.Confluence.getContextPath()
                }));
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-gon").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importGliffyGonHelpPanel({
                    contextPath:AJS.Confluence.getContextPath()
                }));
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-vdx").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importVisioHelpPanel());
                return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-drawio").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                        .append(gliffySoy.macro.dialog.importDrawIoHelpPanel());
                    return false;
            });

            // Bind the inline help
            baseDialog.find("#gliffy-file-type-lucidchart").click(function () {
                baseDialog.find(".gliffy-import-help-container").empty()
                    .append(gliffySoy.macro.dialog.importLucidchartHelpPanel());
                return false;
            });

            baseDialog.find("#gliffy-import-file").bind("change.gliffyImportPanel", function () {
                $(this).closest("form").submit();
            });

            //setup upload form
            self.setupFormSubmit(baseDialog);
            importPanelInitialized = true;
        };
        ImportPanel.prototype.teardown = function (baseDialog) {
            //show primary button
            baseDialog.find(".gliffy-button.gliffy-primary").show();

            //no delegate events were added in setup, so nothing else needs to be removed
        };


        /******************************************************************/
        /*                  Template Categories Panel                     */
        /******************************************************************/

        TemplateCategoryPanel = function (category) {
            this.category = category;
            this.name = category.uid || category.id; //key
        };
        TemplateCategoryPanel.prototype = new Panel();
        TemplateCategoryPanel.prototype.constructor = TemplateCategoryPanel;
        TemplateCategoryPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active"),
                name = template.data("name"), category = template.data("category");
            //Actual editor launch logic is in gliffy-rte-editor-html5.js
            analyticsEvent('trackEvent', {category:"panel." + category, action:name});

            AJS.trigger("gliffy.confluence.launchTemplate", [category, name]);


        };
        TemplateCategoryPanel.prototype.isTemplateCategory = function () {
            return true;
        };
        TemplateCategoryPanel.prototype.getTemplate = function () {

            return gliffySoy.macro.dialog.templatePanel({
                category:this.category.uid,
                templates:this.category.templates,
                contextPath:AJS.Confluence.getContextPath()
            });

        };
        TemplateCategoryPanel.prototype.getPanelText = function () {
            return this.category.desc;
        };
        TemplateCategoryPanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };


        /******************************************************************/
        /*                  Blueprint Categories Panel                    */
        /******************************************************************/

        BlueprintCategoryPanel = function (category) {
            this.category = category;
            this.name = category.uid || category.id;
        };
        BlueprintCategoryPanel.prototype = new Panel();
        BlueprintCategoryPanel.prototype.constructor = TemplateCategoryPanel;
        BlueprintCategoryPanel.prototype.isTemplateCategory = function () {
            return true;
        };
        BlueprintCategoryPanel.prototype.getTemplate = function () {
            return gliffySoy.macro.dialog.templatePanel({
                category:this.category.uid,
                templates:this.category.templates,
                contextPath:AJS.Confluence.getContextPath()
            });

        };
        BlueprintCategoryPanel.prototype.getPanelText = function () {
            return this.category.desc.charAt(0).toUpperCase() + this.category.desc.slice(1);
        };
        BlueprintCategoryPanel.prototype.getPrimaryButtonText = function (event) {
            return "Create";
        };

//      Add any custom logic/elements in the setup function, if you added any delegates, or
//      bound any events outside of your panel, remove it in teardown.
        BlueprintCategoryPanel.prototype.setup = function (baseDialog) {
        };
        BlueprintCategoryPanel.prototype.teardown = function (baseDialog) {
        };

        BlueprintCategoryPanel.prototype.primaryAction = function (event, baseDialog, macroDialog) {
            event.preventDefault();
            event.stopPropagation();
            var template = baseDialog.find(".gliffy-content .gliffy-template.gliffy-active");
            analyticsEvent('trackEvent', {category:'macro', action:"addToConfluenceTemplate"});
            AJS.trigger('gliffy.confluence.addGliffyDiagramToPage', [template.data("category"), template.data("name")]);

        };


        /******************************************************************/
        /*                   Macro Dialog                                 */
        /******************************************************************/

        GLIFFY._confluence.macroDialog = {
            //true if, the dialog has already been init'd and appended to body
            initialized:false,
            //our normal panels
            panels:{},
            //what the panel should do when you click the primary button
            primaryActions:{},
            //primary button text
            primaryButtonText:{},
            //can the user create attachments?
            canCreateAttachmentPromise:null,

            //panel state (what panel is currently rendered)
            panelState:null,

            setPanelState:function (state) {
                this.panelState = state;
            },

            getPanelState:function () {
                return this.panelState;
            },

            /******************************************************************/
            /*                 Button Events and Styling                      */
            /******************************************************************/

            /**
             * Sets the correct style for the active panel link
             * @param link
             */
            setActivePanelLink:function (listItem) {
                this.baseDialog.find("li.gliffy-active").removeClass("gliffy-active");
                listItem.addClass("gliffy-active");
            },

            /**
             * Sets the correct style for the active template in gliffy-content
             * @param link
             */
            setActiveTemplate:function (template) {
                this.baseDialog.find(".gliffy-content .gliffy-template.gliffy-active").removeClass("gliffy-active");
                template.addClass("gliffy-active");
            },

            /**
             * Registers what a panel should do when the primary button is clicked
             * @param key
             * @param primaryAction
             */
            registerPrimaryAction:function (panel) {
                this.primaryActions[panel.getName()] = panel;
                if (panel.getPrimaryButtonText()) {
                    this.primaryButtonText[panel.getName()] = panel.getPrimaryButtonText();
                }
            },
            /**
             * Updates the primary button text
             * @param key
             */
            updatePrimaryButtonText:function (key) {
                this.baseDialog.find(".gliffy-button.gliffy-primary").text(this.primaryButtonText[key]);
            },

            /**
             * Binds the primary button click handler. Call this once.
             */
            bindPrimaryButtonClick:function () {
                var self = this;
                this.baseDialog.delegate(".gliffy-button.gliffy-primary", "click", function (event) {
                    if (self.getPanelState()) {
                        self.primaryActions[self.getPanelState()].primaryAction(event, self.baseDialog, self);
                    }
                });
            },

            /**
             * Binds the secondary button handler. Call this once.
             */
            bindSecondaryButtonClick:function () {
                var self = this;
                this.baseDialog.delegate(".gliffy-button.gliffy-secondary", "click", function (event) {
                    event.preventDefault();
                    self.hide();
                });
            },
            /**
             * Binds the click handler for the blanket. call this once.
             */
            bindBlanketClick:function () {
                var self = this;
                this.blanket.click(function () {
                    self.hide();
                });
            },

            bindPanelLinkClick:function () {
                var self = this;
                $(this.baseDialog).delegate("ul.gliffy-panel-links li", "click", function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    var listItem = $(this), key = listItem.data("key");
                    if (key) {
                        self.renderPanel(self.panels[key]);
                    }
                });
            },

            bindTemplateElementClick:function () {
                var self = this;

                //single click
                $(this.baseDialog).delegate(".gliffy-content .gliffy-template", "click", function (event) {
                    event.preventDefault();
                    self.setActiveTemplate($(this));
                });

                //double click
                $(this.baseDialog).delegate(".gliffy-content .gliffy-template", "dblclick", function (event) {
                    event.preventDefault();
                    //trigger primary action
                    if (self.getPanelState()) {
                        self.primaryActions[self.getPanelState()].primaryAction(event, self.baseDialog, self);
                    }
                });

            },

            /******************************************************************/
            /*                       Panels                                   */
            /******************************************************************/

            /**
             * Registers the panel and adds a new link in sidebar
             */
            registerPanel:function (panel) {

                this.panels[panel.getName()] = panel;

                //give panel a reference to it's inserted panel link
                panel.insertedPanelLink = $(panel.getPanelLink());

                if (panel.isTemplateCategory()) {
                    this.baseDialog.find(".gliffy-sidebar-templates ul").append(panel.insertedPanelLink);
                } else {
                    this.baseDialog.find(".gliffy-sidebar-panels ul.gliffy-panel-links").append(panel.insertedPanelLink);
                }
                //binds any required delegate events
                this.registerPrimaryAction(panel);
            },
            /**
             * Renders a panel
             * @param panel
             */
            renderPanel:function (panel) {
                if (this.getPanelState()) {
                    this.panels[this.getPanelState()].teardown(this.baseDialog);
                }
                this.baseDialog.find(".gliffy-content").empty().append(panel.getTemplate());
                this.setActivePanelLink(panel.insertedPanelLink);
                this.updatePrimaryButtonText(panel.getName());
                this.setPanelState(panel.getName());
                panel.setup(this.baseDialog);

            },
            /******************************************************************/
            /*                       Templates                                */
            /******************************************************************/

            /**
             * ajax call to get template categories
             */
            populateTemplateCategories:function (panelType) {
                var self = this;
                $.ajax({
                    url:GLIFFY._confluence.gvars.gliffyApiEndpoint + "/templateLibraries/com.gliffy.template_library.default",
                    type:"GET",
                    cache:false,
                    success:function (data, textStatus, xhr) {
                        //add blank category for blueprint
                        if (panelType === BlueprintCategoryPanel) {
                            var blankCategory = {
                                desc:"Blank",
                                template:[
                                    {
                                        desc:"Blank",
                                        uid:"com.gliffy.template.blank",
                                        previewLocation:"",
                                        templateLocation:""
                                    }
                                ],
                                uid:"com.gliffy.templates.blank"
                            }
                            data.categories.unshift(blankCategory);
                        }

                        for (var i = 0; i < data.categories.length; i++) {
                            var category = data.categories[i];
                            //Create and Register TemplateCategoryPanels
                            self.registerPanel(new panelType(category));
                        }
                    },
                    error:function (xhr) {
                        //remove template sidebar list
                        self.baseDialog.find(".gliffy-sidebar-templates").remove();
                    }
                });

            },
            /******************************************************************/
            /*                        Init                                    */
            /******************************************************************/

            init:function () {
                this.canCreateAttachmentPromise = this.canCreateAttachments()
            },

            /**
             * Check to see if the anon user is on a draft.
             * If the user has no attachment permissions.
             *
             * This returns a promise that is rejected if they don't have the right attachment permissions
             */
            canCreateAttachments:function () {

                var deferred = new PromiseJS.Deferred(), pageId = Confluence.Editor.getContentId(), message;

                if (pageId === "0") {
                    deferred.reject("Please save the page before creating a diagram.");
                } else {
                    $.ajax({
                        type:"GET",
                        url:AJS.format("{0}/ceo/{1}/permission", GLIFFY._confluence.gvars.gliffyApiEndpoint, pageId),
                        dataType:"json",
                        cache:false,
                        success:function () {
                            deferred.resolve();
                        },
                        error:function (xhr) {
                            // If it's a license error, be more aggressive
                            if (xhr.status === 402) {
                                message = "License Error. Please contact your Administrator.";
                            }
                            else if (xhr.status === 404) {
                                //unauthorized is 401, but we substitue with 404 here for: http://jira.gliffy.com/browse/GCONF-1642
                                message = "No create permission or you are not logged in.";
                            }
                            else {
                                message = "Error. Please contact your Administrator.";
                            }
                            deferred.reject(message);
                        }
                    });
                }

                return deferred.promise;
            },

            /**
             * Did we come in from the blueprint workflow?
             */
            isFromBlueprint:function () {
                return AJS.Meta.get('form-name') === 'createpagetemplate' || AJS.Meta.get('form-name') === 'editpagetemplate';
            },


            setupButtons:function () {
                this.bindPrimaryButtonClick();
                this.bindSecondaryButtonClick();
                this.bindBlanketClick();
                this.bindPanelLinkClick();
                this.bindTemplateElementClick();
            },

            buildDialog:function () {
                var i, self = this, panels, panel, analyticsPromise;

                //initialize analytics!
                analyticsPromise = GLIFFY._confluence.utils.initAnalytics();

                //create the blanket
                this.blanket = $(gliffySoy.macro.dialog.blanket());


                if (this.isFromBlueprint()) {

                    analyticsPromise.then(function () {
                        analyticsEvent('trackEvent', {category:'macroInit', action:"blueprint"});
                    });


                    self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:false}));

                    //start the template request
                    self.populateTemplateCategories(BlueprintCategoryPanel);

                    //create a new panel that is insert only!
                    panel = new InsertPanel(true, "", true);

                    self.registerPanel(panel);

                    //setup button state
                    self.setupButtons();

                    //render the first panel
                    self.renderPanel(panel);

                    //append the modal and blanket to body
                    self.blanket.appendTo("body");
                    self.baseDialog.appendTo("body");

                    self.initialized = true;


                } else {
                    this.canCreateAttachmentPromise.then(function () {

                        analyticsPromise.then(function () {
                            analyticsEvent('trackEvent', {category:'macroInit', action:"normal"});
                        });

                        //we can create attachments!
                        self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:false}));

                        //start the template request
                        self.populateTemplateCategories(TemplateCategoryPanel);

                        //our static panels
                        panels = [new CreatePanel(), new ImportPanel(), new InsertPanel()];

                        //register panels
                        for (i = 0; i < panels.length; i++) {
                            self.registerPanel(panels[i]);
                        }

                        //setup button state
                        self.setupButtons();

                        //render the first panel
                        self.renderPanel(panels[0]);

                        //append the modal and blanket to body
                        self.blanket.appendTo("body");
                        self.baseDialog.appendTo("body");

                        self.initialized = true;

                    }, function (message) {


                        analyticsPromise.then(function () {
                            analyticsEvent('trackEvent', {category:'macroInit', action:"noAttachPermissions"});
                        });

                        //show the InsertPanel (Search) only, and do not populate templates

                        self.baseDialog = $(gliffySoy.macro.dialog.base({insertOnly:true}));

                        //create a new panel that is insert only!
                        panel = new InsertPanel(true, message);

                        self.registerPanel(panel);

                        //setup button state
                        self.setupButtons();

                        //render the first panel
                        self.renderPanel(panel);

                        //append the modal and blanket to body
                        self.blanket.appendTo("body");
                        self.baseDialog.appendTo("body");

                        self.initialized = true;

                    });
                }

            },
            /******************************************************************/
            /*               'Public' Methods                                 */
            /******************************************************************/
            show:function () {
                if (!this.initialized) {
                    this.buildDialog();
                } else {
                    //GCONF 1847 re-position the dialog and remove margin if the dialog height is larger than the window height
                    //to prevent the top of the dialog from being trancated at the top
                    var heightDifference = ($('body').height() - $('#gliffy-macro-dialog').height())/2;
                    var minimumTopMargin = 20;
                    if (heightDifference < minimumTopMargin) {
                        //ie hides the srollbars, so we need to show them to be able to scroll to the create/cancel buttons
                        //later versions of IE user agent string do not contain MSIE so do a check for Wind
                        if (window.navigator.userAgent.indexOf('Trident') != -1) {
                            $('body').css('overflow-y', 'scroll');
                        }
                        $('#gliffy-macro-dialog').css('top', minimumTopMargin);
                        $('#gliffy-macro-dialog').css('margin-top', 0);
                    }

                    this.blanket.show();
                    this.baseDialog.show();
                }
            },
            hide:function () {
                if (this.initialized) {
                    var heightDifference = ($('body').height() - $('#gliffy-macro-dialog').height())/2;
                    if (window.navigator.userAgent.indexOf('Trident') != -1) {
                        //put back to the original state if we close
                        $('body').css('overflow-y', 'hidden');
                        window.scrollTo(0, 0);
                    }
                    //GCONF-2702: GCONF-2599 broke Import which is described in GCONF-2702. Following addresses the fix.
                    //In the future when the code in the else block is used, this if block can be removed.
                    if (importPanelInitialized) {
                        this.blanket.hide();
                        this.baseDialog.hide();
                    } else {
                        //This vomit fixes a bug with windows/Chrome continuing
                        // to render the blanket even when it's display:none
                        // TODO: remove when windows chrome is fixed
                        this.blanket.remove().hide().appendTo('body');
                        this.baseDialog.remove().hide().appendTo('body');
                        this.setupButtons();
                        //Replace with this
                        // this.blanket.hide();
                        // this.baseDialog.hide();
                    }
                }
            }
        };
        //any other things we should check before our macro dialog is displayed?
        GLIFFY._confluence.macroDialog.init();

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte.js' */
// http://docs.atlassian.com/aui/3.0/
// http://confluence.atlassian.com/display/AUI/Dialog
AJS.bind("gliffy.init.rte", function (event) {
    (function ($) {
        AJS.log("AJS.version=" + AJS.version);
        var CUTOFF_TIME = 1000*60*60*24*30; //30 days in ms.  We are filtering for drafts that are over 30 days old to encourage people to publish or remove them.
        var draftCutoff = Date.now() - CUTOFF_TIME;
        //check for drafts over 15 days since last edit and nag the user if any GliffyDocumentCondition
        AJS.$.ajax(AJS.format("{0}/rest/gliffy/1.0/diagrams/drafts?before={1}&limit=1", Confluence.getContextPath(), draftCutoff)).then(function(response) {
            if (response.drafts.length === 0) {
                return;
            }
            var message = "It appears you have open Gliffy drafts over {$numberDays} days old.  \u003ca href=\u0022{$contextPath}/plugins/gliffy/gliffyUserPage.action\u0022\u003eClick here\u003c/a\u003e to navigate to your drafts or remove them if you no longer plan to publish them."
                .replace('{$numberDays}', '30')
                .replace('{$contextPath}', Confluence.getContextPath());
            var draftDialog = gliffySoy.oldDrafts.popup({
                message: message
            });
            var flagContainer = AJS.$('#aui-flag-container');
            if (flagContainer.length === 0) {
                AJS.$('body').prepend('<div id="aui-flag-container" />')
            }
            AJS.$('#aui-flag-container').prepend(draftDialog);
            AJS.$('.gliffy-close-icon').click(function() {
                AJS.$('.gliffy-draft-message-popup').hide();
            });
        });

        //==============================================================================================================
        // Show our macro dialog
        //==============================================================================================================

        var showDialogFirstEntry = function (dialog) {
            dialog.show();
            dialog.gotoPanel(0, 0);
        };

        var showPanel = function (dialog, onSuccessFunc) {
            //query for spaces
            if (GLIFFY._confluence.gvars.spaces.length < 1) {
                $.ajax({
                    type : "GET",
                    url : AJS.format("{0}/rest/api/space", Confluence.getContextPath()),
                    dataType : "json",
                    cache : false,
                    success : function (data) {
                        GLIFFY._confluence.gvars.spaces = data.categoryList;

                        $(".gliffy-space-dropdown").append(
                            gliffySoy.macro.dialog.spaceOptions({spaces : data.categoryList})
                        );

                        showDialogFirstEntry(dialog);

                        if (onSuccessFunc){
                            onSuccessFunc();
                        }
                    },
                    error : function (xhr, textstatus, errorThrown) {
                        AJS.log("space service unavailable " + textstatus);
                        showDialogFirstEntry(dialog);
                    }
                });
            }
            else {
                showDialogFirstEntry(dialog);
            }
        };

        AJS.bind("gliffy.confluence.showMacroDialog", function (event, params) {


            //clear the current selection of {gliffy
            AJS.Rte.getEditor().selection.setContent("");
            //bookmark selection
            AJS.Rte.BookmarkManager.storeBookmark();

            GLIFFY._confluence.macroDialog.show();

            return false;
        });


        //can't use live here since we want to stop immediate propagation
        $('#gliffy').click(function () {
            AJS.trigger("gliffy.confluence.showMacroDialog");
        });
        //==============================================================================================================
        // Add Diagram Workflow Setup
        //==============================================================================================================
        // If gliffy is in the hash, launch our dialog or the inline editor
        var urlParams = GLIFFY._confluence.utils.getUrlVars();
        if (urlParams["showGliffyMacro"]) {

            var ed = AJS.Rte.getEditor();
            var tmp = ed.dom.create("p");
            var $body = $(ed.getBody());

            var firstP = $body.find("p:first");
            if (firstP.length > 0) {
                firstP.before(tmp);
            } else {
                $body.prepend(tmp);
            }
            ed.dom.add(tmp, "p", {"class" : "gliffy-caret"});

            ed.focus(); //for firefox weirdness

            ed.selection.select(ed.dom.select("p.gliffy-caret")[0]);
            var bookmark = ed.selection.getBookmark();
            ed.selection.moveToBookmark(bookmark);

            ed.dom.remove(ed.dom.select("p.gliffy-caret")[0]);

            AJS.trigger("gliffy.confluence.showMacroDialog", {createDiagramType: urlParams["createDiagramType"]});
        }

    }(AJS.$));
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-rte.soy' */
// This file was automatically generated from gliffy-rte.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.macro.dialog.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.macro == 'undefined') { gliffySoy.macro = {}; }
if (typeof gliffySoy.macro.dialog == 'undefined') { gliffySoy.macro.dialog = {}; }


gliffySoy.macro.dialog.blanket = function(opt_data, opt_ignored) {
  return '<div id="gliffy-macro-blanket"></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.blanket.soyTemplateName = 'gliffySoy.macro.dialog.blanket';
}


gliffySoy.macro.dialog.base = function(opt_data, opt_ignored) {
  return '<div id="gliffy-macro-dialog"><div class="gliffy-header"><div class="gliffy-logo"></div></div><div class="gliffy-dialog-body"><div class="gliffy-sidepanel"><div class="gliffy-sidebar-panels"><ul class="gliffy-panel-links"></ul></div>' + ((opt_data.insertOnly != true) ? '<div class="gliffy-sidebar-templates"><ul class="gliffy-panel-links"><li class="gliffy-panel-title"><b>' + soy.$$escapeHtml('Templates') + '</b></li></ul></div>' : '') + '</div><div class="gliffy-content"></div><div class="gliffy-clear"></div><div class="gliffy-footer"><div class="button-container-left"></div><div class="button-container-right"><ul class="gliffy-button-list"><li><a class="gliffy-button gliffy-primary" href="#">' + soy.$$escapeHtml('Create') + '</a></li><li><a class="gliffy-button gliffy-secondary" href="#">' + soy.$$escapeHtml('Cancel') + '</a></li></ul></div><div class="gliffy-clear"></div></div></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.base.soyTemplateName = 'gliffySoy.macro.dialog.base';
}


gliffySoy.macro.dialog.panelLink = function(opt_data, opt_ignored) {
  return '<li ' + ((opt_data.active == true) ? 'class="gliffy-active"' : '') + '  data-key="' + soy.$$escapeHtml(opt_data.key) + '"><a href="#">' + soy.$$escapeHtml(opt_data.title) + '</a></li>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.panelLink.soyTemplateName = 'gliffySoy.macro.dialog.panelLink';
}


gliffySoy.macro.dialog.templatePanel = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.category == 'com.gliffy.templates.blank') {
    output += '<div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-name="com.gliffy.template.blank"><div class="gliffy-image-placeholder"/><span>' + soy.$$escapeHtml('Blank') + '</span></div>';
  } else {
    var templateList33 = opt_data.templates;
    var templateListLen33 = templateList33.length;
    for (var templateIndex33 = 0; templateIndex33 < templateListLen33; templateIndex33++) {
      var templateData33 = templateList33[templateIndex33];
      output += '<div data-category="' + soy.$$escapeHtml(opt_data.category) + '" data-name="' + soy.$$escapeHtml(templateData33.uid) + '" class="gliffy-template ' + ((templateIndex33 == 0) ? 'gliffy-active' : '') + '"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0' + soy.$$escapeHtml(templateData33.thumbnailLocation) + '\')"></div><span>' + soy.$$escapeHtml(templateData33.desc) + '</span></div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.templatePanel.soyTemplateName = 'gliffySoy.macro.dialog.templatePanel';
}


gliffySoy.macro.dialog.createPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-blank-container"><div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-panels="basic" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-basic"></div><span>' + soy.$$escapeHtml('Basic') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="cloud" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-cloud"></div><span>' + soy.$$escapeHtml('Cloud Services') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="bpmn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-bpmn"></div><span>' + soy.$$escapeHtml('Flowchart \x26 BPMN') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="software" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-uml"></div><span>' + soy.$$escapeHtml('Software Design: UML \x26 ERD') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="network" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-network"></div><span>' + soy.$$escapeHtml('Network') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="ui" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-wireframe"></div><span>' + soy.$$escapeHtml('Wireframe') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="org" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-org"></div><span>' + soy.$$escapeHtml('Org Chart') + '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="venn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-venn"></div><span>' + soy.$$escapeHtml('Venn Diagram') + '</span></div><div class="gliffy-template" data-category="com.gliffy.template.mindmap_blank" data-panels="mindmap" data-name="com.gliffy.template.mindmap_blank" ><div class="gliffy-image-placeholder gliffy-symbol-mindmap"></div><span>' + soy.$$escapeHtml('Mind Map') + '</span></div><div class="gliffy-clear"></div></div><div class="gliffy-recent-container"><div class="gliffy-recent-title">' + soy.$$escapeHtml('Use a Recent Diagram as a Template') + '</div><div class="gliffy-recent-results"><div class="gliffy-spinner-container"></div></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.createPanel.soyTemplateName = 'gliffySoy.macro.dialog.createPanel';
}


gliffySoy.macro.dialog.searchResults = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.diagrams.length > 0) {
    var diagramList75 = opt_data.diagrams;
    var diagramListLen75 = diagramList75.length;
    for (var diagramIndex75 = 0; diagramIndex75 < diagramListLen75; diagramIndex75++) {
      var diagramData75 = diagramList75[diagramIndex75];
      output += '<div data-category="com.gliffy.transform.diagram" data-name="' + soy.$$escapeHtml(diagramData75.attachmentId) + '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.rootApi) + soy.$$escapeHtml(diagramData75.urls.thumbnail) + '\')"></div><span>' + soy.$$escapeHtml(diagramData75.displayName ? diagramData75.displayName : diagramData75.name) + '</span></div>';
    }
    output += (opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '';
  } else {
    output += '<div style="text-indent:7.5px;">' + soy.$$escapeHtml('No Diagrams Found') + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.searchResults.soyTemplateName = 'gliffySoy.macro.dialog.searchResults';
}


gliffySoy.macro.dialog.listGridToggle = function(opt_data, opt_ignored) {
  return '<span class="gliffy-list-grid-toggle ' + soy.$$escapeHtml(opt_data.view) + '"></span>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.listGridToggle.soyTemplateName = 'gliffySoy.macro.dialog.listGridToggle';
}


gliffySoy.macro.dialog.listSearchResults = function(opt_data, opt_ignored) {
  var output = '<table class="gliffy-list-search-results">' + ((opt_data.index == 0) ? '<thead><tr><th class="gliffy-table-column-diagram"><div class="gliffy-background-f0"></div></th><th class="gliffy-table-column-space">' + soy.$$escapeHtml('Space') + '</th><th class="gliffy-table-column-date">' + soy.$$escapeHtml('Last Modified') + '</th></tr></thead>' : '') + '<tbody>';
  if (opt_data.diagrams.length > 0) {
    var diagramList112 = opt_data.diagrams;
    var diagramListLen112 = diagramList112.length;
    for (var diagramIndex112 = 0; diagramIndex112 < diagramListLen112; diagramIndex112++) {
      var diagramData112 = diagramList112[diagramIndex112];
      output += '<tr><td><div data-category="com.gliffy.transform.diagram" data-name="' + soy.$$escapeHtml(diagramData112.attachmentId) + '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'' + soy.$$escapeHtml(opt_data.rootApi) + soy.$$escapeHtml(diagramData112.urls.thumbnail) + '\')"></div></div><div class="gliffy-diagram-list-info">' + soy.$$escapeHtml(diagramData112.displayName ? diagramData112.displayName : diagramData112.name) + '<div class="gliffy-list-label">' + soy.$$escapeHtml('Last Modified by') + ' ' + soy.$$escapeHtml(diagramData112.lastModifier) + '</div></div></td><td>' + soy.$$escapeHtml(diagramData112.spaceName) + '</td><td>' + soy.$$escapeHtml(diagramData112.lastModifiedFriendly) + '</td></tr>';
    }
  } else {
    output += '<tr><td><div style="text-indent:7.5px;">' + soy.$$escapeHtml('No Diagrams Found') + '</div></td><td></td><td></td></tr>';
  }
  output += '</tbody></table>' + ((opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '');
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.listSearchResults.soyTemplateName = 'gliffySoy.macro.dialog.listSearchResults';
}


gliffySoy.macro.dialog.insertPanel = function(opt_data, opt_ignored) {
  return '<div><form class="gliffy-insert-search-form"><input class="gliffy-insert-search" type="text" placeholder="' + soy.$$escapeHtml('Search for a diagram') + '" value="' + soy.$$escapeHtml(opt_data.query) + '"></form>' + ((opt_data.message != null) ? '<div class="gliffy-warning-message"><div class="aui-message closeable shadowed warning"><p class="title"><span class="aui-icon icon-generic"></span><strong>' + soy.$$escapeHtml('Sorry, you cannot create new diagrams but you may insert existing ones.') + '</strong></p><p>' + soy.$$escapeHtml(opt_data.message) + '</p></div></div>' : '') + '<div class="gliffy-search-results ' + ((opt_data.insertOnly == true) ? 'gliffy-no-border' : '') + '"></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertPanel.soyTemplateName = 'gliffySoy.macro.dialog.insertPanel';
}


gliffySoy.macro.dialog.insertPanelCheckbox = function(opt_data, opt_ignored) {
  return '<form class="gliffy-toggle-insert">' + ((opt_data.blueprint != true) ? '<input class="gliffy-toggle-checkbox" type="checkbox" ' + ((opt_data.insertOnly == true) ? 'checked disabled' : '') + '/><span>' + soy.$$escapeHtml('Link to Original Diagram') + '</span><a class="gliffy-question-link" href="#" data-tooltip="' + soy.$$escapeHtml('Select this option to link and display the original diagram. Modifications to the original will be reflected in linked locations.') + '"><span class="gliffy-question-icon"></span></a>' : '') + '</form>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertPanelCheckbox.soyTemplateName = 'gliffySoy.macro.dialog.insertPanelCheckbox';
}


gliffySoy.macro.dialog.insertDropdown = function(opt_data, opt_ignored) {
  var output = ((opt_data.label.length > 0) ? '<span class="gliffy-dropdown-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' : '') + '<div class="gliffy-btn-group ' + soy.$$escapeHtml(opt_data.name) + '" data-value="' + soy.$$escapeHtml(opt_data.items[0].shortName) + '"><button class="gliffy-btn gliffy-dropdown">' + soy.$$escapeHtml(opt_data.items[0].longName) + '</button><button class="gliffy-btn gliffy-dropdown-toggle"><span class="gliffy-caret"></span></button><ul class="gliffy-dropdown-menu">';
  var itemList187 = opt_data.items;
  var itemListLen187 = itemList187.length;
  for (var itemIndex187 = 0; itemIndex187 < itemListLen187; itemIndex187++) {
    var itemData187 = itemList187[itemIndex187];
    output += '<li><a href="#" data-value="' + soy.$$escapeHtml(itemData187.shortName) + '">' + soy.$$escapeHtml(itemData187.longName) + '</a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.insertDropdown.soyTemplateName = 'gliffySoy.macro.dialog.insertDropdown';
}


gliffySoy.macro.dialog.importPanel = function(opt_data, opt_ignored) {
  return '<div id="gliffy-upload-attachment"><form id="gliffy-create-import-form" class="aui" method="post" enctype="multipart/form-data" action="' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0/diagrams/import"><fieldset class="inline"><div class="field gliffy-import-field-group"><input class="gliffy-import-text-input" type="text" placeholder="' + soy.$$escapeHtml('Upload a file from your computer') + '"/><a class="gliffy-import-browse">' + soy.$$escapeHtml('Browse') + '</a><div class="gliffy-file-input-wrapper"><input type="file" name="file" id="gliffy-import-file" class="gliffy-file-upload"/></div><input id="gliffy-security-token" type="hidden" name="atl_token" value=""></input><span id="gliffy-import-wait"></span><div class="gliffy-clear"></div><div id="gliffy-create-import-error" class="error gliffy-import-description"></div><div class="gliffy-create-import-type-description">' + soy.$$escapeHtml('The following file types are supported [click each for more info]:') + '</div><div id="gliffy-create-import-types" class="gliffy-create-import-types"><ul><li><a id="gliffy-file-type-gon" href="#">' + soy.$$escapeHtml('Gliffy Diagram') + ' (.gliffy, .gon)</a></li><li><a id="gliffy-file-type-gxml" href="#">' + soy.$$escapeHtml('Gliffy Diagram') + ' (.gxml)</a></li><li><a id="gliffy-file-type-vdx" href="#">' + soy.$$escapeHtml('Visio Diagram') + ' (.vsdx, .vdx)</a></li><li><a id="gliffy-file-type-drawio" href="#">' + soy.$$escapeHtml('Draw.io Diagram') + ' - ALPHA (.drawio, .xml)</a></li><li><a id="gliffy-file-type-lucidchart" href="#">' + soy.$$escapeHtml('Lucidchart Diagram - ALPHA') + '</a></li></ul></div></div></fieldset></form><div class="#gliffy-create-import-error"></div><div class="gliffy-import-help-container"></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importPanel.soyTemplateName = 'gliffySoy.macro.dialog.importPanel';
}


gliffySoy.macro.dialog.importGliffyHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-image"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/com.gliffy.integration.confluence/icons/gliffy_online_file_menu.png"/><p><sup>*</sup> ' + soy.$$escapeHtml('Gliffy Online File Menu') + '</p></div><div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Gliffy Diagrams (.gxml) that are exported from the Gliffy Editor.') + '</p><p>' + soy.$$escapeHtml('This allows you to import a diagram from any Gliffy product be it the Gliffy JIRA Plugin, Gliffy Online *, or even from another Confluence page.') + '</p><p>' + soy.$$escapeHtml('From the Gliffy Editor, navigate to the \x27file\x27 menu and choose \x27Export as Gliffy XML\x27.') + '</p><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Using Gliffy Diagrams Attached to a Confluence Page or JIRA Issue') + '</strong></p><p>' + soy.$$escapeHtml('Gliffy Diagrams downloaded as an attachment from a Confluence Page or JIRA Issue are not guaranteed to work, unless it was exported using the method described above.') + '</p><p>' + soy.$$escapeHtml('An easy way to tell if your diagram will import is to look for the \x3ccode\x3e.gxml\x3c/code\x3e extension in your filename.') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importGliffyHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importGliffyHelpPanel';
}


gliffySoy.macro.dialog.importGliffyGonHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-image"><img src="' + soy.$$escapeHtml(opt_data.contextPath) + '/download/resources/com.gliffy.integration.confluence/icons/gliffy_export_file_menu.png"/><p><sup>*</sup> ' + soy.$$escapeHtml('Gliffy HTML5 File Menu') + '</p></div><div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Gliffy Diagrams (.gon) that are exported from the Gliffy HTML5 Editor.') + '</p><p>' + soy.$$escapeHtml('From the Gliffy HTML5 Editor, navigate to the \x27File\x27 menu and choose \x27Export as Gliffy\x27.') + '</p><div class="aui-message info" style="width: 440px;"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml('Gliffy HTML5 files are fully portable!') + '</strong></p><p>' + soy.$$escapeHtml('You can download a Gliffy HTML5 diagram directly from the attachments page. Make sure your diagram is of this content type:') + '</p><p><code>' + soy.$$escapeHtml('application/gliffy+json') + '</code></p><p>' + soy.$$escapeHtml('Just attach the diagram to any Confluence page, and you can immediately use \x27Insert Diagram\x27 from the macro dialog to show it on your wiki page.  No importing is necessary!') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importGliffyGonHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importGliffyGonHelpPanel';
}


gliffySoy.macro.dialog.importVisioHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><span id="gliffy-visio-description-spinner"></span><p id="gliffy-visio-description">' + soy.$$escapeHtml('The import dialog supports the import of Visio diagrams (.vsdx, .vdx) that are saved from Microsoft Visio.') + '</p><h3 id="gliffy-import-visio-prep">' + soy.$$escapeHtml('Preparing the Visio File') + '</h3><ol><li>' + soy.$$escapeHtml('In Visio, open the file that you want to import into Gliffy.') + '</li><li>' + soy.$$escapeHtml('If this file has multiple worksheets, select the worksheet that you want to export.') + '</li><li>' + soy.$$escapeHtml('Select File \x3e Save As.') + '</li><li>' + soy.$$escapeHtml('Choose either \x22Visio Drawing (*.vsdx)\x22 or \x22XML Drawing (*.vdx)\x22.') + '</li><li>' + soy.$$escapeHtml('Save the file.') + '</li></ol><h3 id="gliffy-import-visio-reduce-size">' + soy.$$escapeHtml('Reducing the Visio File Size (Optional)') + '</h3><ol><li>' + soy.$$escapeHtml('Load the file into Visio.') + '</li><li>' + soy.$$escapeHtml('Select File \x3e Info.') + '</li><li>' + soy.$$escapeHtml('Click on the button \x22Reduce File Size\x22 and check the boxes.') + '</li><li>' + soy.$$escapeHtml('Save the file.') + '</li></ol><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>' + soy.$$escapeHtml('Missing Shapes') + '</strong></p><div class="gliffy-import-missing-shape"></div><p>' + soy.$$escapeHtml('If you see a shape like the image on the right then you have encountered a shape that the importer was not able to convert. The most common reason for this occurs when using 3rd party symbols or Visio clip art. Feel free to contact support if you experience these at') + ' <a href="mailto:support@gliffy.com">support@gliffy.com</a>.</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importVisioHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importVisioHelpPanel';
}


gliffySoy.macro.dialog.importDrawIoHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><p>' + soy.$$escapeHtml('The import dialog supports the import of Draw.io Diagrams (.drawio or .xml) that are exported from the Draw.io Editor.') + '</p><p>' + soy.$$escapeHtml('From the Draw.io Editor, navigate to the \x22File\x22 menu, choose \x22Save As...\x22 and select \x22Device\x22 to download the file.') + '</p><div class="aui-message warning" style="width: 420px;"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml('Draw.io import is in Alpha stage') + '</strong></p><p>' + soy.$$escapeHtml('Please note that certain imported images and shapes may populate as a blank placeholder. We appreciate your patience as we continue to grow and improve this feature.') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importDrawIoHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importDrawIoHelpPanel';
}


gliffySoy.macro.dialog.importLucidchartHelpPanel = function(opt_data, opt_ignored) {
  return '<div class="gliffy-help-text"><p>' + soy.$$escapeHtml('Navigate to the Confluence page where the diagram is and download it as an attachment to your computer.') + '</p><p>' + soy.$$escapeHtml('From the import screen, click the \x22Choose file\x22 button and select your downloaded Lucidchart attachment.') + '</p><div class="aui-message warning" style="width: 420px;"><p class="title">' + soy.$$escapeHtml('Lucidchart import is in Alpha stage') + '</p></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importLucidchartHelpPanel.soyTemplateName = 'gliffySoy.macro.dialog.importLucidchartHelpPanel';
}


gliffySoy.macro.dialog.spaceOptions = function(opt_data, opt_ignored) {
  var output = '';
  var spaceList300 = opt_data.spaces;
  var spaceListLen300 = spaceList300.length;
  for (var spaceIndex300 = 0; spaceIndex300 < spaceListLen300; spaceIndex300++) {
    var spaceData300 = spaceList300[spaceIndex300];
    output += '<option value="' + soy.$$escapeHtml(spaceData300.shortName) + '">' + soy.$$escapeHtml(spaceData300.longName) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.spaceOptions.soyTemplateName = 'gliffySoy.macro.dialog.spaceOptions';
}


gliffySoy.macro.dialog.searchResult = function(opt_data, opt_ignored) {
  var output = '<table><thead><tr class="gliffy-data-table-header"><th class="gliffy-title-field">' + soy.$$escapeHtml('Title') + '</th><th class="gliffy-space-field">' + soy.$$escapeHtml('Space') + '</th><th class="gliffy-last-modified-field">' + soy.$$escapeHtml('Last Modified') + '</th></tr></thead><tbody>';
  var diagramList315 = opt_data.diagrams;
  var diagramListLen315 = diagramList315.length;
  if (diagramListLen315 > 0) {
    for (var diagramIndex315 = 0; diagramIndex315 < diagramListLen315; diagramIndex315++) {
      var diagramData315 = diagramList315[diagramIndex315];
      output += '<tr data-attachment-id="' + soy.$$escapeHtml(diagramData315.attachmentId) + '" data-name="' + soy.$$escapeHtml(diagramData315.name) + '" data-page-id="' + soy.$$escapeHtml(diagramData315.pageId) + '" data-version="' + soy.$$escapeHtml(diagramData315.version) + '" ' + ((diagramIndex315 == 0) ? 'class="gliffy-selected"' : '') + '><td class="gliffy-title-field">' + soy.$$escapeHtml(diagramData315.displayName ? diagramData315.displayName : diagramData315.name) + '</td><td class="gliffy-space-field">' + soy.$$escapeHtml(diagramData315.spaceName) + '</td><td class="gliffy-last-modified-field">' + soy.$$escapeHtml(diagramData315.lastModifiedFriendly) + '</td></tr>';
    }
  } else {
    output += '<tr data-empty="true"><td>' + soy.$$escapeHtml('No results') + '</td></tr>';
  }
  output += '</tbody></table>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.searchResult.soyTemplateName = 'gliffySoy.macro.dialog.searchResult';
}


gliffySoy.macro.dialog.importResult = function(opt_data, opt_ignored) {
  var output = '<ul id="gliffy-import-list" class="gliffy-image-list">';
  var attachmentList343 = opt_data.attachments;
  var attachmentListLen343 = attachmentList343.length;
  if (attachmentListLen343 > 0) {
    for (var attachmentIndex343 = 0; attachmentIndex343 < attachmentListLen343; attachmentIndex343++) {
      var attachmentData343 = attachmentList343[attachmentIndex343];
      output += gliffySoy.macro.dialog.importResultItem({attachment: attachmentData343, contextPath: opt_data.contextPath});
    }
  } else {
    output += '<li id="gliffy-import-empty" data-empty="true"><span>' + soy.$$escapeHtml('No results') + '</span></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importResult.soyTemplateName = 'gliffySoy.macro.dialog.importResult';
}


gliffySoy.macro.dialog.importResultItem = function(opt_data, opt_ignored) {
  return '<li class="gliffy-attached-image" data-attachment-id="' + soy.$$escapeHtml(opt_data.attachment.attachmentId) + '" data-name="' + soy.$$escapeHtml(opt_data.attachment.name) + '" data-page-id="' + soy.$$escapeHtml(opt_data.attachment.pageId) + '" data-version="' + soy.$$escapeHtml(opt_data.attachment.version) + '"><div class="gliffy-image-container"><img width="100" height="100" title="' + soy.$$escapeHtml(opt_data.attachment.name) + '" src="' + soy.$$escapeHtml(opt_data.contextPath) + '/rest/gliffy/1.0' + soy.$$escapeHtml(opt_data.attachment.urls.thumbnail) + '" class="thumbnail"/></div><span class="caption filename">' + soy.$$escapeHtml(opt_data.attachment.name) + '</span><span class="caption owner-title">' + soy.$$escapeHtml(opt_data.attachment.lastModifiedFriendly) + '</span></li>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.importResultItem.soyTemplateName = 'gliffySoy.macro.dialog.importResultItem';
}


gliffySoy.macro.dialog.morePropertyPanel = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" class="aui top-label" name="gliffy-more-form"><fieldset><div class="field-group"><label for="gliffy-dialog-more-size-field">' + soy.$$escapeHtml('Size') + '</label><input id="gliffy-dialog-more-size-field" name="gliffy-dialog-more-size-field" class="text" type="text" value="' + soy.$$escapeHtml(opt_data.size) + '"/><div id="gliffy-dialog-more-size-error-field" class="error"></div><div class="description">' + soy.$$escapeHtml('Width in #px | T (150px) | S (1:3) | M (2:3) | L (1:1)') + '</div></div><div class="field-group"><label for="gliffy-dialog-more-chrome">' + soy.$$escapeHtml('Viewer Toolbar') + '</label><select name="gliffy-chrome" id="gliffy-dialog-more-chrome-field">';
  var chromeOptionList383 = opt_data.chromeOptions;
  var chromeOptionListLen383 = chromeOptionList383.length;
  for (var chromeOptionIndex383 = 0; chromeOptionIndex383 < chromeOptionListLen383; chromeOptionIndex383++) {
    var chromeOptionData383 = chromeOptionList383[chromeOptionIndex383];
    output += (chromeOptionData383.key == opt_data.selectedChromeOption) ? '<option value="' + soy.$$escapeHtml(chromeOptionData383.key) + '" selected="selected">' + soy.$$escapeHtml(chromeOptionData383.value) + '</option>' : '<option value="' + soy.$$escapeHtml(chromeOptionData383.key) + '">' + soy.$$escapeHtml(chromeOptionData383.value) + '</option>';
  }
  output += '</select><div class="description">' + soy.$$escapeHtml('\x22Full\x22 displays Edit/Zoom controls') + '</div></div>' + ((! opt_data.isHtml5ViewerDisabledByAdmin) ? '<div class="field-group"><input class="gliffy-dialog-interactive-viewer-checkbox" type="checkbox" ' + ((opt_data.html5Viewer == true) ? 'checked' : '') + '/><span>' + soy.$$escapeHtml('Interactive HTML5 Viewer') + '</span><div class="description">' + soy.$$escapeHtml('Display preview image when disabled') + '</div></div>' : '') + '</fieldset></form>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.morePropertyPanel.soyTemplateName = 'gliffySoy.macro.dialog.morePropertyPanel';
}


gliffySoy.macro.dialog.versionPropertyPanel = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" class="aui top-label" name="gliffy-version-form"><fieldset><div class="field-group"><div class="description">' + soy.$$escapeHtml('Select which diagram version to pin to the page.') + '</div><select name="gliffy-version" id="gliffy-dialog-version-field">';
  var versionList417 = opt_data.versions;
  var versionListLen417 = versionList417.length;
  for (var versionIndex417 = 0; versionIndex417 < versionListLen417; versionIndex417++) {
    var versionData417 = versionList417[versionIndex417];
    output += (versionData417.key == opt_data.selectedVersion) ? '<option value="' + soy.$$escapeHtml(versionData417.key) + '" selected="selected">' + soy.$$escapeHtml(versionData417.value) + '</option>' : '<option value="' + soy.$$escapeHtml(versionData417.key) + '">' + soy.$$escapeHtml(versionData417.value) + '</option>';
  }
  output += '</select><div id="gliffy-version-dialog-information" class="description"></div><a id="gliffy-diagram-preview"><img id="gliffy-diagram-thumbnail"></a></div></fieldset></form>';
  return output;
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.versionPropertyPanel.soyTemplateName = 'gliffySoy.macro.dialog.versionPropertyPanel';
}


gliffySoy.macro.dialog.noSaveDialog = function(opt_data, opt_ignored) {
  return '<div>' + soy.$$escapeHtml(opt_data.pageUnsavedMessage) + '</div>';
};
if (goog.DEBUG) {
  gliffySoy.macro.dialog.noSaveDialog.soyTemplateName = 'gliffySoy.macro.dialog.noSaveDialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-edit-linked-diagram.soy' */
// This file was automatically generated from gliffy-edit-linked-diagram.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.editLinkedDiagram.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.editLinkedDiagram == 'undefined') { gliffySoy.editLinkedDiagram = {}; }


gliffySoy.editLinkedDiagram.dialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="gliffy-dialog-edit-linked-diagram" class="aui-layer aui-dialog2 aui-dialog2-small" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('You are being redirected') + '</h2><a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">X</span></a></header><div class="aui-dialog2-content"><p>' + soy.$$escapeHtml('You are being redirected to the source diagram page.') + '</p><p>' + soy.$$escapeHtml('Editing the original diagram will update all linked diagrams.') + '</p></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><a id="gliffy-dialog-edit-linked-diagram-ok" class="aui-button aui-button-primary" href="#" target="_blank">' + soy.$$escapeHtml('Go to source diagram page') + '</a></div></footer></section>';
};
if (goog.DEBUG) {
  gliffySoy.editLinkedDiagram.dialog.soyTemplateName = 'gliffySoy.editLinkedDiagram.dialog';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-old-draft-message.soy' */
// This file was automatically generated from gliffy-old-draft-message.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.oldDrafts.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.oldDrafts == 'undefined') { gliffySoy.oldDrafts = {}; }


gliffySoy.oldDrafts.popup = function(opt_data, opt_ignored) {
  return '<div class="gliffy-draft-message-popup aui-flag" aria-hidden="false"><div class="aui-message aui-message-info info closeable shadowed"><p class="title"></p><span class="draft-message">' + soy.$$filterNoAutoescape(opt_data.message) + '</span><span class="gliffy-close-icon aui-icon icon-close" role="button"></span></div></div>';
};
if (goog.DEBUG) {
  gliffySoy.oldDrafts.popup.soyTemplateName = 'gliffySoy.oldDrafts.popup';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/Analytics.js' */
define("gliffy/interface/analytics", [
    "jquery",
    "gliffy/confluence/rest/webRequestPromiseFactory"
], function($, webRequestPromiseFactory) {

    var isEnabled = false;

    var getAnalyticsDisabled = webRequestPromiseFactory.buildGetPropertyValuePromise("com.gliffy.integration.confluence.ANALYTICS_OFF");
    $.when(getAnalyticsDisabled).then(function(result) {
        isEnabled = !result;
        if(isEnabled) {
            analytics.event('init', {accountType:'google', accountID:'UA-248648-13', optPageName:'Gliffy Confluence Init'});
            // to debug analytics, uncomment the following line
            analytics.event('logEvents', {logEvents: true, logger: console});
            analytics.event('setLabel', {label: 'none'});
            analytics.event('setCustomVariables', {
                product: 'Confluence',
                license: $('meta[name=gliffy-license-type]').attr("content"),
                numUsers: parseInt($('meta[name=gliffy-license-quantity]').attr("content"))
            });
        }
    });

    var analytics = {
        event: function (type, options) {
            if (isEnabled) {
                $(window).trigger(type + '.gliffyAnalytics', options);
            }
        }
    };

    return analytics;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/macro/controller/PropertyPanelController.js' */
// Register as apex module so this module can be instantiated after everybody is registered.
var apexModuleManager = require("gliffy/amd/apexModuleManager");
apexModuleManager.define("gliffy/confluence/macro/controller/PropertyPanelController", [
    "jquery",
    "GliffySpinner",
    "gliffy/confluence/rest/urlFactory",
    "gliffy/confluence/rest/webRequestPromiseFactory",
    "gliffy/confluence/editor/editorLauncher",
    "gliffy/confluence/pageFacade",
    "gliffy/interface/analytics"
], function($, GliffySpinner, urlFactory, webRequestPromiseFactory, editorLauncher, pageFacade, analytics, EmbedMacroController) {

    //======================================================================================================================
    // Property panel button handlers
    //======================================================================================================================

    var LATEST = 0;
    var isEditLinkedDialogCreated = false;

    function gliffyEdit (macroNode) {

        AJS.Rte.BookmarkManager.storeBookmark();
        var name = macroNode.params ? macroNode.params['name'] : null;
        var isNamed = name && name.length >0;

        if (macroNode["params"] && (isNamed || macroNode.params['macroId'])) {

            if (AJS.Meta.get('form-name') === 'createpagetemplate' || AJS.Meta.get('form-name') === 'editpagetemplate') {
                noEditingTemplateDiagramDialog();
            } else if (macroNode.params.blueprint) {
                AJS.trigger("gliffy.confluence.launchTemplate", [macroNode.params.blueprint, macroNode.params.name]);
            } else if (macroNode.params.attachmentId) {
                //GCONF-1573
                AJS.trigger("gliffy.confluence.launchTemplate", ["com.gliffy.transform.diagram", macroNode.params.attachmentId]);
            } else if (macroNode.params.page && macroNode.params.name && !macroNode.params.pageid) {
                //GCONF-1680 old style macro - this needs to be entered by hand to trigger this case!
                launchEditorForLegacyMacro(macroNode);
            } else if(macroNode.params.pageid){
                launchLinkedDiagramEditorFlow(macroNode.params.pageid);
            } else {
                //new macros should be using ceoid (page id). This is the main flow.
                launchEditor(macroNode);
            }
        }
        else {
            //show the gliffy choice dialog
            AJS.trigger("gliffy.confluence.showMacroDialog");
        }
    };

    function noEditingTemplateDiagramDialog(){
        var alertDialog = new AJS.Dialog({
            width: 450,
            height: 250,
            id: "gliffy-no-editing-template-message",
            closeOnOutsideClick: true
        });
        alertDialog.addHeader("Gliffy in Page Templates").
        addPanel("SinglePanel", '', "gliffy-no-editing-template-content");
        $('.gliffy-no-editing-template-content').html("Gliffy diagrams cannot be edited in page templates.  Please edit the diagram from the page where it is attached and changes will be reflected here.");

        alertDialog.addCancel("Close", function () {
            alertDialog.hide();
        });

        alertDialog.show();
    };

    function launchEditorForLegacyMacro(macroNode){
        if (macroNode.params.space == null) {
            // use the current space key
            macroNode.params.space = AJS.Meta.get('space-key');
        }

        var ceoFindUrl = AJS.format(
            "{0}/ceo/find/space/{1}/page/{2}/name/{3}",
            GLIFFY._confluence.gvars.gliffyApiEndpoint,
            encodeURIComponent(macroNode.params.space),
            encodeURIComponent(macroNode.params.page),
            encodeURIComponent(macroNode.params.name)
        );

        //lookup the ceo + attachment ids (this call also checks for permission at the same time to cut down on calls)
        $.ajax({
            type: "GET",
            url: ceoFindUrl,
            dataType: "json",
            cache: false,
            success: function (data) {

                // NOTE: this won't work with linked diagrams, but linked diagrams were not supported when
                // old-style macros were used.
                editorLauncher.launchEditorFromEditPage({
                    editor: GLIFFY._confluence.editor,
                    diagramName: macroNode.params.name,
                    ownerPageId: data.id,
                    referencePageId: data.id,
                    attachmentId: data.attachmentId,
                    attachmentVersion: data.attachmentVersion,
                    pagePin: LATEST,
                    macroId: macroNode.params.macroId,
                    template: {
                        category: "com.gliffy.diagram"
                    }
                });
            },
            error: function (xhr, textstatus, errorThrown) {
                alert(GLIFFY._confluence.utils.parseError(xhr));
            }
        });
    };

    function launchLinkedDiagramEditorFlow(pageId){
        if(!isEditLinkedDialogCreated){
            createEditLinkedDialog(pageId);
        }
        showEditLinkedDialog();
    };

    function launchEditor(macroNode){
        // Use the current pageId if a pageId when it is not specified
        macroNode.params.pageid = Confluence.Editor.getContentId();

        var getEditPermission;
        if (macroNode.params['name']) {
            getEditPermission = webRequestPromiseFactory.buildGetEditDiagramPermissionPromise(macroNode.params.pageid, macroNode.params.name);
        } else{
            getEditPermission = webRequestPromiseFactory.buildGetCreateAttachmentPermissionPromise(macroNode.params.pageid);
        }
        var getWootricState = $.ajax({url:AJS.Confluence.getContextPath() + '/rest/gliffy/1.0/qa/instrumentation/wootric'});
        $.when(getEditPermission, getWootricState).done(function (permissionResponse, wootric) {
            // Edit link
            var attachmentId = permissionResponse[0] ? permissionResponse[0].attachmentId : 0;
            var attachmentVersion = parseInt(macroNode.params.version) || LATEST;
            editorLauncher.launchEditorFromEditPage({
                editor: GLIFFY._confluence.editor,
                diagramName: macroNode.params.name,
                displayName: macroNode.params.displayName,
                ownerPageId: macroNode.params.pageid,
                referencePageId: Confluence.Editor.getContentId(),
                attachmentVersion: attachmentVersion,
                pagePin: macroNode.params.pagePin,
                macroId: macroNode.params.macroId,
                attachmentId: attachmentId,
                template: {
                    category: "com.gliffy.diagram"
                },
                wootric: (wootric[0] === 'true') ? 'true' : undefined
            });
        }).fail(function (xhr) {
            alert(GLIFFY._confluence.utils.parseError(xhr));
        });
    };

    function linkToSourceDiagramPage(pageId){
        var gotoLinkedPageButton = document.getElementById('gliffy-dialog-edit-linked-diagram-ok');

        gotoLinkedPageButton.href = AJS.Confluence.getContextPath()+'/pages/editpage.action?pageId='+ pageId;

        gotoLinkedPageButton.addEventListener('click', function() {
            AJS.dialog2('#gliffy-dialog-edit-linked-diagram').hide();
        });
    };

    function appendSoyTemplate(jsSelector, soyTemplate, opt_data, opt_ignored) {
        var node = document.createElement('template');
        node.innerHTML = soyTemplate(opt_data, opt_ignored);
        jsSelector.appendChild(node.firstChild || node.content.firstChild);
    };

    function createEditLinkedDialog(pageId) {
        appendSoyTemplate(document.body, gliffySoy.editLinkedDiagram.dialog);

        linkToSourceDiagramPage(pageId);

        isEditLinkedDialogCreated = true;
    };

    function showEditLinkedDialog(){
        AJS.dialog2('#gliffy-dialog-edit-linked-diagram').show();
    };

    function gliffyImageSize (macroNode, imageSize) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);
        diagramReference.size = imageSize;
        pageFacade.addDiagramReference(diagramReference, macroDiv[0]);
    };

    function gliffyBorderToggle (macroNode) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);
        diagramReference.border = !diagramReference.border;
        pageFacade.addDiagramReference(diagramReference, macroDiv[0]);
    };

    function gliffySubmitMoreDialog (dialog) {

        var LEGACY_MACRO_SIZE_OPTIONS = ["T", "S", "M", "L", "O"];

        var sanitizeSize = function (sizeFieldValue) {

            var size = $.trim(sizeFieldValue);
            if (size.length === 0) {
                return "";
            }

            if ($.inArray(size, LEGACY_MACRO_SIZE_OPTIONS) >= 0) {
                return size;
            }

            var sizeInt = parseInt(size);
            if (isNaN(sizeInt)) {
                return false;
            }
            var isValidNumericalSizeValue = sizeInt >= 150 && sizeInt <= 3000;
            if (isValidNumericalSizeValue) {
                return sizeInt;
            }

            return false;
        };

        var diagramReference = $(".gliffy-more-panel").data("diagramReference");
        var macroNode = $(".gliffy-more-panel").data("macroNode");
        var sizeField = $("#gliffy-dialog-more-size-field");

        var sanitizedSize = sanitizeSize(sizeField.val());
        if (sanitizedSize === false) {
            $("#gliffy-dialog-more-size-error-field").text("Invalid input (150 min, 3000 max)");
            return false;
        } else {
            ("" === sanitizedSize) ? delete diagramReference.size : diagramReference.size = sanitizedSize;
        }

        diagramReference.chrome = $("#gliffy-dialog-more-chrome-field").val();
        diagramReference.html5 = $(".gliffy-dialog-interactive-viewer-checkbox").is(':checked');

        pageFacade.addDiagramReference(diagramReference, macroNode);
        dialog.remove();
    };

    function setupMoreDialogOptions (diagramReference, isHtml5ViewerDisabledByAdmin) {
        return {
            size: (diagramReference.size == null) ? "" : diagramReference.size,
            chromeOptions: [
                {key: "full", value: "Full"},
                {key: "min", value: "None"}
            ],
            selectedChromeOption: (diagramReference.chrome == null) ? "full" : diagramReference.chrome,
            html5Viewer: (diagramReference.html5 === undefined || diagramReference.html5 === null) ? true : diagramReference.html5 == "true",
            isHtml5ViewerDisabledByAdmin: isHtml5ViewerDisabledByAdmin
        };
    };

    function showMoreDialog (diagramReference, macroNode, moreDialogData) {

        var moreDialog = new AJS.Dialog(340, 380, "gliffy-dialog-more");
        moreDialog.addHeader("Additional Options", "");

        moreDialog.addPanel("More Panel", gliffySoy.macro.dialog.morePropertyPanel(moreDialogData), "gliffy-more-panel", 0);
        $(".gliffy-more-panel").data("diagramReference", diagramReference).data("macroNode", macroNode);

        moreDialog.addButton("Update", gliffySubmitMoreDialog, "gliffy-more-update");

        moreDialog.addCancel("Cancel", function (dialog) {
            AJS.Rte.BookmarkManager.restoreBookmark();
            dialog.remove();
        });

        moreDialog.show();
    };

    function gliffyMoreButton (macroNode) {

        var macroDiv = AJS.$(macroNode);
        AJS.Rte.getEditor().selection.select(macroDiv[0]);
        AJS.Rte.BookmarkManager.storeBookmark();

        var diagramReference = pageFacade.getDiagramReference(macroDiv);

        var getProperty = webRequestPromiseFactory.buildGetPropertyValuePromise("com.gliffy.integration.confluence.HTML5_OFF");
        $.when(getProperty).then(function(result) {
            var moreDialogData = setupMoreDialogOptions(diagramReference, !!result);
            showMoreDialog(diagramReference, macroNode, moreDialogData);
        });
    };

    function updateVersionInformation (versionData, diagramName, pageId) {

        $("#gliffy-version-dialog-information").text("");

        var selectedVal = +$('#gliffy-dialog-version-field').val();
        var versionInfo = versionData.allVersionInformation[selectedVal - 1];

        if (selectedVal === LATEST) {
            versionInfo = versionData.allVersionInformation[versionData.allVersionInformation.length - 1];
        }

        if (versionInfo) {
            $("#gliffy-version-dialog-information").text(versionInfo);
        }

        $("#gliffy-diagram-preview").attr('href', urlFactory.buildDiagramPreviewImageUrl(pageId, diagramName, selectedVal));
        $("#gliffy-diagram-thumbnail").attr('src', urlFactory.buildDiagramThumbnailImageUrl(pageId, diagramName, selectedVal));

        var v = (selectedVal === 0) ? versionData.allVersionInformation.length : selectedVal;

        //GCONF-2013 fancybox is depricated.  check for previewer, but fallback to fancybox if not available
        var previewImage = $("#gliffy-diagram-thumbnail");
        if (previewImage.previewer) {
            $(previewImage).previewer({
                src: $("#gliffy-diagram-preview").attr('href'),
                type: "image/png",
                title: "v" + v,
                zindex: 10000
            }).closest('a').attr('href', '#').click(function (ev) {
                ev.preventDefault(); //supresses message warning that user is navigating from the page
            }); //we're keeping the <a> link to for legacy instances that use fancy box
        } else {
            $("#gliffy-diagram-preview").fancybox({
                type: 'image',
                showCloseButton: true,
                hideOnOverlayClick: true,
                hideOnContentClick: true,
                title: 'v' + v
            });
        }
    };

    function gliffyVersionButton (macroNode) {
        analytics.event('trackEvent', {category:'viewer', action:'showVersionPinningDialog'});

        var clickOutsideDialogHandler = function(event) {
            if (!$(event.target).closest('#gliffy-version-dialog').length) {
                $(document).off('click', clickOutsideDialogHandler);
                dialog.remove();
            }
        };

        $(document).on('click', clickOutsideDialogHandler);

        var $macroNode = AJS.$(macroNode);
        var diagramReference = pageFacade.getDiagramReference($macroNode);
        var pageid = diagramReference.ownerPageId;

        var dialog = new AJS.Dialog({
            width: 340,
            height: 430,
            id: 'gliffy-version-dialog',
            closeOnOutsideClick: false // GCONF-2194: don't set this to true. it can break dialog functionality
        });
        dialog.addHeader("Version");
        dialog.addPanel('Panel 1','<div/>', 'gliffy-version-body');
        dialog.addLink("Cancel", function (dialog) {
            $(document).off('click', clickOutsideDialogHandler);
            dialog.remove();
        }, '#');
        dialog.show();

        var versionDialog = AJS.$('#gliffy-version-dialog');
        var spinner = new GliffySpinner(versionDialog.get(0), {
            radius: 50,
            color: '#666'
        });
        spinner.start();

        var getVersions = webRequestPromiseFactory.buildGetDiagramVersionsPromise(pageid, diagramReference.name);
        var processVersionsResponse = function (response) {
            spinner.stop();
            var versions = [
                {key: '0', value: "Latest"}
            ];
            var index = 0;
            for (var i = response.numRevisions; i > 0; i--) {
                versions.push({
                    key: '' + response.revisions[index].version,
                    value: 'v' + response.revisions[index].version
                });
                index++;
            }

            var data = {
                versions: versions,
                selectedVersion: diagramReference.version || 0,
                allVersionInformation: response.revisions.map(function (value) {
                    return value.lastModifiedFriendly + " by " + value.creator;
                }).reverse()

            };

            $('.gliffy-version-body').html(gliffySoy.macro.dialog.versionPropertyPanel(data));
            dialog.addButton("Update", function (dialog) {
                $(document).off('click', clickOutsideDialogHandler);

                analytics.event('trackEvent', {category: 'viewer', action: 'pinToNewVersion'});

                var selectedVal = $('#gliffy-dialog-version-field').val();
                diagramReference.version = parseInt(selectedVal);
                pageFacade.addDiagramReference(diagramReference, macroNode);
                dialog.remove();
            });

            dialog.gotoPanel(0);

            updateVersionInformation(data, diagramReference.name, pageid);

            // add a handler for version selector, to display version information when changed
            $("#gliffy-dialog-version-field").change(function () {
                updateVersionInformation(data, diagramReference.name, pageid);
            });
        };

        function getVersionsFailed (xhr) {
            spinner.stop();
            $('#gliffy-version-dialog').remove();
            if (xhr.status === 404) {

                var dialog = new AJS.Dialog({
                    width: 340,
                    height: 190,
                    id: 'gliffy-version-dialog',
                    closeOnOutsideClick: true
                });

                var data = {
                    pageUnsavedMessage: "Sorry, version information is not available until the Confluence page has been saved."
                };

                dialog.addPanel('Diagram Version Selection', gliffySoy.macro.dialog.noSaveDialog(data), 'gliffy-version-body'); // ?
                dialog.addButton("Close", function (dialog) {
                    dialog.remove();
                });

                dialog.gotoPanel(0);
                dialog.show();
            }
        };

        $.when(getVersions).done(processVersionsResponse).fail(getVersionsFailed);
    };

    // Disable submit of form
    $("form[name='gliffy-more-form']").live("submit", function () {
        return false;
    });

    //======================================================================================================================
    // Override property panel style on create
    //======================================================================================================================
    //this is the atlassian custom event that is fired when a property panel is created.
    AJS.bind("created.property-panel", function (event, panel) {
        var macro = $(panel.anchor);
        if (macro.data("macro-name") === "gliffy") {
            //check if any buttons should be selected
            var diagramReference = pageFacade.getDiagramReference(macro);
            if (diagramReference.border) {
                panel.panel.find(".macro-property-panel-gliffy-button-image-border").addClass("selected");
            }
            //size
            if (diagramReference.size) {
                switch (diagramReference.size) {
                    case '300':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-small").addClass("selected");
                        break;
                    case '600':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-medium").addClass("selected");
                        break;
                    case '1200':
                        panel.panel.find(".macro-property-panel-gliffy-button-image-large").addClass("selected");
                        break;
                    default:
                        break;
                }
            }
            else {
                panel.panel.find(".macro-property-panel-gliffy-button-image-original").addClass("selected");
            }
        }
    });

    //======================================================================================================================
    // Override property panel macro when rte is ready
    //======================================================================================================================
    //override property panel

    // GCONF-809
    AJS.MacroBrowser.setMacroJsOverride('gliffy', {
        opener: gliffyEdit
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-small", function (e, macroNode) {
        gliffyImageSize(macroNode, "300");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-medium", function (e, macroNode) {
        gliffyImageSize(macroNode, "600");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-large", function (e, macroNode) {
        gliffyImageSize(macroNode, "1200");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-original", function (e, macroNode) {
        gliffyImageSize(macroNode, "O");
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-border", function (e, macroNode) {
        gliffyBorderToggle(macroNode);
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-more", function (e, macroNode) {
        gliffyMoreButton(macroNode);
    });

    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-version", function (e, macroNode) {
        gliffyVersionButton(macroNode);
    });
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'gliffy/confluence/ContextFinalizer.js' */
/**
 * Exists to require, and therefore execute, application-level bits like DOM controllers.
 * This must be included as the final resource of the web-resource definition
 */
;(function($, apexModuleManager) {
    // Wait for DOM to be loaded before instantiating apex modules.
    $(function () {
        apexModuleManager.instantiateAll();
        apexModuleManager.reset();
    });
})(require('jquery'), require('gliffy/amd/apexModuleManager'));


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-core', location = 'js/autoconvert/tinymce-autoconvert.js' */
define("confluence-paste/autoconvert/tinymce-autoconvert","tinymce ajs jquery document confluence/api/constants confluence/meta".split(" "),function(l,j,e,n,o,i){function m(a){for(var d=m.options,a=d.parser[d.strictMode?"strict":"loose"].exec(a),c={},b=14;b--;)c[d.key[b]]=a[b]||"";c[d.q.name]={};c[d.key[12]].replace(d.q.parser,function(a,b,e){b&&(c[d.q.name][b]=e)});return c}var f=function(a){a.onUndo.add(this.cleanLinks);this.editor=a;this.weightedHandlers=[];this.handlers=[]};f.prototype={addHandler:function(a,
d){this.weightedHandlers.push({handler:a,weight:d||0});this.weightedHandlers.sort(function(a,b){return a.weight-b.weight});this.handlers=[];for(var c=this.weightedHandlers.length,b=0;b<c;b++)this.handlers.push(this.weightedHandlers[b].handler)},cleanLinks:function(a){e("a.atlassian-autoconvert",a.getDoc()).removeClass("atlassian-autoconvert");return true},callHandlers:function(a){function d(a){if(a&&(a.length!==1||!a.attr("href")))return b(a);if(a){k=a;g=0;i=m(k.attr("href"));c(h.handlers[g],i,k)}else{g++;
if(g<h.handlers.length)c(h.handlers[g],i,k);else return b(k)}}function c(a,b,c){var e=d,f;f=setTimeout(function(){j.log("Autoconvert: Callback #"+g+" failed to call continuation in time. If there is no subsequent log, the handler is improperly implemented and should be uninstalled.");e=function(){j.log("Autoconvert: Callback #"+g+" did eventualy return. Probably a slow async call.")};d()},l.plugins.Autoconvert.callbackTimeout);a(b,c,function(){var a=g;clearTimeout(f);e.apply(h,arguments);e=function(){j.log("Autoconvert: Callback #"+
a+" called the continuation multiple times.")}})}function b(a){h.editor.undoManager.beforeChange();var b=h.editor.selection,c=h.editor.selection.getBookmark();f.replaceWith(a);b.moveToBookmark(c);h.editor.undoManager.add()}var g=0,h=this,f=e(a),k=e(a).clone(),a=k.attr("href"),i=m(a.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40"));this.handlers.length!==0&&c(this.handlers[0],i,k)}};f.callbackTimeout=5E3;f.convertMacroToDom=function(a,d,c){a={macro:a,contentId:i.get("content-id")};e.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:o.CONTEXT_PATH+"/rest/tinymce/1/macro/placeholder",data:e.toJSON(a),dataType:"text",success:d,error:c,timeout:45E3})};f.convertMacroToDomViaWikiText=function(a,d,c){var b=["{",a.name],g=true;if(a.defaultParameterValue){b.push(":",a.defaultParameterValue);g=false}for(var h in a.params){if(g){b.push(":");g=false}else b.push("|");b.push(h,"=",a.params[h])}b.push("}");f.getHtmlFromWikiMarkup(b.join(""),function(a){d(e(a)[0])},function(){c()})};f.getHtmlFromWikiMarkup=function(a,d,c){a={wiki:a,entityId:i.get("content-id"),
spaceKey:i.get("space-key"),contextType:i.get("content-type")};e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:o.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:e.toJSON(a),dataType:"text",success:d,error:c,timeout:45E3})};m.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}};return{autoConverter:f,plugin:{init:function(a){function d(b,d,f){b=e(f.node).children("a");if(b.length===1&&b[0].tagName==="A"&&b.text()===b.attr("href")){b.attr("class","atlassian-autoconvert");setTimeout(function(){var b=e("a.atlassian-autoconvert",e(a.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");
c.callHandlers(b)},0)}}var c=new f(a);l.plugins.Autoconvert.autoConvert=c;a.onInit.add(function(){e(n).bind("postPaste",d);a.addCommand("addAutoconverter",function(a,d){c.addHandler(d)})});a.onRemove.add(function(){e(n).unbind("postPaste",d)})},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}});
require("confluence/module-exporter").safeRequire("confluence-paste/autoconvert/tinymce-autoconvert",function(l){var j=require("tinymce");j.plugins.Autoconvert=l.autoConverter;j.create("tinymce.plugins.AutoconvertPlugin",l.plugin);j.PluginManager.add("autoconvert",j.plugins.AutoconvertPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'ch.mibex.confluence.include:autoconvert-bitbucket-links', location = 'js/bitbucket-link-paste-support.js' */
define('mibexsoftware/paste-bitbucket-link', [
    'ajs',
    'tinymce'
], function(
    AJS,
    tinymce
) {
    'use strict';

    var BitbucketPasteLink = {
        pasteHandler: function(uri, node, done) {
            var urlDecoded = decodeURIComponent(uri.source);
            var fileDetails = parseBitbucketDataCenterFileUrl(urlDecoded);
            if(!fileDetails) {
                fileDetails = parseBitbucketCloudFileUrl(urlDecoded)
            }
            if (!fileDetails) {
                done();
                return; // no match
            }
            var appLinkId = BitbucketPasteLink.lookUpApplicationLinkId(urlDecoded);
            var macro = {
                name: 'stashincludebyfilepath',
                params: {
                    applicationLink: appLinkId,
                    projectKey: fileDetails.projectKey,
                    repoSlug: fileDetails.repoSlug,
                    branchId: fileDetails.branchId ? fileDetails.branchId :
                        BitbucketPasteLink.lookUpDefaultBranch(appLinkId, fileDetails.projectKey, fileDetails.repoSlug),
                    filepath: fileDetails.filepath,
                    lineStart: fileDetails.lineStart,
                    lineEnd: fileDetails.lineEnd
                }
            };
            tinymce.plugins.Autoconvert.convertMacroToDom(macro, done, done);
        },

        lookUpDefaultBranch: function(appLink, projectKey, repoSlug) {
            var branchesUrl = "getbranches.action?appLink=" + appLink + "&projectKey=" + projectKey +
                "&repoSlug=" + repoSlug + "&pageId=" + AJS.params.pageId;
            var defaultBranch = null;
            AJS.$.ajax({
                async: false,
                url: AJS.params.contextPath + '/plugins/includeforconfluence/' + branchesUrl,
                dataType: 'json',
                timeout: 10000,
                error: function(xhr, textStatus, errorThrown) {
                    console.error(errorThrown);
                    return null;
                },
                success: function(response) {
                    if (response.status === 'OK') {
                        for (var i = 0; i < response.body.length; i++) {
                            if (response.body[i].defaultBranch) {
                                defaultBranch = response.body[i].id;
                            }
                        }
                    }
                }
            });
            return defaultBranch;
        },

        lookUpApplicationLinkId: function(url) {
            var applicationLinkId = null;
            AJS.$.ajax({
                async: false,
                url: AJS.params.contextPath + '/plugins/includeforconfluence/getapplinkbyurl.action?url=' + encodeURIComponent(url),
                dataType: 'json',
                timeout: 10000,
                error: function(xhr, textStatus, errorThrown) {
                    console.error(errorThrown);
                    return null;
                },
                success: function(response) {
                    if (response.status === 'OK') {
                        applicationLinkId = response.body;
                    }
                }
            });
            return applicationLinkId;
        }
    };

    return BitbucketPasteLink;
});

require('confluence/module-exporter').safeRequire('mibexsoftware/paste-bitbucket-link', function(BitbucketPasteLink) {
    var tinymce = require('tinymce');
    var AJS = require('ajs');

    AJS.bind('init.rte', function() {
        tinymce.plugins.Autoconvert.autoConvert.addHandler(BitbucketPasteLink.pasteHandler);
    });
});

function parseBitbucketDataCenterFileUrl(url) {
    // BITBUCKET_HOST/projects/PROJECT_KEY/repos/REPO_SLUG/browse/FILEPATH?at=BRANCH#LINE_START-LINE_END
    var bitbucketUrlEx = /.*?\/projects\/([^/]+)\/repos\/([^/]+)\/(?:browse|raw)\/(.*?)(\?at=.*?)?#?(\d+)?-?(\d+)?$/;
    var parts = bitbucketUrlEx.exec(url);
    if (!parts) {
        return null;
    }
    return {
        projectKey: parts[1],
        repoSlug: parts[2],
        branchId: parts[4] ? parts[4].substring("?at=".length) : null,
        filepath: parts[3],
        lineStart: parts[5],
        lineEnd: parts[6] ? parts[6] : parts[5]
    };
}
function parseBitbucketCloudFileUrl(urlDecoded) {
    // BITBUCKET_HOST/projects/PROJECT_KEY/repos/REPO_SLUG/browse/FILEPATH?at=BRANCH#LINE_START-LINE_END
    var  bitbucketCloudUrlEx = /^https:\/\/bitbucket\.org\/([^/]+)\/([^/]+)\/src\/([^/]+)\/(.+)$/;
    var partsCloud = bitbucketCloudUrlEx.exec(urlDecoded);
    if (!partsCloud) {
        return null;
    }
    return {
        repoSlug: partsCloud[2],
        branchId: partsCloud[3],
        projectKey: partsCloud[1],
        filepath: partsCloud[4]
    };
}

// outside the browser, export functions for testing
const isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';
if(!isBrowser){
    module.exports.parseBitbucketDataCenterFileUrl = parseBitbucketDataCenterFileUrl;
    module.exports.parseBitbucketCloudFileUrl = parseBitbucketCloudFileUrl
}
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.onresolve.confluence.groovy.groovyrunner:split_includeLockContentMacro', location = 'js/includeLockContentMacro.8b39cc2d29f3c0bccb22.js' */
(self.webpackJsonpScriptRunner=self.webpackJsonpScriptRunner||[]).push([["includeLockContentMacro"],{23126:(r,e,t)=>{"use strict";t(55778),AJS.toInit((function(r){var e="#macro-param-restrictedGroup",t=function(r){return'<span class="adaptavist-sr">'+r.text+"</span>"};AJS.MacroBrowser.setMacroJsOverride("lock-content-macro",{fields:{string:{restrictedGroup:function(){var e=r(Confluence.Templates.MacroBrowser.macroParameter()),t=r('<input class="adaptavist-sr"/>').appendTo(e);return AJS.MacroBrowser.Field(e,t,{})}}},beforeParamsSet:function(a){return r("#macro-param-div-restrictedGroup > input").hide(),r(e).auiSelect2({allowClear:!0,multiple:!0,minimumInputLength:2,formatResult:t,tags:!0,tokenSeparators:[","],ajax:{url:AJS.contextPath()+"/rest/scriptrunner-confluence/latest/lock-content-macro/groups",dataType:"json",type:"GET",quietMillis:250,data:function(r){return{searchTerm:r}},results:function(t){var a=r(e).val().split(",");return a&&a.every((function(r,e,a){var n=t.groups.indexOf(r);return n>=0&&t.groups.splice(n,1),!0})),{results:r.map(t.groups,(function(r){return{id:r,text:r}}))}}},initSelection:function(e,t){var a=[];r(e.val().split(",")).each((function(r,e){a.push({id:e,text:e})})),t(a)}}),r("#s2id_macro-param-restrictedGroup").show(),function(t){if(t.restrictedGroup){var a=JSON.parse(t.restrictedGroup);a&&(t.restrictedGroup=a.join()),r(e).val(t.restrictedGroup).trigger("change")}}(a),a},beforeParamsRetrieved:function(e){return e.restrictedGroup&&(e.restrictedGroup=JSON.stringify(e.restrictedGroup.split(","))),r("#s2id_macro-param-restrictedGroup > ul > li.select2-search-choice > a").each((function(e,t){r(t).data("events").click.splice(1,1)})),e}})}))},55778:(r,e,t)=>{r.exports=t}},r=>{var e;e=23126,r(r.s=e)}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.onresolve.confluence.groovy.groovyrunner:split_createPage', location = 'js/createPage.21cc8f84a7bacb6a2c68.js' */
"use strict";(self.webpackJsonpScriptRunner=self.webpackJsonpScriptRunner||[]).push([["createPage"],{98725:()=>{function e(e,t){var a=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("[?&]"+a+"=([^&#]*)").exec(t);return null===n?null:n[1]}function t(e,t){var a=e.attr("data-title-dialog");if(""===a){var n=t.find(".create-page-dialog");return AJS.dialog2(n).show(),""}return e.attr("data-prefix")&&(a=e.attr("data-prefix")+a),e.attr("data-postfix")&&(a+=e.attr("data-postfix")),a}jQuery((function(a){a(".create-page-main-div").each((function(n,r){var i=a(r),o=i.find("a.adaptavist-create-page-link"),c=o.attr("href"),s=o.attr("openInNewTab"),l=e("parentId",c),p=e("spaceKey",c),f=function(e){var n=t(o,i),r=AJS.escapeHtml(n);if(!1===e.success)AJS.messages.warning(a("#action-messages"),{title:e.errorMessage,body:"<p>Title: "+r+"</p><p>Space: "+AJS.escapeHtml(p)+"</p>"}),o.attr("href",c);else{var l=c.concat("&title="+encodeURIComponent(n));"true"===s?(AJS.$("#text-input").val(""),window.open(l,"_blank")):window.location.href=l,o.attr("href",c)}},d=function(e){e.preventDefault(),o.removeAttr("href");var n=t(o,i);""!==n&&a.ajax({type:"POST",url:AJS.contextPath()+"/rest/create-page/1.0/pageResources/pagesExist",data:JSON.stringify({space:p,title:n,parentId:l}),error:function(e,t,n){console.error(e.statusText),console.error(t),console.error(n),AJS.messages.error(a("#action-messages"),{title:"JS ERROR",body:n})},dataType:"json",contentType:"application/json; charset=utf-8",success:f,async:!1})},u=i.find(".create-page-dialog");i.find(".dialog-close-button").off("click").on("click",(function(e){AJS.dialog2(u).hide()})),i.find(".dialog-submit-button").off("click").on("click",(function(e){var t=u.find("input").val();o.attr("data-title-dialog",t),""===t?u.find(".submitHiddenButton").click():(AJS.dialog2(u).hide(),d(e))})),o.off("click").on("click",d)}))}))}},e=>{var t;t=98725,e(e.s=t)}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.onresolve.confluence.groovy.groovyrunner:split_pageInfo', location = 'js/pageInfo.309040334d824f7c2399.js' */
"use strict";(self.webpackJsonpScriptRunner=self.webpackJsonpScriptRunner||[]).push([["pageInfo"],{47753:()=>{AJS.toInit((function(){AJS.MacroBrowser.setMacroJsOverride("page-info",{beforeParamsSet:function(e){var a=e[""];if(a)switch(a){case"created-user":e.infoType="Created by";break;case"created-date":e.infoType="Create date";break;case"modified-user":e.infoType="Modified by";break;case"modified-users":e.infoType="Modified users";break;case"modified-date":e.infoType="Modified date";break;case"participants":e.infoType="Participants";break;case"commenters":e.infoType="Commenters";break;case"current-version":e.infoType="Current version";break;case"versions":e.infoType="Versions";break;case"diffs":e.infoType="Diffs";break;case"labels":e.infoType="Labels";break;case"tinyurl":e.infoType="Tiny url";break;case"title":e.infoType="Title";break;case"pageId":e.infoType="Page id"}return e}})}))}},e=>{var a;a=47753,e(e.s=a)}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = 'templates/mentions.soy' */
// This file was automatically generated from mentions.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Mentions.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Mentions == 'undefined') { Confluence.Templates.Mentions = {}; }


Confluence.Templates.Mentions.userNotFoundResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error no-result">' + soy.$$escapeHtml('Sorry, we can\x27t find that person') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.userNotFoundResult.soyTemplateName = 'Confluence.Templates.Mentions.userNotFoundResult';
}


Confluence.Templates.Mentions.searchFailureResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error search-failure"><div class="search-failure-title">' + soy.$$escapeHtml('Something went wrong') + '</div><div class="search-failure-body">' + soy.$$escapeHtml('We can\x27t fetch people right now. Try again in a few minutes.') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.searchFailureResult.soyTemplateName = 'Confluence.Templates.Mentions.searchFailureResult';
}


Confluence.Templates.Mentions.loadingPlaceholder = function(opt_data, opt_ignored) {
  return '<div class="mention-loading"><div class="avatar-placeholder"></div><div class="text-container"><div class="text-placeholder lg"></div><div class="text-placeholder sm"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.loadingPlaceholder.soyTemplateName = 'Confluence.Templates.Mentions.loadingPlaceholder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js-target/bundle.js' */
define("confluence-mentions", ["ajs","confluence/meta","jquery","confluence/legacy","confluence/templates","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","tinymce","confluence/storage-manager","confluence/dark-features","confluence/analytics-support","confluence-link-browser/link-object","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings"], function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_16__, __WEBPACK_EXTERNAL_MODULE_18__, __WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_37__, __WEBPACK_EXTERNAL_MODULE_45__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_52__, __WEBPACK_EXTERNAL_MODULE_53__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 20);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    exports.default = {
        CURRENT: 'current',
        RELATED: 'related',
        RECENT: 'recent',
        SERVER: 'server'
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(29), __webpack_require__(37), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _lruCache, _storageManager, _userSupplierKeys) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var LRU = _interopRequireDefault(_lruCache).default;

    var StorageManager = _interopRequireDefault(_storageManager).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Returns users from a localstorage-backed LRU (least-recently-used) cache, and adds entries to that cache.
     */
    var inMemoryCache = void 0;
    var persistentCache = void 0;

    var CACHE_PREFIX = 'mentions';
    var CACHE_ID = 'recently-mentioned-users';
    var CACHE_ITEMS_KEY = 'items';

    /**
     * The maximum number of recently-mentioned users to keep in the cache.
     * @type {number}
     */
    var RECENT_USER_LIMIT = 20;
    /**
     * WaterTightValidation means that any users at or past this expiry _must_ be refreshed before being displayed in the UI.
     * @type {{expireTimeMillis: number}}
     */
    var WATERTIGHT_VALIDATION = { expireTimeMillis: 29 * 24 * 60 * 60 * 1000 }; //29 days in millis
    /**
     * EarlyValidation means that any users at or past this expiry _should_ be refreshed after the UI is completed (so as to not block users)
     * @type {{expireTimeMillis: number}}
     */
    var EARLY_VALIDATION = { expireTimeMillis: 7 * 24 * 60 * 60 * 1000 }; //7 days in millis
    /**
     * stores the enums used for calls to {getStaleUsers()}.
     * @type {{WATERTIGHT_VALIDATION: {expireTimeMillis: number}, EARLY_VALIDATION: {expireTimeMillis: number}}}
     */
    var ValidationType = { WATERTIGHT_VALIDATION: WATERTIGHT_VALIDATION, EARLY_VALIDATION: EARLY_VALIDATION };

    // Lazy-initialise to avoid interacting with localStorage when it isn't required.
    function loadCache() {
        inMemoryCache = LRU(RECENT_USER_LIMIT);
        persistentCache = new StorageManager(CACHE_PREFIX, CACHE_ID);

        var recentUsersDump = persistentCache.getItem(CACHE_ITEMS_KEY);
        if (recentUsersDump) {
            var recentUsersJson = JSON.parse(recentUsersDump);
            inMemoryCache.load(recentUsersJson);
        }
    }

    function getUsers() {
        return new Promise(function (resolve) {
            inMemoryCache || loadCache();

            // Add users with order of most-recently-mentioned first
            var users = [];
            var index = 0;
            inMemoryCache.forEach(function (user) {
                user.supplier = UserSupplier.RECENT;
                user.role = null;
                user.sortIndex = index++;
                users.push(user);
            });
            AJS.debug('Found ' + users.length + ' recently-mentioned users');
            resolve(users);
        });
    }

    /**
     * Store a recently-mentioned User in the cache.
     * @param user
     * @param refreshed {Boolean} true if the user is from the server. This will update the timestamp of the last refresh to now().
     *                            Defaults to false if not passed in.
     */
    function store(user, refreshed) {
        inMemoryCache || loadCache();
        var oldUser = inMemoryCache.peek(user.username);
        var oldRefreshDate = oldUser ? oldUser.refreshedAt || 0 : 0;
        var refreshedAt = refreshed || !oldUser ? new Date().getTime() : oldRefreshDate;
        inMemoryCache.set(user.username, Object.assign({}, user.model ? user.model : user, { timestamp: user.timestamp, refreshedAt: refreshedAt }));
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    function remove(username) {
        inMemoryCache || loadCache();
        inMemoryCache.del(username);
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    /**
     * A stale user is one which has not been refreshed from the server for X days or more, X being calculated from the validation type.
     * @param validationType {{expireTimeMillis: number}} an enum to flag what kind of stale users to return. Use a value from ValidationType
     * @return {Array} a list of stale usersnames (NOTE: not the user objects - just the usernames)
     */
    function getStaleUsers(validationType) {
        inMemoryCache || loadCache();
        var stale = [];
        var now = new Date().getTime();
        //use a hack to iterate the keys to prevent the LRU from changing the ordering
        var existingKeys = inMemoryCache.keys();
        existingKeys.map(function (k) {
            return [inMemoryCache.peek(k), k];
        }).forEach(function (entry) {
            var val = entry[0];
            var key = entry[1];
            if (!val.refreshedAt || now - val.refreshedAt > validationType.expireTimeMillis) {
                stale.push(key);
            }
        });
        return stale;
    }

    function refresh(users) {
        inMemoryCache || loadCache();
        users.forEach(function (user) {
            if (inMemoryCache.has(user.username)) {
                var entry = inMemoryCache.peek(user.username);
                var timestamp = entry.timestamp || 0;
                //treat no timestamp as though it is stale, and refresh it
                if (!user.timestamp || !timestamp || user.timestamp > timestamp) {
                    store(user, true);
                }
            }
        });
    }

    // Used in tests
    function _clear() {
        loadCache();
    }

    exports.default = {
        getUsers: getUsers,
        store: store,
        remove: remove,
        getStaleUsers: getStaleUsers,
        refresh: refresh,
        _clear: _clear,
        RECENT_USER_LIMIT: RECENT_USER_LIMIT,
        ValidationType: ValidationType
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(41), __webpack_require__(13)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _currentUserSupplier, _userCache) {
    'use strict';

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var CurrentUserSupplier = _interopRequireDefault(_currentUserSupplier).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _slicedToArray = function () {
        function sliceIterator(arr, i) {
            var _arr = [];
            var _n = true;
            var _d = false;
            var _e = undefined;

            try {
                for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                    _arr.push(_s.value);

                    if (i && _arr.length === i) break;
                }
            } catch (err) {
                _d = true;
                _e = err;
            } finally {
                try {
                    if (!_n && _i["return"]) _i["return"]();
                } finally {
                    if (_d) throw _e;
                }
            }

            return _arr;
        }

        return function (arr, i) {
            if (Array.isArray(arr)) {
                return arr;
            } else if (Symbol.iterator in Object(arr)) {
                return sliceIterator(arr, i);
            } else {
                throw new TypeError("Invalid attempt to destructure non-iterable instance");
            }
        };
    }();

    "use strict";

    /**
     *
     * @param {string}   query              User's query
     * @param {object}   editor             the currently-active editor
     */
    function search(query, editor) {

        var serverUsersPromise = ServerUsersSupplier.getUsers(query);
        var relatedUsersPromise = RelatedUsersSupplier.getUsers(editor);
        var recentUsersPromise = RecentUsersSupplier.getUsers();
        var currentUserPromise = CurrentUserSupplier.getCurrentUser();

        var fastPromises = [relatedUsersPromise, recentUsersPromise, currentUserPromise];

        return {
            client: Promise.all(fastPromises).then(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 3),
                    relatedUsers = _ref2[0],
                    recentUsers = _ref2[1],
                    currentUser = _ref2[2];

                UserCache.addAll(relatedUsers);
                UserCache.addAll(recentUsers, true);
                if (currentUser) {
                    // May be undefined if anonymous.
                    UserCache.add(currentUser, true);
                }
            }),
            server: serverUsersPromise.then(function (serverUsers) {
                UserCache.addAll(serverUsers);
                RecentUsersSupplier.refresh(serverUsers);
            })
        };
    }

    function prefetchSuppliers(editor) {
        var waterTightValidationCheck = RecentUsersSupplier.getStaleUsers(RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        if (waterTightValidationCheck.length > 0) {
            //found some users whose stale for longer than 30 days. Must revalidate and delete if needed, before showing in UI.
            deleteStaleUsers(waterTightValidationCheck, RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        }
        // This will load related users into the cache in 'service/content-users/users-related-to-content'.
        RelatedUsersSupplier.getUsers(editor);
    }

    function deleteStaleUsers(usersToCheck, validationType) {
        ServerUsersSupplier._searchWithUsernames(usersToCheck).then(function (resultUsers) {
            RecentUsersSupplier.refresh(resultUsers);
            //if users are still stale after a refresh, it means they've not been returned by the server
            //time to delete 'em
            var usersToDelete = RecentUsersSupplier.getStaleUsers(validationType);
            usersToDelete.forEach(function (u) {
                return RecentUsersSupplier.remove(u);
            });
        });
    }

    // Reset any of the suppliers that hold state. Used in testing.
    function reset() {
        RelatedUsersSupplier.reset();
        ServerUsersSupplier.reset();
        RecentUsersSupplier._clear();
    }

    exports.default = {
        search: search,
        prefetchSuppliers: prefetchSuppliers,
        deleteStaleUsers: deleteStaleUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(24), __webpack_require__(25)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _draftContentSupplier, _usersRelatedToContent) {
    'use strict';

    var getDraft = _interopRequireDefault(_draftContentSupplier).default;

    var UsersRelatedToContent = _interopRequireDefault(_usersRelatedToContent).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     Returns users related to the Content currently in the Editor, optionally filtered by a search string.
    
     You can test this logic in your browser console against a running instance by running something like :
    
     `require('confluence-mentions').userSuppliers.contentRelated.getUsers().then((result) => { window.relatedUsers = result; });`
    
     and then viewing the `window.relatedUsers` value.
     */
    function getUsers(editor) {
        var content = getDraft(editor);
        return UsersRelatedToContent.getUsers(content);
    }

    /*
     We assume that all useful information is returned in the getUsersRelatedTo call.
     */
    function isExhausted() {
        return true;
    }

    // Clears the related user cache, used in testing.
    function reset() {
        UsersRelatedToContent.reset();
    }

    exports.default = {
        getUsers: getUsers,
        isExhausted: isExhausted,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(8)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _i18n) {
    'use strict';

    var I18n = _interopRequireDefault(_i18n).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var newRole = function newRole(role) {
        return {
            role: role,
            i18n: I18n('user.role.' + role)
        };
    }; /**
        A simple User Role bean that can provide its i18n'd display name.
        */
    exports.default = {
        CREATOR: newRole('creator'),
        CONTRIBUTOR: newRole('contributor'),
        COMMENTER: newRole('commenter'),
        ANCESTOR_COMMENTER: newRole('ancestorCommenter') // never shown, but available
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var i18nMap = {
        'user.role.creator': "Creator",
        'user.role.contributor': "Contributor",
        'user.role.commenter': "Commenter",
        'user.supplier.recent': "Recent"
    }; /**
        A way to get the i18nTransformer away from all-the-JS, this module allows clients to get I18n text using
        dynamic keys. Normally the i18nTransformer would fail to handle this and the developer would be forced to add
       
        "foo100"
       
        entries for each case. By extracting those invocations of AJS.I18n.getText to a single place, we can plan for a future
        where the transformer is not necessary and we can serve one set of JS resources for all locales.
       
        A future improvement might be to generate an i18n.js file directly from a plugin's
        i18n.properties file at build time.
        */

    exports.default = function (key) {
        // TODO - could interpolate args, etc. dT
        return i18nMap[key];
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 9 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(11), __webpack_require__(2), __webpack_require__(3), __webpack_require__(12), __webpack_require__(39), __webpack_require__(1), __webpack_require__(40)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _legacy, _meta, _jquery, _userRanker, _serverUserCache, _userSupplierKeys, _luceneQuery) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Confluence = _interopRequireDefault(_legacy).default;

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var UserRanker = _interopRequireDefault(_userRanker).default;

    var Cache = _interopRequireDefault(_serverUserCache).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var LuceneQuery = _interopRequireDefault(_luceneQuery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Wait this long after REST call triggers before actually doing a search - results in fewer HTTP requests.
     */
    var DEBOUNCE_WAIT_MS = 250;

    // 1 char query is now supported by CQL.
    var MIN_CHARS_TO_SEARCH = 1;

    var limit = 100;
    var cache = Cache(limit);

    /**
     * The id of the last timeout to be created for a REST call. We cancel this timeout if
     * a scheduled call becomes stale.
     */
    var lastTimeout = void 0;

    /**
     Returns users from the backend via a CQL search.
     */
    function getUsers(query) {
        return new Promise(function (resolve, reject) {

            if (!query || query.length < MIN_CHARS_TO_SEARCH) {
                // No query - no server results.
                return resolve([]);
            }

            AJS.debug('server-users-supplier: Looking in cache for ' + query);
            var cacheEntry = cache.getClosest(query);
            if (cacheEntry) {
                AJS.debug('server-users-supplier: Found cache entry with query ' + cacheEntry.query);
                if (cacheEntry.query === query) {
                    // Exact match - just serve these results.
                    return resolve(cacheEntry.users);
                }

                // Not an exact match. Might need a REST call, but we can show results based on what we have cached.
                var rankedUsers = UserRanker(cacheEntry.users, query);
                cache.add(query, rankedUsers);

                // TODO Always resolve with what we have from the cache - this is information that can be put in front of
                // the user immediately. We then decide whether to follow up the local results with remote ones.
                // However, we need the ability to 'resolve' multiple times - to call the render once with the cached
                // results and again (if not debounced, stale, etc, etc) with the server results.
                if (cacheEntry.isExhausted) {
                    return resolve(rankedUsers);
                }

                // Else we might be searching for "John" but "Joh" already has >={limit} users.
                // We need to hit the server!
                // TODO - can we resolve multiple times?
            }

            var contextPath = Meta.get('context-path');
            var escapedQuery = LuceneQuery.escape(query);
            var queryParameters = {
                cql: 'user ~ "' + Confluence.unescapeEntities(escapedQuery) + '"',
                start: 0,
                limit: limit
            };
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    AJS.debug('server-users-supplier: Adding user to cache: ' + user.username);
                    return user;
                });
                cache.add(query, users);
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     * Forces a search for exact usernames. Use this to ensure the cached entries in
     * other suppliers are not stale.
     * @param usernames {Array} Array of username strings
     * @returns {Promise} a promise which will resolve with an array of user objects from the search that matched any of the input usernames.
     * @private
     */
    function _searchWithUsernames(usernames) {
        return new Promise(function (resolve, reject) {
            if (!usernames || usernames.length === 0) {
                return resolve([]);
            }
            var contextPath = Meta.get('context-path');
            var queryParameters = {
                cql: 'user in (' + usernames.map(function (u) {
                    return '"' + u + '"';
                }).join(",") + ')',
                start: 0,
                limit: usernames.length
            };
            AJS.debug('querying with \'' + queryParameters.cql + '\'');
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    return user;
                });
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     If a given search returns less that the specified limit, we say that that query is exhausted - adding more
     characters to the query will return a subset of users from the shorter query.
     */
    function isExhausted(query) {
        return true;
    }

    // Flushes the cache between tests.
    function reset() {
        cache.reset();
        AJS.debug('server-users-supplier: Cache reset');
    }

    exports.default = {
        getUsers: getUsers,
        _searchWithUsernames: _searchWithUsernames,
        isExhausted: isExhausted,
        reset: reset,
        DEBOUNCE_WAIT_MS: DEBOUNCE_WAIT_MS
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_11__;

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(11), __webpack_require__(38)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _legacy, _fuse) {
    'use strict';

    var Confluence = _interopRequireDefault(_legacy).default;

    var Fuse = _interopRequireDefault(_fuse).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Details for these options are available at http://fusejs.io/, but the basic gist is:
     *
     * - tokenize is required so that first and last names are searched from their first character
     * - matchAllTokens so that tokenize will match all words in the query
     * - threshold close to 0 to avoid unhelpful results, but this can be tweaked because...
     * - shouldSort will put the best matches at the top of the result array.
     * - location means that matching should start at the beginning of words, which is usually
     *     what name searches will want
     */
    /**
     * Ranks users, given a query.
     */
    var options = {
        includeMatches: true,
        includeScore: true,
        tokenize: true,
        matchAllTokens: true,
        threshold: 0.1,
        location: 0,
        distance: 0,
        maxPatternLength: 16,
        minMatchCharLength: 1,
        keys: [{
            name: 'displayName',
            weight: 0.7
        }, {
            name: 'username',
            weight: 0.3
        }]
    };

    exports.default = function (users, query) {
        if (!query) {
            return users;
        }

        // TODO Depending on what kind of setup is done in the Fuse constructor, we might want to
        // optimise by keeping an instance around that has all of the users currently-known to the
        // frontend: including cached Server search results.
        var fuse = new Fuse(users, options);
        var results = fuse.search(Confluence.unescapeEntities(query));
        return results.map(function (result) {
            var item = result.item;
            item.fuseMatches = result.matches;
            item.fuseScore = result.score;
            return item;
        });
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    /**
     * Where all the aggregation and caching happens
     */
    "use strict";

    function _toConsumableArray(arr) {
        if (Array.isArray(arr)) {
            for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {
                arr2[i] = arr[i];
            }

            return arr2;
        } else {
            return Array.from(arr);
        }
    }

    var userCache = new Map();

    /**
     * Updates the incoming User object to split "displayName" into "firstName" and "lastNames" to aid Fuse matching.
     * @param user
     * @private
     */
    function _splitNames(user) {
        if (!user || !user.displayName) {
            return;
        }

        // We store first and last names separately to enable search weightings in Fuse.
        // JS String.split doesn't quite do what we need so we just use a substring.
        var firstSpace = user.displayName.indexOf(' ');
        if (firstSpace > 0) {
            user.firstName = user.displayName.substring(0, firstSpace);
            user.lastNames = user.displayName.substring(firstSpace + 1);
        } else {
            // A user display name in a language without spaces. Setting the firstName should work in most cases.
            user.firstName = user.displayName;
            user.lastNames = '';
        }
    }

    function _isStaleEntry(user) {
        if (!userCache.has(user.username)) {
            return true;
        }
        var entry = userCache.get(user.username);
        var timestamp = entry.timestamp || 0;
        return user.timestamp > timestamp;
    }

    exports.default = {
        /**
         * Will add the user to the user cache, if it's not already present.
         * @param {user}    user     A single user in API format
         * @param {boolean} force    if true, any cached user with the same username will be replaced with this user
         */
        add: function add(user) {
            var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

            // Existing cache entries may have a different Supplier for a given user - don't overwrite.
            if (user && user.hasOwnProperty("username") && (force === true || _isStaleEntry(user))) {
                _splitNames(user);
                userCache.set(user.username, user);
            }
        },

        /**
         * Will add all the supplied users by individually calling add
         * @param users an array of users
         */
        addAll: function addAll(users, force) {
            var _this = this;

            users.forEach(function (user) {
                _this.add(user, force);
            });
        },

        /**
         * @returns an array of all the users in the cache
         */
        getAll: function getAll() {
            return [].concat(_toConsumableArray(userCache.values()));
        },

        /**
         * Used for testing
         * @private
         */
        _get: function _get(username) {
            return userCache.get(username);
        },

        /**
         * Used for testing
         * @private
         */
        _clear: function _clear() {
            userCache.clear();
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(5), __webpack_require__(13), __webpack_require__(42), __webpack_require__(49), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _userSupplierManager, _userCache, _pipelines, _executor, _scoreBooster) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var userSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    var Pipelines = _interopRequireDefault(_pipelines).default;

    var PipelineExecutor = _interopRequireDefault(_executor).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * The maximum number of Users that will be displayed in the Mentions dropdown.
     */
    var DISPLAY_LIMIT = 5;
    var NON_BREAKING_SPACE = String.fromCharCode(160);

    // The last query to be triggered, used when server responses return out of order and we need to skip the render of
    // stale responses.
    var latestQuery = void 0;

    /**
     *
     * @param {string}   query              User's query
     * @param {function} renderCallback     Callback function to render the results
     * @param {function} selectedUser       (optional) the currently-selected user in the dropdown
     * @param {object} editor               the currently-active editor
     */
    function searchAndRender(query, renderCallback, selectedUser, editor) {
        // Trim the query but don't convert to lowercase just yet - the ranker should handle this. (i.e. upper case
        // letters could be weighted higher in matches).
        // Note that 160 is the non-breaking-space character and is not handled by trim().
        // It IS handled by $.trim(str) but noooooo, noooooo.
        query = query.replace(NON_BREAKING_SPACE, ' ').trim();
        latestQuery = query;

        var promises = userSupplierManager.search(query, editor);

        promises.client.then(function () {
            resolveClientUsers();
            // Guarantee that server results are handled after local ones - chain the promises!
            promises.server.then(resolveServerUsers, renderErrorOnReject);
        }, renderErrorOnReject);

        function resolveClientUsers() {
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, false);
        }

        function resolveServerUsers() {
            // We could in future wrap the renderCallback so that if the server render would have the same values as the
            // client render, we skip it and avoid a browser repaint.
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, true);
        }

        function renderErrorOnReject() {
            var iterator = new PipelineExecutor(Pipelines.error(renderCallback));
            iterator.execute([]);
        }
    }

    function renderPipeline(users, query, renderCallback, selectedUser, isServerCall) {
        var context = {
            query: query,
            latestQuery: latestQuery,
            selectedUser: selectedUser,
            isServerCall: isServerCall,
            DISPLAY_LIMIT: DISPLAY_LIMIT
        };

        var pipeline = void 0;
        if (!query) {
            pipeline = Pipelines.default(renderCallback);
        } else {
            pipeline = isServerCall ? Pipelines.server(renderCallback) : Pipelines.client(renderCallback);
        }

        var executor = new PipelineExecutor(pipeline, context);
        executor.execute(users);
    }

    // Called during testing to clear caches.
    function reset() {
        userSupplierManager.reset();
        UserCache._clear();
        ScoreBooster.reset();
    }

    exports.default = {
        searchAndRender: searchAndRender,
        prefetchSuppliers: userSupplierManager.prefetchSuppliers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    exports.default = {
        resultWithHtml: function resultWithHtml(html) {
            return {
                html: html
            };
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_16__;

/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    'use strict';

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var suggestedUsers = [];

    /**
     * When searching for a user you're likely to want a user you've recently mentioned, even if other Fuse matches have
     * slightly better (lower) scores. For now we boost all recent matches, but we could adjust this to only the recent match
     * with the best score.
     *
     * Also, contributors should bubble to the top in the search results, at least until the search token is compelling enough
     * to switch.
     */
    function boostScores(users, next, context) {
        var query = context && context.query || '';
        if (query.indexOf(' ') > 0) {
            // Don't boost on supplier once multiple names are being added - the user seems to know who they're after so
            // let Fuse do its job.
            return next(users);
        }

        // The pipeline could be ensuring that users passed down the pipe are immutable, but for now just clone. fuseScore
        // should NOT be making its way into the user cache.
        var boostedUsers = users.map(function (userIn) {
            var user = Object.assign({}, userIn);
            if (suggestedUsers.includes(user.username)) {
                user.fuseScore /= 1000; // keep ordering for multiple matched suggestions
            } else if (typeof user.fuseScore === 'number') {
                switch (user.supplier) {
                    case UserSupplier.RECENT:
                        user.fuseScore /= 5;
                        break;
                    case UserSupplier.RELATED:
                        user.fuseScore /= 10;
                        break;
                }
            }
            return user;
        });
        return next(boostedUsers);
    }

    function setSuggestedUsers(users, next) {
        suggestedUsers = users.map(function (user) {
            return user.username;
        });
        return next(users);
    }

    function reset() {
        suggestedUsers = [];
    }

    exports.default = {
        boostScores: boostScores,
        setSuggestedUsers: setSuggestedUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 18 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_18__;

/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(21);


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(22), __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _editorPluginInit, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _tinymce) {
    'use strict';

    var editorPluginInit = _interopRequireDefault(_editorPluginInit).default;

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    function init(e, context) {
        var editor = context && context.editor; // in case the initCallback internal code breaks API

        tinymce.create('tinymce.plugins.InsertMentions', {
            init: editorPluginInit(editor),

            getInfo: function getInfo() {
                return {
                    longname: 'Insert Mentions',
                    author: 'Atlassian',
                    authorurl: 'http://www.atlassian.com',
                    version: tinymce.majorVersion + "." + tinymce.minorVersion
                };
            }
        });

        tinymce.PluginManager.add('insertmentions', tinymce.plugins.InsertMentions);
    }

    /**
     * This is the main export from the Mentions module set.
     */
    exports.default = {
        init: init,
        userSuppliers: {
            // Users from localstorage
            recent: RecentUsersSupplier,
            // Users from the server
            serverSearch: ServerUsersSupplier,
            // Users from the front-end cache of the Content in the editor
            contentRelated: RelatedUsersSupplier
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(3), __webpack_require__(23), __webpack_require__(14), __webpack_require__(18), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _jquery, _autocompleteAdapter, _Mentions, _autocompleteManager, _autocompleteSettings) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var $ = _interopRequireDefault(_jquery).default;

    var Adapter = _interopRequireDefault(_autocompleteAdapter).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    var AutocompleteSettings = _interopRequireDefault(_autocompleteSettings).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function activateMentions() {
        AJS.EventQueue.push({ name: 'confluencementioninsert' });
        AutocompleteManager.shortcutFired("@");
    }

    function onClickEvent(event) {
        event.stopPropagation();
        event.preventDefault();
        AJS.Rte.getEditor().focus();
        activateMentions();
    }

    function editorPluginInit(editor) {
        AJS.EventQueue = AJS.EventQueue || [];
        Mentions.prefetchSuppliers(editor);

        AutocompleteSettings.Settings["@"] = {
            ch: "@",
            cache: true,
            endChars: [],
            dropDownClassName: "autocomplete-mentions fabric",
            autocompleteClassNames: "fabric",
            dropDownDelay: 0, // No delay needed because there is no AJAX request involved
            selectFirstItem: true,
            minLengthForGetData: 1,
            displayHandler: function displayHandler(user) {
                // Use Jquery to encode the user name
                return $('<div/>').text(user.name).html();
            },

            getHeaderText: function getHeaderText() {
                return null; // HACK this could be an option in core, the header is currently being hidden with CSS.
            },

            getAdditionalLinks: function getAdditionalLinks(autoCompleteControl, value, callback) {
                var additionalLinks = [];
                if (callback) callback(value, additionalLinks);
                return additionalLinks;
            },

            /**
             *
             * @param autoCompleteControl
             * @param value     The user's input
             * @param {function} renderResults  function to run with the resulting users (from input-driven-dropdown in
             *                                  Core)
             */
            getDataAndRunCallback: function getDataAndRunCallback(autoCompleteControl, value, renderResults) {
                Adapter.search(autoCompleteControl, value, renderResults, editor);
            },

            /**
             * Overrides the confluence/highlighter used to highlight query term matches in results
             */
            // For now, this override is ignored: we're getting better results from the default highlighter than with the
            // highlighting based on Fuse.js output.
            // Highlighter,

            update: Adapter.insert
        };

        $('#insertmention-button').on('click', onClickEvent);

        if (AJS.Rte.Placeholder && AJS.Rte.Placeholder.addPlaceholderType) {
            AJS.Rte.Placeholder.addPlaceholderType({
                type: 'mention',
                label: "User mention",
                tooltip: "Instructional text is replaced with suggested people when a person types."
            });
        }
    }

    exports.default = editorPluginInit;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(14), __webpack_require__(4), __webpack_require__(5), __webpack_require__(50), __webpack_require__(2), __webpack_require__(52), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _Mentions, _recentUsersSupplier, _userSupplierManager, _mentionAnalytics, _meta, _linkObject, _tinymce) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    var UserSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var MentionsAnalytics = _interopRequireDefault(_mentionAnalytics).default;

    var Meta = _interopRequireDefault(_meta).default;

    var Link = _interopRequireDefault(_linkObject).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    var BASE_URL = Meta.get('base-url');

    function search(autoCompleteControl, value, renderResults, editor) {
        MentionsAnalytics.updateSession(autoCompleteControl);

        // The && guard here can be removed once the core tinymce3/plugins/autocomplete/autocomplete-manager.js code is released.
        // Hacky try catch to work around CONFSRVDEV-3101 and CONFSRVDEV-3138
        var selectedUser = void 0;
        try {
            var selectedItem = autoCompleteControl.getCurrentItem && autoCompleteControl.getCurrentItem();
            selectedUser = selectedItem && selectedItem.model;
        } catch (ignored) {
            console.log('Error retrieving currently-selected autoComplete item');
            console.log(ignored);
        }

        // renderResults likes a 2D array, and the query tokens in an array for highlighting
        var tokens = value && value.split(' ') || [];
        var render = function render(results, next, context) {
            return renderResults([results], value, null, tokens, context);
        };
        Mentions.searchAndRender(value, render, selectedUser, editor);
    }

    function insert(autoCompleteControl, user) {
        MentionsAnalytics.publishEventForSelection(user, autoCompleteControl.analytics);

        // Add this user to the cache - it will be retrieved with the recent-users-supplier module.
        RecentUsers.store(user);

        var earlyValidationCheck = RecentUsers.getStaleUsers(RecentUsers.ValidationType.EARLY_VALIDATION);
        if (earlyValidationCheck.length > 0) {
            //asynchronously attempt to update the recently mentioned cache to remove any stale users, after the UI insert is completed
            setTimeout(function () {
                return UserSupplierManager.deleteStaleUsers(earlyValidationCheck, RecentUsers.ValidationType.EARLY_VALIDATION);
            }, 0);
        }

        var link = {
            attrs: {
                href: user.link,
                'userkey': user.model.userKey, // required to unmarshall ResourceIdentifier
                'data-base-url': BASE_URL,
                'data-linked-resource-type': 'userinfo',
                'data-linked-resource-default-alias': user.name
            },
            body: {
                html: AJS.escapeHtml(user.name)
            },
            classes: ['confluence-link']
        };
        Link.fromData(link).insert();
        tinymce.activeEditor.selection.setContent(" ");
    }

    // Called during testing
    function reset() {
        Mentions.reset();
    }

    exports.default = {
        search: search,
        insert: insert,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    // Adapted from confluence-quick-edit/src/main/resources/jscripts/handlers/comment.js.
    /**
     Supplies the Content API model object associated with the current draft in the editor.
    
     This is basically a shim for something that the Editor JS API *should* provide but currently doesn't
     */
    function getParameter(url, paramName) {
        if (!url) {
            return '';
        }
        var regex = new RegExp("[?&]" + paramName + "=(\\d+)");
        var match = url.match(regex);
        return match && match.length > 1 ? match[1] : '';
    }

    function safeGetDraft(editor) {
        if (!editor) {
            return null;
        }

        try {
            return getDraft(editor);
        } catch (e) {
            // This might happen if the Editor is being initialised in a context we don't yet support.
            console.error(e.message);
            return null;
        }
    }

    function getDraft(editor) {
        var id = Meta.get('page-id');

        var form = editor.formElement;
        var action = form.action || '';

        if (action.indexOf('/doaddcomment.action') > -1 || action.indexOf('/doeditcomment.action') > -1 || $(form).closest('.ic-sidebar').length) {
            var commentId = getParameter(action, "commentId") || '0';

            var content = {
                id: commentId,
                type: 'comment',
                status: 'draft',
                container: {
                    id: id
                }
            };

            var parentCommentId = getParameter(action, "parentId");
            if (parentCommentId) {
                content.ancestors = [{
                    id: parentCommentId
                }];
            }

            return content;
        }

        var previewContainer = $(form).closest('.cp-container');
        if (previewContainer.length) {
            // This is a comment for a Preview. Until we have a proper API, scrape the DOM and shed a single tear.
            var previewTitle = previewContainer.find('.cp-file-title').text().replace(/"/g, "\\\"");
            // CONFSRVDEV-11704 because the previewer can be triggered from like million places, and because we suck
            // and don't set the alias for attachment titles consistently , which means we need to look for them with spaces
            // a well as with + for space
            var alternateTitle = escape(previewTitle.replace(/\s/g, "+"));
            var $element = $('body').find('*[data-linked-resource-default-alias="' + previewTitle + '"], *[data-linked-resource-default-alias="' + alternateTitle + '"]');
            if ($element.length) {
                var attachmentId = $element.attr('data-linked-resource-id');
                // Again, until Previews exposes an API, and the Editor consumes it in a way that THIS code can consume,
                // we're limited in how Smart the suggestions here can be. For now, editing an existing comment or replying
                // to a comment are treated the same as creating a new comment.
                return {
                    id: 0,
                    type: 'comment',
                    status: 'draft',
                    container: {
                        id: attachmentId
                    }
                };
            }
        }

        var newPage = Meta.get('new-page');

        var type = Meta.get('content-type');
        return {
            id: newPage ? '0' : id,
            type: type,
            status: 'draft'
        };
    }

    exports.default = safeGetDraft;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery, _aggregateUsers, _restParameters, _relatedUserTransformer) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var aggregateUsers = _interopRequireDefault(_aggregateUsers).default;

    var getRestParameters = _interopRequireDefault(_restParameters).default;

    var flattenUsers = _interopRequireDefault(_relatedUserTransformer).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   Supplies Users that are related to a piece of Content, calculated from server data via the Content API.
                   */


    var cache = {};

    var getUsers = function getUsers(contentStub) {
        var restParams = getRestParameters(contentStub);
        if (!restParams) {
            // Will be null for new pages and blogposts: don't make a REST call, don't cache
            return Promise.resolve([]);
        }

        if (restParams.contentId in cache) {
            return cache[restParams.contentId];
        }

        var promise = new Promise(function (resolve, reject) {
            var contextPath = Meta.get('context-path');
            var url = contextPath + '/rest/api/content/' + restParams.contentId;
            var queryParameters = {
                expand: restParams.expand
            };

            $.getJSON(url, queryParameters, function (content) {
                resolve(flattenUsers(aggregateUsers(content)));
            }).fail(reject);
        });

        cache[restParams.contentId] = promise;
        return promise;
    };

    // Used in testing.
    function reset() {
        cache = {};
    }

    exports.default = {
        getUsers: getUsers,
        reset: reset,
        _cache: cache //exposed for testing
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole, _userSupplierKeys) {
    'use strict';

    var UserRole = _interopRequireDefault(_userRole).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    exports.default = function (content) {
        var relatedUsers = {};

        // Used to track users that have already been added to relatedUsers
        var usernames = new Set();

        // Skip anonymous users, disabled/deleted users, and users already in the result
        function shouldAddUser(user) {
            if (user.type === 'anonymous') {
                return false;
            }

            if (typeof user.status === 'undefined') {
                console.error("User status is undefined. Not adding to relatedUsers aggregate.");
                return false;
            }
            return user.status === 'current' && !usernames.has(user.username);
        }

        function addUser(user, role) {
            user.role = role;
            user.supplier = UserSupplier.RELATED;
            var roleKey = role.role;
            relatedUsers[roleKey] = relatedUsers[roleKey] || [];
            relatedUsers[roleKey].push(user);
            usernames.add(user.username);
        }

        function addUserWithRole(user, role) {
            if (shouldAddUser(user)) {
                addUser(user, role);
            }
        }

        var page = content.type === 'comment' ? content.container : content;

        // Only do this for content that has history
        if ('history' in page) {
            addUserWithRole(page.history.createdBy, UserRole.CREATOR);

            // Contributors are reversed to descending chronological order - users are more likely to mention contributors who
            // edited the content more recently.
            page.history.contributors.publishers.users.reverse().forEach(function (contributor) {
                addUserWithRole(contributor, UserRole.CONTRIBUTOR);
            });
        }

        if (content.type === 'comment' && content.ancestors) {
            // A new or existing comment that is a reply to another comment. We catch ancestor commenters before other
            // commenters because they are more likely to be mentioned.
            // Ancestor order is not reversed because they are already ordered youngest to oldest.
            content.ancestors.forEach(function (ancestorComment) {
                addUserWithRole(ancestorComment.version.by, UserRole.ANCESTOR_COMMENTER);
            });
        }

        if ('children' in page) {
            // Page commenters are also listed in reverse order
            page.children.comment.results.reverse().forEach(function (comment) {
                addUserWithRole(comment.version.by, UserRole.COMMENTER);
            });
        }

        return relatedUsers;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    /**
     Calculations the content id and expansions that should be used in the REST API call when building the
     list of users related to a piece of Content in the editor.
     */

    var PAGE_REST_EXPANSIONS = 'history.createdBy.status,history.contributors.publishers.users.status,children.comment.version.by.status';
    var COMMENT_REST_EXPANSIONS = 'ancestors.version.by.status,container.history.createdBy.status,container.history.contributors.publishers.users.status,container.children.comment.version.by.status';

    function restParams(id, expansions) {
        return {
            contentId: id,
            expand: expansions
        };
    }

    function isBlankId(val) {
        return !val || val === '0';
    }

    exports.default = function (contentStub) {
        if (!contentStub) {
            return null;
        }

        if (contentStub.type === 'page' || contentStub.type === 'blogpost') {
            var pageId = contentStub.id;
            if (isBlankId(pageId)) {
                // A new page/blogpost has no related users.
                return null;
            }
            // Editing an existing page or blogpost
            return restParams(pageId, PAGE_REST_EXPANSIONS);
        }

        if (contentStub.type === 'comment') {
            var commentId = contentStub.id;
            if (!isBlankId(commentId)) {
                // Editing an existing comment
                return restParams(commentId, COMMENT_REST_EXPANSIONS);
            }

            // A new comment: the stub will include the id of the comment it is replying to, unless this is a top-level
            // comment. NOTE: if we end up with access to a Draft comment, we should be able to use its id as the
            // content id, and not use the parent-comment or page ids here.
            var parentCommentId = contentStub.ancestors && contentStub.ancestors[0] && contentStub.ancestors[0].id;
            if (!isBlankId(parentCommentId)) {
                // A new reply
                return restParams(parentCommentId, COMMENT_REST_EXPANSIONS);
            }

            // A new top-level comment
            var _pageId = contentStub.container.id;
            return restParams(_pageId, PAGE_REST_EXPANSIONS);
        }
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole) {
    "use strict";

    var UserRole = _interopRequireDefault(_userRole).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Converts the map of users by role into a list of users.
     */

    exports.default = function (usersMap) {
        var transformedList = [];

        function addUsersWithRoleToList(userRole) {
            var users = usersMap[userRole.role];
            if (users && users.length) {
                transformedList = transformedList.concat(users);
            }
        }

        addUsersWithRoleToList(UserRole.CREATOR);
        addUsersWithRoleToList(UserRole.CONTRIBUTOR);
        addUsersWithRoleToList(UserRole.COMMENTER);
        addUsersWithRoleToList(UserRole.ANCESTOR_COMMENTER);

        return transformedList;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = LRUCache

// This will be a proper iterable 'Map' in engines that support it,
// or a fakey-fake PseudoMap in older versions.
var Map = __webpack_require__(30)
var util = __webpack_require__(32)

// A linked list to keep track of recently-used-ness
var Yallist = __webpack_require__(36)

// use symbols if possible, otherwise just _props
var hasSymbol = typeof Symbol === 'function'
var makeSymbol
if (hasSymbol) {
  makeSymbol = function (key) {
    return Symbol.for(key)
  }
} else {
  makeSymbol = function (key) {
    return '_' + key
  }
}

var MAX = makeSymbol('max')
var LENGTH = makeSymbol('length')
var LENGTH_CALCULATOR = makeSymbol('lengthCalculator')
var ALLOW_STALE = makeSymbol('allowStale')
var MAX_AGE = makeSymbol('maxAge')
var DISPOSE = makeSymbol('dispose')
var NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')
var LRU_LIST = makeSymbol('lruList')
var CACHE = makeSymbol('cache')

function naiveLength () { return 1 }

// lruList is a yallist where the head is the youngest
// item, and the tail is the oldest.  the list contains the Hit
// objects as the entries.
// Each Hit object has a reference to its Yallist.Node.  This
// never changes.
//
// cache is a Map (or PseudoMap) that matches the keys to
// the Yallist.Node object.
function LRUCache (options) {
  if (!(this instanceof LRUCache)) {
    return new LRUCache(options)
  }

  if (typeof options === 'number') {
    options = { max: options }
  }

  if (!options) {
    options = {}
  }

  var max = this[MAX] = options.max
  // Kind of weird to have a default max of Infinity, but oh well.
  if (!max ||
      !(typeof max === 'number') ||
      max <= 0) {
    this[MAX] = Infinity
  }

  var lc = options.length || naiveLength
  if (typeof lc !== 'function') {
    lc = naiveLength
  }
  this[LENGTH_CALCULATOR] = lc

  this[ALLOW_STALE] = options.stale || false
  this[MAX_AGE] = options.maxAge || 0
  this[DISPOSE] = options.dispose
  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false
  this.reset()
}

// resize the cache when the max changes.
Object.defineProperty(LRUCache.prototype, 'max', {
  set: function (mL) {
    if (!mL || !(typeof mL === 'number') || mL <= 0) {
      mL = Infinity
    }
    this[MAX] = mL
    trim(this)
  },
  get: function () {
    return this[MAX]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'allowStale', {
  set: function (allowStale) {
    this[ALLOW_STALE] = !!allowStale
  },
  get: function () {
    return this[ALLOW_STALE]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'maxAge', {
  set: function (mA) {
    if (!mA || !(typeof mA === 'number') || mA < 0) {
      mA = 0
    }
    this[MAX_AGE] = mA
    trim(this)
  },
  get: function () {
    return this[MAX_AGE]
  },
  enumerable: true
})

// resize the cache when the lengthCalculator changes.
Object.defineProperty(LRUCache.prototype, 'lengthCalculator', {
  set: function (lC) {
    if (typeof lC !== 'function') {
      lC = naiveLength
    }
    if (lC !== this[LENGTH_CALCULATOR]) {
      this[LENGTH_CALCULATOR] = lC
      this[LENGTH] = 0
      this[LRU_LIST].forEach(function (hit) {
        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)
        this[LENGTH] += hit.length
      }, this)
    }
    trim(this)
  },
  get: function () { return this[LENGTH_CALCULATOR] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'length', {
  get: function () { return this[LENGTH] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'itemCount', {
  get: function () { return this[LRU_LIST].length },
  enumerable: true
})

LRUCache.prototype.rforEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].tail; walker !== null;) {
    var prev = walker.prev
    forEachStep(this, fn, walker, thisp)
    walker = prev
  }
}

function forEachStep (self, fn, node, thisp) {
  var hit = node.value
  if (isStale(self, hit)) {
    del(self, node)
    if (!self[ALLOW_STALE]) {
      hit = undefined
    }
  }
  if (hit) {
    fn.call(thisp, hit.value, hit.key, self)
  }
}

LRUCache.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].head; walker !== null;) {
    var next = walker.next
    forEachStep(this, fn, walker, thisp)
    walker = next
  }
}

LRUCache.prototype.keys = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.key
  }, this)
}

LRUCache.prototype.values = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.value
  }, this)
}

LRUCache.prototype.reset = function () {
  if (this[DISPOSE] &&
      this[LRU_LIST] &&
      this[LRU_LIST].length) {
    this[LRU_LIST].forEach(function (hit) {
      this[DISPOSE](hit.key, hit.value)
    }, this)
  }

  this[CACHE] = new Map() // hash of items by key
  this[LRU_LIST] = new Yallist() // list of items in order of use recency
  this[LENGTH] = 0 // length of items in the list
}

LRUCache.prototype.dump = function () {
  return this[LRU_LIST].map(function (hit) {
    if (!isStale(this, hit)) {
      return {
        k: hit.key,
        v: hit.value,
        e: hit.now + (hit.maxAge || 0)
      }
    }
  }, this).toArray().filter(function (h) {
    return h
  })
}

LRUCache.prototype.dumpLru = function () {
  return this[LRU_LIST]
}

LRUCache.prototype.inspect = function (n, opts) {
  var str = 'LRUCache {'
  var extras = false

  var as = this[ALLOW_STALE]
  if (as) {
    str += '\n  allowStale: true'
    extras = true
  }

  var max = this[MAX]
  if (max && max !== Infinity) {
    if (extras) {
      str += ','
    }
    str += '\n  max: ' + util.inspect(max, opts)
    extras = true
  }

  var maxAge = this[MAX_AGE]
  if (maxAge) {
    if (extras) {
      str += ','
    }
    str += '\n  maxAge: ' + util.inspect(maxAge, opts)
    extras = true
  }

  var lc = this[LENGTH_CALCULATOR]
  if (lc && lc !== naiveLength) {
    if (extras) {
      str += ','
    }
    str += '\n  length: ' + util.inspect(this[LENGTH], opts)
    extras = true
  }

  var didFirst = false
  this[LRU_LIST].forEach(function (item) {
    if (didFirst) {
      str += ',\n  '
    } else {
      if (extras) {
        str += ',\n'
      }
      didFirst = true
      str += '\n  '
    }
    var key = util.inspect(item.key).split('\n').join('\n  ')
    var val = { value: item.value }
    if (item.maxAge !== maxAge) {
      val.maxAge = item.maxAge
    }
    if (lc !== naiveLength) {
      val.length = item.length
    }
    if (isStale(this, item)) {
      val.stale = true
    }

    val = util.inspect(val, opts).split('\n').join('\n  ')
    str += key + ' => ' + val
  })

  if (didFirst || extras) {
    str += '\n'
  }
  str += '}'

  return str
}

LRUCache.prototype.set = function (key, value, maxAge) {
  maxAge = maxAge || this[MAX_AGE]

  var now = maxAge ? Date.now() : 0
  var len = this[LENGTH_CALCULATOR](value, key)

  if (this[CACHE].has(key)) {
    if (len > this[MAX]) {
      del(this, this[CACHE].get(key))
      return false
    }

    var node = this[CACHE].get(key)
    var item = node.value

    // dispose of the old one before overwriting
    // split out into 2 ifs for better coverage tracking
    if (this[DISPOSE]) {
      if (!this[NO_DISPOSE_ON_SET]) {
        this[DISPOSE](key, item.value)
      }
    }

    item.now = now
    item.maxAge = maxAge
    item.value = value
    this[LENGTH] += len - item.length
    item.length = len
    this.get(key)
    trim(this)
    return true
  }

  var hit = new Entry(key, value, len, now, maxAge)

  // oversized objects fall out of cache automatically.
  if (hit.length > this[MAX]) {
    if (this[DISPOSE]) {
      this[DISPOSE](key, value)
    }
    return false
  }

  this[LENGTH] += hit.length
  this[LRU_LIST].unshift(hit)
  this[CACHE].set(key, this[LRU_LIST].head)
  trim(this)
  return true
}

LRUCache.prototype.has = function (key) {
  if (!this[CACHE].has(key)) return false
  var hit = this[CACHE].get(key).value
  if (isStale(this, hit)) {
    return false
  }
  return true
}

LRUCache.prototype.get = function (key) {
  return get(this, key, true)
}

LRUCache.prototype.peek = function (key) {
  return get(this, key, false)
}

LRUCache.prototype.pop = function () {
  var node = this[LRU_LIST].tail
  if (!node) return null
  del(this, node)
  return node.value
}

LRUCache.prototype.del = function (key) {
  del(this, this[CACHE].get(key))
}

LRUCache.prototype.load = function (arr) {
  // reset the cache
  this.reset()

  var now = Date.now()
  // A previous serialized cache has the most recent items first
  for (var l = arr.length - 1; l >= 0; l--) {
    var hit = arr[l]
    var expiresAt = hit.e || 0
    if (expiresAt === 0) {
      // the item was created without expiration in a non aged cache
      this.set(hit.k, hit.v)
    } else {
      var maxAge = expiresAt - now
      // dont add already expired items
      if (maxAge > 0) {
        this.set(hit.k, hit.v, maxAge)
      }
    }
  }
}

LRUCache.prototype.prune = function () {
  var self = this
  this[CACHE].forEach(function (value, key) {
    get(self, key, false)
  })
}

function get (self, key, doUse) {
  var node = self[CACHE].get(key)
  if (node) {
    var hit = node.value
    if (isStale(self, hit)) {
      del(self, node)
      if (!self[ALLOW_STALE]) hit = undefined
    } else {
      if (doUse) {
        self[LRU_LIST].unshiftNode(node)
      }
    }
    if (hit) hit = hit.value
  }
  return hit
}

function isStale (self, hit) {
  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {
    return false
  }
  var stale = false
  var diff = Date.now() - hit.now
  if (hit.maxAge) {
    stale = diff > hit.maxAge
  } else {
    stale = self[MAX_AGE] && (diff > self[MAX_AGE])
  }
  return stale
}

function trim (self) {
  if (self[LENGTH] > self[MAX]) {
    for (var walker = self[LRU_LIST].tail;
         self[LENGTH] > self[MAX] && walker !== null;) {
      // We know that we're about to delete this one, and also
      // what the next least recently used key will be, so just
      // go ahead and set it now.
      var prev = walker.prev
      del(self, walker)
      walker = prev
    }
  }
}

function del (self, node) {
  if (node) {
    var hit = node.value
    if (self[DISPOSE]) {
      self[DISPOSE](hit.key, hit.value)
    }
    self[LENGTH] -= hit.length
    self[CACHE].delete(hit.key)
    self[LRU_LIST].removeNode(node)
  }
}

// classy, since V8 prefers predictable objects.
function Entry (key, value, length, now, maxAge) {
  this.key = key
  this.value = value
  this.length = length
  this.now = now
  this.maxAge = maxAge || 0
}


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {if (process.env.npm_package_name === 'pseudomap' &&
    process.env.npm_lifecycle_script === 'test')
  process.env.TEST_PSEUDOMAP = 'true'

if (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {
  module.exports = Map
} else {
  module.exports = __webpack_require__(31)
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(9)))

/***/ }),
/* 31 */
/***/ (function(module, exports) {

var hasOwnProperty = Object.prototype.hasOwnProperty

module.exports = PseudoMap

function PseudoMap (set) {
  if (!(this instanceof PseudoMap)) // whyyyyyyy
    throw new TypeError("Constructor PseudoMap requires 'new'")

  this.clear()

  if (set) {
    if ((set instanceof PseudoMap) ||
        (typeof Map === 'function' && set instanceof Map))
      set.forEach(function (value, key) {
        this.set(key, value)
      }, this)
    else if (Array.isArray(set))
      set.forEach(function (kv) {
        this.set(kv[0], kv[1])
      }, this)
    else
      throw new TypeError('invalid argument')
  }
}

PseudoMap.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  Object.keys(this._data).forEach(function (k) {
    if (k !== 'size')
      fn.call(thisp, this._data[k].value, this._data[k].key)
  }, this)
}

PseudoMap.prototype.has = function (k) {
  return !!find(this._data, k)
}

PseudoMap.prototype.get = function (k) {
  var res = find(this._data, k)
  return res && res.value
}

PseudoMap.prototype.set = function (k, v) {
  set(this._data, k, v)
}

PseudoMap.prototype.delete = function (k) {
  var res = find(this._data, k)
  if (res) {
    delete this._data[res._index]
    this._data.size--
  }
}

PseudoMap.prototype.clear = function () {
  var data = Object.create(null)
  data.size = 0

  Object.defineProperty(this, '_data', {
    value: data,
    enumerable: false,
    configurable: true,
    writable: false
  })
}

Object.defineProperty(PseudoMap.prototype, 'size', {
  get: function () {
    return this._data.size
  },
  set: function (n) {},
  enumerable: true,
  configurable: true
})

PseudoMap.prototype.values =
PseudoMap.prototype.keys =
PseudoMap.prototype.entries = function () {
  throw new Error('iterators are not implemented in this version')
}

// Either identical, or both NaN
function same (a, b) {
  return a === b || a !== a && b !== b
}

function Entry (k, v, i) {
  this.key = k
  this.value = v
  this._index = i
}

function find (data, k) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k))
      return data[key]
  }
}

function set (data, k, v) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k)) {
      data[key].value = v
      return
    }
  }
  data.size++
  data[key] = new Entry(k, v, key)
}


/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = __webpack_require__(34);

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = __webpack_require__(35);

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(33), __webpack_require__(9)))

/***/ }),
/* 33 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 34 */
/***/ (function(module, exports) {

module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}

/***/ }),
/* 35 */
/***/ (function(module, exports) {

if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}


/***/ }),
/* 36 */
/***/ (function(module, exports) {

module.exports = Yallist

Yallist.Node = Node
Yallist.create = Yallist

function Yallist (list) {
  var self = this
  if (!(self instanceof Yallist)) {
    self = new Yallist()
  }

  self.tail = null
  self.head = null
  self.length = 0

  if (list && typeof list.forEach === 'function') {
    list.forEach(function (item) {
      self.push(item)
    })
  } else if (arguments.length > 0) {
    for (var i = 0, l = arguments.length; i < l; i++) {
      self.push(arguments[i])
    }
  }

  return self
}

Yallist.prototype.removeNode = function (node) {
  if (node.list !== this) {
    throw new Error('removing node which does not belong to this list')
  }

  var next = node.next
  var prev = node.prev

  if (next) {
    next.prev = prev
  }

  if (prev) {
    prev.next = next
  }

  if (node === this.head) {
    this.head = next
  }
  if (node === this.tail) {
    this.tail = prev
  }

  node.list.length--
  node.next = null
  node.prev = null
  node.list = null
}

Yallist.prototype.unshiftNode = function (node) {
  if (node === this.head) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var head = this.head
  node.list = this
  node.next = head
  if (head) {
    head.prev = node
  }

  this.head = node
  if (!this.tail) {
    this.tail = node
  }
  this.length++
}

Yallist.prototype.pushNode = function (node) {
  if (node === this.tail) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var tail = this.tail
  node.list = this
  node.prev = tail
  if (tail) {
    tail.next = node
  }

  this.tail = node
  if (!this.head) {
    this.head = node
  }
  this.length++
}

Yallist.prototype.push = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    push(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.unshift = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    unshift(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.pop = function () {
  if (!this.tail) {
    return undefined
  }

  var res = this.tail.value
  this.tail = this.tail.prev
  if (this.tail) {
    this.tail.next = null
  } else {
    this.head = null
  }
  this.length--
  return res
}

Yallist.prototype.shift = function () {
  if (!this.head) {
    return undefined
  }

  var res = this.head.value
  this.head = this.head.next
  if (this.head) {
    this.head.prev = null
  } else {
    this.tail = null
  }
  this.length--
  return res
}

Yallist.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.head, i = 0; walker !== null; i++) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.next
  }
}

Yallist.prototype.forEachReverse = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.prev
  }
}

Yallist.prototype.get = function (n) {
  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.next
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.getReverse = function (n) {
  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.prev
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.map = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.head; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.next
  }
  return res
}

Yallist.prototype.mapReverse = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.tail; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.prev
  }
  return res
}

Yallist.prototype.reduce = function (fn, initial) {
  var acc
  var walker = this.head
  if (arguments.length > 1) {
    acc = initial
  } else if (this.head) {
    walker = this.head.next
    acc = this.head.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = 0; walker !== null; i++) {
    acc = fn(acc, walker.value, i)
    walker = walker.next
  }

  return acc
}

Yallist.prototype.reduceReverse = function (fn, initial) {
  var acc
  var walker = this.tail
  if (arguments.length > 1) {
    acc = initial
  } else if (this.tail) {
    walker = this.tail.prev
    acc = this.tail.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = this.length - 1; walker !== null; i--) {
    acc = fn(acc, walker.value, i)
    walker = walker.prev
  }

  return acc
}

Yallist.prototype.toArray = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.head; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.next
  }
  return arr
}

Yallist.prototype.toArrayReverse = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.tail; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.prev
  }
  return arr
}

Yallist.prototype.slice = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {
    walker = walker.next
  }
  for (; walker !== null && i < to; i++, walker = walker.next) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.sliceReverse = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {
    walker = walker.prev
  }
  for (; walker !== null && i > from; i--, walker = walker.prev) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.reverse = function () {
  var head = this.head
  var tail = this.tail
  for (var walker = head; walker !== null; walker = walker.prev) {
    var p = walker.prev
    walker.prev = walker.next
    walker.next = p
  }
  this.head = tail
  this.tail = head
  return this
}

function push (self, item) {
  self.tail = new Node(item, self.tail, null, self)
  if (!self.head) {
    self.head = self.tail
  }
  self.length++
}

function unshift (self, item) {
  self.head = new Node(item, null, self.head, self)
  if (!self.tail) {
    self.tail = self.head
  }
  self.length++
}

function Node (value, prev, next, list) {
  if (!(this instanceof Node)) {
    return new Node(value, prev, next, list)
  }

  this.list = list
  this.value = value

  if (prev) {
    prev.next = this
    this.prev = prev
  } else {
    this.prev = null
  }

  if (next) {
    next.prev = this
    this.next = next
  } else {
    this.next = null
  }
}


/***/ }),
/* 37 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_37__;

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

/*!
 * Fuse.js v3.2.0 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("Fuse", [], factory);
	else if(typeof exports === 'object')
		exports["Fuse"] = factory();
	else
		root["Fuse"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 8);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
};

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var bitapRegexSearch = __webpack_require__(5);
var bitapSearch = __webpack_require__(7);
var patternAlphabet = __webpack_require__(4);

var Bitap = function () {
  function Bitap(pattern, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$isCaseSensitive = _ref.isCaseSensitive,
        isCaseSensitive = _ref$isCaseSensitive === undefined ? false : _ref$isCaseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

    _classCallCheck(this, Bitap);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: isCaseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength
    };

    this.pattern = this.options.isCaseSensitive ? pattern : pattern.toLowerCase();

    if (this.pattern.length <= maxPatternLength) {
      this.patternAlphabet = patternAlphabet(this.pattern);
    }
  }

  _createClass(Bitap, [{
    key: 'search',
    value: function search(text) {
      if (!this.options.isCaseSensitive) {
        text = text.toLowerCase();
      }

      // Exact match
      if (this.pattern === text) {
        return {
          isMatch: true,
          score: 0,
          matchedIndices: [[0, text.length - 1]]
        };
      }

      // When pattern length is greater than the machine word length, just do a a regex comparison
      var _options = this.options,
          maxPatternLength = _options.maxPatternLength,
          tokenSeparator = _options.tokenSeparator;

      if (this.pattern.length > maxPatternLength) {
        return bitapRegexSearch(text, this.pattern, tokenSeparator);
      }

      // Otherwise, use Bitap algorithm
      var _options2 = this.options,
          location = _options2.location,
          distance = _options2.distance,
          threshold = _options2.threshold,
          findAllMatches = _options2.findAllMatches,
          minMatchCharLength = _options2.minMatchCharLength;

      return bitapSearch(text, this.pattern, this.patternAlphabet, {
        location: location,
        distance: distance,
        threshold: threshold,
        findAllMatches: findAllMatches,
        minMatchCharLength: minMatchCharLength
      });
    }
  }]);

  return Bitap;
}();

// let x = new Bitap("od mn war", {})
// let result = x.search("Old Man's War")
// console.log(result)

module.exports = Bitap;

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isArray = __webpack_require__(0);

var deepValue = function deepValue(obj, path, list) {
  if (!path) {
    // If there's no path left, we've gotten to the object we care about.
    list.push(obj);
  } else {
    var dotIndex = path.indexOf('.');
    var firstSegment = path;
    var remaining = null;

    if (dotIndex !== -1) {
      firstSegment = path.slice(0, dotIndex);
      remaining = path.slice(dotIndex + 1);
    }

    var value = obj[firstSegment];

    if (value !== null && value !== undefined) {
      if (!remaining && (typeof value === 'string' || typeof value === 'number')) {
        list.push(value.toString());
      } else if (isArray(value)) {
        // Search each item in the array.
        for (var i = 0, len = value.length; i < len; i += 1) {
          deepValue(value[i], remaining, list);
        }
      } else if (remaining) {
        // An object. Recurse further.
        deepValue(value, remaining, list);
      }
    }
  }

  return list;
};

module.exports = function (obj, path) {
  return deepValue(obj, path, []);
};

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function () {
  var matchmask = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var minMatchCharLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

  var matchedIndices = [];
  var start = -1;
  var end = -1;
  var i = 0;

  for (var len = matchmask.length; i < len; i += 1) {
    var match = matchmask[i];
    if (match && start === -1) {
      start = i;
    } else if (!match && start !== -1) {
      end = i - 1;
      if (end - start + 1 >= minMatchCharLength) {
        matchedIndices.push([start, end]);
      }
      start = -1;
    }
  }

  // (i-1 - start) + 1 => i - start
  if (matchmask[i - 1] && i - start >= minMatchCharLength) {
    matchedIndices.push([start, i - 1]);
  }

  return matchedIndices;
};

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern) {
  var mask = {};
  var len = pattern.length;

  for (var i = 0; i < len; i += 1) {
    mask[pattern.charAt(i)] = 0;
  }

  for (var _i = 0; _i < len; _i += 1) {
    mask[pattern.charAt(_i)] |= 1 << len - _i - 1;
  }

  return mask;
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var SPECIAL_CHARS_REGEX = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;

module.exports = function (text, pattern) {
  var tokenSeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : / +/g;

  var regex = new RegExp(pattern.replace(SPECIAL_CHARS_REGEX, '\\$&').replace(tokenSeparator, '|'));
  var matches = text.match(regex);
  var isMatch = !!matches;
  var matchedIndices = [];

  if (isMatch) {
    for (var i = 0, matchesLen = matches.length; i < matchesLen; i += 1) {
      var match = matches[i];
      matchedIndices.push([text.indexOf(match), match.length - 1]);
    }
  }

  return {
    // TODO: revisit this score
    score: isMatch ? 0.5 : 1,
    isMatch: isMatch,
    matchedIndices: matchedIndices
  };
};

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern, _ref) {
  var _ref$errors = _ref.errors,
      errors = _ref$errors === undefined ? 0 : _ref$errors,
      _ref$currentLocation = _ref.currentLocation,
      currentLocation = _ref$currentLocation === undefined ? 0 : _ref$currentLocation,
      _ref$expectedLocation = _ref.expectedLocation,
      expectedLocation = _ref$expectedLocation === undefined ? 0 : _ref$expectedLocation,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance;

  var accuracy = errors / pattern.length;
  var proximity = Math.abs(expectedLocation - currentLocation);

  if (!distance) {
    // Dodge divide by zero error.
    return proximity ? 1.0 : accuracy;
  }

  return accuracy + proximity / distance;
};

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bitapScore = __webpack_require__(6);
var matchedIndices = __webpack_require__(3);

module.exports = function (text, pattern, patternAlphabet, _ref) {
  var _ref$location = _ref.location,
      location = _ref$location === undefined ? 0 : _ref$location,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance,
      _ref$threshold = _ref.threshold,
      threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
      _ref$findAllMatches = _ref.findAllMatches,
      findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
      _ref$minMatchCharLeng = _ref.minMatchCharLength,
      minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

  var expectedLocation = location;
  // Set starting location at beginning text and initialize the alphabet.
  var textLen = text.length;
  // Highest score beyond which we give up.
  var currentThreshold = threshold;
  // Is there a nearby exact match? (speedup)
  var bestLocation = text.indexOf(pattern, expectedLocation);

  var patternLen = pattern.length;

  // a mask of the matches
  var matchMask = [];
  for (var i = 0; i < textLen; i += 1) {
    matchMask[i] = 0;
  }

  if (bestLocation !== -1) {
    var score = bitapScore(pattern, {
      errors: 0,
      currentLocation: bestLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });
    currentThreshold = Math.min(score, currentThreshold);

    // What about in the other direction? (speed up)
    bestLocation = text.lastIndexOf(pattern, expectedLocation + patternLen);

    if (bestLocation !== -1) {
      var _score = bitapScore(pattern, {
        errors: 0,
        currentLocation: bestLocation,
        expectedLocation: expectedLocation,
        distance: distance
      });
      currentThreshold = Math.min(_score, currentThreshold);
    }
  }

  // Reset the best location
  bestLocation = -1;

  var lastBitArr = [];
  var finalScore = 1;
  var binMax = patternLen + textLen;

  var mask = 1 << patternLen - 1;

  for (var _i = 0; _i < patternLen; _i += 1) {
    // Scan for the best match; each iteration allows for one more error.
    // Run a binary search to determine how far from the match location we can stray
    // at this error level.
    var binMin = 0;
    var binMid = binMax;

    while (binMin < binMid) {
      var _score3 = bitapScore(pattern, {
        errors: _i,
        currentLocation: expectedLocation + binMid,
        expectedLocation: expectedLocation,
        distance: distance
      });

      if (_score3 <= currentThreshold) {
        binMin = binMid;
      } else {
        binMax = binMid;
      }

      binMid = Math.floor((binMax - binMin) / 2 + binMin);
    }

    // Use the result from this iteration as the maximum for the next.
    binMax = binMid;

    var start = Math.max(1, expectedLocation - binMid + 1);
    var finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;

    // Initialize the bit array
    var bitArr = Array(finish + 2);

    bitArr[finish + 1] = (1 << _i) - 1;

    for (var j = finish; j >= start; j -= 1) {
      var currentLocation = j - 1;
      var charMatch = patternAlphabet[text.charAt(currentLocation)];

      if (charMatch) {
        matchMask[currentLocation] = 1;
      }

      // First pass: exact match
      bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;

      // Subsequent passes: fuzzy match
      if (_i !== 0) {
        bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
      }

      if (bitArr[j] & mask) {
        finalScore = bitapScore(pattern, {
          errors: _i,
          currentLocation: currentLocation,
          expectedLocation: expectedLocation,
          distance: distance
        });

        // This match will almost certainly be better than any existing match.
        // But check anyway.
        if (finalScore <= currentThreshold) {
          // Indeed it is
          currentThreshold = finalScore;
          bestLocation = currentLocation;

          // Already passed `loc`, downhill from here on in.
          if (bestLocation <= expectedLocation) {
            break;
          }

          // When passing `bestLocation`, don't exceed our current distance from `expectedLocation`.
          start = Math.max(1, 2 * expectedLocation - bestLocation);
        }
      }
    }

    // No hope for a (better) match at greater error levels.
    var _score2 = bitapScore(pattern, {
      errors: _i + 1,
      currentLocation: expectedLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });

    if (_score2 > currentThreshold) {
      break;
    }

    lastBitArr = bitArr;
  }

  // Count exact matches (those with a score of 0) to be "almost" exact
  return {
    isMatch: bestLocation >= 0,
    score: finalScore === 0 ? 0.001 : finalScore,
    matchedIndices: matchedIndices(matchMask, minMatchCharLength)
  };
};

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Bitap = __webpack_require__(1);
var deepValue = __webpack_require__(2);
var isArray = __webpack_require__(0);

var Fuse = function () {
  function Fuse(list, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$caseSensitive = _ref.caseSensitive,
        caseSensitive = _ref$caseSensitive === undefined ? false : _ref$caseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng,
        _ref$id = _ref.id,
        id = _ref$id === undefined ? null : _ref$id,
        _ref$keys = _ref.keys,
        keys = _ref$keys === undefined ? [] : _ref$keys,
        _ref$shouldSort = _ref.shouldSort,
        shouldSort = _ref$shouldSort === undefined ? true : _ref$shouldSort,
        _ref$getFn = _ref.getFn,
        getFn = _ref$getFn === undefined ? deepValue : _ref$getFn,
        _ref$sortFn = _ref.sortFn,
        sortFn = _ref$sortFn === undefined ? function (a, b) {
      return a.score - b.score;
    } : _ref$sortFn,
        _ref$tokenize = _ref.tokenize,
        tokenize = _ref$tokenize === undefined ? false : _ref$tokenize,
        _ref$matchAllTokens = _ref.matchAllTokens,
        matchAllTokens = _ref$matchAllTokens === undefined ? false : _ref$matchAllTokens,
        _ref$includeMatches = _ref.includeMatches,
        includeMatches = _ref$includeMatches === undefined ? false : _ref$includeMatches,
        _ref$includeScore = _ref.includeScore,
        includeScore = _ref$includeScore === undefined ? false : _ref$includeScore,
        _ref$verbose = _ref.verbose,
        verbose = _ref$verbose === undefined ? false : _ref$verbose;

    _classCallCheck(this, Fuse);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: caseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength,
      id: id,
      keys: keys,
      includeMatches: includeMatches,
      includeScore: includeScore,
      shouldSort: shouldSort,
      getFn: getFn,
      sortFn: sortFn,
      verbose: verbose,
      tokenize: tokenize,
      matchAllTokens: matchAllTokens
    };

    this.setCollection(list);
  }

  _createClass(Fuse, [{
    key: 'setCollection',
    value: function setCollection(list) {
      this.list = list;
      return list;
    }
  }, {
    key: 'search',
    value: function search(pattern) {
      this._log('---------\nSearch pattern: "' + pattern + '"');

      var _prepareSearchers2 = this._prepareSearchers(pattern),
          tokenSearchers = _prepareSearchers2.tokenSearchers,
          fullSearcher = _prepareSearchers2.fullSearcher;

      var _search2 = this._search(tokenSearchers, fullSearcher),
          weights = _search2.weights,
          results = _search2.results;

      this._computeScore(weights, results);

      if (this.options.shouldSort) {
        this._sort(results);
      }

      return this._format(results);
    }
  }, {
    key: '_prepareSearchers',
    value: function _prepareSearchers() {
      var pattern = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var tokenSearchers = [];

      if (this.options.tokenize) {
        // Tokenize on the separator
        var tokens = pattern.split(this.options.tokenSeparator);
        for (var i = 0, len = tokens.length; i < len; i += 1) {
          tokenSearchers.push(new Bitap(tokens[i], this.options));
        }
      }

      var fullSearcher = new Bitap(pattern, this.options);

      return { tokenSearchers: tokenSearchers, fullSearcher: fullSearcher };
    }
  }, {
    key: '_search',
    value: function _search() {
      var tokenSearchers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var fullSearcher = arguments[1];

      var list = this.list;
      var resultMap = {};
      var results = [];

      // Check the first item in the list, if it's a string, then we assume
      // that every item in the list is also a string, and thus it's a flattened array.
      if (typeof list[0] === 'string') {
        // Iterate over every item
        for (var i = 0, len = list.length; i < len; i += 1) {
          this._analyze({
            key: '',
            value: list[i],
            record: i,
            index: i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }

        return { weights: null, results: results };
      }

      // Otherwise, the first item is an Object (hopefully), and thus the searching
      // is done on the values of the keys of each item.
      var weights = {};
      for (var _i = 0, _len = list.length; _i < _len; _i += 1) {
        var item = list[_i];
        // Iterate over every key
        for (var j = 0, keysLen = this.options.keys.length; j < keysLen; j += 1) {
          var key = this.options.keys[j];
          if (typeof key !== 'string') {
            weights[key.name] = {
              weight: 1 - key.weight || 1
            };
            if (key.weight <= 0 || key.weight > 1) {
              throw new Error('Key weight has to be > 0 and <= 1');
            }
            key = key.name;
          } else {
            weights[key] = {
              weight: 1
            };
          }

          this._analyze({
            key: key,
            value: this.options.getFn(item, key),
            record: item,
            index: _i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }

      return { weights: weights, results: results };
    }
  }, {
    key: '_analyze',
    value: function _analyze(_ref2, _ref3) {
      var key = _ref2.key,
          _ref2$arrayIndex = _ref2.arrayIndex,
          arrayIndex = _ref2$arrayIndex === undefined ? -1 : _ref2$arrayIndex,
          value = _ref2.value,
          record = _ref2.record,
          index = _ref2.index;
      var _ref3$tokenSearchers = _ref3.tokenSearchers,
          tokenSearchers = _ref3$tokenSearchers === undefined ? [] : _ref3$tokenSearchers,
          _ref3$fullSearcher = _ref3.fullSearcher,
          fullSearcher = _ref3$fullSearcher === undefined ? [] : _ref3$fullSearcher,
          _ref3$resultMap = _ref3.resultMap,
          resultMap = _ref3$resultMap === undefined ? {} : _ref3$resultMap,
          _ref3$results = _ref3.results,
          results = _ref3$results === undefined ? [] : _ref3$results;

      // Check if the texvaluet can be searched
      if (value === undefined || value === null) {
        return;
      }

      var exists = false;
      var averageScore = -1;
      var numTextMatches = 0;

      if (typeof value === 'string') {
        this._log('\nKey: ' + (key === '' ? '-' : key));

        var mainSearchResult = fullSearcher.search(value);
        this._log('Full text: "' + value + '", score: ' + mainSearchResult.score);

        if (this.options.tokenize) {
          var words = value.split(this.options.tokenSeparator);
          var scores = [];

          for (var i = 0; i < tokenSearchers.length; i += 1) {
            var tokenSearcher = tokenSearchers[i];

            this._log('\nPattern: "' + tokenSearcher.pattern + '"');

            // let tokenScores = []
            var hasMatchInText = false;

            for (var j = 0; j < words.length; j += 1) {
              var word = words[j];
              var tokenSearchResult = tokenSearcher.search(word);
              var obj = {};
              if (tokenSearchResult.isMatch) {
                obj[word] = tokenSearchResult.score;
                exists = true;
                hasMatchInText = true;
                scores.push(tokenSearchResult.score);
              } else {
                obj[word] = 1;
                if (!this.options.matchAllTokens) {
                  scores.push(1);
                }
              }
              this._log('Token: "' + word + '", score: ' + obj[word]);
              // tokenScores.push(obj)
            }

            if (hasMatchInText) {
              numTextMatches += 1;
            }
          }

          averageScore = scores[0];
          var scoresLen = scores.length;
          for (var _i2 = 1; _i2 < scoresLen; _i2 += 1) {
            averageScore += scores[_i2];
          }
          averageScore = averageScore / scoresLen;

          this._log('Token score average:', averageScore);
        }

        var finalScore = mainSearchResult.score;
        if (averageScore > -1) {
          finalScore = (finalScore + averageScore) / 2;
        }

        this._log('Score average:', finalScore);

        var checkTextMatches = this.options.tokenize && this.options.matchAllTokens ? numTextMatches >= tokenSearchers.length : true;

        this._log('\nCheck Matches: ' + checkTextMatches);

        // If a match is found, add the item to <rawResults>, including its score
        if ((exists || mainSearchResult.isMatch) && checkTextMatches) {
          // Check if the item already exists in our results
          var existingResult = resultMap[index];
          if (existingResult) {
            // Use the lowest score
            // existingResult.score, bitapResult.score
            existingResult.output.push({
              key: key,
              arrayIndex: arrayIndex,
              value: value,
              score: finalScore,
              matchedIndices: mainSearchResult.matchedIndices
            });
          } else {
            // Add it to the raw result list
            resultMap[index] = {
              item: record,
              output: [{
                key: key,
                arrayIndex: arrayIndex,
                value: value,
                score: finalScore,
                matchedIndices: mainSearchResult.matchedIndices
              }]
            };

            results.push(resultMap[index]);
          }
        }
      } else if (isArray(value)) {
        for (var _i3 = 0, len = value.length; _i3 < len; _i3 += 1) {
          this._analyze({
            key: key,
            arrayIndex: _i3,
            value: value[_i3],
            record: record,
            index: index
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }
    }
  }, {
    key: '_computeScore',
    value: function _computeScore(weights, results) {
      this._log('\n\nComputing score:\n');

      for (var i = 0, len = results.length; i < len; i += 1) {
        var output = results[i].output;
        var scoreLen = output.length;

        var totalScore = 0;
        var bestScore = 1;

        for (var j = 0; j < scoreLen; j += 1) {
          var weight = weights ? weights[output[j].key].weight : 1;
          var score = weight === 1 ? output[j].score : output[j].score || 0.001;
          var nScore = score * weight;

          if (weight !== 1) {
            bestScore = Math.min(bestScore, nScore);
          } else {
            output[j].nScore = nScore;
            totalScore += nScore;
          }
        }

        results[i].score = bestScore === 1 ? totalScore / scoreLen : bestScore;

        this._log(results[i]);
      }
    }
  }, {
    key: '_sort',
    value: function _sort(results) {
      this._log('\n\nSorting....');
      results.sort(this.options.sortFn);
    }
  }, {
    key: '_format',
    value: function _format(results) {
      var finalOutput = [];

      this._log('\n\nOutput:\n\n', JSON.stringify(results));

      var transformers = [];

      if (this.options.includeMatches) {
        transformers.push(function (result, data) {
          var output = result.output;
          data.matches = [];

          for (var i = 0, len = output.length; i < len; i += 1) {
            var item = output[i];

            if (item.matchedIndices.length === 0) {
              continue;
            }

            var obj = {
              indices: item.matchedIndices,
              value: item.value
            };
            if (item.key) {
              obj.key = item.key;
            }
            if (item.hasOwnProperty('arrayIndex') && item.arrayIndex > -1) {
              obj.arrayIndex = item.arrayIndex;
            }
            data.matches.push(obj);
          }
        });
      }

      if (this.options.includeScore) {
        transformers.push(function (result, data) {
          data.score = result.score;
        });
      }

      for (var i = 0, len = results.length; i < len; i += 1) {
        var result = results[i];

        if (this.options.id) {
          result.item = this.options.getFn(result.item, this.options.id)[0];
        }

        if (!transformers.length) {
          finalOutput.push(result.item);
          continue;
        }

        var data = {
          item: result.item
        };

        for (var j = 0, _len2 = transformers.length; j < _len2; j += 1) {
          transformers[j](result, data);
        }

        finalOutput.push(data);
      }

      return finalOutput;
    }
  }, {
    key: '_log',
    value: function _log() {
      if (this.options.verbose) {
        var _console;

        (_console = console).log.apply(_console, arguments);
      }
    }
  }]);

  return Fuse;
}();

module.exports = Fuse;

/***/ })
/******/ ]);
});
//# sourceMappingURL=fuse.js.map

/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    /**
     * Stores user search results for the server-users-supplier
     */
    // TODO CONFSRVDEV-2015 - shouldn't store the same User object more than once. Should only store lists of keys in the query map,
    // and then have a separate cross-supplier Map of User objects by key. dT
    var cache = {};
    var queries = [];

    exports.default = function (limit) {
        return {
            add: function add(query, users) {
                cache[query] = {
                    query: query,
                    users: users,
                    isExhausted: users.length < limit
                };

                // Queries list is alph sorted descending so that longer queries are above the shorter queries that
                // they contain.
                queries.push(query);
                queries.sort();
                queries.reverse();
            },

            /**
             * Look in the cache for this query or a shorter one.
             */
            getClosest: function getClosest(query) {
                if (cache[query]) {
                    return cache[query];
                }

                // Else find the longest matching substring of the query.
                // The query list is sorted, so the first item found should be the longest one.
                var queryMatch = queries.find(function (subquery) {
                    return query.indexOf(subquery) === 0;
                });
                if (queryMatch) {
                    return cache[queryMatch];
                }

                return null; // just to make this obvious...
            },

            // Used in tests.
            reset: function reset() {
                cache = {};
                queries = [];
            }
        };
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function escape(query) {
        return [].map.call(query, function escapeSpecialCharacter(char) {
            if (char === '+' || char === '-' || char === '&' || char === '|' || char === '!' || char === '(' || char === ')' || char === '{' || char === '}' || char === '[' || char === ']' || char === '^' || char === '"' || char === '~' || char === '*' || char === '?' || char === ':' || char === '\\') return '\\' + char;
            return char;
        }).join('');
    }

    exports.default = {
        escape: escape
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _userSupplierKeys) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function getCurrentUser() {
        return new Promise(function (resolve) {

            var username = Meta.get('remote-user');
            if (!username) {
                // Anonymous user.
                return resolve();
            }

            var userKey = Meta.get('remote-user-key');
            var displayName = Meta.get('current-user-fullname');
            var path = Meta.get('current-user-avatar-uri-reference');

            resolve({
                type: "known",
                username: username,
                userKey: userKey,
                profilePicture: {
                    path: path,
                    width: 48,
                    height: 48
                },
                displayName: displayName,
                supplier: UserSupplier.CURRENT
            });
        });
    }

    exports.default = {
        getCurrentUser: getCurrentUser
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(16), __webpack_require__(43), __webpack_require__(12), __webpack_require__(44), __webpack_require__(15), __webpack_require__(46), __webpack_require__(47), __webpack_require__(48), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _templates, _resultPlaceholder, _userRanker, _userConverter, _utils, _defaultOrdering, _scoreLogger, _defaultFiltering, _scoreBooster) {
    'use strict';

    var Templates = _interopRequireDefault(_templates).default;

    var ResultPlaceholder = _interopRequireDefault(_resultPlaceholder).default;

    var SearchUsers = _interopRequireDefault(_userRanker).default;

    var ConvertUsers = _interopRequireDefault(_userConverter).default;

    var RenderUtils = _interopRequireDefault(_utils).default;

    var ensureDefaultOrder = _interopRequireDefault(_defaultOrdering).default;

    var scoreLogger = _interopRequireDefault(_scoreLogger).default;

    var filterServerResults = _interopRequireDefault(_defaultFiltering).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   * The contents of the UserCache is passed through the user pipeline which filters, ranks and modifies
                   * the list until we arrive at the final 5 elements to display.
                   *
                   * Want To add another function to the user pipeline? Easy...
                   *
                   * Define a function like the following and add it to a pipeline. Ordering is very important.
                   *
                   * @param results   The results array as supplied by the previous function
                   * @param next      Call this function and pass some results to trigger the next stage of the pipeline
                   * @param context   Some context about the current rendering request. See Mentions.js
                   *
                   * function pipelineTransformation(results, next, context) {
                   *      //Do some things on results
                   *      results.forEach((results) => transform(result))
                   *
                   *      //Remember to call next
                   *      next(results);
                   * }
                   */

    function filterUsingQuery(results, next, context) {
        next(SearchUsers(results, context.query));
    }

    function moveSelectedUserToTop(oldUsers, next, context) {
        if (!context.selectedUser) {
            return next(oldUsers);
        }

        var index = oldUsers.findIndex(function (user) {
            return user.username === context.selectedUser.username;
        });
        // Note that > -1 means that the user IS in the array. If index is 0, the user is already in the correct position
        // at the start of the array and there is nothing to do.
        if (index <= 0) {
            return next(oldUsers);
        }

        // Put this user at the start of the array.
        var user = oldUsers[index];
        var newUsers = oldUsers.slice(0); // clone the array to avoid modifying the original
        newUsers.splice(index, 1);
        newUsers.unshift(user);

        return next(newUsers);
    }

    /**
     * fuseScore is available on all user results for a query-term search, so we can sort at any point in the pipeline.
     */
    function sortOnScore(users, next) {
        if (users.length && typeof users[0].fuseScore === 'number') {
            // If the first result has a fuseScore they all will.
            users.sort(function (user1, user2) {
                return user1.fuseScore - user2.fuseScore;
            });
        }
        next(users);
    }

    function limit(array, next, context) {
        next(array.slice(0, context.DISPLAY_LIMIT));
    }

    // Called in the Server pipeline when there are no results.
    function userNotFound(results, next) {
        if (!results.length) {
            var notFoundResult = RenderUtils.resultWithHtml(Templates.Mentions.userNotFoundResult());
            results = [notFoundResult];
        }

        next(results);
    }

    function empty(results, next) {
        if (!results.length) {
            next([RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder())]);
        } else {
            next(results);
        }
    }

    function addErrorResult(results, next) {
        var failureResult = RenderUtils.resultWithHtml(Templates.Mentions.searchFailureResult());
        next([failureResult]);
    }

    /**
     * This function convert Users from API format to something that the Dropdown can display.
     *
     * All elements in the results array should be Users in API format.
     * If you want to add other elements to the results array, do this *after* convertUsers in the pipeline
     *
     * @param results
     * @param next
     */
    function convertUsers(results, next) {
        next(ConvertUsers(results));
    }

    // Don't continue the render if the query is stale.
    function staleServerResponseFilter(results, next, context) {
        if (context.latestQuery === context.query) {
            next(results);
        }
    }

    exports.default = {

        default: function _default(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterServerResults, ensureDefaultOrder, limit, ScoreBooster.setSuggestedUsers, convertUsers, renderCallback];
        },

        client: function client(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, convertUsers, ResultPlaceholder.startTimeout, empty, renderCallback];
        },
        server: function server(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, staleServerResponseFilter, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, scoreLogger, convertUsers, userNotFound, renderCallback];
        },

        error: function error(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, addErrorResult, renderCallback];
        },

        _functions: {
            moveSelectedUserToTop: moveSelectedUserToTop,
            sortOnScore: sortOnScore
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(15), __webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _utils, _templates) {
    'use strict';

    var RenderUtils = _interopRequireDefault(_utils).default;

    var Templates = _interopRequireDefault(_templates).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var displayTimeout = void 0;

    function _padResults(results, context) {
        var additionalElements = context.DISPLAY_LIMIT - results.length;
        if (additionalElements > 0) {
            var placeholder = RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder());
            for (var index = 0; index < additionalElements; index++) {
                results.push(placeholder);
            }
        }
        return results;
    }

    function startTimeout(results, next, context) {
        displayTimeout = setTimeout(function () {
            results = _padResults(results, context);
            next(results);
        }, window.skeletonPlaceholder || 3000); // CONFSRVDEV-3833 Remove once an appropriate value has been found.
        next(results);
    }

    function cancelTimeout(results, next) {
        clearTimeout(displayTimeout);
        next(results);
    }

    exports.default = {
        startTimeout: startTimeout,
        cancelTimeout: cancelTimeout
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(8), __webpack_require__(1), __webpack_require__(45)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _i18n, _userSupplierKeys, _darkFeatures) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var I18n = _interopRequireDefault(_i18n).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var DarkFeatures = _interopRequireDefault(_darkFeatures).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Converts Users from API format to something that the Dropdown can display.
     */
    var contextPath = Meta.get('context-path');

    function getProfilePicture(user) {
        if (user && user.profilePicture && Meta.get('can-view-profile')) {
            // HACK - work around CONFSRVDEV-2936 by removing the dud context-path from the path.
            return user.profilePicture.path.replace('/_' + contextPath, '/_');
        }
        return contextPath + '/images/icons/profilepics/anonymous.svg';
    }

    var converter = function converter(users) {
        var addRecentLozenge = DarkFeatures.isEnabled('smart.mentions.recent.lozenge');
        var linkBase = Meta.get('base-url') + '/display/~';

        return users.map(function (user) {
            var link = linkBase + user.username;

            var lozenge = user.supplier === UserSupplier.RELATED && user.role && user.role.i18n;

            if (!lozenge && addRecentLozenge) {
                // Including a lozenge for Recent helps us see why an item is promoted, but make it opt-in.
                lozenge = user.supplier === UserSupplier.RECENT && I18n('user.supplier.recent');
            }
            // Uncomment this line to see why the results are in the order they are.
            // const lozenge = "" + user.fuseScore;

            return {
                className: 'insert-mentions-dropdown-option',
                name: user.displayName,
                username: user.username,
                href: link, // only used if the user tries to middle-click/open-in-new-tab the dropdown item
                icon: getProfilePicture(user),
                lozenge: lozenge,
                link: link,
                model: user,
                fuseMatches: user.fuseMatches
            };
        });
    };

    // Available for unit testing.
    converter._getProfilePicture = getProfilePicture;

    exports.default = converter;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 45 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_45__;

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _recentUsersSupplier) {
    "use strict";

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
        return typeof obj;
    } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    var supplierToScoreMap = {
        "current": 1,
        "recent": 2,
        "related": {
            "creator": 3,
            "contributor": 4,
            "commenter": 5
        },
        "server": 6
    };

    var MAX_SCORE = 100;

    function scoreUser(user) {
        var potentialScore = supplierToScoreMap[user.supplier];

        if (typeof potentialScore === "number") {
            if (typeof user.sortIndex === "number") {
                // This allows us to sort recent users coming out of the cache. The highest calculated score will be just < 3.
                potentialScore += user.sortIndex / (RecentUsers.RECENT_USER_LIMIT + 1);
            }
            return potentialScore;
        }

        // Not a number, probably another object, index into it with role
        // Otherwise, it might have been undefined
        return (typeof potentialScore === "undefined" ? "undefined" : _typeof(potentialScore)) === "object" ? potentialScore[user.role.role] : MAX_SCORE;
    }

    function ensureDefaultOrder(results, next) {
        var sorted = results.sort(function (user1, user2) {
            return scoreUser(user1) - scoreUser(user2);
        });
        next(sorted);
    }

    exports.default = ensureDefaultOrder;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    "use strict";

    exports.default = logScores;

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Just used during development, logs result score information to help us figure out reasons for result order.
     */
    function logScores(results, next, context) {
        if (context.query) {
            AJS.debug("*** Mentions *** user-pipeline/logger: Logging search results for " + context.query);

            results.forEach(function (user) {
                AJS.debug("*** Mentions *** user-pipeline/logger: " + user.displayName + " has a score of " + user.fuseScore);
            });
        }

        next(results);
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    "use strict";

    var DEFAULT_SUPPLIERS = [_userSupplierKeys.RECENT, _userSupplierKeys.CURRENT, _userSupplierKeys.RELATED];

    function filterServerResults(results, next) {
        var filteredUsers = results.filter(function (user) {
            return DEFAULT_SUPPLIERS.indexOf(user.supplier) !== -1;
        });
        next(filteredUsers);
    }

    exports.default = filterServerResults;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function PipelineExecutor(pipeline, context) {
        this.pipeline = pipeline;
        this.context = context;
    }

    PipelineExecutor.prototype.execute = function (input) {
        this._next(0, input);
    };

    PipelineExecutor.prototype._next = function (index, results) {
        this.pipeline[index](results, this._next.bind(this, index + 1), this.context);
    };

    exports.default = PipelineExecutor;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(51), __webpack_require__(18)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _analyticsSupport, _autocompleteManager) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Analytics = _interopRequireDefault(_analyticsSupport).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function publishEventForSelection(user) {
        var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        var idd = typeof AutocompleteManager.getInputDrivenDropdown === 'function' && AutocompleteManager.getInputDrivenDropdown();
        if (!idd || !user) {
            AJS.debug("Cannot publish 'confluence.mention.selection' analytics with missing dropdown, user or context.");
            return;
        }

        var query = idd._value || '';
        var dd = idd.dd;
        var index = dd && typeof dd.getFocusIndex === 'function' && dd.getFocusIndex();

        var analyticsData = {
            source: user.model.supplier,
            queryLength: query.length,
            queryWords: query.split(' ').length,
            index: index,
            numberOfSearches: context.numGetDataAndRunCallbackCalls
        };

        // By publishing the supplier source of the selected User, we can determine whether users are finding
        // the users they need from the Smart mentions or whether they still have to wait for the Dumb (server)
        // ones.
        Analytics.publish('confluence.mention.selection', analyticsData);
        AJS.debug("Published 'confluence.mention.selection' event with supplier: " + user.model.supplier);
    }

    /**
     * Updates the state of the current Mention interaction.
     * @param autoCompleteControl
     */
    function updateSession(autoCompleteControl) {
        autoCompleteControl.analytics = Object.assign({
            numGetDataAndRunCallbackCalls: 0
        }, autoCompleteControl.analytics);

        autoCompleteControl.analytics.numGetDataAndRunCallbackCalls += 1;
    }

    exports.default = {
        updateSession: updateSession,
        publishEventForSelection: publishEventForSelection
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_51__;

/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_52__;

/***/ }),
/* 53 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_53__;

/***/ })
/******/ ])});;
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js/smart-mentions-init.js' */
require([
    'confluence-editor/loader/tinymce-bootstrap',
    'confluence-mentions'
], function (BootstrapManager,
             Mentions) {
    // Main entry point to Smart Mentions logic. To lower page weight, we could potentially pull in the Mentions
    // bundle.js via a WRM.require on the bootstrap init.
    BootstrapManager.addOnInitCallback(Mentions.init);
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:macro-analytics-bundle', location = 'frontend/bundles/macro-analytics.bundle.js' */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="http://localhost:8080/target/classes/frontend/bundles",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n={reportMacroInserted:function(e){var t=this.buildAnalyticData("Macro-Inserted",e);return this.reportAnalyticsToBackend(t)},reportMacroEdited:function(e){var t=this.buildAnalyticData("Macro-Edited",e);return this.reportAnalyticsToBackend(t)},reportMacrosDeleted:function(e){var t=this,r=(Array.isArray(e)?e:[e]).map(function(e){return t.buildAnalyticData("Macro-Deleted",e)});return this.reportAnalyticsToBackend(r)},buildAnalyticData:function(e,t){return{eventType:[e],spaceKey:[AJS.params.spaceKey],pageId:[AJS.params.pageId],macroName:[t]}},reportAnalyticsToBackend:function(e){var t=Array.isArray(e)?e:[e];return $.ajax({type:"POST",contentType:"application/json",async:!0,url:AJS.params.baseUrl+"/plugins/servlet/cfm/analytics/macro-usage",data:JSON.stringify(t)}).error(function(){})}};var a="com.adaptavist.confluence.contentFormattingMacros",o=function(e,t){for(var r=[],n=i(),a=e(),o=0;o<a.length;o++){var c=t(a[o]),u=n.filter(function(e){return e.macroName===c});1===u.length&&r.push(u[0])}return r};function i(){return AJS.MacroBrowser.metadataList.filter(function(e){return e.pluginKey===a})}var c=function(){return $("#wysiwygTextarea_ifr")[0].contentWindow.getSelection().getRangeAt(0).cloneContents().querySelectorAll("table.wysiwyg-macro, img.editor-inline-macro")},u=function(e){return e.dataset.macroName},s=function(){return $('div.aui-dropdown ol li.active a[class^="autocomplete-macro"]')},d=function(e){var t=$(e).attr("class");return t.substring("autocomplete-macro-".length+t.indexOf("autocomplete-macro-"))},l=function(){return $("div#macro-insert-container input.macro-name")},f=function(){return $("#avst-custom-dialog-macro-name")},p=function(e){return e.value},m=function(e,t){if("Insert"===e){var r=o(l,p);n.reportMacroInserted(r[0].macroName)}else if("InsertCustomDialog"===e){var a=o(f,p);n.reportMacroInserted(a[0].macroName)}else if("Save"===e){var i=o(c,u);n.reportMacroEdited(i[0].macroName)}else if("SaveCustomDialog"===e){var s=o(function(){return t},function(){return t.find("#avst-custom-dialog-macro-name").attr("value")});n.reportMacroEdited(s[0].macroName)}},v=function(e){if($(e.target).is('a[class*="autocomplete-macro"] span:first-child')){var t=o(s,d);if(!t.length)return;var r=t[0];r.anyParameterRequired||n.reportMacroInserted(r.macroName)}},g=function(e){var t=e.target;if(13===e.keyCode){var r=t.matches("div.macro-input-fields form div.macro-param-div .macro-param-input"),n="submit"===t.type,a=$("#macro-details-page").is(":visible")&&1===$("#macro-details-page").find(".button-panel-button.ok").size();if(!n&&(r||a)){var o=$("div#macro-details-page div.dialog-button-panel button.button-panel-button.ok")[0];m(o.innerText)}}},y=function(){var e=$(".macro-placeholder-property-panel-remove-button"),t=o(c,u);e.size()>0&&e.one("click.removeMacro",function(){n.reportMacrosDeleted([t[0].macroName])})},b=function(e){if(46===e.keyCode||8===e.keyCode){var t=o(c,u);if(!t||!t[0])return;var r=t.map(function(e){return e.macroName});n.reportMacrosDeleted(r)}else if(13===e.keyCode){if($("#autocomplete-dropdown li.active").size()){var a=$("#autocomplete-dropdown li.active").text(),s=(d=a,i().find(function(e){return e.title===d}));s&&!s.anyParameterRequired&&n.reportMacroInserted(s.macroName)}}var d},h=function(e,t){var r=e.target;if(function(e){return e.matches("#buttongroup-dialog #insertButtonGroup")}(r)){var n=r.innerText;m(n+"CustomDialog",t)}else m(e.target.innerText)};function k(e,t,r,n,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,a)}function w(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){k(o,n,a,i,c,"next",e)}function c(e){k(o,n,a,i,c,"throw",e)}i(void 0)})}}function x(){var e;$("#editPageLink").off("click.enterEditMode",x),document.addEventListener("click",y,!0),document.addEventListener("click",v,!0),document.addEventListener("keydown",g,!0),function e(t,r){var n=$(t);if(n.size())return n.ready(function(){r(n)});window.requestAnimationFrame(function(){return e(t,r)})}("#wysiwygTextarea_ifr",function(e){(e.get(0).contentDocument||e.get(0).contentWindow.document).addEventListener("keydown",b,!0)}),e=function(e){e.find(".button-panel-button.ok")[0].addEventListener("click",h(event,e),!0)},document.addEventListener("click",function(){var t=$("#buttongroup-dialog").size()?$("#buttongroup-dialog"):$("#macro-details-page");t.size()&&"hiddenButton"!==event.target.id&&e(t)},!0)}function M(e){return A.apply(this,arguments)}function A(){return(A=w(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){setTimeout(e,t)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=w(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=10,r=0;case 2:if(!(r<t)){e.next=10;break}if(void 0===AJS.Editor){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:return e.next=7,M(1e3);case 7:r++,e.next=2;break;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}AJS.toInit(function(){w(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S();case 3:AJS.Editor.isVisible()?x():$("#editPageLink").on("click.enterEditMode",x),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}))()})}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'soy/common.soy' */
// This file was automatically generated from common.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ContentFormatting.Macro.Common.
 */

if (typeof ContentFormatting == 'undefined') { var ContentFormatting = {}; }
if (typeof ContentFormatting.Macro == 'undefined') { ContentFormatting.Macro = {}; }
if (typeof ContentFormatting.Macro.Common == 'undefined') { ContentFormatting.Macro.Common = {}; }


ContentFormatting.Macro.Common.requiredIcon = function(opt_data, opt_ignored) {
  return '<span class="aui-icon icon-required icon-required-moved"> required</span>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.requiredIcon.soyTemplateName = 'ContentFormatting.Macro.Common.requiredIcon';
}


ContentFormatting.Macro.Common.descriptionDesc = function(opt_data, opt_ignored) {
  return '<div class="description">' + soy.$$escapeHtml('Displayed below the field') + '</div>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.descriptionDesc.soyTemplateName = 'ContentFormatting.Macro.Common.descriptionDesc';
}


ContentFormatting.Macro.Common.velocityValueLink = function(opt_data, opt_ignored) {
  return '' + soy.$$escapeHtml('ID (relating to data attribute)');
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.velocityValueLink.soyTemplateName = 'ContentFormatting.Macro.Common.velocityValueLink';
}


ContentFormatting.Macro.Common.footerContent = function(opt_data, opt_ignored) {
  return '<div class="custom-macro-footer"><div class="aui-group aui-group-split"><div class="aui-item"><a class="" href="' + soy.$$escapeHtml(opt_data.docHrefHtml) + '" target="_blank">' + soy.$$escapeHtml('Documentation') + '</a></div><div class="aui-item"><button class="aui-button aui-button-primary button-panel-button ok" id="insertButtonGroup" type="submit">' + soy.$$escapeHtml(opt_data.buttonTitle) + '</button><a class="aui-button aui-button-link" href="#" id="cancelButtonGroup">' + soy.$$escapeHtml('Cancel') + '</a></div></div></div>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.footerContent.soyTemplateName = 'ContentFormatting.Macro.Common.footerContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'soy/rest-table-macro.soy' */
// This file was automatically generated from rest-table-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ContentFormatting.Macro.RestTable.
 */

if (typeof ContentFormatting == 'undefined') { var ContentFormatting = {}; }
if (typeof ContentFormatting.Macro == 'undefined') { ContentFormatting.Macro = {}; }
if (typeof ContentFormatting.Macro.RestTable == 'undefined') { ContentFormatting.Macro.RestTable = {}; }


ContentFormatting.Macro.RestTable.dialog = function(opt_data, opt_ignored) {
  return '' + aui.dialog.dialog2({id: 'buttongroup-dialog', titleText: opt_data.title, modal: true, size: 'xlarge', content: '' + ContentFormatting.Macro.RestTable.content(opt_data), footerActionContent: '' + ContentFormatting.Macro.Common.footerContent(soy.$$augmentMap(opt_data, {docHrefHtml: 'https://docs.adaptavist.com/display/CFM4CS/Restful+Table', buttonTitle: opt_data.buttonTitle}))});
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.dialog.soyTemplateName = 'ContentFormatting.Macro.RestTable.dialog';
}


ContentFormatting.Macro.RestTable.content = function(opt_data, opt_ignored) {
  var output = '<div class="module custom-macro-dialog"><form id="buttonGroupForm" class="aui rest-table"><div role="application" class="aui-tabs horizontal-tabs"><ul role="tablist" class="tabs-menu"><li role="presentation" class="menu-item active-tab"><a aria-selected="true" role="tab" id="link-details" href="#tabs-details"><strong>' + soy.$$escapeHtml('Macro Options') + '</strong></a></li></ul><div aria-hidden="false" role="tabpanel" class="tabs-pane active-pane" id="tabs-details"><input id="avst-custom-dialog-macro-name" type="hidden" value="rest-table"><fieldset class="details"><legend>' + soy.$$escapeHtml('Rest Table Details') + '</legend><div class="aui-group aui-group-split"><div class="aui-item group-label"><label for="restURL">' + soy.$$escapeHtml('Resource URL') + '</label><input id="restURL" name="restURL" type="text" value="' + soy.$$escapeHtml(opt_data.restURL ? opt_data.restURL : '') + '" class="text" required="required"/><div class="description">' + soy.$$escapeHtml('URL of json data for table') + '</div></div></div></fieldset><fieldset class="rows"><legend>' + soy.$$escapeHtml('Add Table Column') + '</legend><div class="aui-group"><div class="aui-item create-button-rows"><table class="aui" id="dataTable"><thead><tr><th class="buttonLabel">' + soy.$$escapeHtml('Header') + '</th><th class="buttonValue">' + ContentFormatting.Macro.Common.velocityValueLink(null) + '</th><th class="actions">' + soy.$$escapeHtml('Actions') + '</th></tr></thead><tbody>';
  var valueList34 = opt_data.values;
  var valueListLen34 = valueList34.length;
  for (var valueIndex34 = 0; valueIndex34 < valueListLen34; valueIndex34++) {
    var valueData34 = valueList34[valueIndex34];
    output += ContentFormatting.Macro.RestTable.addRestTableRow({rowIndex: valueIndex34, size: opt_data.values.length, label: valueData34.label, value: valueData34.value});
  }
  output += '</tbody></table></div></div></fieldset></div></div><button class="hiddenButton" id="hiddenButton" type="submit"></button></form></div>';
  return output;
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.content.soyTemplateName = 'ContentFormatting.Macro.RestTable.content';
}


ContentFormatting.Macro.RestTable.addRestTableRow = function(opt_data, opt_ignored) {
  return '<tr id="groupRow' + soy.$$escapeHtml(opt_data.rowIndex) + '"><td class="buttonLabel"><input class="text buttonInputLabel" name="buttonLabel" type="text" value="' + soy.$$escapeHtml(opt_data.label) + '"/></td><td class="buttonValue"><input class="text buttonInputValue" name="buttonValue" type="text" value="' + soy.$$escapeHtml(opt_data.value) + '"/></td><td class="actions"><input onclick="addRestTableRow(' + soy.$$escapeHtml(opt_data.rowIndex) + ')" type="button" class="aui-button" value="+"/><input onclick="removeRestTableGroupRow(' + soy.$$escapeHtml(opt_data.rowIndex) + ')" id="removeButton-' + soy.$$escapeHtml(opt_data.rowIndex) + '" type="button" class="aui-button" value="-" ' + ((opt_data.size == 1) ? 'disabled' : '') + '/></td></tr>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.addRestTableRow.soyTemplateName = 'ContentFormatting.Macro.RestTable.addRestTableRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'js/rest-table-macro.js' */
AJS.bind("init.rte", function () {

    //Model for a Rest Table
    function RestTable(params) {

        this.getRestURL = function () {
            return params === undefined ? '' : params.restURL;
        };


        this.getValues = function () {
            if (params === undefined) {
                return [{
                    label: '',
                    value: ''
                }];
            } else {
                var counter = Number(params['counter']);
                var values = [];

                //Unfortunately, Confluence cannot parse a JSON string, so one needs to write each parameter individually
                for (var i = 0; i < counter; i++) {
                    values.push({
                        label: params[i.toString() + '_label'] === undefined ? "" : params[i.toString() + '_label'],
                        value: params[i.toString() + '_value'] === undefined ? "" : params[i.toString() + '_value']
                    });
                }
                return values;
            }
        };
    }

    //Fetches all Label/Values from each row, plus if it's selected.
    function getRowValues(values) {
        var counter = 0;

        //Unfortunately, Confluence cannot parse a JSON string, so one needs to write each parameter individually
        AJS.$('[id^="groupRow"]').each(function () {
            var label = $(this).find("input[name='buttonLabel']").val();
            var value = $(this).find("input[name='buttonValue']").val();

            values[counter + '_label'] = label;
            values[counter + '_value'] = value;

            counter++;
        });

        values['counter'] = counter;

        return values;
    }

    function getRestTableParams() {
        var values = {
            restURL: AJS.$('#restURL').val()
        };

        return getRowValues(values);
    }

    function setupEvents() {
        // Setups Tabs in AJS
        AJS.tabs.setup();

        //Hooks up the Cancel Button
        AJS.$('#cancelButtonGroup').click(function (e) {
            e.preventDefault();
            AJS.dialog2('#buttongroup-dialog').remove();
        });

        //Hooks up the Insert Button
        // The hidden button is required to submit the form because the dialog submit button is outside the form element.
        AJS.$('#insertButtonGroup').click(function () {
            AJS.$('#buttonGroupForm').submit();
        });
    }

    function createRestTable(macro) {

        //Creates a new Rest Table object that holds the parameters
        var restTable = new RestTable(macro.params);

        var dialogAndButtonTitle = macro.body === undefined ?
            "Insert" :
            "Save";
        //Calls the dialog with Edit or Insert accordingly.
        AJS.dialog2(ContentFormatting.Macro.RestTable.dialog({
            title: dialogAndButtonTitle + ' ' + "\u0027Restful Table\u0027 Macro",
            buttonTitle: dialogAndButtonTitle,
            restURL: restTable.getRestURL(),
            values: restTable.getValues()
        })).show();

        AJS.$('#insertButtonGroup').on('click', function (event) {
            AJS.$('#hiddenButton').click();
        });

        AJS.$('#buttonGroupForm').on('submit', function (e) {
            e.preventDefault();

                var t = tinymce.confluence.macrobrowser;

                AJS.Rte.BookmarkManager.restoreBookmark();

                if (t.editedMacroDiv) {
                    delete t.editedMacroDiv;
                }

                //Saves the Macro. Since the values is an array, it needs to convert it to JSON and then parse it back to display.
                tinymce.confluence.macrobrowser.macroBrowserComplete({
                    name: "rest-table",
                    "bodyHtml": undefined,
                    "params": getRestTableParams(),
                    "values": restTable.getValues()
                });

                AJS.dialog2('#buttongroup-dialog').remove();
        });

        setupEvents();
    }

    AJS.MacroBrowser.setMacroJsOverride('rest-table', {opener: createRestTable});
});

//Adds a new row Macro
function addRestTableRow(rowIndex) {
    AJS.$('#dataTable > tbody > tr#groupRow' + rowIndex).after(ContentFormatting.Macro.RestTable.addRestTableRow({
        rowIndex: AJS.$('[id^="groupRow"]').length,
        label: '',
        value: ''
    }));

    AJS.$('[id^="removeButton-"]')[0].disabled = false;
}
//Removes a row from Macro
function removeRestTableGroupRow(rowIndex) {
    AJS.$('#groupRow' + rowIndex).remove();

    if (AJS.$('[id^="removeButton-"]').length == 1) {
        AJS.$('[id^="removeButton-"]')[0].disabled = true;
    }
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.edrup.confluence.plugins.simple-cite:simple-cite-body-hint-11300', location = 'js/simple-cite-body-hint.js' */
function SimpleCiteBodyHint(){var c=false;this.init=function(){e();AJS.$("#editPageLink").click(function(){d.observe(document.body,a)})};var e=function(){if(AJS.Rte){if(AJS.Rte.getEditor()){if(AJS.Rte.getEditor().dom){if(AJS.Rte.getEditor().dom.getRoot()){c=true;console.log("simpleCiteBodyOberserver added!");b.observe(AJS.Rte.getEditor().dom.getRoot(),f)}}}}};var d=new MutationObserver(function(){if(c==false){e()}});var b=new MutationObserver(function(g){g.forEach(function(i){for(var k=0;k<i.addedNodes.length;k++){if(AJS.$(i.addedNodes[k]).attr("data-macro-name")=="single-cite"){var h=AJS.$(i.addedNodes[k]).find(".wysiwyg-macro-body:first");if(AJS.$(h).html()=="<p><br></p>"){console.log("New Simple Cite macro with empty body detected!");var j="Please define your cite here - e.g. title and author";AJS.$(h).html('<p><span class="text-placeholder">'+j+"</span></p>")}}}})});var f={childList:true,subtree:true};var a={childList:true,subtree:true}}var simpleCiteBodyHint=new SimpleCiteBodyHint();AJS.toInit(function(){simpleCiteBodyHint.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-slim', location = '/com/atlassian/confluence/extra/calendar3/amd/shim/dialogs-amd.js' */
define("tc/dialogs",function(){return Confluence.TeamCalendars.Dialogs});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-slim', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/backbone-amd.js' */
if(typeof Backbone!=="undefined"){define("tc-backbone",["underscore"],function(){return Backbone})};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-slim', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/wrm-amd.js' */
define("wrm",function(){return WRM});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-init-common', location = 'com/atlassian/confluence/extra/calendar3/components/initialiser/init-resources.js' */
define("tc/init-resources",["wrm","jquery"],function(a,c){var b=function(d){return d.removeClass("spinner").removeClass("aui-icon").removeClass("aui-icon-wait")};return{requireResources:function(){console.log("Init TC resources");a.require(["wrc!com.atlassian.confluence.extra.team-calendars.resources-batch"],function(){b(c("div.plugin-calendar"));require(["tc/calendar-plugin"],function(d){d.onTeamCalendarsLoaded()})}).fail(function(){b(c("div.plugin-calendar")).text("Failed to load calendar resources")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-init-editor', location = 'com/atlassian/confluence/extra/calendar3/components/initialiser/initialiser-editor.js' */
define("tc/init-resources-unsupported-content-types",function(){var a=["comment","com.atlassian.confluence.plugins.confluence-questions:question"];return a});define("tc/wait-for-calendar-macro-browser-metadata",function(){var a;return function(){if(!a){a=new Promise(function(c){var b=setInterval(function(){if(AJS.MacroBrowser.getMacroMetadata("calendar")){clearInterval(b);c()}},100)})}return a}});define("tc/init-resources-function",["ajs","jquery","wrm","confluence/meta","confluence/api/logger","tc/init-resources-unsupported-content-types","tc/wait-for-calendar-macro-browser-metadata"],function(d,h,c,f,b,g,e){var a=function(){var i=f.get("content-type");if(g.indexOf(i)>=0){c.require(["wrc!com.atlassian.confluence.extra.team-calendars:editor"],function(){e().then(function(){d.MacroBrowser.getMacroMetadata("calendar").hidden=true;h(window).trigger("tc/init-resources-function--load-succeed");a.isEditorResourcesLoadSucceed=true;b.log("TC initialiser-editor: not loading TC editor resources for content-type="+i)})});return}b.log("TC initialiser-editor: Init TC resources in Editor. content-type="+i);c.require(["wrc!com.atlassian.confluence.extra.team-calendars:editor"],function(){require(["tc/init-resources","tc/macro-button-panel","tc/macro-browser","tc/macro-browser-event-macro","tc/editor-auto-convert"],function(l,o,k,j,n){try{o.init();k.init();j.init();n.init();l.requireResources();e().then(function(){d.MacroBrowser.getMacroMetadata("calendar").hidden=false;h(window).trigger("tc/init-resources-function--load-succeed");a.isEditorResourcesLoadSucceed=true})}catch(m){h(window).trigger("tc/init-resources-function--load-failed");a.isEditorResourcesLoadFailed=m;b.error("TC initialiser-editor: Could not init TC resources for editor",m)}})}).fail(function(j){h(window).trigger("tc/init-resources-function--load-failed");a.isEditorResourcesLoadFailed=j;b.error("TC initialiser-editor: Could not load TC resources for editor")})};return a});require(["tc/init-resources-function"],function(a){$(window).bind("rte-ready",a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:question-link-autoconvert', location = 'js/question-link-autoconvert.js' */
(function(a){AJS.bind("init.rte",function(){function b(h,g,f){function d(m){var l=m.authority===document.location.host;l=l&&(!AJS.contextPath()||m.path.indexOf(AJS.contextPath())===0);return l}if(!d(h)){f();return}var j=h.path;var i=j.indexOf("view.action")!==-1;var e=0;if(i){e=h.queryKey.postId}else{var k=j.match(/qa\/questions\/([\d]+)/);if(k&&k.length===2){e=k[1]}}if(!e||e===0){f();return}AJS.$.get(AJS.params.contextPath+"/rest/tiny-qa-services/1.0/questions/get-question-title?postId="+e,function(l){if(l&&l.title!==""){f(AJS.$('<a href="'+h.source+'" >'+l.title+"</a>")[0])}else{f();return}})}try{tinymce.plugins.Autoconvert.autoConvert.addHandler(b)}catch(c){AJS.error("Failed to add questions autoconvert handler",c)}})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jpos.confluencemacro.portfolio-sever-confluence-macro:jpos-editor', location = 'js/jpos-editor.js' */
define("jpos-editor",["ajs","aui/dialog2","confluence/templates","confluence/macro-js-overrides",],function(a,b,c,d){return{_validateUrl:function(e){var f=new RegExp(/^https?:\/\/.+\/secure\/PortfolioRoadmapConfluence\.jspa\?r=[a-zA-Z0-9]{0,30}$/);return e.match(f)},_validateHeight:function(e){return e.length>0&&parseInt(e,10)>=300},_renderPreview:function(){var f=this;var h=f.previewContainer.offsetHeight;var e=a.contextPath()+"/rest/tinymce/1/macro/preview";var g={contentId:a.Meta.get("page-id"),macro:{name:f.macro.name,params:{url:f.urlInput.value,planHeight:h}}};f._disablePreviewBtn.call(f,"Loading...");f._clearPreview.call(f);a.$.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify(g)}).done(function(j){f.previewContainer.innerHTML=c.JPOS.jposMacroIframe({height:f.heightInput.value});var i=document.querySelector(".jpos__iframe");var k=i.contentWindow.document;if(i){f.iframeLoadTimeout=setTimeout(f._iframeLoadTimeout.bind(f),20000);i.addEventListener("load",function(){clearTimeout(f.iframeLoadTimeout);f._enablePreviewBtn.call(f);k.querySelector("#main").setAttribute("style","padding: 0px; overflow: hidden");k.querySelector("body").style.overflow="hidden"})}j=j.replace("window.onload","var preventPreviewOnloadFnTrigger");j=j.replace("2px solid #efefef","none");k.open();k.write(j);k.close()})},_iframeLoadTimeout:function(){var e=this;e.previewContainer.innerHTML=c.JPOS.jposIframeTimeout();e._enablePreviewBtn.call(e)},_clearPreview:function(){var e=this;e.previewContainer.innerHTML="";clearTimeout(e.iframeLoadTimeout)},_enablePreviewBtn:function(){var e=this;e.previewBtn.innerHTML="Preview";e.previewBtn.removeAttribute("disabled")},_disablePreviewBtn:function(f){var e=this;e.previewBtn.innerHTML=a.I18n.getText(f);e.previewBtn.setAttribute("disabled",true)},_addListeners:function(){var n=this;var m=document.querySelectorAll(".jpos__size-button");var k=document.querySelector(".jpos__close-dialog");var g=document.querySelector(".jpos__field-error--url");var j=document.querySelector(".jpos__field-error--height");function e(i){n.heightInput.value=i.target.dataset.value;j.style.display="none";if(n._validateUrl(n.urlInput.value)){n.insertBtn.removeAttribute("disabled")}}function l(p,o){var i;return function(){var r=this;var q=arguments;clearTimeout(i);i=setTimeout(function(){p.apply(r,q),o})}}function h(){n.urlInput.value=n.urlInput.value.replace(/(%20|\s)/g,"")}for(var f=0;f<m.length;f++){m[f].addEventListener("click",e)}n.previewBtn.addEventListener("click",function(){h();n._renderPreview()});k.addEventListener("click",function(){n.dialog.hide()});n.insertBtn.addEventListener("click",function(){h();tinymce.confluence.macrobrowser.macroBrowserComplete({name:n.macro.name,params:{url:n.urlInput.value,planHeight:n.heightInput.value,}});n.dialog.hide()});n.urlInput.addEventListener("keydown",function(i){if(i.key===" "){i.preventDefault()}});n.urlInput.addEventListener("input",l(function(i){h();n._clearPreview();if(!n._validateUrl(this.value)){g.style.display="block";n._disablePreviewBtn.call(n,"Preview");n.insertBtn.setAttribute("disabled",true);return false}g.style.display="none";n._enablePreviewBtn.call(n);if(n._validateHeight(n.heightInput.value)){n.insertBtn.removeAttribute("disabled")}},500));n.heightInput.addEventListener("input",l(function(i){if(!n._validateHeight(i.target.value)){j.style.display="block";n.insertBtn.setAttribute("disabled",true);return false}j.style.display="none";if(n._validateUrl(n.urlInput.value)){n.insertBtn.removeAttribute("disabled")}},500))},init:function(){var e=this;var f=function(g){var i=document.createElement("div");i.innerHTML=c.JPOS.jposMacroDialog();document.body.appendChild(i.firstChild);e.macro=g;e.dialog=b(".jpos__macro-dialog");e.dialog.show();e.urlInput=document.querySelector(".jpos__url-input");e.heightInput=document.querySelector(".jpos__height-input");e.insertBtn=document.querySelector(".jpos__insert-macro");e.previewBtn=document.querySelector(".jpos__preview-btn");e.previewContainer=document.querySelector(".jpos__preview-container");e._addListeners();const h="700";if(g.params){e.urlInput.value=g.params.url;e.heightInput.value=g.params.planHeight||h;e.previewBtn.focus()}else{e.heightInput.value=h;e._disablePreviewBtn.call(e,"Preview");e.insertBtn.setAttribute("disabled",true);e.urlInput.focus()}};d.put("portfolio-for-jira-plan",{opener:f})}}});require("confluence/module-exporter").safeRequire("jpos-editor",function(a){require("ajs").toInit(function(){a.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.jpos.confluencemacro.portfolio-sever-confluence-macro:jpos-editor', location = 'templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.JPOS.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.JPOS == 'undefined') { Confluence.Templates.JPOS = {}; }


Confluence.Templates.JPOS.jposMacroDialog = function(opt_data, opt_ignored) {
  return '<section class="jpos__macro-dialog aui-dialog2 aui-dialog2-xlarge aui-layer" role="dialog" aria-hidden="true" data-aui-remove-on-hide="true"><header class="jpos__macro-dialog-header aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Insert an Advanced Roadmaps for Jira plan') + '</h2></header><div class="jpos__macro-dialog-content aui-dialog2-content"><form action="" onsubmit="return false" class="aui jpos__form">' + soy.$$escapeHtml('This macro currently supports Advanced Roadmaps for Jira plan sharing.') + '<div class="jpos__form-fields"><div class="jpos__field-group jpos__field-group--url"><label for="url" class="jpos__field-label">' + soy.$$escapeHtml('URL') + '</label><div class="jpos__field-group jpos__field-group--flex"><input id="url" type="text" class="jpos__url-input text" /><button tabindex="0" class="jpos__preview-btn aui-button aui-button-primary">' + soy.$$escapeHtml('Preview') + '</button></div><div class="jpos__field-label jpos__field-label--inline">' + soy.$$escapeHtml('Paste the link copied from the Confluence sharing option in Advanced Roadmaps for Jira') + '<a class="jpos__learn-more" href="https://confluence.atlassian.com/display/JIRAPortfolioServer/Sharing+roadmaps" target="_blank" rel="noopener noreferrer">' + soy.$$escapeHtml('Learn More') + '</a></div><div class="jpos__field-error jpos__field-error--url"><span class="aui-icon aui-icon-small aui-iconfont-error"></span>' + soy.$$escapeHtml('It looks like you\x27ve entered an invalid URL. Check the Confluence sharing link in Advanced Roadmaps for Jira, then try again') + '</div></div><div class="jpos__field-group jpos__field-group--height"><label for="height" class="jpos__field-label">' + soy.$$escapeHtml('Height') + '</label><div class="jpos__field-group jpos__field-group--flex"><div class="aui-buttons"><button tabindex="0" class="jpos__size-button aui-button" data-value="700" title="small"></button><button tabindex="0" class="jpos__size-button jpos__size-button--medium aui-button" data-value="900" title="medium"></button><button tabindex="0" class="jpos__size-button jpos__size-button--large aui-button" data-value="1100" title="large"></button></div><input id="height" type="number" step="10" min="300" class="jpos__height-input text" /><span class="jpos__height-unit">px</span></div><div class="jpos__field-label">' + soy.$$escapeHtml('Choose the height to display on your page') + '</div><div class="jpos__field-error jpos__field-error--height">' + soy.$$escapeHtml('Height must be at least 300px') + '</div></div></div></form><div tabindex="-1" class="jpos__preview-container"></div></div><footer class="jpos__macro-dialog-footer aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><form onsubmit="return false" class="aui"><button tabindex="0" class="jpos__close-dialog aui-button aui-button-link">' + soy.$$escapeHtml('Cancel') + '</button><button tabindex="0" class="jpos__insert-macro aui-button aui-button-primary">' + soy.$$escapeHtml('Insert') + '</button></form></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposMacroDialog.soyTemplateName = 'Confluence.Templates.JPOS.jposMacroDialog';
}


Confluence.Templates.JPOS.jposMacroIframe = function(opt_data, opt_ignored) {
  return '<div class="jpos__iframe-container"><iframe class="jpos__iframe" frameborder="none" src="' + soy.$$escapeHtml(opt_data.url) + '" width="100%" height="' + soy.$$escapeHtml(opt_data.height) + '"></iframe></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposMacroIframe.soyTemplateName = 'Confluence.Templates.JPOS.jposMacroIframe';
}


Confluence.Templates.JPOS.jposIframeTimeout = function(opt_data, opt_ignored) {
  return '<div class="jpos__iframe-load-timeout"><span class="aui-icon aui-icon-small aui-iconfont-error"></span>' + soy.$$escapeHtml('Your preview couldn\x27t be rendered. Please check the url and try again') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposIframeTimeout.soyTemplateName = 'Confluence.Templates.JPOS.jposIframeTimeout';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'net.customware.confluence.plugin.reporting:entrypoint-reportOnboarding', location = 'dist/js/reportOnboarding.min.js' */
!function(){var t={135:function(t,e,r){t.exports=r(248)},409:function(t,e,r){var n;window,t.exports=(n=r(864),function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13)}([function(t,e){t.exports=n},function(t,e,r){"use strict";e.__esModule=!0,e.extend=u,e.indexOf=function(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return a.test(t)?t.replace(o,i):t},e.isEmpty=function(t){return!t&&0!==t||!(!c(t)||0!==t.length)},e.createFrame=function(t){var e=u({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},o=/[&<>"'`=]/g,a=/[&<>"'`=]/;function i(t){return n[t]}function u(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var s=Object.prototype.toString;e.toString=s;var l=function(t){return"function"==typeof t};l(/x/)&&(e.isFunction=l=function(t){return"function"==typeof t&&"[object Function]"===s.call(t)}),e.isFunction=l;var c=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===s.call(t)};e.isArray=c},function(t,e,r){"use strict";e.__esModule=!0;var n=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function o(t,e){var r=e&&e.loc,a=void 0,i=void 0,u=void 0,s=void 0;r&&(a=r.start.line,i=r.end.line,u=r.start.column,s=r.end.column,t+=" - "+a+":"+u);for(var l=Error.prototype.constructor.call(this,t),c=0;c<n.length;c++)this[n[c]]=l[n[c]];Error.captureStackTrace&&Error.captureStackTrace(this,o);try{r&&(this.lineNumber=a,this.endLineNumber=i,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=u,this.endColumn=s))}catch(t){}}o.prototype=new Error,e.default=o,t.exports=e.default},function(t,e,r){t.exports=r(14)},function(t,e){function r(t,e,r,n,o,a,i){try{var u=t[a](i),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}t.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function u(t){r(i,o,a,u,s,"next",t)}function s(t){r(i,o,a,u,s,"throw",t)}u(void 0)}))}}},function(t,e,r){t.exports=r(15).default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=c;var o=r(1),a=n(r(2)),i=r(7),u=r(23),s=n(r(9)),l=r(10);function c(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},i.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}e.VERSION="4.7.6",e.COMPILER_REVISION=8,e.LAST_COMPATIBLE_COMPILER_REVISION=7,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"},c.prototype={constructor:c,logger:s.default,log:s.default.log,registerHelper:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if("[object Object]"===o.toString.call(t))o.extend(this.partials,t);else{if(void 0===e)throw new a.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var f=s.default.log;e.log=f,e.createFrame=o.createFrame,e.logger=s.default},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),a.default(t),i.default(t),u.default(t),s.default(t),l.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])};var o=n(r(16)),a=n(r(17)),i=n(r(18)),u=n(r(19)),s=n(r(20)),l=n(r(21)),c=n(r(22))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";e.__esModule=!0;var n=r(1),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];console[e].apply(console,n)}}};e.default=o,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.createProtoAccessControl=function(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=Object.create(null);return r.__proto__=!1,{properties:{whitelist:n.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:n.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,r){return function(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==a[t]&&(a[t]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}("function"==typeof t?e.methods:e.properties,r)},e.resetLoggedProperties=function(){Object.keys(a).forEach((function(t){delete a[t]}))};var n=r(25),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(9)),a=Object.create(null)},function(t,e,r){var n=r(5);t.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(t,e,r,n,o){var a,i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<ul class="aui-buttons">\n    <li id="rte-common-on-boarding-button" class="toolbar-item aui-button">\n        <a id="rte-common-on-boarding" href="#">\n            <span class="trigger-text">\n                <img style="margin-top: 4px;" src="'+t.escapeExpression("function"==typeof(a=null!=(a=i(r,"iconUrl")||(null!=e?i(e,"iconUrl"):e))?a:t.hooks.helperMissing)?a.call(null!=e?e:t.nullContext||{},{name:"iconUrl",hash:{},data:o,loc:{start:{line:5,column:51},end:{line:5,column:62}}}):a)+'">\n            </span>\n        </a>\n    </li>\n</ul>\n'},useData:!0})},function(t,e,r){var n=r(5);t.exports=(n.default||n).template({1:function(t,e,r,n,o){var a;return"        "+(null!=(a=t.lambda(e,e))?a:"")+"\n"},compiler:[8,">= 4.3.0"],main:function(t,e,r,n,o){var a,i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div id="sr-appcues-onboarding">\n\t<div>\n'+(null!=(a=i(r,"each").call(null!=e?e:t.nullContext||{},null!=e?i(e,"elems"):e,{name:"each",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:3,column:4},end:{line:5,column:13}}}))?a:"")+'\t</div>\n\t<div style="float: right;margin-top: 5px">\n\t    <button id="sr-appcues-skip-btn" class="aui-button aui-button-link">Maybe later</button>\n\t</div>\n</div>\n\n\n'},useData:!0})},function(t,e,r){"use strict";r.r(e),r.d(e,"APPCUES_TUTORIAL_SLIDEOUT",(function(){return d})),r.d(e,"APPCUES_INLINE_DIALOG_POPUP",(function(){return h})),r.d(e,"initializeRocket",(function(){return v})),r.d(e,"insertNewContainer",(function(){return m})),r.d(e,"insertRestPathOfPluginConsumer",(function(){return g})),r.d(e,"insertNewHandler",(function(){return y})),r.d(e,"hideDialog",(function(){return _})),r.d(e,"hasUserSeen",(function(){return x})),r.d(e,"getHasUserSeen",(function(){return P})),r.d(e,"markUserSeen",(function(){return O})),r.d(e,"sendReportingAnalytics",(function(){return k})),r.d(e,"initAppcues",(function(){return E})),r.d(e,"fetchAppcuesScript",(function(){return L}));var n=r(3),o=r.n(n),a=r(4),i=r.n(a),u=r(11),s=r.n(u),l=r(12),c=r.n(l),f=r(0),p=r.n(f),d="APPCUES_TUTORIAL_SLIDEOUT",h="APPCUES_INLINE_DIALOG_POPUP";function v(t,e){(document.querySelector(".blogpost.edit")||document.querySelector(".page.edit"))&&(function(t){var e,r,n,o;!0!==window.srConfHasAppcuesInit&&(window.srConfHasAppcuesInit=!0,window.srConfTempElements=[],window.srConfTempHandlers=[],window.srConfPluginConsumers=[],window.srConfAppcuesDialogHasShown=!1,$("#rte-button-help").parent("ul").before(s()({iconUrl:t})),window.srAppcuesInlineDialog=p.a.InlineDialog(p.a.$("#rte-common-on-boarding-button"),"common-appcues-tooltip",(function(t,e,r){t.html(c()({elems:window.srConfTempElements})),r()}),{persistent:!0,initCallback:w,width:"300px"}),e=$("#rte-toolbar").find(".aui-toolbar2-primary"),r="margin-right",45,(o=/(\d*)(px)?/.exec(e.css(r))).length>1&&(n=+o[1],n+=45,e.css(r,n+"px")))}(e),function(t){b.apply(this,arguments)}(t))}function m(t){window.srConfTempElements.push(t)}function g(t){window.srConfPluginConsumers.push(t)}function y(t){-1===window.srConfTempHandlers.indexOf(t)&&window.srConfTempHandlers.push(t)}function w(){window.srConfTempHandlers.forEach((function(t){t()})),$("#sr-appcues-skip-btn").click((function(t){t.preventDefault(),_(),window.srConfPluginConsumers.forEach((function(t){var e="".concat(p.a.params.baseUrl,"/rest/").concat(t,"/on-boarding/analytics"),r="".concat(p.a.params.baseUrl,"/rest/").concat(t,"/on-boarding/seen");k(e,"SKIP_ON_BOARDING"),O(r,p.a.Meta.get("remote-user-key"),d)}))}))}function _(){window.srAppcuesInlineDialog.hide()}function b(){return(b=i()(o.a.mark((function t(e){var r,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(e,p.a.Meta.get("remote-user-key"),d);case 2:r=t.sent,n=r.hasUserSeen,!1===r.shouldPopUp||n||window.srConfAppcuesDialogHasShown||(window.srConfAppcuesDialogHasShown=!0,setTimeout((function(){return window.srAppcuesInlineDialog.show()}),2e3));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t,e,r){return P(t,e,r)}function P(t,e,r){return p.a.$.ajax({url:t,type:"GET",contentType:"application/json",data:{userKey:e,type:r}})}function O(t,e,r){return p.a.$.ajax({url:t,type:"POST",contentType:"application/json",data:JSON.stringify({userKey:e,onBoardingType:r})})}function k(t,e){p.a.$.ajax({url:t,type:"POST",beforeSend:function(t){t.setRequestHeader("X-Atlassian-Token","no-check")},contentType:"application/json",data:JSON.stringify({event:e})})}function E(t){return M.apply(this,arguments)}function M(){return(M=i()(o.a.mark((function t(e){var r,n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!p.a.params.remoteUserKey){t.next=10;break}return t.next=4,p.a.$.ajax({url:e,type:"GET",contentType:"application/json"});case 4:r=t.sent,n=r.userKey,a=r.serverSEN,window.Appcues.identify(n,{serverSEN:a}),t.next=11;break;case 10:window.Appcues.anonymous();case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function L(t){return S.apply(this,arguments)}function S(){return(S=i()(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.$.ajax({url:e,dataType:"script",cache:!0});case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,r){var n=function(t){"use strict";var e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(t,e,r,n){var o=e&&e.prototype instanceof c?e:c,a=Object.create(o.prototype),i=new x(n||[]);return a._invoke=function(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=w(i,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(t,r,i),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function c(){}function f(){}function p(){}var d={};d[o]=function(){return this};var h=Object.getPrototypeOf,v=h&&h(h(P([])));v&&v!==e&&r.call(v,o)&&(d=v);var m=p.prototype=c.prototype=Object.create(d);function g(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t,e){var n;this._invoke=function(o,a){function i(){return new e((function(n,i){!function n(o,a,i,u){var l=s(t[o],t,a);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,i,u)}),(function(t){n("throw",t,i,u)})):e.resolve(f).then((function(t){c.value=t,i(c)}),(function(t){return n("throw",t,i,u)}))}u(l.arg)}(o,a,n,i)}))}return n=n?n.then(i,i):i()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=s(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=m.constructor=p,p.constructor=f,p[i]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,i in t||(t[i]="GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(y.prototype),y.prototype[a]=function(){return this},t.AsyncIterator=y,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new y(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},g(m),m[i]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),b(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;b(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}e.__esModule=!0;var a=o(r(6)),i=n(r(26)),u=n(r(2)),s=o(r(1)),l=o(r(27)),c=n(r(29));function f(){var t=new a.HandlebarsEnvironment;return s.extend(t,a),t.SafeString=i.default,t.Exception=u.default,t.Utils=s,t.escapeExpression=s.escapeExpression,t.VM=l,t.template=function(e){return l.template(e,t)},t}var p=f();p.create=f,c.default(p),p.default=p,e.default=p,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n=r(1);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,r){var o=r.inverse,a=r.fn;if(!0===e)return a(this);if(!1===e||null==e)return o(this);if(n.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):o(this);if(r.data&&r.ids){var i=n.createFrame(r.data);i.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:i}}return a(e,r)}))},t.exports=e.default},function(t,e,r){"use strict";(function(n){e.__esModule=!0;var o,a=r(1),i=(o=r(2))&&o.__esModule?o:{default:o};e.default=function(t){t.registerHelper("each",(function(t,e){if(!e)throw new i.default("Must pass iterator to #each");var r,o=e.fn,u=e.inverse,s=0,l="",c=void 0,f=void 0;function p(e,r,n){c&&(c.key=e,c.index=r,c.first=0===r,c.last=!!n,f&&(c.contextPath=f+e)),l+=o(t[e],{data:c,blockParams:a.blockParams([t[e],e],[f+e,null])})}if(e.data&&e.ids&&(f=a.appendContextPath(e.data.contextPath,e.ids[0])+"."),a.isFunction(t)&&(t=t.call(this)),e.data&&(c=a.createFrame(e.data)),t&&"object"==typeof t)if(a.isArray(t))for(var d=t.length;s<d;s++)s in t&&p(s,s,s===t.length-1);else if(n.Symbol&&t[n.Symbol.iterator]){for(var h=[],v=t[n.Symbol.iterator](),m=v.next();!m.done;m=v.next())h.push(m.value);for(d=(t=h).length;s<d;s++)p(s,s,s===t.length-1)}else r=void 0,Object.keys(t).forEach((function(t){void 0!==r&&p(r,s-1),r=t,s++})),void 0!==r&&p(r,s-1,!0);return 0===s&&(l=u(this)),l}))},t.exports=e.default}).call(this,r(8))},function(t,e,r){"use strict";e.__esModule=!0;var n,o=(n=r(2))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(1),a=(n=r(2))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return o.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,r){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),e[0]=o,t.log.apply(t,e)}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e,r){return t?r.lookupProperty(t,e):t}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(1),a=(n=r(2))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");o.isFunction(t)&&(t=t.call(this));var r=e.fn;if(o.isEmpty(t))return e.inverse(this);var n=e.data;return e.data&&e.ids&&((n=o.createFrame(e.data)).contextPath=o.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:n,blockParams:o.blockParams([t],[n&&n.contextPath])})}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){o.default(t)};var n,o=(n=r(24))&&n.__esModule?n:{default:n}},function(t,e,r){"use strict";e.__esModule=!0;var n=r(1);e.default=function(t){t.registerDecorator("inline",(function(t,e,r,o){var a=t;return e.partials||(e.partials={},a=function(o,a){var i=r.partials;r.partials=n.extend({},i,e.partials);var u=t(o,a);return r.partials=i,u}),e.partials[o.args[0]]=o.fn,a}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.extend.apply(void 0,[Object.create(null)].concat(e))};var n=r(1)},function(t,e,r){"use strict";function n(t){this.string=t}e.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},e.default=n,t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=i.COMPILER_REVISION;if(!(e>=i.LAST_COMPATIBLE_COMPILER_REVISION&&e<=i.COMPILER_REVISION)){if(e<i.LAST_COMPATIBLE_COMPILER_REVISION){var n=i.REVISION_CHANGES[r],o=i.REVISION_CHANGES[e];throw new a.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new a.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new a.default("No environment passed to template");if(!t||!t.main)throw new a.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r=t.compiler&&7===t.compiler[0],n={strict:function(t,e,r){if(!t||!(e in t))throw new a.default('"'+e+'" not defined in '+t,{loc:r});return t[e]},lookupProperty:function(t,e){var r=t[e];return null==r||Object.prototype.hasOwnProperty.call(t,e)||l.resultIsAllowed(r,n.protoAccessControl,e)?r:void 0},lookup:function(t,e){for(var r=t.length,o=0;o<r;o++)if(null!=(t[o]&&n.lookupProperty(t[o],e)))return t[o][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:o.escapeExpression,invokePartial:function(r,n,i){i.hash&&(n=o.extend({},n,i.hash),i.ids&&(i.ids[0]=!0)),r=e.VM.resolvePartial.call(this,r,n,i);var u=o.extend({},i,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=e.VM.invokePartial.call(this,r,n,u);if(null==s&&e.compile&&(i.partials[i.name]=e.compile(r,t.compilerOptions,e),s=i.partials[i.name](n,u)),null!=s){if(i.indent){for(var l=s.split("\n"),c=0,f=l.length;c<f&&(l[c]||c+1!==f);c++)l[c]=i.indent+l[c];s=l.join("\n")}return s}throw new a.default("The partial "+i.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var r=t[e];return r.decorator=t[e+"_d"],r},programs:[],program:function(t,e,r,n,o){var a=this.programs[t],i=this.fn(t);return e||o||n||r?a=c(this,t,i,e,r,n,o):a||(a=this.programs[t]=c(this,t,i)),a},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var r=t||e;return t&&e&&t!==e&&(r=o.extend({},e,t)),r},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function i(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.data;i._setup(r),!r.partial&&t.useData&&(o=p(e,o));var a=void 0,u=t.useBlockParams?[]:void 0;function s(e){return""+t.main(n,e,n.helpers,n.partials,o,u,a)}return t.useDepths&&(a=r.depths?e!=r.depths[0]?[e].concat(r.depths):r.depths:[e]),(s=d(t.main,s,n,r.depths||[],o,u))(e,r)}return i.isTop=!0,i._setup=function(a){if(a.partial)n.protoAccessControl=a.protoAccessControl,n.helpers=a.helpers,n.partials=a.partials,n.decorators=a.decorators,n.hooks=a.hooks;else{var i=o.extend({},e.helpers,a.helpers);!function(t,e){Object.keys(t).forEach((function(r){var n=t[r];t[r]=function(t,e){var r=e.lookupProperty;return s.wrapHelper(t,(function(t){return o.extend({lookupProperty:r},t)}))}(n,e)}))}(i,n),n.helpers=i,t.usePartial&&(n.partials=n.mergeIfNeeded(a.partials,e.partials)),(t.usePartial||t.useDecorators)&&(n.decorators=o.extend({},e.decorators,a.decorators)),n.hooks={},n.protoAccessControl=l.createProtoAccessControl(a);var c=a.allowCallsToHelperMissing||r;u.moveHelperToHooks(n,"helperMissing",c),u.moveHelperToHooks(n,"blockHelperMissing",c)}},i._child=function(e,r,o,i){if(t.useBlockParams&&!o)throw new a.default("must pass block params");if(t.useDepths&&!i)throw new a.default("must pass parent depths");return c(n,e,t[e],r,0,o,i)},i},e.wrapProgram=c,e.resolvePartial=function(t,e,r){return t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name],t},e.invokePartial=function(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var u=void 0;if(r.fn&&r.fn!==f&&function(){r.data=i.createFrame(r.data);var t=r.fn;u=r.data["partial-block"]=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=i.createFrame(r.data),r.data["partial-block"]=n,t(e,r)},t.partials&&(r.partials=o.extend({},r.partials,t.partials))}(),void 0===t&&u&&(t=u),void 0===t)throw new a.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)},e.noop=f;var n,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(1)),a=(n=r(2))&&n.__esModule?n:{default:n},i=r(6),u=r(7),s=r(28),l=r(10);function c(t,e,r,n,o,a,i){function u(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=i;return!i||e==i[0]||e===t.nullContext&&null===i[0]||(u=[e].concat(i)),r(t,e,t.helpers,t.partials,o.data||n,a&&[o.blockParams].concat(a),u)}return(u=d(r,u,t,i,n,a)).program=e,u.depth=i?i.length:0,u.blockParams=o||0,u}function f(){return""}function p(t,e){return e&&"root"in e||((e=e?i.createFrame(e):{}).root=t),e}function d(t,e,r,n,a,i){if(t.decorator){var u={};e=t.decorator(e,u,r,n&&n[0],a,i,n),o.extend(e,u)}return e}},function(t,e,r){"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){return"function"!=typeof t?t:function(){return arguments[arguments.length-1]=e(arguments[arguments.length-1]),t.apply(this,arguments)}}},function(t,e,r){"use strict";(function(r){e.__esModule=!0,e.default=function(t){var e=void 0!==r?r:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default}).call(this,r(8))}]))},41:function(t,e,r){var n=r(655);t.exports=(n.default||n).template({1:function(t,e,r,n,o){return" background-color: #fefedd; "},compiler:[8,">= 4.3.0"],main:function(t,e,r,n,o){var a,i=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="sr-appcues-container" style="border-radius: 10px; padding: 10px;  '+(null!=(a=i(r,"if").call(null!=e?e:t.nullContext||{},null!=e?i(e,"status"):e,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:1,column:78},end:{line:1,column:127}}}))?a:"")+'">\n    <h5 style="color:black">Did you know you can create advance reports in Confluence?</h5>\n\n    <div style="margin-top: 4px">\n        <button class="aui-button aui-button-compact aui-button-primary reporting-ok-btn"><span class="aui-icon aui-icon-small aui-iconfont-devtools-arrow-right"></span></button>\n        <button class="aui-button aui-button-link reporting-ok-btn">Learn how to build a simple report</button>\n\n    </div>\n</div>'},useData:!0})},34:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}e.__esModule=!0;var a=o(r(207)),i=n(r(586)),u=n(r(24)),s=o(r(704)),l=o(r(546)),c=n(r(179));function f(){var t=new a.HandlebarsEnvironment;return s.extend(t,a),t.SafeString=i.default,t.Exception=u.default,t.Utils=s,t.escapeExpression=s.escapeExpression,t.VM=l,t.template=function(e){return l.template(e,t)},t}var p=f();p.create=f,c.default(p),p.default=p,e.default=p,t.exports=e.default},207:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=f;var o=r(704),a=n(r(24)),i=r(870),u=r(576),s=n(r(765)),l=r(467);e.VERSION="4.7.7",e.COMPILER_REVISION=8,e.LAST_COMPATIBLE_COMPILER_REVISION=7,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var c="[object Object]";function f(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},i.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}f.prototype={constructor:f,logger:s.default,log:s.default.log,registerHelper:function(t,e){if(o.toString.call(t)===c){if(e)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===c)o.extend(this.partials,t);else{if(void 0===e)throw new a.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===c){if(e)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var p=s.default.log;e.log=p,e.createFrame=o.createFrame,e.logger=s.default},576:function(t,e,r){"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){o.default(t)};var n,o=(n=r(642))&&n.__esModule?n:{default:n}},642:function(t,e,r){"use strict";e.__esModule=!0;var n=r(704);e.default=function(t){t.registerDecorator("inline",(function(t,e,r,o){var a=t;return e.partials||(e.partials={},a=function(o,a){var i=r.partials;r.partials=n.extend({},i,e.partials);var u=t(o,a);return r.partials=i,u}),e.partials[o.args[0]]=o.fn,a}))},t.exports=e.default},24:function(t,e){"use strict";e.__esModule=!0;var r=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function n(t,e){var o=e&&e.loc,a=void 0,i=void 0,u=void 0,s=void 0;o&&(a=o.start.line,i=o.end.line,u=o.start.column,s=o.end.column,t+=" - "+a+":"+u);for(var l=Error.prototype.constructor.call(this,t),c=0;c<r.length;c++)this[r[c]]=l[r[c]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{o&&(this.lineNumber=a,this.endLineNumber=i,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=u,this.endColumn=s))}catch(t){}}n.prototype=new Error,e.default=n,t.exports=e.default},870:function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),a.default(t),i.default(t),u.default(t),s.default(t),l.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])};var o=n(r(810)),a=n(r(847)),i=n(r(780)),u=n(r(229)),s=n(r(328)),l=n(r(124)),c=n(r(89))},810:function(t,e,r){"use strict";e.__esModule=!0;var n=r(704);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,r){var o=r.inverse,a=r.fn;if(!0===e)return a(this);if(!1===e||null==e)return o(this);if(n.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):o(this);if(r.data&&r.ids){var i=n.createFrame(r.data);i.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:i}}return a(e,r)}))},t.exports=e.default},847:function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(704),a=(n=r(24))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("each",(function(t,e){if(!e)throw new a.default("Must pass iterator to #each");var n,i=e.fn,u=e.inverse,s=0,l="",c=void 0,f=void 0;function p(e,r,n){c&&(c.key=e,c.index=r,c.first=0===r,c.last=!!n,f&&(c.contextPath=f+e)),l+=i(t[e],{data:c,blockParams:o.blockParams([t[e],e],[f+e,null])})}if(e.data&&e.ids&&(f=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(c=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var d=t.length;s<d;s++)s in t&&p(s,s,s===t.length-1);else if(r.g.Symbol&&t[r.g.Symbol.iterator]){for(var h=[],v=t[r.g.Symbol.iterator](),m=v.next();!m.done;m=v.next())h.push(m.value);for(d=(t=h).length;s<d;s++)p(s,s,s===t.length-1)}else n=void 0,Object.keys(t).forEach((function(t){void 0!==n&&p(n,s-1),n=t,s++})),void 0!==n&&p(n,s-1,!0);return 0===s&&(l=u(this)),l}))},t.exports=e.default},780:function(t,e,r){"use strict";e.__esModule=!0;var n,o=(n=r(24))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},229:function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(704),a=(n=r(24))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new a.default("#if requires exactly one argument");return o.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,r){if(2!=arguments.length)throw new a.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})}))},t.exports=e.default},328:function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),e[0]=o,t.log.apply(t,e)}))},t.exports=e.default},124:function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e,r){return t?r.lookupProperty(t,e):t}))},t.exports=e.default},89:function(t,e,r){"use strict";e.__esModule=!0;var n,o=r(704),a=(n=r(24))&&n.__esModule?n:{default:n};e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new a.default("#with requires exactly one argument");o.isFunction(t)&&(t=t.call(this));var r=e.fn;if(o.isEmpty(t))return e.inverse(this);var n=e.data;return e.data&&e.ids&&((n=o.createFrame(e.data)).contextPath=o.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:n,blockParams:o.blockParams([t],[n&&n.contextPath])})}))},t.exports=e.default},943:function(t,e,r){"use strict";e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.extend.apply(void 0,[Object.create(null)].concat(e))};var n=r(704)},467:function(t,e,r){"use strict";e.__esModule=!0,e.createProtoAccessControl=function(t){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=Object.create(null);return r.__proto__=!1,{properties:{whitelist:n.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:n.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,r){return function(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==a[t]&&(a[t]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}("function"==typeof t?e.methods:e.properties,r)},e.resetLoggedProperties=function(){Object.keys(a).forEach((function(t){delete a[t]}))};var n=r(943),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(765)),a=Object.create(null)},205:function(t,e){"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){return"function"!=typeof t?t:function(){return arguments[arguments.length-1]=e(arguments[arguments.length-1]),t.apply(this,arguments)}}},765:function(t,e,r){"use strict";e.__esModule=!0;var n=r(704),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];console[e].apply(console,n)}}};e.default=o,t.exports=e.default},179:function(t,e,r){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==r.g?r.g:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default},546:function(t,e,r){"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=i.COMPILER_REVISION;if(!(e>=i.LAST_COMPATIBLE_COMPILER_REVISION&&e<=i.COMPILER_REVISION)){if(e<i.LAST_COMPATIBLE_COMPILER_REVISION){var n=i.REVISION_CHANGES[r],o=i.REVISION_CHANGES[e];throw new a.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new a.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new a.default("No environment passed to template");if(!t||!t.main)throw new a.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r=t.compiler&&7===t.compiler[0],n={strict:function(t,e,r){if(!t||!(e in t))throw new a.default('"'+e+'" not defined in '+t,{loc:r});return n.lookupProperty(t,e)},lookupProperty:function(t,e){var r=t[e];return null==r||Object.prototype.hasOwnProperty.call(t,e)||l.resultIsAllowed(r,n.protoAccessControl,e)?r:void 0},lookup:function(t,e){for(var r=t.length,o=0;o<r;o++)if(null!=(t[o]&&n.lookupProperty(t[o],e)))return t[o][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:o.escapeExpression,invokePartial:function(r,n,i){i.hash&&(n=o.extend({},n,i.hash),i.ids&&(i.ids[0]=!0)),r=e.VM.resolvePartial.call(this,r,n,i);var u=o.extend({},i,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=e.VM.invokePartial.call(this,r,n,u);if(null==s&&e.compile&&(i.partials[i.name]=e.compile(r,t.compilerOptions,e),s=i.partials[i.name](n,u)),null!=s){if(i.indent){for(var l=s.split("\n"),c=0,f=l.length;c<f&&(l[c]||c+1!==f);c++)l[c]=i.indent+l[c];s=l.join("\n")}return s}throw new a.default("The partial "+i.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var r=t[e];return r.decorator=t[e+"_d"],r},programs:[],program:function(t,e,r,n,o){var a=this.programs[t],i=this.fn(t);return e||o||n||r?a=c(this,t,i,e,r,n,o):a||(a=this.programs[t]=c(this,t,i)),a},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var r=t||e;return t&&e&&t!==e&&(r=o.extend({},e,t)),r},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function i(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=r.data;i._setup(r),!r.partial&&t.useData&&(o=p(e,o));var a=void 0,u=t.useBlockParams?[]:void 0;function s(e){return""+t.main(n,e,n.helpers,n.partials,o,u,a)}return t.useDepths&&(a=r.depths?e!=r.depths[0]?[e].concat(r.depths):r.depths:[e]),(s=d(t.main,s,n,r.depths||[],o,u))(e,r)}return i.isTop=!0,i._setup=function(a){if(a.partial)n.protoAccessControl=a.protoAccessControl,n.helpers=a.helpers,n.partials=a.partials,n.decorators=a.decorators,n.hooks=a.hooks;else{var i=o.extend({},e.helpers,a.helpers);!function(t,e){Object.keys(t).forEach((function(r){var n=t[r];t[r]=function(t,e){var r=e.lookupProperty;return s.wrapHelper(t,(function(t){return o.extend({lookupProperty:r},t)}))}(n,e)}))}(i,n),n.helpers=i,t.usePartial&&(n.partials=n.mergeIfNeeded(a.partials,e.partials)),(t.usePartial||t.useDecorators)&&(n.decorators=o.extend({},e.decorators,a.decorators)),n.hooks={},n.protoAccessControl=l.createProtoAccessControl(a);var c=a.allowCallsToHelperMissing||r;u.moveHelperToHooks(n,"helperMissing",c),u.moveHelperToHooks(n,"blockHelperMissing",c)}},i._child=function(e,r,o,i){if(t.useBlockParams&&!o)throw new a.default("must pass block params");if(t.useDepths&&!i)throw new a.default("must pass parent depths");return c(n,e,t[e],r,0,o,i)},i},e.wrapProgram=c,e.resolvePartial=function(t,e,r){return t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name],t},e.invokePartial=function(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var u=void 0;if(r.fn&&r.fn!==f&&function(){r.data=i.createFrame(r.data);var t=r.fn;u=r.data["partial-block"]=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=i.createFrame(r.data),r.data["partial-block"]=n,t(e,r)},t.partials&&(r.partials=o.extend({},r.partials,t.partials))}(),void 0===t&&u&&(t=u),void 0===t)throw new a.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)},e.noop=f;var n,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(704)),a=(n=r(24))&&n.__esModule?n:{default:n},i=r(207),u=r(870),s=r(205),l=r(467);function c(t,e,r,n,o,a,i){function u(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=i;return!i||e==i[0]||e===t.nullContext&&null===i[0]||(u=[e].concat(i)),r(t,e,t.helpers,t.partials,o.data||n,a&&[o.blockParams].concat(a),u)}return(u=d(r,u,t,i,n,a)).program=e,u.depth=i?i.length:0,u.blockParams=o||0,u}function f(){return""}function p(t,e){return e&&"root"in e||((e=e?i.createFrame(e):{}).root=t),e}function d(t,e,r,n,a,i){if(t.decorator){var u={};e=t.decorator(e,u,r,n&&n[0],a,i,n),o.extend(e,u)}return e}},586:function(t,e){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},704:function(t,e){"use strict";e.__esModule=!0,e.extend=i,e.indexOf=function(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return o.test(t)?t.replace(n,a):t},e.isEmpty=function(t){return!t&&0!==t||!(!l(t)||0!==t.length)},e.createFrame=function(t){var e=i({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},n=/[&<>"'`=]/g,o=/[&<>"'`=]/;function a(t){return r[t]}function i(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var u=Object.prototype.toString;e.toString=u;var s=function(t){return"function"==typeof t};s(/x/)&&(e.isFunction=s=function(t){return"function"==typeof t&&"[object Function]"===u.call(t)}),e.isFunction=s;var l=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===u.call(t)};e.isArray=l},655:function(t,e,r){t.exports=r(34).default},248:function(t){var e=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),i=new L(n||[]);return a._invoke=function(t,e,r){var n=f;return function(o,a){if(n===d)throw new Error("Generator is already running");if(n===h){if("throw"===o)throw a;return j()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=k(i,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var s=c(t,e,r);if("normal"===s.type){if(n=r.done?h:p,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=h,r.method="throw",r.arg=s.arg)}}}(t,r,i),a}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",h="completed",v={};function m(){}function g(){}function y(){}var w={};s(w,a,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(S([])));b&&b!==r&&n.call(b,a)&&(w=b);var x=y.prototype=m.prototype=Object.create(w);function P(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,a,i,u){var s=c(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,u)}),(function(t){r("throw",t,i,u)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,u)}))}u(s.arg)}var o;this._invoke=function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}}function k(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=c(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function S(t){if(t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}return{next:j}}function j(){return{value:e,done:!0}}return g.prototype=y,s(x,"constructor",y),s(y,"constructor",g),g.displayName=s(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},P(O.prototype),s(O.prototype,i,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(x),s(x,u,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),M(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;M(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:S(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},864:function(t){"use strict";t.exports=AJS}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},"undefined"!=typeof AJS&&(r.p=AJS.contextPath()+"/s/112ad16d-96c8-425e-a65d-ec3853483e8d/_/download/resources/net.customware.confluence.plugin.reporting:assets-112ad16d-96c8-425e-a65d-ec3853483e8d/");var n={};!function(){"use strict";function t(t,e,r,n,o,a,i){try{var u=t[a](i),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function e(e){return function(){var r=this,n=arguments;return new Promise((function(o,a){var i=e.apply(r,n);function u(e){t(i,o,a,u,s,"next",e)}function s(e){t(i,o,a,u,s,"throw",e)}u(void 0)}))}}r.r(n);var o,a,i=r(135),u=r.n(i),s=r(41),l=r.n(s),c=r(864),f=r.n(c),p=r(409),d="reporting/1.0";function h(){return(h=e(u().mark((function t(){var e,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,p.initializeRocket)(o,a),t.next=3,(0,p.getHasUserSeen)(o,f().Meta.get("remote-user-key"),p.APPCUES_INLINE_DIALOG_POPUP);case 3:e=t.sent,r=e.hasUserSeen,(0,p.insertNewContainer)(l()({status:!r})),(0,p.insertNewHandler)(v),(0,p.insertRestPathOfPluginConsumer)(d);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function v(){var t="".concat(f().params.baseUrl,"/rest/").concat(d,"/on-boarding/analytics"),r="".concat(f().params.baseUrl,"/rest/").concat(d,"/appcues/identity");$(".reporting-ok-btn").click(function(){var n=e(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),(0,p.hideDialog)(),e.next=4,(0,p.fetchAppcuesScript)("//fast.appcues.com/23212.js");case 4:(0,p.initAppcues)(r),window.Appcues.show("-KhMJ80AQSAzMsE0sq6x"),(0,p.sendReportingAnalytics)(t,"OK_ON_BOARDING"),(0,p.markUserSeen)(o,f().Meta.get("remote-user-key"),p.APPCUES_INLINE_DIALOG_POPUP),(0,p.markUserSeen)(o,f().Meta.get("remote-user-key"),p.APPCUES_TUTORIAL_SLIDEOUT);case 9:case"end":return e.stop()}}),e)})));return function(t){return n.apply(this,arguments)}}())}f().bind("rte-ready",(function(){o="".concat(f().params.baseUrl,"/rest/reporting/1.0/on-boarding/seen"),a="".concat(f().params.baseUrl,"/rest/plugins/1.0/net.customware.confluence.plugin.reporting-key/media/plugin-icon"),function(){h.apply(this,arguments)}()}))}()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.scandio.confluence.plugins.pocketquery:pocketquery-macrobrowser-web-resources', location = '/pocketquery/frontend/bundle-macrobrowser.js' */
!function(){var e={6106:function(e,t,n){var r=n(4208);function a(e){return e?$.isArray(e)?e.length:Object.keys(e).length:0}function o(e){return!e||0===a(e)}r.registerHelper("eq",(function(e,t,n){return e===t?n.fn(this):n.inverse(this)})),r.registerHelper("empty",(function(e,t){return o(e)?t.fn(this):t.inverse(this)})),r.registerHelper("notEmpty",(function(e,t){return o(e)?t.inverse(this):t.fn(this)})),r.registerHelper("notEmpty",(function(e,t){return o(e)?t.inverse(this):t.fn(this)})),r.registerHelper("toJson",(function(e){return JSON.stringify(e)})),r.registerHelper("append",(function(e,t){return e+t})),r.registerHelper({not:function(e){return!e},and:function(){return Array.prototype.slice.call(arguments).every(Boolean)},or:function(){return Array.prototype.slice.call(arguments,0,-1).some(Boolean)},size:function(e){return a(e)},isEqual:function(e,t){return e===t},isEmpty:function(e){return o(e)},isNotEmpty:function(e){return!o(e)}})},9793:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({1:function(e,t,n,r,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                <li>"+e.escapeExpression(e.lambda(null!=t?o(t,"displayname"):t,t))+"</li>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a){var o,l,i=null!=t?t:e.nullContext||{},u=e.hooks.helperMissing,s="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="pq-dialog-associated-queries" class="aui-dialog2 aui-dialog2-small aui-dialog2-warning aui-layer"\n         role="dialog" aria-hidden="true">\n    <header class="aui-dialog2-header">\n        <h2 class="aui-dialog2-header-main">Cannot Remove!</h2>\n    </header>\n    <div class="aui-dialog2-content">\n        <p>This '+c(typeof(l=null!=(l=d(n,"entityType")||(null!=t?d(t,"entityType"):t))?l:u)===s?l.call(i,{name:"entityType",hash:{},data:a,loc:{start:{line:7,column:16},end:{line:7,column:30}}}):l)+" is still in use by the following queries:</p>\n        <ul>\n"+(null!=(o=d(n,"each").call(i,null!=t?d(t,"associatedQueries"):t,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:9,column:12},end:{line:11,column:21}}}))?o:"")+"        </ul>\n        <p>Please first change these queries to use a different "+c(typeof(l=null!=(l=d(n,"entityType")||(null!=t?d(t,"entityType"):t))?l:u)===s?l.call(i,{name:"entityType",hash:{},data:a,loc:{start:{line:13,column:64},end:{line:13,column:78}}}):l)+' and then try again.</p>\n    </div>\n    <footer class="aui-dialog2-footer">\n        <div class="aui-dialog2-footer-actions">\n            <button class="aui-button cancel">Acknowledge</button>\n        </div>\n    </footer>\n</section>'},useData:!0})},2076:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({1:function(e,t,n,r,a){return'                <button class="aui-button aui-button-link cancel">Cancel</button>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a){var o,l,i=null!=t?t:e.nullContext||{},u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="pq-dialog-confirm" class="aui-dialog2 aui-dialog2-small aui-layer aui-dialog2-warning" role="dialog" aria-hidden="true">\n    <header class="aui-dialog2-header">\n        <h2 class="aui-dialog2-header-main">Are you sure?</h2>\n    </header>\n    <div class="aui-dialog2-content">\n        <p>'+e.escapeExpression("function"==typeof(l=null!=(l=u(n,"text")||(null!=t?u(t,"text"):t))?l:e.hooks.helperMissing)?l.call(i,{name:"text",hash:{},data:a,loc:{start:{line:6,column:11},end:{line:6,column:19}}}):l)+'</p>\n    </div>\n    <footer class="aui-dialog2-footer">\n        <div class="aui-dialog2-footer-actions">\n            <button class="aui-button aui-button-primary confirm">Confirm</button>\n'+(null!=(o=u(n,"if").call(i,null!=t?u(t,"hasCancel"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:11,column:12},end:{line:13,column:19}}}))?o:"")+"        </div>\n    </footer>\n</section>"},useData:!0})},3826:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a){var o,l=null!=t?t:e.nullContext||{},i=e.hooks.helperMissing,u="function",s=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="pq-dialog-export" class="aui-dialog2 aui-dialog2-small aui-layer" role="dialog" aria-hidden="true">\n    <header class="aui-dialog2-header">\n        <h2 class="aui-dialog2-header-main">Include Related Entities</h2>\n    </header>\n    <div class="aui-dialog2-content">\n        <p>Do you want to <strong>include related entities</strong> of the query in the export?</p>\n        <p>This will apply to the selected custom template and converter. The datasource will only be included if you have the permission to maintain datasources.</p>\n    </div>\n    <footer class="aui-dialog2-footer">\n        <div class="aui-dialog2-footer-actions">\n            <a href="'+s(typeof(o=null!=(o=c(n,"contextPath")||(null!=t?c(t,"contextPath"):t))?o:i)===u?o.call(l,{name:"contextPath",hash:{},data:a,loc:{start:{line:11,column:21},end:{line:11,column:36}}}):o)+"/plugins/servlet/pocketquery/admin/doimportexport?type="+s(typeof(o=null!=(o=c(n,"entityType")||(null!=t?c(t,"entityType"):t))?o:i)===u?o.call(l,{name:"entityType",hash:{},data:a,loc:{start:{line:11,column:91},end:{line:11,column:105}}}):o)+"&name="+s(typeof(o=null!=(o=c(n,"entityName")||(null!=t?c(t,"entityName"):t))?o:i)===u?o.call(l,{name:"entityName",hash:{},data:a,loc:{start:{line:11,column:111},end:{line:11,column:125}}}):o)+'&includeRelated=true" class="aui-button aui-button-primary yes">Yes</a>\n            <a href="'+s(typeof(o=null!=(o=c(n,"contextPath")||(null!=t?c(t,"contextPath"):t))?o:i)===u?o.call(l,{name:"contextPath",hash:{},data:a,loc:{start:{line:12,column:21},end:{line:12,column:36}}}):o)+"/plugins/servlet/pocketquery/admin/doimportexport?type="+s(typeof(o=null!=(o=c(n,"entityType")||(null!=t?c(t,"entityType"):t))?o:i)===u?o.call(l,{name:"entityType",hash:{},data:a,loc:{start:{line:12,column:91},end:{line:12,column:105}}}):o)+"&name="+s(typeof(o=null!=(o=c(n,"entityName")||(null!=t?c(t,"entityName"):t))?o:i)===u?o.call(l,{name:"entityName",hash:{},data:a,loc:{start:{line:12,column:111},end:{line:12,column:125}}}):o)+'" class="aui-button aui-button-primary no">No</a>\n            <button class="aui-button aui-button-link cancel">Cancel</button>\n        </div>\n    </footer>\n</section>'},useData:!0})},9925:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({1:function(e,t,n,r,a){return'            <div class="footer-hint">This preview will remember your previous settings (<button class="aui-button aui-button-link clear-preview">clear</button>).</div>\n'},3:function(e,t,n,r,a){return'                <button class="aui-button aui-button-primary confirm">Save</button>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a){var o,l=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="pq-dialog-preview" class="aui-dialog2 aui-dialog2-large aui-layer"\n         role="dialog" aria-hidden="true" data-aui-remove-on-hide="true" data-aui-modal="true">\n    <header class="aui-dialog2-header">\n        <h2 class="aui-dialog2-header-main">Preview</h2>\n        <a class="aui-dialog2-header-close">\n\t\t\t<button type="button" class="aui-close-button" aria-label="{getText(\'aui.words.close\')}"></button>\n        </a>\n    </header>\n    <div class="aui-dialog2-content">\n    </div>\n    <footer class="aui-dialog2-footer">\n'+(null!=(o=i(n,"if").call(l,null!=t?i(t,"usePersistentMemory"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:12,column:2},end:{line:14,column:9}}}))?o:"")+'        <div class="aui-dialog2-footer-actions">\n'+(null!=(o=i(n,"eq").call(l,null!=t?i(t,"mode"):t,"view",{name:"eq",hash:{},fn:e.program(3,a,0),inverse:e.noop,data:a,loc:{start:{line:16,column:12},end:{line:18,column:19}}}))?o:"")+'            <button class="aui-button aui-button-link cancel">Close</button>\n        </div>\n    </footer>\n</section>\n'},useData:!0})},6297:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({1:function(e,t,n,r,a){return'checked="true" '},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a){var o,l,i=null!=t?t:e.nullContext||{},u=e.hooks.helperMissing,s="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="field-group" data-field="'+c(typeof(l=null!=(l=d(n,"key")||(null!=t?d(t,"key"):t))?l:u)===s?l.call(i,{name:"key",hash:{},data:a,loc:{start:{line:1,column:37},end:{line:1,column:44}}}):l)+'">\n    <aui-toggle tooltip-off '+(null!=(o=d(n,"if").call(i,d(n,"lookup").call(i,null!=t?d(t,"env"):t,null!=t?d(t,"key"):t,{name:"lookup",hash:{},data:a,loc:{start:{line:2,column:34},end:{line:2,column:50}}}),{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:28},end:{line:2,column:74}}}))?o:"")+'id="pq-field-'+c(typeof(l=null!=(l=d(n,"key")||(null!=t?d(t,"key"):t))?l:u)===s?l.call(i,{name:"key",hash:{},data:a,loc:{start:{line:2,column:87},end:{line:2,column:94}}}):l)+'" label="'+c(typeof(l=null!=(l=d(n,"label")||(null!=t?d(t,"label"):t))?l:u)===s?l.call(i,{name:"label",hash:{},data:a,loc:{start:{line:2,column:103},end:{line:2,column:112}}}):l)+'"></aui-toggle>\n    <aui-label for="pq-field-'+c(typeof(l=null!=(l=d(n,"key")||(null!=t?d(t,"key"):t))?l:u)===s?l.call(i,{name:"key",hash:{},data:a,loc:{start:{line:3,column:29},end:{line:3,column:36}}}):l)+'" resolved="">\n        <label for="pq-field-'+c(typeof(l=null!=(l=d(n,"key")||(null!=t?d(t,"key"):t))?l:u)===s?l.call(i,{name:"key",hash:{},data:a,loc:{start:{line:4,column:29},end:{line:4,column:36}}}):l)+'">'+c(typeof(l=null!=(l=d(n,"label")||(null!=t?d(t,"label"):t))?l:u)===s?l.call(i,{name:"label",hash:{},data:a,loc:{start:{line:4,column:38},end:{line:4,column:47}}}):l)+'<span class="aui-icon aui-icon-small aui-iconfont-help pocket-help-link pq-tooltip" data-gravity="w" title="'+c(typeof(l=null!=(l=d(n,"tooltip")||(null!=t?d(t,"tooltip"):t))?l:u)===s?l.call(i,{name:"tooltip",hash:{},data:a,loc:{start:{line:4,column:155},end:{line:4,column:166}}}):l)+'">Help</span></label>\n    </aui-label>\n</div>'},useData:!0})},2583:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({1:function(e,t,n,r,a){return" draft-entity-selected"},3:function(e,t,n,r,a){var o,l=e.lambda,i=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <option class="draft-entity-option" selected value="'+i(l(null!=t?u(t,"hardcodedDraftEntityName"):t,t))+'">DRAFT: '+i(l(null!=(o=null!=t?u(t,"draftEntity"):t)?u(o,"displayname"):o,t))+"</option>\n"+(null!=(o=u(n,"each").call(null!=t?t:e.nullContext||{},null!=t?u(t,"queries"):t,{name:"each",hash:{},fn:e.program(4,a,0),inverse:e.noop,data:a,loc:{start:{line:10,column:24},end:{line:12,column:33}}}))?o:"")},4:function(e,t,n,r,a){var o=e.lambda,l=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                            <option value="'+l(o(null!=t?i(t,"name"):t,t))+'">'+l(o(null!=t?i(t,"displayName"):t,t))+"</option>\n"},6:function(e,t,n,r,a,o,l){var i,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(i=u(n,"each").call(null!=t?t:e.nullContext||{},null!=t?u(t,"queries"):t,{name:"each",hash:{},fn:e.program(7,a,0,o,l),inverse:e.noop,data:a,loc:{start:{line:14,column:24},end:{line:16,column:33}}}))?i:""},7:function(e,t,n,r,a,o,l){var i,u=e.lambda,s=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                            <option value="'+s(u(null!=t?c(t,"name"):t,t))+'" '+(null!=(i=c(n,"eq").call(null!=t?t:e.nullContext||{},null!=(i=null!=l[1]?c(l[1],"env"):l[1])?c(i,"queryName"):i,null!=t?c(t,"name"):t,{name:"eq",hash:{},fn:e.program(8,a,0,o,l),inverse:e.noop,data:a,loc:{start:{line:15,column:58},end:{line:15,column:108}}}))?i:"")+">"+s(u(null!=t?c(t,"displayName"):t,t))+"</option>\n"},8:function(e,t,n,r,a){return" selected"},10:function(e,t,n,r,a){var o,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=l(n,"if").call(null!=t?t:e.nullContext||{},null!=(o=null!=t?l(t,"draftEntity"):t)?l(o,"description"):o,{name:"if",hash:{},fn:e.program(11,a,0),inverse:e.noop,data:a,loc:{start:{line:21,column:24},end:{line:23,column:31}}}))?o:""},11:function(e,t,n,r,a){var o,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                            "+e.escapeExpression(e.lambda(null!=(o=null!=t?l(t,"draftEntity"):t)?l(o,"description"):o,t))+"\n"},13:function(e,t,n,r,a){var o,l=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(o=i(n,"with").call(l,i(n,"lookup").call(l,null!=t?i(t,"queriesByName"):t,null!=(o=null!=t?i(t,"env"):t)?i(o,"queryName"):o,{name:"lookup",hash:{},data:a,loc:{start:{line:25,column:32},end:{line:25,column:68}}}),{name:"with",hash:{},fn:e.program(14,a,0),inverse:e.noop,data:a,loc:{start:{line:25,column:24},end:{line:27,column:33}}}))?o:""},14:function(e,t,n,r,a){var o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"                            "+e.escapeExpression(e.lambda(null!=t?o(t,"description"):t,t))+"\n"},16:function(e,t,r,a,o){var l,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(l=e.invokePartial(n(2432),t,{name:"query-parameters",hash:{queryParameters:null!=t?i(t,"queryParameters"):t,queryParameterNames:null!=t?i(t,"queryParameterNames"):t},data:o,indent:"                    ",helpers:r,partials:a,decorators:e.decorators}))?l:""},18:function(e,t,n,r,a){return"                    <span>Select a query to show its parameters.</span>\n"},20:function(e,t,r,a,o){var l,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(l=e.invokePartial(n(6297),t,{name:"fieldgroup-boolean",hash:{tooltip:"Display meta information about your query execution.",env:null!=t?i(t,"env"):t,key:"debug",label:"Debug Mode"},data:o,indent:"                ",helpers:r,partials:a,decorators:e.decorators}))?l:""},22:function(e,t,n,r,a){var o,l=null!=t?t:e.nullContext||{},i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <div id="pq-simulate-container">\n                    <div id="pq-search-input-content" class="search-input'+(null!=(o=i(n,"if").call(l,null!=(o=null!=t?i(t,"env"):t)?i(o,"contentKey"):o,{name:"if",hash:{},fn:e.program(23,a,0),inverse:e.noop,data:a,loc:{start:{line:69,column:73},end:{line:69,column:112}}}))?o:"")+'">\n                        <span class="aui-icon aui-icon-small aui-iconfont-remove icon-clear"></span>\n                        <span class="aui-icon aui-icon-small aui-iconfont-page icon-content"></span>\n                        <input id="pq-field-contentKey" class="text pq-aui-select2" type="text" '+(null!=(o=i(n,"if").call(l,null!=(o=null!=t?i(t,"env"):t)?i(o,"contentKey"):o,{name:"if",hash:{},fn:e.program(25,a,0),inverse:e.noop,data:a,loc:{start:{line:72,column:96},end:{line:72,column:151}}}))?o:"")+'\n                               placeholder="Simulate a page..." data-none-message="No matching content found"\n                               autocomplete="off" />\n                    </div>\n\n                    <div id="pq-search-input-user" class="search-input'+(null!=(o=i(n,"if").call(l,null!=(o=null!=t?i(t,"env"):t)?i(o,"userKey"):o,{name:"if",hash:{},fn:e.program(23,a,0),inverse:e.noop,data:a,loc:{start:{line:77,column:70},end:{line:77,column:106}}}))?o:"")+'">\n                        <span class="aui-icon aui-icon-small aui-iconfont-remove icon-clear"></span>\n                        <span class="aui-icon aui-icon-small aui-iconfont-person icon-user"></span>\n                        <input id="pq-field-userKey" class="text pq-aui-select2" type="text" '+(null!=(o=i(n,"if").call(l,null!=(o=null!=t?i(t,"env"):t)?i(o,"userKey"):o,{name:"if",hash:{},fn:e.program(27,a,0),inverse:e.noop,data:a,loc:{start:{line:80,column:93},end:{line:80,column:142}}}))?o:"")+'\n                               placeholder="Simulate a user..." data-none-message="No matching user found"\n                               autocomplete="off" />\n                    </div>\n                    <span class="aui-icon aui-icon-small aui-iconfont-help pocket-help-link pq-tooltip" data-gravity="e" title="You can simulate the execution of the query based on a specific content and user. This can be convenient if you want to test wildcards for query parameters."></span>\n                </div>\n'},23:function(e,t,n,r,a){return" has-value"},25:function(e,t,n,r,a){var o,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'value="'+e.escapeExpression(e.lambda(null!=(o=null!=t?l(t,"env"):t)?l(o,"contentKey"):o,t))+'"'},27:function(e,t,n,r,a){var o,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'value="'+e.escapeExpression(e.lambda(null!=(o=null!=t?l(t,"env"):t)?l(o,"userKey"):o,t))+'"'},compiler:[8,">= 4.3.0"],main:function(e,t,r,a,o,l,i){var u,s=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<form id="pq-preview-form" class="aui top-label'+(null!=(u=c(r,"if").call(s,null!=t?c(t,"draftEntity"):t,{name:"if",hash:{},fn:e.program(1,o,0,l,i),inverse:e.noop,data:o,loc:{start:{line:1,column:47},end:{line:1,column:95}}}))?u:"")+'">\n    <div class="pq-preview-left">\n        <fieldset>\n            <label>Query<span class="aui-icon aui-icon-small aui-iconfont-help pocket-help-link pq-tooltip" title="Choose the query that you would like to execute." data-gravity="w">Help</span></label>\n            <div class="field-group" data-field="queryName">\n                <select id="pq-field-queryName" class="pq-aui-select2" data-placeholder="Please select a query">\n                    <option></option>\n'+(null!=(u=c(r,"if").call(s,null!=t?c(t,"draftEntity"):t,{name:"if",hash:{},fn:e.program(3,o,0,l,i),inverse:e.program(6,o,0,l,i),data:o,loc:{start:{line:8,column:20},end:{line:17,column:27}}}))?u:"")+'                </select>\n                <div class="description">\n'+(null!=(u=c(r,"if").call(s,null!=t?c(t,"draftEntity"):t,{name:"if",hash:{},fn:e.program(10,o,0,l,i),inverse:e.program(13,o,0,l,i),data:o,loc:{start:{line:20,column:20},end:{line:28,column:27}}}))?u:"")+'                </div>\n                <div class="draft-entity-message aui-message aui-message-warning">\n                    <p>This is the preview for the draft query data currently open in your form.</p>\n                </div>\n            </div>\n        </fieldset>\n\n        <fieldset>\n            <label>Query Parameters<span class="aui-icon aui-icon-small aui-iconfont-help pocket-help-link pq-tooltip" data-gravity="w" title="The parameters for your query.">Help</span></label>\n            <div class="field-group" data-field="queryParameters">\n'+(null!=(u=c(r,"if").call(s,c(r,"or").call(s,null!=(u=null!=t?c(t,"env"):t)?c(u,"queryName"):u,null!=t?c(t,"draftEntity"):t,{name:"or",hash:{},data:o,loc:{start:{line:39,column:22},end:{line:39,column:52}}}),{name:"if",hash:{},fn:e.program(16,o,0,l,i),inverse:e.program(18,o,0,l,i),data:o,loc:{start:{line:39,column:16},end:{line:43,column:23}}}))?u:"")+'            </div>\n        </fieldset>\n\n        <fieldset class="fieldset-settings">\n            <label>Settings</label>\n'+(null!=(u=e.invokePartial(n(6297),t,{name:"fieldgroup-boolean",hash:{tooltip:"With this setting, the query will be executed in the background without delaying the loading of the page. You will see a spinning wheel while it is being loaded.",env:null!=t?c(t,"env"):t,key:"dynamicLoad",label:"Load dynamically"},data:o,indent:"            ",helpers:r,partials:a,decorators:e.decorators}))?u:"")+(null!=(u=e.invokePartial(n(6297),t,{name:"fieldgroup-boolean",hash:{tooltip:"Adds a button to the result in the top right corner where the query can be re-executed.",env:null!=t?c(t,"env"):t,key:"includeReloadButton",label:"Include reload button"},data:o,indent:"            ",helpers:r,partials:a,decorators:e.decorators}))?u:"")+(null!=(u=e.invokePartial(n(6297),t,{name:"fieldgroup-boolean",hash:{tooltip:"Allows to set the values for query parameters through GET parameters in the URL. For example, to assign a value to the query parameter 'param', append '?pq_param=value' to the URL. This can be used to share links containing pre-filled PocketQuery parameters.",env:null!=t?c(t,"env"):t,key:"allowGetParams",label:"Allow URL parameters"},data:o,indent:"            ",helpers:r,partials:a,decorators:e.decorators}))?u:"")+(null!=(u=e.invokePartial(n(6297),t,{name:"fieldgroup-boolean",hash:{tooltip:"Include a form where you can dynamically change the query parameters.",env:null!=t?c(t,"env"):t,key:"includeChangeTemplate",label:"Use change params template"},data:o,indent:"            ",helpers:r,partials:a,decorators:e.decorators}))?u:"")+(null!=(u=e.invokePartial(n(6297),t,{name:"fieldgroup-boolean",hash:{tooltip:"With this setting the query will not execute automatically when you load the page, but you will have to trigger it manually by clicking a button.",env:null!=t?c(t,"env"):t,key:"disableAutoload",label:"Disable autoload"},data:o,indent:"            ",helpers:r,partials:a,decorators:e.decorators}))?u:"")+(null!=(u=c(r,"if").call(s,null!=t?c(t,"pocketQueryEditor"):t,{name:"if",hash:{},fn:e.program(20,o,0,l,i),inverse:e.noop,data:o,loc:{start:{line:54,column:12},end:{line:56,column:19}}}))?u:"")+'        </fieldset>\n\n    </div>\n\n    <div class="pq-preview-right">\n        <div class="top-row">\n            <button id="pq-load-button" class="aui-button aui-button-subtle">\n                <span class="aui-icon aui-icon-small aui-iconfont-refresh">Load Preview</span>\n                Preview\n            </button>\n'+(null!=(u=c(r,"eq").call(s,null!=t?c(t,"mode"):t,"admin",{name:"eq",hash:{},fn:e.program(22,o,0,l,i),inverse:e.noop,data:o,loc:{start:{line:67,column:12},end:{line:86,column:19}}}))?u:"")+'        </div>\n        <div id="pq-preview-iframe-container">\n\n        </div>\n    </div>\n\n</form>\n'},usePartial:!0,useData:!0,useDepths:!0})},2432:function(e,t,n){var r=n(1524);e.exports=(r.default||r).template({1:function(e,t,n,r,a){return"    <span>There are no parameters for this query.</span>\n"},3:function(e,t,n,r,a,o,l){var i,u,s=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <ul id="query-parameter-list" data-queryname="'+e.escapeExpression("function"==typeof(u=null!=(u=c(n,"queryName")||(null!=t?c(t,"queryName"):t))?u:e.hooks.helperMissing)?u.call(s,{name:"queryName",hash:{},data:a,loc:{start:{line:4,column:50},end:{line:4,column:63}}}):u)+'">\n'+(null!=(i=c(n,"each").call(s,null!=t?c(t,"queryParameterNames"):t,{name:"each",hash:{},fn:e.program(4,a,0,o,l),inverse:e.noop,data:a,loc:{start:{line:5,column:8},end:{line:10,column:17}}}))?i:"")+"    </ul>\n"},4:function(e,t,n,r,a,o,l){var i,u=e.lambda,s=e.escapeExpression,c=null!=t?t:e.nullContext||{},d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <li>\n                <label for="pq-parameter-'+s(u(t,t))+'">'+s(u(t,t))+'</label>\n                <input autocomplete="off" '+(null!=(i=d(n,"if").call(c,d(n,"lookup").call(c,null!=l[1]?d(l[1],"queryParameters"):l[1],t,{name:"lookup",hash:{},data:a,loc:{start:{line:8,column:48},end:{line:8,column:80}}}),{name:"if",hash:{},fn:e.program(5,a,0,o,l),inverse:e.noop,data:a,loc:{start:{line:8,column:42},end:{line:8,column:132}}}))?i:"")+'data-parametername="'+s(u(t,t))+'" type="text" class="text" name="pq-parameter-'+s(u(t,t))+'">\n            </li>\n'},5:function(e,t,n,r,a,o,l){var i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'value="'+e.escapeExpression(i(n,"lookup").call(null!=t?t:e.nullContext||{},null!=l[1]?i(l[1],"queryParameters"):l[1],t,{name:"lookup",hash:{},data:a,loc:{start:{line:8,column:89},end:{line:8,column:123}}}))+'" '},compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a,o,l){var i,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(i=u(n,"empty").call(null!=t?t:e.nullContext||{},null!=t?u(t,"queryParameterNames"):t,{name:"empty",hash:{},fn:e.program(1,a,0,o,l),inverse:e.program(3,a,0,o,l),data:a,loc:{start:{line:1,column:0},end:{line:12,column:10}}}))?i:""},useData:!0,useDepths:!0})},4208:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.__esModule=!0;var o=a(n(7060)),l=r(n(5442)),i=r(n(4936)),u=a(n(3303)),s=a(n(9657)),c=r(n(3779));function d(){var e=new o.HandlebarsEnvironment;return u.extend(e,o),e.SafeString=l.default,e.Exception=i.default,e.Utils=u,e.escapeExpression=u.escapeExpression,e.VM=s,e.template=function(t){return s.template(t,e)},e}var p=d();p.create=d,c.default(p),p.default=p,t.default=p,e.exports=t.default},7060:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.HandlebarsEnvironment=d;var a=n(3303),o=r(n(4936)),l=n(9228),i=n(2024),u=r(n(5324)),s=n(5434);t.VERSION="4.7.7",t.COMPILER_REVISION=8,t.LAST_COMPATIBLE_COMPILER_REVISION=7,t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var c="[object Object]";function d(e,t,n){this.helpers=e||{},this.partials=t||{},this.decorators=n||{},l.registerDefaultHelpers(this),i.registerDefaultDecorators(this)}d.prototype={constructor:d,logger:u.default,log:u.default.log,registerHelper:function(e,t){if(a.toString.call(e)===c){if(t)throw new o.default("Arg not supported with multiple helpers");a.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(a.toString.call(e)===c)a.extend(this.partials,e);else{if(void 0===t)throw new o.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(a.toString.call(e)===c){if(t)throw new o.default("Arg not supported with multiple decorators");a.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){s.resetLoggedProperties()}};var p=u.default.log;t.log=p,t.createFrame=a.createFrame,t.logger=u.default},2024:function(e,t,n){"use strict";t.__esModule=!0,t.registerDefaultDecorators=function(e){a.default(e)};var r,a=(r=n(882))&&r.__esModule?r:{default:r}},882:function(e,t,n){"use strict";t.__esModule=!0;var r=n(3303);t.default=function(e){e.registerDecorator("inline",(function(e,t,n,a){var o=e;return t.partials||(t.partials={},o=function(a,o){var l=n.partials;n.partials=r.extend({},l,t.partials);var i=e(a,o);return n.partials=l,i}),t.partials[a.args[0]]=a.fn,o}))},e.exports=t.default},4936:function(e,t){"use strict";t.__esModule=!0;var n=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function r(e,t){var a=t&&t.loc,o=void 0,l=void 0,i=void 0,u=void 0;a&&(o=a.start.line,l=a.end.line,i=a.start.column,u=a.end.column,e+=" - "+o+":"+i);for(var s=Error.prototype.constructor.call(this,e),c=0;c<n.length;c++)this[n[c]]=s[n[c]];Error.captureStackTrace&&Error.captureStackTrace(this,r);try{a&&(this.lineNumber=o,this.endLineNumber=l,Object.defineProperty?(Object.defineProperty(this,"column",{value:i,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:u,enumerable:!0})):(this.column=i,this.endColumn=u))}catch(e){}}r.prototype=new Error,t.default=r,e.exports=t.default},9228:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.registerDefaultHelpers=function(e){a.default(e),o.default(e),l.default(e),i.default(e),u.default(e),s.default(e),c.default(e)},t.moveHelperToHooks=function(e,t,n){e.helpers[t]&&(e.hooks[t]=e.helpers[t],n||delete e.helpers[t])};var a=r(n(2984)),o=r(n(31)),l=r(n(81)),i=r(n(691)),u=r(n(4668)),s=r(n(7245)),c=r(n(7420))},2984:function(e,t,n){"use strict";t.__esModule=!0;var r=n(3303);t.default=function(e){e.registerHelper("blockHelperMissing",(function(t,n){var a=n.inverse,o=n.fn;if(!0===t)return o(this);if(!1===t||null==t)return a(this);if(r.isArray(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):a(this);if(n.data&&n.ids){var l=r.createFrame(n.data);l.contextPath=r.appendContextPath(n.data.contextPath,n.name),n={data:l}}return o(t,n)}))},e.exports=t.default},31:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(3303),o=(r=n(4936))&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("each",(function(e,t){if(!t)throw new o.default("Must pass iterator to #each");var r,l=t.fn,i=t.inverse,u=0,s="",c=void 0,d=void 0;function p(t,n,r){c&&(c.key=t,c.index=n,c.first=0===n,c.last=!!r,d&&(c.contextPath=d+t)),s+=l(e[t],{data:c,blockParams:a.blockParams([e[t],t],[d+t,null])})}if(t.data&&t.ids&&(d=a.appendContextPath(t.data.contextPath,t.ids[0])+"."),a.isFunction(e)&&(e=e.call(this)),t.data&&(c=a.createFrame(t.data)),e&&"object"==typeof e)if(a.isArray(e))for(var f=e.length;u<f;u++)u in e&&p(u,u,u===e.length-1);else if(n.g.Symbol&&e[n.g.Symbol.iterator]){for(var m=[],h=e[n.g.Symbol.iterator](),y=h.next();!y.done;y=h.next())m.push(y.value);for(f=(e=m).length;u<f;u++)p(u,u,u===e.length-1)}else r=void 0,Object.keys(e).forEach((function(e){void 0!==r&&p(r,u-1),r=e,u++})),void 0!==r&&p(r,u-1,!0);return 0===u&&(s=i(this)),s}))},e.exports=t.default},81:function(e,t,n){"use strict";t.__esModule=!0;var r,a=(r=n(4936))&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new a.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},e.exports=t.default},691:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(3303),o=(r=n(4936))&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("if",(function(e,t){if(2!=arguments.length)throw new o.default("#if requires exactly one argument");return a.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||a.isEmpty(e)?t.inverse(this):t.fn(this)})),e.registerHelper("unless",(function(t,n){if(2!=arguments.length)throw new o.default("#unless requires exactly one argument");return e.helpers.if.call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}))},e.exports=t.default},4668:function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("log",(function(){for(var t=[void 0],n=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)t.push(arguments[r]);var a=1;null!=n.hash.level?a=n.hash.level:n.data&&null!=n.data.level&&(a=n.data.level),t[0]=a,e.log.apply(e,t)}))},e.exports=t.default},7245:function(e,t){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("lookup",(function(e,t,n){return e?n.lookupProperty(e,t):e}))},e.exports=t.default},7420:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(3303),o=(r=n(4936))&&r.__esModule?r:{default:r};t.default=function(e){e.registerHelper("with",(function(e,t){if(2!=arguments.length)throw new o.default("#with requires exactly one argument");a.isFunction(e)&&(e=e.call(this));var n=t.fn;if(a.isEmpty(e))return t.inverse(this);var r=t.data;return t.data&&t.ids&&((r=a.createFrame(t.data)).contextPath=a.appendContextPath(t.data.contextPath,t.ids[0])),n(e,{data:r,blockParams:a.blockParams([e],[r&&r.contextPath])})}))},e.exports=t.default},6547:function(e,t,n){"use strict";t.__esModule=!0,t.createNewLookupObject=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.extend.apply(void 0,[Object.create(null)].concat(t))};var r=n(3303)},5434:function(e,t,n){"use strict";t.__esModule=!0,t.createProtoAccessControl=function(e){var t=Object.create(null);t.constructor=!1,t.__defineGetter__=!1,t.__defineSetter__=!1,t.__lookupGetter__=!1;var n=Object.create(null);return n.__proto__=!1,{properties:{whitelist:r.createNewLookupObject(n,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:r.createNewLookupObject(t,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},t.resultIsAllowed=function(e,t,n){return function(e,t){return void 0!==e.whitelist[t]?!0===e.whitelist[t]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==o[e]&&(o[e]=!0,a.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(t),!1)}("function"==typeof e?t.methods:t.properties,n)},t.resetLoggedProperties=function(){Object.keys(o).forEach((function(e){delete o[e]}))};var r=n(6547),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(5324)),o=Object.create(null)},1208:function(e,t){"use strict";t.__esModule=!0,t.wrapHelper=function(e,t){return"function"!=typeof e?e:function(){return arguments[arguments.length-1]=t(arguments[arguments.length-1]),e.apply(this,arguments)}}},5324:function(e,t,n){"use strict";t.__esModule=!0;var r=n(3303),a={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=r.indexOf(a.methodMap,e.toLowerCase());e=t>=0?t:parseInt(e,10)}return e},log:function(e){if(e=a.lookupLevel(e),"undefined"!=typeof console&&a.lookupLevel(a.level)<=e){var t=a.methodMap[e];console[t]||(t="log");for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];console[t].apply(console,r)}}};t.default=a,e.exports=t.default},3779:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e){var t=void 0!==n.g?n.g:window,r=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=r),e}},e.exports=t.default},9657:function(e,t,n){"use strict";t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,n=l.COMPILER_REVISION;if(!(t>=l.LAST_COMPATIBLE_COMPILER_REVISION&&t<=l.COMPILER_REVISION)){if(t<l.LAST_COMPATIBLE_COMPILER_REVISION){var r=l.REVISION_CHANGES[n],a=l.REVISION_CHANGES[t];throw new o.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+a+").")}throw new o.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},t.template=function(e,t){if(!t)throw new o.default("No environment passed to template");if(!e||!e.main)throw new o.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var n=e.compiler&&7===e.compiler[0],r={strict:function(e,t,n){if(!e||!(t in e))throw new o.default('"'+t+'" not defined in '+e,{loc:n});return r.lookupProperty(e,t)},lookupProperty:function(e,t){var n=e[t];return null==n||Object.prototype.hasOwnProperty.call(e,t)||s.resultIsAllowed(n,r.protoAccessControl,t)?n:void 0},lookup:function(e,t){for(var n=e.length,a=0;a<n;a++)if(null!=(e[a]&&r.lookupProperty(e[a],t)))return e[a][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:a.escapeExpression,invokePartial:function(n,r,l){l.hash&&(r=a.extend({},r,l.hash),l.ids&&(l.ids[0]=!0)),n=t.VM.resolvePartial.call(this,n,r,l);var i=a.extend({},l,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),u=t.VM.invokePartial.call(this,n,r,i);if(null==u&&t.compile&&(l.partials[l.name]=t.compile(n,e.compilerOptions,t),u=l.partials[l.name](r,i)),null!=u){if(l.indent){for(var s=u.split("\n"),c=0,d=s.length;c<d&&(s[c]||c+1!==d);c++)s[c]=l.indent+s[c];u=s.join("\n")}return u}throw new o.default("The partial "+l.name+" could not be compiled when running in runtime-only mode")},fn:function(t){var n=e[t];return n.decorator=e[t+"_d"],n},programs:[],program:function(e,t,n,r,a){var o=this.programs[e],l=this.fn(e);return t||a||r||n?o=c(this,e,l,t,n,r,a):o||(o=this.programs[e]=c(this,e,l)),o},data:function(e,t){for(;e&&t--;)e=e._parent;return e},mergeIfNeeded:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=a.extend({},t,e)),n},nullContext:Object.seal({}),noop:t.VM.noop,compilerInfo:e.compiler};function l(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=n.data;l._setup(n),!n.partial&&e.useData&&(a=p(t,a));var o=void 0,i=e.useBlockParams?[]:void 0;function u(t){return""+e.main(r,t,r.helpers,r.partials,a,i,o)}return e.useDepths&&(o=n.depths?t!=n.depths[0]?[t].concat(n.depths):n.depths:[t]),(u=f(e.main,u,r,n.depths||[],a,i))(t,n)}return l.isTop=!0,l._setup=function(o){if(o.partial)r.protoAccessControl=o.protoAccessControl,r.helpers=o.helpers,r.partials=o.partials,r.decorators=o.decorators,r.hooks=o.hooks;else{var l=a.extend({},t.helpers,o.helpers);!function(e,t){Object.keys(e).forEach((function(n){var r=e[n];e[n]=function(e,t){var n=t.lookupProperty;return u.wrapHelper(e,(function(e){return a.extend({lookupProperty:n},e)}))}(r,t)}))}(l,r),r.helpers=l,e.usePartial&&(r.partials=r.mergeIfNeeded(o.partials,t.partials)),(e.usePartial||e.useDecorators)&&(r.decorators=a.extend({},t.decorators,o.decorators)),r.hooks={},r.protoAccessControl=s.createProtoAccessControl(o);var c=o.allowCallsToHelperMissing||n;i.moveHelperToHooks(r,"helperMissing",c),i.moveHelperToHooks(r,"blockHelperMissing",c)}},l._child=function(t,n,a,l){if(e.useBlockParams&&!a)throw new o.default("must pass block params");if(e.useDepths&&!l)throw new o.default("must pass parent depths");return c(r,t,e[t],n,0,a,l)},l},t.wrapProgram=c,t.resolvePartial=function(e,t,n){return e?e.call||n.name||(n.name=e,e=n.partials[e]):e="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name],e},t.invokePartial=function(e,t,n){var r=n.data&&n.data["partial-block"];n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var i=void 0;if(n.fn&&n.fn!==d&&function(){n.data=l.createFrame(n.data);var e=n.fn;i=n.data["partial-block"]=function(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return n.data=l.createFrame(n.data),n.data["partial-block"]=r,e(t,n)},e.partials&&(n.partials=a.extend({},n.partials,e.partials))}(),void 0===e&&i&&(e=i),void 0===e)throw new o.default("The partial "+n.name+" could not be found");if(e instanceof Function)return e(t,n)},t.noop=d;var r,a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(3303)),o=(r=n(4936))&&r.__esModule?r:{default:r},l=n(7060),i=n(9228),u=n(1208),s=n(5434);function c(e,t,n,r,a,o,l){function i(t){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=l;return!l||t==l[0]||t===e.nullContext&&null===l[0]||(i=[t].concat(l)),n(e,t,e.helpers,e.partials,a.data||r,o&&[a.blockParams].concat(o),i)}return(i=f(n,i,e,l,r,o)).program=t,i.depth=l?l.length:0,i.blockParams=a||0,i}function d(){return""}function p(e,t){return t&&"root"in t||((t=t?l.createFrame(t):{}).root=e),t}function f(e,t,n,r,o,l){if(e.decorator){var i={};t=e.decorator(t,i,n,r&&r[0],o,l,r),a.extend(t,i)}return t}},5442:function(e,t){"use strict";function n(e){this.string=e}t.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},t.default=n,e.exports=t.default},3303:function(e,t){"use strict";t.__esModule=!0,t.extend=l,t.indexOf=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return a.test(e)?e.replace(r,o):e},t.isEmpty=function(e){return!e&&0!==e||!(!s(e)||0!==e.length)},t.createFrame=function(e){var t=l({},e);return t._parent=e,t},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},r=/[&<>"'`=]/g,a=/[&<>"'`=]/;function o(e){return n[e]}function l(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}var i=Object.prototype.toString;t.toString=i;var u=function(e){return"function"==typeof e};u(/x/)&&(t.isFunction=u=function(e){return"function"==typeof e&&"[object Function]"===i.call(e)}),t.isFunction=u;var s=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===i.call(e)};t.isArray=s},1524:function(e,t,n){e.exports=n(4208).default}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=n(2076),t=n.n(e),r=n(3826),a=n.n(r),o=n(9793),l=n.n(o),i=n(9925),u=n.n(i);function s(e,t,n){var r=$(e),a={group:function(e){return $.map(e.result,(function(e){return{id:e.name,text:e.name}}))},user:function(e){return $.map(e.result,(function(e){return{id:e.userKey,text:e.title}}))},content:function(e){var t=[],n=[];return e.group.length>0&&(t=e.group[0].result),e.group.length>1&&(n=e.group[1].result),$.map(t,(function(e){return{id:e.id,text:"".concat(e.title," (").concat(e.space.key,")")}})).concat($.map(n,(function(e){return{id:e.id,text:"".concat(e.title," (").concat(e.space.key,")")}})))}},o={minimumInputLength:3,maximumSelectionLength:1,ajax:{url:"".concat(x.getContextPath(),"/rest/prototype/1/search/").concat({user:"user.json?max-results=15",content:"name.json?max-results=10&pageSize=15&type=page,blogpost",group:"group.json?max-results=15"}[t]),dataType:"json",data:function(e){return{query:e}},results:function(e){return{results:a[t](e)}}}};n&&n.key&&n.text&&(o.initSelection=function(e,t){t({id:n.key,text:n.text})}),r.auiSelect2(o).on("change",(function(e){var t=$(this).closest(".search-input");e.val?t.addClass("has-value"):t.removeClass("has-value")}))}var c=function(e,t){s(e,"user",t)},d=function(e,t){s(e,"content",t)},p={warn:m()?AJS.warn:console.log,log:m()?AJS.log:console.log,debug:m()?AJS.log:console.log,error:m()?AJS.logError:console.log},f={};function m(){return"undefined"!=typeof AJS}function h(){return m()&&void 0!==AJS.Meta}function y(){return v("context-path")?v("context-path"):AJS.contextPath?AJS.contextPath():""}function v(e){return h()?AJS.Meta.get(e):""}function g(e){m()&&AJS.toInit?AJS.toInit(e):$(document).ready(e)}var b={error:function(e){m()?AJS.messages.error(e):p.error("Missing AJS for `Platform.messages.error`")}};function w(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.confirmFn,o=r.cancelFn,l="#pq-".concat(e),i=function(){AJS.dialog2(l).hide(),$(l).remove()};$(l).length&&i();var u=$(t(n));return $(document.body).append(u),AJS.dialog2(l).show(),u.find(".confirm").one("click",(function(){a&&a(),i()})),u.find(".cancel, .icon-close").one("click",(function(){o&&o(),i()})),u}function P(){return"localStorage"in window}var x={getSafe$:function(){var e;return m()&&AJS.$?e=AJS.$:"undefined"!=typeof jQuery?e=jQuery:"undefined"!=typeof $&&(e=$),e},newDialogExport:function(e,t){return w("dialog-export",a(),{entityType:e,entityName:t,contextPath:y()})},newDialogConfirm:function(e,n){return w("dialog-confirm",t(),{text:e,hasCancel:!!n},{confirmFn:n})},getContextPath:y,auiMajorVersionAtLeast:function(e){var t=!1;try{m()&&(t=Number(AJS.version.split(".")[0])>=e)}catch(e){p.warn("Could not check AUI version",e)}return t},getText:function(e){return f[e]||e},getContentId:function(){if(h())return AJS.Meta.get("content-id")||AJS.Meta.get("page-id");p.warn("Missing AJS for `Platform.getContentId(). Leaving undefined.`")},getContextKey:function(){if(h())return AJS.Meta.get("space-key");p.warn("Missing AJS for `Platform.getContextKey(). Leaving undefined.`")},log:p,messages:b,bind:function(e,t){m()?AJS.bind(e,t):p.error("Missing AJS for AJS.bind")},flag:function(e){m()?AJS.flag(e):p.error("Missing AJS for `AJS.flag()`")},trigger:function(e){m()?AJS.trigger(e):p.error("Missing AJS for AJS.trigger")},isReadOnlyMode:function(){return m()&&"READ_ONLY"===v("access-mode")},ready:g,readyForDynamicLoad:function(e){g((function(){var t=function(){return $(document).bind("issueRefreshed inlineEditSaveComplete",e)},n=$("body");n.hasClass("ajax-issue-search-and-view")?t():(e(),n.hasClass("page-issue-navigator")&&t())}))},auiSelect2:function(e){e.auiSelect2()},setMacroJsOverride:function(e,t){m()&&("undefined"!=typeof tinyMCE||AJS.MacroBrowser)?AJS.MacroBrowser&&AJS.MacroBrowser.setMacroJsOverride(e,t):m()?p.error("Missing AJS.MacroBrowser for `setMacroJsOverride`"):p.error("Missing AJS for `setMacroJsOverride`")},_setTranslations:function(e){f=e},newDialogAssociatedQueries:function(e,t){return w("dialog-associated-queries",l(),{entityType:e,associatedQueries:t})},newPreviewDialog:function(e,t){var n=t.confirmFn,r=t.cancelFn,a=t.usePersistentMemory;return w("dialog-preview",u(),{mode:e,usePersistentMemory:a},{confirmFn:n,cancelFn:r})},autocompleteUser:function(e,t){c(e,t)},autocompleteContent:function(e,t){d(e,t)},savePreviewMemory:function(e){P()&&localStorage.setItem("previewEnv",JSON.stringify(e))},getPreviewMemory:function(){var e={};if(P()){var t=localStorage.getItem("previewEnv");if(t)try{e=JSON.parse(t)}catch(e){p.debug("Could not json-parse string from env memory: "+t)}}return e},clearMemory:function(){localStorage.clear()},getFromOrigin:function(){var e=null;return window.location.search&&window.location.search.indexOf("from=import")>=0&&(e="import"),e}},k=(n(6106),n(2583)),q=n.n(k),_=n(2432),O=n.n(_);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){return e&&(x.log.debug("PQ encoding parameter value: ",e),e=(e=encodeURIComponent(e)).replace(/=/g,"%3D").replace(/&/g,"%26"),x.log.debug("PQ result: ",e)),e}function M(e){return e&&(x.log.debug("PQ decoding parameter value: ",e),e=(e=decodeURIComponent(e)).replace(/%3D/g,"=").replace(/%26/g,"&"),x.log.debug("PQ result: ",e)),e}var C=function(e,t){t=t||{},e=e||{};var n=[],r=function(r,a){var o,l=r;t.keyPrefix&&(r=t.keyPrefix+r),o=e[r],t.encodeParameterValues&&(o=A(o)),n.push(r+"="+o),!0===a&&delete e[l]};return"array"===$.type(t.order)&&$.each(t.order,(function(e,t){r(t,!0)})),$.each(Object.keys(e).sort(),(function(e,t){r(t)})),n.join("&")},E=function(e,t){var n={},r=e.split("&");return t=t||{},$.each(r,(function(e,r){var a=r.split("=");if(2===a.length){var o=a[0],l=a[1];t.keyPrefix&&(o=t.keyPrefix+o),t.decodeParameterValues&&(l=M(l)),n[o]=l}})),n},N=function(e){var t,n=[];return e&&(n=e.match(/:(?=[^']*(?:'[^']*'[^']*)*$)([a-zA-Z@][a-zA-Z0-9_-]*)/g)||[],n=(n=(t=new Set(n),n=function(e){if(Array.isArray(e))return S(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e){return e.replace(":","")}))).filter((function(e){return e.indexOf("@")<0}))),n};function j(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D,I="pq-error",L="draft-entity-selected",H="___DRAFT___ENTITY___NAME___",J={responseData:{queries:null,pocketQueryEditor:!1},queriesByName:{},$dialog:null,$querySelect:null,$form:null,$inputContentKey:null,currentQueryName:null,currentDraftEntity:null,draftParameterNames:[],queryParameterMemory:{}};function R(){D=$.extend({},J)}function F(){return D.$querySelect.val()}function Q(){var e={};return $("#query-parameter-list input").each((function(){var t=$(this),n=t.attr("data-parametername");e[n]=t.val()})),e}function B(){var e={includeChangeTemplate:["dynamicLoad","allowGetParams"],includeReloadButton:["dynamicLoad"],disableAutoload:["dynamicLoad"]},t=function(e){return e.attr("disabled","disabled").prop("checked",!1)},n=function(e){return e.removeAttr("disabled")},r=$("#pq-field-dynamicLoad");for(var a in D.currentDraftEntity&&D.$querySelect.find(":selected").hasClass("draft-entity-option")?t(r):n(r),e){var o,l=$("#pq-field-".concat(a)),i=!1,u=j(e[a]);try{for(u.s();!(o=u.n()).done;){var s=o.value;if($("#pq-field-".concat(s)).prop("checked")){i=!0;break}}}catch(e){u.e(e)}finally{u.f()}i?n(l):t(l)}}function K(e){if(D.currentQueryName){var t=$(e.target),n=t.attr("data-parametername");t.removeClass(I),D.queryParameterMemory[D.currentQueryName]||(D.queryParameterMemory[D.currentQueryName]={}),D.queryParameterMemory[D.currentQueryName][n]=t.val()}}function V(){var e=function(e){return!!D.$dialog.find('.field-group[data-field="'.concat(e,'"] aui-toggle')).attr("checked")},t=F(),n={queryName:t,queryParameters:Q(),debug:e("debug"),allowGetParams:e("allowGetParams"),includeChangeTemplate:e("includeChangeTemplate"),dynamicLoad:e("dynamicLoad"),includeReloadButton:e("includeReloadButton"),disableAutoload:e("disableAutoload"),simulatedContentKey:D.$inputContentKey.attr("data-contentkey")||D.$inputContentKey.val()||null,simulatedUserKey:D.$inputUserKey.attr("data-userkey")||D.$inputUserKey.val()||null,draftEntity:null,contentKey:x.getContentId()};return D.currentDraftEntity&&D.currentDraftEntity.name===t&&(n.draftEntity=D.currentDraftEntity),n}function U(e){var t,n,r;D.$querySelect.closest(".field-group").removeClass(I),D.currentQueryName=D.$querySelect.val(),n=D.$dialog.find('.field-group[data-field="queryName"]'),r="",(t=D.currentQueryName===H?D.currentDraftEntity:D.queriesByName[D.currentQueryName])&&t.description&&(r=t.description),n.find(".description").text(r),function(){var e,t=D.$dialog.find('.field-group[data-field="queryParameters"]');D.currentQueryName===H?e=D.draftParameterNames:D.queriesByName[D.currentQueryName]&&(e=D.queriesByName[D.currentQueryName].parameterNames);var n=D.queryParameterMemory[D.currentQueryName]||{};t.html(O()({queryParameterNames:e,queryParameters:n}))}(),D.$form.removeClass(L),D.currentDraftEntity&&D.currentDraftEntity.name===e.val&&D.$form.addClass(L),B()}function G(e,t){var n=F();if(e&&!n)D.$querySelect.closest(".field-group").addClass(I);else if(n){var r=!0,a=Q();if(t)for(var o in a)a[o]||(e&&D.$form.find('input[data-parametername="'.concat(o,'"]')).addClass(I),r=!1);r&&function(){var e=V(),t=$("#pq-preview-iframe-container");D.$dialog.addClass("loading-content"),t.html("");var n=$('<iframe id="pq-preview-iframe"></iframe>');t.append(n),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(x.getContextPath(),"/rest/pocketquery/1.0/preview/content"),data:JSON.stringify(e),dataType:"json"}).done((function(e){if(e.success){var t=n[0],r=t.contentDocument||t.contentWindow.document;r.write(e.data.html),r.close()}else D.$dialog.removeClass("loading-content"),x.flag({type:"error",body:e.data,close:"manual"})})).fail((function(){x.flag({type:"error",body:"Unexpected error communicating with the server. Please try again later and contact your administrator if the problem persists.",close:"manual"})}))}()}}function Y(e){e.preventDefault(),G(!0,!1)}function z(e){$(e.target).closest(".search-input").find(".pq-aui-select2").select2("val",null).trigger("change")}function W(e){x.clearMemory(),Z("admin",{},{})}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=n.draftEntity,a=n.confirmFn,o=n.cancelFn,l=n.usePersistentMemory;R(),r?(D.currentQueryName=H,D.currentDraftEntity=r,D.draftParameterNames=N(D.currentDraftEntity.statement)):D.currentQueryName=t.queryName,D.$dialog=x.newPreviewDialog(e,{confirmFn:a,cancelFn:o,usePersistentMemory:l}),D.$dialog.addClass("loading-data");var i="".concat(x.getContextPath(),"/rest/pocketquery/1.0/preview/queries"),u=x.getContextKey();u&&(i+="?contextKey=".concat(u)),$.ajax({type:"GET",url:i}).done((function(n){var r=n.data,a=r.queries,o=r.pocketQueryEditor;D.responseData={queries:a,pocketQueryEditor:o},D.queriesByName={};var l,i=j(a);try{for(i.s();!(l=i.n()).done;){var u=l.value;D.queriesByName[u.name]=u}}catch(e){i.e(e)}finally{i.f()}var s=[],c={};D.currentDraftEntity?(s=D.draftParameterNames||[],c=t.queryParameters||{}):t.queryName&&(D.queriesByName[t.queryName]?(s=D.queriesByName[t.queryName].parameterNames||[],c=t.queryParameters||{}):x.log.warn("Non-existing query in preview. This is unexpected.")),D.$dialog.removeClass("loading-data"),D.$dialog.find(".aui-dialog2-content").html(q()({env:t,queries:a,queriesByName:D.queriesByName,queryParameterNames:s,pocketQueryEditor:o,queryParameters:c,mode:e,hardcodedDraftEntityName:H,draftEntity:D.currentDraftEntity})),D.$dialog.find("select.pq-aui-select2").each((function(){var e=$(this);e.auiSelect2({placeholder:e.attr("data-placeholder"),allowClear:!0,dir:"rtl"})})),D.$form=D.$dialog.find("#pq-preview-form"),D.$querySelect=D.$dialog.find("#pq-field-queryName"),D.$inputContentKey=D.$dialog.find("#pq-field-contentKey"),D.$inputUserKey=D.$dialog.find("#pq-field-userKey"),D.$querySelect.change(U),x.autocompleteUser("input#pq-field-userKey",{key:t.userKey,text:t.userText}),x.autocompleteContent("input#pq-field-contentKey",{key:t.contentKey,text:t.contentText}),D.$dialog.find(".pq-tooltip").each((function(){var e=$(this);e.tooltip({gravity:e.data("gravity")||"w",trigger:"hover"})})),D.$dialog.on("change","#pq-preview-form aui-toggle",B),D.$dialog.on("input","#query-parameter-list input",K),D.$dialog.on("click","#pq-load-button",Y),D.$dialog.on("click",".search-input .icon-clear",z),D.$dialog.on("click",".clear-preview",W),x.auiMajorVersionAtLeast(8)||$(".select2-with-searchbox .select2-input").click((function(e){"false"===D.$dialog.attr("aria-hidden")&&(D.$dialog.attr("aria-hidden",!0),$(e.currentTarget).focus(),D.$dialog.attr("aria-hidden",!1))})),setTimeout((function(){B(),G(!1,!0)}),10)}))}var X={init:Z,onPreviewFrameLoaded:function(){D.$dialog.removeClass("loading-content"),D.$dialog.find("iframe").contents().find(".wiki-content .pocketquery-view-container form").on("submit",(function(e){e.preventDefault(),x.flag({type:"info",body:'This feature is not available in the preview when the option "Load dynamically" is disabled. Please try it out on an actual page instead or enable the option (requires a preview reload).',close:"manual"})}))},getRuntimeEnvFromPreviewSettings:V,getSimulatedContentText:function(){var e=D.$inputContentKey.select2("data");return e&&e.text},getSimulatedUserText:function(){var e=D.$inputUserKey.select2("data");return e&&e.text},DRAFT_QUERY_NAME:H};function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function te(){var e,t,n,r;tinymce.confluence.macrobrowser.macroBrowserComplete({name:"pocketquery",params:(e={},t=X.getRuntimeEnvFromPreviewSettings(),n=t.queryParameters,r="",n&&(r=C(n,{encodeParameterValues:!0})),e.name=t.queryName,e.parameters=r,function(n){var r,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}(["allowGetParams","debug","disableAutoload","dynamicLoad","includeChangeTemplate","includeReloadButton"]);try{for(a.s();!(r=a.n()).done;){var o=r.value;t[o]&&(e[o.toLowerCase()]="true")}}catch(e){a.e(e)}finally{a.f()}}(),e),bodyHtml:"",defaultParameterValue:void 0})}x.ready((function(){x.setMacroJsOverride("pocketquery",{opener:function(e){var t=function(e){var t={},n=e.params;return n&&(t.queryName=n.name,t.queryParameters={},n.parameters&&(t.queryParameters=E(n.parameters,{decodeParameterValues:!0})),t.allowGetParams=n.allowgetparams,t.debug=n.debug,t.disableAutoload=n.disableautoload,t.dynamicLoad=n.dynamicload,t.includeChangeTemplate=n.includechangetemplate,t.includeReloadButton=n.includereloadbutton),t}(e);X.init("view",t,{confirmFn:te})}})}));var ne=window.PocketQuery||{};$.extend(ne,{onPreviewFrameLoaded:X.onPreviewFrameLoaded}),window.PocketQuery=ne}()}();
//# sourceMappingURL=bundle-macrobrowser.js.map
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.officeconnector:macro-browser-smart-fields', location = 'javascript/office-connector-macro-fields.js' */
(function(d){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewdoc",["doc","docx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewpdf",["pdf"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewxls",["xls","xlsx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewppt",["ppt","pptx"]);AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(b){var a=b.params[""]||b.params.name;if(a){var c=a.lastIndexOf(".");0<c&&(a=a.substring(c+1))&&("doc"==a&&"docx"==
a&&(b.name="viewdoc"),"pdf"==a&&(b.name="viewpdf"),"ppt"==a&&"pptx"==a&&(b.name="viewppt"),"xls"==a&&"xlsx"==a&&(b.name="viewxls"))}}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:d0c63675b81be7895c1abd97aa0e1586', location = 'build/8905.js' */
"use strict";(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[8905],{28905:function(e,t,a){a.r(t);a(42295),a(17503),a(63045);var s=a(14479),n=a(53132);t.default=class{constructor(e,t){this.params=e,this.$iframe=t,this.iframe=t[0]}onReady(){}getData(){var{params:e}=this;return e.attachment?(0,s.default)(e.pageId,e.spaceKey,e.attachment):Promise.resolve(e.data&&JSON.parse(e.data))}init(){return this.bindToMessageEvent(),this.dataPromise=this.getData(),this.startLoad(),this.dataPromise}bindToMessageEvent(){window.addEventListener("message",this.onMessageHandler.bind(this))}bindToUnloadEvent(){this.iframe.contentWindow.addEventListener("beforeunload",(()=>{this.spreadsheetModule=null}),{once:!0})}onMessageHandler(e){(function(e,t){return(e.source.location.search||t).indexOf(t)>-1&&e.data===n.SPREADSHEET_READY_MSG})(e,this.params.id)&&this.onIframeLoad()}startLoad(){this.iframe.src=this.iframe.dataset.src}onIframeLoad(){var e,{dataPromise:t,iframe:a}=this;null!==(e=a.contentWindow)&&void 0!==e&&e.SpreadsheetModule&&t.then((e=>{this.initSpreadsheet(a.contentWindow,e)}))}initSpreadsheet(e,t){var{params:a}=this;if(!this.spreadsheetModule){e.AJS=AJS,e.Confluence=Confluence;var n=new e.SpreadsheetModule({data:t,title:a.attachment,pageId:a.pageId,spaceKey:a.spaceKey,lang:AJS.Meta.get("user-locale"),exit:a.exit,save:a.save,open:s.default,openFullScreen:a.openFullScreen});n.init(),this.spreadsheetModule=n,this.bindToUnloadEvent(),this.onReady(n,t)}}getModule(){return this.spreadsheetModule}updateData(e){this.dataPromise=Promise.resolve(e)}}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:a896c2d28bfed920143b9d7fab712f3a', location = 'build/6470.js' */
"use strict";(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[6470],{14479:function(e,t,n){n.r(t),n.d(t,{default:function(){return i}});n(63045);var r=n(16790);function a(e,t,n,r,a,c,i){try{var o=e[c](i),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,c){var i=e.apply(t,n);function o(e){a(i,r,c,o,u,"next",e)}function u(e){a(i,r,c,o,u,"throw",e)}o(void 0)}))}}function i(e,t,n){return o.apply(this,arguments)}function o(){return(o=c((function*(e,t,n){try{return JSON.parse(yield(0,r.getAttachmentData)(e,t,n))}catch(e){return null}}))).apply(this,arguments)}},16790:function(e,t,n){n.r(t),n.d(t,{getAttachmentData:function(){return w},getAttachments:function(){return g},getContentById:function(){return p},searchAttachments:function(){return P},searchContentByCQL:function(){return m},searchPage:function(){return b},storeAttachment:function(){return O}});n(63045),n(42295),n(48868),n(54861),n(98457),n(68049),n(86305);var r=(e,t)=>{if(e.indexOf("^")>0){var n=e.split("^"),r=n[1],a=n[0],c=a.indexOf(":");c>0&&(t=a.substring(0,c),a=a.substring(c+1));var i=a.indexOf("/")>0,o="";if(i){var u=a.split("/");a=u[3],o=u.slice(0,3).join("-")}return{attachmentName:r,pageTitle:a,spaceKey:t,postingDate:o,type:i?"blogpost":"page"}}return{attachmentName:e}},a=n(33926);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=e=>{var t=i(i({contentType:"application/json"},e),{},{dataType:"text",type:"GET"});return new Promise(((e,n)=>{(0,a.makeRequest)(i(i({},t),{},{success:function(t){e(t?JSON.parse(t):t)},error:e=>n(new Error(e))}))}))};function s(e,t,n,r,a,c,i){try{var o=e[c](i),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,a)}var l=function(){var e,t=(e=function*(e,t){var n,r=e.resultGlobalContainer.displayUrl.split("display/")[1],a=e.resultParentContainer.title,c=e.content.title,i=null===(n=e.resultParentContainer.displayUrl.split(r+"/")[1])||void 0===n?void 0:n.match("\\d{4}/\\d{2}/\\d{2}");return i&&(a=i[0]+"/"+a),{wikiLink:c,parentPageId:yield b(a,r,t),parentTitle:a,parentSpaceKey:r}},function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function i(e){s(c,r,a,i,o,"next",e)}function o(e){s(c,r,a,i,o,"throw",e)}i(void 0)}))});return function(e,n){return t.apply(this,arguments)}}(),p=e=>u({url:"/rest/api/content/".concat(e)});function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r,a,c,i){try{var o=e[c](i),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,a)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function i(e){h(c,r,a,i,o,"next",e)}function o(e){h(c,r,a,i,o,"throw",e)}i(void 0)}))}}var m=e=>new Promise((t=>{(0,a.makeRequest)({type:"GET",url:"/rest/api/content/search",contentType:"application/json",dataType:"text",data:e||{cql:""},success:function(e){t(e)},error:function(){t('{ "results": [] }')}})})),b=(e,t,n,r)=>{if(!e)return{id:n};var a="=",c=e;-1!==e.indexOf('"')&&(c=e.replace(/"/g,""),a="~");var i='space = "'.concat(t,'" and title ').concat(a,' "').concat(c,'"');return m({cql:i,expand:r,limit:200}).then((e=>JSON.parse(e).results)).then((t=>1===t.length?t[0]:t.find((t=>t.title===e))))},O=(e,t,n,c,i)=>new Promise(((o,u)=>{v((function*(){try{var s=r(c,t);if(s.pageTitle){var l=yield b(s.pageTitle,s.spaceKey,e);l&&e!==l.id&&(e=l.id,i=!1)}var p=((e,t)=>{var n=new FormData;return n.append("file",e,t),{type:"POST",contentType:!1,processData:!1,data:n}})(new Blob([n],{}),s.attachmentName),f=i?"draft":"current";(0,a.makeRequest)(d(d({},p),{},{url:"/rest/api/content/".concat(e,"/child/attachment?status=").concat(f,"&allowDuplicated=true"),headers:{"X-Atlassian-Token":"nocheck"},success:e=>{o(e)},error:e=>{u(new Error(e))}}))}catch(e){u(e)}}))()})),g=(e,t,n)=>new Promise(((c,i)=>{var o=r(n,t);o.pageTitle?(0,a.makeRequest)({url:"/rest/api/content",type:"GET",contentType:"application/json",dataType:"text",data:{expand:"children.attachment",spaceKey:o.spaceKey,title:o.pageTitle,postingDay:o.postingDate,type:o.type},success:e=>{var t,n=JSON.parse(e);if(null!==(t=n.results)&&void 0!==t&&t.length){var r=n.results[0].children.attachment;c({response:r,name:o.attachmentName})}else i(new Error("Page with attachment not found."))},error:e=>{i(new Error(e))}}):(0,a.makeRequest)({url:"/rest/api/content/".concat(e,"/child/attachment"),type:"GET",contentType:"application/json",dataType:"text",data:{expand:"children.attachment",filename:n},success:e=>{c({response:JSON.parse(e),name:n})},error:e=>{i(new Error(e))}})})),w=(e,t,n)=>new Promise(((r,c)=>{v((function*(){try{var{response:i,name:o}=yield g(e,t,n),u=i.results.filter((e=>o===e.title));0===u.length?c(new Error("Attachment not found.")):(0,a.makeRequest)({url:u[0]._links.download,type:"GET",contentType:"application/json",success:e=>{r(e)},error:e=>{c(new Error(e))}})}catch(e){c(e)}}))()})),P=function(){var e=v((function*(e,t,n,r){var a=r?((e,t)=>{var n=e?'title~"'.concat(e,'*" and '):"";return n+'(sitesearch~"file.extension:'+t.join('" or sitesearch~"file.extension:')+'")'})(n,r):'title~"'.concat(n,'*"'),c=(yield u({url:"/rest/api/search",data:{cql:'type = "attachment" and '.concat(a," order by created desc"),excerpt:!1,limit:10}})).results.map((t=>l(t,e)));return(yield Promise.all(c)).map((n=>{var{wikiLink:r,parentPageId:a,parentTitle:c,parentSpaceKey:i}=n;return c&&e!==a&&(r="".concat(c,"^").concat(r),t===i&&-1===c.indexOf(":")||(r="".concat(i,":").concat(r))),{label:n.wikiLink+(c?" (".concat(c,")"):""),value:r}}))}));return function(t,n,r,a){return e.apply(this,arguments)}}()},53132:function(e,t,n){n.r(t),n.d(t,{SPREADSHEET_READY_MSG:function(){return r}});var r="spreadsheet-ready"}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:dbda26516a0328fd29bd663c25f6920d', location = 'build/8265.js' */
"use strict";(self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[]).push([[8265],{98265:function(t,e,s){s.r(e);s(42295),s(15761),s(75654),s(68268),s(79150);(function(){var t,e,s,i,n={}.hasOwnProperty;(i=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t,e){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t,null,null,e)},t.prototype.add_group=function(t){var e,s,i,n,r,o;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:t.label,title:t.title?t.title:void 0,children:0,disabled:t.disabled,classes:t.className}),o=[],s=0,i=(r=t.childNodes).length;s<i;s++)n=r[s],o.push(this.add_option(n,e,t.disabled));return o},t.prototype.add_option=function(t,e,s,i){if("OPTION"===t.nodeName.toUpperCase())return null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:i?t.text:t.innerHTML,title:t.title?t.title:void 0,selected:t.selected,disabled:!0===s?s:t.disabled,group_array_index:e,group_label:null!=e?this.parsed[e].label:null,classes:t.className,style:t.style.cssText}),this.options_index+=1},t}()).select_to_array=function(t,e){var s,n,r,o,h;for(o=new i,n=0,r=(h=t.childNodes).length;n<r;n++)s=h[n],o.add_node(s,e);return o.parsed},e=function(){function t(e,s){this.form_field=e,this.options=null!=s?s:{},this.label_click_handler=function(t,e){return function(){return t.apply(e,arguments)}}(this.label_click_handler,this),t.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return t.prototype.set_default_values=function(){return this.click_test_action=function(t){return function(e){return t.test_active_click(e)}}(this),this.activate_action=function(t){return function(e){return t.activate_field(e)}}(this),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.is_rtl=this.options.rtl||/\bchosen-rtl\b/.test(this.form_field.className),this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options,this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY,this.case_sensitive_search=this.options.case_sensitive_search||!1,this.hide_results_on_select=null==this.options.hide_results_on_select||this.options.hide_results_on_select},t.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.default_text=this.escape_html(this.default_text),this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text},t.prototype.choice_label=function(t){return this.include_group_label_in_selected&&null!=t.group_label?"<b class='group-name'>"+this.escape_html(t.group_label)+"</b>"+t.html:t.html},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(t){if(this.is_multiple){if(!this.active_field)return setTimeout(function(t){return function(){return t.container_mousedown()}}(this),50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(t){if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(t){return function(){return t.blur_test()}}(this),100)},t.prototype.label_click_handler=function(t){return this.is_multiple?this.container_mousedown(t):this.activate_field()},t.prototype.results_option_build=function(t){var e,s,i,n,r,o,h;for(e="",h=0,n=0,r=(o=this.results_data).length;n<r&&("",""!==(i=(s=o[n]).group?this.result_add_group(s):this.result_add_option(s))&&(h++,e+=i),(null!=t?t.first:void 0)&&(s.selected&&this.is_multiple?this.choice_build(s):s.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(s))),!(h>=this.max_shown_results));n++);return e},t.prototype.result_add_option=function(t){var e,s;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),t.style&&(s.style.cssText=t.style),s.setAttribute("data-option-array-index",t.array_index),s.innerHTML=t.highlighted_html||t.html,t.title&&(s.title=t.title),this.outerHTML(s)):""},t.prototype.result_add_group=function(t){var e,s;return(t.search_match||t.group_match)&&t.active_options>0?((e=[]).push("group-result"),t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),s.innerHTML=t.highlighted_html||this.escape_html(t.label),t.title&&(s.title=t.title),this.outerHTML(s)):""},t.prototype.results_update_field=function(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing)return this.winnow_results()},t.prototype.reset_single_select_options=function(){var t,e,s,i,n;for(n=[],t=0,e=(s=this.results_data).length;t<e;t++)(i=s[t]).selected?n.push(i.selected=!1):n.push(void 0);return n},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(t){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.winnow_results=function(t){var e,s,i,n,r,o,h,l,c,_,a,u,d,p,f;for(this.no_results_clear(),_=0,e=(h=this.get_search_text()).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),c=this.get_search_regex(e),i=0,n=(l=this.results_data).length;i<n;i++)(r=l[i]).search_match=!1,a=null,u=null,r.highlighted_html="",this.include_option_in_results(r)&&(r.group&&(r.group_match=!1,r.active_options=0),null!=r.group_array_index&&this.results_data[r.group_array_index]&&(0===(a=this.results_data[r.group_array_index]).active_options&&a.search_match&&(_+=1),a.active_options+=1),f=r.group?r.label:r.text,r.group&&!this.group_search||(u=this.search_string_match(f,c),r.search_match=null!=u,r.search_match&&!r.group&&(_+=1),r.search_match?(h.length&&(d=u.index,o=f.slice(0,d),s=f.slice(d,d+h.length),p=f.slice(d+h.length),r.highlighted_html=this.escape_html(o)+"<em>"+this.escape_html(s)+"</em>"+this.escape_html(p)),null!=a&&(a.group_match=!0)):null!=r.group_array_index&&this.results_data[r.group_array_index].search_match&&(r.search_match=!0)));return this.result_clear_highlight(),_<1&&h.length?(this.update_results_content(""),this.no_results(h)):(this.update_results_content(this.results_option_build()),(null!=t?t.skip_highlight:void 0)?void 0:this.winnow_results_set_highlight())},t.prototype.get_search_regex=function(t){var e,s;return s=this.search_contains?t:"(^|\\s|\\b)"+t+"[^\\s]*",this.enable_split_word_search||this.search_contains||(s="^"+s),e=this.case_sensitive_search?"":"i",new RegExp(s,e)},t.prototype.search_string_match=function(t,e){var s;return s=e.exec(t),!this.search_contains&&(null!=s?s[1]:void 0)&&(s.index+=1),s},t.prototype.choices_count=function(){var t,e,s;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,t=0,e=(s=this.form_field.options).length;t<e;t++)s[t].selected&&(this.selected_option_count+=1);return this.selected_option_count},t.prototype.choices_click=function(t){if(t.preventDefault(),this.activate_field(),!this.results_showing&&!this.is_disabled)return this.results_show()},t.prototype.keydown_checker=function(t){var e,s;switch(s=null!=(e=t.which)?e:t.keyCode,this.search_field_scale(),8!==s&&this.pending_backstroke&&this.clear_backstroke(),s){case 8:this.backstroke_length=this.get_search_field_value().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:this.results_showing&&(t.stopPropagation(),t.preventDefault());break;case 27:this.results_showing&&t.preventDefault();break;case 32:this.disable_search&&t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},t.prototype.keyup_checker=function(t){var e,s;switch(s=null!=(e=t.which)?e:t.keyCode,this.search_field_scale(),s){case 8:this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0?this.keydown_backstroke():this.pending_backstroke||(this.result_clear_highlight(),this.results_search());break;case 13:t.preventDefault(),this.results_showing&&this.result_select(t);break;case 27:this.results_showing&&this.results_hide();break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;default:this.results_search()}},t.prototype.clipboard_event_checker=function(t){if(!this.is_disabled)return setTimeout(function(t){return function(){return t.results_search()}}(this),50)},t.prototype.container_width=function(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth+"px"},t.prototype.include_option_in_results=function(t){return!(this.is_multiple&&!this.display_selected_options&&t.selected||!this.display_disabled_options&&t.disabled||t.empty)},t.prototype.search_results_touchstart=function(t){return this.touch_started=!0,this.search_results_mouseover(t)},t.prototype.search_results_touchmove=function(t){return this.touch_started=!1,this.search_results_mouseout(t)},t.prototype.search_results_touchend=function(t){if(this.touch_started)return this.search_results_mouseup(t)},t.prototype.outerHTML=function(t){var e;return t.outerHTML?t.outerHTML:((e=document.createElement("div")).appendChild(t),e.innerHTML)},t.prototype.get_single_html=function(){return'<div class="chosen-single chosen-default">\n  <span>'+this.default_text+'</span>\n  <div><b></b></div>\n</div>\n<div class="chosen-drop">\n  <div class="chosen-search">\n    <input class="chosen-search-input" type="text" autocomplete="off" />\n  </div>\n  <ul class="chosen-results"></ul>\n</div>'},t.prototype.get_multi_html=function(){return'<ul class="chosen-choices">\n  <li class="search-field">\n    <input class="chosen-search-input" type="text" autocomplete="off" placeholder="'+this.default_text+'"/>\n  </li>\n</ul>\n<div class="chosen-drop">\n  <ul class="chosen-results"></ul>\n</div>'},t.prototype.get_no_results_html=function(t){return'<li class="no-results">\n  '+this.results_none_found+" <span>"+this.escape_html(t)+"</span>\n</li>"},t.browser_is_supported=function(){return"Microsoft Internet Explorer"!==window.navigator.appName||document.documentMode>=8},t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results match",t}(),(t=window.$||jQuery).fn.extend({chosenTF:function(i){return e.browser_is_supported()?this.each((function(e){var n,r;r=(n=t(this)).data("chosen"),"destroy"!==i?r instanceof s||n.data("chosen",new s(this,i)):r instanceof s&&r.destroy()})):this}}),s=function(s){function r(){return r.__super__.constructor.apply(this,arguments)}return function(t,e){function s(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex},r.prototype.set_up_html=function(){var e,s;return(e=["chosen-container"]).push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),s={class:e.join(" "),title:this.form_field.title},this.form_field.id.length&&(s.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=t("<div />",s),this.container.width(this.container_width()),this.is_multiple?this.container.html(this.get_multi_html()):this.container.html(this.get_single_html()),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},r.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},r.prototype.register_observers=function(){return this.container.on("touchstart.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.container.on("touchend.chosen",function(t){return function(e){t.container_mouseup(e)}}(this)),this.container.on("mousedown.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.container.on("mouseup.chosen",function(t){return function(e){t.container_mouseup(e)}}(this)),this.container.on("mouseenter.chosen",function(t){return function(e){t.mouse_enter(e)}}(this)),this.container.on("mouseleave.chosen",function(t){return function(e){t.mouse_leave(e)}}(this)),this.search_results.on("mouseup.chosen",function(t){return function(e){t.search_results_mouseup(e)}}(this)),this.search_results.on("mouseover.chosen",function(t){return function(e){t.search_results_mouseover(e)}}(this)),this.search_results.on("mouseout.chosen",function(t){return function(e){t.search_results_mouseout(e)}}(this)),this.search_results.on("mousewheel.chosen DOMMouseScroll.chosen",function(t){return function(e){t.search_results_mousewheel(e)}}(this)),this.search_results.on("touchstart.chosen",function(t){return function(e){t.search_results_touchstart(e)}}(this)),this.search_results.on("touchmove.chosen",function(t){return function(e){t.search_results_touchmove(e)}}(this)),this.search_results.on("touchend.chosen",function(t){return function(e){t.search_results_touchend(e)}}(this)),this.form_field_jq.on("chosen:updated.chosen",function(t){return function(e){t.results_update_field(e)}}(this)),this.form_field_jq.on("chosen:activate.chosen",function(t){return function(e){t.activate_field(e)}}(this)),this.form_field_jq.on("chosen:open.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.form_field_jq.on("chosen:close.chosen",function(t){return function(e){t.close_field(e)}}(this)),this.search_field.on("blur.chosen",function(t){return function(e){t.input_blur(e)}}(this)),this.search_field.on("keyup.chosen",function(t){return function(e){t.keyup_checker(e)}}(this)),this.search_field.on("keydown.chosen",function(t){return function(e){t.keydown_checker(e)}}(this)),this.search_field.on("focus.chosen",function(t){return function(e){t.input_focus(e)}}(this)),this.search_field.on("cut.chosen",function(t){return function(e){t.clipboard_event_checker(e)}}(this)),this.search_field.on("paste.chosen",function(t){return function(e){t.clipboard_event_checker(e)}}(this)),this.is_multiple?this.search_choices.on("click.chosen touchstart.chosen",function(t){return function(e){t.choices_click(e)}}(this)):this.container.on("click.chosen",(function(t){t.preventDefault()}))},r.prototype.destroy=function(){return t(this.container[0].ownerDocument).off("click.chosen",this.click_test_action),this.form_field_label.length>0&&this.form_field_label.off("click.chosen"),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},r.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field.disabled||this.form_field_jq.parents("fieldset").is(":disabled"),this.container.toggleClass("chosen-disabled",this.is_disabled),this.search_field[0].disabled=this.is_disabled,this.is_multiple||this.selected_item.off("focus.chosen",this.activate_field),this.is_disabled?this.close_field():this.is_multiple?void 0:this.selected_item.on("focus.chosen",this.activate_field)},r.prototype.container_mousedown=function(e){var s;if(!this.is_disabled)return!e||"mousedown"!==(s=e.type)&&"touchstart"!==s||this.results_showing||e.preventDefault(),null!=e&&t(e.target).hasClass("ui-resizable-handle")?this.results_hide():null!=e&&t(e.target).hasClass("search-choice-close")?void 0:(this.active_field?this.is_multiple||!e||t(e.target)[0]!==this.selected_item[0]&&!t(e.target).parents("div.chosen-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(this.container[0].ownerDocument).on("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},r.prototype.container_mouseup=function(t){if("ABBR"===t.target.nodeName&&!this.is_disabled)return this.results_reset(t)},r.prototype.search_results_mousewheel=function(t){var e;if(t.originalEvent&&(e=t.originalEvent.deltaY||-t.originalEvent.wheelDelta||t.originalEvent.detail),null!=e)return t.preventDefault(),"DOMMouseScroll"===t.type&&(e*=40),this.search_results.scrollTop(e+this.search_results.scrollTop())},r.prototype.blur_test=function(t){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()},r.prototype.close_field=function(){return t(this.container[0].ownerDocument).off("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale(),this.search_field.blur()},r.prototype.activate_field=function(){if(!this.is_disabled)return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},r.prototype.test_active_click=function(e){var s;return(s=t(e.target).closest(".chosen-container")).length&&this.container[0]===s[0]?this.active_field=!0:this.close_field()},r.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=i.select_to_array(this.form_field,this.options.isHtml),this.is_multiple?this.search_choices.find("li.search-choice").remove():(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},r.prototype.result_do_highlight=function(t){var e,s,i,n,r;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),n=(i=parseInt(this.search_results.css("maxHeight"),10))+(r=this.search_results.scrollTop()),(e=(s=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight())>=n)return this.search_results.scrollTop(e-i>0?e-i:0);if(s<r)return this.search_results.scrollTop(s)}},r.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},r.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.get_search_field_value()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},r.prototype.update_results_content=function(t){return this.search_results.html(t)},r.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},r.prototype.set_tab_index=function(t){var e;if(this.form_field.tabIndex)return e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e},r.prototype.set_label_behavior=function(){if(this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=t("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0)return this.form_field_label.on("click.chosen",this.label_click_handler)},r.prototype.show_search_field_default=function(){return this.search_field.val(""),this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.attr("placeholder",this.default_text),this.search_field.addClass("default")):(this.search_field.attr("placeholder",""),this.search_field.removeClass("default"))},r.prototype.search_results_mouseup=function(e){var s;if((s=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first()).length)return this.result_highlight=s,this.result_select(e),this.search_field.focus()},r.prototype.search_results_mouseover=function(e){var s;if(s=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first())return this.result_do_highlight(s)},r.prototype.search_results_mouseout=function(e){if(t(e.target).hasClass("active-result")||t(e.target).parents(".active-result").first())return this.result_clear_highlight()},r.prototype.choice_build=function(e){var s,i;return(s=t("<li />",{class:"search-choice"}).html("<span>"+this.choice_label(e)+"</span>")).css("max-width",this.container.width()>100?this.container.width()-40:""),e.disabled?s.addClass("search-choice-disabled"):((i=t("<span />",{class:"search-choice-close","data-option-array-index":e.array_index})).on("click.chosen touchstart.chosen",function(t){return function(e){return t.choice_destroy_link_click(e)}}(this)),s.append(i)),this.search_container.before(s)},r.prototype.choice_destroy_link_click=function(e){if(e.preventDefault(),e.stopPropagation(),!this.is_disabled)return this.choice_destroy(t(e.target))},r.prototype.choice_destroy=function(t){if(0===t.length&&(t=this.pending_backstroke.find(".search-choice-close")),this.result_deselect(t[0].getAttribute("data-option-array-index")))return this.active_field?this.search_field.focus():this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.get_search_field_value().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()},r.prototype.results_reset=function(){if(this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.trigger_form_field_change(),this.active_field)return this.results_hide()},r.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},r.prototype.result_select=function(e){var s,i,n,r,o;if(this.result_highlight)return i=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?i.removeClass("active-result"):this.reset_single_select_options(),i.addClass("result-selected"),(n=this.results_data[i[0].getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[n.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(n):this.single_set_selected_text(this.choice_label(n)),this.is_multiple&&(!this.hide_results_on_select||e.metaKey||e.ctrlKey)?e.metaKey||e.ctrlKey?this.winnow_results({skip_highlight:!0}):(this.search_field.val(""),this.winnow_results()):(this.results_hide(),this.show_search_field_default()),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.trigger_form_field_change({selected:this.form_field.options[n.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale());this.options.addUserOption&&(o=this.search_field.val(),s=!1,this.results_data.some((function(t){if(t.text===o)return s=!0,!0})),s||(r=t('<option selected="selected"></option>').attr("value",o).text(o),this.form_field_jq.append(r).trigger("change",{selected:o}).trigger("chosen:updated")))},r.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").html(t)},r.prototype.result_deselect=function(t){var e;return e=this.results_data[t],!this.form_field.options[e.options_index].disabled&&(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.trigger_form_field_change({deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},r.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect)return this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")},r.prototype.get_search_field_value=function(){return this.search_field.val()},r.prototype.get_search_text=function(){return t.trim(this.get_search_field_value())},r.prototype.escape_html=function(e){return t("<div/>").text(e).html()},r.prototype.winnow_results_set_highlight=function(){var t,e;if(null!=(t=(e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?e.first():this.search_results.find(".active-result").first()))return this.result_do_highlight(t)},r.prototype.no_results=function(e){var s,i;return s=t(this.get_no_results_html(e)),this.search_results.append(s),this.options.addUserOption&&(i=this,s.addClass("add-user-option").click((function(){i.result_select()}))),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},r.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},r.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},r.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(t.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},r.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last()).length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},r.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},r.prototype.search_field_scale=function(){var e,s,i,n,r,o,h;if(this.is_multiple){if(h=25,this.search_field.attr("placeholder")||this.get_search_field_value()){for(r={position:"absolute",left:"-1000px",top:"-1000px",display:"none",whiteSpace:"pre"},s=0,i=(o=["fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing"]).length;s<i;s++)r[n=o[s]]=this.search_field.css(n);(e=t("<div />").css(r)).text(this.search_field.attr("placeholder")||this.get_search_field_value()),t("body").append(e),h+=e.width(),e.remove()}return this.container.is(":visible")&&(h=Math.min(this.container.outerWidth()-10,h)),this.search_field.width(h)}},r.prototype.trigger_form_field_change=function(t){return this.form_field_jq.trigger("input",t),this.form_field_jq.trigger("change",t)},r}()}).call(void 0)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:macro-browser-resources', location = 'build/macro-browser.js' */
!function(){var e,t={59476:function(e){if(void 0===(t=window.SpreadsheetTemplate=window.SpreadsheetTemplate||{}))var t={};t.macroDialog=function(e,a){return'<section id="spreadsheet-dialog" class="aui-layer aui-dialog2 aui-dialog2-fullscreen aui-dialog2-maximum ap-aui-dialog2" role="dialog" data-aui-modal="true" data-aui-remove-on-hide="true"><base target="_blank"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">'+(e.isInsert?soy.$$escapeHtml(AJS.format("Insert \u2018{0}\u2019 Macro","Table Spreadsheet")):soy.$$escapeHtml(AJS.format("Edit \u2018{0}\u2019 Macro","Table Spreadsheet")))+'</h2><div class="aui-dialog2-footer-actions"><button class="aui-button aui-button-primary save" aria-label="'+soy.$$escapeHtml("Save")+'" disabled><span class="aui-icon aui-icon-small aui-iconfont-check"></span></button><button class="aui-button aui-button-subtle cancel" aria-label="'+soy.$$escapeHtml("Cancel")+'"><span class="aui-icon aui-icon-small aui-iconfont-cross"></span></button></div></header><div class="aui-dialog2-content">'+t.view(e)+"</div></section>"},goog.DEBUG&&(t.macroDialog.soyTemplateName="SpreadsheetTemplate.macroDialog"),t.view=function(e,t){return'<iframe src="about:blank" data-src="'+soy.$$escapeHtml(AJS.contextPath())+"/spreadsheet/view.action?sid="+soy.$$escapeHtml(e.id)+'" frameborder="0" width="100%" seamless allowfullscreen id="'+soy.$$escapeHtml(e.id)+'"></iframe>'},goog.DEBUG&&(t.view.soyTemplateName="SpreadsheetTemplate.view"),e.exports=t},37058:function(e,t,a){"use strict";a.r(t);a(98265),a(42295),a(79150);var l=a(37628);function r(e,t){e.find("option").each((function(){var e=$(this),a=e.attr("value");e.text(t[a].title)}))}function o(e,t,a,r,o){if(!t.__multiSelect){var s=Object.keys(t),c=a[r],m="#".concat(e.attr("id")),p=!0===a.isNew,{option:d,onChangeAppender:u}=l.default.initSelects(m,t[c]&&c,s[0],o,p);a[r]=d,e.change((function(){var a=e.val();i(a,r,t,"hidden"),i(a,r,t,"shown"),function(e,t,a){a.__default&&n(a.__default.labels);"object"!=typeof e&&n(a[e].labels)}(a,0,t)})).val(d).trigger("change"),u(e)}}function i(e,t,a,l){var r="tfac-"+l+"-"+t;$("."+r).removeClass(r);var o=a[e];if(o){var i=o[l+"Params"];if(i){var n=i.map((function(e){return"#macro-param-div-"+e}));$(n.join(",")).addClass(r)}}}function n(e){e&&$.each(e,(function(e,t){$("#macro-param-div-"+e).find("label").text(t)}))}var s={initSelects:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;$.each(e,(function(l){var i=$("#macro-param-"+l),n=e[l];r(i,n),o(i,n,t,l,a)}))}},c=a(53348),m=a(16631),p=a.n(m),d=a(12746),u=a(83931),f=a(33926);var g=class{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{e()};this.url=e,this.requestAuth=t}transformElements(e){this.initSelects(e),this.initEncodingInput(),this.initAuthDialog(e),this.initHeaderDialog(e),this.initHeadersDialog(e),this.bindURL()}initSelects(e){var t={source:{url:{title:"URL",hiddenParams:["attachment"]},attachment:{title:"Attachment",hiddenParams:["url","auth-type","set-auth","set-header","headers"]}},"auth-type":{basic:{title:"Login and password",hiddenParams:["set-header"]},header:{title:"Custom",hiddenParams:["set-auth"]}},format:{plain:{title:"Plain text"},wiki:{title:"Wiki markup"},markdown:{title:"Markdown"}}};s.initSelects(t,e)}initEncodingInput(){u.default.inputAutocomplete($("#macro-param-encoding"),null,[{value:"UTF-8"},{value:"UTF-16"},{value:"UTF-16LE"},{value:"UTF-16BE"},{value:"UTF-32"},{value:"ISO-8859-1"},{value:"US-ASCII"}])}initAuthDialog(e){var t=this,a="tf-auth-dialog",l=$("#macro-param-div-set-auth"),r=$("#macro-param-auth");e&&e.auth&&"header"!==e["auth-type"]&&l.find("label").text("Change login and password"),(0,d.initMacroBrowserAJSDialog)(l,{dialogName:a,dialogId:a,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=[{field:"Login",value:"",variant:c.default.FIELD_VARIANTS.TEXT},{field:"Password",value:"",variant:c.default.FIELD_VARIANTS.PASSWORD}];return p().inlineDialog({clazz:a,name:"auth",inputs:e,dialogId:a})},applyCallback:function(e){var l=e.popup.find("form").find("input"),o=l.eq(0).val().trim(),i=l.eq(1).val().trim(),n=$("#button-".concat(a," .name"));t.encodeAuth(o,i,(e=>{e?n.text("Change login and password"):n.text("Set login and password"),r.val(e)}))}})}initHeaderDialog(e){this.initDialog({name:"header",btnName:"set-header",inputName:"auth",isSet:e&&e.auth&&"header"===e["auth-type"],setLabel:"Set authentication header",changeLabel:"Change authentication header",inputLabel:"Request header",inputType:c.default.FIELD_VARIANTS.TEXT})}initHeadersDialog(e){this.initDialog({name:"headers",btnName:"headers",inputName:"headers",isSet:e&&e.headers,setLabel:"Set additional headers",changeLabel:"Change additional headers",inputLabel:"Request headers",inputType:c.default.FIELD_VARIANTS.TEXTAREA})}initDialog(e){var{name:t,btnName:a,inputName:l,isSet:r,setLabel:o,changeLabel:i,inputLabel:n,inputType:s}=e,m=this,u="tf-".concat(t,"-dialog"),f=$("#macro-param-div-"+a),g=$("#macro-param-"+l),b=s===c.default.FIELD_VARIANTS.TEXT?"input":s;r&&f.find("label").text(i),(0,d.initMacroBrowserAJSDialog)(f,{dialogName:u,dialogId:u,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=[{field:n,value:"",variant:s}];return p().inlineDialog({clazz:u,name:a,inputs:e,dialogId:u})},applyCallback:function(e){var t=e.popup.find("form").find(b).val().trim(),a=$("#button-".concat(u," .name"));m.encodeHeader(t,(e=>{e?a.text(i):a.text(o),g.val(e)}))}})}bindURL(){$("#macro-param-url").change((()=>{this.requestData&&this.makeRequest(this.requestData.url,this.requestData.data,this.requestData.callback)}))}encodeAuth(e,t,a){e||t?this.makeRequest(this.url+"/auth",{login:e,password:t},a):(this.requestData=null,a(""))}encodeHeader(e,t){e?this.makeRequest(this.url+"/header",{header:e},t):(this.requestData=null,t(""))}makeRequest(e,t,a){this.requestData={url:e,data:t,callback:a};var l=$("#macro-param-url").val().trim();this.requestAuth((r=>{t.url=l,t.jwt=r,(0,f.makeAjax)({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,async:!1,url:e,dataType:"text",data:t,success:a})}))}},b=a(99497),h={"csv-table":"CSV","json-from-table":"JSON"},v=function(){};v.isSaveClick=!1,v.isSetParams=!1,v.storedParams={},v.prototype.beforeParamsSet=function(e){$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   ");var t,a=new g(Confluence.getContextPath()+"/rest/table-filter/1.0/csv/encode");return function(e,t){"header"===e["auth-type"]?e.header&&(e.auth=t.encodeHeader(e.header)):e.login&&e.password&&(e.auth=t.encodeAuth(e.login,e.password));e.header="",e.login="",e.password=""}(e,a),a.transformElements(e),(t=$("#macro-param-attachment")).addClass("autocomplete-attachment").attr("data-template","{wikiLink}").attr("data-none-message","Nothing found"),Confluence.Binder.autocompleteAttachment(t.parent()),t.bind("selected.autocomplete-content",(function(e,a){var l=a.content.wikiLink.substring(1,a.content.wikiLink.length-1);if(AJS.params.spaceKey===a.content.space.key){var r=a.content.datePath?"/".concat(a.content.datePath,"/").concat(a.content.parentTitle):a.content.parentTitle;AJS.params.pageTitle!==r&&-1!==r.indexOf(":")||(l=l.replace("".concat(AJS.params.spaceKey,":"),""),AJS.params.pageTitle===r&&(l=l.replace("".concat(AJS.params.pageTitle,"^"),"")))}t.val(l)})),v.isSaveClick=!1,v.isSetParams=!0,e},v.prototype.postPreview=function(){v.isSaveClick=!1,v.isSetParams=!1},v.prototype.manipulateMarkup=function(e){return v.isSaveClick=!0,v.isSetParams=!1,e},v.prototype.beforeParamsRetrieved=function(e,t){return v.isSaveClick&&b.default.gaEditorDataSource(e,v.storedParams,h[t.macroName]),v.isSetParams&&(v.storedParams=e),e};var S=v;a(86305);var y=class{constructor(e){this.params=e}initSelects(){var e={type:{this:{title:"Current page",hiddenParams:["page","labels","labels-operator","space","merge-tables"]},page:{title:"Specific page",hiddenParams:["copytable","labels","labels-operator","space","merge-tables"]},"page-children":{title:"Page and child pages",hiddenParams:["copytable","labels","labels-operator","space"]},"page-descendants":{title:"Page and all descendants",hiddenParams:["copytable","labels","labels-operator","space"]},labels:{title:"Pages with labels",hiddenParams:["copytable","page"]}},"labels-operator":{OR:{title:"at least one label"},AND:{title:"all the labels above"}}};s.initSelects(e,this.params)}initMetaSelect(){var e=this.params["page-title"]||"";"true"===e&&(e="Page"),e=e.split(",").filter((e=>e));var t=$("#macro-param-meta-view");t.find("option[value='']").remove(),t.attr("multiple",!0),e.length?t.val(e):t.find("option:selected").prop("selected",!1);var a=$("#macro-param-page-title");t.chosenTF({placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1}).change(((t,l)=>{l.selected?e.push(l.selected):l.deselected&&e.splice(e.indexOf(l.deselected),1),a.val(e.join(","))})),u.default.sortSelectedOptions(t,e)}initMergeTablesParam(){this.params.name||$("#macro-param-merge-tables").prop("checked",!0)}},x=function(){};x.isSaveClick=!1,x.isSetParams=!1,x.storedParams={},x.prototype.beforeParamsSet=function(e){var t=new y(e);return function(e){var t=$("#macro-param-labels");e&&e.labels&&t.val(e.labels);t.auiSelect2(Confluence.UI.Components.LabelPicker.build({separator:",",queryOpts:{spaceKey:AJS.Meta.get("space-key")}}))}(e),t.initSelects(),t.initMetaSelect(),t.initMergeTablesParam(),x.isSaveClick=!1,x.isSetParams=!0,e},x.prototype.postPreview=function(){x.isSaveClick=!1,x.isSetParams=!1},x.prototype.manipulateMarkup=function(e){return x.isSaveClick=!0,x.isSetParams=!1,e},x.prototype.beforeParamsRetrieved=function(e){return x.isSaveClick&&b.default.gaEditorExcerptInclude(e,x.storedParams),x.isSetParams&&(x.storedParams=e),e["meta-view"]=void 0,e};var T=new x,w=a(92381),C=(a(62983),{convertStorageToView:function(e){var t=e.body,a=t.indexOf('<table class="merged-header')>=0&&t.indexOf('data-tf-ready="true"')>=0,l=!1;if(t.indexOf(' data-macro-name="')>=0&&t.indexOf(' data-macro-parameters="')>=0&&(0,f.makeAjax)({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/api/contentbody/convert/storage",contentType:"application/json",dataType:"json",data:JSON.stringify({value:t,representation:"editor"}),success:function(e){t=e.value,l=!0}}),(t.indexOf("<ac:structured-macro")>=0||t.indexOf("<time")>=0)&&(0,f.makeAjax)({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({contentId:u.default.getContentId(),macro:{name:e.name||"table-filter",body:t,params:{id:0}}}),success:function(e){t=e,l=!0}}),l&&a)for(var r,o=/<table class="merged-header/g;r=o.exec(t);){var i=r[0].length,n='<table data-tf-ready="true" class="merged-header';t=t.replace(r[0],n),o.lastIndex+=n.length-i}return t},showTabsParam:function(e){u.default.hasTabs($(e))||-1!==e.indexOf("macro 'spreadsheets'")||$("#macro-param-div-tabs").addClass("tf-very-hidden-param")}}),A=a(11706),P=function(e){var t=new w.default;if(!e.body){var a=tinymce.activeEditor.selection.getContent();$("<div></div>").html(a).children().length?e.body=a:e.body=""}e.bodyHtml=e.body,e.bodyView=C.convertStorageToView(e),e.params=e.params?e.params:{},e.params.id=(new Date).getTime()+"_"+(0,A.hashCode)(e.bodyView),e.params.hasTable=e.body.indexOf("table")>0,e.params.isFirstTimeEnter=e.params.hasTable?void 0===e.params.isFirstTimeEnter:void 0,t.showDialog(e,I,J,k,O),AJS.MacroBrowser.dialog&&(AJS.MacroBrowser.dialog.activeMetadata=null)};function I(e,t){e.params.isFirstTimeEnter=t,b.default.gaEditorTransformer(e.params,e.storedParams),tinymce.confluence.macrobrowser.macroBrowserComplete(e)}function J(){tinymce.confluence.macrobrowser.macroBrowserCancel()}function k(e,t){var a={contentId:u.default.getContentId(),macroName:e.name,params:e.params,body:e.bodyHtml,successCallback:function(e){t(e)},errorCallback:function(e){AJS.logError(e)}};AJS.MacroBrowser.Rest.fetchMacroPreviewData(a)}function O(){return AJS.params.staticResourceUrlPrefix+"/blank.html"}var M=AJS.MacroBrowser.previewOnload;AJS.MacroBrowser.previewOnload=function(e){if(AJS.MacroBrowser.dialog&&AJS.MacroBrowser.dialog.activeMetadata)return M(e)};a(67285),a(68268),a(98457);var D=a(79086),F=a.n(D),_=a(16951),B=a.n(_),N=a(40479),E=a(94121),R=a(78299),L=function(){var e=this;e.tables=[],e.iconTables=[],e.tableColumns=[],e.sortColumns=[],e.columnSelect=null,e.userfilterSelect=null,e.numberfilterSelect=null,e.datefilterSelect=null,e.iconfilterSelect=null,e.sortSelect=null,e.columnParams=[],e.userfilterParams=[],e.numberfilterParams=[],e.datefilterParams=[],e.iconfilterParams=[],e.sortParams=[],e.dateFormatInput=null,e.dateFormatContainer=null,e.separatorContainer=null,e.tfBody="",e.defaults={},e.widths={},e.inverse={},e.gotBody=!1,e.order={},e.labels={},e.ddSeparators={},e.ddOperators={},e.totalRow=[],e.locale=AJS.Meta.get("user-locale").replace("-","_")};function j(e,t){return!!e.val()&&-1!==e.val().indexOf(t)}L.prototype.getMacroDetails=function(e){var t=this;t.columnParams=[],t.userfilterParams=[],t.numberfilterParams=[],t.datefilterParams=[],t.iconfilterParams=[],t.sortParams=[],t.chosenUpdated=!1,t.gotBody=!0,t.tfBody=e,t.body=$('<div><div class="tablefilter-table-wrapper">'+e+"</div></div>"),t.tables=u.default.getTables(t.body),t.iconTables=u.default.getTables(t.body,u.default.visualType),t.tableColumns=u.default.getColumns(t.tables),t.sortColumns=[],$.each(t.tableColumns,(function(e,a){$.trim(a).length&&(t.sortColumns.push(a+" ⇧"),t.sortColumns.push(a+" ⇩"))}))},L.prototype.transformElements=function(e){var t=this;N.default.adaptOldParamsTF(e);var a={thousandSeparator:{"":{title:""},"\\u0020":{title:"Space ( )"},".":{title:"Point (.)"},",":{title:"Comma (,)"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},isOR:{AND:{title:"AND"},OR:{title:"OR"}},numbering:{"":{title:""},"Dynamic Ascending":{title:"Dynamic Ascending"},"Static Ascending":{title:"Static Ascending"},"Dynamic Descending":{title:"Dynamic Descending"},"Static Descending":{title:"Static Descending"}},totalcol:{"":{title:"",hiddenParams:["totalColName","thousandSeparator"]},Sum:{title:"Sum",shownParams:["thousandSeparator"]},Average:{title:"Average",shownParams:["thousandSeparator"]},Multiplication:{title:"Multiplication",shownParams:["thousandSeparator"]},Min:{title:"Min",shownParams:["thousandSeparator"]},Max:{title:"Max",shownParams:["thousandSeparator"]}},hidePane:{"Filtration panel":{title:"Filtration panel"},"Table header":{title:"Table header",hiddenParams:["hidelabels","labels","disabled"]},true:{title:"Hidden",hiddenParams:["hidelabels","disableSave","hideControls"]}}};$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),t.setTypeNumbers($("#macro-param-limitHeight"));var r=$("#macro-param-limitHeight");t.setTypeNumbers($("#macro-param-fixedCols")),t.setTypeNumbers($("#macro-param-rowsPerPage")),t.setTypeNumbers($("#macro-param-showNRowsifNotFiltered")),t.setTypeNumbers($("#macro-param-ignoreFirstNrows"));var o=[],i=[],n=[],c=[],m=[],p=[];null!=e.column&&(o=e.column.split(",")),null!=e.userfilter&&(i=e.userfilter.split(",")),e.sort&&(e.sort=e.sort.replace(/ \(\u200DDesc\)/g," ⇩").replace(/ \(\u200DAsc\)/g," ⇧"),p=e.sort.split(",")),null!=e.iconfilter&&(m=e.iconfilter.split(",")),null!=e.totalrow?t.totalRow=e.totalrow.split(","):t.totalRow=[],e.limitHeight="true"==e.limitHeight?1:e.limitHeight,Object.prototype.hasOwnProperty.call(e,"isNew")||(e.isNew=!e.datepattern),function(e){e.globalFilter&&$("#macro-param-globalFilter").prop("checked",!0);e.hideColumns&&$("#macro-param-hideColumns").prop("checked",!0);e.hidePane&&$("#macro-param-hidePane").val(e.hidePane);e.hidelabels&&$("#macro-param-hidelabels").prop("checked",!0);e.hideControls&&$("#macro-param-hideControls").prop("checked",!0);e.disableSave&&$("#macro-param-disableSave").prop("checked",!0);e.separator&&$("#macro-param-separator").val(e.separator);e.showNRowsifNotFiltered&&$("#macro-param-showNRowsifNotFiltered").val(e.showNRowsifNotFiltered);e.rowsPerPage&&$("#macro-param-rowsPerPage").val(e.rowsPerPage);e.ignoreFirstNrows&&$("#macro-param-ignoreFirstNrows").val(e.ignoreFirstNrows);e.numbering&&$("#macro-param-numbering").val(e.numbering);e.limitHeight&&$("#macro-param-limitHeight").val(e.limitHeight);e.fixedCols&&$("#macro-param-fixedCols").val(e.fixedCols);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.ddOperator&&$("#macro-param-ddOperator").val(e.ddOperator);e.isOR&&$("#macro-param-isOR").val(e.isOR);e.totalcol&&$("#macro-param-totalcol").val(e.totalcol);e.totalColName&&$("#macro-param-totalColName").val(e.totalColName);e.totalrow&&$("#macro-param-totalrow").val(e.totalrow);e.totalRowName&&$("#macro-param-totalRowName").val(e.totalRowName);"true"==e.disabled&&$("#macro-param-disabled").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.updateSelectOptions&&$("#macro-param-updateSelectOptions").prop(e.updateSelectOptions)}(e),t.separatorContainer=$("#macro-param-div-separator"),t.dateFormatInput=$("#macro-param-datepattern"),t.totalRowInput=$("#macro-param-totalrow"),null!=e.datefilter&&(c=e.datefilter.split(",")),null!=e.numberfilter&&(n=e.numberfilter.split(",")),l.default.initDateFormatInput(e),l.default.initCheckBoxesParams(e),d.default.initMacroBrowserWorklogDialog(e.worklog);var f=$("#macro-param-column"),g=$("#macro-param-userfilter"),b=$("#macro-param-datefilter"),h=$("#macro-param-numberfilter"),v=$("#macro-param-iconfilter"),S=$("#macro-param-sort"),y=$.merge([],o);$.merge(y,i),$.merge(y,c),$.merge(y,n),$.merge(y,m),$.each(y,(function(e,a){var l=$.trim(a.replace(/\‚/g,",")).replace("‌","");-1==$.inArray(l,t.tableColumns)&&(t.tableColumns.push(l),t.sortColumns.push(l+" ⇧"),t.sortColumns.push(l+" ⇩"))})),$.each(p,(function(e,a){var l=$.trim(a.replace(/\‚/g,","));-1==$.inArray(l,t.sortColumns)&&t.sortColumns.push(l)})),t.tableColumns.sort(((e,t)=>e.localeCompare(t))),t.sortColumns.sort(((e,t)=>e.localeCompare(t))),t.columnSelect=t.createSelect(f,t.tableColumns,o,t.columnParams,(()=>E.default.macrobrowserFilterAdded("dropdown","normal"))),t.userfilterSelect=t.createSelect(g,t.tableColumns,i,t.userfilterParams,(()=>E.default.macrobrowserFilterAdded("freeText","normal"))),t.datefilterSelect=t.createSelect(b,t.tableColumns,c,t.datefilterParams,(()=>E.default.macrobrowserFilterAdded("date","normal"))),t.numberfilterSelect=t.createSelect(h,t.tableColumns,n,t.numberfilterParams,(()=>E.default.macrobrowserFilterAdded("number","normal"))),t.iconfilterSelect=t.createSelect(v,t.tableColumns,m,t.iconfilterParams,(()=>E.default.macrobrowserFilterAdded("icon","normal"))),t.sortSelect=t.createSelect(S,t.sortColumns,p,t.sortParams,null,!0),$("#macro-param-globalFilter").change((()=>E.default.macrobrowserFilterAdded("global","normal"))),$("#macro-param-hideColumns").change((()=>E.default.macrobrowserFilterAdded("hideColumns","normal"))),t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.columnSelect,t.columnParams),u.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),u.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),u.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),u.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),u.default.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),d.default.initMacroBrowserDefaultValueDialog(t,$("#macro-param-div-default")),d.default.initMacroBrowserCellWidthDialog(t,$("#macro-param-div-cell-width")),d.default.initMacroBrowserInverseFilterDialog(t,$("#macro-param-div-inverse")),d.default.initMacroBrowserFilterLabelsDialog(t,$("#macro-param-div-labels")),d.default.initMacroBrowserDDSeparatorDialog(t,$("#macro-param-div-ddSeparator")),d.default.initMacroBrowserDDOperatorDialog(t,$("#macro-param-div-ddOperator")),d.default.initMacroBrowserTotalRowDialog(t,$("#macro-param-div-totalrow"));var x=e.default?e.default.split(","):[],T=e["cell-width"]?e["cell-width"].split(","):[],w=e.inverse?e.inverse.split(","):[],C=e.order?e.order.split(","):[],A=e.labels?e.labels.split("‚"):[],P=e.ddSeparator?e.ddSeparator.split("‚"):[],I=e.ddOperator?e.ddOperator.split(","):[],J=0,k=0,O=0,M=0,D=0,_=0,B=0,L=1!==P.length||e.ddSeparators?"":P[0];e.ddSeparators=!0,u.default.i18nFilterValues(x),t.order.select_=[],$.each(o,(function(e,a){var l=a.replace("‌","");t.defaults["select_"+l]=x.length>J?x[J++]:"",t.inverse["select_"+l]=w.length>M&&"true"==w[M++],t.widths["select_"+l]=T.length>k?T[k++]:"",t.labels["select_"+l]=A.length>O?A[O++]:"",t.ddSeparators["select_"+l]=P.length>_?P[_++]:L,t.ddOperators["select_"+l]=I.length>B?I[B++]:"OR",t.order.select_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.freetext_=[],$.each(i,(function(e,a){var l=a.replace("‌","");t.defaults["freetext_"+l]=x.length>J?x[J++]:"",t.inverse["freetext_"+l]=w.length>M&&"true"==w[M++],t.widths["freetext_"+l]=T.length>k?T[k++]:"",t.labels["freetext_"+l]=A.length>O?A[O++]:"",t.order.freetext_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.number_=[],$.each(n,(function(e,a){var l=a.replace("‌","");t.defaults["number_"+l]=x.length>J?x[J++]:"",t.inverse["number_"+l]=w.length>M&&"true"==w[M++],t.labels["number_"+l]=A.length>O?A[O++]:"",t.order.number_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.date_=[],$.each(c,(function(e,a){var l=a.replace("‌","");t.defaults["date_"+l]=x.length>J?x[J++]:"",t.inverse["date_"+l]=w.length>M&&"true"==w[M++],t.labels["date_"+l]=A.length>O?A[O++]:"",t.order.date_.push(C.length>D?parseInt(C[D++]):D++)})),t.order.global=[],e.globalFilter&&(t.defaults.global=x.length>J?x[J++]:"",t.inverse.global=w.length>M&&"true"==w[M++],t.widths.global=T.length>k?T[k++]:"",t.labels.global=A.length>O?A[O++]:"",t.order.global.push(C.length>D?parseInt(C[D++]):D+++m.length)),t.order.hideColumns=[],e.hideColumns&&(t.defaults.hideColumns=x.length>J?x[J++]:"",t.inverse.hideColumns=w.length>M&&"true"==w[M++],t.widths.hideColumns=T.length>k?T[k++]:"",t.labels.hideColumns=A.length>O?A[O++]:"",t.order.hideColumns.push(C.length>D?parseInt(C[D++]):D+++m.length)),t.order.icon=[],$.each(m,(function(e,a){var l=a.replace("‌","");t.defaults["icon"+l]=x.length>J?x[J++]:"",t.inverse["icon"+l]=w.length>M&&"true"==w[M++],t.widths["icon"+l]=T.length>k?T[k++]:"",t.labels["icon"+l]=A.length>O?A[O++]:"",t.ddOperators["icon"+l]=I.length>B?I[B++]:"OR",t.order.icon.push(C.length>D?parseInt(C[D++]):D++-t.order.hideColumns.length-t.order.global.length)})),t.columnSelect.one("chosen:showing_dropdown",(function(){t.columnSelect.click()}));var j=$("#macro-param-sparkline"),V=$("#macro-param-sparkName");V.val("Sparkline");var H=V.parent();H.addClass("tf-always-hidden"),e.sparkline&&"false"!==e.sparkline&&(j.prop("checked",!0),H.removeClass("tf-always-hidden"),V.val(e.sparkName)),j.change((function(){$(this).prop("checked")?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),H.removeClass("tf-always-hidden")):H.addClass("tf-always-hidden")}));var K=$("#macro-param-heightValue"),U=K.parent();U.addClass("tf-always-hidden"),e.limitHeight&&(r.val(e.limitHeight),U.removeClass("tf-always-hidden"),K.val(e.heightValue)),r.bind("keyup keydown change",(function(){r.val()>0?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),U.removeClass("tf-always-hidden")):U.addClass("tf-always-hidden")})),t.totaRowNameInput=$("#macro-param-div-totalRowName"),t.thousandSeparatorSelect=$("#macro-param-div-thousandSeparator"),t.totalRowInput.change((function(){t.totalRowInput.val().replace(/,/g,"")?(t.totaRowNameInput.removeClass("tf-always-hidden"),t.thousandSeparatorSelect.removeClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.addClass("tfac-shown-totalrow")):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.removeClass("tfac-shown-totalrow"))})),e.totalrow&&e.totalrow.replace(/,/g,"")?t.thousandSeparatorSelect.addClass("tfac-shown-totalrow"):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow")),s.initSelects(a,e,R.TABLE_FILTER),function(e){$("#macro-param-div-column").before(F().tableFilterTabs());var t=[$("#macro-param-div-column"),$("#macro-param-div-userfilter"),$("#macro-param-div-numberfilter"),$("#macro-param-div-datefilter"),$("#macro-param-div-iconfilter"),$("#macro-param-div-globalFilter"),$("#macro-param-div-hideColumns")],a=[$("#macro-param-div-separator"),$("#macro-param-div-datepattern"),$("#macro-param-div-default"),$("#macro-param-div-cell-width"),$("#macro-param-div-inverse"),$("#macro-param-div-disableSave"),$("#macro-param-div-hidelabels"),$("#macro-param-div-hidePane"),$("#macro-param-div-hideControls"),$("#macro-param-div-isOR"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-ddOperator"),$("#macro-param-div-ignoreFirstNrows"),$("#macro-param-div-labels"),$("#macro-param-div-disabled"),$("#macro-param-div-worklog"),$("#macro-param-div-updateSelectOptions"),$("#macro-param-div-enabledInEditor"),$("#macro-param-div-tabs")],l=[$("#macro-param-div-showNRowsifNotFiltered"),$("#macro-param-div-rowsPerPage"),$("#macro-param-div-numbering"),$("#macro-param-div-sort"),$("#macro-param-div-fixedCols"),$("#macro-param-div-limitHeight"),$("#macro-param-div-sparkline"),$("#macro-param-div-sparkName"),$("#macro-param-div-totalrow"),$("#macro-param-div-totalcol"),$("#macro-param-div-totalColName"),$("#macro-param-div-totalRowName"),$("#macro-param-div-thousandSeparator"),$("#macro-param-div-heightValue")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var r=$("#tab-filters"),o=$("#tab-filter-options"),i=$("#tab-table-options"),n=[r,o,i];function s(e){a(e[0],"in");for(var t=1;t<e.length;t++)a(e[t],"out");function a(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].show():e[a].hide()}}function c(e){e.hasClass("active-tab")||(n.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}r.click((function(){c(r),s([t,a,l])})),o.click((function(){c(o),s([a,t,l])})),i.click((function(){c(i),s([l,t,a])})),r.trigger("click")}(t.isCloud)},L.prototype.createSelect=function(e,t,a,l,r,o){e.hide(),$.each(a,(function(e,t){l.push($.trim(t))})),$.each(a,(function(e,t){a[e]=$.trim(t.replace(/\‚/g,",")).replace("‌","")}));var i=$("<select multiple/>");$.each(t,(function(t,l){var r=-1==$.inArray(l,a)?"":'selected="selected" ',o="";if(e.is("#macro-param-sort")){var n=l;n=-1!=n.indexOf("⇧")?n.replace("⇧","⇩"):n.replace("⇩","⇧"),-1!=$.inArray(n,a)&&(o='style="display: none"')}i.append($("<option "+r+o+"></option>").text(l))})),e.after(i),i.chosenTF({no_results_text:o?"No matches found":"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!o}).change((function(t,a){if(null!=a.selected){if(i.find("option").filter((function(){return this.textContent===a.selected})).prop("selected",!0),""==(s=a.selected)&&(s="‌"),l.push(s.replace(/\,/g,"‚")),e.is("#macro-param-sort")){c=-1!=(c=a.selected).indexOf("⇧")?c.replace("⇧","⇩"):c.replace("⇩","⇧"),i.find("option").filter((function(){return this.textContent==c})).hide(),i.trigger("chosen:updated");for(var o=i.parent().find("ul.chosen-choices"),n=l.length-1;n>=0;n--)o.prepend(o.find("li").filter((function(){return this.textContent==l[n].replace(/\‚/g,",")})))}}else if(null!=a.deselected){var s;if($(this).find("option").filter((function(){return this.textContent==a.deselected})).prop("selected",!1),""==(s=a.deselected)&&(s="‌"),l.splice($.inArray(s.replace(/\,/g,"‚"),l),1),e.is("#macro-param-sort")){var c;c=-1!=(c=a.deselected).indexOf("⇧")?c.replace("⇧","⇩"):c.replace("⇩","⇧"),i.find("option").filter((function(){return this.textContent==c})).show(),i.trigger("chosen:updated");for(o=i.parent().find("ul.chosen-choices"),n=l.length-1;n>=0;n--)o.prepend(o.find("li").filter((function(e){return this.textContent==l[n].replace(/\‚/g,",")})))}}e.val(l.join(",")),r&&r()}));var n=u.default.sortSelectedOptions(i,l);return n.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){l=[],n.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e="‌"),l.push(e.replace(/\,/g,"‚"))})),e.val(l.join(","))}}),i},L.prototype.getSelectFilterOptions=function(e,t){var a=this,l=[],r=[],o=!0,i=a.ddSeparators["select_"+e];return i=i?i.replace(/\,/g,"‚").replace(/\\u0020/g," "):i,$.each(a.tables,(function(n,s){$.each(s[0],(function(c,m){if(e.toLocaleLowerCase()===u.default.clearString(m).toLocaleLowerCase()){var p=t?a.iconTables[n]:s;if($.each(p,(function(e,a){if(0!==e)if(t&&a[c]){var n=$(a[c]);n.filter("img").each((function(){var e=u.default.clearIconSrc(this.src);-1===$.inArray(e,r)&&(r.push(e),l.push(B().sanitize(this.outerHTML)))})),n.filter("ul").length&&o&&(o=!1,-1===$.inArray('<ul class="inline-task-list"><li></li></ul>',r)&&(l.push('<ul class="inline-task-list"><li></li></ul>'),r.push('<ul class="inline-task-list"><li></li></ul>')),-1===$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',r)&&(l.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),r.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else if(null!=a[c]){var s=a[c].replace(/\,/g,"‚");(s=i?s.split(i):[s]).forEach((function(e){e=e.trim(),-1===$.inArray(e,l)&&l.push(e)}))}})),!t&&-1===$.inArray("@currentUser",l)){var d=c+1;a.body.find("table").eq(n).find("tr td:nth-child("+d+"), tr th:nth-child("+d+")").find(".confluence-userlink, ri\\:user").length&&l.push("@currentUser")}}}))})),{allSelects:l,options:r}},L.prototype.updateColumns=function(e){var t=this;function a(e){t.body=e;var a=!1,l=!1;u.default.normalizeTable(u.default.getTableNodes(e)),t.tables=u.default.getTables(e),t.iconTables=u.default.getTables(e,u.default.visualType),$.each(u.default.getRawColumns(t.tables),(function(e,r){if(-1===$.inArray(r,t.tableColumns)&&(a=!0,t.tableColumns.push(r),t.columnSelect.append($("<option></option>").val(r).text(r)),t.userfilterSelect.append($("<option></option>").val(r).text(r)),t.datefilterSelect.append($("<option></option>").val(r).text(r)),t.numberfilterSelect.append($("<option></option>").val(r).text(r)),t.iconfilterSelect.append($("<option></option>").val(r).text(r))),$.trim(r).length){if(-1==$.inArray(r+" ⇧",t.sortColumns)){l=!0,t.sortColumns.push(r+" ⇧");var o="";j(t.sortSelect,r+" ⇩")&&(o=' style="display:none"'),t.sortSelect.append($("<option"+o+"></option>").val(r+" ⇧").text(r+" ⇧"))}if(-1==$.inArray(r+" ⇩",t.sortColumns)){l=!0,t.sortColumns.push(r+" ⇩");o="";j(t.sortSelect,r+" ⇧")&&(o=' style="display:none"'),t.sortSelect.append($("<option"+o+"></option>").val(r+" ⇩").text(r+" ⇩"))}}})),a&&(u.default.sortSelectOptions(t.columnSelect),u.default.sortSelectOptions(t.userfilterSelect),u.default.sortSelectOptions(t.datefilterSelect),u.default.sortSelectOptions(t.numberfilterSelect),u.default.sortSelectOptions(t.iconfilterSelect),t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.columnSelect,t.columnParams),u.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),u.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),u.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),u.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams)),l&&(u.default.sortSelectOptions(t.sortSelect),t.sortSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.sortSelect,t.sortParams))}t.body=e,l.default.bindPreview(e,a),u.default.addIframe(t.body,"tablefilter-table-wrapper",a),a(e)},L.prototype.getComputationalParams=function(e){var t=this,a=null!=e.column?e.column.split(","):[],l=null!=e.userfilter?e.userfilter.split(","):[],r=null!=e.numberfilter?e.numberfilter.split(","):[],o=null!=e.datefilter?e.datefilter.split(","):[],i=null!=e.iconfilter?e.iconfilter.split(","):[],n=[],s=[],c=[],m=[],p=[],d=[],f=[],g={},b=0;return b=h(t,a,"select_"),b=h(t,l,"freetext_"),b=h(t,r,"number_"),b=h(t,o,"date_"),e.globalFilter&&(b=h(t,[""],"global")),e.hideColumns&&(b=h(t,[""],"hideColumns")),h(t,i,"icon",(e.globalFilter?1:0)+(e.hideColumns?1:0)),p.slice().sort((function(e,t){return e-t})).forEach((function(e,t){p[$.inArray(e,p)]=t})),u.default.unI18nFilterValues(n),e.default=n.join(","),e["cell-width"]=s.join(","),e.inverse=c.join(","),e.labels=m.join("‚"),e.order=p.join(","),e.ddSeparator=d.join("‚"),e.ddOperator=f.join(","),e;function h(e,t,a,l){return $.each(t,(function(t,r){var o=$.trim(r.replace(/\‚/g,",")).replace("‌","");n.push(e.defaults[a+o]),"number_"!=a&&"date_"!=a&&s.push(e.widths[a+o]),c.push(e.inverse[a+o]),m.push(e.labels[a+o]),"select_"===a&&d.push(e.ddSeparators[a+o]),"select_"!==a&&"icon"!==a||f.push(e.ddOperators[a+o]);var i=e.order[a][t];if(null==i){if(0==p.length)i=0;else{b=0;var u=p.length-1;"icon"==a&&0==t&&(u-=l),i=u>=0?p[u]+1:0}var h=i-b,v=h;$.each(g,(function(e,t){v>e&&(h-=t)})),g[h]?g[h]++:g[h]=1,p.forEach((function(e,t){e>=i-b&&t<p.length-b&&(p[t]+=1)})),b++}else{b=0;for(var S=i;S>=0;S--)g[S]&&(i+=g[S])}p.push(i)})),b}},L.prototype.getSelectedFilters=function(){var e=[];if($("div.macro-param-div:not(#macro-param-div-sort) .chosen-choices .search-choice").each((function(){var t=$(this),a=t.parents("#macro-param-div-column").length>0,l=t.parents("#macro-param-div-datefilter").length>0,r=t.parents("#macro-param-div-numberfilter").length>0,o=t.parents("#macro-param-div-userfilter").length>0,i=t.parents("#macro-param-div-iconfilter").length>0,n=i?"icon":l?"date_":r?"number_":o?"freetext_":"select_";e.push({field:t.text(),isSelect:a,isDate:l,isNumber:r,isText:o,isIcon:i,type:n})})),$("#macro-param-globalFilter").prop("checked")){var t="Filter whole table";e.push({field:t,type:"global"})}if($("#macro-param-hideColumns").prop("checked")){var a="Columns to hide";e.push({field:a,type:"hideColumns"})}return e},L.prototype.setTypeNumbers=function(e){e.replaceWith(e.clone().attr("type","number").attr("min","0"))};var V,H=L,K=a(94874),U=function(){this.tableFilterMacro=new H,this.tableFilterMacro.storedParams={},this.tableFilterMacro.isSaveClick=!1,this.tableFilterMacro.isSetParams=!1,this.tableFilterMacro.hasTable=!1};U.prototype.getMacroDetailsFromSelectedMacro=function(e,t){var a=V.tableFilterMacro;V.bodyView=C.convertStorageToView(t),a.getMacroDetails(V.bodyView),C.showTabsParam(V.bodyView),a.hasTable=V.bodyView.indexOf("table")>0},U.prototype.postPreview=function(e){var t=V.tableFilterMacro;t.updateColumns($(e).contents().find(".tablefilter-table-wrapper")),t.isSaveClick=!1,t.isSetParams=!1,window.TableBinderWasBind||(window.TableBinderWasBind=!0,K.default.bindFilterActions(),K.default.bindOptionsEvents())},U.prototype.beforeParamsSet=function(e){var t=V.tableFilterMacro;return t.gotBody||V.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,("true"==e.numbering||"Dynamic"==e.numbering)&&(e.numbering="Dynamic Ascending"),e.id=(new Date).getTime()+"_"+(0,A.hashCode)(t.tfBody),t.transformElements(e),""==e.column&&(e.column="‌"),""==e.userfilter&&(e.userfilter="‌"),""==e.iconfilter&&(e.iconfilter="‌"),""==e.datefilter&&(e.datefilter="‌"),""==e.numberfilter&&(e.numberfilter="‌"),C.showTabsParam(V.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e},U.prototype.manipulateMarkup=function(e){return V.tableFilterMacro.isSaveClick=!0,V.tableFilterMacro.isSetParams=!1,e},U.prototype.beforeParamsRetrieved=function(e){var t=V.tableFilterMacro;return t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.columnSelect,t.columnParams),u.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),u.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),u.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),u.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),u.default.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),e.limitHeight=$("#macro-param-limitHeight").val(),e=t.getComputationalParams(e),t.isSaveClick&&(e.isFirstTimeEnter&&b.default.gaTFInsert("TF Saved in Macro Browser",t.tables.length),K.default.triggerFilterMacroBrowserEvents(e,t.storedParams),b.default.gaEditorTF(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e};var q=V=new U,z=(a(63045),a(97669)),G=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.aggregateSelect=null,this.typeSelect=null,this.tfBody="",this.columnParams=[],this.aggregateParams=[],this.isPivot=!1,this.gotBody=!1,this.transpose=!1,this.colors=[],this.pieKeys=[],this.isCloud=!1};function W(e,t,a,l,r,o){e.hide();var i=$("<select multiple/>");return $.each(a,(function(e,a){a=$.trim(a).replace("‌",""),-1==$.inArray(a,t)&&t.push(a)})),t.sort(((e,t)=>e.localeCompare(t))),$.each(t,(function(e,t){i.append($("<option></option>").text(t))})),$.each(l,(function(e,a){a=$.trim(a).replace("‌",""),-1==$.inArray(a,t)&&(t.push(a),i.append($("<option></option>").text(a)))})),e.after(i),function(e,t,a,l,r){e.chosenTF({no_results_text:"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!0}).change((function(l,o){if(null!=o.selected)e.find("option").filter((function(){return this.textContent==o.selected})).prop("selected",!0),""==(i=o.selected)&&(i="‌"),a.push(i);else if(null!=o.deselected){var i;e.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),""==(i=o.deselected)&&(i="‌"),a.splice($.inArray(i,a),1)}t.val(a.join("‚")),r&&r.updatePieKeys()}));var o=u.default.sortSelectedOptions(e,a);o.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var e=a.slice();a.length=0,o.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e="‌"),a.push(e)}));var r=l.slice();e.forEach((function(e,t){var o=$.inArray(e,a);o>=0&&r.length>o&&(l[o]=r[t])})),t.val(a.join("‚"))}});var i=[];a.forEach((function(e){i.push(e.replace("‌",""))})),e.val(i),e.trigger("chosen:updated"),t.val(a.join("‚"))}(i,e,a,r,o),i}function X(e){e.hasClass("chart-browser-hidden")||e.addClass("chart-browser-hidden")}function Q(e){e.hasClass("chart-browser-hidden")&&e.removeClass("chart-browser-hidden")}G.prototype.getMacroDetails=function(e,t,a,l){var r=this;r.isCloud=l,r.transpose="Horizontal"==t.dataorientation,r.gotBody=!0,r.isPivot=a||!1,r.tfBody=e,r.initTableChart(t),r.setTables(r.tfBody),r.tables=r.TableChart.tables,r.tableColumns=u.default.getColumns(r.tables)},G.prototype.transformElements=function(e){var t=this,a={type:{Pie:{title:"Pie",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle"]},Donut:{title:"Donut",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle"]},Column:{title:"Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},"Stacked Column":{title:"Stacked Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},Bar:{title:"Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},"Stacked Bar":{title:"Stacked Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","outerLabels"]},"Bubble Pie":{title:"Bubble Pie",hiddenParams:["line-settings","is3d","trendline","interpolation","xlog","log","outerLabels"],labels:{column:"X-axis and Y-axis columns",xtitle:"X-axis label",ytitle:"Y-axis label"}},Line:{title:"Line",hiddenParams:["datepattern","innerlabels","is3d","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Area:{title:"Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Area":{title:"Stacked Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Line":{title:"Time Line",hiddenParams:["xlog","innerlabels","is3d","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Area":{title:"Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Time Area":{title:"Stacked Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Gantt:{title:"Gantt",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","legend","scalestep","interpolation","minvalue","maxvalue","outerLabels"],labels:{ytitle:"Date axis label",xscalestep:"Scale step",xminvalue:"Minimal value",xmaxvalue:"Maximal value"}},Radar:{title:"Radar",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","xscalestep","interpolation","minvalue","datepattern","xminvalue","xmaxvalue","xtitle","ytitle","outerLabels"]},__default:{labels:{aggregation:"Values column",column:"Labels column",xtitle:"Row axis label",log:"Logarithmic scale",xscalestep:"Scale X step",xminvalue:"Minimal X value",xmaxvalue:"Maximal X value",scalestep:"Scale step",minvalue:"Minimal value",maxvalue:"Maximal value",ytitle:"Value axis label"}}},align:{Center:{title:"Center"},Left:{title:"Left"},Right:{title:"Right"}},hide:{false:{title:"Show all content"},true:{title:"Hide tables"},all:{title:"Hide all content"}},outerLabels:{Label:{title:"Label"},None:{title:"None"}},legend:{right:{title:"Right"},under:{title:"Bottom"},none:{title:"None"}},innerlabels:{Value:{title:"Number"},None:{title:"None"},Percentage:{title:"Percentage"},"Value (Percentage)":{title:"Number (Percentage)"},"Percentage (Value)":{title:"Percentage (Number)"}},dataorientation:{Vertical:{title:"Vertical"},Horizontal:{title:"Horizontal"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}}};if(0===Object.getOwnPropertyNames(e).length&&(e.isNew=!0),!e.version&&!e.formatVersion&&(e.version=2,e.formatVersion=2,e.type&&(e.type.indexOf("Line")>=0||e.type.indexOf("Area")>=0))){var r=e.column;e.column=e.aggregation,e.aggregation=r}e.type&&e.type.indexOf("3D ")>=0&&(e.type=e.type.replace("3D ",""),e.is3d=!0),z.default.initParamBarColoringType(e),t.transpose="Horizontal"==e.dataorientation,$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split("‚"),$.each(t.columnParams,(function(e,a){t.columnParams[e]=$.trim(a)}))):t.columnParams=t.tableColumns.length?[u.default.getRawColumns(t.tables)[0]]:[],e.aggregation?(t.aggregateParams=e.aggregation.split("‚"),$.each(t.aggregateParams,(function(e,a){t.aggregateParams[e]=$.trim(a)}))):t.aggregateParams=t.tableColumns.length>1?[u.default.getRawColumns(t.tables)[1]]:[],e.colors&&(t.colors=e.colors.split(",")),u.default.chartColors.forEach((function(e){-1==$.inArray(e,t.colors)&&t.colors.push(e)})),e.pieKeys&&(t.pieKeys=e.pieKeys.split("‚")),2!=e.version&&2!=e.formatVersion||(e.version=3,e.formatVersion=3,"false"===e.innerlabels?e.innerlabels="None":e.type&&"Pie"!==e.type&&-1===e.type.indexOf("Donut")||(e.innerlabels="Percentage")),Object.prototype.hasOwnProperty.call(e,"isNew")||(e.isNew=!e.datepattern),function(e){(e.dateFormat||e.datepattern)&&$("#macro-param-datepattern").val(e.dateFormat||e.datepattern);(e["tfc-height"]||e.height)&&$("#macro-param-tfc-height").val(e["tfc-height"]||e.height);(e["tfc-width"]||e.width)&&$("#macro-param-tfc-width").val(e["tfc-width"]||e.width);(e.separator||e.decimalSeparator)&&$("#macro-param-separator").val(e.separator||e.decimalSeparator);$("#macro-param-hide").val(e.hide||e.hideSource||"false"),("true"==e.hideControls||"true"==e.hidecontrols)&&$("#macro-param-hidecontrols").prop("checked",!0);"false"==e.grid?$("#macro-param-grid").prop("checked",!1):$("#macro-param-grid").prop("checked",!0);"string"==typeof e.legend?"false"==e.legend?e.legend="none":"true"==e.legend&&(e.legend="right"):e.legend||void 0===e.legend?e.legend="right":e.legend="none";$("#macro-param-legend").val(e.legend),e.minvalue&&$("#macro-param-minvalue").val(e.minvalue);e.maxvalue&&$("#macro-param-maxvalue").val(e.maxvalue);e.xminvalue&&$("#macro-param-xminvalue").val(e.xminvalue);e.xmaxvalue&&$("#macro-param-xmaxvalue").val(e.xmaxvalue);e.scalestep&&$("#macro-param-scalestep").val(e.scalestep);e.xscalestep&&$("#macro-param-xscalestep").val(e.xscalestep);e.title&&$("#macro-param-title").val(e.title);e.xtitle&&$("#macro-param-xtitle").val(e.xtitle);e.ytitle&&$("#macro-param-ytitle").val(e.ytitle);"true"==e.log&&$("#macro-param-log").prop("checked",!0);"true"==e.xlog&&$("#macro-param-xlog").prop("checked",!0);"true"==e.trendline&&$("#macro-param-trendline").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.is3d&&$("#macro-param-is3d").prop("checked",!0);e.interpolation&&$("#macro-param-interpolation").val(e.interpolation);e["line-settings"]&&$("#macro-param-line-settings").val(e["line-settings"])}(e),t.columnInput=$("#macro-param-column"),t.aggregateInput=$("#macro-param-aggregation"),t.columnSelect=W(t.columnInput,t.tableColumns,t.columnParams,t.aggregateParams,[],t),t.aggregateSelect=W(t.aggregateInput,t.tableColumns,t.aggregateParams,[],t.colors,t),t.typeSelect=$("#macro-param-type"),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),t.dateFormatInput=$("#macro-param-datepattern"),l.default.initDateFormatInput(e),d.default.initMacroBrowserWorklogDialog(e.worklog);var o=$("#macro-param-div-colors"),i=$("#macro-param-div-column"),n=$("#macro-param-div-aggregation"),c=$("#macro-param-div-scalestep"),m=$("#macro-param-div-xscalestep"),p=$("#macro-param-div-type"),f=$("#macro-param-div-maxvalue");c.find(".macro-param-desc").addClass("chart-browser-hidden");var g="Gantt"===e.type;t.typeSelect.change((function(){var e=!0;t.isPie="Pie"===t.typeSelect.val()||"Donut"===t.typeSelect.val(),t.isBar=t.typeSelect.val().indexOf("Bar")>=0||t.typeSelect.val().indexOf("Column")>=0,t.isGantt="Gantt"===t.typeSelect.val(),t.isBubblePie="Bubble Pie"===t.typeSelect.val(),t.isMultipleChoice=t.isBar||t.typeSelect.val().indexOf("Line")>=0||t.typeSelect.val().indexOf("Area")>=0||t.isGantt,c.find(".macro-param-desc").text("For scale X enter number of days (X), weeks (Xw), months (Xm) or years (Xy)"),t.isBubblePie?Q(c.find(".macro-param-desc").text("For time scales enter number of hours (Xh/Yh), days (X/Y), months (Xm/Ym) or years (Xy/Yy)").removeClass("gantt")):t.typeSelect.val().indexOf("Time")>=0?Q(c.find(".macro-param-desc").removeClass("gantt")):(t.isGantt?Q(c.find(".macro-param-desc").addClass("gantt")):X(c.find(".macro-param-desc")),e="Line"===t.typeSelect.val()||"Area"===t.typeSelect.val()||"Stacked Area"===t.typeSelect.val()),t.isPivot&&(X(i),t.tableColumns.length>2?n.show():X(n)),(t.isGantt?!g:g)&&(g&&t.columnParams.length>1&&(t.columnParams.length=1,t.columnSelect.find("option:selected").removeAttr("selected"),t.columnSelect.find("option").filter((function(){return this.textContent==t.columnParams[0]})).attr("selected","selected"),t.columnInput.val(t.columnParams[0]),t.columnSelect.trigger("chosen:updated")),g=t.isGantt),m.removeClass("gantt"),p.removeClass("short"),e||t.isBubblePie?c.addClass("multiple").css("display",""):(t.isGantt?m.addClass("gantt"):p.addClass("short"),c.removeClass("multiple")),-1!==t.typeSelect.val().indexOf("Radar")?f.addClass("wide"):f.removeClass("wide"),t.TableChart.typeSelect&&t.updatePieKeys()})),e.type||(e.type="Pie"),s.initSelects(a,e,R.CHART),$("#macro-param-dataorientation").change((function(){t.transpose="Horizontal"==$(this).val(),t.tables=u.default.transpose(t.tables),t.tableColumns=u.default.getColumns(t.tables);var e=u.default.getRawColumns(t.tables);t.columnSelect.find("option").remove(),t.aggregateSelect.find("option").remove(),t.columnParams.length=0,t.aggregateParams.length=0,$.each(t.tableColumns,(function(e,a){t.columnSelect.append($("<option></option>").text(a)),t.aggregateSelect.append($("<option></option>").text(a))})),t.columnSelect.val(e[0]).trigger("change",{selected:e[0]}).trigger("chosen:updated"),t.aggregateSelect.val(e[1]).trigger("change",{selected:e[1]}).trigger("chosen:updated")})),t.TableChart.typeSelect=t.typeSelect,t.updatePieKeys(),d.default.initMacroBrowserChartColorsDialog(t,o),t.initInterpolationDialog(),t.initLineSettingsDialog(),function(){$("#macro-param-div-type").before(F().chartTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-aggregation"),$("#macro-param-div-type"),$("#macro-param-div-is3d")],t=[$("#macro-param-div-tfc-height"),$("#macro-param-div-tfc-width"),$("#macro-param-div-colors"),$("#macro-param-div-align"),$("#macro-param-div-legend"),$("#macro-param-div-grid"),$("#macro-param-div-hide"),$("#macro-param-div-hidecontrols"),$("#macro-param-div-title"),$("#macro-param-div-xtitle"),$("#macro-param-div-ytitle"),$("#macro-param-div-innerlabels"),$("#macro-param-div-outerLabels"),$("#macro-param-div-line-settings")],a=[$("#macro-param-div-datepattern"),$("#macro-param-div-separator"),$("#macro-param-div-dataorientation"),$("#macro-param-div-xminvalue"),$("#macro-param-div-xmaxvalue"),$("#macro-param-div-minvalue"),$("#macro-param-div-maxvalue"),$("#macro-param-div-xscalestep"),$("#macro-param-div-scalestep"),$("#macro-param-div-log"),$("#macro-param-div-xlog"),$("#macro-param-div-interpolation"),$("#macro-param-div-trendline"),$("#macro-param-div-worklog"),$("#macro-param-div-tabs")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var l=$("#tab-columns"),r=$("#tab-display-options"),o=$("#tab-advanced-options"),i=[l,r,o];function n(e){a(e[0],"in");for(var t=1;t<e.length;t++)a(e[t],"out");function a(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].removeClass("chart-browser-hidden-by-tab"):e[a].addClass("chart-browser-hidden-by-tab")}}function s(e){e.hasClass("active-tab")||(i.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}l.click((function(){l.hasClass("active-tab")||(s(l),n([e,t,a]))})),r.click((function(){r.hasClass("active-tab")||(s(r),n([t,e,a]))})),o.click((function(){o.hasClass("active-tab")||(s(o),n([a,e,t]))})),l.trigger("click")}()},G.prototype.initInterpolationDialog=function(){d.default.initMacroBrowserInterpolationDialog(this,$("#macro-param-div-interpolation"))},G.prototype.initLineSettingsDialog=function(){d.default.initMacroBrowserLineSettingsDialog(this,$("#macro-param-div-line-settings"))},G.prototype.initTableChart=function(e){var t=this;t.TableChart=new z.default({macroId:"editor",type:e.type,columns:e.column,aggregation:e.aggregation,dateFormat:e.datepattern,separator:e.separator,pageId:0,dataorientation:e.dataorientation,colors:e.colors,colorColumns:e.colorColumns,pieKeys:e.pieKeys,worklog:e.worklog,sessionId:0,barColoringType:e.barColoringType,lineSettings:e["line-settings"],interpolation:e.interpolation,ganttArrows:e.ganttArrows}),t.TableChart.content=$(),t.TableChart.wrapper=$(),t.TableChart.is3DWrapper=$()},G.prototype.calculateColors=function(){var e=this,t=this.TableChart;t.colors=e.colors,t.pieKeys=e.pieKeys,t.columns=e.columnParams.slice(),t.columnsCache=e.columnParams.slice(),t.aggregation=e.aggregateParams.slice(),t.aggregationCache=e.aggregateParams.slice(),t.transpose=e.transpose,t.dateFormat=e.dateFormatInput.val(),t.getType(),t.setIsMultiColorColumn(),e.setChartKeys(),t.updateColorsKeyMap(e.colors),t.resetDateFormats();var a=u.default.getRawColumns(t.tables);return 1===t.columns.length&&-1===a.indexOf(t.columns[0])&&(t.columns=[]),1===t.aggregation.length&&-1===a.indexOf(t.aggregation[0])&&(t.aggregation=[]),0===t.columns.length&&void 0!==a[0]&&t.columns.push(a[0]),t.isPivot?0===t.aggregation.length&&void 0!==a[a.length-1]&&t.aggregation.push(a[a.length-1]):0===t.aggregation.length&&t.aggregation.push(a[1]),t.calculate(),t.getColorsData()},G.prototype.applyColors=function(e){this.pieKeys=e.pieKeys,this.colors=e.colors},G.prototype.setChartKeys=function(){var e=this.TableChart;e.rebuildColorsAndChartKeys()&&(this.colors=e.colors)},G.prototype.updatePieKeys=function(){var e=this.calculateColors();this.applyColors(e)},G.prototype.getTrimmedColors=function(){var e=this;e.TableChart.columnsCache=e.columnParams.slice(),e.TableChart.aggregationCache=e.aggregateParams.slice(),e.setChartKeys();var t=e.TableChart.getAllChartColorLabels(),a=e.TableChart.getColorsFromMap(e.TableChart.colorKeyMap,t,e.TableChart.palette);return(a=a.slice(0,t.length)).length&&(e.colors=a),e.colors},G.prototype.setTables=function(e){var t=this;t.TableChart.chartBody=$('<div class="chart-body">'+e+"</div>"),t.TableChart.checkPivotContent(),t.TableChart.getOriginalTable()},G.prototype.updateColumns=function(e,t){var a=this;function r(e){var t=!1;a.setTables("string"==typeof e?e:e.html());var l=u.default.getRelevantRows(a.TableChart.rows,a.transpose);a.tables=[];var r=a.TableChart.tables;$.each(r,(function(e,t){var r=[];$.each(t,(function(t,a){l[e][t]&&r.push(a)})),a.tables.push(r)})),$.each(u.default.getRawColumns(a.tables),(function(e,l){if(-1==$.inArray(l,a.tableColumns)){var r;t=!0,a.tableColumns.push(l),0===a.columnParams.length&&0===e?(a.columnParams.push(l),a.columnInput.val(l),r=!0):r=$.inArray(l,a.columnParams)>=0;var o=r?'selected="selected"':"";a.columnSelect.append($("<option "+o+"></option>").text(l)),0===a.aggregateParams.length&&1===e?(a.aggregateParams.push(l),a.aggregateInput.val(l),r=!0):r=$.inArray(l,a.aggregateParams)>=0,o=r?'selected="selected"':"",a.aggregateSelect.append($("<option "+o+"></option>").text(l))}})),a.isPivot&&a.tableColumns.length>2&&($("#macro-param-div-aggregation").removeClass("chart-browser-hidden"),a.typeSelect.find("option").each((function(){var e=$(this);"Line"!=e.val()&&"Area"!=e.val()&&"Stacked Area"!=e.val()||e.show()}))),t&&(a.columnSelect.trigger("chosen:updated"),a.aggregateSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(a.columnSelect,a.columnParams),u.default.sortSelectedOptions(a.aggregateSelect,a.aggregateParams)),a.typeSelect.trigger("change"),a.updatePieKeys()}l.default.bindPreview(e,r),u.default.addIframe(e,"chart-body",(function(e){r(e.map(((e,t)=>{var a;return(null===(a=t.parentElement)||void 0===a?void 0:a.innerHTML)||t.innerHTML})).toArray().join())})),r(e)};var Y,Z=G,ee=!1,te=function(){this.tableChartMacro=null};function ae(e){return null==e.tableChartMacro&&(e.tableChartMacro=new Z,e.tableChartMacro.storedParams={},e.tableChartMacro.isSaveClick=!1,e.tableChartMacro.isSetParams=!1,e.tableChartMacro.hasTable=!1),e.tableChartMacro}te.prototype.getMacroDetailsFromSelectedMacro=function(e,t){ee=!1,Y.bodyView=C.convertStorageToView(t),ae(Y).getMacroDetails(Y.bodyView,t.params,!1),C.showTabsParam(Y.bodyView),Y.tableChartMacro.hasTable=Y.bodyView.indexOf("table")>0},te.prototype.beforeParamsRetrieved=function(e){var t=Y.tableChartMacro;return ee||(t.columnSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.columnSelect,t.columnParams),u.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),ee=!0),e.barColoringType=t.TableChart.barColoringType,e.colors=t.getTrimmedColors().join(","),e.colorColumns=t.TableChart.colorColumns.join(","),e.pieKeys=t.pieKeys.join("‚"),t.isSaveClick&&(e.isFirstTimeEnter&&b.default.gaChartInsert(t.tables.length),b.default.gaEditorChart(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e},te.prototype.postPreview=function(e){var t=Y.tableChartMacro;t.updateColumns($(e).contents().find(".chart-body")),t.isSaveClick=!1,t.isSetParams=!1},te.prototype.manipulateMarkup=function(e){return Y.tableChartMacro.isSaveClick=!0,Y.tableChartMacro.isSetParams=!1,e},te.prototype.beforeParamsSet=function(e){$(".tfc-container").remove();var t=ae(Y);return t.gotBody||Y.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent(),params:e}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+(0,A.hashCode)(t.tfBody),C.showTabsParam(Y.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e};var le=Y=new te,re=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.rowSelect=null,this.aggregateSelect=null,this.tfBody="",this.typeParams=[],this.columnParams=[],this.rowParams=[],this.aggregateParams=[],this.sortColumns=[],this.gotBody=!1};function oe(e,t,a,l,r){e.hide();var o=[];a.forEach((function(e){o.push(e.replace("‌",""))}));var i=$("<select multiple/>");return $.each(o,(function(e,a){a=$.trim(a),-1==$.inArray(a,t)&&t.push(a)})),t.sort(((e,t)=>e.localeCompare(t))),$.each(t,(function(e,t){var a=-1==$.inArray(t,o)?"":'selected="selected" ';i.append($("<option "+a+"></option>").text(t))})),e.after(i),ie(i,e,a,l,r),i}function ie(e,t,a,l,r){e.chosenTF({no_results_text:l?"No matches found. Press \u0027Enter\u0027 to add":"No matches for",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:l}).change((function(l,o){if(null!=o.selected)e.find("option").filter((function(){return this.textContent==o.selected})).prop("selected",!0),""==(i=o.selected)&&(i="‌"),a.push(i);else if(null!=o.deselected){var i;e.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),""==(i=o.deselected)&&(i="‌"),a.splice($.inArray(i,a),1)}if("macro-param-column"==t.attr("id")){var n=r.sortSelect.parent();null!=e.val()&&e.val().length>1&&!n.hasClass("tf-always-hidden")?n.addClass("tf-always-hidden"):(null==e.val()||e.val().length<=1)&&n.removeClass("tf-always-hidden")}r.updateSortOptions(),t.val(a.join("‚"))}));var o=u.default.sortSelectedOptions(e,a);o.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){a.length=0,o.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e="‌"),a.push(e)})),t.val(a.join("‚"))}})}re.prototype.getMacroDetails=function(e){var t=this;t.gotBody=!0,t.tfBody=e;var a=$('<div class="original-table">'+e+"</div>");t.tables=u.default.getTables(a,u.default.textType,"tf-numbering"),t.tableColumns=u.default.getColumns(t.tables)},re.prototype.transformElements=function(e){var t=this,a={vvpattern:{v:{title:"Number"},p:{title:"Percentage"},vp:{title:"Number (Percentage)"},pv:{title:"Percentage (Number)"}},decimalseparator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},separator:{"":{title:""},"Space ( )":{title:"Space ( )"},"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},dateaccuracy:{Day:{title:"Day"},None:{title:"None"},Hour:{title:"Hour"},Week:{title:"Week"},Month:{title:"Month"},Quarter:{title:"Quarter"},Year:{title:"Year"}},type:{"":{title:""},Count:{title:"Count"},Sum:{title:"Sum"},Average:{title:"Average"},Multiplication:{title:"Multiplication"},Max:{title:"Max"},Min:{title:"Min"},Literal:{title:"Literal"},__multiSelect:!0},showrawdata:{false:{title:"Hide tables"},true:{title:"Show all content"},all:{title:"Hide all content"}}};if($("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split("‚"),$.each(t.columnParams,(function(e,a){t.columnParams[e]=$.trim(a)}))):t.columnParams=[],e.row?(t.rowParams=e.row.split("‚"),$.each(t.rowParams,(function(e,a){t.rowParams[e]=$.trim(a)}))):t.rowParams=[],e.aggregation?(t.aggregateParams=e.aggregation.split("‚"),$.each(t.aggregateParams,(function(e,a){t.aggregateParams[e]=$.trim(a)}))):t.aggregateParams=[],t.typeParams=["Count"],e.type&&(t.typeParams=e.type.split("‚")),e.version||2==t.columnParams.length&&(t.rowParams=[t.columnParams[1]],t.columnParams.length=1),e.sort&&(e.sort=e.sort.replace(" (‍Desc)"," ⇩").replace(" (‍Asc)"," ⇧").split(",")),!e.version||1==e.version){e.version=2;var r=t.typeParams[t.typeParams.length-1];"Count"==r||0==t.aggregateParams.length?e.sort=r+" ⇩":e.sort=r+" of "+t.aggregateParams[t.aggregateParams.length-1]+" ⇩"}Object.prototype.hasOwnProperty.call(e,"isNew")||(e.isNew=!e.datepattern),function(e){(e.decimalSeparator||e.decimalseparator)&&$("#macro-param-decimalseparator").val(e.decimalSeparator||e.decimalseparator);e.decimals&&$("#macro-param-decimals").val(e.decimals);e.separator&&$("#macro-param-separator").val(e.separator);$("#macro-param-showrawdata").val(e.showrawdata||"false"),"true"==e.hidePane&&$("#macro-param-hidePane").prop("checked",!0);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.dateaccuracy&&$("#macro-param-dateaccuracy").val(e.dateaccuracy);"true"==e.hideTotal&&$("#macro-param-hideTotal").prop("checked",!0);e.numberaccuracy&&$("#macro-param-numberaccuracy").val(e.numberaccuracy);"true"===e.cumulative&&$("#macro-param-cumulative").prop("checked",!0);e.literalseparator&&$("#macro-param-literalseparator").val(e.literalseparator);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.vvpattern&&$("#macro-param-vvpattern").val(e.vvpattern)}(e);var o=$.merge([],t.columnParams);$.merge(o,t.rowParams),$.merge(o,t.aggregateParams),$.each(o,(function(e,a){a=a.replace("‌",""),-1==$.inArray(a,t.tableColumns)&&t.tableColumns.push(a)})),t.columnSelect=oe($("#macro-param-column"),t.tableColumns,t.columnParams,!0,t),t.rowSelect=oe($("#macro-param-row"),t.tableColumns,t.rowParams,!0,t),t.aggregateSelect=oe($("#macro-param-aggregation"),t.tableColumns,t.aggregateParams,!0,t),t.sortSelect=$("#macro-param-sort"),t.sortSelect.chosenTF(),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),l.default.initDateFormatInput(e),l.default.initDecimalPlacesInput(e),d.default.initMacroBrowserWorklogDialog(e.worklog),u.default.inputAutocomplete($("#macro-param-literalseparator"),null,[{label:"None",value:"​"},{label:"Comma",value:", "},{label:"Semicolon",value:"; "},{label:"Space",value:"\\u0020"},{label:"Line break",value:"\\n"},{label:"Bulleted list",value:"<ul>"},{label:"Numbered list",value:"<ol>"}]);var i=$("#macro-param-type");i.attr("multiple","multiple"),i.find("option").each((function(){var e=$(this);-1==$.inArray(e.val(),t.typeParams)?e.prop("selected",!1):e.prop("selected",!0)})),s.initSelects(a,e,R.PIVOT),ie(i,$("<input>"),t.typeParams,!1,t),function(){$("#macro-param-div-column").before(F().pivotTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-row"),$("#macro-param-div-aggregation"),$("#macro-param-div-type")],t=[$("#macro-param-div-sort"),$("#macro-param-div-decimalseparator"),$("#macro-param-div-separator"),$("#macro-param-div-decimals"),$("#macro-param-div-showrawdata"),$("#macro-param-div-hidePane"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-vvpattern"),$("#macro-param-div-datepattern"),$("#macro-param-div-dateaccuracy"),$("#macro-param-div-numberaccuracy"),$("#macro-param-div-cumulative"),$("#macro-param-div-worklog"),$("#macro-param-div-hideTotal"),$("#macro-param-div-tabs"),$("#macro-param-div-literalseparator")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var a=$("#tab-columns"),l=$("#tab-options"),r=[a,l];function o(e){function t(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].show():e[a].hide()}t(e[0],"in"),t(e[1],"out")}function i(e){e.hasClass("active-tab")||(r.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}a.click((function(){i(a),o([e,t])})),l.click((function(){i(l),o([t,e])})),a.trigger("click")}(),t.updateSortOptions(e.sort);var n=$("#macro-param-div-literalseparator");-1===t.typeParams.indexOf("Literal")&&n.addClass("tf-always-hidden"),i.change((function(){-1===t.typeParams.indexOf("Literal")?n.addClass("tf-always-hidden"):n.removeClass("tf-always-hidden")})),i.on("chosen:showing_dropdown",(function(){$(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750)})),2==e.version&&($("#macro-param-literalseparator").val(", "),e.version=3)},re.prototype.updateSortOptions=function(e){var t=this,a=e||t.sortSelect.val();function l(e,a,i){var n=u.default.getCellPosition(i,t.rowParams[a]);null!=n?$.each(i,(function(s,c){0!=s&&(a+1<t.rowParams.length?(l(e+" "+c[n],a+1,r(i,n,c[n])),l(e,a+1,r(i,n,c[n]))):o(e+" "+c[n]))})):a+1<t.rowParams.length&&l(e,a+1,i),o(e)}function r(e,t,a){var l=[];return $.each(e,(function(e,r){0!=e&&r[t]!=a||l.push(r)})),l}function o(e){$.trim(e).length&&(-1==$.inArray(e+" ⇧",t.sortColumns)&&t.sortColumns.push(e+" ⇧"),-1==$.inArray(e+" ⇩",t.sortColumns)&&t.sortColumns.push(e+" ⇩"))}t.sortColumns=[],t.sortSelect.empty().append('<option selected="selected" value="false"></option>').append('<option value="-as_is-">'+"Preserve the original sorting order"+"</option>"),t.columnParams.length<=1&&(o(t.columnParams[0]),$.each(t.tables,(function(e,a){$.each(t.typeParams,(function(e,r){t.rowParams.length>0?"Count"==r?l(r,0,a):$.each(t.aggregateParams,(function(e,t){l(r+" of "+t,0,a)})):"Count"==r?o(r):$.each(t.aggregateParams,(function(e,t){o(r+" of "+t)}))}))}))),$.each(t.sortColumns.sort(((e,t)=>e.localeCompare(t))),(function(e,a){t.sortSelect.append($("<option></option>").val(a).text(a))})),t.sortSelect.val(a),t.sortSelect.trigger("chosen:updated")},re.prototype.updateColumns=function(e){var t=this;function a(e){var a=!1;u.default.normalizeTable(e,"data-tf-ready"),t.tables=u.default.getTables(e,u.default.textType,"tf-numbering"),$.each(u.default.getRawColumns(t.tables),(function(e,l){-1==$.inArray(l,t.tableColumns)&&(a=!0,t.tableColumns.push(l),t.columnSelect.append($("<option></option>").val(l).text(l)),t.rowSelect.append($("<option></option>").val(l).text(l)),t.aggregateSelect.append($("<option></option>").val(l).text(l)))})),a&&(u.default.sortSelectOptions(t.columnSelect),u.default.sortSelectOptions(t.rowSelect),u.default.sortSelectOptions(t.aggregateSelect),t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.columnSelect,t.columnParams),u.default.sortSelectedOptions(t.rowSelect,t.rowParams),u.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams))}t.body=e,l.default.bindPreview(e,a),u.default.addIframe(e,"original-table",(function(e){a(e.parent())})),a(e)};var ne,se=re,ce=!1,me=function(){this.pivotTableMacro=new se,this.pivotTableMacro.storedParams={},this.pivotTableMacro.isSaveClick=!1,this.pivotTableMacro.isSetParams=!1,this.pivotTableMacro.hasTable=!1};me.prototype.getMacroDetailsFromSelectedMacro=function(e,t){ce=!1,ne.bodyView=C.convertStorageToView({body:t.body}),ne.pivotTableMacro.getMacroDetails(ne.bodyView),C.showTabsParam(ne.bodyView),ne.pivotTableMacro.hasTable=ne.bodyView.indexOf("table")>0},me.prototype.postPreview=function(e){var t=ne.pivotTableMacro;t.updateColumns($(e).contents().find(".original-table")),t.isSaveClick=!1,t.isSetParams=!1},me.prototype.beforeParamsSet=function(e){var t=ne.pivotTableMacro;return t.gotBody||ne.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+(0,A.hashCode)(t.tfBody),C.showTabsParam(ne.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e},me.prototype.manipulateMarkup=function(e){return ne.pivotTableMacro.isSaveClick=!0,ne.pivotTableMacro.isSetParams=!1,e},me.prototype.beforeParamsRetrieved=function(e){var t=ne.pivotTableMacro;return ce||(t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),u.default.sortSelectedOptions(t.columnSelect,t.columnParams),u.default.sortSelectedOptions(t.rowSelect,t.rowParams),u.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),ce=!0),e.type=t.typeParams.join("‚"),t.isSaveClick&&(e.isFirstTimeEnter&&b.default.gaPivotInsert(t.tables.length),b.default.gaEditorPivot(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e};var pe=ne=new me,de=(a(48868),a(54861),a(28905)),ue=a(59476),fe=a.n(ue),ge=a(16790);class be extends de.default{constructor(e){var t;e.params=e.params||{};var{dialog:a,isInsert:l}=function(e){e.id=e.id||"spreadsheet"+(new Date).getTime();var t=!(e.attachment||e.data),a=$(fe().macroDialog({isInsert:t,id:e.id}));return AJS.dialog2(a).show(),{dialog:a,isInsert:t}}(e.params),r=u.default.getContentId(),o=AJS.params.spaceKey;super({...e.params,pageId:r,spaceKey:o,exit:()=>this.onCancel(),save:function(){return t.saveAttachment(...arguments)}},a.find("iframe")),t=this,this.isInsert=l,this.dialog=a,this.macro=e,this.title=e.params.attachment,this.saved=!1}init(){this.dialog.find("button.cancel").one("click",(()=>{var e=this.macro.params;this.title!==e.attachment||e.data?this.onSave():this.onCancel()})),super.init()}onReady(e){e.on("file:open",(()=>b.default.gaSpreadsheetOpenMacro())).on("file:export",(()=>b.default.gaSpreadsheetExportBrowser())).on("file:import",(()=>b.default.gaSpreadsheetImportBrowser()));var t=this.dialog.find("button.save");t.off("click.spe"),t.one("click.spe",(()=>{var e=this.spreadsheetModule;e&&e.getDataToPersists().then((e=>{this.saveAttachment(e,!0)}))})),t.removeAttr("disabled")}saveAttachment(e,t){var a,{spreadsheet:l,render:r}=e;if("template"===AJS.params.contentType)this.macro.params={data:l.data},a=Promise.resolve(l);else{var o=this.params;this.macro.params={attachment:l.name},a=(0,ge.storeAttachment)(o.pageId,o.spaceKey,l.data,l.name,AJS.params.newPage).then((()=>(0,ge.storeAttachment)(o.pageId,o.spaceKey,r.data,r.name,AJS.params.newPage))).then((()=>l))}a.then((e=>{super.updateData(JSON.parse(e.data)),this.saved=!0,t&&this.onSave()}))}onSave(){var e=this.spreadsheetModule;this.isInsert?b.default.gaSpreadsheetCreate(e.data.length):(b.default.gaSpreadsheetUpdateMacro(e.data.length),this.title!==this.macro.params.attachment&&b.default.gaSpreadsheetSaveAsMacro()),tinymce.confluence.macrobrowser.macroBrowserComplete(this.macro),AJS.dialog2(this.dialog).hide()}onCancel(){this.saved&&b.default.gaSpreadsheetUpdateMacro(this.spreadsheetModule.data.length),tinymce.confluence.macrobrowser.macroBrowserCancel(),AJS.dialog2(this.dialog).hide()}}var he=be,ve=function(e){new he(e).init()};AJS.toInit((function(){AJS.MacroBrowser.setMacroJsOverride("csv-table",new S),AJS.MacroBrowser.setMacroJsOverride("json-from-table",new S),AJS.MacroBrowser.setMacroJsOverride("table-excerpt-include",T),AJS.MacroBrowser.setMacroJsOverride("table-joiner",{opener:P}),AJS.MacroBrowser.setMacroJsOverride("table-filter",q),AJS.MacroBrowser.setMacroJsOverride("table-chart",le),AJS.MacroBrowser.setMacroJsOverride("pivot-table",pe),AJS.MacroBrowser.setMacroJsOverride("spreadsheet-table",{opener:ve})}))}},a={};function l(e){var r=a[e];if(void 0!==r)return r.exports;var o=a[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,l),o.loaded=!0,o.exports}l.m=t,l.amdD=function(){throw new Error("define cannot be used indirect")},l.amdO={},e=[],l.O=function(t,a,r,o){if(!a){var i=1/0;for(m=0;m<e.length;m++){a=e[m][0],r=e[m][1],o=e[m][2];for(var n=!0,s=0;s<a.length;s++)(!1&o||i>=o)&&Object.keys(l.O).every((function(e){return l.O[e](a[s])}))?a.splice(s--,1):(n=!1,o<i&&(i=o));if(n){e.splice(m--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var m=e.length;m>0&&e[m-1][2]>o;m--)e[m]=e[m-1];e[m]=[a,r,o]},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,{a:t}),t},l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={2560:0,177:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,o,i=a[0],n=a[1],s=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in n)l.o(n,r)&&(l.m[r]=n[r]);if(s)var m=s(l)}for(t&&t(a);c<i.length;c++)o=i[c],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return l.O(m)},a=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter=self.webpackChunkcom_stiltsoft_confluence_plugin_tablefilter||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var r=l.O(void 0,[8556,2295,3353,7874,6305,5546,9150,5654,8018,5260,5761,9352,2166,1729,3926,4818,3931,1706,8265,479,177,7669,4874,6470,8905],(function(){return l(37058)}));r=l.O(r)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.masterdetail:master-details-macro-browser', location = 'com/atlassian/confluence/extra/masterdetail/js/macro-browser-options.js' */
AJS.toInit(function(a){AJS.MacroBrowser.setMacroJsOverride("detailssummary",{fields:{cqlSelect2CustomOptions:{maximumSelectionSize:"60"}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.scandio.confluence.plugins.hideelements-macro:hideelements-resources-macrobrowser', location = '/hideelements/bundles/bundle-macrobrowser.js' */
(()=>{var e={362:(e,n,t)=>{"use strict";t.r(n);var a=t(222),o=t(34);o.registerHelper("eq",(function(e,n,t){return e===n?t.fn(this):t.inverse(this)})),o.registerHelper("noteq",(function(e,n,t){return e!==n?t.fn(this):t.inverse(this)})),o.registerHelper("hyphenate",(function(){var e=Array.prototype.slice.call(arguments);return e.pop(),e.join("-")})),o.registerHelper("getContextPath",(function(){return a.Hw()})),o.registerHelper("getElementText",(function(e){switch(e){case"confluencelogo":return"Confluence Logo";case"pagehistory":return"Page History";case"jiraissue":return"Jira Issue Link";case"inlinecomment":return"Inline Comment";default:return e[0].toUpperCase()+e.substring(1)}})),o.registerHelper("hasSpaceKey",(function(e){return a.fW()?e.fn(this):e.inverse(this)})),o.registerHelper("notEmpty",(function(e,n){return function(e){return!e||0===function(e){return e?$.isArray(e)?e.length:Object.keys(e).length:0}(e)}(e)?n.inverse(this):n.fn(this)}))},455:(e,n,t)=>{"use strict";t.d(n,{Jb:()=>o,NP:()=>l,Lw:()=>i,Dg:()=>a});var a={ULUL:"L1E1",ULUU:"L2E3",ULVL:"L1E1",ULVU:"L2E3",ULHL:"L1E6",ULHU:"L2E4",UUUL:"L1E1",UUUU:"L3E3",UUVL:"L1E1",UUVU:"L3E3",UUHL:"L1E6",UUHU:"L3E4",VLUL:"L1E1",VLUU:"L2E5",VLVL:"L1E1",VLVU:"L2E5",VLHL:"L1E6",VLHU:"L2E5",VUUL:"L1E1",VUUU:"L3E5",VUVL:"L1E1",VUVU:"L3E5",VUHL:"L1E6",VUHU:"L3E5",HLUL:"L1E1",HLUU:"L2E2",HLVL:"L1E1",HLVU:"L2E2",HLHL:"L1E6",HLHU:"L2E2",HUUL:"L1E1",HUUU:"L3E2",HUVL:"L1E1",HUVU:"L3E2",HUHL:"L1E6",HUHU:"L3E2"};function o(e){return a[e]}function i(e,n,t,a){return e[0].toUpperCase()+n[0].toUpperCase()+t[0].toUpperCase()+a[0].toUpperCase()}function l(e){return o(i(e.attr("data-visibility"),e.attr("data-locked"),e.attr("data-parent-visibility"),e.attr("data-locked-in-parent")))}},222:(e,n,t)=>{"use strict";t.d(n,{Hw:()=>f,OX:()=>k,ew:()=>g,LP:()=>h,fW:()=>y,Cd:()=>b,OH:()=>x,bh:()=>L,wI:()=>E,ZV:()=>v});var a={};t.r(a),t.d(a,{getHiddenElements:()=>r,getInheritedSettings:()=>l});var o=t(968);function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function l(e){var n,t=h(),a=g(),l=e.globalSettings,r=t?e.spaceSettings[t]:null,s={},c=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){s=!0,l=e},f:function(){try{r||null==t.return||t.return()}finally{if(s)throw l}}}}(e.allElementKeys);try{for(c.s();!(n=c.n()).done;){var u=n.value,d={},p=l.elements[u]||{},f=r&&r.elements[u]||{};a?(d.hidden=null,d.locked=null,d.parentHidden=o.Es(p.hidden),d.lockedInParent=o.jk(p.locked),d.lockedInParent||(o.le(f.hidden)&&(d.parentHidden=o.Es(f.hidden)),d.lockedInParent=o.jk(f.locked))):t?(d.hidden=o.Es(f.hidden),d.locked=o.jk(f.locked),d.parentHidden=o.Es(p.hidden),d.lockedInParent=o.jk(p.locked)):(d.hidden=o.Es(p.hidden),d.locked=o.jk(p.locked),d.parentHidden=null,d.lockedInParent=!1),s[u]=d}}catch(e){c.e(e)}finally{c.f()}var m={value:l.cssSelector,locked:o.jk(l.cssSelectorLocked),lockedInParent:o.jk(null)};return t&&(m.lockedInParent=m.locked,m.locked=o.jk(r&&r.cssSelectorLocked),r&&r.cssSelector&&!m.lockedInParent&&(m.value=r.cssSelector)),a&&(m.lockedInParent=m.locked,m.locked=null),{elements:s,cssSelector:m}}function r(e,n){var t=[];for(var a in e.elements){var o=e.elements[a];if(o.lockedInParent&&o.parentHidden)t.push(a);else if(o.lockedInParent&&!o.parentHidden);else{var i=n.elements[a];void 0!==i?(!0===i.hidden||!1!==i.hidden&&o.hidden)&&t.push(a):(o.hidden||!1!==o.hidden&&o.parentHidden)&&t.push(a)}}return t}function s(e,n,t,a,o,i,l){try{var r=e[i](l),s=r.value}catch(e){return void t(e)}r.done?n(s):Promise.resolve(s).then(a,o)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(a,o){var i=e.apply(n,t);function l(e){s(i,a,o,l,r,"next",e)}function r(e){s(i,a,o,l,r,"throw",e)}l(void 0)}))}}var u={warn:p()?AJS.warn:function(){},log:p()?AJS.log:function(){}},d={};function p(){return"undefined"!=typeof AJS}function f(){return m("context-path")}function h(){return m("space-key")}function m(e){return p()&&void 0!==AJS.Meta?AJS.Meta.get(e):""}function v(e){var n="hideelements-resources-".concat(e),t="".concat("de.scandio.confluence.plugins",".").concat("hideelements-macro",":").concat(n,".").concat(n,"-data"),a=null;return d[e]&&(a=d[e]),"WRM"in window&&WRM.data&&WRM.data.claim&&(a=WRM.data.claim(t)),a}function g(){return m("page-id")}function y(){return!!h()}function b(e){p()&&AJS.toInit?AJS.toInit(e):$(document).ready(e)}function k(){return a}function w(e){p()?AJS.flag(e):u.error("Missing AJS for `AJS.flag()`")}function P(e,n){return"<div><strong>".concat(e,"</strong><br/>").concat(n,"</div>")}function L(e){w({body:P(e.title,e.body),type:"error",close:"manual"})}function E(e){w({body:P(e.title,e.body),type:"success",close:"auto"})}function x(e,n,t){return _.apply(this,arguments)}function _(){return(_=c(regeneratorRuntime.mark((function e(n,t,a){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=$(n.target),i=o.closest("form"),o.attr("disabled","disabled"),i.attr("data-status","loading"),e.abrupt("return",$.ajax({type:"POST",url:a,data:JSON.stringify(t),dataType:"json",contentType:"application/json"}).done((function(e){return i.removeAttr("data-status"),o.removeAttr("disabled"),Promise.resolve(e)})).fail((function(e){return i.removeAttr("data-status"),o.removeAttr("disabled"),Promise.reject(e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},898:(e,n,t)=>{"use strict";t.d(n,{m:()=>m,i:()=>v});var a=t(968),o=t(455),i=t(222),l=t(605),r=t.n(l),s=t(966),c=t.n(s),u=t(398),d=t.n(u),p=t(633),f=t.n(p),h=i.OX(),m={config:r(),settings:c(),error:d(),preview:f()};function v(e,n,t){var i=h.getInheritedSettings(e),l={};$.each(i.elements,(function(e,n){var t=a.oI(n.hidden),i=a.oI(n.parentHidden),r=a.CA(n.locked),s=a.CA(n.lockedInParent),c=o.Lw(t,r,i,s);l[e]={visibility:t,parentVisibility:i,locked:r,lockedInParent:s,key:e,iconComboKey:o.Jb(c)}}));var r={value:i.cssSelector.value,locked:a.CA(i.cssSelector.locked),lockedInParent:a.CA(i.cssSelector.lockedInParent)};return r.iconComboKey=o.Jb(o.Lw("visible",r.locked,"visible",r.lockedInParent)),{lockingEnabled:n,scope:t,cssSelector:r,elements:l,warnings:e.warnings}}},968:(e,n,t)=>{"use strict";function a(e){switch(e){case!0:return"hidden";case!1:return"visible";default:return"unset"}}function o(e){return e?"locked":"unlocked"}function i(e){return"locked"===e.attr("data-locked")}function l(e){switch(e.attr("data-visibility")){case"visible":return!1;case"hidden":return!0;default:return null}}function r(e){return"true"===e||"false"!==e&&null}function s(e){return!1===e||!0===e?e:null}function c(e){return e||!1}function u(e){return null!=e}t.d(n,{oI:()=>a,CA:()=>o,p1:()=>i,xj:()=>l,eU:()=>r,Es:()=>s,jk:()=>c,le:()=>u}),t(222)},978:(e,n,t)=>{"use strict";t.d(n,{S:()=>Y});var a,o,i,l,r,s,c=t(968),u=t(222),d=t(455),p=t(898),f={title:".title-text, h1.content-title, h1.with-breadcrumbs",breadcrumb:".breadcrumb-section, .page-metadata-banner",comments:".comments-section, .container > div > .comments",likes:".likes-section, .container > div > .likes",labels:".labels-section",metas:"div.page-metadata > ul, .page-metadata-banner, .content-meta-outer > .content-meta",share:".shareContentLink",sidebar:"div.vsplitbar, .splitter-sidebar, .ia-splitter-left, .ia-splitter-left",watch:".watch-content-button, .content-meta-outer > .content-watch",tools:".action-menu-link, .add-menu-link",favorite:".page-favourite",edit:".editPageLink",create:".create-page-button-preview, .quick-create-page-button-preview",confluencelogo:"div.left.confluence-logo",spaces:"div.left.confluence-spaces-menu",people:"div.left.confluence-people-menu",search:"div.confluence-header-right .confluence-search-bar",help:"div.confluence-header-right .confluence-help-button",admin:"div.confluence-header-right .confluence-admin-button",notifications:"div.confluence-header-right .confluence-notifications-button",profile:"div.confluence-header-right .confluence-profile-button",header:"div.confluence-header",jiraissue:'.inline-dialog-selection-action-panel button[data-key="com.atlassian.confluence.plugins.confluence-jira-content:create-Jira-issue-summary"]',inlinecomment:'.inline-dialog-selection-action-panel button[data-key="com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment"]'};function h(){var e=r.position();s.css({top:e.top-38,left:e.left+5})}function m(e,n,t){a&&n&&a(e);var o,i,l,r=$('.he-item-div[data-he-key="'.concat(e,'"]')),s=$('[data-he-key-for="'.concat(e,'"]'));i=(o=r).attr("data-visibility"),l=o.attr("data-parent-visibility"),"hidden"===i||"unset"===i&&"hidden"===l?s.addClass("he-hidden"):s.removeClass("he-hidden"),t&&h()}function v(){for(var e in f)m(e,!1,!1);h()}function g(){i.removeClass("active")}function y(e){i.filter('[data-he-key-for="'.concat(e,'"][data-locked-in-parent="unlocked"]')).addClass("active")}var b,k,w,P,L={E1:{name:"Eye Grey",desc:"Element was made visible by an admin (can NOT be changed)",type:"visibility"},E2:{name:"Eye Red Strikethrough",desc:"Element was explicitly hidden here (can be changed)",type:"visibility"},E3:{name:"Eye Blue",desc:"Element has NOT been set by an admin (can be changed)",type:"visibility"},E4:{name:"Eye Blue Strikethrough",desc:"Element was hidden by an admin (can be changed)",type:"visibility"},E5:{name:"Eye Green",desc:"Element was explicitly made visible here (can be changed)",type:"visibility"},E6:{name:"Eye Grey Strikethrough",desc:"Element was hidden by an admin (can NOT be changed)",type:"visibility"},L1:{name:"Locked Grey",desc:"Visibility was locked by an admin (visibility can NOT be changed)",type:"locking"},L2:{name:"Locked Red",desc:"Visibility was locked here (visibility can be changed here but NOT on levels below)",type:"locking"},L3:{name:"Unlocked Blue",desc:"Visibility has NOT been locked (can be locked here and levels below will NOT be able to change visibility)",type:"locking"},L4:{name:"Unlocked Grey",desc:"Visibility has NOT been locked (and can NOT be locked here)",type:"locking"}};function E(e,n,t,a,o,i,l){try{var r=e[i](l),s=r.value}catch(e){return void t(e)}r.done?n(s):Promise.resolve(s).then(a,o)}function x(e){return function(){var n=this,t=arguments;return new Promise((function(a,o){var i=e.apply(n,t);function l(e){E(i,a,o,l,r,"next",e)}function r(e){E(i,a,o,l,r,"throw",e)}l(void 0)}))}}t(362);var _={title:function(){var e,n=$(this),t=n.closest(".he-icon-container").attr("data-icon-key");return e=n.hasClass("icon-locking")?t.substring(0,2):t.substring(2,4),L[e].desc},delayIn:1e3,gravity:"e"},S={delayIn:500,gravity:$(void 0).attr("data-tooltip-gravity")||"e"};function C(e,n){e.find(".he-icon-container").attr("data-icon-key",d.NP(e)),n||P.removeAttr("disabled")}function O(e){$('.he-item-div:not([data-he-key="cssselector"])').each((function(){e($(this))}))}function I(){var e={};return O((function(n){var t=n.attr("data-he-key");e[t]={hidden:c.xj(n),locked:c.p1(n)}})),{elements:e,cssSelector:w.find("input").val(),cssSelectorLocked:c.p1(w)}}function H(){var e=u.LP();return e?"".concat(u.Hw(),"/rest/hideelements/1.0/spacesettings?spaceKey=").concat(e):"".concat(u.Hw(),"/rest/hideelements/1.0/globalsettings")}function M(e,n){if("locked"!==e.attr("data-locked-in-parent")){var t=e.closest(".he-form"),a=["unset","hidden","visible"],o=e.attr("data-visibility");if(!n){var i=(a.indexOf(o)+1)%a.length;n=a[i]}e.attr("data-visibility",n),t.hasClass("locking-disabled")||e.attr("data-locked","unset"===n?"unlocked":"locked"),C(e)}}function j(){k.removeClass("active")}function U(e){k.filter('[data-he-key="'.concat(e,'"][data-locked-in-parent="unlocked"]')).addClass("active")}function A(e){var n=$(e.target).closest("[data-he-key]");if(e.preventDefault(),"locked"!==n.attr("data-locked-in-parent")&&!$(".he-form").hasClass("locking-disabled")){var t="locked"===n.attr("data-locked")?"unlocked":"locked";n.attr("data-locked",t),C(n)}}function V(e){var n=$(e.target).closest("div[data-he-key]"),t=n.attr("data-he-key");e.preventDefault(),M(n),m(t,!1,!0)}function T(e){e.preventDefault(),O((function(e){$.each(["visibility","parent-visibility","locked","locked-in-parent"],(function(n,t){e.attr("data-"+t,e.attr("data-original-"+t)),C(e,!0)}))})),w.attr("data-locked",w.attr("data-original-locked")).find("input").val(w.attr("data-original-value")),C(w),v()}function D(e){e.preventDefault(),O((function(e){e.attr({"data-visibility":"unset","data-locked":"unlocked"}),C(e,!0)})),w.attr("data-locked","unlocked").find("input").val(""),C(w),v()}function q(e){M($('.he-item-div[data-he-key="'.concat(e,'"]')),"hidden")}function N(e,n){var t=$(this).attr("data-he-key");j(),g(),"mouseenter"!==e.type&&"mouseover"!==e.type||(U(t),y(t))}function R(e,n){j(),"mouseenter"!==e.type&&"mouseover"!==e.type||U(n)}function J(e){var n=$(".he-form");e.preventDefault(),n.hasClass("legend-active")?n.removeClass("legend-active"):n.addClass("legend-active")}function F(e){e.preventDefault(),$(".he-form").removeClass("legend-active")}function B(e){e.preventDefault(),$(e.target).closest(".aui-message").remove()}function W(e){C($(e.target).closest(".he-item-div"))}function G(e){return K.apply(this,arguments)}function K(){return(K=x(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,u.OH(n,I(),H());case 4:(t=e.sent).error?u.bh({title:"Error Occurred",body:"".concat(t.error)}):u.wI({title:"Success!",body:"Your settings were saved successfully."}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),u.bh({title:"Error Occurred",body:"Are you connected and logged in?"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function Y(e,n){var t;e.append(p.m.settings(n)),k=$("[data-he-key]"),P=$(".aui-button-primary"),function(e,n,t){for(var c in l=$(".hideelements-preview"),r=$(".preview-jiraissue-highlight-text"),s=$(".inline-dialog-selection-action-panel"),a=e,o=n,f)l.find(f[c]).attr({"data-he-key-for":c,"data-locked-in-parent":t.filter('[data-he-key="'.concat(c,'"]')).attr("data-locked-in-parent")});var u,d;i=$("[data-he-key-for]"),v(),u=$(".confluence-header"),d=function(e,n){o&&o(e,n),g(),"mouseenter"!==e.type&&"mouseover"!==e.type||y(n)},$("[data-he-key-for]").on("mouseenter mouseleave",(function(e){d(e,$(this).attr("data-he-key-for"))})),$('[data-he-key-for="header"]').on("mouseover",(function(e){$(e.target).closest(".header-part",u).length||d(e,"header")})),$("[data-he-key-for]").click((function(e){e.preventDefault(),e.stopPropagation(),m($(this).attr("data-he-key-for"),!0,!0)})),$(".hideelements-preview button").click((function(e){e.preventDefault()}))}(q,R,k),t=$(".legend-table-icons tbody"),$.each(L,(function(e,n){t.append('<tr data-name="'.concat(n.name,'" data-key="').concat(e,'">\n\t\t\t\t<td class="he-icon-container" data-icon-key="').concat(e,'">\n\t\t\t\t\t<span class="aui-icon icon-locking icon-locked aui-icon-small aui-iconfont-lock"></span>\n\t\t\t\t\t<span class="aui-icon icon-locking icon-unlocked aui-icon-small aui-iconfont-unlock"></span>\n\t\t\t\t\t<span class="aui-icon icon-eye aui-icon-small aui-iconfont-watch-filled"></span>\n\t\t\t\t</td>\n            \t<td>').concat(n.desc,"</td>\n            </tr>"))})),$.each(d.Dg,(function(e,n){$(".legend-table-states tbody").append("<tr>\n\t\t\t\t<td>".concat(e,'</td>\n\t\t\t\t<td class="he-icon-container" \n\t\t\t\t\tdata-icon-key="').concat(d.Jb(e),'">\n\t\t\t\t\t<span class="aui-icon icon-locking icon-locked aui-icon-small aui-iconfont-lock"></span>\n\t\t\t\t\t<span class="aui-icon icon-locking icon-unlocked aui-icon-small aui-iconfont-unlock"></span>\n\t\t\t\t\t<span class="aui-icon icon-eye aui-icon-small aui-iconfont-watch-filled"></span>\n\t\t\t\t</td>\n\t\t\t</tr>'))})),w=$(".he-item-div-cssselector"),$(".settings-save-button").on("click",G),$("div[data-he-key] .icon-locking").click(A),$("div[data-he-key]").find(".icon-eye, .element-text").click(V),$(".reset-menu .reset-link").click(T),$(".reset-menu .clear-link").click(D),$(".he-legend-button").click(J),$(".hide-legend-button").click(F),$(".he-item-div-cssselector input").on("keyup",W),$(".he-form:not(.locking-disabled) .icon-locking, .icon-eye").tooltip(_),$(".he-markup-based-tooltip").tooltip(S),$(".aui-message .icon-close").click(B),k.on("mouseenter mouseleave",N)}u.Cd((function(){b=u.ZV("settings");var e=$(".hideelements-container");if("settings"===e.attr("data-view")){var n=u.fW()?"space":"global";Y(e,p.i(b,!0,n))}}))},181:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-info aui-message aui-message-info closeable">\n    <p class="title">\n        <strong>Welcome to the HideElements configuration!</strong>\n    </p>\n    <p> This is the global HideElements Configuration that contains options for how HideElements\n        can be used with your Confluence instance. If you want to specify the elements to hide, please go to the\n        global <a href="'+e.escapeExpression(i(t,"getContextPath").call(null!=n?n:e.nullContext||{},{name:"getContextPath",hash:{},data:o,loc:{start:{line:7,column:24},end:{line:7,column:42}}}))+'/plugins/servlet/hideelements/settings">HideElements Settings</a>. Please visit our\n        <a href="https://help.livelyapps.com/hideelements-for-confluence-server/" target="_blank">documentation</a> for more information.\n        Don\'t hesitate to <a href="https://go.livelyapps.com/support" target="_blank">raise a ticket</a>\n        if you need additional assistance (or just want to say hello to the <strong>Lively Apps</strong> team)!\n    </p>\n    <span class="aui-icon icon-close" role="button"></span>\n</div>\n'},useData:!0})},605:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){return"checked"},3:function(e,n,t,a,o){return"error"},compiler:[8,">= 4.3.0"],main:function(e,n,a,o,i){var l,r=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<form class="aui he-form">\n    <div class="he-content">\n'+(null!=(l=e.invokePartial(t(181),n,{name:"config-info",data:i,indent:"        ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'        <div class="he-config">\n            <aui-toggle id="space-tools-config-toggle" label="Show Space Tools Menu in Cog Wheel Menu"\n            '+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"spaceToolsItemEnabled"):n,!0,{name:"eq",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:6,column:12},end:{line:6,column:60}}}))?l:"")+'></aui-toggle>\n            <aui-label for="space-tools-config-toggle">Add space tools link in administration menu for space administrators\n            </aui-label>\n            <div class="description">When the sidebar is hidden using HideElements, space administrators will lose the\n                Space Tools link at the bottom of the sidebar. If you enable this setting, space administrators will be\n                provided an additional Space Tools link in the global administration menu in the Confluence header.\n                Note that this menu will appear with a single link item ‘Space Tools’ to space administrators\n                that are not Confluence administrators.</div>\n        </div>\n        <div class="he-config">\n            <aui-toggle id="allow-query-params-settings-config-toggle" label="Allow Hiding Elements Using Query Parameters"\n                        '+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"allowUrlOverrides"):n,!0,{name:"eq",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:17,column:24},end:{line:17,column:68}}}))?l:"")+'></aui-toggle>\n            <aui-label for="allow-query-params-settings-config-toggle">Allow passing settings using query parameters\n            </aui-label>\n            <div class="description">When this option is enabled, you can hide additional elements using the \'he_elements\'\n                query parameter and additional selectors using the \'he_selector\' query parameter. These settings are applied\n                only when these parameters are present in your URL. Please, note that you can hide elements that are\n                set to \'always visible\' in the space/global administration.</div>\n        </div>\n        <div class="buttons-container">\n            <div class="buttons">\n                <span class="aui-icon aui-icon-success aui-icon-small aui-iconfont-approve"></span>\n                <span class="aui-icon aui-icon-wait"></span>\n                <span class="aui-icon aui-icon-error"></span>\n                <button class="config-save-button aui-button aui-button-primary" disabled>Save</button>\n            </div>\n            <span class="status '+(null!=(l=s(a,"if").call(r,null!=n?s(n,"error"):n,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i,loc:{start:{line:32,column:32},end:{line:32,column:57}}}))?l:"")+'"></span>\n        </div>\n    </div>\n</form>\n'},usePartial:!0,useData:!0})},567:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){return"disabled"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l,r=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,d=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-item-div he-item-div-cssselector"\n     data-visibility="visible"\n     data-parent-visibility="visible"\n     data-locked="'+u(typeof(l=null!=(l=d(t,"locked")||(null!=n?d(n,"locked"):n))?l:s)===c?l.call(r,{name:"locked",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:28}}}):l)+'"\n     data-locked-in-parent="'+u(typeof(l=null!=(l=d(t,"lockedInParent")||(null!=n?d(n,"lockedInParent"):n))?l:s)===c?l.call(r,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:5,column:28},end:{line:5,column:46}}}):l)+'"\n     data-original-locked="'+u(typeof(l=null!=(l=d(t,"locked")||(null!=n?d(n,"locked"):n))?l:s)===c?l.call(r,{name:"locked",hash:{},data:o,loc:{start:{line:6,column:27},end:{line:6,column:37}}}):l)+'"\n     data-original-locked-in-parent="'+u(typeof(l=null!=(l=d(t,"lockedInParent")||(null!=n?d(n,"lockedInParent"):n))?l:s)===c?l.call(r,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:7,column:37},end:{line:7,column:55}}}):l)+'"\n     data-original-value="'+u(typeof(l=null!=(l=d(t,"value")||(null!=n?d(n,"value"):n))?l:s)===c?l.call(r,{name:"value",hash:{},data:o,loc:{start:{line:8,column:26},end:{line:8,column:35}}}):l)+'"\n     data-he-key="cssselector"\n     data-from-macro="'+u(typeof(l=null!=(l=d(t,"fromMacro")||(null!=n?d(n,"fromMacro"):n))?l:s)===c?l.call(r,{name:"fromMacro",hash:{},data:o,loc:{start:{line:10,column:22},end:{line:10,column:35}}}):l)+'"\n>\n    <div class="he-icon-container" data-icon-key="'+u(typeof(l=null!=(l=d(t,"iconComboKey")||(null!=n?d(n,"iconComboKey"):n))?l:s)===c?l.call(r,{name:"iconComboKey",hash:{},data:o,loc:{start:{line:12,column:50},end:{line:12,column:66}}}):l)+'">\n        <a href="#" class="aui-icon icon-locking icon-this icon-locked aui-icon-small aui-iconfont-lock"></a>\n        <a href="#" class="aui-icon icon-locking icon-this icon-unlocked aui-icon-small aui-iconfont-unlock"></a>\n    </div>\n    <input type="text" class="text he-item-input he-item-cssselector"\n           autocomplete="off" value="'+u(typeof(l=null!=(l=d(t,"value")||(null!=n?d(n,"value"):n))?l:s)===c?l.call(r,{name:"value",hash:{},data:o,loc:{start:{line:17,column:37},end:{line:17,column:46}}}):l)+'" '+(null!=(i=d(t,"eq").call(r,null!=n?d(n,"lockedInParent"):n,"locked",{name:"eq",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:17,column:48},end:{line:17,column:94}}}))?i:"")+'>\n    <span class="aui-icon icon-question aui-icon-small aui-iconfont-question-filled he-markup-based-tooltip"\n          title="A CSS selector for hidden elements that will be applied in addition to the elements above. Note that this will not apply to administration screens"></span>\n</div>'},useData:!0})},881:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l=null!=n?n:e.nullContext||{},r=e.hooks.helperMissing,s="function",c=e.escapeExpression,u=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-item-div he-item-div-'+c(typeof(i=null!=(i=u(t,"key")||(null!=n?u(n,"key"):n))?i:r)===s?i.call(l,{name:"key",hash:{},data:o,loc:{start:{line:1,column:36},end:{line:1,column:43}}}):i)+'"\n     data-visibility="'+c(typeof(i=null!=(i=u(t,"visibility")||(null!=n?u(n,"visibility"):n))?i:r)===s?i.call(l,{name:"visibility",hash:{},data:o,loc:{start:{line:2,column:22},end:{line:2,column:36}}}):i)+'"\n     data-parent-visibility="'+c(typeof(i=null!=(i=u(t,"parentVisibility")||(null!=n?u(n,"parentVisibility"):n))?i:r)===s?i.call(l,{name:"parentVisibility",hash:{},data:o,loc:{start:{line:3,column:29},end:{line:3,column:49}}}):i)+'"\n     data-locked="'+c(typeof(i=null!=(i=u(t,"locked")||(null!=n?u(n,"locked"):n))?i:r)===s?i.call(l,{name:"locked",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:28}}}):i)+'"\n     data-locked-in-parent="'+c(typeof(i=null!=(i=u(t,"lockedInParent")||(null!=n?u(n,"lockedInParent"):n))?i:r)===s?i.call(l,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:5,column:28},end:{line:5,column:46}}}):i)+'"\n     data-original-visibility="'+c(typeof(i=null!=(i=u(t,"visibility")||(null!=n?u(n,"visibility"):n))?i:r)===s?i.call(l,{name:"visibility",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:45}}}):i)+'"\n     data-original-parent-visibility="'+c(typeof(i=null!=(i=u(t,"parentVisibility")||(null!=n?u(n,"parentVisibility"):n))?i:r)===s?i.call(l,{name:"parentVisibility",hash:{},data:o,loc:{start:{line:7,column:38},end:{line:7,column:58}}}):i)+'"\n     data-original-locked-in-parent="'+c(typeof(i=null!=(i=u(t,"lockedInParent")||(null!=n?u(n,"lockedInParent"):n))?i:r)===s?i.call(l,{name:"lockedInParent",hash:{},data:o,loc:{start:{line:8,column:37},end:{line:8,column:55}}}):i)+'"\n     data-original-locked="'+c(typeof(i=null!=(i=u(t,"locked")||(null!=n?u(n,"locked"):n))?i:r)===s?i.call(l,{name:"locked",hash:{},data:o,loc:{start:{line:9,column:27},end:{line:9,column:37}}}):i)+'"\n     data-he-key="'+c(typeof(i=null!=(i=u(t,"key")||(null!=n?u(n,"key"):n))?i:r)===s?i.call(l,{name:"key",hash:{},data:o,loc:{start:{line:10,column:18},end:{line:10,column:25}}}):i)+'"\n>\n\n    <div class="he-icon-container" data-icon-key="'+c(typeof(i=null!=(i=u(t,"iconComboKey")||(null!=n?u(n,"iconComboKey"):n))?i:r)===s?i.call(l,{name:"iconComboKey",hash:{},data:o,loc:{start:{line:13,column:50},end:{line:13,column:66}}}):i)+'">\n        <a href="#" class="aui-icon icon-locking icon-this icon-locked aui-icon-small aui-iconfont-lock"></a>\n        <a href="#" class="aui-icon icon-locking icon-this icon-unlocked aui-icon-small aui-iconfont-unlock"></a>\n        <a href="#" class="aui-icon icon-this icon-eye aui-icon-small aui-iconfont-watch-filled"></a>\n    </div>\n    <span class="element-text">'+c((u(t,"getElementText")||n&&u(n,"getElementText")||r).call(l,null!=n?u(n,"key"):n,{name:"getElementText",hash:{},data:o,loc:{start:{line:18,column:31},end:{line:18,column:53}}}))+"</span>\n</div>"},useData:!0})},398:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"        <p>"+e.escapeExpression("function"==typeof(i=null!=(i=l(t,"error")||(null!=n?l(n,"error"):n))?i:e.hooks.helperMissing)?i.call(null!=n?n:e.nullContext||{},{name:"error",hash:{},data:o,loc:{start:{line:6,column:11},end:{line:6,column:20}}}):i)+"</p>\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="aui-message aui-message-error">\n    <p class="title">\n        <strong>Something strange happened.</strong>\n    </p>\n'+(null!=(i=l(t,"if").call(null!=n?n:e.nullContext||{},null!=n?l(n,"error"):n,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:4},end:{line:7,column:11}}}))?i:"")+'    <p>\n        Since this is something unexpected, it might be best to contact your Confluence administrator. Or feel free to\n        create a <a href="https://help.scandio.de/servicedesk/customer/portal/9">support ticket</a>.\n    </p>\n    <p>\n        <a class="browser-back-link" href="#">&lt;&lt; back</a>\n    </p>\n</div>'},useData:!0})},681:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){return'<table class="aui legend-table-icons">\n    <thead>\n        <tr>\n            <th>Icon</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        \x3c!-- FILLED BY JS --\x3e\n    </tbody>\n</table>\n<table class="aui legend-table-states">\n    <thead>\n        <tr>\n            <th>State Key</th>\n            <th>Icon Combo</th>\n        </tr>\n    </thead>\n    <tbody>\n        \x3c!-- FILLED BY JS --\x3e\n    </tbody>\n</table>'},useData:!0})},633:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){return'<div class="hideelements-preview">\n    <div class="confluence-header" data-id="confluence-header">\n        <div data-id="confluence-header-left" class="confluence-header-left left header-part">\n            <div data-id="logo" class="left confluence-logo">Confluence</div>\n            <div data-id="space-menu-link" class="header-menu left confluence-spaces-menu">Spaces</div>\n            <div data-id="people-directory-link" class="header-menu left confluence-people-menu">People</div>\n            <div data-id="quick-create-page-button" class="header-menu create-button left create-page-button-preview">Create</div>\n            <div data-id="create-page-button" class="header-menu create-button left quick-create-page-button-preview">\n                <span class="overflow-icon">...</span>\n            </div>\n        </div>\n        <div class="confluence-header-right right header-part">\n            <div data-id="confluence-profile-button" class="header-menu right confluence-profile-button">\n                <span class="aui-icon aui-icon-small aui-iconfont-person-circle"></span>\n            </div>\n            <div data-id="confluence-notifications-button" class="header-menu right confluence-notifications-button">\n                <span class="aui-icon aui-icon-small aui-iconfont-notification"></span>\n            </div>\n            <div data-id="confluence-admin-button" class="header-menu right confluence-admin-button">\n                <span class="aui-icon aui-icon-small aui-iconfont-settings"></span>\n            </div>\n            <div data-id="confluence-help-button" class="header-menu right confluence-help-button">\n                <span class="right aui-icon aui-icon-small aui-iconfont-question-filled"></span>\n            </div>\n            <div data-id="confluence-search-bar" class="header-menu right confluence-search-bar">\n                Search\n                <span class="right aui-icon aui-icon-small aui-iconfont-search"></span>\n            </div>\n        </div>\n    </div>\n\n    <div data-id="splitter-sidebar" class="splitter-sidebar left"></div>\n\n    <div class="hideelements-main">\n        <div class="right">\n            <div data-id="action-menu-link" class="action-menu-link rounded right button">\n                <span class="overflow-icon">...</span>\n            </div>\n            <div data-id="shareContentLink" class="shareContentLink rounded right button">Share</div>\n            <div data-id="watch-content-button" class="watch-content-button rounded right button">Watch</div>\n            <div data-id="page-favourite" class="page-favourite rounded right button">Save for later</div>\n            <div data-id="editPageLink" class="editPageLink rounded right button">Edit</div>\n        </div>\n\n        <div data-id="title-heading" class="title-heading content-meta-outer">\n            <div data-id="breadcrumb-section" class="breadcrumb-section link breadcrumb">\n                Lorem / ipsum / dolor / sit <div class="meta icon rounded"></div>\n            </div>\n            <div data-id="title-text" class="title-text title">Lorem ipsum dolor</div>\n            <div class="metas content-meta">Lorem ipsum dolor, sit amet consetetur sadipscing elitr</div>\n        </div>\n\n        <div class="content">\n            <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr\n                , sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua\n                . At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren\n                , no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet\n                , consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat\n                , sed diam voluptua\n                . At vero eos et accusam et justo duo <span class="preview-jiraissue-highlight-text">dolores</span> et ea rebum.</p>\n            <div data-id="inline-dialog-selection-action-panel" class="inline-dialog-selection-action-panel aui-inline-dialog">\n                <div class="aui-inline-dialog-contents contents">\n                    <button class="preview-inline-block"\n                            data-key="com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment">\n                        <span class="aui-icon aui-icon-small aui-iconfont-comment"></span>\n                    </button>\n                    <button class="preview-inline-block"\n                            data-key="com.atlassian.confluence.plugins.confluence-jira-content:create-Jira-issue-summary">\n                        <span class="aui-icon aui-icon-small aui-iconfont-jira"></span>\n                    </button>\n                    <div data-id="arrow-selection-action-panel" class="arrow-selection-action-panel aui-inline-dialog-arrow arrow aui-css-arrow aui-bottom-arrow"></div>\n                </div>\n            </div>\n        </div>\n\n        <div data-id="likes-section" class="likes-section likes left">\n            <div class="icon rounded left"></div>\n            <div class="link left">Unlike</div>\n            You like this\n        </div>\n\n        <div data-id="labels-section" class="labels-section right labels">\n            <div class="aui-label">Lorem</div>\n            <div class="aui-label">Ipsum</div>\n            <div class="icon rounded"></div>\n        </div>\n\n        <div data-id="comments-section" class="comments-section comments clear">\n            <div class="comment-title">2 comments</div>\n            <div class="comment">\n                <div class="userimg left"></div>\n                <div class="comment-content">\n                    <div class="link">John Doe</div>\n                    <div>Lorem ipsum dolor sit amet?</div>\n                    <div class="metas">Lorem ipsum dolor, sit amet consetetur sadipscing elitr</div>\n                </div>\n            </div>\n            <div class="comment">\n                <div class="userimg left"></div>\n                <div class="comment-content">\n                    <div class="link">Jane Doe</div>\n                    <div>Lorem Ipsum!</div>\n                    <div class="metas">Lorem ipsum dolor, sit amet consetetur sadipscing elitr</div>\n                </div>\n            </div>\n            <div class="comment no-border">\n                <div class="userimg left"></div>\n                <div class="comment-content">\n                    <div class="add-comment">Write a comment...</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'},useData:!0})},275:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){return"            You are on the <strong>SPACE</strong> level, which means these settings will be applied\n            everywhere in this space.\n"},3:function(e,n,t,a,o){return"            You are on the <strong>GLOBAL</strong> level, which means these settings will be applied\n            <i>Confluence-wide</i>.\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,o){var i,l=null!=n?n:e.nullContext||{},r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="he-info aui-message aui-message-info closeable">\n    <p class="title">\n        <strong>Welcome to the HideElements settings!</strong>\n    </p>\n    <p>\n        Below is a preview of your settings.\n'+(null!=(i=r(t,"eq").call(l,null!=n?r(n,"scope"):n,"space",{name:"eq",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:7,column:8},end:{line:10,column:15}}}))?i:"")+(null!=(i=r(t,"eq").call(l,null!=n?r(n,"scope"):n,"global",{name:"eq",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:11,column:8},end:{line:14,column:15}}}))?i:"")+'        Click the question mark on the left for an explanation of each icon and please\n        visit our <a href="https://help.livelyapps.com/hideelements-for-confluence-server/" target="_blank">documentation</a> for more information.\n        Don\'t hesitate to <a href="https://go.livelyapps.com/support" target="_blank">raise a ticket</a> if\n        you need additional assistance (or just want to say hello to the <Strong>Lively Apps</Strong> team)!\n    </p>\n    <span class="aui-icon icon-close" role="button"></span>\n</div>'},useData:!0})},966:(e,n,t)=>{var a=t(655);e.exports=(a.default||a).template({1:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(i=l(t,"notEmpty").call(null!=n?n:e.nullContext||{},null!=n?l(n,"warnings"):n,{name:"notEmpty",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:4},end:{line:15,column:17}}}))?i:""},2:function(e,n,t,a,o){var i,l=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'        <div class="aui-message aui-message-warning">\n            <p class="title">\n                <strong>You currently have warnings</strong>\n            </p>\n            <ul>\n'+(null!=(i=l(t,"each").call(null!=n?n:e.nullContext||{},null!=n?l(n,"warnings"):n,{name:"each",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:8,column:16},end:{line:12,column:25}}}))?i:"")+"            </ul>\n        </div>\n"},3:function(e,n,t,a,o){var i;return null!=(i=(e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]})(t,"eq").call(null!=n?n:e.nullContext||{},n,"GROUSE",{name:"eq",hash:{},fn:e.program(4,o,0),inverse:e.noop,data:o,loc:{start:{line:9,column:20},end:{line:11,column:27}}}))?i:""},4:function(e,n,t,a,o){return'                        <li>There are cache inconsistencies on your instance (error code "Grouse"). This may affect performance. Please visit <a href="https://go.livelyapps.com/hideelements-warning-grouse">this troubleshooting article</a>.</li>\n'},6:function(e,n,t,a,o){return"locking-disabled"},8:function(e,n,a,o,i){var l;return null!=(l=e.invokePartial(t(881),n,{name:"element-item",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:""},10:function(e,n,a,o,i){var l;return null!=(l=e.invokePartial(t(275),n,{name:"settings-info",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:""},12:function(e,n,t,a,o){return'                <div class="buttons-container">\n                    <div class="buttons">\n                        <span class="aui-icon aui-icon-success aui-icon-small aui-iconfont-approve"> </span>\n                        <span class="aui-icon aui-icon-wait"> </span>\n                        <span class="aui-icon aui-icon-error"> </span>\n                        <button class="settings-save-button aui-button aui-button-primary" disabled>Save</button>\n                    </div>\n                    <span class="status"></span>\n                </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,n,a,o,i){var l,r=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return(null!=(l=s(a,"eq").call(r,null!=n?s(n,"scope"):n,"global",{name:"eq",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:1,column:0},end:{line:16,column:7}}}))?l:"")+'\n<form action="#" class="he-form aui '+(null!=(l=s(a,"unless").call(r,null!=n?s(n,"lockingEnabled"):n,{name:"unless",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i,loc:{start:{line:18,column:36},end:{line:18,column:89}}}))?l:"")+'" data-scope="'+e.escapeExpression(e.lambda(null!=n?s(n,"scope"):n,n))+'">\n    <div class="he-menu">\n'+(null!=(l=s(a,"each").call(r,null!=n?s(n,"elements"):n,{name:"each",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i,loc:{start:{line:20,column:8},end:{line:22,column:17}}}))?l:"")+"\n"+(null!=(l=e.invokePartial(t(567),null!=n?s(n,"cssSelector"):n,{name:"cssselector-field",data:i,indent:"        ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'\n        <a href="#" class="he-legend-button">\n            <span class="aui-icon icon-question aui-icon-small aui-iconfont-question-filled"></span>\n        </a>\n    </div>\n\n    <div class="he-content">\n'+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"scope"):n,"global",{name:"eq",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i,loc:{start:{line:32,column:8},end:{line:34,column:15}}}))?l:"")+(null!=(l=s(a,"eq").call(r,null!=n?s(n,"scope"):n,"space",{name:"eq",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i,loc:{start:{line:35,column:8},end:{line:37,column:15}}}))?l:"")+'\n        <div class="he-preview">\n'+(null!=(l=e.invokePartial(t(633),n,{name:"preview",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'\n            <ul class="reset-menu">\n                <li>\n                    <a href="#" class="reset-link he-markup-based-tooltip" data-tooltip-gravity="e"\n                       title="This will reset the state to the initial state on page load.">Reset</a></li>\n                <li>\n                    <a href="#" class="clear-link he-markup-based-tooltip" data-tooltip-gravity="e"\n                       title="This will completely clear all settings made here.">Clear</a></li>\n            </ul>\n\n'+(null!=(l=s(a,"noteq").call(r,null!=n?s(n,"scope"):n,"page",{name:"noteq",hash:{},fn:e.program(12,i,0),inverse:e.noop,data:i,loc:{start:{line:51,column:12},end:{line:61,column:22}}}))?l:"")+'        </div>\n\n        <div class="he-legend">\n'+(null!=(l=e.invokePartial(t(681),n,{name:"legend",data:i,indent:"            ",helpers:a,partials:o,decorators:e.decorators}))?l:"")+'            <a href="#" class="hide-legend-button">\n                <span class="aui-icon icon-hide-legend aui-icon-small aui-iconfont-chevron-double-left"></span>\n            </a>\n        </div>\n\n    </div>\n\n\n</form>'},usePartial:!0,useData:!0})},34:(e,n,t)=>{"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}n.__esModule=!0;var i=o(t(207)),l=a(t(586)),r=a(t(24)),s=o(t(704)),c=o(t(546)),u=a(t(179));function d(){var e=new i.HandlebarsEnvironment;return s.extend(e,i),e.SafeString=l.default,e.Exception=r.default,e.Utils=s,e.escapeExpression=s.escapeExpression,e.VM=c,e.template=function(n){return c.template(n,e)},e}var p=d();p.create=d,u.default(p),p.default=p,n.default=p,e.exports=n.default},207:(e,n,t)=>{"use strict";function a(e){return e&&e.__esModule?e:{default:e}}n.__esModule=!0,n.HandlebarsEnvironment=d;var o=t(704),i=a(t(24)),l=t(870),r=t(576),s=a(t(765)),c=t(467);n.VERSION="4.7.7",n.COMPILER_REVISION=8,n.LAST_COMPATIBLE_COMPILER_REVISION=7,n.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};var u="[object Object]";function d(e,n,t){this.helpers=e||{},this.partials=n||{},this.decorators=t||{},l.registerDefaultHelpers(this),r.registerDefaultDecorators(this)}d.prototype={constructor:d,logger:s.default,log:s.default.log,registerHelper:function(e,n){if(o.toString.call(e)===u){if(n)throw new i.default("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else this.helpers[e]=n},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,n){if(o.toString.call(e)===u)o.extend(this.partials,e);else{if(void 0===n)throw new i.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=n}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,n){if(o.toString.call(e)===u){if(n)throw new i.default("Arg not supported with multiple decorators");o.extend(this.decorators,e)}else this.decorators[e]=n},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){c.resetLoggedProperties()}};var p=s.default.log;n.log=p,n.createFrame=o.createFrame,n.logger=s.default},576:(e,n,t)=>{"use strict";n.__esModule=!0,n.registerDefaultDecorators=function(e){o.default(e)};var a,o=(a=t(642))&&a.__esModule?a:{default:a}},642:(e,n,t)=>{"use strict";n.__esModule=!0;var a=t(704);n.default=function(e){e.registerDecorator("inline",(function(e,n,t,o){var i=e;return n.partials||(n.partials={},i=function(o,i){var l=t.partials;t.partials=a.extend({},l,n.partials);var r=e(o,i);return t.partials=l,r}),n.partials[o.args[0]]=o.fn,i}))},e.exports=n.default},24:(e,n)=>{"use strict";n.__esModule=!0;var t=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function a(e,n){var o=n&&n.loc,i=void 0,l=void 0,r=void 0,s=void 0;o&&(i=o.start.line,l=o.end.line,r=o.start.column,s=o.end.column,e+=" - "+i+":"+r);for(var c=Error.prototype.constructor.call(this,e),u=0;u<t.length;u++)this[t[u]]=c[t[u]];Error.captureStackTrace&&Error.captureStackTrace(this,a);try{o&&(this.lineNumber=i,this.endLineNumber=l,Object.defineProperty?(Object.defineProperty(this,"column",{value:r,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:s,enumerable:!0})):(this.column=r,this.endColumn=s))}catch(e){}}a.prototype=new Error,n.default=a,e.exports=n.default},870:(e,n,t)=>{"use strict";function a(e){return e&&e.__esModule?e:{default:e}}n.__esModule=!0,n.registerDefaultHelpers=function(e){o.default(e),i.default(e),l.default(e),r.default(e),s.default(e),c.default(e),u.default(e)},n.moveHelperToHooks=function(e,n,t){e.helpers[n]&&(e.hooks[n]=e.helpers[n],t||delete e.helpers[n])};var o=a(t(810)),i=a(t(847)),l=a(t(780)),r=a(t(229)),s=a(t(328)),c=a(t(124)),u=a(t(89))},810:(e,n,t)=>{"use strict";n.__esModule=!0;var a=t(704);n.default=function(e){e.registerHelper("blockHelperMissing",(function(n,t){var o=t.inverse,i=t.fn;if(!0===n)return i(this);if(!1===n||null==n)return o(this);if(a.isArray(n))return n.length>0?(t.ids&&(t.ids=[t.name]),e.helpers.each(n,t)):o(this);if(t.data&&t.ids){var l=a.createFrame(t.data);l.contextPath=a.appendContextPath(t.data.contextPath,t.name),t={data:l}}return i(n,t)}))},e.exports=n.default},847:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=t(704),i=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("each",(function(e,n){if(!n)throw new i.default("Must pass iterator to #each");var a,l=n.fn,r=n.inverse,s=0,c="",u=void 0,d=void 0;function p(n,t,a){u&&(u.key=n,u.index=t,u.first=0===t,u.last=!!a,d&&(u.contextPath=d+n)),c+=l(e[n],{data:u,blockParams:o.blockParams([e[n],n],[d+n,null])})}if(n.data&&n.ids&&(d=o.appendContextPath(n.data.contextPath,n.ids[0])+"."),o.isFunction(e)&&(e=e.call(this)),n.data&&(u=o.createFrame(n.data)),e&&"object"==typeof e)if(o.isArray(e))for(var f=e.length;s<f;s++)s in e&&p(s,s,s===e.length-1);else if(t.g.Symbol&&e[t.g.Symbol.iterator]){for(var h=[],m=e[t.g.Symbol.iterator](),v=m.next();!v.done;v=m.next())h.push(v.value);for(f=(e=h).length;s<f;s++)p(s,s,s===e.length-1)}else a=void 0,Object.keys(e).forEach((function(e){void 0!==a&&p(a,s-1),a=e,s++})),void 0!==a&&p(a,s-1,!0);return 0===s&&(c=r(this)),c}))},e.exports=n.default},780:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},e.exports=n.default},229:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=t(704),i=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("if",(function(e,n){if(2!=arguments.length)throw new i.default("#if requires exactly one argument");return o.isFunction(e)&&(e=e.call(this)),!n.hash.includeZero&&!e||o.isEmpty(e)?n.inverse(this):n.fn(this)})),e.registerHelper("unless",(function(n,t){if(2!=arguments.length)throw new i.default("#unless requires exactly one argument");return e.helpers.if.call(this,n,{fn:t.inverse,inverse:t.fn,hash:t.hash})}))},e.exports=n.default},328:(e,n)=>{"use strict";n.__esModule=!0,n.default=function(e){e.registerHelper("log",(function(){for(var n=[void 0],t=arguments[arguments.length-1],a=0;a<arguments.length-1;a++)n.push(arguments[a]);var o=1;null!=t.hash.level?o=t.hash.level:t.data&&null!=t.data.level&&(o=t.data.level),n[0]=o,e.log.apply(e,n)}))},e.exports=n.default},124:(e,n)=>{"use strict";n.__esModule=!0,n.default=function(e){e.registerHelper("lookup",(function(e,n,t){return e?t.lookupProperty(e,n):e}))},e.exports=n.default},89:(e,n,t)=>{"use strict";n.__esModule=!0;var a,o=t(704),i=(a=t(24))&&a.__esModule?a:{default:a};n.default=function(e){e.registerHelper("with",(function(e,n){if(2!=arguments.length)throw new i.default("#with requires exactly one argument");o.isFunction(e)&&(e=e.call(this));var t=n.fn;if(o.isEmpty(e))return n.inverse(this);var a=n.data;return n.data&&n.ids&&((a=o.createFrame(n.data)).contextPath=o.appendContextPath(n.data.contextPath,n.ids[0])),t(e,{data:a,blockParams:o.blockParams([e],[a&&a.contextPath])})}))},e.exports=n.default},943:(e,n,t)=>{"use strict";n.__esModule=!0,n.createNewLookupObject=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return a.extend.apply(void 0,[Object.create(null)].concat(n))};var a=t(704)},467:(e,n,t)=>{"use strict";n.__esModule=!0,n.createProtoAccessControl=function(e){var n=Object.create(null);n.constructor=!1,n.__defineGetter__=!1,n.__defineSetter__=!1,n.__lookupGetter__=!1;var t=Object.create(null);return t.__proto__=!1,{properties:{whitelist:a.createNewLookupObject(t,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:a.createNewLookupObject(n,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}},n.resultIsAllowed=function(e,n,t){return function(e,n){return void 0!==e.whitelist[n]?!0===e.whitelist[n]:void 0!==e.defaultValue?e.defaultValue:(function(e){!0!==i[e]&&(i[e]=!0,o.log("error",'Handlebars: Access has been denied to resolve the property "'+e+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(n),!1)}("function"==typeof e?n.methods:n.properties,t)},n.resetLoggedProperties=function(){Object.keys(i).forEach((function(e){delete i[e]}))};var a=t(943),o=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}(t(765)),i=Object.create(null)},205:(e,n)=>{"use strict";n.__esModule=!0,n.wrapHelper=function(e,n){return"function"!=typeof e?e:function(){return arguments[arguments.length-1]=n(arguments[arguments.length-1]),e.apply(this,arguments)}}},765:(e,n,t)=>{"use strict";n.__esModule=!0;var a=t(704),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var n=a.indexOf(o.methodMap,e.toLowerCase());e=n>=0?n:parseInt(e,10)}return e},log:function(e){if(e=o.lookupLevel(e),"undefined"!=typeof console&&o.lookupLevel(o.level)<=e){var n=o.methodMap[e];console[n]||(n="log");for(var t=arguments.length,a=Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];console[n].apply(console,a)}}};n.default=o,e.exports=n.default},179:(e,n,t)=>{"use strict";n.__esModule=!0,n.default=function(e){var n=void 0!==t.g?t.g:window,a=n.Handlebars;e.noConflict=function(){return n.Handlebars===e&&(n.Handlebars=a),e}},e.exports=n.default},546:(e,n,t)=>{"use strict";n.__esModule=!0,n.checkRevision=function(e){var n=e&&e[0]||1,t=l.COMPILER_REVISION;if(!(n>=l.LAST_COMPATIBLE_COMPILER_REVISION&&n<=l.COMPILER_REVISION)){if(n<l.LAST_COMPATIBLE_COMPILER_REVISION){var a=l.REVISION_CHANGES[t],o=l.REVISION_CHANGES[n];throw new i.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+a+") or downgrade your runtime to an older version ("+o+").")}throw new i.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},n.template=function(e,n){if(!n)throw new i.default("No environment passed to template");if(!e||!e.main)throw new i.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,n.VM.checkRevision(e.compiler);var t=e.compiler&&7===e.compiler[0],a={strict:function(e,n,t){if(!e||!(n in e))throw new i.default('"'+n+'" not defined in '+e,{loc:t});return a.lookupProperty(e,n)},lookupProperty:function(e,n){var t=e[n];return null==t||Object.prototype.hasOwnProperty.call(e,n)||c.resultIsAllowed(t,a.protoAccessControl,n)?t:void 0},lookup:function(e,n){for(var t=e.length,o=0;o<t;o++)if(null!=(e[o]&&a.lookupProperty(e[o],n)))return e[o][n]},lambda:function(e,n){return"function"==typeof e?e.call(n):e},escapeExpression:o.escapeExpression,invokePartial:function(t,a,l){l.hash&&(a=o.extend({},a,l.hash),l.ids&&(l.ids[0]=!0)),t=n.VM.resolvePartial.call(this,t,a,l);var r=o.extend({},l,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),s=n.VM.invokePartial.call(this,t,a,r);if(null==s&&n.compile&&(l.partials[l.name]=n.compile(t,e.compilerOptions,n),s=l.partials[l.name](a,r)),null!=s){if(l.indent){for(var c=s.split("\n"),u=0,d=c.length;u<d&&(c[u]||u+1!==d);u++)c[u]=l.indent+c[u];s=c.join("\n")}return s}throw new i.default("The partial "+l.name+" could not be compiled when running in runtime-only mode")},fn:function(n){var t=e[n];return t.decorator=e[n+"_d"],t},programs:[],program:function(e,n,t,a,o){var i=this.programs[e],l=this.fn(e);return n||o||a||t?i=u(this,e,l,n,t,a,o):i||(i=this.programs[e]=u(this,e,l)),i},data:function(e,n){for(;e&&n--;)e=e._parent;return e},mergeIfNeeded:function(e,n){var t=e||n;return e&&n&&e!==n&&(t=o.extend({},n,e)),t},nullContext:Object.seal({}),noop:n.VM.noop,compilerInfo:e.compiler};function l(n){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=t.data;l._setup(t),!t.partial&&e.useData&&(o=p(n,o));var i=void 0,r=e.useBlockParams?[]:void 0;function s(n){return""+e.main(a,n,a.helpers,a.partials,o,r,i)}return e.useDepths&&(i=t.depths?n!=t.depths[0]?[n].concat(t.depths):t.depths:[n]),(s=f(e.main,s,a,t.depths||[],o,r))(n,t)}return l.isTop=!0,l._setup=function(i){if(i.partial)a.protoAccessControl=i.protoAccessControl,a.helpers=i.helpers,a.partials=i.partials,a.decorators=i.decorators,a.hooks=i.hooks;else{var l=o.extend({},n.helpers,i.helpers);!function(e,n){Object.keys(e).forEach((function(t){var a=e[t];e[t]=function(e,n){var t=n.lookupProperty;return s.wrapHelper(e,(function(e){return o.extend({lookupProperty:t},e)}))}(a,n)}))}(l,a),a.helpers=l,e.usePartial&&(a.partials=a.mergeIfNeeded(i.partials,n.partials)),(e.usePartial||e.useDecorators)&&(a.decorators=o.extend({},n.decorators,i.decorators)),a.hooks={},a.protoAccessControl=c.createProtoAccessControl(i);var u=i.allowCallsToHelperMissing||t;r.moveHelperToHooks(a,"helperMissing",u),r.moveHelperToHooks(a,"blockHelperMissing",u)}},l._child=function(n,t,o,l){if(e.useBlockParams&&!o)throw new i.default("must pass block params");if(e.useDepths&&!l)throw new i.default("must pass parent depths");return u(a,n,e[n],t,0,o,l)},l},n.wrapProgram=u,n.resolvePartial=function(e,n,t){return e?e.call||t.name||(t.name=e,e=t.partials[e]):e="@partial-block"===t.name?t.data["partial-block"]:t.partials[t.name],e},n.invokePartial=function(e,n,t){var a=t.data&&t.data["partial-block"];t.partial=!0,t.ids&&(t.data.contextPath=t.ids[0]||t.data.contextPath);var r=void 0;if(t.fn&&t.fn!==d&&function(){t.data=l.createFrame(t.data);var e=t.fn;r=t.data["partial-block"]=function(n){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.data=l.createFrame(t.data),t.data["partial-block"]=a,e(n,t)},e.partials&&(t.partials=o.extend({},t.partials,e.partials))}(),void 0===e&&r&&(e=r),void 0===e)throw new i.default("The partial "+t.name+" could not be found");if(e instanceof Function)return e(n,t)},n.noop=d;var a,o=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}(t(704)),i=(a=t(24))&&a.__esModule?a:{default:a},l=t(207),r=t(870),s=t(205),c=t(467);function u(e,n,t,a,o,i,l){function r(n){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=l;return!l||n==l[0]||n===e.nullContext&&null===l[0]||(r=[n].concat(l)),t(e,n,e.helpers,e.partials,o.data||a,i&&[o.blockParams].concat(i),r)}return(r=f(t,r,e,l,a,i)).program=n,r.depth=l?l.length:0,r.blockParams=o||0,r}function d(){return""}function p(e,n){return n&&"root"in n||((n=n?l.createFrame(n):{}).root=e),n}function f(e,n,t,a,i,l){if(e.decorator){var r={};n=e.decorator(n,r,t,a&&a[0],i,l,a),o.extend(n,r)}return n}},586:(e,n)=>{"use strict";function t(e){this.string=e}n.__esModule=!0,t.prototype.toString=t.prototype.toHTML=function(){return""+this.string},n.default=t,e.exports=n.default},704:(e,n)=>{"use strict";n.__esModule=!0,n.extend=l,n.indexOf=function(e,n){for(var t=0,a=e.length;t<a;t++)if(e[t]===n)return t;return-1},n.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return o.test(e)?e.replace(a,i):e},n.isEmpty=function(e){return!e&&0!==e||!(!c(e)||0!==e.length)},n.createFrame=function(e){var n=l({},e);return n._parent=e,n},n.blockParams=function(e,n){return e.path=n,e},n.appendContextPath=function(e,n){return(e?e+".":"")+n};var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},a=/[&<>"'`=]/g,o=/[&<>"'`=]/;function i(e){return t[e]}function l(e){for(var n=1;n<arguments.length;n++)for(var t in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],t)&&(e[t]=arguments[n][t]);return e}var r=Object.prototype.toString;n.toString=r;var s=function(e){return"function"==typeof e};s(/x/)&&(n.isFunction=s=function(e){return"function"==typeof e&&"[object Function]"===r.call(e)}),n.isFunction=s;var c=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===r.call(e)};n.isArray=c},655:(e,n,t)=>{e.exports=t(34).default}},n={};function t(a){var o=n[a];if(void 0!==o)return o.exports;var i=n[a]={exports:{}};return e[a](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=t(978),n=t(968),a=t(898),o=t(455),i=t(222);t(362);var l,r="hideelements-container";function s(){$("#macro-details-page").removeClass(r)}function c(e,n){n&&n.dialog&&n.dialog.activeMetadata&&"hideelements-macro"===n.dialog.activeMetadata.macroName&&($(".he-form").remove(),s())}function u(e){var n=$(".he-form"),t=n.hasClass("macrobrowser-opened");if(n.length&&($('.he-item-div:not([data-he-key="cssselector"])').each((function(){var n=$(this),a=n.attr("data-visibility");if(t){var o=n.attr("data-he-key");"unset"===a?delete e[o]:e[o]="hidden"===a}})),t)){var a=$('.he-item-div[data-he-key="cssselector"]'),o=a.find("input").val(),i="true"===a.attr("data-from-macro"),l=a.attr("data-original-value");o&&(i||o!==l)?e.cssselector=o:delete e.cssselector}return n.addClass("macrobrowser-opened"),e}function d(t){var i,c,u=$("#macro-details-page");return u.addClass(r),u.find(".dialog-back-link").one("click",s),$(".he-form").remove(),e.S(u.find(".dialog-panel-body"),(i=t,c=a.i(l,!1,"page"),$.each(i,(function(e,t){var a=c.elements[e];if(a&&"cssselector"!==e&&"locked"!==a.lockedInParent){var i=n.eU(t),l=n.oI(i);a.visibility=l;var r=o.Lw(l,a.locked,a.parentVisibility,a.lockedInParent);a.iconComboKey=o.Jb(r)}})),"cssselector"in i&&"locked"!==c.cssSelector.lockedInParent&&(c.cssSelector.value=i.cssselector,c.cssSelector.fromMacro=!0),c)),t}AJS.bind("init.rte",(function(){l=i.ZV("macrobrowser"),AJS.MacroBrowser&&AJS.MacroBrowser.setMacroJsOverride("hideelements-macro",{beforeParamsRetrieved:u,beforeParamsSet:d}),AJS.bind("hide.dialog",c)}))})()})();
//# sourceMappingURL=bundle-macrobrowser.js.map
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:split_nh-macro-browser-plugin', location = 'nh-macro-browser-plugin.3df9976fe535214983d7.js' */
(window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[]).push([[5],{139:function(a,b,c){"use strict";c.r(b);var d=c(140),e=c.n(d),f=c(2),g=c.n(f),h=function(){this.headingFields=["h1","h2","h3","h4","h5","h6"]};h.prototype.beforeParamsSet=function(a){var b=a["number-format"];if("custom"!==b)for(var c=0;c<this.headingFields.length;c++)g.a.$("#macro-param-div-"+this.headingFields[c]).hide();return a},h.prototype.fields={enum:{"number-format":function(a){var b=g.a.MacroBrowser.ParameterFields["enum"](a);return g.a.$(b.input[0]).on("change",function(){for(var a=1;6>=a;a++)"custom"===this.value?g.a.$("#macro-param-div-h"+a).show():g.a.$("#macro-param-div-h"+a).hide()}),b}}},"function"==typeof g.a.MacroBrowser.setMacroJsOverride?g.a.MacroBrowser.setMacroJsOverride("numberedheadings",new h):g.a.MacroBrowser.Macros={numberedheadings:new h}},140:function(a){a.exports=void 0}},[[139,10,0]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'nl.avisi.confluence.plugins.numberedheadings:entrypoint-nh-macro-browser-plugin', location = 'bundled.runtime~nh-macro-browser-plugin.b1f5e0ea85005dc029a1.js' */
(function(a){function b(b){for(var d,e,h=b[0],j=b[1],k=b[2],l=0,m=[];l<h.length;l++)e=h[l],f[e]&&m.push(f[e][0]),f[e]=0;for(d in j)Object.prototype.hasOwnProperty.call(j,d)&&(a[d]=j[d]);for(i&&i(b);m.length;)m.shift()();return g.push.apply(g,k||[]),c()}function c(){for(var a,b=0;b<g.length;b++){for(var c,e=g[b],h=!0,i=1;i<e.length;i++)c=e[i],0!==f[c]&&(h=!1);h&&(g.splice(b--,1),a=d(d.s=e[0]))}return a}function d(b){if(e[b])return e[b].exports;var c=e[b]={i:b,l:!1,exports:{}};return a[b].call(c.exports,c,c.exports,d),c.l=!0,c.exports}var e={},f={10:0},g=[];d.m=a,d.c=e,d.d=function(a,b,c){d.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:c})},d.r=function(a){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(a,'__esModule',{value:!0})},d.t=function(a,b){if(1&b&&(a=d(a)),8&b)return a;if(4&b&&'object'==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(d.r(c),Object.defineProperty(c,'default',{enumerable:!0,value:a}),2&b&&'string'!=typeof a)for(var e in a)d.d(c,e,function(b){return a[b]}.bind(null,e));return c},d.n=function(a){var b=a&&a.__esModule?function(){return a['default']}:function(){return a};return d.d(b,'a',b),b},d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},d.p='','undefined'!=typeof AJS&&(d.p=AJS.contextPath()+'/s/2585692b-d6e2-436b-ba22-c8f4b00be189/_/download/resources/nl.avisi.confluence.plugins.numberedheadings:assets-2585692b-d6e2-436b-ba22-c8f4b00be189/');var h=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b=window.atlassianWebpackJsonp981e0f4effab173567f2d6cf31d7b23b||[],j=h.push.bind(h);h.push=b,h=h.slice();for(var k=0;k<h.length;k++)b(h[k]);var i=j;c()})([]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'biz.artemissoftware.confluence.multiexcerpt.MultiExcerptMacro:name-field-parameter', location = 'js/name-parameter-field.js' */
(function (AJS, $) {  // IIFE

  // The macro editor div is inserted into the DOM when a user edits a
  // macro in the page editor.  The inputs in the editor insert
  // option elements dynamically.
  //
  // Detect and react to DOM insertion for the ME Include macro editor:
  var observer = new MutationObserver(function (mutations) {
    var handledMutation = false;
    for (var i = 0; i < mutations.length; i++) {
      for (var j = 0; j < mutations[i].addedNodes.length; j++) {
        var addedNode = mutations[i].addedNodes[j];
        if (addedNode.nodeType === Node.ELEMENT_NODE) {
          if ( customizeNameInputForMEIncludeMacro($(addedNode)) ) {
            handledMutation = true;
            break;
          }
        }
      }
      if (handledMutation) {
        break;
      }
    }
  });

  var firstLoad;     // true if rendering the macro name input for the first time

  // the input immediately after the name input
  var nextParamLocator = '#macro-param-shouldDisplayInlineCommentsInIncludes';

  // Implement "select2" selector options auto-complete for the macro name input in the macro editor for ME Include
  // https://docs.atlassian.com/aui/8.5.1/docs/auiselect2.html
  // https://developer.atlassian.com/server/confluence/javascript-components/
  //
  // The space and page name inputs are automatically wired up w/ necessary REST APIs, etc. to populate
  // the input options because they are for standard objects.
  // We have a custom impl for the macro name input because we use our own REST API for getting a list
  // of ME macros in a given space/page.
  function customizeNameInputForMEIncludeMacro($addedNode) {  // TODO: rename to customizeNameInputForMEIncludeMacro

    var excerptNames;  // array of the values for options in the macro name input (name of included ME)
    var $nameInput = $addedNode.find('#macro-param-MultiExcerptName');   // macro name input (name of included ME)
    var pageInputLocator = '#macro-param-PageWithExcerpt';               // macro page name input (page that owns the included ME)
    var $spaceInput = $('#macro-param-SpaceWithExcerpt');
    var foundOurNameInput = $nameInput.length;

    // TODO: for support of the magic "@self" value for the page input
//    var $olLast = $addedNode.find('ol.last');                           // list of options for select2 selector
//    var foundOurSelect2Options = $olLast.length;

    if (foundOurNameInput) {

      // We watch for ESC key on the div that contains the macro name input, not on the name input
      // TODO: really?  this looks like it is wired to ESC key for ANY select2 selector
      $(document).off('keyup.select2').on('keyup.select2', function (event) {
        if (event.which === 27) { //ESC
          select2init($nameInput.val(), $nameInput, excerptNames);
          $(nextParamLocator).focus(); // the input immediately after the name input
        }
      });
      firstLoad = true;

      var $pageInput = $(pageInputLocator);

      // initialize the macro name input options
      var loadAvailableMacros = function(pageTitle) {
          $.ajax({
            // Make REST call to get the name of the ME we are including
            url: AJS.contextPath() + '/rest/multiexcerpt/1.0/names',
            data: {
              pageTitleParam: pageTitle,
              currentSpaceKey: $('#confluence-space-key').attr('content')
            },
            success: function (res) {
              excerptNames = res.slice();
              select2init($nameInput.val(), $nameInput, res);
              $nameInput.off("select2-selecting").on("select2-selecting", function (e) {
                res = excerptNames.slice();
                firstLoad = true;
                select2init(e.val, $nameInput, res);
                $nameInput.val(e.val).trigger("change");

                // setup keyboard TAB navigation from the macro name input to the next input on the form
                // select2 has trouble w/ tab out.
                $(document).on('keydown.select2', function (event) {
                  if (event.which === 9) { //TAB
                    event.preventDefault();
                    $(nextParamLocator).focus();  // the input immediately after the name input
                  }
                });

                // TODO: if this is not here then TAB from input to input doesn't work.
                // Why are we doing this:
                //
                // unbind the event again to avoid binding multiple times
                setTimeout(function () {
                  $(document).off('keydown.select2');
                }, 1);
                $(nextParamLocator).focus();  // the input immediately after the name input
              });
            }  // end ajax success
          });  // end ajax call
      };  // end function loadAvailableMacros

      // Initialize during first load
      var pageWithExcerptValue = $pageInput.val();

      // Handling 'Page with Excerpt' value update
      var onPageWithExcerptUpdate = function(pageTitle, isInit) {

        // Initialize macro name options on initial loading
        if (isInit) {
          var initialSpaceKey = $spaceInput.val() || AJS.Meta.get('space-key');
          $pageInput.attr('data-spacekey', initialSpaceKey);
          loadAvailableMacros(pageTitle);
          return;
        }

        // Check if value in control has been changed during interactivity with control
        if (pageWithExcerptValue !== pageTitle) {

          // Remember previous value that was entered/selected
          pageWithExcerptValue = pageTitle;

          // Reset macro name options cuz 'Page with Excerpt' has been changed
          $nameInput.val('').trigger('change');
          if (pageTitle) {
            // Reinitialize macro name options cuz 'Page with Excerpt' is not set
            loadAvailableMacros(pageTitle);
          }
          return;
        }

        // Reset macro name options if page with excerpt not set
        if (!pageTitle) {
            $nameInput.val('').trigger('change');
        }
      };  // end function onPageWithExcerptUpdate

      // Attach event listeners to 'Page with Excerpts' control
      $pageInput.off('change').on({
        'selected.autocomplete-content change': function(event, data) {

          // After this change event listener is declared here
          // we fire a change event with {initNameInputSelector: true}.
          // That is so that only that first change event (the one we fire w/ init=true) will
          // initialize the name param input
          var isInit = (data || {}).initNameInputSelector;

          // If the SpaceWithExcerpt parameter is not specified then it is "this" space
          var thisSpaceKey = AJS.Meta.get('space-key');
          var spaceInputValue = $spaceInput.val();
          var spaceWithExcerpt = spaceInputValue || thisSpaceKey;

          var pageWithExcerpt = $pageInput.val();

          // TODO: the excerpt name input selector is not being auto-populated when using "@self"
          // so let's not partly support this thing:
//          var pageTitle = pageWithExcerpt !== "@self" ? pageWithExcerpt :
//              $('meta[name="ajs-page-title"]').attr('content');
          var pageTitle = pageWithExcerpt;

          if (pageTitle) {
            if (pageTitle.indexOf(':') !== -1) {
              var spaceKeyPrefix = pageTitle.split(':')[0];
              if (spaceWithExcerpt !== spaceKeyPrefix) {
                pageTitle = spaceWithExcerpt + ':' + pageTitle;
                $pageInput.val(pageTitle);
              }
            } else {
              pageTitle = spaceWithExcerpt + ':' + pageTitle;
              $pageInput.val(pageTitle);
            }

            // CMEP-283 - don't ever let the SpaceWithExcerpt parameter get set to "this" space.
            //            If it is "this" space THEN IT NEEDS TO BE EMPTY/BLANK/UNSET to be consistent
            //            with how Confluence uses page links (they don't include a space-key in a
            //            ri:page link to a page in "this" space).
            //
            //            If that is confusing then look at the Storage format for the PageWithExcerpt
            //            ac:link and ri:page elements.  Notice it has no space-key attribute if the space key
            //            for the page is "this" space.
            //            Only when the space is "another" space does the ri:page element have a space-key
            //            attribute.
            //            If we set the value for SpaceWithExcerpt when it is for "this" space it wreaks havoc.
            if (thisSpaceKey === spaceInputValue) {
              $spaceInput.val('');
              var clearedMsg = "The \u0022Space With Excerpt\u0022 parameter has been cleared because it was set to this space.";
              console.warn(clearedMsg);
              var explanationMsg = "The parameter needs to be blank/unset to denote \u0022this\u0022 space (CMEP-283).";
              var explanationMsg = "The parameter needs to be blank/unset to denote \u0022this\u0022 space (CMEP-283).";
              var actionMsg = "Save this macro to repair the parameter.";
              alert(clearedMsg + '\n\n' + explanationMsg + '\n\n' + actionMsg);
            }
          }

          onPageWithExcerptUpdate(pageTitle, isInit);
        }  // end anonymnous function change event handler
      });  // end $pageInput.on(...) call

      // Fire a change in the page name input to cause initialization of macro name input options
      $pageInput.trigger("change", {
          initNameInputSelector: true
      });
    }

    // TODO: support for the magic "@self" value for page name input is more complexity than it is worth right now.
    //       It was only partly working. Let's take it all out for now.
//    else if (foundOurSelect2Options) {  // end if (foundOurNameInput)
//
//      // Process the options list for the macro page name input to handle the "@self" magic value
//      // for page name
//      var $pageInput = $(pageInputLocator);
//      if ( $pageInput.find($olLast).length ) {
//        // TODO: add support in the macro name input for @self in the page name input.  Currently,
//        //       the macro name input options are NOT populated when page name input val is '@self'
//        if ("@self".match("^" + $pageInput.val())) {
//          var $selfLi = $('<li class=""><a class="content-type-page"><span title="@self"><em>@self</em></span></a></li>');
//          $selfLi.hover(function () {
//            $(this).toggleClass("active");
//          });
//          $selfLi.click(function () {
//            $pageInput.val('@self');
//            $pageInput.trigger("change");
//          });
//          if ($olLast.find('span[title="@self"]').length == 0) {
//            $pageInput.off('keydown');
//            $pageInput.keydown(function (e) {
//              if (e.which == 13 && $('li.active').find('span[title="@self"]').length) {  // 13 --> enter/return
//                e.stopPropagation();
//                $pageInput.val('@self');
//                $('div.aui-dropdown.aui-dropdown-left').remove();
//                $pageInput.trigger("change");
//              }
//            });
//            $olLast.append($selfLi);
//          }
//          $('a.no-results').parent().remove();
//        }
//      }
//    }  // end else if

    return foundOurNameInput;
  }  // end function customizeNameInputForMEIncludeMacro

  // Initialize "select2" input options for the macro name input
  function select2init(selectValue, $nameInput, options) {
    $('#select2-drop-mask').remove();
    if (selectValue.length > 0 && firstLoad) {
      var hasDefaultValue = false;
      $.each(options, function (i, obj) {
        if (obj.id === selectValue) {
          hasDefaultValue = true;
          return false;
        }
      });
      if (!hasDefaultValue) {
        var defaultValue = {"id": selectValue, "text": selectValue};
        options.unshift(defaultValue);
      }
    }
    firstLoad = false;
    $nameInput.auiSelect2('destroy');
    $nameInput.auiSelect2({
      data: options,
      createSearchChoice: function (term, data) {
        if ($(data).filter(function () {
            return this.text.localeCompare(term) === 0;
          }).length === 0) {
            return {
              id: term,
              text: term
            };
          }
      }
    }).on("select2-focus", function () {   // TODO: off/on?
      $nameInput.data('select2').open();
      $('#select2-drop-mask').off();
      $('#select2-drop-mask').on('click', function () {
        select2init(selectValue, $nameInput, options);
        $(nextParamLocator).focus();  // the input immediately after the name input
      });
    });
  }  // end function select2init


  // When the input for the space loses focus then update the macro page name input (page that owns the included ME)
  // with the space.
  $(document).ready(function() {
    AJS.bind('hide.dialog', function (e, data) {
      observer.disconnect();
    });

    AJS.bind('show.dialog', function(e, data) {
      observer.observe(document, {
          childList: true,
          subtree: true
      });

      // See Confluence autocomplete documents: https://developer.atlassian.com/server/confluence/javascript-components/
      $('#macro-browser-dialog').
        on('selected.autocomplete-content change', '#macro-param-SpaceWithExcerpt',
          function() {
            var pagePickerElement = $('#macro-param-PageWithExcerpt');
            var thisSpaceKey = AJS.Meta.get('space-key');
            var selectedSpaceKey = $(this).val();
            if (!selectedSpaceKey) {
                selectedSpaceKey = thisSpaceKey;
                pagePickerElement.trigger('focusout');  // TODO: why?
            } else if (selectedSpaceKey === thisSpaceKey ) {
              // CMEP-283 - If PageWithExcerpt does not have a space-key then SpaceWithExcerpt must be
              //            blank.
              //            Don't let the user set the SpaceWithExcerpt parameter to "this" space key, use
              //            a blank for "this" space.
              //
              //            For "this" space, when a page is selected for the PageWithExcerpt input, we
              //            end up with a PageWithExcerpt ac:link element that does not have a space-key
              //            attribute.  Confluence uses a missing space-key to mean "this" space.
              //            PageWithExcerpt is an ac:link element under the covers. Confluence does not
              //            add a space-key to the ri:page element in a ac:link element when the link is
              //            to a page in "this" space.
              //
              //            If we let the user set the SpaceWithExcerpt param to "this" space that
              //            would be bad because then they have a SpaceWithExcerpt param value that is
              //            INCONSISTENT with the PageWithExcerpt page link and that causes problems,
              //            especially when the page with this macro on it is moved/copied to other spaces.
              //
              $(this).val('');
              var msg = "Leave \u0022Space With Excerpt\u0022 empty to search in the current space.";
              alert(msg);
            }

            // Reinitialize 'Page with Excerpt' control if space has been changed
            var previousSpaceKey = pagePickerElement.attr('data-spacekey');
            if (previousSpaceKey !== selectedSpaceKey) {
                pagePickerElement.attr('data-spacekey', selectedSpaceKey);
                pagePickerElement.val('').trigger("change");
            }
          });  // end anonymous function for change event handler

          $(document).
            on('mouseover',
              '#macro-param-div-MultiExcerptName .select2-container .select2-chosen, .select2-results li',
              function() {
                $(this).attr('title', $(this).text());
            });
    });  // end AJS.bing for show-dialog

    /*AJS.MacroBrowser.setMacroJsOverride("multiexcerpt-include", {
        fields: {
            'confluence-content': {
                'PageWithExcerpt': function (params) {
                    params.options.spaceKey = 'TEST';
                    return AJS.MacroBrowser.ParameterFields['confluence-content'](params);
                }
            }
        }
    });*/
  });

})(AJS, AJS.$);   // end IIFE

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.griffel.confluence.plugins.plant-uml:macro-browser-fields', location = 'js/macro.js' */
AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("svg",["svg","svgz"]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'net.customware.confluence.plugin.scaffolding:override-macro-parameter', location = 'dist/js/overrideMacroParameter.js' */
!function(){var e={1249:function(e,a){"use strict";var r,t,n,o,i,s;Object.defineProperty(a,"__esModule",{value:!0}),a.nameParamOverrideHandler=void 0,r=AJS.$,n=new RegExp("^("+["handle","urlpath","type","version","content-name-unstemmed","versioncomment","title","created","homepage","watchers","space-type","contentbody","lastmodifiers","ancestorids","excerpt","content-version","spacekey","macrostorageversion","modified","lastmodifiername","labeltext","space-name","macroname","creatorname","authorcontributions","labelcontributions"].join("|")+")$","i"),t=function(e,a){var t,n,o,i,s;return i=function(e,a){return'<div id="'.concat(e,'">\n  <div class="aui-message aui-message-warning">\n    <p>\n      ').concat(a,"\n    </p>\n  </div>\n</div>")},r("#"+"scaffolding-name-warning").remove(),t=(n=(s=e&&!a)?"":"disabled")?"addClass":"removeClass",r("#macro-browser-dialog button.ok").prop("disabled",n),r("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",n)[t]("disabled"),a&&(o='Unable to use <em>"'.concat(r("#macro-param-name").val(),'"</em> as name, conflicts with\n<a href="https://confluence.atlassian.com/display/DOC/Confluence+Search+Fields#ConfluenceSearchFields-Confluencesearchfields" title="Atlassian Confluence documentation" target="_blank">\n  Confluence search fields\n</a>.'),r(i("scaffolding-name-warning",o)).insertAfter(r("#macro-param-div-name .macro-param-desc"))),s},i=function(e,a){var r;return r=e.match(n),t(a,r)},o=function(e){var a;return(a=r("input[data-scaffolding-field=true]")).length>0?i(a.val(),e):e},AJS.MacroBrowser.Editor?(s=AJS.MacroBrowser.Editor.processRequiredParameters,AJS.MacroBrowser.Editor.processRequiredParameters=function(){return o(s())}):function(e){AJS.MacroBrowser.processRequiredParameters=function(){return o(e())}}(AJS.MacroBrowser.processRequiredParameters),a.nameParamOverrideHandler=function(e,a){var t,n;return n=r(Confluence.Templates.MacroBrowser.macroParameter()),(t=r("input",n)).attr("data-scaffolding-field","true"),AJS.MacroBrowser.Field(n,t,a)}},1701:function(e,a,r){"use strict";r.r(a)},4024:function(e,a,r){e.exports=r}},a={};function r(t){var n=a[t];if(void 0!==n)return n.exports;var o=a[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},"undefined"!=typeof AJS&&(r.p=AJS.contextPath()+"/s/d35a8556-7a9b-4025-bed3-15c5e313bf96/_/download/resources/net.customware.confluence.plugin.scaffolding:assets-d35a8556-7a9b-4025-bed3-15c5e313bf96/"),function(){"use strict";r(4024);var e,a=r(1249);r(1701),e=["excerpt-data","text-data","list-data","number-data","get-data","eval-data","scaffold","group-data","repeating-data","table-data","label-options","date-data","set-data","attachment-data","set-data","set-data"],AJS.toInit((function(){return _.map(e,(function(e){return AJS.MacroBrowser.setMacroJsOverride(e,{fields:{string:a.nameParamOverrideHandler}})}))}))}()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'net.customware.confluence.plugin.scaffolding:override-live-template-macro-parameter', location = 'dist/js/overrideLiveTemplateMacroParameter.js' */
!function(){var e={4024:function(e,r,t){e.exports=t}},r={};function t(a){var n=r[a];if(void 0!==n)return n.exports;var o=r[a]={exports:{}};return e[a](o,o.exports,t),o.exports}"undefined"!=typeof AJS&&(t.p=AJS.contextPath()+"/s/d35a8556-7a9b-4025-bed3-15c5e313bf96/_/download/resources/net.customware.confluence.plugin.scaffolding:assets-d35a8556-7a9b-4025-bed3-15c5e313bf96/"),function(){"use strict";var e,r,a;t(4024),a=function(e){return e.paramDiv.show(),e.paramDiv.addClass("required")},e=function(e){return e.paramDiv.removeClass("required"),e.paramDiv.hide()},r={fields:{enum:{type:function(r,t){var n,o,s;return s=AJS.MacroBrowser.ParameterFields.enum(r,t),n=AJS.MacroBrowser.fields,o=function(){return"template"===s.getValue()||"blueprint"===s.getValue()?(a(n.template),e(n.page)):(a(n.page),e(n.template)),AJS.MacroBrowser.processRequiredParameters()},s.input.change((function(){return o()})),s}},string:{template:function(r,t){var a;return a=AJS.MacroBrowser.ParameterFields.string(r,t),e(a),a}},"confluence-content":{page:function(r,t){var n,o,s,i,u;return u=AJS.MacroBrowser.ParameterFields["confluence-content"](r,t),e(u),u.input.focusout((function(){return AJS.MacroBrowser.processRequiredParameters()})),o=(s=AJS.MacroBrowser.fields).type.getValue(),"template"===(n=void 0===(i=AJS.MacroBrowser.selectedMacroDefinition)||void 0===i.params.type?o:i.params.type)||"blueprint"===n?(a(s.template),e(u)):(a(u),e(s.template)),u}}}},AJS.MacroBrowser.setMacroJsOverride("live-template",r)}()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'eps.focuspro.EasyDropdownMenu:easy-dropdown-menu-macro-browser-v6.1.0', location = '/js/MacroBrowserOverride.js' */
AJS.toInit(function(){function e(e){return function(r,t){var o=AJS.$(Confluence.Templates.MacroBrowser.macroParameter()),n=AJS.$("input[type='text']",o);return r.required&&n.keyup(AJS.MacroBrowser.processRequiredParameters),t=t||{},e(n,!0,o,t),AJS.MacroBrowser.Field(o,n,t)}}function r(e){return function(r,t){var o=AJS.MacroBrowser.ParameterFields._hidden(r,t);return AJS.$("input#macro-param-option-id").on("change",function(){var r=e();r.length>0&&o.setValue(r)}),o}}function t(e,r,t){AJS.$("input#macro-param-set-id").on("change",function(){r?r=!1:AJS.$("input#macro-param-option-id").val(""),t(e)}),AJS.$("input#macro-param-multi-dropdown").on("change",function(){t(e)})}function o(){var e=AJS.$("#macro-param-option-id");AJS.$("#macro-param-multi-dropdown").is(":checked")?(AJS.$("div#macro-param-div-include-blank").hide(),AJS.$("div#macro-param-div-separator").show()):(AJS.$("div#macro-param-div-include-blank").show(),AJS.$("div#macro-param-div-separator").hide()),e.select2("destroy"),A(e)}var n=AJS.params.contextPath+"/rest/edm/1.0/edm/status/get-options-from-set",a=AJS.params.contextPath+"/rest/edm/1.0/edm/text/get-options-from-set",s=AJS.params.contextPath+"/rest/edm/1.0/edm/status/get-set-names",i=AJS.params.contextPath+"/rest/edm/1.0/edm/text/get-set-names",c=AJS.params.contextPath+"/rest/edm/1.0/edm/groups/allWritableNames",d=AJS.params.contextPath+"/rest/edm/1.0/edm/css/classes",m=function(e,r){return e&&" "!==e||(e="62d41cfd-9dc1-45ff-8991-defaultset"),{setId:e,spaceKey:r}},p=function(e){Edm.Rest.get(c,function(r){Edm.Select2.createDropdownFromResponse(e,r,!0)})},u=function(e){Edm.Rest.post(d,{spaceKey:AJS.params.spaceKey},function(r){Edm.Select2.createDropdownFromResponse(e,r,!1)})},f=function(){return $("div#macro-param-div-option-id").find(".select2-chosen").find("span").text()},l=function(){return AJS.$("#macro-param-multi-dropdown").is(":checked")?S():AJS.$("div#macro-param-div-option-id").find(".select2-chosen").text()},S=function(){return AJS.$("div#macro-param-div-option-id .select2-search-choice div").map(function(e,r){return r.textContent}).get().join(",")},J=function(e){var r=AJS.$("input#macro-param-set-id").val();Edm.Rest.post(n,m(r,AJS.params.spaceKey),function(r){Edm.Select2.createStatusOptionsDropdownFromResponse(e,r),AJS.MacroBrowser.Editor.processRequiredParameters()})},A=function(e){var r=AJS.$("input#macro-param-set-id").val(),t=AJS.$("#macro-param-multi-dropdown").is(":checked"),o=AJS.$("#macro-param-include-blank").is(":checked");Edm.Rest.post(a,m(r,AJS.params.spaceKey),function(r){Edm.Select2.createTextOptionsDropdownFromResponse(e,r,t,o),AJS.MacroBrowser.Editor.processRequiredParameters()})},v=function(e,r){Edm.Select2.createUniversalSetDropdownFromResponse(e,r);var t=e.val();e.val(t).change()},w=function(e){Edm.Rest.post(s,{spaceKey:AJS.params.spaceKey},function(r){v(e,r)})},h=function(e){Edm.Rest.post(i,{spaceKey:AJS.params.spaceKey},function(r){v(e,r)})},g=void 0;$(document).on("change","input#macro-param-multi-dropdown, input#macro-param-include-blank",function(){o()}),AJS.MacroBrowser.setMacroJsOverride("easy-dropdown-menu",{fields:{string:{options:e(function(e,r,t,o){o.setValue=function(r){Edm.Select2.createMultiDropdownWithExistingValues(e,r,t)}}),"permitted-groups":e(function(e){Edm.Rest.get(c,function(r){Edm.Select2.createDropdownFromResponse(e,r,!0)})}),"css-style-class":e(function(e){Edm.Rest.post(d,{spaceKey:AJS.params.spaceKey},function(r){Edm.Select2.createDropdownFromResponse(e,r,!1)})}),"current-option":function(e,r){var t=AJS.$(Confluence.Templates.MacroBrowser.macroParameter());t.hide();var o=AJS.$("input",t);return e.required&&o.keyup(AJS.MacroBrowser.processRequiredParameters),AJS.MacroBrowser.Field(t,o,r)}}},beforeParamsSet:function(e){return g=e["multi-dropdown"],g&&AJS.$("div#macro-param-div-include-blank").hide(),e}}),AJS.MacroBrowser.setMacroJsOverride("easy-dropdown-menu-predefined",{fields:{string:{"set-id":e(function(e){h(e)}),"option-id":e(function(e,r){t(e,r,A)}),"permitted-groups":e(function(e){p(e)}),"css-style-class":e(function(e){u(e)}),"current-option-value":r(l)}},beforeParamsSet:function(e){return g=e["multi-dropdown"],g&&AJS.$("div#macro-param-div-include-blank").hide(),e}}),AJS.MacroBrowser.setMacroJsOverride("easy-dropdown-menu-status",{fields:{string:{"set-id":e(function(e){w(e)}),"option-id":e(function(e,r){t(e,r,J)}),"permitted-groups":e(function(e){p(e)}),"current-option-value":r(f)}}}),AJS.MacroBrowser.setMacroJsOverride("easy-dropdown-menu-edit-mode",{fields:{string:{"set-id":e(function(e){h(e)}),"option-id":e(function(e,r){t(e,r,A)}),"permitted-groups":e(function(e){p(e)}),"css-style-class":e(function(e){u(e)}),"current-option-value":r(l)}},beforeParamsSet:function(e){return g=e["multi-dropdown"],g||AJS.$("div#macro-param-div-separator").hide(),e}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.simplenia.confluence.plugins.polls:polls-macro-smartfields', location = 'scripts/polls-macro-smartfields.js' */
AJS.bind("init.rte",function(){var a=function(b){this.parameterName=b};a.prototype.beforeParamsSet=function(e){var c=$("#macro-browser-dialog #macro-param-div-poll");var b=$("#macro-browser-dialog #macro-param-poll");var d=e.poll;b.hide();b.after('<div class="loading-spinner">&nbsp;<span class="aui-icon aui-icon-wait"></span></div>');AJS.$.getJSON(AJS.params.contextPath+"/rest/polls/1.0/polls",function(f){var g=false;$(f).each(function(h,i){if(d===i.guid){g=true;return false}});if(g||!d){if(f.length>0){$(f).each(function(h,j){var i=AJS.$("<option/>").attr("value",j.guid).html(""+AJS.escapeHtml(j.name));if(d===j.guid){i.attr("selected","selected")}b.append(i)});if(typeof b.auiSelect2==="function"){b.auiSelect2();$("#macro-browser-dialog #s2id_macro-param-poll").removeClass("macro-param-input");$("#macro-browser-dialog #s2id_macro-param-poll").show()}AJS.MacroBrowser.previewMacro(AJS.MacroBrowser.dialog.activeMetadata);AJS.MacroBrowser.processRequiredParameters()}else{$("div.macro-param-desc",c).text("No polls created yet. Please create a poll first to later embed it on a page or blogpost by using this macro.").css("color","#D04437")}}else{b.append(AJS.$("<option/>").attr("value",d).attr("disabled","disabled").html(""+AJS.escapeHtml(d)));b.show();AJS.MacroBrowser.previewMacro(AJS.MacroBrowser.dialog.activeMetadata);AJS.MacroBrowser.processRequiredParameters()}$("div.loading-spinner",c).remove()});return e};AJS.MacroBrowser.activateSmartFieldPolls=function(c,b){AJS.MacroBrowser.setMacroJsOverride(c,new a(b))};AJS.MacroBrowser.activateSmartFieldPolls("polls","poll")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'ch.mibex.confluence.include:include-for-confluence-macro-browser', location = '/js/include.js' */
(function($) {

    function setOptionHandler(options, input) {
        options.setValue = function(value) {
            const targetOption = input.find("option[value='" + value + "']");
            if (targetOption.length === 0) {
                const option = $("<option/>");
                option.val(value);
                option.text(value);
                input.append(option);
            }
        };
    }

    var StashIncludeMacroConfig = function(args) {
        this.supportCloud = !args || args.supportCloud;
    };

    StashIncludeMacroConfig.prototype.fields = {
        "string" : {
            "applicationLink" : function(param, options) {
                const paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                const input = $("select", paramDiv);
                if (options == null) {
                    options = {};
                }
                setOptionHandler(options, input);
                fillApplicationLinkList(input, this.supportCloud);
                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            },
            "progLang" : function(param, options) {
                const paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                const input = $("select", paramDiv);
                if (options == null) {
                    options = {};
                }
                setOptionHandler(options, input);

                $('input#macro-param-filepath').change(function() {
                    input.empty();
                    fillProgLangList(input, this.value);
                });

                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            }
        }
    };

    // because these fields are handled with select2, we need to remember their initial state
    let initialProjectKey;
    let initialRepoSlug;
    let initialFilePath;
    let initialBranch;

    StashIncludeMacroConfig.prototype.beforeParamsSet = function(selectedParams, macroSelected) {
        initialFilePath = selectedParams['filepath'];
        initialBranch = selectedParams['branchId'];
        initialRepoSlug = selectedParams['repoSlug'];
        initialProjectKey = selectedParams['projectKey'];

        // this is necessary because it is a mandatory parameter that was added later to the plug-in; without setting
        // this manually, users not having this parameter configured will not see the preview when they open the macro dialog
        if (selectedParams['applicationLink'] === undefined) {
            getStashEntities("getapplinks.action?pageId=" + AJS.params.pageId, function (appLinks) {
                    if (appLinks.status === 'ERROR') {
                        showError(appLinks);
                        return;
                    }
                    $.each(appLinks, function (index, appLink) {
                        if (appLink.primary) {
                            selectedParams['applicationLink'] = appLink.id;
                        }
                    });
                },
                function (response) {
                    showError(response);
                },
                false
            );
        }
        return selectedParams;
    };

    AJS.MacroBrowser.Macros["stashincludebyfilepath"] = new StashIncludeMacroConfig();
    AJS.MacroBrowser.Macros["stashincludebyantglob"] = new StashIncludeMacroConfig({supportCloud: false});
    AJS.MacroBrowser.Macros["stashopenpullrequests"] = new StashIncludeMacroConfig();
    AJS.MacroBrowser.Macros["stashbranches"] = new StashIncludeMacroConfig();
    AJS.MacroBrowser.Macros["stashcommits"] = new StashIncludeMacroConfig();
    AJS.MacroBrowser.Macros["stashtags"] = new StashIncludeMacroConfig();
    
    function fillApplicationLinkList(dropDown, supportCloud) {
        getStashEntities("getapplinks.action?pageId=" + AJS.params.pageId, function(appLinks) {
                var currentValue = dropDown.val();
                dropDown.empty();
                dropDown.append($("<option>(Choose application link)</option>").attr("value", ""));

                if (!appLinks.length) {
                    AJS.log("No Bitbucket connections found.");
                    return;
                }

                $.each(appLinks, function(index, appLink) {
                    if(supportCloud || !appLink.cloud){
                        var option = $("<option />");
                        option.val(appLink.id);
                        option.text(appLink.name);
                        dropDown.append(option);

                        if (!currentValue && appLink.primary) {
                            currentValue = appLink.id;
                        }
                    }
                });

                dropDown.val(currentValue);
                fillProjectsList($('select#macro-param-projectKey'), dropDown.val());
            },
            function(response) {
                dropDown.empty();
                showError(response);
            }, true
        );
        dropDown.off('change')
        dropDown.change(function() {
            fillProjectsList($('select#macro-param-projectKey'), dropDown.val());
        });
    }

    function fillProjectsList(dropDown, appLink) {
        const $projectKey = $('input#macro-param-projectKey');
        const getProjectsUrl = "getprojects.action?appLink=" + appLink + "&spaceKey=" + AJS.params.spaceKey + "&pageId=" + AJS.params.pageId;

        getStashEntities(getProjectsUrl, function(projects) {
            $projectKey.auiSelect2({
                placeholder: 'Select a project',
                width: '100%',
                adaptContainerCssClass: function (klass) {
                    return $.trim(klass) === 'macro-param-input' ? null : klass;
                },
                formatNoMatches: function (query) {
                    return 'No matching projects found';
                },
                formatResult: function (obj, container, query) {
                    return formatStashEntry(obj);
                },
                formatSelection: function (obj, container) {
                    return formatStashEntry(obj);
                },
                initSelection: function (element, callback) {
                    const initialProject = _.find(projects, function (project) {
                        if (project.key === initialProjectKey) return project;
                        else return null;
                    });
                    callback({
                        id: initialProjectKey,
                        text: initialProject ? initialProject.name : null
                    });
                },
                sortResults: function (results, container, query) {
                    return _.sortBy(results, function (path) {
                        return path.text;
                    });
                },
                query: function (query) {
                    const term = query.term.toLowerCase();
                    const results = [];
                    for (let i = 0; i < projects.length; i++) {
                        const project = projects[i];
                        if (project.name.toLowerCase().indexOf(term) >= 0) {
                            results.push({id: project.key, text: project.name});
                        }
                    }
                    query.callback({results: results});
                }
            });
        }, function(error) {
            showError(error);
        });

        fillRepositoryList(appLink, $projectKey.val());
        $projectKey.off('change')
        $projectKey.change(function() {
            fillRepositoryList(appLink, $projectKey.val());
        });
    }

    function initAutoPreviewMacro(macroParameter) {
        const filePathParameter = document.getElementById("macro-param-filepath");
        const filePathParameterExists = document.body.contains(filePathParameter);
        const autoPreview = function () {
            if ($(this).val() || $(macroParameter).val()) {
                AJS.log("auto-preview triggered for " + $(this).val());
                $('#macro-browser-preview-link').click();
            }
            return true;
        };
        if (filePathParameterExists) {
            $('#macro-param-lineStart, #macro-param-lineEnd, #macro-param-regexMatchStart, #macro-param-regexMatchEnd, #macro-param-numMatches').blur(autoPreview);
            $('#macro-param-fileEncoding, #macro-param-progLang, #macro-param-showLineNumbers, #macro-param-collapsible, #macro-param-theme, #macro-param-hideHeader, #macro-param-antGlob').on('change', autoPreview);
            macroParameter.on('change', autoPreview);
        } else {
            $('#macro-param-numMatches').blur(autoPreview);
            macroParameter.on('change', autoPreview);
        };
    }

    function fillRepositoryList(appLink, projectKey) {
        if (!projectKey) return;
        const $repoSlug = $('input#macro-param-repoSlug');
        const repoUrl = "getrepos.action?appLink=" + appLink + "&projectKey=" + projectKey + "&pageId=" + AJS.params.pageId;
        const filePathParameter = document.getElementById("macro-param-filepath");
        const filePathParameterExists = document.body.contains(filePathParameter);
        const fileAntGlobPathParameter = document.getElementById("macro-param-antGlob");
        const fileAntGlobPathParameterExists = document.body.contains(fileAntGlobPathParameter);

        getStashEntities(repoUrl, function(repos) {
            $repoSlug.auiSelect2({
                placeholder: 'Select a repository',
                width: '100%',
                adaptContainerCssClass: function(klass) {
                    return $.trim(klass) === 'macro-param-input' ? null : klass;
                },
                formatNoMatches: function(query) {
                    return 'No matching repositories found';
                },
                formatResult: function(obj, container, query) {
                    return formatStashEntry(obj);
                },
                formatSelection: function(obj, container) {
                    return formatStashEntry(obj);
                },
                initSelection : function(element, callback) {
                    const initialRepo = _.find(repos, function(repo) {
                        if (repo.slug === initialRepoSlug) return repo;
                        else return null;
                    });
                    callback({
                        id: initialRepoSlug,
                        text: initialRepo ? initialRepo.name : null
                    });
                },
                sortResults: function(results, container, query) {
                    return _.sortBy(results, function(path) {
                        return path.text;
                    });
                },
                query: function(query) {
                    const term = query.term.toLowerCase();
                    const results = [];
                    for (let i = 0; i < repos.length; i++) {
                        var repo = repos[i];
                        if (repo.name.toLowerCase().indexOf(term) >= 0) {
                            results.push({id: repo.slug, text: repo.name});
                        }
                    }
                    query.callback({results: results});
                }
            });
        }, function(error) {
            showError(error);
        });

        if (filePathParameterExists || fileAntGlobPathParameterExists){
            initBranchChooserFileMacro(appLink, projectKey, $repoSlug.val(), initialBranch);
            $repoSlug.off('change');
            $repoSlug.change(function() {
                initBranchChooserFileMacro(appLink, projectKey, $repoSlug.val(), '');
            });
        } else {
            initBranchChooserAllOtherMacros(appLink, projectKey, $repoSlug.val(), initialBranch);
            $repoSlug.change(function() {
                initBranchChooserAllOtherMacros(appLink, projectKey, $repoSlug.val(), '');
            });
            initAutoPreviewMacro($repoSlug);
        }
    }

    function formatFilePathEntry(obj) {
        if (!obj.text) return;
        const maxNumCharsToShow = 28;
        if (obj.text.length <= maxNumCharsToShow) {
            return '<div>' + obj.text + '</div>';
        } else if (obj.abbreviation) {
            return '<div title="' + obj.text + '">' + obj.abbreviation + '</div>';
        } else {
            return '<div title="' + obj.text + '">' + '...' + obj.text.slice(-maxNumCharsToShow + '...'.length + 1) + '</div>';
        }
    }

    function formatStashEntry(obj) {
        if (!obj.text) return;
        const maxNumCharsToShow = 28;
        if (obj.text.length <= maxNumCharsToShow) {
            return '<div>' + obj.text + '</div>';
        } else {
            return '<div title="' + obj.text + '">' + obj.text.slice(0, maxNumCharsToShow - ('...'.length + 1)) + '...' + '</div>';
        }
    }

    function initFileChooser(appLink, projectKey, repoSlug, branchId, initialFile) {
        if (!branchId) return;

        let cache = [];
        const $filePath = $('input#macro-param-filepath');
        const $antGlobFilePath = $('input#fileAntGlobPathParameter')

        $filePath.auiSelect2({
            placeholder: 'Select a file',
            width: '100%',
            adaptContainerCssClass: function(klass) {
                return $.trim(klass) === 'macro-param-input' ? null : klass;
            },
            formatNoMatches: function(query) {
                return 'No matching files found';
            },
            formatResult: function(obj, container, query) {
                return formatFilePathEntry(obj);
            },
            formatSelection: function(obj, container) {
                return formatFilePathEntry(obj);
            },
            initSelection : function(element, callback) {
                callback({id: initialFile, text: initialFile});
            },
            sortResults: function(results, container, query) {
                return _.sortBy(results, function(path) {
                    return path.text;
                });
            },
            query: function(query) {
                const term = query.term.toLowerCase();

                if (cache.length) {
                    const results = _.filter(cache, function(path) {
                        return path.text.toLowerCase().indexOf(term) >= 0;
                    });
                    query.callback({results : results});
                    return;
                }

                var getFilePathsUrl = "getfiles.action?appLink=" + appLink + "&projectKey=" + projectKey +
                    "&repoSlug=" + repoSlug + "&branchId=" + branchId + "&pageId=" + AJS.params.pageId + "&filePath=";
                getStashEntities(getFilePathsUrl, function(filePaths) {
                    const results = [];
                    for (let i = 0; i < filePaths.length; i++) {
                        if (i % 2 === 0) { // file paths and their appreviation always come after each other
                            const path = filePaths[i];
                            if (path.toLowerCase().indexOf(term) >= 0) {
                                results.push({id: path, text: path, abbreviation: filePaths[i + 1]});
                            }
                        }
                    }
                    cache = results;
                    query.callback({results: results});
                }, function(error) {
                    // in case of timeouts, we just switch back to plain text field without showing an error
                    if (error.body && error.body.includes("Timeout") && error.body.includes("Bitbucket")) {
                        $filePath.select2('destroy');
                    } else {
                        showError(error);
                    }
                }, true);
            }
        });

        initAutoPreviewMacro($filePath);
        initAutoPreviewMacro($antGlobFilePath);
        fillProgLangList($('select#macro-param-progLang'), initialFile);
    }

    function initBranchChooserAllOtherMacros(appLink, projectKey, repoSlug, initialBranch) {
        if (!repoSlug) return;

        const branchesUrl = "getbranches.action?appLink=" + appLink + "&projectKey=" + projectKey +
            "&repoSlug=" + repoSlug + "&pageId=" + AJS.params.pageId;
        let cachedBranches = null;
        let cachedTags = null;

        // this is necessary when the default branch was different to the main branch when we didn't yet have
        // the branch correction in the URL paste logic in place; in that case, the branch is null, so we need to
        // look the default branch up here
        if (!initialBranch) {
            getStashEntities(branchesUrl, function (branches) {
                cachedBranches = branches;
                for (let i = 0; i < branches.length; i++) {
                    if (branches[i].defaultBranch) {
                        initialBranch = branches[i].id;
                        break;
                    }
                }
            }, function() {
                console.error("Failed to fetch branches");
            }, false);
        }

        const $branchChooser = $('input#macro-param-branchId');

        $branchChooser.val(initialBranch).change();

        $branchChooser.auiSelect2({
            placeholder: 'Select a branch or tag',
            width: '100%',
            adaptContainerCssClass: function(klass) {
                return $.trim(klass) === 'macro-param-input' ? null : klass;
            },
            formatNoMatches: function(query) {
                return 'No matching branches or tags found';
            },
            formatResult: function(obj, container, query) {
                return formatStashEntry(obj);
            },
            initSelection : function(element, callback) {
                callback({id: initialBranch, text: initialBranch});
            },
            sortResults: function(results, container, query) {
                return _.sortBy(results, function(path) {
                    return path.text;
                });
            },
            formatSelection: function(obj, container) {
                if (!obj.text) return;
                let selection = obj.text;
                if (selection.lastIndexOf('refs/heads/', 0) === 0) {
                    selection = selection.slice('refs/heads/'.length);
                }
                if (selection.lastIndexOf('refs/tags/', 0) === 0) {
                    selection = selection.slice('refs/tags/'.length);
                }
                return formatStashEntry({ text: selection });
            },
            query: function(query) {
                const term = query.term.toLowerCase();
                function continueWithTags(results, tags){
                    for (let i = 0; i < tags.length; i++) {
                        if (results['tags'] === undefined) {
                            results['tags'] = {text:'tags', children:[]};
                        }
                        if (tags[i].displayId.toLowerCase().indexOf(term) >= 0) {
                            results['tags'].children.push({id: tags[i].id, text: tags[i].displayId});
                        }
                    }
                    query.callback({results: results});
                }
                function continueWithBranches(branches){
                    const results = {}
                    for (let i = 0; i < branches.length; i++) {
                        if (results['branches'] === undefined) {
                            results['branches'] = {text:'branches', children:[]};
                        }
                        if (branches[i].displayId.toLowerCase().indexOf(term) >= 0) {
                            results['branches'].children.push({id: branches[i].id, text: branches[i].displayId});
                        }
                    }
                    const tagsUrl = "gettags.action?appLink=" + appLink + "&projectKey=" + projectKey + "&repoSlug=" + repoSlug + "&pageId=" + AJS.params.pageId;

                    if(cachedTags){
                        continueWithTags(results, cachedTags)
                    } else{
                        getStashEntities(tagsUrl, function(tags) {
                            cachedTags = tags;
                            continueWithTags(results, tags)
                        }, function(error) {
                            query.callback({results: []});
                        }, true);
                    }
                }
                if(cachedBranches){
                    continueWithBranches(cachedBranches)
                } else{
                    getStashEntities(branchesUrl, function(branches) {
                        cachedBranches = branches;
                        continueWithBranches(branches);
                    }, function(error) {
                        query.callback({results: []});
                    }, true);
                }
            }
        });
        initAutoPreviewMacro($branchChooser);
    }

    function initBranchChooserFileMacro(appLink, projectKey, repoSlug, initialBranch) {
        if (!repoSlug) return;

        const branchesUrl = "getbranches.action?appLink=" + appLink + "&projectKey=" + projectKey +
            "&repoSlug=" + repoSlug + "&pageId=" + AJS.params.pageId;
        let cachedBranches = null;
        let cachedTags = null;

        // this is necessary when the default branch was different to the main branch when we didn't yet have
        // the branch correction in the URL paste logic in place; in that case, the branch is null, so we need to
        // look the default branch up here
        if (!initialBranch) {
            getStashEntities(branchesUrl, function (branches) {
                cachedBranches = branches;
                for (let i = 0; i < branches.length; i++) {
                    if (branches[i].defaultBranch) {
                        initialBranch = branches[i].id;
                        break;
                    }
                }
            }, function() {
                console.error("Failed to fetch branches");
            }, false);
        }

        const $branchChooser = $('input#macro-param-branchId');
        $branchChooser.val(initialBranch);

        $branchChooser.auiSelect2({
            placeholder: 'Select a branch or tag',
            width: '100%',
            adaptContainerCssClass: function(klass) {
                return $.trim(klass) === 'macro-param-input' ? null : klass;
            },
            formatNoMatches: function(query) {
                return 'No matching branches or tags found';
            },
            formatResult: function(obj, container, query) {
                return formatStashEntry(obj);
            },
            initSelection : function(element, callback) {
                callback({id: initialBranch, text: initialBranch});
            },
            sortResults: function(results, container, query) {
                return _.sortBy(results, function(path) {
                    return path.text;
                });
            },
            formatSelection: function(obj, container) {
                if (!obj.text) return;
                let selection = obj.text;
                if (selection.lastIndexOf('refs/heads/', 0) === 0) {
                    selection = selection.slice('refs/heads/'.length);
                }
                if (selection.lastIndexOf('refs/tags/', 0) === 0) {
                    selection = selection.slice('refs/tags/'.length);
                }
                return formatStashEntry({ text: selection });
            },
            query: function(query) {
                const term = query.term.toLowerCase();
                function continueWithTags(results, tags){
                    for (let i = 0; i < tags.length; i++) {
                        if (results['tags'] === undefined) {
                            results['tags'] = {text:'tags', children:[]};
                        }
                        if (tags[i].displayId.toLowerCase().indexOf(term) >= 0) {
                            results['tags'].children.push({id: tags[i].id, text: tags[i].displayId});
                        }
                    }
                    query.callback({results: results});
                }
                function continueWithBranches(branches){
                    const results = {}
                    for (let i = 0; i < branches.length; i++) {
                        if (results['branches'] === undefined) {
                            results['branches'] = {text:'branches', children:[]};
                        }
                        if (branches[i].displayId.toLowerCase().indexOf(term) >= 0) {
                            results['branches'].children.push({id: branches[i].id, text: branches[i].displayId});
                        }
                    }
                    const tagsUrl = "gettags.action?appLink=" + appLink + "&projectKey=" + projectKey + "&repoSlug=" + repoSlug + "&pageId=" + AJS.params.pageId;

                    if(cachedTags){
                        continueWithTags(results, cachedTags)
                    } else{
                        getStashEntities(tagsUrl, function(tags) {
                            cachedTags = tags;
                            continueWithTags(results, tags)
                        }, function(error) {
                            query.callback({results: []});
                        }, true);
                    }
                }
                if(cachedBranches){
                    continueWithBranches(cachedBranches)
                } else{
                    getStashEntities(branchesUrl, function(branches) {
                        cachedBranches = branches;
                        continueWithBranches(branches);
                    }, function(error) {
                        query.callback({results: []});
                    }, true);
                }
            }
        });
        initFileChooser(appLink, projectKey, repoSlug, $branchChooser.val(), initialFilePath);
        $branchChooser.change(function() {
            initFileChooser(appLink, projectKey, repoSlug, $branchChooser.val(), '');
        });
    }

    function getStashEntities(entityUrl, successHandler, errorHandler, async) {
        AJS.$.ajax({
            async: async,
            url: AJS.params.contextPath + "/plugins/includeforconfluence/" + entityUrl,
            dataType: 'json',
            timeout: 10000,
            error: function(xhr, textStatus, errorThrown) {
                errorHandler(errorThrown);
            },
            success: function(response) {
                if (response.status === 'OK' && successHandler && typeof(successHandler) == 'function') {
                    successHandler(response.body);
                } else if (errorHandler && typeof(errorHandler) == 'function') {
                    errorHandler(response);
                }
            }
        });
    }

    function showError(response) {
        // Work around for Firefox. If you remove the timeout, retest with Firefox. Was implemented when Firefox is at version 100.
        // Firefox doesn't show the message this code runs directly. When running with the debugger on,
        // it tends to crash the tab. As soon as the message is shown later with a timer, it does work again
        setTimeout(function () {
            // remove old messages first
            $('#macro-browser-preview div.aui-message').remove();
            if (response.status === "ERROR") {
                AJS.messages.error('div#macro-browser-preview', {
                    title: "An error occurred", body: response.body, closeable: false
                });
            } else if (response.status === "INFO") {
                AJS.messages.info('div#macro-browser-preview', {
                    title: "An action is required", body: response.body, closeable: false
                });
            } else {
                AJS.messages.error('div#macro-browser-preview', {
                    title: "An error occurred", body: response.body, closeable: false
                });
            }
        }, 16)
    }

    function fillProgLangList(dropDown, currentFile) {
        const currentValue = dropDown.val();
        dropDown.empty();
        dropDown.append($("<option>(Choose programming language)</option>").attr("value", ""));
        const progLangUrl = "getproglang.action?pageId=" + AJS.params.pageId;
        getStashEntities(progLangUrl, function(progLanguages) {
            $.each(progLanguages, function(index, progLang) {
                const option = $("<option />");
                option.val(progLang.key);
                option.text(progLang.name);
                dropDown.append(option);
            });

            if (!currentFile) return;

            if(!currentValue || currentValue === "") {
                const progLangTikaUrl = "getproglangtika.action?filePath=" + currentFile;
                getStashEntities(progLangTikaUrl, function(detectedLanguage) {
                    dropDown.val(detectedLanguage);
                });
            } else { // language has already been set
                dropDown.val(currentValue);
            }
        });
    }

})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.onresolve.confluence.groovy.groovyrunner:split_includeVersionMacro', location = 'js/includeVersionMacro.3af4222367b5f507087c.js' */
"use strict";(self.webpackJsonpScriptRunner=self.webpackJsonpScriptRunner||[]).push([["includeVersionMacro"],{38896:()=>{AJS.toInit((function(e){var t="location",n=function(t,n){e.ajax({type:"GET",dataType:"json",url:AJS.contextPath()+"/rest/scriptrunner-confluence/latest/content-info/history",data:{location:t,spaceKey:AJS.params.spaceKey}}).fail((function(e,t,n){403===e.status?alert("You do not have permission to view the included page, press Cancel"):alert("Failed to get versions for this page: "+e.responseText)})).done((function(t){var o=e("#macro-param-location-select");o.empty().append("<option value='0'>Latest</option>"),e.each(t,(function(t,a){var r=e("<option>"+a+"</option>");a===n&&r.attr("selected","selected"),o.append(r)})),n||o.find("option:nth(1)").attr("selected","selected"),o.trigger("change")}))};AJS.MacroBrowser.setMacroJsOverride("include-version",{fields:{int:{version:function(){var t=e(Confluence.Templates.MacroBrowser.macroParameterSelect()),n=e("select",t).attr("id","macro-param-location-select"),o=e('<input type="hidden"/>').appendTo(t);return n.bind("change",(function(){o.val(e(n).val()),o.trigger("change")})),AJS.MacroBrowser.Field(t,o,{})}}},beforeParamsSet:function(o){return e("#macro-param-location").on("selected.autocomplete-content",(function(t){n(e(t.currentTarget).val(),null)})),t in o&&n(o.location,o.version),o}})}))}},e=>{var t;t=38896,e(e.s=t)}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.onresolve.confluence.groovy.groovyrunner:split_includeCurrencyConverterMacro', location = 'js/includeCurrencyConverterMacro.039de111ff85b21e3002.js' */
(self.webpackJsonpScriptRunner=self.webpackJsonpScriptRunner||[]).push([["includeCurrencyConverterMacro"],{32956:(e,r,a)=>{"use strict";a(55778),AJS.toInit((function(e){AJS.MacroBrowser.setMacroJsOverride("currency-converter",{fields:{string:{currencyTo:function(){var r,a=e(Confluence.Templates.MacroBrowser.macroParameter()),c=e('<select class="adaptavist-sr"/>').appendTo(a);c.attr("id","macro-param-select").attr("multiple",!0),r=c,e("#macro-param-currencyFrom.select > option").each((function(e,a){var c="<option>"+a.value+"</option>";r.append(c)}));var n=e('<input type="hidden"/>').appendTo(a);return c.on("change",(function(r){n.val(JSON.stringify(e(c).val())),n.trigger("change")})),AJS.MacroBrowser.Field(a,n,{})}}},beforeParamsSet:function(r){return e("#macro-param-div-currencyTo input").hide(),e("#macro-param-select").auiSelect2({allowClear:!0}),function(r){if(r){var a=JSON.parse(r);e("#macro-param-select").val(a).trigger("change")}}(r.currencyTo),r},beforeParamsRetrieved:function(r){return e(".select2-search-choice-close").each((function(r,a){console.log("s2",a),e(a).data("events").click.splice(1,1)})),r}})}))},55778:(e,r,a)=>{e.exports=a}},e=>{var r;r=32956,e(e.s=r)}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:hidden-field-parameter', location = 'js/hidden-parameter-fields.js' */
AJS.MacroBrowser.setMacroJsOverride("clickable", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("copyright", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("htmlcomment", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("reg-tm", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("sm", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("span", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("strike", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

AJS.MacroBrowser.setMacroJsOverride("tm", {
  fields: {
    enum: {
      "atlassian-macro-output-type": function (param) {
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});
        if (!parameterField.getValue()) {
          parameterField.setValue('INLINE');
        }
        return parameterField;
      }
    }
  }
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:code-macro-editor', location = '/scripts/code-macro-languages.js' */
/**
 * Provides custom behaviour in the macro browser for the code macro.
 */
(function($) {

    var CodeMacroConfig = function() {};

    CodeMacroConfig.prototype.fields = {
        "string" : {
            "language" : function(param, options) {

                var paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                var input = $("select", paramDiv);

                // we need to do some trickery when the value is first set, and when the value is subsequently changed,
                // so set this up.
                if (options == null)
                    options = {};
                options.setValue = function(value) {

                    var targetOption = input.find("option[value='" + value + "']");
                    if (targetOption.length == 0) {
                        var option = $("<option/>");
                        option.val(value);
                        option.text(value);
                        input.append(option);
                    }
                };

                bindAsyncDropDown(input);
                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            }
        }
    };

    AJS.MacroBrowser.Macros["code"] = new CodeMacroConfig();

    /**
     * Populates an HTML Select element with the list of configured syntax highlighters.
     * @param dropDown JQuery selector for the HTML select element to be populated.
     */
    function bindAsyncDropDown(dropDown) {
        // Load the languages from Confluence
        getLanguagesAsync(function(languages) {
                    if (!languages.length)
                    {
                        AJS.log("Configured code macro languages result was not in the expected format.");
                        return;
                    }

                    var currentValue = dropDown.val();

                    dropDown.empty();
                    dropDown.append($("<option/>").attr("value", ""));

                    $.each(languages, function(index, lang) {
                        var option = $("<option />");
                        option.val(lang.aliases[0]);
                        option.text(lang.friendlyName);

                        dropDown.append(option);
                    });

                    // restore the currently selected value.
                    dropDown.val(currentValue);
                },
                function(xhr, textStatus, errorThrown) {
                    AJS.log("Failed to retrieve syntax highlighters from Confluence " + textStatus + " - " + errorThrown);
                });
    }

    /**
     * Asynchronously retrieves the current set of syntax highlighters currently installed for the Code macro.
     *
     * @param successHandler Callback to invoke if the retrieval is successful
     * @param errorHandler Callback to invoke if the retrieval fails.
     */
    function getLanguagesAsync(successHandler, errorHandler) {
        AJS.$.ajax({
            async: true,
            url: AJS.contextPath() + "/plugins/newcode/getlanguages.action",
            dataType: "json",
            timeout: 10000, // 10 seconds,
            error: function(xhr, textStatus, errorThrown) {
                if (errorHandler && typeof(errorHandler) == "function") {
                    errorHandler(xhr, textStatus, errorThrown);
                }
            },
            success: function(data) {
                if (successHandler && typeof(successHandler) == "function") {
                    successHandler(data);
                }
            }
        });
    }
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.edrup.confluence.plugins.simple-cite:macro-attachment', location = 'js/macro-browser-smartfields-simple-cite.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("bibtex-cite",["bib"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("bibtex-cite-link",["bib"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("bibtex-listing",["bib"])})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:question-answer-list-macro-resources', location = 'soytemplates/macro-question-list.soy' */
// This file was automatically generated from macro-question-list.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.TinyQA.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.TinyQA == 'undefined') { Confluence.TinyQA = {}; }
if (typeof Confluence.TinyQA.Templates == 'undefined') { Confluence.TinyQA.Templates = {}; }


Confluence.TinyQA.Templates.questionList = function(opt_data, opt_ignored) {
  var output = '<div class="question-list-header"><h2>' + soy.$$escapeHtml(opt_data.listTitle) + '</h2><button class="aui-button">Ask a question</button></div>' + ((opt_data.questions.length == 0) ? '<div class="aui-message aui-message-info"><p>' + soy.$$escapeHtml('No questions found.') + '</p></div>' : '');
  var questionList11 = opt_data.questions;
  var questionListLen11 = questionList11.length;
  for (var questionIndex11 = 0; questionIndex11 < questionListLen11; questionIndex11++) {
    var questionData11 = questionList11[questionIndex11];
    var spaceKey__soy12 = AJS.params.spaceKey == null ? '' : AJS.params.spaceKey;
    var contextUrl__soy13 = "" + (questionData11.spaceKey == '' ? '' : '/display/' + questionData11.spaceKey);
    output += '<div class="question-summary" id="question-summary-' + soy.$$escapeHtml(questionData11.id) + '"><div class="summary"><h3>' + ((questionData11.acceptedAnswerId > 0) ? '<img class="solved-question" alt="Solved question" title="Solved question" src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/accepted.png">' : '') + '<a href="' + soy.$$escapeHtml(contextUrl__soy13) + '/qa/questions/' + soy.$$escapeHtml(questionData11.id) + '" class="question-hyperlink">' + soy.$$escapeHtml(questionData11.title) + '</a></h3><div class="question-stats" ><span title="' + soy.$$escapeHtml(questionData11.score) + ' ' + soy.$$escapeHtml(questionData11.score == 1 ? 'vote' : 'votes') + '">' + soy.$$escapeHtml(questionData11.score) + ' ' + soy.$$escapeHtml(questionData11.score == 1 ? 'vote' : 'votes') + '</span><span>' + soy.$$escapeHtml(questionData11.viewCount) + ' ' + soy.$$escapeHtml(questionData11.viewCount == 1 ? 'view' : 'views') + '</span><span title="' + soy.$$escapeHtml(questionData11.answerCount) + ' ' + soy.$$escapeHtml(questionData11.answerCount == 1 ? 'answer' : 'answers') + '">' + soy.$$escapeHtml(questionData11.answerCount) + ' ' + soy.$$escapeHtml(questionData11.answerCount == 1 ? 'answer' : 'answers') + '</span><span title="Author"><img src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/user.png"/><a href="' + soy.$$escapeHtml("") + '/display/~' + soy.$$escapeHtml(questionData11.ownerUser.name) + '" target="_blank">' + soy.$$escapeHtml(questionData11.ownerUser.displayName) + '</a></span><span title="Asked"><img src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/timer.png"/>' + soy.$$escapeHtml(questionData11.friendlyCreationDate) + '</span>';
    if (questionData11.spaceKey != '') {
      var currentSpaceKey__soy63 = AJS.params.spaceKey == null ? '' : AJS.params.spaceKey;
      output += (currentSpaceKey__soy63 != questionData11.spaceKey) ? '<span title="Space"><img src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/space.png"/><a href="' + soy.$$escapeHtml(contextUrl__soy13) + '/qa/questions">' + soy.$$escapeHtml(questionData11.spaceName) + '</a></span>' : '';
    }
    output += '</div><div class="tags">';
    var tagNameList74 = questionData11.encodedTagNames;
    var tagNameListLen74 = tagNameList74.length;
    for (var tagNameIndex74 = 0; tagNameIndex74 < tagNameListLen74; tagNameIndex74++) {
      var tagNameData74 = tagNameList74[tagNameIndex74];
      output += '<a href="' + soy.$$escapeHtml(contextUrl__soy13) + '/qa/questions/?tag=' + soy.$$escapeHtml(tagNameData74.encodedName) + '" class="post-tag" title="' + soy.$$escapeHtml('show questions tagged') + ' \'' + soy.$$escapeHtml(tagNameData74.name) + '\'">' + soy.$$escapeHtml(tagNameData74.name) + '</a>';
    }
    output += '</div></div></div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.TinyQA.Templates.questionList.soyTemplateName = 'Confluence.TinyQA.Templates.questionList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:question-answer-list-macro-resources', location = 'js/tiny-question-answer-utils.js' */
var TinyQuestionAnswerUtils={ajaxTimeout:360000,getRestBaseUrl:function(){return Confluence.getContextPath()+"/rest/tiny-qa-services/1.0"},getQuestionServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/questions"+a},getUserServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/users"+a},getTagServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/tags"+a},getConfigurationServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/configuration"+a},isReadOnlyModeEnabled:function(){var b=false;try{b=AJS.Meta.get("access-mode")==="READ_ONLY"}catch(a){}return b},escapeHtml:function(a){if(a===undefined){a=""}return a.replace(/[\"&'\/<>]/g,function(b){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;"}[b]})},createTagSelection:function(b){var c=[];var a=10;b.removeClass("hidden").auiSelect2({multiple:true,tokenSeparators:[","," "],maximumSelectionLength:5,placeholder:"",maximumInputLength:150,quietMillis:200,ajax:{url:TinyQuestionAnswerUtils.getTagServiceBaseUrl("/search"),data:function(d,e){if(d.length<2){d=""}return{keyword:$.trim(d),page:e-1,pagesize:a,spaceKey:$("input[name='postSpaceKey']").val()}},results:function(d){c=_.map(d.tags,function(e){return{id:e.tagName,text:e.tagName,metadata:(e.tagCount==1?AJS.format("{0} question",e.tagCount):AJS.format("{0} questions",e.tagCount)),tagDescription:e.description}});return{results:c,more:d.tags.length==a}},quietMillis:300},createSearchChoice:function(e,f){var d=$.trim(e);var g=function(h){return h.text.localeCompare(d)==0};if(_.filter(c,g).length>0){return{id:d,text:d}}if(AJS.params.eliteSoft.canCreateNewTag){if(f.length<a&&_.filter(f,g).length==0){return{id:d,text:d,metadata:"Create new",newTag:true}}}},initSelection:function(d,f){var e=[];$(d.val().split(",")).each(function(){e.push({id:this,text:this})});f(e)},formatResult:function(e,f,h,d){var g=$.fn.select2.defaults.formatResult(e,f,h,d);if(e.metadata!==undefined){var i="";if(e.tagDescription!==undefined){i="title='"+e.tagDescription+"'"}g+="<span class='tnqa-tags-info' "+i+" >"+e.metadata+"</span>"}return g},sortResults:function(e,d,g){if(e.length>0&&e[0].newTag){var f=e.shift();e.push(f)}return e}})},createSpaceSelection:function(b){var c=[];var a=20;b.auiSelect2({multiple:false,tokenSeparators:[","],maximumSelectionLength:1000,placeholder:"",maximumInputLength:1500,quietMillis:200,ajax:{url:TinyQuestionAnswerUtils.getQuestionServiceBaseUrl("/search-paging-spaces")+"?pageSize="+a,data:function(d,e){d=$.trim(d);return{query:$.trim(d),pageIndex:e}},results:function(g,f){var d=g.spaces;c=_.map(d,function(h){return{id:h.key,text:h.name}});var e=(f*a)<g.total;return{results:c,more:e}},quietMillis:300},createSearchChoice:function(e,g){var d=$.trim(e);var h=function(i){return i.text.localeCompare(d)==0};var f=_.filter(c,h);if(f.length>0){return{id:f[0].id,text:f[0].text}}},initSelection:function(d,f){var e=$(d).val();if(e!==""){$.ajax({cache:false,data:{spaceKeys:e},dataType:"json",error:function(g,j,i){var h=[];f(h)},success:function(j){var g={};for(var h=0;h<j.spaces.length;h++){g={id:j.spaces[h].key,text:j.spaces[h].name}}f(g)},type:"PUT",timeout:TinyQuestionAnswerUtils.ajaxTimeout,url:TinyQuestionAnswerUtils.getQuestionServiceBaseUrl("/get-spaces")})}},formatResult:function(e,f,h,d){var g=$.fn.select2.defaults.formatResult(e,f,h,d);return g},sortResults:function(e,d,f){return e}})}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:question-answer-list-macro-resources', location = '/js/macro-question-list.js' */
(function(a){a(function(){a(".question-list-macro").each(function(g,l){var h=a(this);var d=h.data();var j=d.macroLimit;var i=d.macroSpaceKey;var m=d.macroTag;var c=d.macroFilter||"";if(c.toLowerCase()==="subscribed"){c="subscribed"}else{if(c.toLowerCase()=="votes"){c="votes"}else{if(c.toLowerCase()=="active"){c="active"}else{if(c.toLowerCase()=="unanswered"){c="unanswered"}else{if(c.toLowerCase()=="unaccepted"){c="unaccepted"}else{c="newest"}}}}}var b=d.macroListTitle||"none";if(b=="none"){b=""}var f=d.macroAskable;var k=d.macroShowaskbutton;a.ajax({cache:false,data:{pageIndex:0,pageSize:j,sortType:c,tag:m,spaceKey:i},dataType:"json",error:function(e,o,n){},success:function(p){var x=p.posts;for(var r=0;r<x.length;r++){x[r].encodedTagNames=[];var w=x[r].tagNames;for(var o=0;o<w.length;o++){var n=w[o];x[r].encodedTagNames.push({name:n,encodedName:encodeURIComponent(n)})}}var q=Confluence.TinyQA.Templates.questionList({questions:x,listTitle:b});h.html(q);var t=a(".question-hyperlink",h);var e=0;for(var r=0;r<t.length;r++){var s=a(t[r]).width();if(s>e){e=s}}if(e>0){if(e<580){e=580}var v=h.width();if(v<e){e=v}a(".question-list-header",h).width(e)}var u=true;if(!f||!k){a(".question-list-header button",h).hide();u=false}if(b===""&&u===false){a(".question-list-header").remove()}},type:"GET",timeout:TinyQuestionAnswerUtils.ajaxTimeout,url:TinyQuestionAnswerUtils.getQuestionServiceBaseUrl("/get-post-list")});h.on("click",".question-list-header button",function(n){n.preventDefault();var e=AJS.params.spaceKey||"";var o=AJS.Confluence.getContextPath()+(e==""?"":"/display/"+e)+"/qa/questions/ask";window.location.href=o})})})}(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:questionslist-macro-resources', location = 'soytemplates/macro-question-list.soy' */
// This file was automatically generated from macro-question-list.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.TinyQA.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.TinyQA == 'undefined') { Confluence.TinyQA = {}; }
if (typeof Confluence.TinyQA.Templates == 'undefined') { Confluence.TinyQA.Templates = {}; }


Confluence.TinyQA.Templates.questionList = function(opt_data, opt_ignored) {
  var output = '<div class="question-list-header"><h2>' + soy.$$escapeHtml(opt_data.listTitle) + '</h2><button class="aui-button">Ask a question</button></div>' + ((opt_data.questions.length == 0) ? '<div class="aui-message aui-message-info"><p>' + soy.$$escapeHtml('No questions found.') + '</p></div>' : '');
  var questionList11 = opt_data.questions;
  var questionListLen11 = questionList11.length;
  for (var questionIndex11 = 0; questionIndex11 < questionListLen11; questionIndex11++) {
    var questionData11 = questionList11[questionIndex11];
    var spaceKey__soy12 = AJS.params.spaceKey == null ? '' : AJS.params.spaceKey;
    var contextUrl__soy13 = "" + (questionData11.spaceKey == '' ? '' : '/display/' + questionData11.spaceKey);
    output += '<div class="question-summary" id="question-summary-' + soy.$$escapeHtml(questionData11.id) + '"><div class="summary"><h3>' + ((questionData11.acceptedAnswerId > 0) ? '<img class="solved-question" alt="Solved question" title="Solved question" src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/accepted.png">' : '') + '<a href="' + soy.$$escapeHtml(contextUrl__soy13) + '/qa/questions/' + soy.$$escapeHtml(questionData11.id) + '" class="question-hyperlink">' + soy.$$escapeHtml(questionData11.title) + '</a></h3><div class="question-stats" ><span title="' + soy.$$escapeHtml(questionData11.score) + ' ' + soy.$$escapeHtml(questionData11.score == 1 ? 'vote' : 'votes') + '">' + soy.$$escapeHtml(questionData11.score) + ' ' + soy.$$escapeHtml(questionData11.score == 1 ? 'vote' : 'votes') + '</span><span>' + soy.$$escapeHtml(questionData11.viewCount) + ' ' + soy.$$escapeHtml(questionData11.viewCount == 1 ? 'view' : 'views') + '</span><span title="' + soy.$$escapeHtml(questionData11.answerCount) + ' ' + soy.$$escapeHtml(questionData11.answerCount == 1 ? 'answer' : 'answers') + '">' + soy.$$escapeHtml(questionData11.answerCount) + ' ' + soy.$$escapeHtml(questionData11.answerCount == 1 ? 'answer' : 'answers') + '</span><span title="Author"><img src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/user.png"/><a href="' + soy.$$escapeHtml("") + '/display/~' + soy.$$escapeHtml(questionData11.ownerUser.name) + '" target="_blank">' + soy.$$escapeHtml(questionData11.ownerUser.displayName) + '</a></span><span title="Asked"><img src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/timer.png"/>' + soy.$$escapeHtml(questionData11.friendlyCreationDate) + '</span>';
    if (questionData11.spaceKey != '') {
      var currentSpaceKey__soy63 = AJS.params.spaceKey == null ? '' : AJS.params.spaceKey;
      output += (currentSpaceKey__soy63 != questionData11.spaceKey) ? '<span title="Space"><img src="' + soy.$$escapeHtml("") + '/download/resources/com.elitesoftsp.confluence.tiny.question.answer.plugins:tiny-qa-main-res/images/space.png"/><a href="' + soy.$$escapeHtml(contextUrl__soy13) + '/qa/questions">' + soy.$$escapeHtml(questionData11.spaceName) + '</a></span>' : '';
    }
    output += '</div><div class="tags">';
    var tagNameList74 = questionData11.encodedTagNames;
    var tagNameListLen74 = tagNameList74.length;
    for (var tagNameIndex74 = 0; tagNameIndex74 < tagNameListLen74; tagNameIndex74++) {
      var tagNameData74 = tagNameList74[tagNameIndex74];
      output += '<a href="' + soy.$$escapeHtml(contextUrl__soy13) + '/qa/questions/?tag=' + soy.$$escapeHtml(tagNameData74.encodedName) + '" class="post-tag" title="' + soy.$$escapeHtml('show questions tagged') + ' \'' + soy.$$escapeHtml(tagNameData74.name) + '\'">' + soy.$$escapeHtml(tagNameData74.name) + '</a>';
    }
    output += '</div></div></div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.TinyQA.Templates.questionList.soyTemplateName = 'Confluence.TinyQA.Templates.questionList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:questionslist-macro-resources', location = 'js/tiny-question-answer-utils.js' */
var TinyQuestionAnswerUtils={ajaxTimeout:360000,getRestBaseUrl:function(){return Confluence.getContextPath()+"/rest/tiny-qa-services/1.0"},getQuestionServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/questions"+a},getUserServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/users"+a},getTagServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/tags"+a},getConfigurationServiceBaseUrl:function(a){return this.getRestBaseUrl()+"/configuration"+a},isReadOnlyModeEnabled:function(){var b=false;try{b=AJS.Meta.get("access-mode")==="READ_ONLY"}catch(a){}return b},escapeHtml:function(a){if(a===undefined){a=""}return a.replace(/[\"&'\/<>]/g,function(b){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;"}[b]})},createTagSelection:function(b){var c=[];var a=10;b.removeClass("hidden").auiSelect2({multiple:true,tokenSeparators:[","," "],maximumSelectionLength:5,placeholder:"",maximumInputLength:150,quietMillis:200,ajax:{url:TinyQuestionAnswerUtils.getTagServiceBaseUrl("/search"),data:function(d,e){if(d.length<2){d=""}return{keyword:$.trim(d),page:e-1,pagesize:a,spaceKey:$("input[name='postSpaceKey']").val()}},results:function(d){c=_.map(d.tags,function(e){return{id:e.tagName,text:e.tagName,metadata:(e.tagCount==1?AJS.format("{0} question",e.tagCount):AJS.format("{0} questions",e.tagCount)),tagDescription:e.description}});return{results:c,more:d.tags.length==a}},quietMillis:300},createSearchChoice:function(e,f){var d=$.trim(e);var g=function(h){return h.text.localeCompare(d)==0};if(_.filter(c,g).length>0){return{id:d,text:d}}if(AJS.params.eliteSoft.canCreateNewTag){if(f.length<a&&_.filter(f,g).length==0){return{id:d,text:d,metadata:"Create new",newTag:true}}}},initSelection:function(d,f){var e=[];$(d.val().split(",")).each(function(){e.push({id:this,text:this})});f(e)},formatResult:function(e,f,h,d){var g=$.fn.select2.defaults.formatResult(e,f,h,d);if(e.metadata!==undefined){var i="";if(e.tagDescription!==undefined){i="title='"+e.tagDescription+"'"}g+="<span class='tnqa-tags-info' "+i+" >"+e.metadata+"</span>"}return g},sortResults:function(e,d,g){if(e.length>0&&e[0].newTag){var f=e.shift();e.push(f)}return e}})},createSpaceSelection:function(b){var c=[];var a=20;b.auiSelect2({multiple:false,tokenSeparators:[","],maximumSelectionLength:1000,placeholder:"",maximumInputLength:1500,quietMillis:200,ajax:{url:TinyQuestionAnswerUtils.getQuestionServiceBaseUrl("/search-paging-spaces")+"?pageSize="+a,data:function(d,e){d=$.trim(d);return{query:$.trim(d),pageIndex:e}},results:function(g,f){var d=g.spaces;c=_.map(d,function(h){return{id:h.key,text:h.name}});var e=(f*a)<g.total;return{results:c,more:e}},quietMillis:300},createSearchChoice:function(e,g){var d=$.trim(e);var h=function(i){return i.text.localeCompare(d)==0};var f=_.filter(c,h);if(f.length>0){return{id:f[0].id,text:f[0].text}}},initSelection:function(d,f){var e=$(d).val();if(e!==""){$.ajax({cache:false,data:{spaceKeys:e},dataType:"json",error:function(g,j,i){var h=[];f(h)},success:function(j){var g={};for(var h=0;h<j.spaces.length;h++){g={id:j.spaces[h].key,text:j.spaces[h].name}}f(g)},type:"PUT",timeout:TinyQuestionAnswerUtils.ajaxTimeout,url:TinyQuestionAnswerUtils.getQuestionServiceBaseUrl("/get-spaces")})}},formatResult:function(e,f,h,d){var g=$.fn.select2.defaults.formatResult(e,f,h,d);return g},sortResults:function(e,d,f){return e}})}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.elitesoftsp.confluence.tiny.question.answer.plugins:questionslist-macro-resources', location = '/js/macro-question-list.js' */
(function(a){a(function(){a(".question-list-macro").each(function(g,l){var h=a(this);var d=h.data();var j=d.macroLimit;var i=d.macroSpaceKey;var m=d.macroTag;var c=d.macroFilter||"";if(c.toLowerCase()==="subscribed"){c="subscribed"}else{if(c.toLowerCase()=="votes"){c="votes"}else{if(c.toLowerCase()=="active"){c="active"}else{if(c.toLowerCase()=="unanswered"){c="unanswered"}else{if(c.toLowerCase()=="unaccepted"){c="unaccepted"}else{c="newest"}}}}}var b=d.macroListTitle||"none";if(b=="none"){b=""}var f=d.macroAskable;var k=d.macroShowaskbutton;a.ajax({cache:false,data:{pageIndex:0,pageSize:j,sortType:c,tag:m,spaceKey:i},dataType:"json",error:function(e,o,n){},success:function(p){var x=p.posts;for(var r=0;r<x.length;r++){x[r].encodedTagNames=[];var w=x[r].tagNames;for(var o=0;o<w.length;o++){var n=w[o];x[r].encodedTagNames.push({name:n,encodedName:encodeURIComponent(n)})}}var q=Confluence.TinyQA.Templates.questionList({questions:x,listTitle:b});h.html(q);var t=a(".question-hyperlink",h);var e=0;for(var r=0;r<t.length;r++){var s=a(t[r]).width();if(s>e){e=s}}if(e>0){if(e<580){e=580}var v=h.width();if(v<e){e=v}a(".question-list-header",h).width(e)}var u=true;if(!f||!k){a(".question-list-header button",h).hide();u=false}if(b===""&&u===false){a(".question-list-header").remove()}},type:"GET",timeout:TinyQuestionAnswerUtils.ajaxTimeout,url:TinyQuestionAnswerUtils.getQuestionServiceBaseUrl("/get-post-list")});h.on("click",".question-list-header button",function(n){n.preventDefault();var e=AJS.params.spaceKey||"";var o=AJS.Confluence.getContextPath()+(e==""?"":"/display/"+e)+"/qa/questions/ask";window.location.href=o})})})}(AJS.$));
}catch(e){WRMCB(e)};